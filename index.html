<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40170863">
          <h3>
            <a
              class="item"
              href="https://truthout.org/articles/scotus-ignores-housing-crisis-in-hearing-on-laws-criminalizing-unhoused-people/"
              >SCOTUS Ignores Housing Crisis in Hearing on Laws Criminalizing
              Unhoused People</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 15:44:15</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40168765">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/04/26/investigatory_powers_bill/"
              >UK's Investigatory Powers Bill to become law despite tech world
              opposition</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 12:45:47</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40168765"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40168519">
          <h3>
            <a class="item" href="https://www.sharetextures.com/"
              >I'm creating PBR Textures and 3D models since 2018 and sharing
              them for free</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 12:23:15</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40168519"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40168284">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/aviator/jobs"
              >Aviator (YC S21) is hiring engineers to build a dev productivity
              platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 12:00:28</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40168242">
          <h3>
            <a class="item" href="https://peps.python.org/pep-0686/"
              >PEP 686 – Make UTF-8 mode default</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 11:55:14</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40168242"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40168052">
          <h3>
            <a
              class="item"
              href="https://michaeldehaan.substack.com/p/what-we-train-our-brains-for"
              >What We Train Our Brains For</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 11:26:29</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40168052"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40167905">
          <h3>
            <a class="item" href="https://cultdeadcow.com/tools/veilid.html"
              >Cult of the Dead Cow – Veilid (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 11:06:09</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40167905"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40167742">
          <h3>
            <a
              class="item"
              href="https://pharo.org/news/2024-04-26-pharo12-released.html"
              >Pharo 12</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 10:41:05</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40167742"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40167406">
          <h3>
            <a class="item" href="http://mendeleej.com/"
              >Show HN: Mendeleej.com - an Interactive Periodic Table</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 09:32:16</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40167406"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>Note : not very optimized for mobile use</p>
            </div>
          </section>
        </section>
        <section id="40167163">
          <h3>
            <a
              class="item"
              href="https://nautil.us/how-i-rewired-my-brain-to-become-fluent-in-math-235085/"
              >I Rewired My Brain to Become Fluent in Math (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 08:44:43</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40167163"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40166690">
          <h3>
            <a class="item" href="https://github.com/myshell-ai/OpenVoice"
              >OpenVoice: Instant Voice Cloning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 07:17:24</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40166690"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40166670">
          <h3>
            <a
              class="item"
              href="https://rubenerd.com/a-bsd-pserson-trying-alpine-linux/"
              >A BSD person tries Alpine Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 07:13:27</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40166670"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40165998">
          <h3>
            <a
              class="item"
              href="https://fy.blackhats.net.au/blog/2024-04-26-passkeys-a-shattered-dream/"
              >Passkeys: A Shattered Dream</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 04:36:39</span
              ><span class="points-container"
                >Points: <span class="points">399</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40165998"
                  >Comments</a
                ><span class="descendants">: 355</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40164337">
          <h3>
            <a
              class="item"
              href="https://romeov.github.io/malicious_ip_addresses/malicious_ip_analysis.html"
              >Visualizing malicious IP addresses</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 23:32:07</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40164337"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40163405">
          <h3>
            <a
              class="item"
              href="https://www.hanselman.com/blog/open-sourcing-dos-4"
              >Open Sourcing DOS 4</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 21:42:06</span
              ><span class="points-container"
                >Points: <span class="points">655</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40163405"
                  >Comments</a
                ><span class="descendants">: 275</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40161794">
          <h3>
            <a class="item" href="https://increase.com/articles/no-abstractions"
              >No Abstractions: our API design principle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 19:15:11</span
              ><span class="points-container"
                >Points: <span class="points">294</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40161794"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40160429">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/04/25/technology/fcc-net-neutrality-open-internet.html"
              >FCC votes to restore net neutrality rules</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 17:23:00</span
              ><span class="points-container"
                >Points: <span class="points">894</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40160429"
                  >Comments</a
                ><span class="descendants">: 497</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40159278">
          <h3>
            <a class="item" href="https://github.com/ArhanChaudhary/NAND"
              >Show HN: I made a programmable computer from NAND gates</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 16:08:05</span
              ><span class="points-container"
                >Points: <span class="points">352</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40159278"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
            <div class="text">
              <p>
                Check out NAND at
                <a href="https://nand.arhan.sh">https://nand.arhan.sh</a>
              </p>
              <p>
                Additionally, I've authored an extensive writeup about the
                project. Read about it on the GitHub repository's readme.
              </p>
            </div>
          </section>
        </section>
        <section id="40158481">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40158481"
              >Launch HN: Nango (YC W23) – Source-available unified API</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 15:09:02</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40158481"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.nango.dev">https://www.nango.dev</a>). We
              take care of the annoyances of external APIs (167 and counting) so
              you can quickly build custom integrations for your SaaS, while
              retaining full control over how they work. 2 min demo video:
              <a
                href="https://www.loom.com/share/d04c67b47e284e86b91b4b99fba548ec"
                >https://www.loom.com/share/d04c67b47e284e86b91b4b99fba548ec</a
              >
              <p>
                SaaS engineering teams face a tough choice: they can build each
                integration in-house from scratch, which gives them full control
                but takes a lot of time and maintenance effort. Or they can use
                pre-built solutions, which are fast and easy but less flexible
                and might not fulfill all customer needs.
              </p>
              <p>
                Nango combines the best of both worlds. We let you quickly ship
                custom integrations without building complex infrastructure or
                diving deep into the quirks of each API. You control the
                business logic, data models, and customer-specific
                configurations, like custom field mappings. We handle (O)Auth
                and run your integrations reliably in production.
              </p>
              <p>
                Under the hood, your integrations run as typescript “lambdas” on
                Nango. A typical integration has 3-5 lambdas of 20-50 lines of
                code each. These lambdas live inside your git repo, are
                version-controlled with the rest of your app, and get deployed
                to Nango with a CLI (<a
                  href="https://docs.nango.dev/understand/core-concepts"
                  >https://docs.nango.dev/understand/core-concepts</a
                >).
              </p>
              <p>
                Our runtime has a built-in scheduler for continuous background
                syncs, monitoring to know if your integrations run as expected,
                detailed logging of everything that happens in Nango, and
                pre-built infrastructure to deal with (O)auth, retries,
                rate-limit handling, webhook floods, data caching,
                de-duplication, etc. More here:
                <a href="https://docs.nango.dev/understand/architecture"
                  >https://docs.nango.dev/understand/architecture</a
                >
              </p>
              <p>
                We have found that ChatGPT and Copilot let you build
                integrations on Nango very fast without having to learn each
                API’s intricacies. LLMs are great at figuring out which endpoint
                to use, what parameters it takes, etc. Paired with our runtime,
                this lets you build complex, high-scale integrations in hours
                instead of weeks.
              </p>
              <p>
                We’ve put a ton of effort into dealing with API complexities, so
                you don’t have to. Even integrations that looked simple at first
                ended up forcing us to extend our infra to deal with their
                quirks and gotchas.
              </p>
              <p>
                For example, we had to figure out 100+ different OAuth
                implementations (see
                <a href="https://www.nango.dev/blog/why-is-oauth-still-hard"
                  >https://www.nango.dev/blog/why-is-oauth-still-hard</a
                >
                and
                <a href="https://news.ycombinator.com/item?id=35713518"
                  >https://news.ycombinator.com/item?id=35713518</a
                >). We had to deal with a half-dozen non-standard auth methods
                (Github apps, Stripe apps, Netsuite, etc.), expiring webhooks,
                ways to deal with data dependencies, weird pagination methods,
                API keys that change with every API call, dozens of different
                ways to register for webhooks, etc. It’s a constantly moving
                target, but it is a challenge we have come to love, and we think
                the approach makes sense: we specialize in finicky details that
                vary from API to API—you specialize in making your product great
                and offering more integrations to your users.
              </p>
              <p>
                Last but not least, Nango is open source (<a
                  href="https://github.com/NangoHQ/nango"
                  >https://github.com/NangoHQ/nango</a
                >) under the ELv2 license (allows most use cases, except for
                direct copy-cats). Anybody can contribute new APIs &amp; share
                their integration templates with the community.
              </p>
              <p>
                The fastest way to see Nango in action is with our interactive
                demo here (no signup required):
                <a href="https://app.nango.dev/hn-demo"
                  >https://app.nango.dev/hn-demo</a
                >
              </p>
              <p>
                Or take a look at our docs:
                <a href="https://docs.nango.dev">https://docs.nango.dev</a>
              </p>
              <p>
                We would love to hear your feedback and look forward to the
                comments!
              </p>
            </div>
          </section>
        </section>
        <section id="40156698">
          <h3>
            <a class="item" href="https://www.meegle.com/index"
              >Show HN: Meegle – Jira alternative with workflow visualization</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 12:31:41</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40156698"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40156534">
          <h3>
            <a class="item" href="https://github.com/Tribler/tribler/wiki"
              >Tribler: An attack-resilient micro-economy for media</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 12:13:51</span
              ><span class="points-container"
                >Points: <span class="points">275</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40156534"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40155022">
          <h3>
            <a
              class="item"
              href="https://justinsomnia.org/2012/04/hotel-wifi-javascript-injection/"
              >Hotel WiFi JavaScript Injection (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 08:43:55</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40155022"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40154731">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/04/24/stripe-doubling-down-on-embedded-finance-de-couples-payments-from-the-rest-of-its-stack/"
              >Stripe de-couples payments from the rest of its stack</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 07:59:13</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40154731"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40154395">
          <h3>
            <a
              class="item"
              href="https://direct.mit.edu/books/oa-monograph/5761/TorFrom-the-Dark-Web-to-the-Future-of-Privacy"
              >Tor: From the Dark Web to the Future of Privacy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 07:07:19</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40154395"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40154189">
          <h3>
            <a class="item" href="https://in-silo.com/daylight_computer"
              >DayLight Computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 06:36:13</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40154189"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40153765">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/philosophical-theories-are-like-good-stories-margaret-macdonald"
              >Philosophy is an art</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 05:26:29</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40153765"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40149961">
          <h3>
            <a
              class="item"
              href="https://onlinelibrary.wiley.com/doi/full/10.1111/issj.12464"
              >The construction of the mafioso social capital and the Sack of
              Palermo (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 21:32:54</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40149961"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40144309">
          <h3>
            <a
              class="item"
              href="https://blog.borrego.dev/entries/patching-requests-for-fun-and-concurrent-profit.html"
              >Patching requests for fun and (concurrent) profit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 13:42:20</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40144309"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40143800">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2404.14414"
              >Removing Reflections from Raw Photos</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 12:56:40</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40143800"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40142039">
          <h3>
            <a class="item" href="https://www.erlang.org/blog/optimizations/"
              >The Optimizations in Erlang/OTP 27</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 08:44:54</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40142039"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
