<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36173020">
          <h3>
            <a
              class="item"
              href="https://discourse.nixos.org/t/the-nixos-foundations-call-to-action-s3-costs-require-community-support/28672"
              >The NixOS Foundation’s Call to Action: S3 Costs Require Community
              Support</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-03 @ 02:10:26</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36173020"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36172936">
          <h3>
            <a
              class="item"
              href="https://www.asiasentinel.com/p/asia-sentinel-blocked-singapore"
              >Asia Sentinel Blocked in Singapore</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-03 @ 01:49:29</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36172936"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36172884">
          <h3>
            <a class="item" href="https://github.com/mateogianolio/vectorious"
              >Vectorious: BLAS-accelerated linear algebra for TypeScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-03 @ 01:41:32</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36172884"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36172677">
          <h3>
            <a
              class="item"
              href="https://elifesciences.org/reviewed-preprints/87414v1"
              >Teen neurostimulation of dopamine circuit reverses genetic
              deficits in PF cortex</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-03 @ 01:01:34</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36172677"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36172672">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36172672"
              >Generally Intelligent (YC S17) Is Hiring Chief of Staff</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-03 @ 01:00:45</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://jobs.lever.co/generallyintelligent/f5d04435-cfb5-4e3a-9269-8c5bda3ede50?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                >https://jobs.lever.co/generallyintelligent/f5d04435-cfb5-4e3...</a
              >
              <p>
                Generally Intelligent is an AI research company working directly
                on building human-level general machine intelligence that can
                learn naturally in the way humans do. Our mission is to
                understand the fundamentals of learning and build safe, humane
                machine intelligence.
              </p>
              <p>
                We are looking for a stellar Chief of Staff who will work
                closely with our CEO, Kanjun Qiu, and CTO, Josh Albrecht, as we
                scale the company. Kanjun herself started her career as the
                Chief of Staff at Dropbox, scaling the company from 200 to 1300
                people.
              </p>
              <p>
                This is a high-trust role with enormous growth potential. Your
                job is to do whatever it takes to make Generally Intelligent
                successful. Your work will cut across strategic initiatives and
                tactical execution with both internal and external folks.
              </p>
              <p>
                You are • A fast learner • Gets stuff done • Can take on big
                projects and move them forward with little oversight • Deep
                belief that AI today is a historical moment, like the Industrial
                Revolution or early Internet • Strong writing skills • Enjoy
                talking to people / working through others • Interest in
                building an AI community around Generally Intelligent
              </p>
              <p>
                Some backgrounds that could be a fit • Experience as a founder •
                Experience in BizOps (business operations) at a startup •
                Experience in strategy consulting (e.g. McKinsey, BCG), in
                addition to at a startup • Experience as an engineer or product
                manager with a desire to move to the business side • Studied
                quantitative fields like math, computer science, physics, or
                computational biology
              </p>
            </div>
          </section>
        </section>
        <section id="36172625">
          <h3>
            <a
              class="item"
              href="https://www.caltech.edu/about/news/in-a-first-caltechs-space-solar-power-demonstrator-wirelessly-transmits-power-in-space"
              >Caltech's Space Solar Power Demonstrator Wirelessly Transmits
              Power in Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-03 @ 00:49:37</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36172625"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36172461">
          <h3>
            <a
              class="item"
              href="https://www.bihealth.org/en/notices/intelligent-brains-take-longer-to-solve-difficult-problems"
              >Intelligent Brains Take Longer to Solve Difficult Problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-03 @ 00:21:35</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36172461"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36172426">
          <h3>
            <a class="item" href="https://www.filfre.net/2023/06/tomb-raider/"
              >Tomb Raider</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-03 @ 00:15:14</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36172426"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36172306">
          <h3>
            <a
              class="item"
              href="https://ukragroconsult.com/en/news/brazil-develops-tropical-wheat-and-predicts-self-sufficiency-in-5-years/"
              >Brazil develops tropical wheat and predicts self-sufficiency in 5
              years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 23:55:12</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36172306"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36171696">
          <h3>
            <a
              class="item"
              href="https://www.mattb.nz/w/2023/06/02/calling-time-on-dnssec/"
              >Calling time on DNSSEC: The costs exceed the benefits</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 22:33:24</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36171696"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36171591">
          <h3>
            <a
              class="item"
              href="https://www.axios.com/2023/06/02/supreme-court-sides-with-slack-putting-direct-listings-in-jeopardy"
              >Supreme Court sides with Slack, putting direct listings in
              jeopardy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 22:23:19</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36171591"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36170910">
          <h3>
            <a
              class="item"
              href="https://if50.substack.com/p/christopher-strachey-and-the-dawn"
              >Christopher Strachey and the dawn of interactive text</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 21:22:13</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36170910"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36170157">
          <h3>
            <a
              class="item"
              href="https://www.uclahealth.org/news/deep-brain-stimulation-during-sleep-strengthens-memory"
              >Deep-brain stimulation during sleep strengthens memory: study</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 20:14:59</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36170157"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36169954">
          <h3>
            <a class="item" href="https://brute.fail/"
              >Brute.Fail: Watch brute force attacks fail in real time</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 19:49:56</span
              ><span class="points-container"
                >Points: <span class="points">402</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36169954"
                  >Comments</a
                ><span class="descendants">: 161</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36169523">
          <h3>
            <a
              class="item"
              href="https://www.open.edu/openlearn/money-management/management/leadership-and-management/managing/systems-explained-humberto-maturana"
              >Systems explained by Humberto Maturana (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 19:16:44</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36169523"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36169513">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/web-deanonymization-side-channel-attack-njit/"
              >A new attack can unmask anonymous users on any major browser
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 19:16:04</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36169513"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36169486">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s42256-023-00666-w"
              >In vitro biological system of cultured brain cells has learned to
              play Pong</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 19:13:17</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36169486"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36169019">
          <h3>
            <a class="item" href="https://www.grumpygamer.com/speed_running_mi"
              >Speed running Monkey Island</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 18:37:08</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36169019"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36168836">
          <h3>
            <a
              class="item"
              href="https://www.allaboutcircuits.com/news/sifive-gives-its-worldguard-security-model-to-the-risc-v-community/"
              >SiFive Gives Its WorldGuard Security Model to the RISC-V
              Community</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 18:19:46</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36168836"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36168468">
          <h3>
            <a
              class="item"
              href="https://jamanetwork.com/journals/jamanetworkopen/fullarticle/2804215"
              >Effect of repeated low-level red light on myopia prevention</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 17:52:51</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36168468"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36168068">
          <h3>
            <a
              class="item"
              href="https://news.mit.edu/2023/gilbert-strang-made-linear-algebra-fun-0531"
              >He made linear algebra fun</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 17:23:18</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36168068"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36167948">
          <h3>
            <a
              class="item"
              href="https://github.com/facebookincubator/AITemplate"
              >Render a neural network into CUDA/HIP code</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 17:14:23</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36167948"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36167694">
          <h3>
            <a
              class="item"
              href="https://dangerousminds.net/comments/kenneth_anger_rip_the_magus_of_american_cinema_dead_at_96"
              >Kenneth Anger has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 16:58:37</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36167694"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36165513">
          <h3>
            <a class="item" href="https://the-analog-thing.org/"
              >The Analog Thing: an open source, educational, low-cost modern
              analog computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 14:25:53</span
              ><span class="points-container"
                >Points: <span class="points">232</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36165513"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36164055">
          <h3>
            <a
              class="item"
              href="https://www.forbes.com/sites/iainmartin/2023/05/31/lisa-su-saved-amd-now-she-wants-nvidias-ai-crown/"
              >Lisa Su saved AMD – Now she wants Nvidia's AI crown</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 12:10:45</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36164055"
                  >Comments</a
                ><span class="descendants">: 194</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36163955">
          <h3>
            <a
              class="item"
              href="http://www.cr31.co.uk/stagecast/trains/tt0_int.html"
              >Turing Trains</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 11:58:29</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36163955"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36162154">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/california-homeless-population-oakland-wood-street-encampment-78d42cc3"
              >California spent $17B on homelessness – it’s not working</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 07:27:07</span
              ><span class="points-container"
                >Points: <span class="points">395</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36162154"
                  >Comments</a
                ><span class="descendants">: 938</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36161385">
          <h3>
            <a
              class="item"
              href="http://oldvcr.blogspot.com/2023/05/refurb-weekend-commodore-128dcr.html"
              >Refurb weekend: Commodore 128DCR</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 05:30:13</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36161385"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36161156">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/06/01/style/when-the-neighbors-dont-share-your-vision-and-that-vision-involves-transformers-statues.html"
              >When the Neighbors Don’t Like Your 10-Foot-Tall Transformer
              Statues</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-02 @ 04:45:53</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36161156"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36146988">
          <h3>
            <a
              class="item"
              href="https://library.stanford.edu/blogs/digital-library-blog/2023/03/stanford-libraries-launches-taube-archive-international-military"
              >Archive of the Military Tribunal at Nuremberg, 1945-46</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-01 @ 02:37:00</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36146988"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
