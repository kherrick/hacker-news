<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36676879">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/europe/2023/07/09/sappers-risk-their-lives-to-win-ukraine-back-inch-by-inch"
              >Sappers risk their lives to win Ukraine back, inch by inch</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 05:51:03</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36676879"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36676415">
          <h3>
            <a class="item" href="https://playlaser.xyz"
              >Show HN: Laser, a new game played on a chess board</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 04:27:41</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36676415"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <i>laser</i> piece, which can shoot diagonally through every piece
              on the board except for the <i>wall</i>, which blocks it. The
              detailed rules are on the website.
              <p>
                I made the website as a super minimal way to play online against
                friends. Nobody really knows about it so it might be hard to
                find a game, but maybe you will against someone on HN if people
                read this. It uses the lichess.org chessboard UI which is super
                pretty and allows you to draw on the board, make premoves, etc.
                The code is public if you are interested:
                github.com/melgrove/laser
              </p>
              <p>If you are playing, good luck, and don't get lasered!</p>
            </div>
          </section>
        </section>
        <section id="36676215">
          <h3>
            <a
              class="item"
              href="https://micro.coyotetracks.org/2023/07/10/youre-so-vain.html"
              >You're So Vain, You Probably Think This App Is About You: On Meta
              and Mastodon</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 03:51:10</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36676215"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36676151">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=bEXefdbQDjw"
              >Growing Rat Neurons to Play Video Games [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 03:37:41</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36676151"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36676103">
          <h3>
            <a
              class="item"
              href="https://linuxiac.com/linux-hits-3-percent-market-share/"
              >After 30 Years, Linux Finally Hits 3% Market Share</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 03:29:39</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36676103"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36675934">
          <h3>
            <a
              class="item"
              href="https://threadreaderapp.com/thread/1678545170508267522.html"
              >GPT-4 details leaked?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 03:00:19</span
              ><span class="points-container"
                >Points: <span class="points">246</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36675934"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36675750">
          <h3>
            <a
              class="item"
              href="https://download.vusec.net/papers/floatzone_sec23.pdf"
              >FloatZone: Accelerating Memory Error Detection Using the Floating
              Point Unit [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 02:28:47</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36675750"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36675564">
          <h3>
            <a class="item" href="https://github.com/libdns/libdns"
              >Libdns: Core interfaces for universal DNS record manipulation
              across providers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 01:55:05</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36675564"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36675036">
          <h3>
            <a class="item" href="https://lwn.net/Articles/934561/"
              >XFS online filesystem check and repair</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 00:35:45</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36675036"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36674920">
          <h3>
            <a class="item" href="https://gpslogdrive.com/"
              >GPS Log: Tracking wood movement down the McKenzie River</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 00:18:44</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36674920"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36674606">
          <h3>
            <a
              class="item"
              href="https://hacks.mozilla.org/2023/03/letting-users-block-injected-third-party-dlls-in-firefox/"
              >Letting users block injected third-party DLLs in Firefox</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 23:42:48</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36674606"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36674487">
          <h3>
            <a
              class="item"
              href="https://blurbusters.com/frame-generation-essentials-interpolation-extrapolation-and-reprojection/"
              >Frame generation essentials: Interpolation, extrapolation, and
              reprojection</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 23:30:27</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36674487"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36674224">
          <h3>
            <a class="item" href="https://www.getlocalcert.net/"
              >Easy HTTPS for your private networks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 23:05:21</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36674224"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36674069">
          <h3>
            <a
              class="item"
              href="https://www.udiscovermusic.com/news/brian-eno-albums-dolby-atmos-first-time/"
              >Brian Eno albums available in Dolby Atmos and Spatial</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 22:49:32</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36674069"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36673945">
          <h3>
            <a
              class="item"
              href="https://qemu.readthedocs.io/en/latest/system/i386/microvm.html"
              >MicroVM by QEMU</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 22:35:26</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36673945"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36673793">
          <h3>
            <a
              class="item"
              href="https://letsencrypt.org/2023/07/10/cross-sign-expiration.html"
              >Shortening the Let's Encrypt chain of trust</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 22:19:22</span
              ><span class="points-container"
                >Points: <span class="points">303</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36673793"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36673224">
          <h3>
            <a class="item" href="https://github.com/immich-app/immich"
              >Self-hosted photo and video backups directly from your mobile
              phone</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 21:28:40</span
              ><span class="points-container"
                >Points: <span class="points">479</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36673224"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36672957">
          <h3>
            <a class="item" href="https://github.com/mkirchner/hamt"
              >Show HN: A hash array-mapped trie implementation in C</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 21:06:55</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36672957"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              <p>
                Kind of aiming to be "the libavl for HAMTs". That is obviously a
                high and aspirational bar but a distinct possibility if it stirs
                up a little interest and/or contribution.
              </p>
              <p>
                Anyways, it's time for this to go out, collect feedback and
                maybe even some use outside of toy projects. Let me know how it
                goes.
              </p>
            </div>
          </section>
        </section>
        <section id="36672888">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/fathom/jobs/OVTRjXb-staff-engineer-full-stack-remote"
              >Fathom AI Notetaker (YC W21) is hiring a staff engineer
              (remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 21:00:06</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36672183">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36672183"
              >Show HN: The full source code and assets for my custom game
              engine and game</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 20:04:29</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36672183"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
            <div class="text">
              <p>https://github.com/Mknsri/HockeySlam</p>
              <p>
                Hockey Slam is a hockey shootout game on Android which I built
                almost from scratch. Some of the engine features include 3D
                graphics with PBR materials, a rudimentary physics system,
                replays, a multithreaded job system and a hot-reload DLL
                platform for developing on Windows.
              </p>
              <p>
                I detailed the creation of the game in it's own post, but now
                that time has passed I am releasing the source code and assets
                under the MIT license. You can still find the making of here:
                https://hockeyslam.com/makingof
              </p>
              <p>I'm happy to answer any questions you might have.</p>
            </div>
          </section>
        </section>
        <section id="36672115">
          <h3>
            <a
              class="item"
              href="https://articles.59.ca/doku.php?id=em:20482030"
              >2048 Bit RSA and the Year 2030</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 19:58:01</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36672115"
                  >Comments</a
                ><span class="descendants">: 113</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36670328">
          <h3>
            <a
              class="item"
              href="https://github.com/markmal/freeship-plus-in-lazarus"
              >FreeShip Plus in Lazarus – an open-source software for boat and
              hull design</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 17:58:30</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36670328"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36669249">
          <h3>
            <a class="item" href="https://rauno.me/craft/interaction-design"
              >Invisible Details of Interaction Design</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 17:02:42</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36669249"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36668964">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2023/07/10/lima--a-nice-way-to-run-linux-vms-on-mac/"
              >Lima: A nice way to run Linux VMs on Mac</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 16:44:09</span
              ><span class="points-container"
                >Points: <span class="points">425</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36668964"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36668732">
          <h3>
            <a
              class="item"
              href="https://github.com/zhuowei/VisionOSStereoScreenshots/tree/alvr"
              >Apple VisionOS Simulator streaming wirelessly to Meta Quest
              headset</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 16:30:34</span
              ><span class="points-container"
                >Points: <span class="points">373</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36668732"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36667103">
          <h3>
            <a
              class="item"
              href="http://hyperphysics.phy-astr.gsu.edu/hbase/index.html"
              >HyperPhysics (1998)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 14:36:57</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36667103"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36666782">
          <h3>
            <a class="item" href="https://hocus.dev/blog/qemu-vs-firecracker/"
              >We replaced Firecracker with QEMU</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 14:15:04</span
              ><span class="points-container"
                >Points: <span class="points">376</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36666782"
                  >Comments</a
                ><span class="descendants">: 137</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36666380">
          <h3>
            <a
              class="item"
              href="https://www.beterinbeleggen.nl/pdf/tsm/The-Perfect-Business-Richard-Russell.pdf"
              >The Perfect Business [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 13:47:59</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36666380"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36664509">
          <h3>
            <a
              class="item"
              href="https://tomverbeure.github.io/2023/07/09/TM4313-GPSDO-Teardown.html"
              >Teardown of the TM4313 GPS Disciplined Oscillator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 10:50:38</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36664509"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36650062">
          <h3>
            <a
              class="item"
              href="http://oldvcr.blogspot.com/2023/07/making-potato-webcam-with-commodore-128.html"
              >Making a potato livecam with the Commodore 128 VDC and
              ComputerEyes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-09 @ 00:13:56</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36650062"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
