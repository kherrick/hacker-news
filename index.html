<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43715235">
          <h3>
            <a
              class="item"
              href="https://www.feldera.com/blog/cutting-down-rust-compile-times-from-30-to-2-minutes-with-one-thousand-crates"
              >Cutting down Rust compile times from 30 to 2 minutes with one
              thousand crates</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 11:22:17</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43715235"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43715109">
          <h3>
            <a
              class="item"
              href="https://voiceofsandiego.org/2025/04/14/as-bot-students-continue-to-flood-in-community-colleges-struggle-to-respond/"
              >As 'Bot' Students Continue to Flood In, Community Colleges
              Struggle to Respond</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 10:57:38</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43715109"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43715022">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/c1egdy24v7po"
              >US Government threatens Harvard with foreign student ban</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 10:42:01</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43715022"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43714959">
          <h3>
            <a
              class="item"
              href="https://rkiselenko.dev/blog/development-on-mac-with-utm/development-on-mac-with-lima/"
              >Development on Apple Silicon with UTM</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 10:28:31</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43714959"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43714902">
          <h3>
            <a class="item" href="https://nickjones.tech/ai-watching-rugby/"
              >Building an AI That Watches Rugby</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 10:18:43</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43714902"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43714619">
          <h3>
            <a
              class="item"
              href="https://www.tokyoweekender.com/art_and_culture/japanese-culture/oda-ujiharu-the-weakest-samurai-warlord/"
              >Why Japan's "Weakest Samurai Warlord" Is Still Admired to This
              Day</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 09:30:43</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43714619"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43714594">
          <h3>
            <a class="item" href="http://uniforumchicago.org/slides/bash1.pdf"
              >Advanced Shell Scripting with Bash (2006) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 09:26:45</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43714594"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43714476">
          <h3>
            <a
              class="item"
              href="https://www.goto10retro.com/p/the-atari-1200xl-fiasco"
              >The Atari 1200XL Fiasco – By Paul Lefebvre</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 09:01:07</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43714476"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43714203">
          <h3>
            <a
              class="item"
              href="https://www.skyatnightmagazine.com/news/k2-18b-dimethyl-sulfide"
              >“Most promising signs yet” of alien life on a planet beyond our
              Solar System</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 08:02:21</span
              ><span class="points-container"
                >Points: <span class="points">290</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43714203"
                  >Comments</a
                ><span class="descendants">: 215</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43714004">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2504.12285"
              >BitNet b1.58 2B4T Technical Report</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 07:27:11</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43714004"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43713885">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/formance/jobs"
              >Formance (YC S21) Is Hiring Engineers to Build OSS Financial
              Infrastructure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 07:00:25</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43713524">
          <h3>
            <a
              class="item"
              href="https://www.windytan.com/2025/04/passing-planes-and-other-whoosh-sounds.html"
              >Passing planes and other whoosh sounds</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 05:53:31</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43713524"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43713140">
          <h3>
            <a class="item" href="https://thenumb.at/Autodiff/"
              >Differentiable Programming from Scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 04:30:47</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43713140"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43711957">
          <h3>
            <a class="item" href="https://status.zoom.us/incidents/pw9r9vnq5rvk"
              >Zoom outage caused by accidental 'shutting down' of the zoom.us
              domain</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-17 @ 00:55:49</span
              ><span class="points-container"
                >Points: <span class="points">427</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43711957"
                  >Comments</a
                ><span class="descendants">: 205</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43711001">
          <h3>
            <a
              class="item"
              href="https://worldhistory.substack.com/p/how-a-forgotten-battle-created-a"
              >How a Forgotten Battle Created a More Peaceful World</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-16 @ 22:21:14</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43711001"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43710576">
          <h3>
            <a class="item" href="https://github.com/plandex-ai/plandex"
              >Show HN: Plandex v2 – open source AI coding agent for large
              projects and tasks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-16 @ 21:26:42</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43710576"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/plandex-ai/plandex"
                >https://github.com/plandex-ai/plandex</a
              >), an open source AI coding agent focused especially on tackling
              large tasks in real world software projects.
              <p>
                You can watch a 2 minute demo of Plandex in action here:
                <a href="https://www.youtube.com/watch?v=SFSu2vNmlLk"
                  >https://www.youtube.com/watch?v=SFSu2vNmlLk</a
                >
              </p>
              <p>
                And here’s more of a tutorial style demo showing how Plandex can
                automatically debug a browser application:
                <a href="https://www.youtube.com/watch?v=g-_76U_nK0Y"
                  >https://www.youtube.com/watch?v=g-_76U_nK0Y</a
                >.
              </p>
              <p>
                I launched Plandex v1 here on HN a little less than a year ago
                (<a href="https://news.ycombinator.com/item?id=39918500"
                  >https://news.ycombinator.com/item?id=39918500</a
                >).
              </p>
              <p>
                Now I’m launching a major update, Plandex v2, which is the
                result of 8 months of heads down work, and is in effect a whole
                new project/product.
              </p>
              <p>
                In short, Plandex is now a top-tier coding agent with fully
                autonomous capabilities. It combines models from Anthropic,
                OpenAI, and Google to achieve better results, more reliable
                agent behavior, better cost efficiency, and better performance
                than is possible by using only a single provider’s models.
              </p>
              <p>
                I believe it is now one of the best tools available for working
                on large tasks in real world codebases with AI. It has an
                effective context window of 2M tokens, and can index projects of
                20M tokens and beyond using tree-sitter project maps (30+
                languages are supported). It can effectively find relevant
                context in massive million-line projects like SQLite, Redis, and
                Git.
              </p>
              <p>A bit more on some of Plandex’s key features:</p>
              <p>
                - Plandex has a built-in diff review sandbox that helps you get
                the benefits of AI without leaving behind a mess in your
                project. By default, all changes accumulate in the sandbox until
                you approve them. The sandbox is version-controlled. You can
                rewind it to any previous point, and you can also create
                branches to try out alternative approaches.
              </p>
              <p>
                - It offers a ‘full auto mode’ that can complete large tasks
                autonomously end-to-end, including high level planning, context
                loading, detailed planning, implementation, command execution
                (for dependencies, builds, tests, etc.), and debugging.
              </p>
              <p>
                - The autonomy level is highly configurable. You can move up and
                down the ladder of autonomy depending on the task, your comfort
                level, and how you weigh cost optimization vs. effort and
                results.
              </p>
              <p>
                - Models and model settings are also very configurable. There
                are built-in models and model packs for different use cases. You
                can also add custom models and model packs, and customize model
                settings like temperature or top-p. All model changes are
                version controlled, so you can use branches to try out the same
                task with different models. The newly released OpenAI models and
                the paid Gemini 2.5 Pro model will be integrated in the default
                model pack soon.
              </p>
              <p>
                - It can be easily self-hosted, including a ‘local mode’ for a
                very fast local single-user setup with Docker.
              </p>
              <p>
                - Cloud hosting is also available for added convenience with a
                couple of subscription tiers: an ‘Integrated Models’ mode that
                requires no other accounts or API keys and allows you to manage
                billing/budgeting/spending alerts and track usage centrally, and
                a ‘BYO API Key’ mode that allows you to use your own
                OpenAI/OpenRouter accounts.
              </p>
              <p>
                I’d love to get more HNers in the Plandex Discord (<a
                  href="https://discord.gg/plandex-ai"
                  >https://discord.gg/plandex-ai</a
                >). Please join and say hi!
              </p>
              <p>
                And of course I’d love to hear your feedback, whether positive
                or negative. Thanks so much!
              </p>
            </div>
          </section>
        </section>
        <section id="43709770">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2022/08/man-who-built-isp-instead-of-paying-comcast-50k-expands-to-hundreds-of-homes/"
              >Man who built ISP instead of paying Comcast expands to hundreds
              of homes (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-16 @ 20:06:50</span
              ><span class="points-container"
                >Points: <span class="points">491</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43709770"
                  >Comments</a
                ><span class="descendants">: 195</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43708025">
          <h3>
            <a class="item" href="https://github.com/openai/codex"
              >OpenAI Codex CLI: Lightweight coding agent that runs in your
              terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-16 @ 17:24:50</span
              ><span class="points-container"
                >Points: <span class="points">447</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43708025"
                  >Comments</a
                ><span class="descendants">: 245</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43707021">
          <h3>
            <a
              class="item"
              href="https://github.com/harishsg993010/damn-vulnerable-MCP-server"
              >Damn Vulnerable MCP Server</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-16 @ 16:00:21</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43707021"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43706037">
          <h3>
            <a
              class="item"
              href="https://theappendix.net/posts/2014/02/darwins-children-drew-vegetable-battles-on-the-origin-of-species"
              >Darwin's children drew all over the “On the Origin of Species”
              manuscript (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-16 @ 14:28:36</span
              ><span class="points-container"
                >Points: <span class="points">434</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43706037"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43704904">
          <h3>
            <a
              class="item"
              href="https://microsoft.design/articles/introducing-kermit-a-typeface-for-kids/"
              >Kermit: A typeface for kids</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-16 @ 12:57:13</span
              ><span class="points-container"
                >Points: <span class="points">334</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43704904"
                  >Comments</a
                ><span class="descendants">: 160</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43699271">
          <h3>
            <a
              class="item"
              href="https://github.com/humanlayer/12-factor-agents"
              >12-factor Agents: Patterns of reliable LLM applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-15 @ 22:38:04</span
              ><span class="points-container"
                >Points: <span class="points">369</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43699271"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
            <div class="text">
              <p>
                So I set out to document what I've learned about building
                production-grade AI systems:
                <a href="https://github.com/humanlayer/12-factor-agents"
                  >https://github.com/humanlayer/12-factor-agents</a
                >. It's a set of principles for building LLM-powered software
                that's reliable enough to put in the hands of production
                customers.
              </p>
              <p>
                In the spirit of Heroku's 12 Factor Apps (<a
                  href="https://12factor.net/"
                  >https://12factor.net/</a
                >), these principles focus on the engineering practices that
                make LLM applications more reliable, scalable, and maintainable.
                Even as models get exponentially more powerful, these core
                techniques will remain valuable.
              </p>
              <p>
                I've seen many SaaS builders try to pivot towards AI by building
                greenfield new projects on agent frameworks, only to find that
                they couldn't get things past the 70-80% reliability bar with
                out-of-the-box tools. The ones that did succeed tended to take
                small, modular concepts from agent building, and incorporate
                them into their existing product, rather than starting from
                scratch.
              </p>
              <p>
                The full guide goes into detail on each principle with examples
                and patterns to follow. I've seen these practices work well in
                production systems handling real user traffic.
              </p>
              <p>
                I'm sharing this as a starting point—the field is moving quickly
                so these principles will evolve. I welcome your feedback and
                contributions to help figure out what "production grade" means
                for AI systems!
              </p>
            </div>
          </section>
        </section>
        <section id="43697717">
          <h3>
            <a
              class="item"
              href="https://knightcolumbia.org/content/ai-as-normal-technology"
              >AI as Normal Technology</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-15 @ 20:05:07</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43697717"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43693900">
          <h3>
            <a
              class="item"
              href="https://www.digicert.com/blog/tls-certificate-lifetimes-will-officially-reduce-to-47-days"
              >TLS certificate lifetimes will officially reduce to 47 days</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-15 @ 15:09:22</span
              ><span class="points-container"
                >Points: <span class="points">487</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43693900"
                  >Comments</a
                ><span class="descendants">: 588</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43688131">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2025/04/14/miscellaneous-mathematical-symbols/"
              >Miscellaneous Mathematical Symbols</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-15 @ 01:30:21</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43688131"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43680715">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-03-cleaner-future-scientists-chemical-repurpose.html"
              >Scientists pioneer chemical process to repurpose rubber waste</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-14 @ 12:48:40</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43680715"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43679906">
          <h3>
            <a
              class="item"
              href="https://bitbashing.io/haskell-concurrency.html"
              >Concurrency in Haskell: Fast, Simple, Correct</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-14 @ 10:47:32</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43679906"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43678144">
          <h3>
            <a class="item" href="https://www.makingsoftware.com/"
              >Making Software</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-14 @ 04:48:54</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43678144"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43678138">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41586-024-08165-7"
              >Adipose tissue retains an epigenetic memory of obesity after
              weight loss</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-14 @ 04:47:51</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43678138"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43674892">
          <h3>
            <a
              class="item"
              href="https://funnyhow.substack.com/p/clowning-around-"
              >Clowning Around: On the Principles of Clowning</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-13 @ 18:41:54</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43674892"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
