<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37969387">
          <h3>
            <a
              class="item"
              href="https://cointelegraph.com/news/reddit-mods-dumped-tokens-hours-before-blockchain-program-termination"
              >Reddit mods dumped tokens hours before blockchain program
              termination</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 18:38:45</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37969387"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37969248">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2023/10/adtech-surveillance-and-government-surveillance-are-often-same-surveillance"
              >Adtech surveillance and government surveillance are often the
              same</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 18:22:32</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37969248"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37968900">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/climate-environment/2023/10/21/plants-talk-warning-danger/"
              >How plants communicate with each other when in danger</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 17:37:34</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37968900"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37968598">
          <h3>
            <a class="item" href="https://bldgblog.com/2010/01/nakatomi-space/"
              >Nakatomi Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 17:08:17</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37968598"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37968534">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37968534"
              >GoGoGrandparent (YC S16) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 17:00:39</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                The position: FULLY REMOTE | Full-time | US, UK, or able to work
                4+ hours overlap with mainland US (UK time working hours also
                OK) | $100k to $120k
              </p>
              <p>
                Build high-quality, robust engineering at the rarest of things -
                a Silicon Valley startup that is both wholesome AND profitable.
                We have 8-figure revenue, are YC-backed, and growing fast.
              </p>
              <p>
                Tech stack (<i>required): Back-end heavy (Node</i>, Typescript<i
                  >, MySQL</i
                >, REST*+GraphQL), front-end (Vue), deploy (AWS, Docker/K8s)
              </p>
              <p>
                Minimum 6 years experience (mostly Node). If full-stack, you
                must be strongest on the backend.
              </p>
              <p>2-stage interview process.</p>
              <p>
                If you want to help older adults and people with disabilities,
                send your LinkedIn/CV to william@gogograndparent.com (keep it
                brief) or apply at
                <a
                  href="https://www.ycombinator.com/companies/gogograndparent/jobs"
                  >https://www.ycombinator.com/companies/gogograndparent/jobs</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="37968115">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2310.10860"
              >Solvable statistical physics models for large neuronal
              populations</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 16:19:37</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37968115"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37967990">
          <h3>
            <a
              class="item"
              href="https://www.ogre3d.org/2023/09/12/ogre-14-1-released"
              >Ogre 14.1 Released</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 16:06:34</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37967990"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37967936">
          <h3><a class="item" href="http://www.ultrafp64.com/">FPGA N64</a></h3>
          <section>
            <h4>
              <span>2023-10-21 @ 16:01:45</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37967936"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37967800">
          <h3>
            <a
              class="item"
              href="https://github.com/rochus-keller/OberonSystem3"
              >Oberon System 3</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 15:50:44</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37967800"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37967751">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/why-chinese-minds-still-bear-the-long-shadow-of-keju"
              >Keju, China’s difficult civil service test</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 15:46:40</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37967751"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37967748">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41564-023-01426-7"
              >Human microbiome myths and misconceptions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 15:46:09</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37967748"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37967493">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/fish-skin-can-heal-other-animals-eye-injuries/"
              >Fish skin can heal other animals' eye injuries</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 15:15:38</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37967493"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37967257">
          <h3>
            <a
              class="item"
              href="https://thephd.dev/c-undefined-behavior-and-the-sledgehammer-guideline"
              >Undefined Behavior, and the Sledgehammer Principle</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 14:51:44</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37967257"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37967126">
          <h3>
            <a
              class="item"
              href="https://codeconfessions.substack.com/p/gpu-computing"
              >What every developer should know about GPU computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 14:36:47</span
              ><span class="points-container"
                >Points: <span class="points">258</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37967126"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37967010">
          <h3>
            <a class="item" href="https://www.hackreels.com/"
              >Show HN: Hackreels – Animate your code in HD</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 14:24:30</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37967010"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text"><p>Let me know if anyone has feedback!</p></div>
          </section>
        </section>
        <section id="37966569">
          <h3>
            <a
              class="item"
              href="https://www.notebookcheck.net/MrWhosetheboss-video-reveals-Google-s-Pixel-8-Pro-Tensor-G3-off-loads-all-generative-AI-tasks-to-the-cloud.760215.0.html"
              >The Pixel 8 Pro's Tensor G3 off-loads all generative AI tasks to
              the cloud</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 13:14:15</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37966569"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37966485">
          <h3>
            <a
              class="item"
              href="https://www.germanvelasco.com/blog/refactoring-is-a-habit"
              >Refactoring has a price, not refactoring has a cost</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 13:02:14</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37966485"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37966367">
          <h3>
            <a
              class="item"
              href="https://petapixel.com/2023/10/20/darren-aronofsky-says-it-takes-12-people-to-use-the-18k-sphere-camera/"
              >It takes 12 people to use the 18k Sphere camera</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 12:45:12</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37966367"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37965319">
          <h3>
            <a
              class="item"
              href="https://www.epsio.io/blog/how-to-create-a-streaming-sql-engine"
              >We Built a Streaming SQL Engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 09:26:39</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37965319"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37965217">
          <h3>
            <a class="item" href="https://go-app.dev"
              >Go Package for Building Progressive Web Apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 08:59:33</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37965217"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37964999">
          <h3><a class="item" href="https://o3de.org/">O3DE</a></h3>
          <section>
            <h4>
              <span>2023-10-21 @ 08:09:05</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37964999"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37964878">
          <h3>
            <a class="item" href="https://github.com/antonblanchard/microwatt"
              >Microwatt: A tiny Open POWER ISA softcore written in VHDL 2008</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 07:40:42</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37964878"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37964829">
          <h3>
            <a class="item" href="https://github.com/susam/cfr"
              >CFR[] is a very minimal drawing language with 5 simple commands:
              C, F, R, [, ]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 07:28:56</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37964829"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37964682">
          <h3>
            <a
              class="item"
              href="https://www.nngroup.com/articles/common-knowledge-effect/"
              >Common-knowledge effect: A bias in team decision making</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 06:51:42</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37964682"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37964575">
          <h3>
            <a class="item" href="https://www.the7thguest-vr.com/"
              >The 7th Guest gets VR remake using volumetric video</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 06:28:53</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37964575"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37964292">
          <h3>
            <a
              class="item"
              href="https://www.australiangeographic.com.au/topics/history-culture/2023/10/stories-told-by-aboriginal-tasmanians-could-be-oldest-recorded-in-the-world/"
              >Stories told by Aboriginal Tasmanians could be oldest recorded</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 05:19:10</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37964292"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37963731">
          <h3>
            <a
              class="item"
              href="https://thepointmag.com/criticism/perilous-joy/"
              >Perilous Joy: George Eliot and the marriage question</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-21 @ 03:03:15</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37963731"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37958765">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37958765"
              >Ask HN: How to do transactional SMS as a bootstrapped or startup
              company?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-20 @ 17:10:17</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37958765"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
            <div class="text">
              <p>
                Now, ì do not want to get into Tier 2 also as the API approach
                ad DX is not available compared to how it is with Tier1. Also I
                don’t want to risk my customers phone numbers with providers who
                do not have good support and privacy handling features.
              </p>
              <p>
                There are couple or more apps that I am building where I like
                the simplicity of SMS. I don’t have to request for push
                notification permissions, I do not need an app on the stores to
                push relevant info and updates. Most basic User signup. If user
                does not want to use the phone, then maybe the service is not
                for them. And then occasional updates on Direct messages on the
                platform. (Order completion, delivery instructions, Direct
                Messages from users etc.) I see most of these as small messages
                only if they ever did take actions on the platform.
              </p>
              <p>
                However, based on my initial calculations, even with 1000 users
                signing up. Allowing SMS code input and DM messages or info
                messages, these can reach a number of close to 300 to 500 Euros
                or Dollars monthly. This is including alpa numeric sending
                options. Where I do not allow messages to be replied back.
              </p>
              <p>
                When I started programming SMS was the cheapest option. Now I
                feel it has become expensive However I still see small and big
                companies using these options. 1. Are there other alternatives I
                am not seeing? 2. Since my volume of push and sending is low, I
                do not want to ask users push notification and scare them away
                3. What other options can we see here.
              </p>
            </div>
          </section>
        </section>
        <section id="37956065">
          <h3>
            <a class="item" href="https://susam.net/cfr.html"
              >Show HN: CFR[]: Very minimal drawing language with 5 commands: C,
              F, R, [, ]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-20 @ 13:56:48</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37956065"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37953943">
          <h3>
            <a
              class="item"
              href="https://www.neh.gov/humanities/2008/septemberoctober/iq/impertinent-questions-kristine-harper"
              >Impertinent Questions with Kristine Harper (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-20 @ 09:22:34</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37953943"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
