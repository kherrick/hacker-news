<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46751835">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2026/01/23/tech/translation-language-jobs-ai-automation-intl"
              >Like digging 'your own grave': The translators grappling with
              losing work to AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 08:08:43</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46751835"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46750937">
          <h3>
            <a
              class="item"
              href="https://xr0am.substack.com/p/what-ralph-wiggum-loops-are-missing"
              >What Ralph Wiggum loops are missing</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 05:09:38</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46750937"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46750437">
          <h3>
            <a class="item" href="https://github.com/mroboff/vm-curator"
              >Show HN: VM-curator – a TUI alternative to libvirt and
              virt-manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 03:36:38</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46750437"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>
                Behold, vm-curator! A fast and friendly VM management TUI
                written in Rust. You can create, configure, organize, and manage
                VMs directly with QEMU. No libvert. No XML. No wonky UI's. Just
                the right level of friendliness, customization, and speed to be
                really really useful.
              </p>
              <p>
                The best part? 3D para-virtualization works with NVIDIA cards
                (via virtio-vga-gl!) No jumping through hoops to get GPU
                passthrough working!
              </p>
              <p>
                (Disclaimer: This works great with other guest Linux VMs, but is
                not suitable for Windows gaming. If you want to game on Windows
                within a VM, passthrough is a must. vm-curator will have fast
                and friendly support soon.)
              </p>
              <p>
                Looking for contributors (especially to help with the ascii
                art,) and donations are welcome. (Claude was a big help, but
                this was not a vibe-coded affair. We pair-programmed approx.
                10,000 lines of code here. It was a great way to learn Rust,
                actually!)
              </p>
            </div>
          </section>
        </section>
        <section id="46750425">
          <h3>
            <a
              class="item"
              href="https://github.com/NVIDIA/open-gpu-kernel-modules/issues/971"
              >Nvidia-smi hangs indefinitely after ~66 days</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 03:33:20</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46750425"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46750358">
          <h3>
            <a
              class="item"
              href="https://www.windowscentral.com/microsoft/windows-11/windows-11-second-emergency-out-of-band-update-kb5078127-released-address-outlook-bugs"
              >Second Win11 emergency out of band update to address disastrous
              Patch Tuesday</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 03:17:43</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46750358"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46750214">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2601.05047"
              >David Patterson: Challenges and Research Directions for LLM
              Inference Hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 02:48:36</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46750214"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46749671">
          <h3>
            <a
              class="item"
              href="https://essenceia.github.io/projects/two_weeks_until_tapeout/"
              >Two Weeks Until Tapeout</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 01:25:37</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46749671"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46749198">
          <h3>
            <a
              class="item"
              href="https://keck.usc.edu/news/adoption-of-electric-vehicles-tied-to-real-world-reductions-in-air-pollution-study-finds/"
              >Adoption of EVs tied to real-world reductions in air pollution:
              study</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 00:14:40</span
              ><span class="points-container"
                >Points: <span class="points">349</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46749198"
                  >Comments</a
                ><span class="descendants">: 274</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46749053">
          <h3>
            <a
              class="item"
              href="https://eclypsium.com/blog/xray-counterfeit-usb-cable/"
              >We X-Rayed a Suspicious FTDI USB Cable</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 23:55:10</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46749053"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46747827">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/security/2026/01/wiper-malware-targeted-poland-energy-grid-but-failed-to-knock-out-electricity/"
              >Poland's energy grid was targeted by never-before-seen wiper
              malware</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 21:24:13</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46747827"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46747625">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/gym-class-by-irl-studios/jobs/ywXHGBv-design-engineer-senior-staff-principal"
              >First Design Engineer Hire – Build Games at Gym Class (YC W22)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 21:01:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46747366">
          <h3>
            <a
              class="item"
              href="https://micahcantor.com/blog/bluesky-comment-section.html"
              >I added a Bluesky comment section to my blog</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 20:33:40</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46747366"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46747119">
          <h3>
            <a
              class="item"
              href="https://albedo.com/post/clarity-1-what-worked-and-where-we-go-next"
              >Postmortem: Our first VLEO satellite mission (with imagery and
              flight data)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 20:03:39</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46747119"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46746681">
          <h3>
            <a class="item" href="https://substack.com/inbox/post/185649875"
              >Agent orchestration for the timid</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 19:25:53</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46746681"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46746476">
          <h3>
            <a
              class="item"
              href="https://www.birdy.chat/blog/first-to-interoperate-with-whatsapp"
              >BirdyChat becomes first European chat app that is interoperable
              with WhatsApp</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 19:04:08</span
              ><span class="points-container"
                >Points: <span class="points">548</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46746476"
                  >Comments</a
                ><span class="descendants">: 333</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46746266">
          <h3>
            <a
              class="item"
              href="https://antoine.vandecreme.net/blog/rust-closures/"
              >Understanding Rust Closures</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 18:42:13</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46746266"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46745922">
          <h3>
            <a
              class="item"
              href="https://the-diy-life.com/raspberry-pi-drag-race-pi-1-to-pi-5-performance-comparison/"
              >Raspberry Pi Drag Race: Pi 1 to Pi 5 – Performance Comparison</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 18:06:00</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46745922"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46744807">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46744807"
              >Ask HN: Gmail spam filtering suddenly marking everything as
              spam?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 16:16:02</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46744807"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
            <div class="text">
              Almost all transactional emails are being marked as suspicious
              even when their SPF/DKIM records are fine and they’ve been
              whitelisted before. Did Google break something in gmail/spam
              filtering?
            </div>
          </section>
        </section>
        <section id="46744647">
          <h3>
            <a
              class="item"
              href="https://raymondtana.github.io/math/programming/2026/01/23/zig-alignment-and-sizing.html"
              >Memory layout in Zig with formulas</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 15:57:45</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46744647"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46743908">
          <h3>
            <a
              class="item"
              href="https://twitter.com/NicerInPerson/status/2014989679796347375"
              >Claude Code's new hidden feature: Swarms</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 14:35:47</span
              ><span class="points-container"
                >Points: <span class="points">391</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46743908"
                  >Comments</a
                ><span class="descendants">: 264</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://xcancel.com/NicerInPerson/status/2014989679796347375"
                >https://xcancel.com/NicerInPerson/status/2014989679796347375</a
              >
              <p>
                <a href="https://github.com/mikekelly/claude-sneakpeek"
                  >https://github.com/mikekelly/claude-sneakpeek</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46741923">
          <h3>
            <a class="item" href="https://sharedclaude.com/"
              >Shared Claude: A website controlled by the public</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-24 @ 08:15:02</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46741923"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46737202">
          <h3>
            <a class="item" href="http://www.jamisbuck.org/mazes/"
              >Maze Algorithms (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 20:07:49</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46737202"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46721421">
          <h3>
            <a class="item" href="https://raku.land/zef:l10n/L10N::CY"
              >Draig, a Welsh Programming Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-22 @ 16:27:22</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46721421"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46700384">
          <h3>
            <a
              class="item"
              href="https://blocksandfiles.com/2026/01/19/a-window-into-hbf-progress/"
              >High-bandwidth flash progress and future</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 02:17:36</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46700384"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46699697">
          <h3>
            <a
              class="item"
              href="https://ikennd.ac/blog/2026/01/old-man-yells-at-modern-software-design/"
              >A Lament for Aperture</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 00:35:01</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46699697"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46697876">
          <h3>
            <a
              class="item"
              href="https://www.presentandcorrect.com/blogs/blog/typography-on-pencils-1-5"
              >Typography on Pencils (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 21:18:26</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46697876"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46693460">
          <h3>
            <a
              class="item"
              href="https://modulovalue.com/blog/syscall-overhead-tar-gz-io-performance/"
              >I built a 2x faster lexer, then discovered I/O was the real
              bottleneck</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 16:10:01</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46693460"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46691963">
          <h3>
            <a
              class="item"
              href="https://blog.videowatermarkremove.com/the-temporal-consistency-challenge-from-optical-flow-to-spatiotemporal-ai-in-video-restoration"
              >The Temporal Consistency Challenge in Video Restoration</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 14:07:39</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46691963"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46690779">
          <h3>
            <a
              class="item"
              href="https://blog.tansu.io/articles/broker-aws-free-tier"
              >Small Kafka: Tansu and SQLite on a free t3.micro</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 11:38:31</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46690779"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46688804">
          <h3>
            <a
              class="item"
              href="https://www.androidauthority.com/google-sideloading-android-high-friction-process-3633468/"
              >Google confirms 'high-friction' sideloading flow is coming to
              Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 07:04:53</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46688804"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
