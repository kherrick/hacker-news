<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38539174">
          <h3>
            <a class="item" href="https://research.swtch.com/testing"
              >Russ Cox: Go Testing by Example</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 00:58:14</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38539174"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38538886">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/thermoelectric-heating"
              >Thermoelectric Heating Comes in from the Cold</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 00:24:48</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38538886"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38538487">
          <h3>
            <a
              class="item"
              href="https://www.tecton.ai/blog/high-scale-feature-serving-at-low-cost-with-caching-machine-learning/"
              >High-Scale AI/ML Feature Serving at Low Cost with Caching</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 23:38:48</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38538487"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38538162">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2023/12/playstation-is-erasing-1318-seasons-of-discovery-shows-from-customer-libraries/"
              >Playstation is erasing 1,318 seasons of Discovery shows from
              customer libraries</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 23:01:57</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38538162"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38538123">
          <h3>
            <a
              class="item"
              href="https://www.nordinvestimentos.com.br/blog/governador-do-amazonas/"
              >Governor of Amazonas wants to charge Amazon royalties for use of
              the brand</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 22:57:45</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38538123"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38538100">
          <h3>
            <a
              class="item"
              href="https://android-developers.googleblog.com/2023/12/virtual-machines-as-core-android-primitive.html"
              >Virtual Machine as a Core Android Primitive</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 22:55:51</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38538100"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38537977">
          <h3>
            <a
              class="item"
              href="https://twitter.com/OldRowSwig/status/1732112446943269347?s=20"
              >Report: YouTube adding user-traceable ID tag to links shared
              off-platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 22:44:41</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38537977"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38537933">
          <h3>
            <a
              class="item"
              href="https://journals.sagepub.com/doi/10.1177/01461672231209400"
              >Cognitive Ability and Miscalibrated Financial Expectations</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 22:41:09</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38537933"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38537682">
          <h3>
            <a class="item" href="https://stylexjs.com/"
              >StyleX – Meta's styling library</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 22:14:05</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38537682"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38536681">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2312.02120"
              >Magicoder: Source Code Is All You Need</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 20:46:05</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38536681"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38534920">
          <h3>
            <a class="item" href="https://github.com/DropbaseHQ/dropbase"
              >Show HN: Dropbase – Build internal web apps with just Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 18:25:47</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38534920"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.dropbase.io">https://www.dropbase.io</a>). We
              are an internal tools builder for Python developers. All you have
              to do is import any Python scripts/libraries, declare UI
              components, and layer app permissions so you can share them with
              others.
              <p>
                We’re a middle ground between Airplane and Retool—simpler UI
                creation than Airplane, more code-centered than Retool. UI
                building is declarative and you can bind Python
                scripts/functions to UI components. You can write Python
                scripts/functions using our App Studio with support from a
                Python Language Server Protocol (LSP) for linting. Since the
                self-hosted worker directly references .py or .sql files in the
                filesystem, you can even write them on VSCode directly or import
                any other Python script or library.
              </p>
              <p>
                Our app layout is highly opinionated to speed up app building.
                Instead of an open canvas for UI building, we just give you a
                main table view and a widget sidebar. This approach
                significantly reduces app-building time while still covering
                what most tools need: see some data and take actions based on
                it. It’s not flexible enough to do absolutely anything, but
                that’s the point—there’s a tradeoff between flexibility and
                speed. Dropbase gives you most of what you need, plus speed!
              </p>
              <p>
                A neat feature we are experimenting with to build admin panels
                fast is “Smart Tables”. We convert any SQL SELECT statement
                (even across multiple joins and filters) into an inline editable
                table, like spreadsheets, without any additional code.
              </p>
              <p>
                We have a hybrid hosting model that combines a self-hosted
                client and a worker server, with a backend API for app/component
                definitions hosted by us to simplify pushing feature updates.
                The worker server sits in your machines so your sensitive data
                doesn’t leave your infra.
              </p>
              <p>
                We’re Python-centric for now, but plan to add support for Rust,
                Go, and others later.
              </p>
              <p>
                We made a few demo videos building common tools: - Customer
                approval tool:
                <a href="https://youtu.be/A1MIIRNkv3Q"
                  >https://youtu.be/A1MIIRNkv3Q</a
                >
                - Data editing tool (with Smart Table):
                <a href="https://youtu.be/R1cHO9lMRXo"
                  >https://youtu.be/R1cHO9lMRXo</a
                >
              </p>
              <p>
                To try Dropbase, create an account at
                <a href="https://app.dropbase.io">https://app.dropbase.io</a>
                and generate a token, then follow these instructions for local
                setup:
                <a href="https://docs.dropbase.io/setup/developer"
                  >https://docs.dropbase.io/setup/developer</a
                >.
              </p>
              <p>
                We are very early so we're really excited to get your feedback,
                especially on our approach to tools building with Python! My
                co-founder Ayazhan and some of our teammates will be around to
                answer questions.
              </p>
            </div>
          </section>
        </section>
        <section id="38534227">
          <h3>
            <a
              class="item"
              href="https://tedium.co/2023/11/17/3m-floppy-disks-history/"
              >Why 3M stopped making floppy disks in the '90s</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 17:41:32</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38534227"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38533533">
          <h3>
            <a
              class="item"
              href="https://signoz.io/careers/site-reliability-engineer/"
              >SigNoz (YC W21), Open Source Datadog, Is Hiring SREs (Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 17:00:53</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38533105">
          <h3>
            <a
              class="item"
              href="https://generallyintelligent.substack.com/p/fine-tuning-mistral-7b-on-magic-the"
              >Fine-tuning Mistral 7B on Magic the Gathering Draft</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 16:33:58</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38533105"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38532914">
          <h3>
            <a
              class="item"
              href="https://sandstorm.org/news/2023-12-05-osm-on-sandstorm"
              >Show HN: Desert Atlas, a self-hosted OpenStreetMap app for
              Sandstorm</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 16:23:23</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38532914"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                This project release is a long time coming. It was a big uphill
                battle, and by far my largest endeavor so far. I built it for
                Sandstorm because I believe in Sandstorm's model, and I wanted
                to show that there's still life and potential in it. If you're
                inspired, joining our OpenCollective would be really helpful:
                <a href="https://opencollective.com/sandstormcommunity"
                  >https://opencollective.com/sandstormcommunity</a
                >
                (keeping in mind that Sandstorm has now moved from its original
                leadership to a community project
                <a href="https://sandstorm.org/news/2023-11-03-from-io-to-org"
                  >https://sandstorm.org/news/2023-11-03-from-io-to-org</a
                >).
              </p>
              <p>
                You can also join our mailing list or connect on the fediverse:
                <a href="https://sandstorm.org/community"
                  >https://sandstorm.org/community</a
                >
                (The IRC link is outdated, we've effectively moved to Matrix for
                now due to the libera.chat split:
                <a href="https://matrix.to/#/#sandstorm:libera.chat"
                  >https://matrix.to/#/#sandstorm:libera.chat</a
                >)
              </p>
              <p>
                Also: I'm open for hire! You can see some of my skills in
                putting things together in this blog post. I'd love to work in
                something FOSS or OSM related, but not a requirement. I mostly
                do Python and Golang, with a bit of Haskell under my belt. Other
                projects and resume here:
                <a href="https://github.com/orblivion/me"
                  >https://github.com/orblivion/me</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="38532761">
          <h3>
            <a class="item" href="https://commonvoice.mozilla.org/en"
              >Common Voice</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 16:13:10</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38532761"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38532167">
          <h3>
            <a
              class="item"
              href="https://jjtech.dev/reverse-engineering/imessage-explained/"
              >iMessage, explained</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 15:33:23</span
              ><span class="points-container"
                >Points: <span class="points">426</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38532167"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38531759">
          <h3>
            <a class="item" href="https://www.beeper.com/"
              >Show HN: Beeper Mini – iMessage Client for Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 15:06:21</span
              ><span class="points-container"
                >Points: <span class="points">977</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38531759"
                  >Comments</a
                ><span class="descendants">: 623</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://play.google.com/store/apps/details?id=com.beeper.ima"
                >https://play.google.com/store/apps/details?id=com.beeper.ima</a
              >
              and there's a technical writeup here:
              <a href="https://blog.beeper.com/p/how-beeper-mini-works"
                >https://blog.beeper.com/p/how-beeper-mini-works</a
              >.
              <p>
                Unlike every other attempt to build an iMessage app for Android
                (including our first gen app), Beeper Mini does not use a Mac
                server relay in the cloud. The app connects directly to Apple
                servers to send and receive end-to-end encrypted messages.
                Encryption keys never leave your device. No Apple ID is
                required. Beeper does not have access to your Apple account.
              </p>
              <p>
                With Beeper Mini, your Android phone number is registered on
                iMessage. You show up as a ‘blue bubble’ when iPhone friends
                text you, and can join real iMessage group chats. All chat
                features like typing status, read receipts, full resolution
                images/video, emoji reactions, voice notes, editing/unsending,
                stickers etc are supported.
              </p>
              <p>
                This is all unprecedented, so I imagine you may have a lot of
                questions. We’ve written a detailed technical blog post about
                how Beeper Mini works:
                <a href="https://blog.beeper.com/p/how-beeper-mini-works"
                  >https://blog.beeper.com/p/how-beeper-mini-works</a
                >. A team member has published an open source Python iMessage
                protocol PoC on Github:
                <a href="https://github.com/JJTech0130/pypush"
                  >https://github.com/JJTech0130/pypush</a
                >. You can try it yourself on any Mac/Windows/Linux computer and
                see how iMessage works. My cofounder and I are also here to
                answer questions in the comments.
              </p>
              <p>
                Our long term vision is to build a universal chat app (<a
                  href="https://blog.beeper.com/p/were-building-the-best-chat-app-on"
                  >https://blog.beeper.com/p/were-building-the-best-chat-app-on</a
                >). Over the next few months, we will be adding support for
                SMS/RCS, WhatsApp, Signal and 12 other chat networks into Beeper
                Mini. At that point, we’ll drop the `Mini` postfix. We’re also
                rebuilding our Beeper Desktop and iOS apps to support our new
                ‘client-side bridge’ architecture that preserves full end-to-end
                encryption. We’re also renaming our first gen apps to ‘Beeper
                Cloud’ to more clearly differentiate them from Beeper Mini.
              </p>
              <p>
                Side note: many people always ask ‘what do you think Apple is
                going to do about this?’ To be honest, I am shocked that
                everyone is so shocked by the sheer existence of a 3rd party
                iMessage client. The internet has always had 3rd party clients!
                It’s almost like people have forgotten that iChat (the app that
                iMessage grew out of) was itself a multi-protocol chat app! It
                supported AIM, Jabber and Google talk. Here’s a blast from the
                past:
                <a href="https://i.imgur.com/k6rmOgq.png"
                  >https://i.imgur.com/k6rmOgq.png</a
                >.
              </p>
            </div>
          </section>
        </section>
        <section id="38531604">
          <h3>
            <a class="item" href="https://how-did-i-get-here.net/"
              >Show HN: How did your computer reach my server?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 14:56:25</span
              ><span class="points-container"
                >Points: <span class="points">483</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38531604"
                  >Comments</a
                ><span class="descendants">: 113</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38531428">
          <h3>
            <a
              class="item"
              href="https://www.cameronmacleod.com/blog/how-does-shazam-work"
              >How does Shazam work? (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 14:44:39</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38531428"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38530948">
          <h3>
            <a class="item" href="https://yutongbai.com/lvm.html"
              >Sequential modeling enables scalable learning for large vision
              models</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 14:14:21</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38530948"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38530885">
          <h3>
            <a
              class="item"
              href="https://social.hackerspace.pl/@q3k/111528162462505087"
              >Polish trains lock up when serviced in third-party workshops</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 14:10:12</span
              ><span class="points-container"
                >Points: <span class="points">845</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38530885"
                  >Comments</a
                ><span class="descendants">: 262</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38530466">
          <h3>
            <a
              class="item"
              href="https://academic.oup.com/pnasnexus/article/2/12/pgad385/7457939"
              >Toxic comments are associated with reduced volunteer activity on
              Wikipedia</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 13:33:30</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38530466"
                  >Comments</a
                ><span class="descendants">: 260</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38530428">
          <h3>
            <a
              class="item"
              href="https://davekiss.com/blog/12-lessons-from-5-years-of-running-a-tech-meetup"
              >Lessons from 5 years of running a tech meetup</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 13:29:47</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38530428"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38529492">
          <h3><a class="item" href="https://filelife.tours/">File Life</a></h3>
          <section>
            <h4>
              <span>2023-12-05 @ 11:17:47</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38529492"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38528582">
          <h3>
            <a
              class="item"
              href="https://terrytao.wordpress.com/2023/11/18/formalizing-the-proof-of-pfr-in-lean4-using-blueprint-a-short-tour/"
              >Formalizing the proof of PFR in Lean4 using Blueprint: a short
              tour</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 09:19:48</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38528582"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38528484">
          <h3>
            <a
              class="item"
              href="https://untappedcities.com/2022/02/21/horse-era-new-york-city/"
              >Reminiscences from the end of the horse era in New York City
              (1952)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 09:02:33</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38528484"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38528477">
          <h3>
            <a
              class="item"
              href="https://buttondown.email/hillelwayne/archive/when-would-you-ever-want-bubblesort/"
              >When would you ever want bubblesort?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 09:01:10</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38528477"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38526584">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-11-mineral-plate-tectonics-global-cooling.html"
              >A mineral produced by plate tectonics has a global cooling
              effect, study finds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 03:03:44</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38526584"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38515435">
          <h3>
            <a class="item" href="https://dalton-nrs.manchester.ac.uk/"
              >Nuclear Reactor Simulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 09:50:47</span
              ><span class="points-container"
                >Points: <span class="points">302</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38515435"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
