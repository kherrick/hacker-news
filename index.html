<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44840013">
          <h3>
            <a
              class="item"
              href="https://instavm.io/blog/building-my-offline-ai-workspace"
              >I want everything local – Building my offline AI workspace</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 18:19:05</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44840013"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44839842">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/Aug/8/surprise-deprecation-of-gpt-4o/"
              >The surprise deprecation of GPT-4o for ChatGPT consumers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 18:04:26</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44839842"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44839787">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2025/08/ai-industry-horrified-to-face-largest-copyright-class-action-ever-certified/"
              >AI industry horrified to face largest copyright class action ever
              certified</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 17:58:30</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44839787"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44839705">
          <h3>
            <a
              class="item"
              href="https://newsroom.intel.com/corporate/my-commitment-to-you-and-our-company"
              >My commitment to you and our company</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 17:48:29</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44839705"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44839681">
          <h3>
            <a
              class="item"
              href="https://www.latimes.com/california/story/2025-08-08/mystery-plane-thief"
              >Someone keeps stealing, flying, fixing and returning this man's
              plane. But why?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 17:45:26</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44839681"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44839459">
          <h3>
            <a
              class="item"
              href="https://www.jeffgeerling.com/blog/2025/i-clustered-four-framework-mainboards-test-huge-llms"
              >I clustered four Framework Mainboards to test LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 17:20:39</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44839459"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44839302">
          <h3>
            <a class="item" href="https://github.com/lurk-lab/lurk"
              >Lurk – A Turing-complete programming language for ZK-SNARKs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 17:03:50</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44839302"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44838733">
          <h3>
            <a
              class="item"
              href="https://blog.langchain.com/introducing-open-swe-an-open-source-asynchronous-coding-agent/"
              >We built an open-source asynchronous coding agent</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 16:16:20</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44838733"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44838687">
          <h3>
            <a
              class="item"
              href="https://www.hudsonrivertrading.com/hrtbeat/inside-hrts-python-fork/"
              >HRT's Python Fork: Leveraging PEP 690 for Faster Imports</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 16:12:03</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44838687"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44838378">
          <h3>
            <a
              class="item"
              href="https://thereader.mitpress.mit.edu/the-secret-history-of-tor-how-a-military-project-became-a-lifeline-for-privacy/"
              >Tor: How a military project became a lifeline for privacy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 15:45:27</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44838378"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44838303">
          <h3>
            <a
              class="item"
              href="https://elite-ai-assisted-coding.dev/p/copilot-agentic-coding-gpt-5-vs-claude-4-sonnet"
              >GPT-5 vs. Sonnet: Complex Agentic Coding</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 15:38:48</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44838303"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44838170">
          <h3>
            <a
              class="item"
              href="https://www.devroom.io/2025/08/08/programming-with-ai-youre-probably-doing-it-wrong/"
              >Programming with AI: You're Probably Doing It Wrong</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 15:26:45</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44838170"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44837875">
          <h3>
            <a
              class="item"
              href="https://passo.uno/from-tech-writers-to-ai-context-curators/"
              >AI must RTFM: Why tech writers are becoming context curators</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 15:04:40</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44837875"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44837646">
          <h3>
            <a
              class="item"
              href="https://theahura.substack.com/p/tech-things-genies-lamp-openai-cant"
              >Google's Genie is more impressive than GPT5</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 14:46:53</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44837646"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44837601">
          <h3>
            <a class="item" href="https://swe.langchain.com/"
              >Open SWE by LangChain</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 14:43:01</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44837601"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44837434">
          <h3>
            <a
              class="item"
              href="https://www.rmg.co.uk/whats-on/astronomy-photographer-year/galleries/2025-shortlist"
              >Astronomy Photographer of the Year 2025 shortlist</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 14:29:54</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44837434"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44836879">
          <h3>
            <a
              class="item"
              href="https://www.dzombak.com/blog/2025/08/getting-good-results-from-claude-code/"
              >Getting good results from Claude code</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 13:45:57</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44836879"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44836463">
          <h3>
            <a
              class="item"
              href="https://radar.com/blog/high-performance-geocoding-in-rust"
              >HorizonDB, a geocoding engine in Rust that replaces
              Elasticsearch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 12:57:50</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44836463"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44836433">
          <h3>
            <a class="item" href="https://synchrotron.thatother.dev/"
              >Show HN: Synchrotron, a real-time DSP engine in pure Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 12:54:23</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44836433"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>
                I can already hear the screams from the rafters telling me how
                terrible of a choice Python is - but in my case, I valued
                modularity, extensibility, <i>hackability</i> over raw
                performance. (It was also a challenge to myself to see how far I
                can get without referencing existing implementations)
              </p>
              <p>
                Synchrotron processes nodes: simple Python classes with typed
                I/O and a render() method for processing. It can be as concise
                as 5 lines:
              </p>
              <p></p>
              <pre><code>    class IncrementNode(Node):
        input: StreamInput
        output: StreamOutput

        def render(self, ctx):
            self.out.write(self.a.read(ctx) + 1)
</code></pre>
              Nodes can then be spawned and linked programmatically or in the
              graphical editor. Synchrotron handles the rest at runtime. Besides
              the web UI, you can also interact with the engine via Python,
              REST, DSL, or standalone TUI.
              <p>
                Currently you can build synths, FX chains, MIDI instruments,
                arpeggiators, controllers, or just mess about with sound :&gt;
              </p>
              <p>
                Editor:
                <a href="https://synchrotron.thatother.dev/"
                  >https://synchrotron.thatother.dev/</a
                >
                Source:
                <a href="https://github.com/ThatOtherAndrew/Synchrotron"
                  >https://github.com/ThatOtherAndrew/Synchrotron</a
                >
              </p>
              <p>
                It's still experimental (and my first ever shipped project), but
                I'd love feedback from people who tinker with audio/DSP/live
                coding. Docs are terrible currently, but that's my next big
                goal!
              </p>
            </div>
          </section>
        </section>
        <section id="44835879">
          <h3>
            <a
              class="item"
              href="https://github.com/Nicholas-L-Johnson/flip-card"
              >Ultrathin business card runs a fluid simulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 11:41:04</span
              ><span class="points-container"
                >Points: <span class="points">654</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44835879"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44834918">
          <h3>
            <a class="item" href="https://hanlab.mit.edu/blog/streamingllm"
              >How Attention Sinks Keep Language Models Stable</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 08:53:10</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44834918"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44833834">
          <h3>
            <a
              class="item"
              href="https://bytemash.net/posts/i-went-down-the-linear-rabbit-hole/"
              >Linear sent me down a local-first rabbit hole</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 05:45:42</span
              ><span class="points-container"
                >Points: <span class="points">373</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44833834"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44826997">
          <h3><a class="item" href="https://openai.com/gpt-5/">GPT-5</a></h3>
          <section>
            <h4>
              <span>2025-08-07 @ 17:00:21</span
              ><span class="points-container"
                >Points: <span class="points">1994</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44826997"
                  >Comments</a
                ><span class="descendants">: 2373</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.youtube.com/watch?v=0Uu_VJeVVfo"
                >https://www.youtube.com/watch?v=0Uu_VJeVVfo</a
              >
            </div>
          </section>
        </section>
        <section id="44825221">
          <h3>
            <a class="item" href="https://trayce.dev?resubmit=hn"
              >Show HN: Trayce – “Burp Suite for developers”</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-07 @ 14:49:32</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44825221"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>Think "Burp Suite for developers".</p>
              <p>
                Trayce stores requests as local files using the .bru file
                format. The UI is based on Flutter which means it offers a
                super-fast and modern desktop GUI with a total download size of
                13MB (on Linux). I am still adding features to it so would love
                feedback. Currently the new features in the pipeline are:
                OAuth2, GRPC, and scripting. It is open source and free to use
                but a perpetual license must be purchased for continued use. The
                license model is similar to that of Sublime Text.
              </p>
              <p>Thank you!</p>
            </div>
          </section>
        </section>
        <section id="44792419">
          <h3>
            <a
              class="item"
              href="https://ergaster.org/posts/2025/08/04-overegineering-homelab/"
              >Overengineering my homelab so I don't pay cloud providers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-04 @ 23:14:15</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44792419"
                  >Comments</a
                ><span class="descendants">: 118</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44791444">
          <h3>
            <a
              class="item"
              href="https://jasonfantl.com/posts/Voice-Controlled-Swarms/"
              >Voice Controlled Swarms</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-04 @ 21:14:55</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44791444"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44790472">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2507.07284"
              >A Robust, Open-Source Framework for Spiking Neural Networks on
              Low-End FPGAs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-04 @ 19:36:09</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44790472"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44789202">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Telefon_H%C3%ADrmond%C3%B3"
              >Telefon Hírmondó: Listen to news and music electronically, in
              1893</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-04 @ 17:50:36</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44789202"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44788972">
          <h3>
            <a
              class="item"
              href="https://www.spacebar.news/apple-history-hiding-in-mac-font/"
              >Apple's history is hiding in a Mac font</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-04 @ 17:31:54</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44788972"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44784685">
          <h3>
            <a
              class="item"
              href="https://blog.broulik.de/2025/08/on-window-activation/"
              >Window Activation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-04 @ 12:03:24</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44784685"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
