<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41336446">
          <h3>
            <a class="item" href="https://www.buzl.uk/2024/08/24/reddit.html"
              >Reddit banned me for developing Geddit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 07:57:40</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41336446"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41335830">
          <h3>
            <a class="item" href="https://gir.st/ircpipe.html"
              >Ircpipe – Netcat for IRC</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 05:18:13</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41335830"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41334910">
          <h3>
            <a
              class="item"
              href="https://clojure.github.io/clojure-contrib/doc/datalog.html"
              >An Overview of Datalog (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 01:58:25</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41334910"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41334387">
          <h3>
            <a class="item" href="https://rosszurowski.com/log/2022/makefiles"
              >Makefiles for Web Work (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 00:22:13</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41334387"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41334207">
          <h3>
            <a class="item" href="https://alexyancey.com/lost-airpods/"
              >Did you lose your AirPods?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 23:54:28</span
              ><span class="points-container"
                >Points: <span class="points">637</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41334207"
                  >Comments</a
                ><span class="descendants">: 211</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41333384">
          <h3>
            <a class="item" href="https://www.newyorkdailyinquirer.com/"
              >Show HN: Hacker News for film buffs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 21:44:59</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41333384"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
            <div class="text">
              I tried to replicate the minimal design of hacker news. A small
              pet project I wanted to do after getting frustrated with the
              politics and dumb down conversations the film communities have on
              X/twitter, instagram and other social platforms have. I'll try to
              update the landing page with more links, feel free to check it out
              and judge.
            </div>
          </section>
        </section>
        <section id="41333284">
          <h3>
            <a
              class="item"
              href="https://kguttag.com/2024/08/22/canon-r5-mk-ii-drops-pixel-shift-high-res-is-canon-missing-the-ai-big-picture/"
              >Canon R5 Mk Ii Drops Pixel Shift High Res – Is Canon Missing the
              AI Big Picture?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 21:29:44</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41333284"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41333059">
          <h3>
            <a class="item" href="https://www.tesorio.com/careers#job-openings"
              >Tesorio Is Hiring a Senior GenAI Engineer and Django Engineer
              (100% Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 21:01:15</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332811">
          <h3>
            <a class="item" href="https://github.com/ptrsr/pi-ci"
              >Pi-CI – A RasPi 5 emulator in a Docker image for creating and
              flashing configs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 20:29:42</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332811"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332427">
          <h3>
            <a class="item" href="https://xeiaso.net/blog/2024/k8s-irc-client/"
              >My IRC client runs on Kubernetes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 19:46:40</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332427"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332342">
          <h3>
            <a
              class="item"
              href="https://marc.info/?l=openbsd-cvs&amp;m=172443408727088&amp;w=2"
              >We have reached OpenBSD of Theseus</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 19:39:11</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332342"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41331851">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2024/08/microsoft-formally-deprecates-the-39-year-old-windows-control-panel/"
              >Microsoft formally deprecates the Windows Control Panel</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 18:49:33</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41331851"
                  >Comments</a
                ><span class="descendants">: 289</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41331531">
          <h3>
            <a class="item" href="https://osf.io/preprints/osf/3ez9v"
              >Author-paid publication fees corrupt science and should be
              abandoned</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 18:17:38</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41331531"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41331369">
          <h3>
            <a
              class="item"
              href="https://www.macrumors.com/2024/08/23/meta-cancels-high-end-headset/"
              >Meta cancels high-end mixed reality headset after Apple Vision
              Pro struggles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 18:00:17</span
              ><span class="points-container"
                >Points: <span class="points">271</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41331369"
                  >Comments</a
                ><span class="descendants">: 342</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41330852">
          <h3>
            <a
              class="item"
              href="https://android-developers.googleblog.com/2024/08/adding-16-kb-page-size-to-android.html"
              >Adding 16 kb page size to Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 17:14:05</span
              ><span class="points-container"
                >Points: <span class="points">272</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41330852"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41330258">
          <h3>
            <a class="item" href="https://blog.isosceles.com/openssh-backdoors/"
              >OpenSSH Backdoors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 16:14:54</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41330258"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41329750">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41329750"
              >Launch HN: Moonglow (YC S24) – Serverless Jupyter Notebooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 15:20:20</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41329750"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
            <div class="text">
              <a href="https://moonglow.ai">https://moonglow.ai</a>). We let you
              run local Jupyter notebooks on remote cloud GPUs. Here’s a quick
              demo video:
              <a href="https://www.youtube.com/watch?v=Bf-xTsDT5FQ"
                >https://www.youtube.com/watch?v=Bf-xTsDT5FQ</a
              >. If you want to try it out directly, there are instructions
              below.
              <p>
                With Moonglow, you can start and stop pre-configured remote
                cloud machines within VSCode, and it makes those servers appear
                to VSCode like normal Jupyter kernels that you can connect your
                notebook to.
              </p>
              <p>
                We built this because we learned from talking to data scientists
                and ML researchers that scaling up experiments is hard. Most
                researchers like to start in a Jupyter notebook, but they
                rapidly hit a wall when they need to scale up to more powerful
                compute resources. To do so, they need to spin up a remote
                machine and then also start a Jupyter server on it so they can
                access it from their laptop. To avoid wasting compute resources,
                they might end up setting this up and tearing it down multiple
                times a day.
              </p>
              <p>
                When Trevor used to do ML research at Stanford, he faced this
                exact problem: often, he needed to move between cloud providers
                to find GPU availability. This meant he was constantly clicking
                through various cloud compute UIs, as well as copying both
                notebook files and data across different providers over and over
                again.
              </p>
              <p>
                Our goal with Moonglow is to make it easy to transfer your dev
                environment from your local machine to your cloud GPU. If you’ve
                used Google Colab, you’ve seen how easy it is to switch from a
                CPU to a GPU - we want to bring that experience to VSCode and
                Cursor.
              </p>
              <p>
                If you’re curious, here’s some background on how it works. You
                can model a local Jupyter server as actually having three parts:
                a frontend (also known as a notebook), a server and an
                underlying backend kernel. The frontend is where you enter code
                into your notebook, the kernel is what actually executes it, and
                the server in the middle is responsible for spinning up and
                restarting kernels. Moonglow is a rewrite of this middle server
                part: where an ordinary Jupyter server would just start and stop
                kernels, we’ve added extra orchestration that provisions a
                machine from your cloud, starts a kernel on it, then sets up a
                tunnel between you and that kernel.
              </p>
              <p>
                In the demo video (<a
                  href="https://www.youtube.com/watch?v=Bf-xTsDT5FQ"
                  >https://www.youtube.com/watch?v=Bf-xTsDT5FQ</a
                >), you can see Trevor demonstrate how he uses Moonglow to train
                a ResNet to 94% accuracy on the CIFAR-10 classification
                benchmark in 1m16s of wall clock time. (In fact, it only takes 5
                seconds of H100 time; the rest of it is all setup.)
              </p>
              <p>
                On privacy: we tunnel your code and notebook output through our
                servers. We don’t store or log this data if you are bringing
                your own compute provider. However, we do monitor it if you are
                using compute provided by us, to make sure that what you are
                running doesn’t break our compute vendor’s terms of service.
              </p>
              <p>
                We currently aren’t charging individuals for Moonglow. When we
                do, we plan to price individuals a reasonable amount per-seat,
                and we have a business plan for teams with more requirements.
              </p>
              <p>
                Right now, we support Runpod and AWS. We’ll add support for GCP
                and Azure soon, too. (If you’d like to use us to connect to your
                own AWS account, please email me at trevor@moonglow.ai.)
              </p>
              <p>
                For today’s launch on HN only, you can get a free API key at
                <a href="https://app.moonglow.ai/hn-launch"
                  >https://app.moonglow.ai/hn-launch</a
                >. You don’t need to sign in and you don’t need to bring your
                own compute; we’ll let you run it on servers we provide. This
                API key will give you enough credit to run Moonglow with an A40
                for an hour.
              </p>
              <p>
                If you're signed in, you won't be able to see the free credits
                page, but your account will have automatically had free credits
                added to it.
              </p>
              <p>
                We’re still very early, and there are a lot of features we’d
                still like to add, but we’d love to get your feedback on this.
                We look forward to your comments!
              </p>
            </div>
          </section>
        </section>
        <section id="41328749">
          <h3>
            <a class="item" href="https://vega.github.io/vega/"
              >Vega – A declarative language for interactive visualization
              designs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 13:15:40</span
              ><span class="points-container"
                >Points: <span class="points">218</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41328749"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41323042">
          <h3>
            <a class="item" href="https://lmstudio.ai/blog/lmstudio-v0.3.0"
              >LM Studio 0.3 – Discover, download, and run local LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-22 @ 18:22:14</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41323042"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41322818">
          <h3>
            <a class="item" href="https://blog.val.town/blog/codegen/"
              >How we built Townie – an app that generates fullstack apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-22 @ 18:01:01</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41322818"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41316807">
          <h3>
            <a
              class="item"
              href="https://purplesyringa.moe/blog/i-sped-up-serde-json-strings-by-20-percent/"
              >I sped up serde_json strings by 20%</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-22 @ 04:24:22</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41316807"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41312834">
          <h3>
            <a class="item" href="https://fly.io/blog/accident-forgiveness/"
              >Accident Forgiveness</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 18:27:56</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41312834"
                  >Comments</a
                ><span class="descendants">: 241</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41310921">
          <h3>
            <a
              class="item"
              href="https://www.htmhell.dev/adventcalendar/2023/1/"
              >The UX of HTML (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 14:54:42</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41310921"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41309821">
          <h3>
            <a
              class="item"
              href="https://slate.com/culture/2022/10/rod-mckuen-bestselling-poet-songs-what-happened.html"
              >Rod McKuen Was the Bestselling Poet in American History. What
              Happened? (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 12:56:49</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41309821"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41309793">
          <h3>
            <a
              class="item"
              href="https://neuroleadership.com/your-brain-at-work/generational-knowledge"
              >The Advantage of Generational Knowledge (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 12:54:14</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41309793"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41309561">
          <h3>
            <a
              class="item"
              href="https://tratt.net/laurie/blog/2024/recording_and_processing_spoken_word.html"
              >Recording and Processing Spoken Word</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 12:22:18</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41309561"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41304610">
          <h3>
            <a class="item" href="https://www.asimov.press/p/lab-mouse"
              >Origins of the Lab Mouse</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 22:10:48</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41304610"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41304600">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/books/article/2024/aug/17/it-could-disappear-for-ever-anger-over-sale-of-george-orwell-archive"
              >'It could disappear for ever': Anger over sale of George Orwell
              archive</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 22:09:44</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41304600"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41298774">
          <h3>
            <a class="item" href="https://zodvik.com/posts/on-writing-well/"
              >On Writing Well</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 10:54:00</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41298774"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294663">
          <h3>
            <a class="item" href="https://github.com/gruhn/typescript-sudoku"
              >Playing Sudoku in TypeScript while the type checker highlights
              mistakes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 21:18:19</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294663"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
