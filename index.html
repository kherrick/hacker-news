<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38502805">
          <h3>
            <a class="item" href="https://github.com/danny-avila/LibreChat"
              >LibreChat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 22:30:46</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38502805"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38502586">
          <h3>
            <a
              class="item"
              href="https://petapixel.com/2023/12/01/filmics-entire-staff-laid-off-by-parent-company-bending-spoons/"
              >Filmic's entire staff laid off by parent company Bending
              Spoons</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 22:07:54</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38502586"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38502340">
          <h3>
            <a
              class="item"
              href="https://bugzilla.mozilla.org/show_bug.cgi?id=1824831"
              >Can't sign in with FIDO2 key on office.com</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 21:45:25</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38502340"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38502011">
          <h3>
            <a class="item" href="https://www.tesorio.com/careers#job-openings"
              >Tesorio (YC S15) Is Hiring a Senior Data Engineer in Latam</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 21:01:55</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38501945">
          <h3>
            <a class="item" href="https://www.acm.org/code-of-ethics"
              >ACM Code of Ethics and Professional Conduct</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 20:54:17</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38501945"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38501878">
          <h3>
            <a
              class="item"
              href="https://optometry.berkeley.edu/berkeley-scientists-discover-retinal-cells-that-help-stabilize-our-world-view/"
              >Scientists discover retinal cells that help stabilize our world
              view</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 20:44:27</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38501878"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38501868">
          <h3>
            <a class="item" href="https://threefold.io/"
              >Show HN: ThreeFold – Decentralized Cloud Infrastructure</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 20:43:14</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38501868"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <p>
                There is even a dashboard, and a playground UI to manage it
                (that you can even run yourself) . Beautifully decentralized,
                you have full control of everything, you can deploy on your own
                servers if the cost of the cloud is too much. You can even run
                the whole system yourself if you want to.
              </p>
              <p>
                Here is a link to documentation
                <a href="https://manual.grid.tf/">https://manual.grid.tf/</a>
              </p>
              <p>
                Also, we are honored if it piqued your interest, and would love
                to support your testing journey free of charge.
              </p>
            </div>
          </section>
        </section>
        <section id="38501779">
          <h3>
            <a
              class="item"
              href="https://thenewstack.io/how-meta-patches-linux-at-hyperscale/"
              >How Meta patches Linux at hyperscale</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 20:32:53</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38501779"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38501589">
          <h3>
            <a class="item" href="https://blog.j11y.io/2023-11-22_multifaceted/"
              >Multifaceted: The linguistic echo chambers of LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 20:10:27</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38501589"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38501437">
          <h3>
            <a
              class="item"
              href="https://bytes.zone/posts/modeling-crdts-in-alloy-counters/"
              >Modeling CRDTs in Alloy – Counters</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 19:54:25</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38501437"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38501030">
          <h3>
            <a
              class="item"
              href="https://jamesg.blog/2023/12/02/advent-of-technical-writing/"
              >Advent of Technical Writing: Navigation Structure (Day 1 of
              24)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 19:03:44</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38501030"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38500906">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/2023/dec/01/singing-to-babies-is-vital-to-help-them-understand-language-say-scientists"
              >Singing to babies is vital to help them learn language, say
              scientists</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 18:50:28</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38500906"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38500821">
          <h3>
            <a
              class="item"
              href="https://harelang.org/blog/2023-12-01-porting-hare-to-openbsd/"
              >Porting Hare to OpenBSD</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 18:39:58</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38500821"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38500782">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Galactic_algorithm"
              >Galactic algorithm</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 18:34:51</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38500782"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38500681">
          <h3>
            <a
              class="item"
              href="https://journals.sagepub.com/doi/10.1177/14705931221138617"
              >Mundane emotions: Losing yourself in boredom, time and technology
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 18:22:44</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38500681"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38499610">
          <h3>
            <a
              class="item"
              href="https://www.ghs.com/products/safety_critical/integrity_178_tump.html"
              >Integrity-178B: Safety Critical Real-Time OS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 16:15:09</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38499610"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38498934">
          <h3>
            <a
              class="item"
              href="https://www.jviotti.com/2023/12/01/understanding-objective-c-by-transpiling-it-to-cpp.html"
              >Understanding Objective-C by transpiling it to C++</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 14:45:26</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38498934"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38498688">
          <h3>
            <a class="item" href="https://github.com/AmrDeveloper/GQL"
              >GQL – Git Query Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 14:06:48</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38498688"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38498332">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2023/12/the-universe-in-a-lab-testing-alternate-cosmology-using-a-cloud-of-atoms/"
              >Testing alternate cosmology using a cloud of atoms</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 13:02:24</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38498332"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38498109">
          <h3>
            <a class="item" href="https://mitxela.com/projects/candle"
              >Tiny volumetric display</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 12:23:05</span
              ><span class="points-container"
                >Points: <span class="points">863</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38498109"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38497624">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/ancient-redwoods-recover-fire-sprouting-1000-year-old-buds"
              >Ancient redwoods recover from fire by sprouting 1000-year-old
              buds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 10:42:01</span
              ><span class="points-container"
                >Points: <span class="points">232</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38497624"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38497570">
          <h3>
            <a class="item" href="https://melang.org/"
              >Show HN: A Time-Sharing Scheduling Coroutine Script Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 10:28:18</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38497570"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38497445">
          <h3>
            <a
              class="item"
              href="https://www.htmhell.dev/adventcalendar/2023/2/"
              >You don't need JavaScript for that</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 09:57:05</span
              ><span class="points-container"
                >Points: <span class="points">744</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38497445"
                  >Comments</a
                ><span class="descendants">: 277</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38496816">
          <h3>
            <a
              class="item"
              href="https://submarine-cable-map-2023.telegeography.com/"
              >Submarine Cable Map 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 07:55:04</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38496816"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38495720">
          <h3>
            <a
              class="item"
              href="https://scitechdaily.com/tinnitus-linked-to-hidden-undetected-auditory-nerve-damage-a-step-towards-a-cure/"
              >Tinnitus linked to undetected auditory nerve damage</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 03:52:10</span
              ><span class="points-container"
                >Points: <span class="points">662</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38495720"
                  >Comments</a
                ><span class="descendants">: 368</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38495542">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=ANxhQ4wUiMQ"
              >Modern automotive electronics will lead to a mechanical
              revolution [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 03:14:26</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38495542"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38495458">
          <h3>
            <a
              class="item"
              href="https://link.springer.com/article/10.1007/s13592-023-01019-7"
              >Conditioning honeybees to a mimic odor increases foraging
              activity</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-02 @ 02:57:03</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38495458"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38494016">
          <h3>
            <a
              class="item"
              href="https://www.dolthub.com/blog/2023-12-01-why-are-go-heaps-confusing/"
              >Why are Golang heaps so complicated</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-01 @ 23:26:57</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38494016"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38491893">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-11-dutch-astronomers-piece-gas-feedback-feeding.html"
              >Dutch astronomers prove last piece of gas feedback-feeding loop
              of black hole</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-01 @ 20:29:50</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38491893"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38485048">
          <h3>
            <a class="item" href="https://github.com/mlabonne/llm-course"
              >Large Language Model Course</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-01 @ 09:57:14</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38485048"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
