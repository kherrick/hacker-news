<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36043944">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36043944"
              >Launch HN: Common Paper (YC W23) – SAFEs for Commercial
              Contracts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 13:28:53</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36043944"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <a href="https://commonpaper.com">https://commonpaper.com</a>). We
              provide standard, open-source contracts and a platform for getting
              them signed quickly. See
              <a href="https://youtu.be/f7maIapJpU4"
                >https://youtu.be/f7maIapJpU4</a
              >
              for an overview, and
              <a href="https://youtu.be/A1PWjWiheFk"
                >https://youtu.be/A1PWjWiheFk</a
              >
              for a demo of sending and signing a contract.
              <p>
                I (Jake) was a co-founder of two B2B SaaS companies, RJMetrics
                (where Ben and I met), and Stitch. Everything about contracts
                was frustrating, both at those startups and the larger companies
                that acquired us.
              </p>
              <p>
                Way too often, the contracting process with a customer got
                adversarial—arguing over whose template to use, emailing Word
                docs back and forth, huge legal fees, and unpredictable delays
                that made it hard to know if a deal would ever close. Then, when
                we finally got the customer to sign, we had to keep track of all
                of the promises embedded in the contract. This is difficult when
                you have hundreds of customers and contract PDFs full of
                unstructured text.
              </p>
              <p>
                The breaking point came when one of our customers was acquired
                by Oracle. They wanted to keep using our product, but had to
                move from our original contract to the one that Oracle uses. In
                exchange for this, they were willing to increase the price they
                were paying from $6,000 to $24,000 per year.
              </p>
              <p>
                It took us 9 months to get the new contract in place, just to
                enable them to keep using the product. We spent more on
                attorneys than we gained from the upsell. And there was
                basically nothing we could do to improve that process as a
                single company operating in a system where standards don’t
                exist.
              </p>
              <p>
                Contrast that to the standardization that the SAFE, or Simple
                Agreement for Future Equity, brought to seed investments, and
                the potential is obvious. (Past discussion of the SAFE at
                <a href="https://news.ycombinator.com/item?id=33639191"
                  >https://news.ycombinator.com/item?id=33639191</a
                >)
              </p>
              <p>
                If you’re a startup raising money on a SAFE, the process is
                simple, whether you’re raising $10k from an angel or $1M from a
                VC. Everyone already uses, or at least is familiar with, the
                same basic contract. There are a few variables that change on a
                deal-by-deal basis, but the transactions are vastly more
                efficient because everyone is on the same standard contract.
              </p>
              <p>
                If you start with standard contracts, you can build very
                different software to manage them compared to traditional
                contracts. Our business model is to provide the standard
                contracts for free and charge money from companies who use our
                software to sell to their customers (more on this below).
              </p>
              <p>
                The standard contracts we create are all related to buying and
                selling B2B software. This includes a non-disclosure agreement,
                (<a href="https://commonpaper.com/standards/mutual-nda/"
                  >https://commonpaper.com/standards/mutual-nda/</a
                >), sales contract (<a
                  href="https://commonpaper.com/standards/cloud-service-agreement/"
                  >https://commonpaper.com/standards/cloud-service-agreement/</a
                >), SLA, DPA, ToS, etc. The full list is at
                <a href="https://commonpaper.com/standards/"
                  >https://commonpaper.com/standards/</a
                >.
              </p>
              <p>
                The process for creating and revising the contracts is modeled
                after an open-source software project, and they are released for
                free (as in both speech and beer) under the Creative Commons CC
                BY 4.0 license.
              </p>
              <p>
                We have a committee of 40+ attorneys from tech companies and law
                firms who are analogous to code contributors (<a
                  href="https://commonpaper.com/committee"
                  >https://commonpaper.com/committee</a
                >). An attorney on our team, who you can think about like a
                maintainer, collects all of their feedback and synthesizes it
                into a version for release (eg the Design Partner Agreement
                v1.0). We post the agreements as DOCX, PDF, and HTML on our
                website and host markdown on Github.
              </p>
              <p>
                Most of the usage of the agreements happens outside of our
                platform, and we don’t have any visibility into that unless
                people choose to tell us. However, we do know that thousands of
                companies have signed the agreements, and millions of dollars
                worth of deals have been closed on them.
              </p>
              <p>
                Each agreement is split into two sections: the standard terms,
                which are the same across all instances, and a cover page, with
                variables that can be customized for a particular company and
                deal. The latter is basically a schema for each agreement type,
                and that leads to the fundamental trade-off in how we build our
                software. We have less flexibility around types of contracts
                (because we’re focused on the standard agreements, not arbitrary
                DOCX files), but in exchange, every agreement type has a
                consistent data model, which means that we can build
                integrations and features that work across all customers. This
                gain is huge.
              </p>
              <p>
                For example, we can use the data in the fees section of our
                standard Cloud Service Agreement to automatically generate
                invoices and subscriptions using Stripe. Similarly, it’s trivial
                to use our API (<a href="https://api.commonpaper.com/docs"
                  >https://api.commonpaper.com/docs</a
                >) to check if an active NDA is in place before sharing
                confidential information or to keep a spreadsheet up to date
                with the SLA obligations for different customers.
              </p>
              <p>
                Traditional contract management tools are built around adding
                electronic signatures to documents full of unstructured text
                and/or creating a custom data model from a particular company’s
                bespoke contract. There’s no way they can offer features like
                this without a custom project for each particular contract. It’s
                basically the difference between custom software and a software
                product.
              </p>
              <p>
                Part of our feature set overlaps with the traditional tools. We
                can do things like send a contract to the other side, propose
                changes, approve, and sign. But our negotiation model is
                different in that it encourages both sides to keep changes
                narrowly scoped to the variables in the cover page. That makes
                it faster both to propose the changes and for each side to
                understand, and accept or reject, the changes proposed by their
                counterparty.
              </p>
              <p>
                We believe that, just as with SAFEs in the investment world, the
                potential efficiency gains and positive side effects of this
                model are so big that the transition is inevitable. We’d love
                for you all to try it out and let us know your feedback and
                suggestions. The agreements are free forever, and our software
                is free as well until you use it to close deals with 5
                customers.
                <a href="https://commonpaper.com/product/"
                  >https://commonpaper.com/product/</a
                >.
              </p>
              <p>
                We’re interested to hear about any experiences you’ve had with
                contracts and how you’ve worked with them. We look forward to
                your comments!
              </p>
            </div>
          </section>
        </section>
        <section id="36043716">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-01708-4"
              >A mental-health crisis is gripping science – toxic research
              culture is to blame</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 13:08:53</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36043716"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36043398">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/investigates/special-report/crypto-binance-money/"
              >Crypto giant Binance commingled customer funds and company
              revenue</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 12:38:45</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36043398"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36043377">
          <h3>
            <a
              class="item"
              href="https://www.telegraph.co.uk/news/2023/05/21/ships-gps-alternative-warfare-tracking-impossible/"
              >Imperial College working with Royal Navy on system to replace GPS
              on ships</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 12:36:11</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36043377"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36043327">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/05/23/meta-sells-giphy-to-shutterstock-for-53m-after-uk-divestment-order/"
              >Following UK antitrust order, Meta sells Giphy to Shutterstock
              for $53M</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 12:29:03</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36043327"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36043322">
          <h3>
            <a
              class="item"
              href="https://blog.waymo.com/2023/05/waymo-and-uber-partner-to-bring-waymos.html"
              >Waymo and Uber partner to bring autonomous driving technology to
              Uber</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 12:28:39</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36043322"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36043287">
          <h3>
            <a
              class="item"
              href="https://www.axios.com/2023/05/22/nintendo-mario-kart-lootboxes-lawsuit"
              >Nintendo sued for “immoral” Mario Kart lootboxes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 12:25:27</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36043287"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36043086">
          <h3>
            <a class="item" href="https://www.tesorio.com/careers#job-openings"
              >Tesorio (YC S15) Is Hiring Back End Engineers and DevOps</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 12:01:05</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36043066">
          <h3>
            <a class="item" href="https://taylor.town/elm-2023"
              >Why I Use Elm in 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 11:58:52</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36043066"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36043060">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/news/technology-65342798"
              >AI scanner used in hundreds of US schools misses knives</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 11:58:04</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36043060"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36042732">
          <h3>
            <a
              class="item"
              href="https://metalintheory.com/metallica-master-of-puppets/"
              >Microtiming in Metallica's “Master of Puppets” (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 11:22:51</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36042732"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36042213">
          <h3>
            <a
              class="item"
              href="https://www.geoffchappell.com/notes/windows/archive/aard/drdos/index.htm"
              >How Microsoft faked errors in Windows 3 on top of DR DOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 10:24:44</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36042213"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36042126">
          <h3>
            <a
              class="item"
              href="https://yoshuabengio.org/2023/05/22/how-rogue-ais-may-arise/"
              >Yoshua Bengio: How Rogue AIs May Arise</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 10:11:52</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36042126"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36041432">
          <h3>
            <a class="item" href="https://www.ableton.com/en/push/"
              >Ableton Push 3</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 08:16:18</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36041432"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36041059">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2023/05/22/fbi_fisa_abuse/"
              >FBI misused surveillance powers more than 280k times in a year</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 07:26:53</span
              ><span class="points-container"
                >Points: <span class="points">343</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36041059"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36039232">
          <h3>
            <a
              class="item"
              href="https://eli.thegreenplace.net/2023/demystifying-tuppers-formula/"
              >Demystifying Tupper's Formula</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 02:51:13</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36039232"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36038945">
          <h3>
            <a class="item" href="https://ai-muzic.github.io/getmusic/"
              >Generating Music Tracks with Unified Representation and Diffusion
              Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 02:03:51</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36038945"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36038868">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2305.13048"
              >RWKV: Reinventing RNNs for the Transformer Era</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 01:50:00</span
              ><span class="points-container"
                >Points: <span class="points">297</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36038868"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36038815">
          <h3>
            <a class="item" href="https://github.com/csunny/DB-GPT"
              >Show HN: DB-GPT, an LLM tool for database</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 01:40:55</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36038815"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36038796">
          <h3>
            <a
              class="item"
              href="https://slate.com/human-interest/2012/05/how-to-cook-onions-why-recipe-writers-lie-and-lie-about-how-long-they-take-to-caramelize.html"
              >Why do recipe writers lie about how long it takes to caramelize
              onions? (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 01:38:01</span
              ><span class="points-container"
                >Points: <span class="points">373</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36038796"
                  >Comments</a
                ><span class="descendants">: 565</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36034409">
          <h3>
            <a class="item" href="https://www.vogons.org/viewtopic.php?t=86172"
              >Salt Lake 2002 – not enough memory/crashes to desktop after
              starting error</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-22 @ 17:46:44</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36034409"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36028244">
          <h3>
            <a class="item" href="https://github.com/softdorothy/GliderPRO"
              >Source code for Glider Pro (1994)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-22 @ 06:51:58</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36028244"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36025180">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/the-fight-to-protect-the-joshua-tree-609bc7e9"
              >The Fight to Protect the Joshua Tree</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-21 @ 22:22:14</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36025180"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36023740">
          <h3>
            <a class="item" href="https://qirella.geosearchef.de"
              >ZX-Calculus Simulator in the Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-21 @ 18:55:51</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36023740"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36023706">
          <h3>
            <a class="item" href="https://surma.dev/things/ditherpunk/"
              >Ditherpunk – The article I wish I had about monochrome image
              dithering (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-21 @ 18:50:21</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36023706"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36023557">
          <h3>
            <a
              class="item"
              href="https://wildlifeinformer.com/can-alligators-climb-trees/"
              >Can alligators climb trees? (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-21 @ 18:31:28</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36023557"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36023463">
          <h3>
            <a
              class="item"
              href="https://eisenbergeffect.medium.com/the-industrial-hammer-complex-d9785886ee59"
              >The Industrial Hammer Complex</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-21 @ 18:22:27</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36023463"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36023267">
          <h3>
            <a
              class="item"
              href="https://www.tweag.io/blog/2023-01-31-hls-internship-report/"
              >A semester of Haskell-language-server: an internship report</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-21 @ 17:58:17</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36023267"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36022731">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Ithkuil"
              >Ithkuil, the Most Complicated Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-21 @ 16:54:20</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36022731"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36020612">
          <h3>
            <a
              class="item"
              href="https://blog.min.io/erasure-coding-cpu-utilization/"
              >Benchmarking Intel, AMD and Graviton Using Erasure Coding
              Workloads</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-21 @ 13:23:54</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36020612"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
