<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35728274">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35728274"
              >Is Satya Nadella the best tech CEO of last decade?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 14:05:45</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35728274"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
            <div class="text">
              He turned around an almost dying windows to become this Kraken
              that has the majority dev environment in its chokehold. That's
              impressive Other candidates in my list are Frank Slootman of
              Snowflake and Tim Cook of Apple for how he has not dropped the
              ball from Steve Jobs. What are yours?
            </div>
          </section>
        </section>
        <section id="35728229">
          <h3>
            <a
              class="item"
              href="https://www.vanityfair.com/hollywood/2023/04/dune-part-two-exclusive-first-look"
              >Dune: Part Two – First Look</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 14:01:44</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35728229"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35728216">
          <h3>
            <a
              class="item"
              href="https://blog.dropbox.com/topics/company/a-message-from-drew"
              >Dropbox axes 16% (500 employees）</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 14:00:49</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35728216"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35727967">
          <h3>
            <a
              class="item"
              href="https://blog.datomic.com/2023/04/datomic-is-free.html"
              >Datomic Is Now Free</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 13:40:47</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35727967"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35727922">
          <h3>
            <a
              class="item"
              href="https://www.thefp.com/p/sports-betting-is-the-new-opioid-crisis"
              >Sports Betting Is the ‘New Oxycontin’</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 13:37:41</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35727922"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35726855">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2304.12517"
              >The 2-Maxsat Problem Can Be Solved in Polynomial Time</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 12:11:24</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35726855"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35726836">
          <h3>
            <a
              class="item"
              href="https://www.anandtech.com/show/18832/tsmc-outlines-2nm-plans-n2p-brings-backside-power-delivery-in-2026-n2x-added-to-roadmap"
              >TSMC Outlines 2nm Plans: N2P Brings Backside Power Delivery in
              2026, N2X Added</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 12:09:43</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35726836"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35726744">
          <h3>
            <a class="item" href="https://onesignal.com/careers/4045518006"
              >OneSignal (YC S11) Is Hiring an Engineering Manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 12:00:35</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35726653">
          <h3>
            <a class="item" href="https://collabfund.com/blog/thoughts/"
              >Some Things I Think</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 11:51:07</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35726653"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35726559">
          <h3>
            <a
              class="item"
              href="https://nathanrooy.github.io/posts/2023-04-12/visual-book-recommender/"
              >A visual book recommender</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 11:40:02</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35726559"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35726425">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gaming/2023/02/humanity-is-the-reimagined-3d-lemmings-we-didnt-know-we-needed/"
              >Humanity is the reimagined 3D Lemmings we didn’t know we
              needed</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 11:27:03</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35726425"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35726235">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-04-german-figure-lager-bavaria.html"
              >German researchers figure out how lager first developed in
              Bavaria</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 11:03:41</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35726235"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35726052">
          <h3>
            <a
              class="item"
              href="https://circleid.com/posts/20230127-the-disappointment-of-5g"
              >The Disappointment of 5G</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 10:40:56</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35726052"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35725202">
          <h3>
            <a class="item" href="https://www.gnu-pascal.de/gpc/h-index.html"
              >GNU Pascal (2005)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 08:58:34</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35725202"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35725094">
          <h3>
            <a
              class="item"
              href="https://twitter.com/FedeItaliano76/status/1650871570137600000"
              >The unintentional dystopian beauty of oil rigs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 08:46:20</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35725094"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35724939">
          <h3>
            <a
              class="item"
              href="https://www.dropboxforum.com/t5/Integrations/Why-So-Much-Telemetry/td-p/455961/page/3"
              >Dropbox telemetry can't be disabled</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 08:28:15</span
              ><span class="points-container"
                >Points: <span class="points">282</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35724939"
                  >Comments</a
                ><span class="descendants">: 154</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35724634">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/film/2023/apr/26/steven-spielberg-et-guns-movie-edit"
              >Steven Spielberg: ‘No film should be revised’ based on modern
              sensitivity</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 07:51:08</span
              ><span class="points-container"
                >Points: <span class="points">635</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35724634"
                  >Comments</a
                ><span class="descendants">: 468</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35723540">
          <h3>
            <a
              class="item"
              href="https://europeanreviewofbooks.com/beamer-dressman-bodybag/en"
              >On the unexpected joys of Denglisch, Berlinglish and global
              Englisch</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 05:08:04</span
              ><span class="points-container"
                >Points: <span class="points">251</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35723540"
                  >Comments</a
                ><span class="descendants">: 274</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35723148">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2023/04/first-us-appellate-court-decide-finds-geofence-warrant-unconstitutional"
              >California Court of Appeal finds geofence warrant
              unconstitutional</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 04:01:08</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35723148"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35722681">
          <h3>
            <a
              class="item"
              href="https://monadical.com/posts/shades-of-rust-gui-library-list.html"
              >Emerging Rust GUI libraries in a WASM world</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 02:41:07</span
              ><span class="points-container"
                >Points: <span class="points">237</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35722681"
                  >Comments</a
                ><span class="descendants">: 141</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35722376">
          <h3>
            <a
              class="item"
              href="https://www.filfre.net/2023/04/the-next-generation-in-graphics-part-1-three-dimensions-in-software-or-quake-and-its-discontents/"
              >The Next Generation in Graphics, Part 1: Three Dimensions in
              Software</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 02:00:22</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35722376"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35722206">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/why-gravity-is-not-like-the-other-forces-20200615/"
              >Why gravity is not like the other forces</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 01:38:24</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35722206"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35720865">
          <h3>
            <a
              class="item"
              href="https://slate.com/business/2023/04/cars-buttons-touchscreens-vw-porsche-nissan-hyundai.html"
              >Automakers are starting to admit that drivers hate
              touchscreens</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 22:29:46</span
              ><span class="points-container"
                >Points: <span class="points">1130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35720865"
                  >Comments</a
                ><span class="descendants">: 797</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35718417">
          <h3>
            <a
              class="item"
              href="https://www.linen.dev/s/linen/t/10511167/linen-dev-the-500kb-slack-alternative"
              >Linen.dev: A 500 kb Slack alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 19:00:51</span
              ><span class="points-container"
                >Points: <span class="points">669</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35718417"
                  >Comments</a
                ><span class="descendants">: 189</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35710266">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/culture/cultural-comment/in-praise-of-the-long-movie"
              >In Praise of the Long Movie</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 06:44:05</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35710266"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35709077">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/our-sounds-of-hesitation-are-more-than-filler-1f2f5807"
              >Sounds of Hesitation Are More Than Filler</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 02:24:30</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35709077"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35705325">
          <h3>
            <a
              class="item"
              href="https://theamericanscholar.org/the-goddess-complex/"
              >The Goddess Complex</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-25 @ 19:20:08</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35705325"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35698653">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-01422-1"
              >First up-close images of Mars’s little-known moon Deimos</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-25 @ 10:39:52</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35698653"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35698587">
          <h3>
            <a class="item" href="https://eliemichel.github.io/LearnWebGPU/"
              >Learn WebGPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-25 @ 10:28:18</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35698587"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35697623">
          <h3>
            <a class="item" href="https://permutation-groups.glitch.me/"
              >Permutation Group Visualizer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-25 @ 07:41:35</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35697623"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
