<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42482829">
          <h3>
            <a
              class="item"
              href="https://www.datafix.com.au/BASHing/2020-08-12.html"
              >A Data Table Thousands of Years Old (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 22:25:37</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42482829"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42482684">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42482684"
              >Ask HN: How to unblock RSS feeds on Cloudflare hosted sites?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 22:01:18</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42482684"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text"><p>[1] https://rishikeshs.com</p></div>
          </section>
        </section>
        <section id="42482635">
          <h3>
            <a
              class="item"
              href="https://www.laphamsquarterly.org/future/magical-thinking"
              >Magical Thinking: Edward Bellamy's Looking Backward (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 21:54:01</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42482635"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42481659">
          <h3>
            <a class="item" href="https://github.com/gildas-lormeau/SingleFile"
              >Singlefile: A web extension to save a complete web page into a
              single HTML file</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 19:33:15</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42481659"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42481612">
          <h3>
            <a
              class="item"
              href="http://0x80.pl/notesen/2024-12-21-uint8-division.html"
              >Dividing unsigned 8-bit numbers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 19:25:13</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42481612"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42481249">
          <h3>
            <a class="item" href="https://talktomehuman.com/demo"
              >Show HN: Demo of my web game about social persuasion</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 18:22:58</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42481249"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>I hope you enjoy, and would love to get your feedback!</p>
            </div>
          </section>
        </section>
        <section id="42481206">
          <h3>
            <a class="item" href="https://anvaka.github.io/city-roads/"
              >City Roads: A tool to draw all roads in a city at once</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 18:16:01</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42481206"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42480624">
          <h3>
            <a class="item" href="https://eonfall.com"
              >Show HN: Eonfall – A new third-person co-op action game built for
              the web</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 16:45:36</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42480624"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
            <div class="text">
              <p>
                It's been 2-years in the making built by a 2 man team. Eonfall,
                is a new third-person co-op action game with rogue-lite elements
                built exclusively for the web! We've finally reached a release
                candidate state and set our official public release date for Jan
                15th! The game's current version 5.0.0-beta is live and
                available to test play today!
              </p>
              <p>
                Unity game engine was used to develop the game along with other
                services to handle the backend, and Nuxt 3 + Nuxt UI to handle
                the front-end.
              </p>
              <p>
                We welcome any and all questions, feedback &amp; suggestions!
              </p>
              <p>Thanks all, Jon</p>
            </div>
          </section>
        </section>
        <section id="42480105">
          <h3>
            <a class="item" href="https://s2.dev/blog/intro">Introducing S2</a>
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 15:11:19</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42480105"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42479866">
          <h3>
            <a
              class="item"
              href="https://recleudo.com/under-googles-watchfull-eye-getting-out-of-a-manual-site-reputation-abuse-penalty-and-continuing-business-as-usual/"
              >Escaping Google's manual reputation penalty and resuming business
              as usual</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 14:24:53</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42479866"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42479233">
          <h3>
            <a class="item" href="https://github.com/malmeloo/FindMy.py"
              >Query Apple's FindMy network with Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 12:14:55</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42479233"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42476876">
          <h3>
            <a
              class="item"
              href="https://tigerbeetle.com/blog/2024-12-19-enum-of-arrays/"
              >Enum of Arrays</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 01:49:25</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42476876"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42476828">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/cybersecurity/us-judge-finds-israels-nso-group-liable-hacking-whatsapp-lawsuit-2024-12-21/"
              >US judge finds NSO Group liable for hacking journalists via
              WhatsApp</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 01:38:23</span
              ><span class="points-container"
                >Points: <span class="points">418</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42476828"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42475798">
          <h3>
            <a class="item" href="https://samwho.dev/turing-machines/"
              >Turing Machines</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-20 @ 22:37:14</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42475798"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42472519">
          <h3>
            <a class="item" href="https://github.com/rivet-gg/rivet"
              >Show HN: Rivet Actors – Durable Objects build with Rust,
              FoundationDB, Isolates</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-20 @ 16:36:33</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42472519"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <a href="https://news.ycombinator.com/item?id=37188659"
                >https://news.ycombinator.com/item?id=37188659</a
              >). In that time, a lot has changed that I think HN will find
              interesting.
              <p>
                Rivet is open-source actor infrastructure similar to
                Cloudflare's Durable Objects. Rivet itself already serves
                millions of MAU in production using our current container
                runtime – primarily for multiplayer games – and Rivet Actors are
                a new extension to support actor-like workloads. Rivet Actor's
                core primitives are RPC, state, and events.
              </p>
              <p>
                Actors are powered by Rust, V8 isolates (supports Deno), and
                FoundationDB. An architecture diagram is available here for [1].
                If you're not familiar with FoundationDB, you're overdue to
                watch Dave Rosenthal's talk [3]. (I firmly believe it's by far
                the best permissively licensed database; if only it had a well
                maintained SQL layer.)
              </p>
              <p>
                Here's where Rivet's architecture gets fun – we don't rely on a
                traditional orchestrator like Kubernetes or Nomad for our
                runtime. Instead, our orchestrator is powered by an in-house
                actor-like workflow engine – similar to how FoundationDB is
                powered by their own actor library (Flow [4]) internally. It
                lets us reliably &amp; efficiently build complex logic – like
                our orchestrator – that would normally be incredibly difficult
                to build correctly. For example, here's the logic that powers
                Rivet Actors themselves with complex mechanisms like retry
                upgrades, retry backoffs, and draining [2].
              </p>
              <p>
                One of the reasons we built Rivet Actors is because we tried to
                replace most of our Redis-based realtime infrastructure with
                Durable Objects. The architecture allowed us to build realtime
                features much faster &amp; efficiently, but the platform &amp;
                APIs were needlessly rigid and difficult to use. Our goal is to
                build an actor-like platform that includes the bells and
                whistles required for developers to benefit from the actor model
                without the learning curve of tools like Erlang/OTP, Akka, or
                Orleans.
              </p>
              <p>
                Rivet Actors provides a few key benefits in flexibility over
                Durable Objects:
              </p>
              <p>
                - Open-source (Apache 2.0) – built to be self-hosted and
                deployed on-prem
              </p>
              <p>
                - Provides observability out of the box, no Logpush required
              </p>
              <p>
                - Rivet Actors support the Deno runtime, so NPM &amp; JSR just
                works
              </p>
              <p>
                - @rivet-gg/actor [5] framework provides RPC, state, and events
                out of the box for faster bootstrapping; you can modify and
                deploy it yourself
              </p>
              <p>
                - Supports both V8 isolates &amp; Docker-compatible containers
                so you can run any software you'd like, like Godot/Unity servers
                or video transcoding
              </p>
              <p>- Also supports TCP &amp; UDP (we run games!)</p>
              <p>- Provides vanilla HTTP API for easy use with existing apps</p>
              <p>- Full control over regions</p>
              <p>
                There's plenty more that I don't have space to talk about. Give
                our docs a read if you'd like to learn more [6] or read about
                internal design decisions [7]. I'll be in the comments answering
                questions!
              </p>
              <p>Cheers, Nathan</p>
              <p>
                [1]
                <a
                  href="https://github.com/rivet-gg/rivet?tab=readme-ov-file#diagram"
                  >https://github.com/rivet-gg/rivet?tab=readme-ov-file#diagram</a
                >
              </p>
              <p>
                [2]
                <a
                  href="https://github.com/rivet-gg/rivet/blob/a3db31f3b5c351061d665003a6a8dfbf3372690b/packages/services/ds/src/workflows/server/pegboard/mod.rs#L49"
                  >https://github.com/rivet-gg/rivet/blob/a3db31f3b5c351061d665...</a
                >
              </p>
              <p>
                [3]
                <a href="https://www.youtube.com/watch?v=9g84y_60VGM"
                  >https://www.youtube.com/watch?v=9g84y_60VGM</a
                >
              </p>
              <p>
                [4]
                <a href="https://apple.github.io/foundationdb/flow.html"
                  >https://apple.github.io/foundationdb/flow.html</a
                >
              </p>
              <p>
                [5]
                <a href="https://jsr.io/@rivet-gg/actor/doc"
                  >https://jsr.io/@rivet-gg/actor/doc</a
                >
              </p>
              <p>
                [6] <a href="https://rivet.gg/docs">https://rivet.gg/docs</a>
              </p>
              <p>
                [7]
                <a href="https://rivet.gg/docs/internals/design-decisions"
                  >https://rivet.gg/docs/internals/design-decisions</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42472384">
          <h3>
            <a class="item" href="https://manifesto.getglu.dev/"
              >The CD Pipeline Manifesto</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-20 @ 16:19:18</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42472384"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42470254">
          <h3>
            <a class="item" href="https://signwith.co/"
              >Show HN: Get e-signatures &amp;amp; pay per signed doc</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-20 @ 11:33:10</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42470254"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <p>
                Last week, we started building signwith.co/ - a simple,
                pay-per-use e-signature tool for people who are struggling with
                complex e-sign tools.
              </p>
              <p>
                The plan was to build quietly, run a private beta, get 50 users
                in 15 days, and then do a launch. Easy peasy.
              </p>
              <p>
                But since Google dropped into the e-signature space - we needed
                to talk.
              </p>
              <p>
                So after 30 minutes of existential dread, a lot of “what are we
                even doing?” thoughts, and one strong dose of paracetamol
              </p>
              <p>we said, screw it. - let’s change gears.</p>
              <p>So now we're opening our beta, and here's the deal:</p>
              <p>
                • All the people who join will get free credits worth 10 signed
                docs • 12 months credit validity • No complexity • No hidden
                cost • No subscription commitment
              </p>
              <p>
                You can join the beta here -
                <a href="http://signwith.co">http://signwith.co</a>
              </p>
              <p>
                That said, we see Google's entry in the signature space as
                validation.
              </p>
              <p>This event expanded the market with such massive awareness.</p>
              <p>
                Let me be clear: We’re not trying to be DocuSign, Google, or any
                other enterprise beast.
              </p>
              <p>
                We’re indie makers and building for: • The freelancers • The
                consultants • The indie and small business owners • and anyone
                who just needs a contract signed—fast, simple, no headaches.
              </p>
              <p>
                Here’s how SignWith works: • Upload your doc • Drop signature
                spots • Send it out and track • Pay per signed document
              </p>
              <p>
                That’s it. No subscriptions. No feature bloat. No crazy hidden
                charges and no complex pricing tiers.
              </p>
              <p>
                If you've read it so far, would love to see you on the other
                side.
              </p>
              <p>
                And hey, if you’ve got any feedback, suggestions, or just want
                to tell us what you need, reply here or drop me a DM. We’re all
                ears!
              </p>
              <p>Cheers!</p>
            </div>
          </section>
        </section>
        <section id="42467937">
          <h3>
            <a
              class="item"
              href="https://thecodist.com/how-talking-over-a-wall-changed-my-direction-as-a-programmer/"
              >Talking over a wall changed my direction as a programmer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-20 @ 03:10:09</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42467937"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42462078">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=sI5DehAuT2I"
              >Wuppertal's suspended monorail proved its doubters wrong
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-19 @ 15:07:22</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42462078"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42460217">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/news/2024/dec/19/humphreys-world-how-the-samuel-smith-beer-baron-built-britains-strangest-pub-chain"
              >How the Samuel Smith beer baron built Britain's strangest pub
              chain</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-19 @ 10:38:06</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42460217"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42456492">
          <h3>
            <a
              class="item"
              href="https://www.16elt.com/2024/09/25/first-book-of-byte-sized-tech/"
              >Ideas from "A Philosophy of Software Design"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-18 @ 23:03:58</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42456492"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42456417">
          <h3>
            <a class="item" href="https://github.com/vlandeiro/yakari"
              >Show HN: Yakari – Interactive TUIs for CLI tools</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-18 @ 22:54:56</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42456417"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <p>
                I wanted to share Yakari, a tool I built to make command-line
                interfaces more approachable through interactive TUIs. If you've
                ever forgotten CLI flags or needed to look up command syntax,
                this might help.
              </p>
              <p>
                Yakari turns complex commands into interactive menus. Users can
                navigate through options with simple key presses instead of
                memorizing complex command structures. If you've used Emacs and
                Magit (or any other Transient) before, the interface will feel
                familiar.
              </p>
              <p>
                Features: - Transform CLIs into guided menus - Create custom
                menus for any CLI - Support for flags, named parameters,
                choices, and interactive inputs - Command history and contextual
                help
              </p>
              <p>You can try it out without installing thanks to uv [1]:</p>
              <p></p>
              <pre><code>  uvx --from yakari ykr demo # Play with a demo showcasing different argument types
  uvx --from yakari ykr git  # Try the git menu in any git repo
</code></pre>
              The project is built with Python using Textual and is heavily
              inspired by Emacs' Transient.
              <p>
                I'd love feedback from both CLI users and developers. What tools
                would you find most useful to have menus for? How could this
                make your terminal workflows easier?
              </p>
              <p>
                [1]
                <a href="https://docs.astral.sh/uv/"
                  >https://docs.astral.sh/uv/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42451968">
          <h3>
            <a
              class="item"
              href="https://www.greptile.com/blog/make-llms-shut-up"
              >How we made our AI code review bot stop leaving nitpicky
              comments</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-18 @ 16:31:46</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42451968"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42451640">
          <h3>
            <a class="item" href="https://colorify.rocks"
              >Generate Color Palettes from Text</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-18 @ 16:04:41</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42451640"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42451135">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/media/2024/dec/18/kenya-facebook-moderators-sue-after-diagnoses-of-severe-ptsd"
              >More than 140 Kenya Facebook moderators sue after diagnoses of
              PTSD</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-18 @ 15:20:09</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42451135"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42447628">
          <h3>
            <a
              class="item"
              href="https://practical.engineering/blog/2024/12/17/the-hidden-engineering-of-wildlife-crossings"
              >The Engineering of Wildlife Crossings</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-18 @ 02:34:36</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42447628"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42443210">
          <h3>
            <a
              class="item"
              href="https://thelampmagazine.com/issues/issue-26/the-one-hundred-pages-strategy"
              >The One Hundred Pages Strategy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-17 @ 17:24:36</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42443210"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42442852">
          <h3>
            <a
              class="item"
              href="https://coda.io/blog/about-coda/grammarly-acquires-coda"
              >Grammarly acquires Coda</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-17 @ 16:44:36</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42442852"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42441609">
          <h3>
            <a class="item" href="https://rubenerd.com/is-it-worth-saving/"
              >Is stuff online worth saving?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-17 @ 14:31:13</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42441609"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42439654">
          <h3>
            <a
              class="item"
              href="https://thasso.xyz/2024/12/16/fixing-c-strings.html"
              >Fixing C Strings</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-17 @ 09:00:11</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42439654"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
