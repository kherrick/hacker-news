<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40995867">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/SSHOurUniversalAccessProtocol"
              >SSH has become our universal (Unix) external access protocol</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 14:26:36</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40995867"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40995817">
          <h3>
            <a
              class="item"
              href="https://news.itsfoss.com/proton-mail-ai-assistant/"
              >Proton Mail Adds an Open-Source AI Writing Assistant to Take on
              Gmail</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 14:21:21</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40995817"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40995540">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/tsmc-set-report-strong-profit-stock-pressured-by-trump-comments-2024-07-18/"
              >TSMC rides AI demand to raise revenue forecast, says no to US
              joint venture</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 13:45:21</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40995540"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40995527">
          <h3>
            <a
              class="item"
              href="https://www.abc.net.au/news/science/2024-07-18/sparrows-lead-poisoning-children-blood-levels-health-mining/104075894"
              >Sparrows may be 'canary in the coal mine' for lead poisoning in
              children: study</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 13:44:27</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40995527"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40995515">
          <h3>
            <a
              class="item"
              href="https://stevejobsarchive.com/exhibits/objects-of-our-life"
              >Steve's Talk at the 1983 International Design Conference in
              Aspen</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 13:43:20</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40995515"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40995018">
          <h3>
            <a
              class="item"
              href="https://buildtrayd.notion.site/Senior-Software-Engineer-Trayd-b2e20c6b936e47b9870823a75e6c0604"
              >Trayd (YC S23) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 12:37:44</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40994898">
          <h3>
            <a class="item" href="https://fileconverter.tommyjepsen.com/"
              >Show HN: I made a privacy-friendly and free image, audio and
              video converter</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 12:18:53</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40994898"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40994817">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/travel/article/20240715-the-erie-canal-the-manmade-waterway-that-transformed-the-us"
              >The Erie Canal: The man-made waterway that transformed the US</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 12:05:14</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40994817"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40994552">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40994552"
              >Ask HN: What's Prolog Like in 2024?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 11:23:06</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40994552"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
            <div class="text">
              <p>
                While i have seen the basics of vanilla prolog (atoms,
                predicates, cuts, lists and all that jazz) and a godawful
                implementation of an agent communication system that works on
                SICStus prolog. I would like to know more because i think that
                this language might be a powerhouse in per se.
              </p>
              <p>
                Since my studies are quite basic in this regards i would like to
                expand my knowledge on it and kind of specialize myself both in
                this world and another world (ontologies :D) that i really
                enjoy.
              </p>
              <p>
                What's prolog like in 2024? what are you wonderful people doing
                with it?
              </p>
              <p>thanks from a dumbass :D</p>
            </div>
          </section>
        </section>
        <section id="40994087">
          <h3>
            <a class="item" href="https://mejorarimagen.org/"
              >Show HN: I made an AI image enhancer that boosts images 10x to
              12k pixels</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 10:02:03</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40994087"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                My wife is a designer, and one day she asked me if there was a
                tool to enhance images and improve their quality. I recommended
                a few to her, but she found that the suitable ones were too
                expensive, and the more affordable options didn't offer enough
                magnification, most only going up to 2x or 4x.
              </p>
              <p>
                So, I thought, why not create a tool that meets her needs, one
                that can greatly enhance image resolution and clarity while
                being very affordable to use?
              </p>
              <p>
                After over a month of effort, I finally completed this tool. It
                can now enlarge images up to 10 times, with a maximum support of
                12,000 pixels.
              </p>
              <p>
                I hope this tool will be as helpful to you as it is to my wife.
                would love your feedback pls
              </p>
              <p>Charles</p>
            </div>
          </section>
        </section>
        <section id="40993428">
          <h3>
            <a
              class="item"
              href="https://arendjr.nl/blog/2024/07/post-architecture-premature-abstraction-is-the-root-of-all-evil/"
              >Post-Architecture: Premature Abstraction Is the Root of All
              Evil</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 07:49:36</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40993428"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40992982">
          <h3>
            <a class="item" href="https://naya.lol"
              >My daughter (7 years old) used HTML to make a website</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 06:24:51</span
              ><span class="points-container"
                >Points: <span class="points">356</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40992982"
                  >Comments</a
                ><span class="descendants">: 200</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40991182">
          <h3>
            <a class="item" href="https://github.com/rscott2049/DECstation2040"
              >A RP2040 based DECstation 3000 emulator that can run
              DECWindows</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 23:11:26</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40991182"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40991075">
          <h3>
            <a
              class="item"
              href="https://ninjakoa.la/curly_curves/posts/quadratic_bezier_arc_length_parametrization/"
              >Closed form arc length parametrization is impossible for
              quadratic Bézier curves</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 22:51:39</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40991075"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40990768">
          <h3>
            <a
              class="item"
              href="https://www.wiz.io/blog/sapwned-sap-ai-vulnerabilities-ai-security"
              >SAPwned: SAP AI vulnerabilities expose customers' cloud
              environments and privat</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 22:02:39</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40990768"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40990641">
          <h3>
            <a class="item" href="https://github.com/seddonm1/sqlite-bench"
              >Show HN: SQLite Transaction Benchmarking Tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 21:44:42</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40990641"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <p>
                Explanatory blog post:
                <a href="https://reorchestrate.com/posts/sqlite-transactions/"
                  >https://reorchestrate.com/posts/sqlite-transactions/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="40989451">
          <h3>
            <a class="item" href="https://tracklist.it/"
              >Show HN: Product Hunt for Music</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 19:31:04</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40989451"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40989069">
          <h3>
            <a
              class="item"
              href="https://staff.um.edu.mt/afra1/seminar/little-languages.pdf"
              >Little Languages (1986) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 18:51:00</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40989069"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40988954">
          <h3>
            <a
              class="item"
              href="https://developer.nvidia.com/blog/nvidia-transitions-fully-towards-open-source-gpu-kernel-modules/"
              >NVIDIA Transitions Fully Towards Open-Source Linux GPU Kernel
              Modules</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 18:40:36</span
              ><span class="points-container"
                >Points: <span class="points">711</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40988954"
                  >Comments</a
                ><span class="descendants">: 200</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40988837">
          <h3>
            <a class="item" href="https://pldb.io/blog/brianKernighan.html"
              >A brief interview with Awk creator Dr. Brian Kernighan (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 18:28:44</span
              ><span class="points-container"
                >Points: <span class="points">199</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40988837"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40988395">
          <h3>
            <a
              class="item"
              href="https://science.anu.edu.au/news-events/news/unexpected-poetry-phd-acknowledgements"
              >The unexpected poetry of PhD acknowledgements</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 17:44:38</span
              ><span class="points-container"
                >Points: <span class="points">271</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40988395"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40988076">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/prover-verifier-games-improve-legibility/"
              >Prover-Verifier Games improve legibility of language model
              outputs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 17:15:37</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40988076"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40987730">
          <h3>
            <a
              class="item"
              href="https://www.da.vidbuchanan.co.uk/blog/r1-jailbreak.html"
              >Jailbreaking RabbitOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 16:41:38</span
              ><span class="points-container"
                >Points: <span class="points">993</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40987730"
                  >Comments</a
                ><span class="descendants">: 233</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40987402">
          <h3>
            <a class="item" href="https://thetinypod.com/"
              >TinyPod – Apple Watch case with scroll wheel</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 16:08:22</span
              ><span class="points-container"
                >Points: <span class="points">809</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40987402"
                  >Comments</a
                ><span class="descendants">: 287</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40986894">
          <h3>
            <a class="item" href="https://matt.sh/panic-at-the-job-market"
              >Panic at the Job Market</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 15:25:11</span
              ><span class="points-container"
                >Points: <span class="points">1535</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40986894"
                  >Comments</a
                ><span class="descendants">: 1326</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40985609">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40985609"
              >Launch HN: Traceloop (YC W23) – Detecting LLM Hallucinations with
              OpenTelemetry</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 13:19:03</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40985609"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.traceloop.com">https://www.traceloop.com</a
              >). We help teams understand when their LLM apps are failing or
              hallucinating at scale. See a demo:
              <a href="https://www.traceloop.com/video"
                >https://www.traceloop.com/video</a
              >
              or try it yourself at
              <a href="https://www.traceloop.com/docs/demo"
                >https://www.traceloop.com/docs/demo</a
              >.
              <p>
                When moving your LLM app to production, significant scale makes
                it harder for engineers and data scientists alike to understand
                when their LLM is hallucinating or returning malformed
                responses. When you get to millions of calls to OpenAI a month,
                methods like “LLM as a judge” can’t work at a reasonable cost or
                latency. So, what most people we talked to usually do is sample
                some generations by hand, maybe for some specific important
                customers, and manually look for errors or hallucinations.
              </p>
              <p>
                Traceloop is a monitoring platform that detects when your LLM
                app fails. Under the hood, we built real-time versions of known
                metrics like faithfulness, relevancy, redundancy, and many
                others. These are loosely based on some well-known NLP metrics
                that work well for LLM-generated texts. We correlate them with
                changes we detect in your system - like updates to prompts or to
                the model you’re using - to detect regressions automatically.
              </p>
              <p>Here are some cool examples we’ve seen with our customers -</p>
              <p>
                1. Applying our QA relevancy metric to an entity extraction
                task, we managed to discover issues where the model was not
                extracting the right entities (like an address instead of a
                person’s name); or returning random answers like “I’m here! What
                can I help you with today?”.
              </p>
              <p>
                2. Our soft-faithfulness metric was able to detect cases in
                summarization tasks where a model was completely making up stuff
                that never appeared in the original text.
              </p>
              <p>
                One of the challenges we faced was figuring out how to collect
                the data that we need from our customers' LLM apps. That’s where
                OpenTelemetry came in handy. We built OpenLLMetry (<a
                  href="https://github.com/traceloop/openllmetry"
                  >https://github.com/traceloop/openllmetry</a
                >), and announced it here almost a year ago. It standardized the
                use of OpenTelemetry to observe LLM apps. We realized that the
                concepts of traces, spans, metrics, and logs that were
                standardized with OpenTelemetry can easily extend to gen AI. We
                partnered with 20+ observability platforms to make sure that
                OpenLLMetry becomes the standard for GenAI observability and
                that the data that we collect can be sent to other platforms as
                well.
              </p>
              <p>
                We plan to extend the metrics we provide to support agents that
                use tools, vision models, and other amazing developments in our
                fast-paced industry.
              </p>
              <p>
                We invite you to give Traceloop a spin and are eager for your
                feedback! How do you track and debug hallucinations? How much
                has that been an issue for you? What types of hallucinations
                have you encountered?
              </p>
            </div>
          </section>
        </section>
        <section id="40985433">
          <h3>
            <a
              class="item"
              href="https://dalpix.com/reverse-engineering-ip-camera-part-1"
              >Reverse-Engineering an IP Camera (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 13:02:19</span
              ><span class="points-container"
                >Points: <span class="points">173</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40985433"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40976776">
          <h3>
            <a
              class="item"
              href="https://undark.org/2024/07/15/enigmatic-earthquake-hotspot-america-heartland/"
              >The struggle to understand why earthquakes happen in America's
              heartland</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-16 @ 14:07:52</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40976776"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40972609">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2003.10555"
              >Electra: Pre-Training Text Encoders as Discriminators Rather Than
              Generators (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-16 @ 00:18:20</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40972609"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40958937">
          <h3>
            <a
              class="item"
              href="https://dl.acm.org/doi/10.1145/2508859.2516734"
              >Elligator: Elliptic-curve points indistinguishable from uniform
              random strings (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-14 @ 04:58:27</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40958937"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
