<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46600729">
          <h3>
            <a
              class="item"
              href="https://usafacts.org/articles/why-have-death-rates-from-accidental-falls-tripled/"
              >Why have death rates from accidental falls tripled?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 13:32:44</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46600729"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46600194">
          <h3>
            <a
              class="item"
              href="https://freedomnews.org.uk/2025/04/11/how-the-uk-is-shaping-a-future-of-precrime-and-dissent-management/"
              >The UK is shaping a future of Precrime and dissent management</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 12:39:03</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46600194"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46600092">
          <h3>
            <a class="item" href="https://snackbase.dev"
              >Show HN: SnackBase – Open-source, GxP-compliant back end for
              Python teams</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 12:27:53</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46600092"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built this because I work in Healthcare and Life Sciences
                domain and was tired of spending months building the same
                "compliant" infrastructure (Audit Logs, Row-Level Security, PII
                Masking, Auth) before writing any actual product code.
              </p>
              <p>
                The Problem: Existing BaaS tools (Supabase, Appwrite) are
                amazing, but they are hard to validate for GxP (FDA regulations)
                and often force you into a JS/Go ecosystem. I wanted something
                native to the Python tools I already use.
              </p>
              <p>
                The Solution: SnackBase is a self-hosted Python (FastAPI +
                SQLAlchemy) backend that includes:
              </p>
              <p>
                Compliance Core: Immutable audit logs with blockchain-style
                hashing (prev_hash) for integrity.
              </p>
              <p>
                Native Python Hooks: You can write business logic in pure Python
                (no webhooks or JS runtimes required).
              </p>
              <p>
                Clean Architecture: Strict separation of layers. No business
                logic in the API routes.
              </p>
              <p>The Stack:</p>
              <p>Python 3.12 + FastAPI</p>
              <p>SQLAlchemy 2.0 (Async)</p>
              <p>React 19 (Admin UI)</p>
              <p>Links:</p>
              <p>
                Live Demo:
                <a href="https://demo.snackbase.dev"
                  >https://demo.snackbase.dev</a
                >
              </p>
              <p>
                Repo:
                <a href="https://github.com/lalitgehani/snackbase"
                  >https://github.com/lalitgehani/snackbase</a
                >
              </p>
              <p>
                The demo resets every hour. I’d love feedback on the DSL
                implementation or the audit logging approach.
              </p>
            </div>
          </section>
        </section>
        <section id="46599897">
          <h3>
            <a
              class="item"
              href="https://blog.mozilla.org/en/mozilla/mozilla-open-source-ai-strategy/"
              >Owners, not renters: Mozilla's open source AI strategy</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 12:00:12</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46599897"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46599574">
          <h3>
            <a
              class="item"
              href="https://www.heraldscotland.com/news/25759181.network-scottish-x-accounts-go-dark-amid-iran-blackout/"
              >Network of Scottish X accounts go dark amid Iran blackout</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 11:19:01</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46599574"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46599341">
          <h3>
            <a class="item" href="https://primoco.me/en/"
              >Show HN: An iOS budget app I've been maintaining since 2011</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 10:44:39</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46599341"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
            <div class="text">
              <p>
                At the time, my plan was to replace a few larger shareware
                projects with several smaller apps to spread the risk. That
                didn’t quite work out — one app, MoneyControl, quickly grew so
                much that it became my main focus.
              </p>
              <p>
                Fifteen years later, the app is still on the App Store, still
                actively developed, and still used by people who started with
                version 1.0. Many apps from that era are long gone.
              </p>
              <p>
                Looking back, these are some of the things that mattered most:
              </p>
              <p>
                Starting early helped, but wasn’t enough on its own. Early
                visibility made a difference, but long-term maintenance and
                reliability are what kept users.
              </p>
              <p>
                Focus beat diversification. I wanted many small apps. I ended up
                with one large, long-lived product. Deep focus turned out to be
                more sustainable.
              </p>
              <p>
                Long-term maintenance is most of the work. Adapting to new iOS
                versions, migrating data safely, handling edge cases, and
                keeping old data usable mattered more than flashy features.
              </p>
              <p>
                Discoverability keeps getting harder. Reaching users on the App
                Store today is much more difficult than it was years ago. Prices
                are higher than in the old 99-cent days, but visibility hasn’t
                improved.
              </p>
              <p>
                I’m a developer first, not a marketer. I work alone, with
                occasional help from freelancers. No employees, no growth team.
                The app could probably have grown more with better marketing,
                but that was never my strength.
              </p>
              <p>
                You don’t need to get rich to build something sustainable. I
                didn’t build this for an exit. I’ve been able to make a living
                from my work for over 20 years, which feels like success to me.
              </p>
              <p>
                Building things you actually use keeps you honest. Every product
                I built was something I personally needed. That authenticity
                mattered more than any roadmap.
              </p>
              <p>
                This week I released version 10 with a new design and a major
                technical overhaul. It feels less like a milestone and more like
                preparing the app for the next phase.
              </p>
              <p>
                Happy to answer questions about long-term app maintenance, indie
                development, or keeping a product alive across many iOS
                generations.
              </p>
            </div>
          </section>
        </section>
        <section id="46598991">
          <h3>
            <a
              class="item"
              href="https://fosdem.org/2026/schedule/event/FE7ULY-foss-in-times-of-war-scarcity-and-ai/"
              >FOSS in times of war, scarcity and (adversarial) AI [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 09:47:59</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46598991"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46597927">
          <h3>
            <a
              class="item"
              href="https://chromium-review.googlesource.com/c/chromium/src/+/7184969"
              >Chromium Has Merged JpegXL</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 06:42:49</span
              ><span class="points-container"
                >Points: <span class="points">212</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46597927"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46597518">
          <h3>
            <a
              class="item"
              href="https://cssence.com/2026/text-based-web-browsers/"
              >Text-based web browsers</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 05:16:10</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46597518"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46593802">
          <h3>
            <a class="item" href="https://www.bellard.org/ts_zip/"
              >Fabrice Bellard's TS Zip (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 20:26:47</span
              ><span class="points-container"
                >Points: <span class="points">192</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46593802"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46593395">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=c0mLhHDcY3I"
              >The chess bot on Delta Air Lines will destroy you (2024)
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 19:57:37</span
              ><span class="points-container"
                >Points: <span class="points">279</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46593395"
                  >Comments</a
                ><span class="descendants">: 245</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46593022">
          <h3>
            <a
              class="item"
              href="https://claude.com/blog/cowork-research-preview"
              >Cowork: Claude Code for the rest of your work</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 19:27:19</span
              ><span class="points-container"
                >Points: <span class="points">1085</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46593022"
                  >Comments</a
                ><span class="descendants">: 476</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46591708">
          <h3>
            <a class="item" href="https://walzr.com/postal-arbitrage"
              >Postal Arbitrage</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 17:41:50</span
              ><span class="points-container"
                >Points: <span class="points">459</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46591708"
                  >Comments</a
                ><span class="descendants">: 236</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46591100">
          <h3>
            <a class="item" href="https://www.trylad.com"
              >Show HN: AI in SolidWorks</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 16:56:17</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46591100"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.trylad.com/">https://www.trylad.com/</a>).
              <p>
                We come from software engineering backgrounds where tools like
                Claude Code and Cursor have come to dominate, but when poking
                around CAD systems a few months back we realized there's no way
                to go from a text prompt input to a modeling output in any of
                the major CAD systems. In our testing, the LLMs aren't as good
                at making 3D objects as they are are writing code, but we think
                they'll get a lot better in the upcoming months and years.
              </p>
              <p>
                To bridge this gap, we've created LAD, an add-in in SolidWorks
                to turn conversational input and uploaded documents/images into
                parts, assemblies, and macros. It includes:
              </p>
              <p>
                - Dozens of tools the LLM can call to create sketches, features,
                and other objects in parts.
              </p>
              <p>
                - Assembly tools the LLM can call to turn parts into assemblies.
              </p>
              <p>
                - File system tools the LLM can use to create, save, search, and
                read SolidWorks files and documentation.
              </p>
              <p>
                - Macro writing/running tools plus a SolidWorks API
                documentation search so the LLM can use macros.
              </p>
              <p>
                - Automatic screenshots and feature tree parsing to provide the
                LLM context on the current state.
              </p>
              <p>
                - Checkpointing to roll back unwanted edits and permissioning to
                determine which commands wait for user permission.
              </p>
              <p>
                You can try LAD at
                <a href="https://www.trylad.com/">https://www.trylad.com/</a>
                and let us know what features would make it more useful for your
                work. To be honest, the LLMs aren't great at CAD right now, but
                we're mostly curious to hear if people would want and use this
                if it worked well.
              </p>
            </div>
          </section>
        </section>
        <section id="46590280">
          <h3>
            <a class="item" href="https://github.com/haykgrigo3/TimeCapsuleLLM"
              >TimeCapsuleLLM: LLM trained only on data from 1800-1875</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 16:04:27</span
              ><span class="points-container"
                >Points: <span class="points">660</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46590280"
                  >Comments</a
                ><span class="descendants">: 273</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46589675">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2026/01/12/apple-google-ai-siri-gemini.html"
              >Apple picks Gemini to power Siri</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 15:22:21</span
              ><span class="points-container"
                >Points: <span class="points">928</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46589675"
                  >Comments</a
                ><span class="descendants">: 568</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46589658">
          <h3>
            <a
              class="item"
              href="https://piccalil.li/blog/date-is-out-and-temporal-is-in/"
              >Date is out, Temporal is in</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 15:20:36</span
              ><span class="points-container"
                >Points: <span class="points">418</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46589658"
                  >Comments</a
                ><span class="descendants">: 173</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46588837">
          <h3>
            <a
              class="item"
              href="https://www.npopov.com/2026/01/11/LLVM-The-bad-parts.html"
              >LLVM: The bad parts</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 14:18:13</span
              ><span class="points-container"
                >Points: <span class="points">360</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46588837"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46588132">
          <h3>
            <a class="item" href="https://github.com/er-bharat/Win8DE"
              >Windows 8 Desktop Environment for Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 13:22:44</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46588132"
                  >Comments</a
                ><span class="descendants">: 207</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46587934">
          <h3>
            <a
              class="item"
              href="https://blog.smartere.dk/2026/01/floppy-disks-the-best-tv-remote-for-kids/"
              >Floppy disks turn out to be the greatest TV remote for kids</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 13:07:49</span
              ><span class="points-container"
                >Points: <span class="points">687</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46587934"
                  >Comments</a
                ><span class="descendants">: 391</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46586766">
          <h3>
            <a class="item" href="https://archaeologist.dev/artifacts/anthropic"
              >Anthropic made a mistake in cutting off third-party clients</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 10:57:29</span
              ><span class="points-container"
                >Points: <span class="points">333</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46586766"
                  >Comments</a
                ><span class="descendants">: 221</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46581095">
          <h3>
            <a class="item" href="https://cy.md/opencode-rce/"
              >Unauthenticated remote code execution in OpenCode</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-11 @ 22:33:32</span
              ><span class="points-container"
                >Points: <span class="points">372</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46581095"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
            <div class="text">
              Previous versions of OpenCode started a server which allowed any
              website visited in a web browser to execute arbitrary commands on
              the local machine. Make sure you are using v1.1.10 or newer; see
              link for more details.
            </div>
          </section>
        </section>
        <section id="46557733">
          <h3>
            <a
              class="item"
              href="https://s3data.computerhistory.org/brochures/cray.cray1.1977.102638650.pdf"
              >The Cray-1 Computer System (1977) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-09 @ 19:05:04</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46557733"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46554775">
          <h3>
            <a
              class="item"
              href="https://theushen.medium.com/designing-an-ipv6-native-p2p-transport-lessons-from-building-i6p-b8ca216d1d73"
              >Designing an IPv6-native P2P transport – lessons from building
              I6P</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-09 @ 15:17:45</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46554775"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46549714">
          <h3>
            <a
              class="item"
              href="https://tinyhack.com/2014/03/12/implementing-a-web-server-in-a-single-printf-call/"
              >Implementing a web server in a single printf() call (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-09 @ 03:24:12</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46549714"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46549039">
          <h3>
            <a class="item" href="https://github.com/risc0/zirgen"
              >Zirgen: Compiler for a Domain-Specific Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-09 @ 01:29:29</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46549039"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46545636">
          <h3>
            <a
              class="item"
              href="https://elbowgreasegames.substack.com/p/introducing-robotopia-a-3d-first"
              >Robotopia: A 3D, first-person, talking simulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-08 @ 19:55:27</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46545636"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46541848">
          <h3>
            <a
              class="item"
              href="https://turbopuffer.com/blog/bm25-latency-musings"
              >Why BM25 queries with more terms can be faster (and other scaling
              surprises)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-08 @ 15:03:35</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46541848"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46540126">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-025-04150-w"
              >Some ecologists fear their field is losing touch with nature</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-08 @ 12:07:31</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46540126"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46531425">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/art-frame-tv-trends/"
              >The Inevitable Rise of the Art TV</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-07 @ 19:40:07</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46531425"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
