<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40300358">
          <h3>
            <a class="item" href="https://apply.workable.com/oven/j/A7A1388873/"
              >Bun (YC S19) Is Hiring Systems Engineers in San Francisco</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 17:00:25</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40300126">
          <h3>
            <a class="item" href="https://www.grafychat.com"
              >Show HN: I built a non-linear UI for ChatGPT</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 16:41:12</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40300126"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built this out of frustration of the evergrowing list of AI
                models and features to try and to fit my workflow.
              </p>
              <p>
                The visual approach clicks for me so i went with it, it provides
                more freedom and control of the outcome, because predictable
                results and increased productivity is what I’m after when using
                conversational AI.
              </p>
              <p>
                The app is packed with features, my most used are prompt
                library, voice input and text search, narration is useful too.
              </p>
              <p>
                The app is local-first and works right in the browser, no sign
                up needed and it's absolutely free to try.
              </p>
              <p>BYOAK – bring your own API Keys.</p>
              <p>Let me know what you think, any feedback is appreciated!</p>
            </div>
          </section>
        </section>
        <section id="40300023">
          <h3>
            <a
              class="item"
              href="https://pitchfork.com/news/steve-albini-storied-producer-and-icon-of-the-rock-underground-dies-at-61/"
              >Steve Albini, Storied Producer and Icon of the Rock Underground,
              Dies at 61</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 16:33:23</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40300023"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40300009">
          <h3>
            <a
              class="item"
              href="https://productidentity.co/p/beautiful-ugly-websites"
              >Beautiful Ugly Websites</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 16:32:10</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40300009"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40299991">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2024/5/7/24151497/tesla-lidar-luminar-elon-musk-sensor-autonomous"
              >Tesla bought over $2M worth of Lidar from Luminar</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 16:31:01</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40299991"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40299761">
          <h3>
            <a class="item" href="https://github.com/neondatabase/psql-describe"
              >Psql-describe: \d ported to JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 16:14:23</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40299761"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40299645">
          <h3>
            <a
              class="item"
              href="https://www.twz.com/sea/rifle-armed-robot-dogs-now-being-tested-by-marine-special-operators"
              >Rifle-Armed Robot Dogs Now Being Tested by Marine Special
              Operators</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 16:02:59</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40299645"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40299271">
          <h3>
            <a
              class="item"
              href="https://www.livescience.com/technology/electronics/ev-batteries-could-last-much-longer-thanks-to-new-capacitor-with-19-times-power-density-that-scientists-created-by-mistake"
              >New capacitor with 19-times energy density</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 15:33:37</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40299271"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40299267">
          <h3>
            <a
              class="item"
              href="https://www.axios.com/2024/05/06/library-librarians-e-books-license-policies"
              >U.S. libraries are battling high prices for better e-book
              access</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 15:33:16</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40299267"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40299091">
          <h3>
            <a class="item" href="https://devv.ai"
              >Show HN: I made a better Perplexity for developers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 15:19:40</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40299091"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <p>
                I am Jiayuan, and I'm here to introduce a tool we've been
                building over the past few months: Devv (<a
                  href="https://devv.ai"
                  >https://devv.ai</a
                >). In simple terms, it is an AI-powered search engine
                specifically designed for developers.
              </p>
              <p>
                Now, you might ask, with so many AI search engines already
                available—Perplexity, You.com, Phind, and several open-source
                projects—why do we need another one?
              </p>
              <p>
                We all know that Generative Search Engines are built on RAG
                (Retrieval-Augmented Generation)[1] combined with Large Language
                Models (LLMs). Most of the products mentioned above use indexes
                from general search engines (like Google/Bing APIs), but we've
                taken a different approach.
              </p>
              <p>
                We've created a vertical search index focused on the development
                domain, which includes:
              </p>
              <p>
                - Documents: These are essentially the single source of truth
                for programming languages or libraries; I believe many of you
                are users of Dash (<a href="https://kapeli.com/dash"
                  >https://kapeli.com/dash</a
                >) or devdocs (<a href="https://devdocs.io/"
                  >https://devdocs.io/</a
                >).
              </p>
              <p>
                - Code: While not natural language, code contains rich
                contextual information. If you have a question related to the
                Django framework, nothing is more convincing than code snippets
                from Django's repository.
              </p>
              <p>
                - Web Search: We still use data from search engines because
                these results contain additional contextual information.
              </p>
              <p>Our reasons for doing this include:</p>
              <p>
                - The quality of the index is crucial to the RAG system; its
                effectiveness determines the output quality of the entire
                system.
              </p>
              <p>
                - We focus more on the Index (RAG) rather than LLMs because LLMs
                evolve rapidly; even models performing well today may be
                superseded by better ones in a few months, and fine-tuning an
                LLM now has relatively low costs.
              </p>
              <p>
                - All players are currently exploring what kind of LLM product
                works best; we hope to contribute some different insights
                ourselves (and plan to open source parts of our underlying
                infrastructure in return for contributions back into open source
                communities).
              </p>
              <p>Some brief product features:</p>
              <p>
                - Three modes: - Fast mode: Offers quick answers within seconds.
                - Agent mode: For complex queries where Devv Agent infers your
                question before selecting appropriate solutions. - GitHub
                mode(currently in beta): Links directly with your own GitHub
                repositories allowing inquiries about specific codebases.
              </p>
              <p>- Clean &amp; intuitive UI/UX design.</p>
              <p>
                - Currently only available as web version but Chrome extension
                &amp; VSCode plugin planned soon!
              </p>
              <p>Technical details regarding how we build our Index:</p>
              <p>
                - Documents section involves crawling most documentation sources
                using scripts inspired by devdocs project’s crawler logic then
                slicing them up according function/symbol dimensions before
                embedding into vector databases;
              </p>
              <p>
                - Codes require special treatment beyond just embeddings alone
                hence why custom parsers were developed per language type
                extracting logical structures within repos such as architectural
                layouts calling relationships between functions definitions
                etc., semantically processed via LMM;
              </p>
              <p>
                - Web searches combine both selfmade indices targeting developer
                niches alongside traditional API based methods. We crawled
                relevant sites including blogs forums tech news outlets etc..
              </p>
              <p>
                For the Agent Mode, we have actually developed a multi-agent
                framework. It first categorizes the user's query and then
                selects different agents based on these categories to address
                the issues. These various agents employ different models and
                solution steps.
              </p>
              <p>Future Plans:</p>
              <p>
                - Build a more comprehensive index that includes internal
                context (The Devv for Teams version will support indexing team
                repositories, documents, issue trackers for Q&amp;A)
              </p>
              <p>
                - Fully localized: All of the above technologies can be executed
                locally, ensuring privacy and security through complete
                localization.
              </p>
              <p>
                Devv is still in its very early stages and can be used without
                logging in. We welcome everyone to experience it and provide
                feedback on any issues; we will continue to iterate on it.
              </p>
              <p>
                [1]:
                <a href="https://arxiv.org/abs/2005.11401"
                  >https://arxiv.org/abs/2005.11401</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="40298927">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/ai/google-deepmind-isomorphic-alphafold-3-ai-model/"
              >AlphaFold 3 predicts the structure and interactions of all of
              life's molecules</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 15:07:10</span
              ><span class="points-container"
                >Points: <span class="points">358</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40298927"
                  >Comments</a
                ><span class="descendants">: 154</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40298304">
          <h3>
            <a
              class="item"
              href="https://sprocketfox.io/xssfox/2024/05/08/jbos/"
              >Just a Bunch of Scanners (JBOS?)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 14:09:29</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40298304"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40297946">
          <h3>
            <a class="item" href="https://github.com/google-research/timesfm"
              >TimesFM (Time Series Foundation Model) for time-series
              forecasting</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 13:34:34</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40297946"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40297748">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/marine/seabike-swimming-propeller/"
              >'Underwater bicycle' propels swimmers forward at superhuman
              speed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 13:13:22</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40297748"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40297502">
          <h3>
            <a
              class="item"
              href="https://www.kiipeilytuomas.fi/articles-in-english/pulley-system-composition-a-systematic-approach/"
              >Pulley system composition – a systematic approach (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 12:48:19</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40297502"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40297280">
          <h3>
            <a class="item" href="https://github.com/google/zimtohrli"
              >Zimtohrli: A New Psychoacoustic Perceptual Metric for Audio
              Compression</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 12:30:17</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40297280"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40297043">
          <h3>
            <a class="item" href="https://github.com/kxxt/tracexec"
              >Show HN: Tracexec – TUI for tracing execve and pre-exec
              behavior</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 12:04:02</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40297043"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>
                It's useful for debugging build systems, catching fd leaks,
                understanding what shell scripts actually do, figuring out what
                programs does a proprietary software run, etc.
              </p>
            </div>
          </section>
        </section>
        <section id="40296744">
          <h3>
            <a
              class="item"
              href="https://www.damninteresting.com/who-wants-to-be-a-thousandaire/"
              >Who Wants to Be a Thousandaire? (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 11:27:23</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40296744"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40296429">
          <h3>
            <a class="item" href="https://github.com/irrustible/ointers"
              >Ointers: A library for representing pointers where bits have been
              stolen (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-08 @ 10:42:02</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40296429"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40287020">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=ymyIEGRw4-U"
              >Road resurfacing during the daytime without stopping traffic
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-07 @ 15:36:05</span
              ><span class="points-container"
                >Points: <span class="points">821</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40287020"
                  >Comments</a
                ><span class="descendants">: 272</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40284225">
          <h3>
            <a
              class="item"
              href="https://sympathetic.ink/2024/01/24/Chapter-1-The-birth-of-Parquet.html"
              >The Birth of Parquet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-07 @ 11:09:23</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40284225"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40284144">
          <h3>
            <a
              class="item"
              href="http://archive.wilsonquarterly.com/essays/how-build-suburb"
              >How to Build a Suburb (1995)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-07 @ 10:53:00</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40284144"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40283752">
          <h3>
            <a
              class="item"
              href="https://github.com/EtherDream/headphone-morse-transmitter"
              >Using AirPods as a Morse Transmitter</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-07 @ 09:31:44</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40283752"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40283474">
          <h3>
            <a
              class="item"
              href="https://jasongullickson.com/an-operating-system-for-the-web.html"
              >An operating system for the web</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-07 @ 08:27:56</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40283474"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40283364">
          <h3>
            <a class="item" href="https://plentycom.jp/en/steermouse/index.html"
              >SteerMouse</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-07 @ 07:57:44</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40283364"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40282671">
          <h3>
            <a
              class="item"
              href="https://hakaimagazine.com/features/the-magnificent-lives-and-quiet-loss-of-muskrats/"
              >The Waning Reign of the Muskrat</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-07 @ 05:34:07</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40282671"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40272514">
          <h3>
            <a
              class="item"
              href="https://ifesunmola.com/how-to-use-the-foreign-function-api-in-java-22-to-call-c-libraries/"
              >How to Use the Foreign Function API in Java 22 to Call C
              Libraries</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 08:40:02</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40272514"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40272339">
          <h3>
            <a class="item" href="https://climbing.ai/"
              >Show HN: AI climbing coach – visualize how to climb any route
              based on your body</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 08:09:38</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40272339"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
            <div class="text">
              <p>
                You can see the demo here:
                <a href="https://www.youtube.com/watch?v=cnvNPWoYZz4"
                  >https://www.youtube.com/watch?v=cnvNPWoYZz4</a
                >
              </p>
              <p>
                Will be open sourcing the model, backend, and frontend codebase
                soon!
              </p>
            </div>
          </section>
        </section>
        <section id="40271797">
          <h3>
            <a class="item" href="https://faultlore.com/blah/abi-puns/"
              >Pair Your Compilers at the ABI Café</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 06:35:04</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40271797"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40263377">
          <h3>
            <a
              class="item"
              href="https://www.merriam-webster.com/wordplay/your-deadline-wont-kill-you"
              >The Bloody History of 'Deadline'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 09:23:54</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40263377"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
