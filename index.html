<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36890209">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/tiny-blue-beads-european-artifact-north-america-old-180976966/"
              >Venetian Glass Beads May Be Oldest European Artifacts Found in
              North America</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 07:37:35</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36890209"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36889703">
          <h3>
            <a
              class="item"
              href="https://jlericson.com/2023/07/26/not_understanding.html"
              >Stack Overflow's CEO Doesn't Understand Stack Overflow</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 06:28:08</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36889703"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36889484">
          <h3>
            <a
              class="item"
              href="https://docs.google.com/document/d/1a6p7-nbk5PVyM1S2tmccFrrIuGzCyzclstBtaciHxVw/mobilebasic"
              >Go 1.22 Inlining Overhaul</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 05:59:07</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36889484"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36889213">
          <h3>
            <a class="item" href="https://ieeexplore.ieee.org/document/6512701"
              >OFDM: Emperor Has No Clothes?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 05:16:44</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36889213"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36889092">
          <h3>
            <a
              class="item"
              href="https://kvm-forum.qemu.org/media/2023/submissions/GDRJLK/resources/macOS_in_QEMU_on_ARM_FhJY65D.pdf"
              >macOS in QEMU (ARM edition) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 04:57:07</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36889092"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36888954">
          <h3>
            <a
              class="item"
              href="https://mail.tarsnap.com/tarsnap-announce/msg00050.html"
              >Tarsnap outage postmortem</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 04:33:56</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36888954"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36888948">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2307.14334"
              >Google Med-Palm M: Towards Generalist Biomedical AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 04:32:46</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36888948"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36888931">
          <h3>
            <a
              class="item"
              href="https://longnow.org/ideas/the-heresy-of-decline/"
              >The Heresy of Decline</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 04:30:16</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36888931"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36888667">
          <h3>
            <a
              class="item"
              href="https://blog.marcua.net/2022/02/20/data-diffs-algorithms-for-explaining-what-changed-in-a-dataset.html"
              >Data diffs: Algorithms for explaining what changed in a dataset
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 03:43:31</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36888667"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36888598">
          <h3>
            <a class="item" href="https://eupnea-linux.github.io/"
              >Your Chromebook, Your Way</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 03:34:01</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36888598"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36888444">
          <h3>
            <a
              class="item"
              href="https://discuss.systems/@adrian/110783401400871208"
              >Super sorry to the guy with the username reset on GitHub</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 03:11:11</span
              ><span class="points-container"
                >Points: <span class="points">231</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36888444"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36888442">
          <h3>
            <a
              class="item"
              href="https://www.infoq.com/news/2023/06/CI-product-feedback/"
              >Treat Your CI System as a Product for Faster and Better
              Feedback</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 03:10:38</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36888442"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36888156">
          <h3>
            <a
              class="item"
              href="https://www.neelc.org/posts/google-webauth-palladium/"
              >Google Web Environment Integrity Is the New Microsoft Trusted
              Computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 02:28:37</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36888156"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36887721">
          <h3>
            <a
              class="item"
              href="https://ryantravitz.com/blog/2023-02-18-pull-of-the-undercurl/"
              >Pull of the Undercurl</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 01:32:40</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36887721"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36887712">
          <h3>
            <a class="item" href="https://paper.mmm.dev/">An Internet Canvas</a>
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 01:31:45</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36887712"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36887711">
          <h3>
            <a class="item" href="https://github.com/BerriAI/litellm"
              >Show HN: Litellm – simple library to standardize OpenAI, Cohere,
              Azure LLM I/O</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 01:31:35</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36887711"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              I built this library because langchain was too bloated and I
              needed a simple abstraction to call multiple LLM APIs. litellm has
              two functions - completion(), embedding()
            </div>
          </section>
        </section>
        <section id="36887447">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/rainmaker/jobs/wzsHtSb-platform-full-stack-engineer"
              >Rainmaker (YC W23) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 01:00:06</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36887412">
          <h3>
            <a class="item" href="https://github.com/ThousandBirdsInc/chidori"
              >Chidori – Declarative framework for AI agents (Rust, Python, and
              Node.js)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 00:56:39</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36887412"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36887091">
          <h3>
            <a
              class="item"
              href="https://log.schemescape.com/posts/programming-languages/learning-lisp-in-2023.html"
              >It's 2023, so of course I'm learning Common Lisp</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 00:21:46</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36887091"
                  >Comments</a
                ><span class="descendants">: 189</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36886605">
          <h3>
            <a
              class="item"
              href="https://blog.jupyter.org/announcing-jupyter-notebook-7-8d6d66126dcf?gi=91803318295b"
              >Jupyter Notebook 7</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 23:28:42</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36886605"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36886411">
          <h3>
            <a class="item" href="https://fractalvise.com/"
              >Morphing Fractal Engraving Vise Jaws</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 23:08:31</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36886411"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36885753">
          <h3>
            <a class="item" href="https://val.packett.cool/blog/tiddlypwa/"
              >TiddlyPWA: putting TiddlyWiki on modern web app steroids</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 22:01:34</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36885753"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36885040">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2023/05/kids-online-safety-act-still-huge-danger-our-rights-online"
              >Kids Online Safety Act is still a danger to our rights online</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 21:07:07</span
              ><span class="points-container"
                >Points: <span class="points">243</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36885040"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36883436">
          <h3>
            <a class="item" href="https://www.henrikkarlsson.xyz/p/good-ideas"
              >Cultivating a state of mind where new ideas are born</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 19:22:01</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36883436"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36882146">
          <h3>
            <a class="item" href="https://github.com/continuedev/continue"
              >Show HN: Continue – Open-source coding autopilot</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 18:04:29</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36882146"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
            <div class="text">
              <p>
                Our GitHub is
                <a href="https://github.com/continuedev/continue"
                  >https://github.com/continuedev/continue</a
                >. You can watch a demo of Continue and download the extension
                at <a href="https://continue.dev">https://continue.dev</a>
              </p>
              <p>— — —</p>
              <p>
                A growing number of developers are replacing Google + Stack
                Overflow with Large Language Models (LLMs) as their primary
                approach to get help, similar to how developers previously
                replaced reference manuals with Google + Stack Overflow.
              </p>
              <p>
                However, existing LLM developer tools are cumbersome black
                boxes. Developers are stuck copy/pasting from ChatGPT and
                guessing what context Copilot uses to make a suggestion. As we
                use these products, we expose how we build software and give
                implicit feedback that is used to improve their LLMs, yet we
                don’t benefit from this data nor get to keep it.
              </p>
              <p>
                The solution is to give developers what they need:
                <i>transparency, hackability,</i> and <i>control</i>. Every one
                of us should be able to reason about what’s going on, tinker,
                and have control over our own development data. This is why we
                created Continue.
              </p>
              <p>— — —</p>
              <p>
                At its most basic, Continue removes the need for copy/pasting
                from ChatGPT—instead, you collect context by highlighting and
                then ask questions in the sidebar or have an edit streamed
                directly to your editor.
              </p>
              <p>
                But Continue also provides powerful tools for managing context.
                For example, type ‘@issue’ to quickly reference a GitHub issue
                as you are prompting the LLM, ‘@README.md’ to reference such a
                file, or ‘@google’ to include the results of a Google search.
              </p>
              <p>
                And there’s a ton of room for further customization. Today, you
                can write your own
              </p>
              <p>
                - slash commands (e.g. ‘/commit’ to write a summary and commit
                message for staged changes, ‘/docs’ to grab the contents of a
                file and update documentation pages that depend on it, ‘/ticket’
                to generate a full-featured ticket with relevant files and
                high-level instructions from a short description)
              </p>
              <p>
                - context sources (e.g. GitHub issues, Jira, local files,
                StackOverflow, documentation pages)
              </p>
              <p>
                - templated system message (e.g. “Always give maximally concise
                answers. Adhere to the following style guide whenever writing
                code: {{ /Users/nate/repo/styleguide.md }}”)
              </p>
              <p>
                - tools (e.g. add a file, run unit tests, build and watch for
                errors)
              </p>
              <p>
                - policies (e.g. define a goal-oriented agent that works in a
                write code, run code, read errors, fix code, repeat loop)
              </p>
              <p>
                Continue works with any LLM, including local models using ggml
                or open-source models hosted on your own cloud infrastructure,
                allowing you to remain 100% private. While OpenAI and Anthropic
                perform best today, we are excited to support the progress of
                open-source as it catches up (<a
                  href="https://continue.dev/docs/customization#change-the-default-llm"
                  >https://continue.dev/docs/customization#change-the-default-l...</a
                >).
              </p>
              <p>
                When you use Continue, you automatically collect data on how you
                build software. By default, this development data is saved to
                `.continue/dev_data` on your local machine. When combined with
                the code that you ultimately commit, it can be used to improve
                the LLM that you or your team use (if you allow).
              </p>
              <p>
                You can read more about how development data is generated as a
                byproduct of LLM-aided development and why we believe that you
                should start collecting it now:
                <a
                  href="https://medium.com/@continuedev/its-time-to-collect-data-on-how-you-build-software-197d12a020d5"
                  >https://medium.com/@continuedev/its-time-to-collect-data-on-...</a
                >
              </p>
              <p>
                Continue has an Apache 2.0 license. We plan to make money by
                offering organizations a paid development data engine—a
                continuous feedback loop that ensures the LLMs always have fresh
                information and code in their preferred style.
              </p>
              <p>— — —</p>
              <p>
                We’d love for you to try out Continue and give us feedback! Let
                us know what you think in the comments : )
              </p>
            </div>
          </section>
        </section>
        <section id="36881808">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/blog-post/breaking-superconductor-news"
              >Superconductor news: What’s claimed, and how strong the evidence
              seems to be</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 17:46:30</span
              ><span class="points-container"
                >Points: <span class="points">942</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36881808"
                  >Comments</a
                ><span class="descendants">: 343</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36876556">
          <h3>
            <a class="item" href="https://duarteocarmo.com/blog/every-job-world"
              >Visualizing every job in the world</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 12:32:15</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36876556"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36874821">
          <h3>
            <a
              class="item"
              href="https://www.fourmilab.ch/webtools/MindGrenade/"
              >Mind Grenade (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 08:57:33</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36874821"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36873243">
          <h3>
            <a
              class="item"
              href="https://www.computerhistory.org/siliconengine/semiconductor-rectifiers-patented-as-cats-whisker-detectors/"
              >1901: Semiconductor rectifiers patented as “cat's whisker”
              detectors</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-26 @ 04:50:00</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36873243"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36859614">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/world-europe-66238618"
              >Paris to bring back swimming in Seine after 100 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-25 @ 08:41:52</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36859614"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
