<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38015277">
          <h3>
            <a class="item" href="https://ileakage.com/"
              >iLeakage: Browser-Based Timerless Speculative Execution Attacks
              on Apple Devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 17:15:49</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38015277"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38015169">
          <h3>
            <a
              class="item"
              href="https://www.ucdavis.edu/climate/news/adding-crushed-rock-farmland-pulls-carbon-out-air"
              >Adding Crushed Rock to Farmland Pulls Carbon Out of the Air</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 17:08:58</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38015169"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38015038">
          <h3>
            <a
              class="item"
              href="https://underjord.io/unpacking-elixir-observability.html"
              >Unpacking Elixir: Observability</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 17:01:12</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38015038"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38014879">
          <h3>
            <a
              class="item"
              href="https://blog.plover.com/prog/katara-advice.html"
              >Advice to a Novice Programmer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 16:50:29</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38014879"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38014812">
          <h3>
            <a class="item" href="https://www.thenile.dev/blog/introducing-nile"
              >Nile, Serverless Postgres for Modern SaaS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 16:45:55</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38014812"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38014638">
          <h3>
            <a
              class="item"
              href="https://thezvi.substack.com/p/book-review-going-infinite"
              >Book Review: Going Infinite</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 16:34:45</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38014638"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38014582">
          <h3>
            <a
              class="item"
              href="https://www.cloudflarestatus.com/incidents/s1hkh315y9s9"
              >Cloudflare API, dashboard, tunnels down</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 16:31:34</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38014582"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38014288">
          <h3>
            <a
              class="item"
              href="https://fiber.googleblog.com/2023/10/gfiber-labs-announces-first-project-20.html"
              >GFiber Labs announces first project: 20 Gig with Wi-Fi 7</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 16:10:44</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38014288"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38014069">
          <h3>
            <a
              class="item"
              href="https://thehistoryoftheweb.com/postscript/wait-whats-a-bookmarklet/"
              >Wait, what's a bookmarklet?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 15:50:22</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38014069"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38013919">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/lta-airship-faa-clearance"
              >Sergey Brin's Airship Gets FAA Clearance</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 15:36:32</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38013919"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38013810">
          <h3>
            <a
              class="item"
              href="https://www3.nhk.or.jp/nhkworld/en/ondemand/video/4026203/"
              >Nishinomiya's 1.3 meters tall "Manbow Tunnel"</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 15:26:24</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38013810"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38013796">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38013796"
              >We should promote more personal indexing, rather than
              algorhythmic indexing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 15:25:05</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38013796"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                However, while original sources (NASA, Reuters, bloggers,
                authors, scholarly journals) still write and publish (including
                to social media), the viral content makers, a second tier of
                people who write about what the original author wrote about,
                specializing themselves for social media, just write the
                grabbiest headline, and the most engaging (infuriating,
                polarizing, salacious) version of a piece of the original
                content, and when we go to our platforms, these are the content
                examples we see and read.
              </p>
              <p>
                The original source's publications (posts) become almost
                invisible. The source becomes almost unknown as a source.
              </p>
              <p>
                Engagement algorithms can't help this, because this is actually
                their purpose, which is anti-original content and -quality
                content.
              </p>
              <p>
                We should design platforms and systems that allow people to
                index their own content again (as was the case before Web 2.0
                when people manually put links to other websites, blogs,
                organizations, and articles on their own websites. This would
                make original and quality content writers become visible and
                indexed (even just in people's worldviews, not just indexed on
                the internet) and make viral content makers more invisible.
              </p>
              <p>
                It wouldn't be total, because many people prefer the
                emotionality of viral content, but it would at least create an
                internet where there was more value available.
              </p>
            </div>
          </section>
        </section>
        <section id="38013714">
          <h3>
            <a
              class="item"
              href="https://www.influxdata.com/blog/flight-datafusion-arrow-parquet-fdap-architecture-influxdb/"
              >Using the FDAP Architecture to Build InfluxDB 3.0: Flight,
              DataFusion, Arrow</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 15:17:10</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38013714"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38013668">
          <h3>
            <a
              class="item"
              href="https://takes.jamesomalley.co.uk/p/its-crazy-how-much-transport-for"
              >What Transport for London can learn about us from our mobiles</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 15:13:47</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38013668"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38013477">
          <h3>
            <a class="item" href="https://neal.fun/internet-artifacts/"
              >Internet Artifact Museum</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 14:54:33</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38013477"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38012742">
          <h3>
            <a
              class="item"
              href="https://www.koyeb.com/blog/building-a-global-deployment-platform-is-hard-here-is-why"
              >Building a global deployment platform is hard – a tour of the
              trade-offs we took</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 13:49:24</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38012742"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38012716">
          <h3>
            <a
              class="item"
              href="https://thehustle.co/the-wild-business-of-desert-island-tourism/"
              >Desert Island Tourism</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 13:46:10</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38012716"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38012662">
          <h3>
            <a
              class="item"
              href="https://jakelazaroff.com/words/web-components-will-outlive-your-javascript-framework/"
              >Web components will outlive JavaScript frameworks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 13:40:44</span
              ><span class="points-container"
                >Points: <span class="points">213</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38012662"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38012311">
          <h3>
            <a class="item" href="https://github.com/orbitalapi/orbital"
              >Show HN: Orbital – Dynamically Unifying APIs and Data with No
              Glue Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 12:59:39</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38012311"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm excited to share Orbital, a new approach for unifying APIs
                and Data sources!
              </p>
              <p>
                Rather than relying on glue code to bridge endpoints, Orbital
                leverages annotations in schemas &amp; API specs to build the
                integration dynamically.
              </p>
              <p>
                The traditional method of crafting glue code often becomes
                repetitive and burdensome to maintain in the long run.
              </p>
              <p>
                With Orbital, developers embed tags to their existing API specs
                (OAP, Protobuf, etc), indicating where data can be sourced, and
                publish these specs to Orbital (which runs self-hosted).
              </p>
              <p>
                Consumers query these tags with our TaxiQL language, and Orbital
                generates the integration on the fly. That could be merging
                multiple APIs, blending API and database queries, or enriching
                event streams to craft custom message payloads.
              </p>
              <p>
                It feels a lot like writing GraphQL, but there's no resolvers to
                maintain, and producers are free to use a variety of API Spec
                languages.
              </p>
              <p>
                The beauty of using tags over field names is the adaptability.
                As API developers update and publish their specs, the
                integration remains seamless and automatically adjusts.
              </p>
              <p>
                Under the hood, the tags (and associated query language) are
                actually Taxi - an OSS meta-language and toolchain we build (and
                have shared previously). Orbital is a query engine that executes
                TaxiQL queries, generating the integration.
              </p>
              <p>
                We've been working on this for a while, and have a number of
                production deployments. We recently made the move to make the
                source available on Github under a mix of Apache 2 (Open Core)
                and BuSL.
              </p>
              <p>
                In a nutshell, Orbital excels in Data Composition (covering
                APIs, DBs), crafting Bespoke Event Streams, and streamlining ELT
                workloads into databases.
              </p>
              <p>Excited to hear your thoughts and feedback!</p>
            </div>
          </section>
        </section>
        <section id="38012263">
          <h3>
            <a
              class="item"
              href="https://www.sciencedirect.com/science/article/abs/pii/S0022103122001615"
              >Loyal workers are selectively and ironically targeted for
              exploitation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 12:54:44</span
              ><span class="points-container"
                >Points: <span class="points">348</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38012263"
                  >Comments</a
                ><span class="descendants">: 222</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38012032">
          <h3>
            <a
              class="item"
              href="https://github.com/AndrewWalsh/openapi-devtools"
              >Show HN: OpenAPI DevTools – Chrome extension that generates an
              API spec</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 12:24:19</span
              ><span class="points-container"
                >Points: <span class="points">513</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38012032"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
            <div class="text">
              Effortlessly discover API behaviour with a Chrome extension that
              automatically generates OpenAPI specifications in real time for
              any app or website.
            </div>
          </section>
        </section>
        <section id="38012008">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/first-malaria-vaccine-slashes-early-childhood-deaths"
              >First malaria vaccine reduces early childhood mortality</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 12:20:15</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38012008"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38011432">
          <h3>
            <a class="item" href="https://artistassistapp.com/"
              >Show HN: ArtistAssistApp – the web app to paint better with
              ease</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 10:53:18</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38011432"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
            <div class="text">
              <p>
                I want to show my new open-source project
                <i>ArtistAssistApp</i>.
              </p>
              <p>
                <i>ArtistAssistApp</i> - the web app to paint better with ease.
              </p>
              <p>
                Tools for realistic color mixing based on real paints, tonal
                value drawing, simplified sketching, and more.
              </p>
              <p>
                Import your own photos, select any desired color directly from
                the image, and learn how to mix it with your paints. The web app
                provides a step-by-step guide on how to precisely mix that color
                using your own paints using atomic or optical mixing. Atomic
                mixing is the physical mixing of colors together, while optical
                mixing is the result of placing a transparent layer of color
                over another color (glaze technique).
              </p>
              <p>
                Save instructions on how to mix your favorite colors from the
                paints you have for quick reference.
              </p>
              <p>
                Smooth your photo to reduce detail and focus on the big shapes
                and proportions of your subject, and learn how to simplify and
                abstract your paintings.
              </p>
              <p>
                Use tonal value sketches that capture the light and shadow of
                your subject to learn how to create contrast and depth in your
                paintings.
              </p>
              <p>Works on desktops, laptops, tablets and smartphones.</p>
              <p>
                You can try it at &lt;<a href="https://artistassistapp.com/"
                  >https://artistassistapp.com/</a
                >&gt;. No login or registration required.
              </p>
              <p>
                The source code is available on GitHub &lt;<a
                  href="https://github.com/eugene-khyst/artistassistapp"
                  >https://github.com/eugene-khyst/artistassistapp</a
                >&gt;.
              </p>
            </div>
          </section>
        </section>
        <section id="38011421">
          <h3>
            <a
              class="item"
              href="https://github.com/rguiscard/fossil-notebook-demo"
              >Show HN: A note-keeping system on top of Fossil SCM</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 10:51:27</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38011421"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38011085">
          <h3>
            <a
              class="item"
              href="https://jobs.lever.co/photoroom/fc379626-eb33-4eb6-839c-10e5d578e2ed?lever-origin=applied&amp;lever-source%5B%5D=yc"
              >PhotoRoom Is Hiring a Senior Developer in Paris (Cross-Platform,
              Rust, Wgpu)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 09:53:49</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010718">
          <h3>
            <a class="item" href="https://austinkleon.com/2010/01/31/logbook/"
              >On Keeping a Logbook (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 08:53:21</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010718"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010267">
          <h3>
            <a class="item" href="https://flawless.dev/"
              >Flawless – Durable execution engine for Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 07:39:11</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010267"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010021">
          <h3>
            <a
              class="item"
              href="https://flak.tedunangst.com/post/an-aborted-experiment-with-server-swift"
              >An aborted experiment with server Swift</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 07:00:38</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010021"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38009377">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=3JIZ40yuZL0"
              >What are Functions? Coding for Kids [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 05:13:48</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38009377"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37985489">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2023/Oct/23/embeddings/"
              >Embeddings: What they are and why they matter</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-23 @ 13:42:12</span
              ><span class="points-container"
                >Points: <span class="points">600</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37985489"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
