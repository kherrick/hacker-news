<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39578616">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39578616"
              >How do I stop being such a doomer?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 05:17:30</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39578616"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>
                Don't get me wrong, I'm not depressed or anything because I'm
                still functional and spend a lot of my time coding and learning
                data structures and algorithms so I can secure a high-paying job
                as a software engineer, but with the threat of AI replacing
                developers on the horizon, I feel like time is running out.
              </p>
              <p>
                I know I'm not very intelligent because if I were, I would've
                figured my life out a long time ago and become rich like all
                these crypto and NFT kids... It's insane how there are so many
                scammers out there selling courses on bullcrap like high ticket
                sales, sales funnels, dropshipping, O*<i>F*</i> management,
                etc., seemingly making money without effort, and I'm just here
                trying to bust my ass for a long shot at a FAANG job.
              </p>
              <p>
                I didn't go to college because I didn't get any financial aid
                (long story I don't want to get into, but in short, my parents
                didn't want to give me their info for FAFSA), and I broke into
                the tech world around the time ChatGPT came out, so the job
                market is pretty rough for newer developers like me.
              </p>
              <p>
                In short, I guess I just feel like I got a very late start, but
                the timing seemingly couldn't be any worse.
              </p>
              <p>
                Anybody else feel similarly? Any suggestions for how I can stop
                being this way?
              </p>
            </div>
          </section>
        </section>
        <section id="39578546">
          <h3>
            <a
              class="item"
              href="https://gitlab.com/J4YC33/metablock/-/blob/main/Meta.txt"
              >Known Meta Sites</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 05:02:11</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39578546"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39578501">
          <h3>
            <a class="item" href="https://benhoyt.com/writings/go-1brc/"
              >The One Billion Row Challenge in Go: from 1m45s to 4s in nine
              solutions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 04:52:24</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39578501"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39578443">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/news/entertainment-arts-68342135"
              >The 'banned' Star Trek episode that promised a united Ireland</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 04:33:28</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39578443"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39578416">
          <h3>
            <a
              class="item"
              href="https://twitter.com/elonmusk/status/1764032892663906313"
              >SpaceX just achieved speed of 17Mb/s from satellite to stock
              Android phone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 04:27:01</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39578416"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39578248">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/security/2024/03/us-prescription-market-hamstrung-for-9-days-so-far-by-ransomware-attack/"
              >US prescription market hamstrung for 9 days (so far) by
              ransomware attack</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 03:44:40</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39578248"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39578218">
          <h3>
            <a
              class="item"
              href="https://calmatters.org/housing/homelessness/2024/02/homeless-mortality-report/"
              >Homeless Mortality Data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 03:38:03</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39578218"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39578007">
          <h3>
            <a
              class="item"
              href="https://nostarch.com/algorithmic-thinking-2nd-edition"
              >Algorithmic Thinking (2nd Edition)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 02:47:21</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39578007"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39577957">
          <h3>
            <a
              class="item"
              href="http://oldvcr.blogspot.com/2024/03/an-apple-district-managers-macintosh.html"
              >An Apple district manager's Macintosh Portable in 1989-91
              (featuring GEIS Apple</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 02:37:06</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39577957"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39577878">
          <h3>
            <a
              class="item"
              href="https://www.cs.cornell.edu/courses/cs6120/2023fa/self-guided/"
              >CS 6120: Advanced Compilers: The Self-Guided Online Course</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 02:25:28</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39577878"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39577164">
          <h3>
            <a
              class="item"
              href="https://github.com/layerdiffusion/sd-forge-layerdiffusion"
              >Generating transparent images using Stable Diffusion XL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 00:27:45</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39577164"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39576974">
          <h3>
            <a
              class="item"
              href="https://computer.rip/2024-03-01-listening-in-on-the-neighborhood.html"
              >ShotSpotter: listening in on the neighborhood</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 23:56:02</span
              ><span class="points-container"
                >Points: <span class="points">279</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39576974"
                  >Comments</a
                ><span class="descendants">: 217</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39576343">
          <h3>
            <a
              class="item"
              href="https://computeradsfromthepast.substack.com/p/byte-interviews-the-apple-lisa-dev"
              >Byte Interviews the Apple Lisa Dev Team (1983)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 22:30:52</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39576343"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39575803">
          <h3>
            <a
              class="item"
              href="https://www.ftc.gov/business-guidance/blog/2024/03/price-fixing-algorithm-still-price-fixing"
              >Price fixing by algorithm is still price fixing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 21:10:35</span
              ><span class="points-container"
                >Points: <span class="points">535</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39575803"
                  >Comments</a
                ><span class="descendants">: 338</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39575274">
          <h3>
            <a
              class="item"
              href="https://hedgehogreview.com/issues/missing-character/articles/sorting-the-self"
              >Sorting the Self: Assessments and the cult of personality</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 19:53:42</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39575274"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39575262">
          <h3>
            <a class="item" href="https://ztoz.blog/posts/user-group-reuse/"
              >How user groups made software reuse a reality</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 19:51:53</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39575262"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39574436">
          <h3>
            <a class="item" href="https://www.di.ens.fr/%7Efbach/ltfp_book.pdf"
              >Learning Theory from First Principles [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 18:10:39</span
              ><span class="points-container"
                >Points: <span class="points">192</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39574436"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39573756">
          <h3>
            <a
              class="item"
              href="https://www.arrl.org/news/bob-heil-k9eid-silent-key"
              >Bob Heil, K9EID, Silent Key</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 16:48:39</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39573756"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39573093">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=IvUU8joBb1Q"
              >Wintergatan Marble Machine (2016) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 15:20:27</span
              ><span class="points-container"
                >Points: <span class="points">307</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39573093"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39572858">
          <h3>
            <a
              class="item"
              href="https://sdomi.pl/weblog/15-witchcraft-minecraft-server-in-bash/"
              >Writing a Minecraft server from scratch in Bash (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 14:42:43</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39572858"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39572718">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/magazine/archive/2024/04/ann-hermes-morse-code/677468/"
              >Scenes from the last operational Morse-code radio station in
              North America</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 14:22:27</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39572718"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39572488">
          <h3>
            <a
              class="item"
              href="https://awkravchuk.itch.io/cl-fast-ecs/devlog/622054/gamedev-in-lisp-part-1-ecs-and-metalinguistic-abstraction"
              >Gamedev in Lisp. Part 1: ECS and Metalinguistic Abstraction</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 13:47:26</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39572488"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39572106">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-03-mathematicians-plya-conjecture-eigenvalues-disk.html"
              >Mathematicians prove Pólya's conjecture for the eigenvalues of a
              disk</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 12:27:22</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39572106"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39570692">
          <h3>
            <a class="item" href="https://ente.io/"
              >Ente: Open-Source, E2E Encrypted, Google Photos Alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 07:31:09</span
              ><span class="points-container"
                >Points: <span class="points">756</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39570692"
                  >Comments</a
                ><span class="descendants">: 256</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39570669">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/two-commodore-64s-one-accordion"
              >Two C64s Plus a Pile of Floppy Disks Equals One Accordion
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 07:27:52</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39570669"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39570423">
          <h3>
            <a
              class="item"
              href="https://simon.peytonjones.org/assets/pdfs/sequent-calculus.pdf"
              >Sequent Calculus as a Compiler Intermediate Language (2016)
              [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 06:42:47</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39570423"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39570197">
          <h3>
            <a
              class="item"
              href="https://github.com/c0pperdragon/LumaCode/wiki/Overview"
              >LumaCode</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 05:55:45</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39570197"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39569655">
          <h3>
            <a
              class="item"
              href="https://32bits.substack.com/p/under-the-microscope-three-dirty"
              >Under the Microscope: Three Dirty Dwarves</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 03:54:37</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39569655"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39564632">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39564632"
              >Ask HN: How can I learn about performance optimization?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 18:02:01</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39564632"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              What are some good resources for learning about performance
              optimization? This is an area that is new to me, but a big part of
              my new job.
            </div>
          </section>
        </section>
        <section id="39563528">
          <h3>
            <a
              class="item"
              href="https://archive.org/details/humbugsofworldac00barn/page/n1/mode/2up"
              >The Humbugs of the World (1866)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 16:42:11</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39563528"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
