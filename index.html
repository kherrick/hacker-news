<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46439027">
          <h3>
            <a
              class="item"
              href="https://codecrafters.io/blog/programming-project-ideas"
              >Project ideas to appreciate the art of programming</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 22:47:36</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46439027"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46438828">
          <h3>
            <a
              class="item"
              href="https://blog.adafruit.com/2025/12/30/nyc-mayoral-inauguration-bans-raspberry-pi-and-flipper-zero-alongside-explosives/"
              >NYC Mayoral Inauguration bans Raspberry Pi and Flipper Zero
              alongside explosives</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 22:28:16</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46438828"
                  >Comments</a
                ><span class="descendants">: 160</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46438642">
          <h3>
            <a class="item" href="https://www.benkler.org/CoasesPenguin.PDF"
              >Coase's Penguin, Or, Linux and the Nature of the Firm [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 22:12:52</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46438642"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46438522">
          <h3>
            <a
              class="item"
              href="https://vptdigital.com/blog/honey-detecting-testers/"
              >Honey's Dieselgate: Detecting and tricking testers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 21:59:35</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46438522"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46438390">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/leaders/2025/12/30/openais-cash-burn-will-be-one-of-the-big-bubble-questions-of-2026"
              >OpenAI's cash burn will be one of the big bubble questions of
              2026</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 21:44:07</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46438390"
                  >Comments</a
                ><span class="descendants">: 273</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46438169">
          <h3>
            <a
              class="item"
              href="https://www.popularmechanics.com/science/health/a69878870/human-new-tooth-regrowth-trials-japan-timeline/"
              >Humans May Be Able to Grow New Teeth Within Just 4 Years</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 21:22:53</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46438169"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46437876">
          <h3>
            <a
              class="item"
              href="https://blog.dshr.org/2025/12/sabotaging-bitcoin.html"
              >Sabotaging Bitcoin</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 20:53:59</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46437876"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46437391">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2512.14012"
              >Professional software developers don't vibe, they control</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 20:06:46</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46437391"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46437381">
          <h3>
            <a
              class="item"
              href="https://www.kasava.dev/blog/everything-as-code-monorepo"
              >Everything as code: How we manage our company in one monorepo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 20:05:42</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46437381"
                  >Comments</a
                ><span class="descendants">: 167</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46437288">
          <h3>
            <a class="item" href="https://github.com/Lulzx/zpdf"
              >Zpdf: PDF text extraction in Zig – 5x faster than MuPDF</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 19:57:10</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46437288"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46436889">
          <h3>
            <a
              class="item"
              href="https://it-notes.dragas.net/2025/02/26/fedimeteo-how-a-tiny-freebsd-vps-became-a-global-weather-service-for-thousands/"
              >FediMeteo: A €4 FreeBSD VPS Became a Global Weather Service</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 19:21:48</span
              ><span class="points-container"
                >Points: <span class="points">230</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46436889"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46436828">
          <h3>
            <a
              class="item"
              href="https://media.ccc.de/v/39c3-escaping-containment-a-security-analysis-of-freebsd-jails"
              >Escaping containment: A security analysis of FreeBSD jails
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 19:15:05</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46436828"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46436409">
          <h3>
            <a
              class="item"
              href="https://f-droid.org/2025/12/30/a-faster-heart-for-f-droid.html"
              >A faster heart for F-Droid. Our new server is here</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 18:36:37</span
              ><span class="points-container"
                >Points: <span class="points">289</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46436409"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46436127">
          <h3>
            <a
              class="item"
              href="https://ethz.ch/en/news-and-events/eth-news/news/2025/11/electrolysis-can-solve-one-of-our-biggest-contamination-problems.html"
              >Electrolysis can solve one of our biggest contamination
              problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 18:08:32</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46436127"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46435614">
          <h3>
            <a
              class="item"
              href="https://00f.net/2025/12/30/libsodium-vulnerability/"
              >A Vulnerability in Libsodium</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 17:24:57</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46435614"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46435418">
          <h3>
            <a class="item" href="https://github.com/torokernel/torokernel"
              >Toro: Deploy Applications as Unikernels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 17:09:57</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46435418"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46435308">
          <h3>
            <a class="item" href="https://hackerbook.dosaygo.com"
              >Show HN: 22 GB of Hacker News in SQLite</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 17:01:59</span
              ><span class="points-container"
                >Points: <span class="points">348</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46435308"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
            <div class="text">
              <p>
                Go to this repo (<a
                  href="https://github.com/DOSAYGO-STUDIO/HackerBook"
                  >https://github.com/DOSAYGO-STUDIO/HackerBook</a
                >): you can download it. Big Query -&gt; ETL -&gt; npx serve
                docs - that's it. 20 years of HN arguments and beauty, can be
                yours forever. So they'll never die. Ever. It's the unkillable
                static archive of HN and it's your hands. That's my Year End
                gift to you all. Thank you for a wonderful year, have happy and
                wonderful 2026. make something of it.
              </p>
            </div>
          </section>
        </section>
        <section id="46433915">
          <h3>
            <a
              class="item"
              href="https://dfarq.homeip.net/what-happened-to-abit-motherboards/"
              >What Happened to Abit Motherboards</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 14:58:18</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46433915"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46433661">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/hive.co/cb0dc490-0e32-4734-8d91-8b56a31ed497"
              >Hive (YC S14) Is Hiring a Staff Software Engineer (Data
              Systems)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 14:31:34</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46433352">
          <h3>
            <a class="item" href="https://mwilczynski.dev/posts/riscv-gpu-zink/"
              >Igniting the GPU: From Kernel Plumbing to 3D Rendering on
              RISC-V</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 13:55:59</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46433352"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46432999">
          <h3>
            <a
              class="item"
              href="https://subseacables.blogspot.com/2025/12/the-british-empires-resilient-subsea.html"
              >The British empire's resilient subsea telegraph network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 13:10:56</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46432999"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46432916">
          <h3>
            <a
              class="item"
              href="https://fuckingapproachableswiftconcurrency.com/en/"
              >Approachable Swift Concurrency</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 13:01:51</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46432916"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46432862">
          <h3>
            <a class="item" href="https://hsu.cy/2025/12/times-new-american/"
              >Times New American: A Tale of Two Fonts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 12:56:07</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46432862"
                  >Comments</a
                ><span class="descendants">: 135</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46432311">
          <h3>
            <a class="item" href="https://nonzerosum.games/"
              >Non-Zero-Sum Games</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 11:42:55</span
              ><span class="points-container"
                >Points: <span class="points">333</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46432311"
                  >Comments</a
                ><span class="descendants">: 171</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46431560">
          <h3>
            <a class="item" href="https://opencontent.netflix.com/"
              >Netflix Open Content</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 10:11:57</span
              ><span class="points-container"
                >Points: <span class="points">598</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46431560"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46431028">
          <h3>
            <a
              class="item"
              href="https://lorentz.app/blog-item.html?id=go-shebang"
              >Go away Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-30 @ 08:50:44</span
              ><span class="points-container"
                >Points: <span class="points">351</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46431028"
                  >Comments</a
                ><span class="descendants">: 332</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46424173">
          <h3>
            <a class="item" href="https://loss32.org/"
              >Loss32: Let's Build a Win32/Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-29 @ 19:09:08</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46424173"
                  >Comments</a
                ><span class="descendants">: 311</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46416674">
          <h3>
            <a
              class="item"
              href="https://audio-database.com/MITSUBISHI-DIATONE/diatonesp/d-160-e.html"
              >Mitsubishi Diatone D-160 (1985)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-29 @ 02:08:08</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46416674"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46366010">
          <h3>
            <a class="item" href="https://www.gkbrk.com/hotel-music"
              >Reverse Engineering a Mysterious UDP Stream in My Hotel (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-23 @ 15:21:55</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46366010"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46361766">
          <h3>
            <a
              class="item"
              href="https://mathvoices.ams.org/mathmedia/tonys-take-april-2022/"
              >Braid Math Article</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-23 @ 02:33:24</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46361766"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
