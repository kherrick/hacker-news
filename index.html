<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46773090">
          <h3>
            <a
              class="item"
              href="https://support.apple.com/en-au/guide/mac-help/welcome/mac"
              >TIL the Apple TV Remote pairs with MacBooks for presentations and
              playback</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 23:16:24</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46773090"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46772655">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46772655"
              >Ask HN: Who do you follow via RSS feed?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 22:41:36</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46772655"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <p>
                I just set up TinyTinyRSS (https://tt-rss.org/) at home and I'm
                looking into interesting things to read as well as
                people/website publishing interesting stuff.
              </p>
              <p>
                This, among the other things, to reduce the daily
                (doom)scrolling and avoid the recommendation algorithms by
                social media.
              </p>
              <p>So: who or what do you follow via RSS feed, and why?</p>
            </div>
          </section>
        </section>
        <section id="46772495">
          <h3>
            <a
              class="item"
              href="https://www.msn.com/en-us/news/technology/i-let-chatgpt-analyze-a-decade-of-my-apple-watch-data-then-i-called-my-doctor/ar-AA1UZxip"
              >I let ChatGPT analyze a decade of my Apple Watch data. Then I
              called my doctor</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 22:29:54</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46772495"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46772212">
          <h3>
            <a
              class="item"
              href="https://ntdotdev.wordpress.com/2026/01/25/state-of-the-windows-what-is-going-on-with-windows-11/"
              >State of the Windows: What is going on with Windows 11?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 22:03:04</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46772212"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46771599">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/business/the-secret-society-of-people-who-know-the-formula-for-wd-40-e9c0ff54"
              >People who know the formula for WD-40</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 21:11:53</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46771599"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://www.wsj.com/business/the-secret-society-of-people-who-know-the-formula-for-wd-40-e9c0ff54?st=zbjngP&amp;reflink=desktopwebshare_permalink"
                >https://www.wsj.com/business/the-secret-society-of-people-wh...</a
              >
            </div>
          </section>
        </section>
        <section id="46770274">
          <h3>
            <a
              class="item"
              href="https://visualrambling.space/dithering-part-2/"
              >Dithering – Part 2: The Ordered Dithering</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 19:23:54</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46770274"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46770221">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2026/Jan/26/chatgpt-containers/"
              >ChatGPT Containers can now run bash, pip/npm install packages and
              download files</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 19:19:40</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46770221"
                  >Comments</a
                ><span class="descendants">: 162</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46769752">
          <h3>
            <a class="item" href="https://tetrisbench.com/tetrisbench/"
              >Show HN: TetrisBench – Gemini Flash reaches 66% win rate on
              Tetris against Opus</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 18:42:40</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769752"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46769201">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/google/comments/1qn1hk1/google_has_seemingly_entirely_removed_search/"
              >Google Books removed all search functions for any books with
              previews</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 18:05:15</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769201"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46769188">
          <h3>
            <a
              class="item"
              href="https://alexwennerberg.com/blog/2026-01-25-slop.html"
              >AI code and software craft</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 18:04:15</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769188"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46769051">
          <h3>
            <a
              class="item"
              href="https://bsky.app/profile/did:plc:okydh7e54e2nok65kjxdklvd/post/3mdd55paffk2o"
              >Fedora Asahi Remix is now working on Apple M3</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 17:54:20</span
              ><span class="points-container"
                >Points: <span class="points">430</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769051"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46768909">
          <h3>
            <a
              class="item"
              href="https://nproject.io/blog/juicessh-give-me-back-my-pro-features/"
              >JuiceSSH – Give me my pro features back</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 17:46:38</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46768909"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46768257">
          <h3>
            <a
              class="item"
              href="https://www.darioamodei.com/essay/the-adolescence-of-technology"
              >The Adolescence of Technology</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 17:07:24</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46768257"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46767668">
          <h3>
            <a
              class="item"
              href="https://twitter.com/lellouchenico/status/2015775970330882319"
              >France Aiming to Replace Zoom, Google Meet, Microsoft Teams,
              etc.</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 16:27:46</span
              ><span class="points-container"
                >Points: <span class="points">538</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46767668"
                  >Comments</a
                ><span class="descendants">: 459</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46767440">
          <h3>
            <a
              class="item"
              href="https://www.zackliscio.com/posts/rip-low-code-2014-2025/"
              >RIP Low-Code 2014-2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 16:11:28</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46767440"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766961">
          <h3>
            <a
              class="item"
              href="https://www.greptile.com/blog/ai-code-review-bubble"
              >There is an AI code review bubble</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 15:38:50</span
              ><span class="points-container"
                >Points: <span class="points">173</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766961"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766741">
          <h3>
            <a class="item" href="https://qwen.ai/blog?id=qwen3-max-thinking"
              >Qwen3-Max-Thinking</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 15:23:00</span
              ><span class="points-container"
                >Points: <span class="points">416</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766741"
                  >Comments</a
                ><span class="descendants">: 376</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766526">
          <h3>
            <a
              class="item"
              href="https://www.windowscentral.com/microsoft/windows-11/windows-11s-botched-patch-tuesday-update-nightmare-continues-as-microsoft-confirms-some-pcs-might-fail-to-boot"
              >Windows 11's Patch Tuesday nightmare gets worse</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 15:07:37</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766526"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766188">
          <h3>
            <a
              class="item"
              href="https://diamondgeezer.blogspot.com/2026/01/tv100.html"
              >Television is 100 years old today</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 14:41:04</span
              ><span class="points-container"
                >Points: <span class="points">523</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766188"
                  >Comments</a
                ><span class="descendants">: 178</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766031">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/technology/2026/jan/24/google-ai-overviews-youtube-medical-citations-study"
              >Google AI Overviews cite YouTube more than any medical site for
              health queries</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 14:27:00</span
              ><span class="points-container"
                >Points: <span class="points">359</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766031"
                  >Comments</a
                ><span class="descendants">: 196</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46765819">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2026/01/apple-introduces-new-airtag-with-expanded-range-and-improved-findability/"
              >Apple introduces new AirTag with longer range and improved
              findability</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 14:10:25</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46765819"
                  >Comments</a
                ><span class="descendants">: 384</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46765694">
          <h3>
            <a
              class="item"
              href="https://blog.vjeux.com/2026/analysis/porting-100k-lines-from-typescript-to-rust-using-claude-code-in-a-month.html"
              >Porting 100k lines from TypeScript to Rust using Claude Code in a
              month</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 13:58:27</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46765694"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46765460">
          <h3>
            <a
              class="item"
              href="https://atmoio.substack.com/p/after-two-years-of-vibecoding-im"
              >After two years of vibecoding, I'm back to writing by hand</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 13:36:22</span
              ><span class="points-container"
                >Points: <span class="points">647</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46765460"
                  >Comments</a
                ><span class="descendants">: 497</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46763864">
          <h3>
            <a
              class="item"
              href="https://maplibre.org/news/2026-01-23-mlt-release/"
              >MapLibre Tile: a modern and efficient vector tile format</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 10:19:51</span
              ><span class="points-container"
                >Points: <span class="points">406</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46763864"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46763721">
          <h3>
            <a class="item" href="https://walzr.com/sf-graffiti"
              >San Francisco Graffiti</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 10:02:12</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46763721"
                  >Comments</a
                ><span class="descendants">: 175</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46727603">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2512.14319"
              >Not all Chess960 positions are equally complex</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 02:27:30</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46727603"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46709461">
          <h3>
            <a
              class="item"
              href="https://rendiment.io/postgresql/2026/01/21/pgtrgm-pgvector-music.html"
              >Find 'Abbey Road when type 'Beatles abbey rd': Fuzzy/Semantic
              search in Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 18:24:55</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46709461"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46705590">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46705590"
              >Show HN: I made AI earphones remember everything (auto-sync to
              Obsidian)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 13:41:47</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46705590"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built this after getting frustrated with losing great ideas
                while driving, cooking, or exercising. You know that moment when
                inspiration strikes but your hands are occupied?
              </p>
              <p>
                The Problem: Doubao AI earphones (popular in China, similar to
                AirPods but with built-in AI) are great for Q&amp;A, but all
                conversations disappear after listening. It's a closed ecosystem
                with no way to export valuable content.
              </p>
              <p>
                My Solution: A Python tool that monitors the Doubao web
                interface and automatically syncs voice notes to Obsidian in
                real-time.
              </p>
              <p>What makes it interesting:</p>
              <p>
                30+ speech variation recognition - Works even if you say "note"
                instead of "take note" or use filler words like "um, note this
                down" Hands-free operation - Just say "Doubao, take a note,
                [your content]" and it appears in Obsidian instantly Smart
                deduplication - Won't create duplicate entries for similar
                content Cross-platform - Works on Windows, macOS, Linux
                Technical approach:
              </p>
              <p>
                Uses Playwright to monitor DOM changes and network requests
                Regex engine handles speech variations and colloquialisms SQLite
                for deduplication logic Async I/O for real-time file operations
                Real use cases I've tested:
              </p>
              <p>
                Capturing meeting insights while driving between offices
                Recording workout thoughts during runs Noting recipe
                improvements while cooking Quick idea capture during walks The
                tool essentially breaks the walled garden of AI earphones and
                turns them into a proper knowledge management device. It's like
                having a voice assistant that actually remembers and organizes
                everything you tell it.
              </p>
              <p>
                Demo: Say "Doubao, note this: remember to research async
                patterns" → Instantly appears in Inbox/Voice Notes/2026-01-21.md
              </p>
              <p>Built with Python + Playwright + SQLite. MIT licensed.</p>
              <p>
                What do you think? Have you faced similar issues with voice
                assistants that don't persist information? Would love to hear
                about your workflows for capturing ideas on-the-go!
              </p>
              <p>
                GitHub:
                <a href="https://github.com/GptsApp/doubao-earphone-to-obsidian"
                  >https://github.com/GptsApp/doubao-earphone-to-obsidian</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46701045">
          <h3>
            <a class="item" href="https://openflexure.org/projects/microscope/"
              >OpenFlexure Microscope</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 04:16:48</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46701045"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46694193">
          <h3>
            <a
              class="item"
              href="https://practical.engineering/blog/2026/1/20/the-hidden-engineering-of-runways"
              >The Hidden Engineering of Runways</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 16:52:52</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46694193"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
