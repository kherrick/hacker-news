<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39854906">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/science-environment-68534309"
              >Banana prices to go up as temperatures rise, says expert</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 17:37:32</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39854906"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39854359">
          <h3>
            <a
              class="item"
              href="https://remotejobs.org/companies/rankscience-remote-jobs"
              >RankScience (YC W17) is hiring to automate SEO for startups</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 17:01:14</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39854182">
          <h3>
            <a class="item" href="https://github.com/dail8859/NotepadNext"
              >NotepadNext – a cross-platform, reimplementation of Notepad++</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 16:50:59</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39854182"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39854056">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=GgDxXDV4_hc"
              >We made a hot dog talk with RF [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 16:43:14</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39854056"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39853958">
          <h3>
            <a
              class="item"
              href="https://www.maginative.com/article/ai21-labs-unveils-jamba-the-first-production-grade-mamba-based-ai-model/"
              >AI21 Labs Unveils Jamba: The First Production-Grade Mamba-Based
              AI Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 16:36:56</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39853958"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39853474">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39853474"
              >Launch HN: Eggnog (YC W24) – AI videos with consistent
              characters</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 16:14:16</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39853474"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.eggnog.ai">https://www.eggnog.ai</a>, an AI
              video platform where your characters look the same across every
              scene. Eggnog lets you create characters, use them in scene
              generations, and share them with others for remixing. Here are
              some videos made with Eggnog:
              <p>
                Fanfiction:
                <a
                  href="https://www.reddit.com/r/harrypotterfanfiction/comments/1bn6cdb/im_making_some_hp_short_videos_let_me_know_what/"
                  >https://www.reddit.com/r/harrypotterfanfiction/comments/1bn6...</a
                >
                (includes some sounds from outside Eggnog) Comedy:
                <a href="https://x.com/jitsvm/status/1771609353725919316?s=20"
                  >https://x.com/jitsvm/status/1771609353725919316?s=20</a
                >
                Post-apocalyptic vibes:
                <a
                  href="https://x.com/saucebook/status/1771212617601659279?s=20"
                  >https://x.com/saucebook/status/1771212617601659279?s=20</a
                >
              </p>
              <p>
                We got into making funny AI videos over the last year, but felt
                annoyed that the characters always looked different in each
                scene. It made it harder to make cool videos and for our friends
                to understand the plot.
              </p>
              <p>
                Diffusion models, like those that make AI videos, start with
                random noise, then add detail. So the little things that make a
                character recognizable will almost always come out looking
                different across generations, no matter how many tricks you add
                into the prompt. For instance, if you want your wizard to have a
                red hat, it might be crooked in one generation and straight in
                the next.
              </p>
              <p>
                Eggnog allows users to make consistent characters by using
                Low-Rank Adaption (LoRA). LoRA takes in a set of images of a
                character in different scenarios and uses those images to teach
                the model that character as a concept. We do this by taking a
                single prompt that a user writes for a character (e.g., an
                ancient Greek soldier with dark hair and bushy beard) and
                turning it into a training set of images of the character in
                different poses, shot from different angles. Once the character
                is trained into the model, the user can then invoke that
                character concept in the prompt and get consistent generations
                about 80% of the time.
              </p>
              <p>
                There is still a lot of room to make Eggnog generations more
                consistent and controllable. Generations sometimes come out with
                the wrong gender, missing key details from the costume, or fail
                in a long tail of other ways. We also often struggle to control
                the character’s exact body movement. We’re planning to address
                these cases with more optimization of the prompt that invokes
                the character concept and by using new open source video models
                that bake in 3D representations of humans.
              </p>
              <p>
                The other fun thing about making characters with Eggnog is that
                you can share them. We already made one San Francisco “American
                Psycho” video that got over 100k views on Twitter (<a
                  href="https://x.com/jitsvm/status/1766987382916894966?s=20"
                  >https://x.com/jitsvm/status/1766987382916894966?s=20</a
                >). Then we expanded on the SF universe by making another video
                with the same character and a new friend for him (<a
                  href="https://x.com/SamuelMGPlank/status/1767405784986718406?s=20"
                  >https://x.com/SamuelMGPlank/status/1767405784986718406?s=20</a
                >). Eventually, you’ll be able to create and remix all the
                components of a good video—the characters, the costumes, the
                sets, and the sounds will all be part of a library of assets
                built up by the Eggnog community.
              </p>
              <p>
                Eggnog is free to use, and you can try it out in the playground:
                <a href="https://www.eggnog.ai/playground"
                  >https://www.eggnog.ai/playground</a
                >. If you’re looking for some inspiration, you can try using the
                character “herm” waving a glowing wand or the character “lep”
                walking down a Dublin street. We’ll make money eventually by
                showing ads to viewers who come to Eggnog to watch AI videos.
              </p>
              <p>
                We’re really excited to see all the fun videos and characters
                people are making with Eggnog, and looking forward to hearing
                what you all think!
              </p>
            </div>
          </section>
        </section>
        <section id="39852953">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/business/live-news/sam-bankman-fried-sentencing-03-28-24/index.html"
              >Sam Bankman-Fried sentenced to 25 years in prison</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 15:48:12</span
              ><span class="points-container"
                >Points: <span class="points">551</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39852953"
                  >Comments</a
                ><span class="descendants">: 664</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39852879">
          <h3>
            <a
              class="item"
              href="https://vitalik.eth.limo/general/2024/03/28/blobs.html"
              >Ethereum has blobs. Where do we go from here?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 15:41:06</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39852879"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39852626">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/trillion-transistor-gpu"
              >Advances in semiconductors are feeding the AI boom</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 15:16:32</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39852626"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39852407">
          <h3>
            <a class="item" href="https://tripgeeks.app/community"
              >Show HN: I built a web app to open source travel itineraries</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 14:57:19</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39852407"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text"><p>Thanks!</p></div>
          </section>
        </section>
        <section id="39852219">
          <h3>
            <a class="item" href="https://julep-ai.github.io/"
              >I scraped all of OpenAI's Community Forum</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 14:44:33</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39852219"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39852167">
          <h3>
            <a class="item" href="https://dioxuslabs.com/blog/release-050/"
              >Dioxus 0.5: Web, Desktop, Mobile Apps in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 14:41:23</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39852167"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39852118">
          <h3>
            <a
              class="item"
              href="https://news.mit.edu/2024/large-language-models-use-surprisingly-simple-mechanism-retrieve-stored-knowledge-0325"
              >LLMs use a surprisingly simple mechanism to retrieve some stored
              knowledge</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 14:37:50</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39852118"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39852037">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/space/2024/03/venus-aerospace-takes-flight-as-it-progresses-with-tests-of-novel-engine/"
              >The company building a rotating detonation engine is pushing the
              tech forward</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 14:32:05</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39852037"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39850972">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/quansheng-uv-k5-hacking"
              >UV-K5 Is the Most Hackable Handheld Ham Radio Yet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 13:18:07</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39850972"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39850383">
          <h3>
            <a
              class="item"
              href="https://scrip.citeline.com:443/SC144926/An-EpiPen-For-Heart-Attacks-Idorsia-Launches-Phase-III-Study-Of-Selatogrel"
              >EpiPen For Heart Attacks? Idorsia Launches Phase III Study Of
              Selatogrel (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 12:27:31</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39850383"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39850207">
          <h3>
            <a
              class="item"
              href="https://yusuf.fyi/posts/linux-text-manipulation"
              >Linux Text Manipulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 12:08:54</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39850207"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39849335">
          <h3>
            <a
              class="item"
              href="https://blog.nordicsemi.com/getconnected/what-is-dect-2020-new-radio-nr-and-how-big-a-deal-is-it"
              >What is DECT-2020 New Radio (NR), and how big a deal is it?
              (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 10:03:14</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39849335"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39849126">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-00930-y"
              >Memories are made by breaking DNA – and fixing it</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 09:26:40</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39849126"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39848862">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/03/27/amazon-dark-pattern-design-fine/"
              >Amazon fined in Poland for dark pattern design tricks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 08:28:41</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39848862"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39848268">
          <h3>
            <a class="item" href="https://github.com/shizunge/endlessh-go"
              >Endlessh-go: a Golang SSH tarpit that traps bots/scanners</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 06:23:19</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39848268"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39847728">
          <h3>
            <a
              class="item"
              href="http://sininenankka.dy.fi/~sami/fdshell/doskernel.php"
              >ST-DOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 04:14:50</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39847728"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39847203">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-researcher-who-explores-computation-by-conjuring-new-worlds-20240327/"
              >The Researcher Who Explores Computation by Conjuring New
              Worlds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-28 @ 02:42:16</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39847203"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39844936">
          <h3>
            <a class="item" href="https://www.swift.org/blog/adwaita-swift/"
              >Writing Gnome Apps with Swift</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-27 @ 21:40:59</span
              ><span class="points-container"
                >Points: <span class="points">524</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39844936"
                  >Comments</a
                ><span class="descendants">: 258</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39844768">
          <h3>
            <a class="item" href="https://makerworld.com/en/models/247798"
              >Show HN: I made a binary enigma machine for manual encryption</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-27 @ 21:24:36</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39844768"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <p>
                Or how else are we going to send secure messages in the future?
              </p>
            </div>
          </section>
        </section>
        <section id="39839257">
          <h3>
            <a
              class="item"
              href="https://www.newstatesman.com/culture/art-design/2024/03/the-last-crimes-of-caravaggio"
              >The last crimes of Caravaggio</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-27 @ 14:04:16</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39839257"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39838104">
          <h3>
            <a
              class="item"
              href="https://www.databricks.com/blog/introducing-dbrx-new-state-art-open-llm"
              >DBRX: A new open LLM</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-27 @ 12:23:48</span
              ><span class="points-container"
                >Points: <span class="points">797</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39838104"
                  >Comments</a
                ><span class="descendants">: 321</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39836797">
          <h3>
            <a
              class="item"
              href="https://brooker.co.za/blog/2023/01/06/erasure.html"
              >Erasure Coding versus Tail Latency</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-27 @ 08:47:00</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39836797"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39836495">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/selfhosted/comments/1bouuv7/warning_vultr_a_major_cloud_provider_is_now/"
              >Vultr is now claiming full perpetual commercial rights over all
              hosted content</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-27 @ 07:41:19</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39836495"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39826521">
          <h3>
            <a
              class="item"
              href="https://windspider.com/gigantic-aluminium-spiders/"
              >Gigantic Aluminium Spiders</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-26 @ 11:27:41</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39826521"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
