<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42870144">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2025/jan/29/abortion-pills-instagram-shadow-banning"
              >Groups helping Americans find abortion pills report Instagram
              'shadow-banning'</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 19:45:05</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42870144"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42870056">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/business/autos-transportation/alphabets-waymo-test-its-autonomous-driving-technology-over-10-new-cities-2025-01-29/"
              >Waymo to test its autonomous driving technology in over 10 new
              cities</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 19:38:18</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42870056"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42869865">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42869865"
              >Ask HN: Are there "story-based" and "fact-based" people?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 19:25:16</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42869865"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
            <div class="text">
              <p>
                story-based: think in terms of whole narratives; have trouble
                evaluating statements without knowing where they fit in some
                story, whose case they help or hurt. Tend to be good at
                articulating vision and goals; tend to think that it's wrong to
                pierce a valuable story with contrary facts. Not great at
                anticipating problems where reality disobeys the intended story,
                but good at rolling over bumps and keeping eyes on the prize.
              </p>
              <p>
                fact-based: strive to assess truth and falsehood irrespective of
                who it helps or hurts. Tend to put foot in mouth by saying
                things at the wrong time; perceived by others as indelicate.
                Tend to struggle to articulate vision and goals, given all the
                things that can go wrong; see nothing wrong with piercing a
                narrative with contrary facts. Good at anticipating problems,
                but can be too fixated on obstacles.
              </p>
              <p>
                Does this ring true for others? How would you revise or amend
                this?
              </p>
            </div>
          </section>
        </section>
        <section id="42868770">
          <h3>
            <a class="item" href="https://github.com/Om-Alve/smolGPT"
              >A minimal PyTorch implementation for training your own small LLM
              from scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 18:09:19</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868770"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42868718">
          <h3>
            <a
              class="item"
              href="https://www.discovermagazine.com/health/how-adding-iodine-to-salt-boosted-americans-iq"
              >Adding iodine to salt played a role in cognitive improvements:
              research (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 18:06:02</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868718"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42868618">
          <h3>
            <a
              class="item"
              href="https://blog.playstation.com/2025/01/29/no-mans-skys-latest-update-introduces-billions-of-new-stars-planets-and-more-today/"
              >No Man's Sky's update introduces billions of new stars, planets,
              and more</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 17:59:28</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868618"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42868576">
          <h3>
            <a
              class="item"
              href="https://twitter.com/charliermarsh/status/1884651482009477368"
              >Astral – "We're building a new static type checker for Python"</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 17:56:51</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868576"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42868531">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/tech-industry/tsmc-founder-says-tim-cook-told-him-intel-did-not-know-how-to-be-a-foundry"
              >Intel doesn't know how to be a foundry," Tim Cook reportedly told
              TSMC's CEO</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 17:53:53</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868531"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42868464">
          <h3>
            <a
              class="item"
              href="https://vetmed.illinois.edu/i-tick/2019/08/09/iceman-lyme-mummy-tattle-the-tick-blog/"
              >Ötzi the Lyme Mummy (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 17:49:16</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868464"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42868390">
          <h3>
            <a
              class="item"
              href="https://arcprize.org/blog/r1-zero-r1-results-analysis"
              >An analysis of DeepSeek's R1-Zero and R1</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 17:44:45</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868390"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42868271">
          <h3>
            <a
              class="item"
              href="https://www.hirundo.io/blog/deepseek-r1-debiased"
              >DeepSeek's Hidden Bias: How We Cut It by 76% Without Performance
              Loss</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 17:38:07</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868271"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42867708">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/frigade/jobs/KUwAluN-senior-full-stack-engineer"
              >Frigade (YC W23) is hiring engineer #2</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 17:00:50</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42867324">
          <h3>
            <a class="item" href="https://www.stc.org/"
              >Society for Technical Communication to permanently close its
              doors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 16:40:19</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42867324"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42867050">
          <h3>
            <a class="item" href="https://github.com/lastmile-ai/mcp-agent"
              >Show HN: Mcp-Agent – Build effective agents with Model Context
              Protocol</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 16:26:07</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42867050"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/lastmile-ai/mcp-agent"
                >https://github.com/lastmile-ai/mcp-agent</a
              >) for Model Context Protocol [2]. It makes it easy to build AI
              apps with MCP servers, and implements every pattern from the
              popular Building Effective Agents blog [3] as well as OpenAI’s
              Swarm [4]. I’m sharing it early to get community feedback on where
              to take it from here, and to ask for contributions.
              <p>
                For those who aren’t familiar with MCP, I think of it as a
                standardized interface to let AI communicate with software via
                tool calls, resources and prompts.
              </p>
              <p>
                mcp-agent provides a higher level interface to build apps with
                MCP. It handles the connection management of MCP servers so you
                don’t have to. It also implements the Building Effective Agents
                patterns: - Augmented LLM (an LLM with access to one or more MCP
                servers) - Router, Orchestrator-Worker, Evaluator-Optimizer, and
                more - Swarm
              </p>
              <p>
                The key design principles are composability and reusability –
                every pattern is an AugmentedLLM itself, so you can chain them
                into more complex workflows.
              </p>
              <p>
                Some background: I worked on LSP [5] and language servers at
                Microsoft, and saw firsthand how standards and protocols can
                revolutionize developer workflows. Before LSP every IDE had its
                own esoteric ways of providing language services. LSP changed
                all that, and arguably made every language server better, since
                they can focus on improving a single implementation for all
                clients.
              </p>
              <p>
                I think AI development is in a similar pre-LSP space right now.
                There are tons of frameworks [6], every model provider has its
                own way of handling messages, tool calls, streaming, etc. I
                really think we need a protocol to standardize these patterns.
              </p>
              <p>
                Pretty soon every service is going to expose an MCP interface,
                and mcp-agent is about letting developers orchestrate these
                services into applications (i.e. build “MCP apps”). This can
                cover any use of an AI model that needs to interact with the
                world around it: - RAG pipelines and Q&amp;A chatbots - Process
                automation via AI workflows/async tasks - Multi-agent
                orchestration, with human in the loop
              </p>
              <p>
                The repo contains examples [7] to build RAG agents, streamlit
                apps and more. There’s a lot left to build, like streaming
                support, server auth and tighter integration with MCP clients.
              </p>
              <p>
                But I wanted to share early in the hopes that you can guide me:
                - If you find this useful, please let me know. If it’s useful to
                you, I will dedicate all my time to improving it. - I really
                welcome contributions. If you want to collaborate, please reach
                out on github to help take this forward.
              </p>
              <p>
                I want to help standardize AI development, so developers a few
                years from now can look back with horror at the pre-MCP days.
              </p>
              <p>
                [1] -
                <a href="https://github.com/lastmile-ai/mcp-agent"
                  >https://github.com/lastmile-ai/mcp-agent</a
                >
              </p>
              <p>
                [2] -
                <a href="https://modelcontextprotocol.io/introduction"
                  >https://modelcontextprotocol.io/introduction</a
                >
              </p>
              <p>
                [3] -
                <a
                  href="https://www.anthropic.com/research/building-effective-agents"
                  >https://www.anthropic.com/research/building-effective-agents</a
                >
              </p>
              <p>
                [4] -
                <a href="https://github.com/openai/swarm"
                  >https://github.com/openai/swarm</a
                >
              </p>
              <p>
                [5] -
                <a href="https://microsoft.github.io/language-server-protocol/"
                  >https://microsoft.github.io/language-server-protocol/</a
                >
              </p>
              <p>
                [6] -
                <a href="https://xkcd.com/927/">https://xkcd.com/927/</a> (I
                understand the irony)
              </p>
              <p>
                [7] -
                <a
                  href="https://github.com/lastmile-ai/mcp-agent/tree/main/examples"
                  >https://github.com/lastmile-ai/mcp-agent/tree/main/examples</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42866702">
          <h3>
            <a
              class="item"
              href="https://www.qodo.ai/blog/effective-code-suggestions-llms-less-is-more/"
              >Effective AI code suggestions: less is more</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 16:07:09</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42866702"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42866572">
          <h3>
            <a
              class="item"
              href="https://ebpf.foundation/case-study-bytedance-uses-ebpf-to-enhance-networking-performance/"
              >Case Study: ByteDance Uses eBPF to Enhance Networking
              Performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 15:58:20</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42866572"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42866201">
          <h3>
            <a
              class="item"
              href="https://www.getlago.com/blog/deepseek-open-source"
              >Why DeepSeek had to be open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 15:37:31</span
              ><span class="points-container"
                >Points: <span class="points">470</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42866201"
                  >Comments</a
                ><span class="descendants">: 238</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42865867">
          <h3>
            <a
              class="item"
              href="https://celso.io/posts/2025/01/26/the-first-perfect-computer/"
              >A story about restoring and upgrading a Commodore Amiga 1000</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 15:16:41</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42865867"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42865619">
          <h3>
            <a
              class="item"
              href="https://www.androidcentral.com/phones/google-pixel-4as-old-firmware-is-gone-trapping-users-on-the-buggy-battery-update"
              >Google Pixel 4a's old firmware is gone, trapping users on buggy
              battery update</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 14:59:59</span
              ><span class="points-container"
                >Points: <span class="points">188</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42865619"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42865575">
          <h3>
            <a
              class="item"
              href="https://twitter.com/carrigmat/status/1884244369907278106"
              >Complete hardware and software setup for running Deepseek-R1
              locally</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 14:56:57</span
              ><span class="points-container"
                >Points: <span class="points">206</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42865575"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42864788">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/pc-components/hdds/german-seagate-customers-say-their-new-hard-drives-were-actually-used-resold-hdds-reportedly-used-for-tens-of-thousands-of-hours"
              >Seagate: 'new' hard drives used for tens of thousands of hours</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 13:42:03</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42864788"
                  >Comments</a
                ><span class="descendants">: 158</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42864122">
          <h3>
            <a class="item" href="https://preserves.dev/"
              >Preserves: An Expressive Data Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 12:30:37</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42864122"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42863901">
          <h3>
            <a
              class="item"
              href="https://www.definite.app/blog/duck-takes-flight"
              >Adding concurrent read/write to DuckDB with Arrow Flight</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 11:52:02</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42863901"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42863262">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/blog-post/bacteria-and-their-metabolites-and-depression"
              >Bacteria (and Their Metabolites) and Depression</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 09:54:33</span
              ><span class="points-container"
                >Points: <span class="points">350</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42863262"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42862246">
          <h3>
            <a
              class="item"
              href="https://ohdoylerules.com/workflows/why-i-still-like-sublime-text-in-2025/"
              >I still like Sublime Text</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 06:43:43</span
              ><span class="points-container"
                >Points: <span class="points">877</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42862246"
                  >Comments</a
                ><span class="descendants">: 469</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42861475">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/a0dfedd1-5255-4fa9-8ccc-1fe01de87ea6"
              >OpenAI says it has evidence DeepSeek used its model to train
              competitor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 04:21:20</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42861475"
                  >Comments</a
                ><span class="descendants">: 874</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42854291">
          <h3>
            <a
              class="item"
              href="https://andrewchilds.com/posts/building-a-t1d-smartwatch-from-scratch"
              >Building a T1D smartwatch for my son from scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-28 @ 16:33:32</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42854291"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42853633">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=-qisIViAHwI"
              >Boom XB-1 First Supersonic Flight [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-28 @ 15:46:53</span
              ><span class="points-container"
                >Points: <span class="points">676</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42853633"
                  >Comments</a
                ><span class="descendants">: 488</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42834739">
          <h3>
            <a
              class="item"
              href="https://www.cbc.ca/radio/thecurrent/dogs-understanding-words-new-research-1.7326495"
              >Think your dog can understand words? This scientist says you
              might be right</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-26 @ 22:13:00</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42834739"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42825324">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-01-silicon-quantum-dots-chip-electronics.html"
              >Integration of 1,024 silicon quantum dots with on-chip
              electronics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-25 @ 22:02:27</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42825324"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
