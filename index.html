<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44572028">
          <h3>
            <a
              class="item"
              href="https://thenewstack.io/kubernetes-finally-solves-its-biggest-problem-managing-databases/"
              >Kubernetes Solves Its Biggest Problem: Managing Databases</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 15:15:20</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44572028"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44571954">
          <h3>
            <a
              class="item"
              href="https://www.psypost.org/secret-changes-to-major-u-s-health-datasets-raise-alarms/"
              >Secret changes to major U.S. health datasets raise alarms</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 15:09:20</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44571954"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44571563">
          <h3>
            <a
              class="item"
              href="https://torrentfreak.com/cloudflare-starts-blocking-pirate-sites-for-uk-users-thats-a-pretty-big-deal-250715/"
              >Cloudflare Starts Blocking Pirate Sites for UK Users</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 14:33:55</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44571563"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44570886">
          <h3>
            <a
              class="item"
              href="https://www.assemblymag.com/articles/91581-the-moving-assembly-line-turns-100"
              >The Moving Assembly Line Turns 100 (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 13:23:34</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44570886"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44570251">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/crimson/jobs/kCikzj1-founding-engineer-full-stack"
              >Crimson (YC X25) is hiring founding engineers in London</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 12:00:48</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44570048">
          <h3>
            <a class="item" href="https://github.com/trymirai/uzu"
              >Show HN: We made our own inference engine for Apple Silicon</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 11:29:02</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44570048"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              We wrote our inference engine on Rust, it is faster than llama cpp
              in all of the use cases. Your feedback is very welcomed. Written
              from scratch with idea that you can add support of any kernel and
              platform.
            </div>
          </section>
        </section>
        <section id="44567888">
          <h3>
            <a
              class="item"
              href="https://clickhouse.com/blog/sigterm-postgres-mystery"
              >When Sigterm Does Nothing: A Postgres Mystery</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 04:43:08</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44567888"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44567857">
          <h3>
            <a
              class="item"
              href="https://tomrenner.com/posts/llm-inevitabilism/"
              >LLM Inevitabilism</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 04:35:35</span
              ><span class="points-container"
                >Points: <span class="points">1138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44567857"
                  >Comments</a
                ><span class="descendants">: 987</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44567683">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/culture/critics-notebook/the-new-literalism-plaguing-todays-biggest-movies"
              >Literalism plaguing todayâ€™s movies</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 03:52:38</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44567683"
                  >Comments</a
                ><span class="descendants">: 196</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44566996">
          <h3>
            <a
              class="item"
              href="https://lyons-den.com/whitepapers/aws-lambda-silent-crash.pdf"
              >AWS Lambda Silent Crash â€“ A Platform Failure, Not an Application
              Bug [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 01:22:49</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44566996"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44565668">
          <h3>
            <a class="item" href="https://github.com/ml-explore/mlx/pull/1983"
              >Apple's MLX adding CUDA support</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 21:40:30</span
              ><span class="points-container"
                >Points: <span class="points">472</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44565668"
                  >Comments</a
                ><span class="descendants">: 164</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44564656">
          <h3>
            <a
              class="item"
              href="https://www.caltech.edu/about/news/ligo-detects-most-massive-black-hole-merger-to-date"
              >LIGO detects most massive black hole merger to date</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 20:06:51</span
              ><span class="points-container"
                >Points: <span class="points">319</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44564656"
                  >Comments</a
                ><span class="descendants">: 165</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44564531">
          <h3>
            <a class="item" href="https://neural-os.com/"
              >NeuralOS: An operating system powered by neural networks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 19:54:26</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44564531"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44564248">
          <h3>
            <a class="item" href="https://research.trychroma.com/context-rot"
              >Context Rot: How increasing input tokens impacts LLM
              performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 19:25:15</span
              ><span class="points-container"
                >Points: <span class="points">214</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44564248"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
            <div class="text">
              <p>
                TLDR: Model performance is non-uniform across context lengths,
                including state-of-the-art GPT-4.1, Claude 4, Gemini 2.5, and
                Qwen3 models.
              </p>
              <p>
                This highlights the need for context engineering. Whether
                relevant information is present in a modelâ€™s context is not all
                that matters; what matters more is how that information is
                presented.
              </p>
              <p>
                Here is the complete open-source codebase to replicate our
                results:
                <a href="https://github.com/chroma-core/context-rot"
                  >https://github.com/chroma-core/context-rot</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44563324">
          <h3>
            <a class="item" href="https://cognition.ai/blog/windsurf"
              >Cognition (Devin AI) to Acquire Windsurf</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 18:07:15</span
              ><span class="points-container"
                >Points: <span class="points">460</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44563324"
                  >Comments</a
                ><span class="descendants">: 378</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44561328">
          <h3>
            <a
              class="item"
              href="https://assemblingamerica.substack.com/p/there-is-no-meritocracy-without-lottocracy"
              >Random selection is necessary to create stable meritocratic
              institutions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 15:28:36</span
              ><span class="points-container"
                >Points: <span class="points">300</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44561328"
                  >Comments</a
                ><span class="descendants">: 246</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44560662">
          <h3>
            <a class="item" href="https://kiro.dev/blog/introducing-kiro/"
              >Kiro:Â A new agentic IDE</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 14:24:40</span
              ><span class="points-container"
                >Points: <span class="points">936</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44560662"
                  >Comments</a
                ><span class="descendants">: 398</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44552500">
          <h3>
            <a
              class="item"
              href="https://www.djangoproject.com/weblog/2025/jul/13/happy-20th-birthday-django/"
              >Happy 20th Birthday, Django</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-13 @ 18:44:56</span
              ><span class="points-container"
                >Points: <span class="points">541</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44552500"
                  >Comments</a
                ><span class="descendants">: 158</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44550722">
          <h3>
            <a
              class="item"
              href="https://www.cse.iitb.ac.in/~mythili/virtcc/papers/vmware.pdf"
              >VMware Workstation: Bringing Virtualization to the x86
              Architecture (2012) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-13 @ 14:33:18</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44550722"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44549549">
          <h3>
            <a class="item" href="https://menerdu.vercel.app/"
              >Show HN: I built this to talk Danish to my girlfriend â€“ works
              with any language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-13 @ 11:38:18</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44549549"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
            <div class="text">
              <p>
                Especially in those cases, I used to give up and translate the
                entire message from English, which kind of defeats the purpose
                and interrupts the learning process.
              </p>
              <p>
                So I started prompting GPT. Iâ€™d write my message with wildcards
                or notes for the parts I didnâ€™t know, and it would return a
                corrected version. That worked well, but reusing the prompt each
                time became tedious.
              </p>
              <p>So I built a wrapper around it.</p>
              <p>
                Now I can type in the target language, mark unclear parts with
                curly braces {like this}, and get an instant corrected version
                with explanations. I also added a history feature so I can
                review what I got wrong, and I plan to build more on that soon
                (eg. summary of areas or words to review).
              </p>
              <p>
                This app is for language learners who want to practice writing
                without feeling insecure about mistakes or breaking their flow
                by switching to a translator.
              </p>
              <p>I hope you find it useful!</p>
            </div>
          </section>
        </section>
        <section id="44549517">
          <h3>
            <a
              class="item"
              href="https://auri-microadventure.azurewebsites.net/"
              >Micro Adventure â€“ Space Attack (online emulator)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-13 @ 11:32:51</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44549517"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44547686">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2506.05987"
              >The JPEG XL Image Coding History, Features, Coding Tools, Design
              Rationale</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-13 @ 05:05:54</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44547686"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44545695">
          <h3>
            <a
              class="item"
              href="https://thewalrus.ca/empress-of-ireland-survivor-mystery/"
              >I Solved the Century-Old Mystery of a Miraculous Shipwreck
              Survivor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-12 @ 22:24:57</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44545695"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44543388">
          <h3>
            <a
              class="item"
              href="https://whatisthequestion.wordpress.com/2025/07/12/english-translators-of-homer-by-simeon-underwood/"
              >"English Translators of Homer": A Review</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-12 @ 17:09:08</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44543388"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44535202">
          <h3>
            <a class="item" href="https://replicube.xyz/staging/"
              >Replicube: 3D shader puzzle game, online demo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 18:00:01</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44535202"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44534807">
          <h3>
            <a
              class="item"
              href="https://blog.engora.com/2025/06/english-football-data.html"
              >Win, lose, or draw: trends in English football match results</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 17:23:55</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44534807"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44533759">
          <h3>
            <a
              class="item"
              href="https://rubenerd.com/vcds-and-laserdiscs-in-southeast-asia/"
              >VHS, VCDs, and Laserdiscs in Southeast Asia</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 16:02:13</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44533759"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44530518">
          <h3>
            <a class="item" href="https://github.com/slaily/aiosqlitepool"
              >SQLite async connection pool for high-performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 10:26:32</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44530518"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44529150">
          <h3>
            <a
              class="item"
              href="https://android-developers.googleblog.com/2025/07/transition-to-16-kb-page-sizes-android-apps-games-android-studio.html"
              >Transition to using 16 KB page sizes for Android apps and
              games</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 07:04:10</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44529150"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44526322">
          <h3>
            <a class="item" href="https://benbridle.com/projects/bedrock.html"
              >Show HN: Bedrock â€“ An 8-bit computing system for running programs
              anywhere</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-10 @ 22:20:18</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44526322"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
            <div class="text">
              <p>
                Bedrock is a lightweight program runtime: programs assemble down
                to a few kilobytes of bytecode that can run on any computer,
                console, or handheld. The runtime is tiny, it can be implemented
                from scratch in a few hours, and the I/O devices for accessing
                the keyboard, screen, networking, etc. can be added on as
                needed.
              </p>
              <p>
                I designed Bedrock to make it easier to maintain programs as a
                solo developer. It's deeply inspired by Uxn and PICO-8, but it
                makes significant departures from Uxn to provide more
                capabilities to programs and to be easier to implement.
              </p>
              <p>Let me know if you try it out or have any questions.</p>
            </div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
