<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40085543">
          <h3>
            <a
              class="item"
              href="https://unixdigest.com/tutorials/tips-on-how-to-structure-your-home-directory.html"
              >Tips on how to structure your home directory (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 11:39:55</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40085543"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40085214">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2024/04/19/tech/china-apple-whatspp-threads-removal-hnk-intl/index.html"
              >Apple deletes WhatsApp, Threads from China app store on orders
              from Beijing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 10:51:01</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40085214"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40085134">
          <h3>
            <a
              class="item"
              href="https://discord.com/blog/developing-rapidly-with-generative-ai"
              >Developing Rapidly with Generative AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 10:37:54</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40085134"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40085122">
          <h3>
            <a
              class="item"
              href="https://techcommunity.microsoft.com/t5/networking-blog/three-reasons-why-you-should-not-use-iperf3-on-windows/ba-p/4117876"
              >Microsoft: Don't Use Iperf3 on Windows</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 10:36:31</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40085122"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40084699">
          <h3>
            <a
              class="item"
              href="https://huggingface.co/MaziyarPanahi/Meta-Llama-3-8B-Instruct-GGUF/discussions/5"
              >Llama 3 8B is almost as good as Wizard 2 8x22B</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 09:11:27</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40084699"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40084681">
          <h3>
            <a
              class="item"
              href="https://ianbetteridge.com/2024/04/19/what-a-difference-four-years-makes/"
              >What a difference four years makes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 09:07:21</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40084681"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40084508">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2024/04/google-merges-the-android-chrome-and-hardware-divisions/"
              >Google merges the Android, Chrome, and hardware divisions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 08:27:29</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40084508"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40084225">
          <h3>
            <a
              class="item"
              href="https://www.futilitycloset.com/2024/04/19/protocol-3/"
              >New Mexico: Psychologists to dress up as wizards when providing
              expert testimony</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 07:25:14</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40084225"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40084104">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40084104"
              >Routine (YC W21) Is Hiring OCaml Software Engineers: On Site
              (Paris) or Remote</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 07:00:09</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Routine is building the next-generation work operating system
                for teams and individuals: customizable and data-centric (graph
                data architecture).
              </p>
              <p>
                We are expanding our founding team with backend software
                engineers who have knowledge in functional programming (we use
                OCaml) and scalable systems.
              </p>
              <p>
                Our team is based in Paris, France but we are open to remote
                candidates.
              </p>
              <p>
                More information here:
                <a href="https://base.routine.co/jobs"
                  >https://base.routine.co/jobs</a
                >
              </p>
              <p>Feel free to get in touch at apply@routine.co</p>
            </div>
          </section>
        </section>
        <section id="40083807">
          <h3>
            <a
              class="item"
              href="https://supabase.com/blog/s3-compatible-storage"
              >Supabase Storage: now supports the S3 protocol</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 05:51:32</span
              ><span class="points-container"
                >Points: <span class="points">233</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40083807"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40083641">
          <h3>
            <a class="item" href="http://www.vors.stargrave.org/"
              >VoRS: Vo(IP) Simple Alternative to Mumble</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 05:16:37</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40083641"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40083285">
          <h3>
            <a class="item" href="https://scaleofuniverse.com/en"
              >Scale of the Universe</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 03:53:15</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40083285"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40083036">
          <h3>
            <a
              class="item"
              href="https://plbrault.com/blog-posts/i-used-netscape-composer-in-2024-en/"
              >I Used Netscape Composer in 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 02:53:32</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40083036"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40082409">
          <h3>
            <a
              class="item"
              href="https://gajus.com/blog/setting-up-postgre-sql-for-running-integration-tests"
              >Setting up PostgreSQL for running integration tests</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 01:00:49</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40082409"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40082372">
          <h3>
            <a class="item" href="https://www.seamonkey-project.org"
              >SeaMonkey All-in-One Internet Application Suite</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-19 @ 00:55:11</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40082372"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40081999">
          <h3>
            <a
              class="item"
              href="https://www.texasmonthly.com/being-texan/the-former-slave-who-became-a-cowboy-a-rancher-and-a-texas-legend/"
              >A former slave who became a cowboy, a rancher, and a Texas
              legend</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 23:59:25</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40081999"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40081541">
          <h3>
            <a class="item" href="https://calculusmadeeasy.org/prologue.html"
              >Calculus Made Easy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 22:44:52</span
              ><span class="points-container"
                >Points: <span class="points">458</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40081541"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40081314">
          <h3>
            <a
              class="item"
              href="https://mcyoung.xyz/2024/04/17/calling-convention/"
              >The Rust calling convention we deserve</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 22:13:13</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40081314"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40081194">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/research/publications/imagine-flash-accelerating-emu-diffusion-models-with-backward-distillation/"
              >Imagine Flash: Accelerating Emu Diffusion Models with Backward
              Distillation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 21:59:01</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40081194"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40080775">
          <h3>
            <a
              class="item"
              href="https://e360.yale.edu/features/sea-lampreys-pacific-lampreys-american-rivers-dams"
              >Long Reviled as 'Ugly,' Sea Lampreys Get Some Respect (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 21:11:46</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40080775"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40080695">
          <h3>
            <a
              class="item"
              href="https://dl.acm.org/doi/10.1145/3617232.3624859?ai=&amp;ui=&amp;af="
              >Formal Mechanised Semantics of CHERI C: Capabilities, Undefined
              Behaviour</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 21:04:25</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40080695"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40080406">
          <h3>
            <a
              class="item"
              href="http://www.douglas-self.com/MUSEUM/TRANSPORT/motorwhl/motorwhl.htm"
              >Monowheels: Vehicles with Insufficient Wheels</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 20:31:09</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40080406"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40077533">
          <h3>
            <a class="item" href="https://llama.meta.com/llama3/"
              >Meta Llama 3</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 15:57:22</span
              ><span class="points-container"
                >Points: <span class="points">1925</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40077533"
                  >Comments</a
                ><span class="descendants">: 799</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40076345">
          <h3>
            <a class="item" href="https://icode4.coffee/?p=738"
              >Halo 2 in HD: Pushing the Original Xbox to the Limit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 14:01:06</span
              ><span class="points-container"
                >Points: <span class="points">409</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40076345"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40075571">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40075571"
              >Launch HN: Volta Labs (YC W19) – Easier sample prep for
              genomics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 12:40:34</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40075571"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.voltalabs.com">https://www.voltalabs.com</a
              >), a genomics applications company that is using advanced
              electrowetting technology to solve one of the toughest challenges
              facing the genomics industry—scalable sample prep. We’ve built a
              walk-away benchtop sample prep system that comes preloaded with
              apps that require no user programming or optimization, enabling
              labs to maximize resources, scale sample throughput, and reduce
              risks related to manual handling. I filmed a quick video in the
              lab if you want to see what it looks like IRL:
              <a href="https://vimeo.com/935960826/d0efdf3f14"
                >https://vimeo.com/935960826/d0efdf3f14</a
              >.
              <p>
                Sample prep is the process of going from raw biological samples
                to sequenceable molecules. The process typically involves
                isolating nucleic acids from samples like blood/cells, breaking
                up these nucleic acids into small pieces, and adding barcodes at
                a molecular level.
              </p>
              <p>
                Although sequencing technologies have made huge advancements in
                general, sample preparation is largely still done manually and
                remains a bottleneck. Many companies, small and large, have
                attempted to develop solutions that haven’t panned out. A couple
                things make it so challenging:
              </p>
              <p>
                (1) The number of sample types - for humans alone, sample types
                include blood, saliva, various tissue types, buccal swab, etc.
                Each has its own requirements when it comes to handling to
                isolate nucleic acids, and even within each type there are
                significant differences. For example, blood from various donors
                has different cell density.
              </p>
              <p>
                (2) There is a large array of chemistries for different analyses
                and sequencing technologies, and there is a need for flexibility
                in throughputs to process a few samples at a time or run large
                batches.
              </p>
              <p>
                Developing a technology that is flexible enough to work with
                various sample types and chemistries while maintaining quality
                spans many disciplines: fluidic dynamics, thermal engineering,
                molecular biology, material science, mechanical engineering,
                electrical engineering, and software engineering.
              </p>
              <p>
                I didn’t set out to develop a way to automate sample prep. I was
                exploring the use of electrowetting to manipulate colored
                droplets on a circuit board during my research in the MIT Media
                Lab. During one of my demos, there was huge interest from
                biologists at the lab as well as from biotech/pharma sponsors. I
                quickly began to realize that the application of this technology
                and the potential impact it could have was much larger than I
                had anticipated. I immediately got to work studying biology,
                focusing on five broad markets that included DNA sequencing and
                synthetic biology. The opportunity in the well-established DNA
                sequencing market begging for a solution to improve the quality
                of samples, reduce costs and create throughput flexibility led
                me to developing a way to automate sample prep. And here we are
                today, bringing it to market.
              </p>
              <p>
                The Callisto Sample Prep System is a sequencer-agnostic benchtop
                system that enables a push-button, walkaway sample prep
                experience. This enables all labs—labs already using sequencing
                automation, and those new to sequencing—to free up resources and
                not rely on skilled labor to maximize throughput. By automating
                the process end to end, reliably, scientists can focus on other
                aspects of research and development.
              </p>
              <p>
                What exactly does the instrument do? It manipulates little
                droplets on a surface using electric and magnetic fields. These
                droplets contain DNA, RNA, enzymes and other biochemistries, or
                they can be raw samples such as blood, saliva, etc. Once these
                droplets are on the surface, we move, merge, mix and split them
                in various ways. We also incubate these samples to specific
                temperatures on the same surface. We also use traditional
                robotic technologies such as gantry and pipettors for a limited
                set of operations.
              </p>
              <p>
                Our approach has many advantages over existing technologies: it
                allows us to reduce total cost to our customers with less
                plastic waste and reagent usage; it improves quality of samples
                prepared; it provides reliable sample manipulation given the
                electric and magnetic nature of the technology; and it offers
                complete walk-away automation, bringing the push-button
                experience of a sequencer to sample prep.
              </p>
              <p>
                I’m proud to bring a solution to the market that is accessible
                for all labs, especially labs with lower budgets (which are the
                majority). Now small core labs can provide low-cost, competitive
                solutions relative to commercial service providers, and larger
                labs can scale up their processes to make new sequencing
                technologies available to their customers. Individual labs at
                universities can now bring sequencers in-house for
                cost-effective, efficient, and reliable sequencing. So many
                applications, with huge potential impact for consumers!
              </p>
              <p>
                Fewer than 5M humans have so far been exposed directly to
                sequencing technologies, yet sequencing technologies and life
                sciences tool development is what propels the modern world of
                biology. The only other field that has experienced advancements
                faster than sequencing technologies over the past two decades is
                AI, if that gives a basis of comparison for how big this is.
              </p>
              <p>
                This level of sample prep automation is new to genomics, new to
                the world! I’m excited to hear your comments, questions,
                thoughts, ideas - please share your insights and experiences to
                help us realize the full potential of this technology and make a
                tangible impact on science and society. And, go!
              </p>
            </div>
          </section>
        </section>
        <section id="40067857">
          <h3>
            <a
              class="item"
              href="https://github.com/spawnmason/randar-explanation/blob/master/README.md"
              >Randar: A Minecraft exploit that uses LLL lattice reduction to
              crack server RNG</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:42:51</span
              ><span class="points-container"
                >Points: <span class="points">405</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067857"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40067238">
          <h3>
            <a
              class="item"
              href="https://sarahendren.substack.com/p/the-city-and-the-limiting-virtues"
              >The City and the Limiting Virtues</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 16:50:10</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067238"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063555">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/why-feathers-are-one-of-evolutions-cleverest-inventions/"
              >Feathers are one of evolution's cleverest inventions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:17:08</span
              ><span class="points-container"
                >Points: <span class="points">365</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063555"
                  >Comments</a
                ><span class="descendants">: 208</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063199">
          <h3>
            <a class="item" href="https://www.bbc.co.uk/newsround/68824029"
              >Old part of International Space Station lands on family home</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 11:44:01</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063199"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40061605">
          <h3>
            <a
              class="item"
              href="https://yosefk.com/blog/the-state-of-ai-for-hand-drawn-animation-inbetweening.html"
              >The state of AI for hand-drawn animation inbetweening</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 07:35:40</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40061605"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
