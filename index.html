<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42386025">
          <h3>
            <a
              class="item"
              href="https://www.ntietz.com/blog/evolving-ergo-setup/"
              >Evolving my ergonomic setup (or, my laptop with extra steps)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 08:56:50</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42386025"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42385761">
          <h3>
            <a
              class="item"
              href="https://www.rmg.co.uk/whats-on/astronomy-photographer-year/galleries/overall-winners-2024"
              >Astronomy Photographer of the Year 2024 winners</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 07:56:39</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42385761"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42385471">
          <h3>
            <a
              class="item"
              href="https://idyllopuspress.com/idyllopus/film/sh_maps.htm"
              >Stanley Kubrick's the Shining Maps of the Overlook</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 06:52:32</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42385471"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42384849">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/p/turning-off-zen-4s-op-cache-for-curiosity"
              >Turning Off Zen 4's Op Cache for Curiosity and Giggles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 04:38:42</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42384849"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42384768">
          <h3>
            <a
              class="item"
              href="https://gilkalai.wordpress.com/2024/12/09/the-case-against-googles-claims-of-quantum-supremacy-a-very-short-introduction/"
              >The Case Against Google's Claims of "Quantum Supremacy"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 04:22:10</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42384768"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42383840">
          <h3>
            <a
              class="item"
              href="https://www.genengnews.com/topics/translational-medicine/ketone-body-role-in-regulating-misfolded-proteins-may-inform-strategies-targeting-aging-alzheimers-disease/"
              >Alzheimer's study shows ketone bodies help clear misfolded
              proteins</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 01:48:35</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42383840"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42383136">
          <h3>
            <a
              class="item"
              href="https://electric-sql.com/blog/2024/12/10/electric-beta-release"
              >Electric (Postgres sync engine) beta release</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 00:04:41</span
              ><span class="points-container"
                >Points: <span class="points">201</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42383136"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42382759">
          <h3>
            <a
              class="item"
              href="https://lflank.wordpress.com/2024/12/10/the-albuquerque-broken-arrow-nuclear-accident/"
              >The Albuquerque "Broken Arrow" Nuclear Accident</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 23:12:21</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42382759"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42381637">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2024/12/10/gm-halts-funding-of-robotaxi-development-by-cruise.html"
              >GM exits robotaxi market, will bring Cruise operations in
              house</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 21:19:22</span
              ><span class="points-container"
                >Points: <span class="points">302</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42381637"
                  >Comments</a
                ><span class="descendants">: 421</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42379974">
          <h3>
            <a
              class="item"
              href="https://supabase.com/blog/durable-workflows-in-postgres-dbos"
              >Running Durable Workflows in Postgres Using DBOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 18:47:20</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42379974"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42379970">
          <h3>
            <a
              class="item"
              href="http://sibervepunk.com/digital-consumption.html"
              >Digital consumption keeps me from getting better at my job</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 18:46:50</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42379970"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42378929">
          <h3>
            <a
              class="item"
              href="https://www.chalkbeat.org/2024/12/04/timss-international-test-result-us-math-scores-decline-post-pandemic/"
              >U.S. math scores drop on major international test</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 17:24:13</span
              ><span class="points-container"
                >Points: <span class="points">286</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42378929"
                  >Comments</a
                ><span class="descendants">: 518</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42378519">
          <h3>
            <a
              class="item"
              href="https://www.surrey.ac.uk/news/surrey-announces-worlds-first-ai-model-near-instant-image-creation-consumer-grade-hardware"
              >AI model for near-instant image creation on consumer-grade
              hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 16:44:52</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42378519"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42378488">
          <h3>
            <a class="item" href="https://antirez.com/news/144"
              >From where I left</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 16:41:52</span
              ><span class="points-container"
                >Points: <span class="points">993</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42378488"
                  >Comments</a
                ><span class="descendants">: 358</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42378407">
          <h3>
            <a class="item" href="https://scottaaronson.blog/?p=8525"
              >The Google Willow Thing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 16:34:02</span
              ><span class="points-container"
                >Points: <span class="points">651</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42378407"
                  >Comments</a
                ><span class="descendants">: 328</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42378335">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2412.06769"
              >Training LLMs to Reason in a Continuous Latent Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 16:26:17</span
              ><span class="points-container"
                >Points: <span class="points">248</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42378335"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42377770">
          <h3>
            <a
              class="item"
              href="https://asteriskmag.com/issues/08/the-depths-of-wikipedians"
              >The Depths of Wikipedians</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 15:32:04</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42377770"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42377644">
          <h3>
            <a
              class="item"
              href="https://www.medievalists.net/2024/06/colour-middle-ages/"
              >Colour in the Middle Ages</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 15:19:57</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42377644"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42377018">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42377018"
              >Launch HN: Double (YC W24) – Index Investing with 0% Expense
              Ratios</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 14:16:54</span
              ><span class="points-container"
                >Points: <span class="points">366</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42377018"
                  >Comments</a
                ><span class="descendants">: 367</span></span
              >
            </h4>
            <div class="text">
              <a href="https://double.finance">https://double.finance</a>).
              Double lets you invest in 50+ broad stock market indexes with 0%
              expense ratios. We handle all the management, including
              rebalancing and tax-loss harvesting—proactively selling losing
              stocks to potentially save on taxes—for $1/month.
              <p>
                Our goal is to bring the low fee trend pioneered by Robinhood to
                ETFs and mutual funds. We posted a Show HN about 3 months ago
                (<a href="https://news.ycombinator.com/item?id=41246686"
                  >https://news.ycombinator.com/item?id=41246686</a
                >) and since then have crossed $10M in AUM (Assets Under
                Management) [1].
              </p>
              <p>
                Here’s a demo video:
                <a
                  href="https://www.loom.com/share/10c9150ce4114f278e8c249f211e7ec8"
                  >https://www.loom.com/share/10c9150ce4114f278e8c249f211e7ec8</a
                >. Please note that none of this content should be treated as
                financial advice.
              </p>
              <p>
                Everyone knows that fees eat into your investing returns.
                Financial advisors generally charge 1% of AUM per year, and ETFs
                have a weighted average expense ratio of about 0.17%, although
                some go as low as 0.03% for VOO. Over a 30-year period on a
                $500k portfolio with $2k invested monthly, the money lost to
                those fees would be $1.30M for the financial advisor and $244k
                for the average ETF and even $42,951 for the low fee VOO.
              </p>
              <p>
                Double lets you index invest without paying any percentage-based
                fees - we charge just $1/month. It works by buying the
                individual stocks that make up popular indexes. By buying the
                individual positions, we can also customize and tax-loss harvest
                your account, something ETFs or Mutual Funds cannot do.
              </p>
              <p>
                Most ETFs and mutual funds today are not that complicated - they
                can be expressed as a CSV file with 2 columns - a ticker and a
                share number. You can find these holding csv files on most ETF
                pages (VOO[2], QQQ[3]). Right now there are about $9.1T of
                assets in ETFs[4] and $20T in Mutual Funds[5] in the US, with
                estimated revenue of $100B per year. We think this market is
                ripe for disruption.
              </p>
              <p>
                We offer 50+ strategies that track popular ETFs and are updated
                as stocks merge and indexes change. You can customize these by
                weighting sectors or stocks differently, or even build your own
                indexes from scratch using our stock/etf screening tools. Once
                you've chosen your strategy, simply set your target weights and
                deposit funds (we also support transferring existing stocks).
                Our engine then checks your portfolio daily for potential
                trades, optimizes for tax-loss harvesting, portfolio tracking,
                and redeploys any generated cash.
              </p>
              <p>
                I (JJ) started working on this after selling my last company.
                After using nearly every brokerage product out there and working
                with a financial advisor, I noticed a huge gap between the
                indexing capabilities of financial advisors and what individual
                investors could access. We wanted to bridge that gap and provide
                these powerful tools to everyone in a simple, low-cost way.
              </p>
              <p>
                There are a number of robo-advisor products out there, but none
                that we know of offer direct indexing without expense ratios or
                AUM fees. One similar product is M1 Finance, but Double is more
                powerful. We offer tax-loss harvesting, a wider range of
                indexes, and greater customization. For example, when building
                your own index, you can set weights down to 0.1% (compared to
                M1's 1%) and even weight by market cap.
              </p>
              <p>
                We also compete with robo-advisors like Wealthfront, but offer
                more control over your investments. And did I mention we don't
                charge AUM fees? You can see our strategies and play with the
                research page
                <a href="https://double.finance/p/explore"
                  >https://double.finance/p/explore</a
                >
                without creating an account.
              </p>
              <p>
                Over the past year we’ve learned a lot about the guts of
                building portfolio software. For example, stocks don’t really
                have persistent identifiers that are easy to model and pass
                around. We trade CUSIPs with our custodian Apex*, but these
                change all the time for stock splits or re-org’s that you would
                not think would lead to a new “stock”.
              </p>
              <p>
                We’ve also learned a lot about how tax loss harvesting (TLH) is
                best implemented on large direct index portfolios using a factor
                model as opposed to pairs based replacements which I initially
                thought might be the way to execute these. We do use a pairs
                strategy on smaller sized strategies. And how TLH and portfolio
                optimization generally is best expressed as a linear
                optimization problem with competing objectives (tracking vs. tax
                alpha vs. trading costs for example).
              </p>
              <p>
                If you have any thoughts on the product or our positioning as
                the low fee alternative I’d love to hear it. I think Robinhood
                has proved that you can build a strong business by getting rid
                of an industry wide cost (in their case commissions, in our
                expense ratios). We aim to do the same.
              </p>
              <p>
                [1]
                <a
                  href="https://www.axios.com/pro/fintech-deals/2024/12/10/direct-indexing-platform-double-finance-raises-seed?utm_source=editorial&amp;utm_medium=social&amp;utm_campaign=pro_edit_regwall_01-24&amp;utm_term=regwall"
                  >https://www.axios.com/pro/fintech-deals/2024/12/10/direct-in...</a
                >
                [2]
                <a
                  href="https://investor.vanguard.com/investment-products/etfs/profile/voo#portfolio-composition"
                  >https://investor.vanguard.com/investment-products/etfs/profi...</a
                >
                [3]
                <a href="https://www.invesco.com/qqq-etf/en/about.html"
                  >https://www.invesco.com/qqq-etf/en/about.html</a
                >
                [4]
                <a href="https://fred.stlouisfed.org/series/BOGZ1LM564090005Q"
                  >https://fred.stlouisfed.org/series/BOGZ1LM564090005Q</a
                >
                [5]
                <a href="https://fred.stlouisfed.org/series/BOGZ1LM654090000Q"
                  >https://fred.stlouisfed.org/series/BOGZ1LM654090000Q</a
                >
              </p>
              <p>
                * Edit to add a note on risk: If Double goes out of business,
                your assets are safe and held in your name at Apex Clearing.
                They have processes in place for these scenarios to help you
                access and transfer those assets. See more at
                <a href="https://news.ycombinator.com/item?id=42379135"
                  >https://news.ycombinator.com/item?id=42379135</a
                >
                below.
              </p>
            </div>
          </section>
        </section>
        <section id="42374027">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Boltzmann_brain"
              >Boltzmann brain</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 05:22:50</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42374027"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42359299">
          <h3>
            <a
              class="item"
              href="https://semiengineering.com/nand-flash-targets-1000-layers/"
              >NAND Flash Targets 1k Layers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-08 @ 18:54:15</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42359299"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42355609">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/obituary/2024/12/05/john-kinsel-used-his-own-language-to-fool-the-japanese"
              >One of the last Navajo code-talkers died on October 19th, aged
              107</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-08 @ 07:37:35</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42355609"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42355073">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2024/12/05/style/toledano-chan-meteorite-watch-b1m/index.html"
              >Watch carved from meteorite that hit Earth a million years ago</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-08 @ 04:47:54</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42355073"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42353333">
          <h3>
            <a
              class="item"
              href="https://www.cs.usfca.edu/~galles/visualization/BPlusTree.html"
              >B+ Tree Visualization</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-07 @ 22:25:47</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42353333"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42347571">
          <h3>
            <a
              class="item"
              href="https://filmstories.co.uk/features/we-all-took-the-dvd-boom-era-for-granted/"
              >We all took the DVD boom era for granted</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-07 @ 05:45:25</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42347571"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42343712">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/ryancdavison/5c705d78cb5c14a809d0ba5a02ab1ba4"
              >DIY Apple iPad Magic Keyboard Portrait Mode Smart Connector
              Cable</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 20:01:20</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42343712"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42343480">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-12-google-ai-weather-masters-day.html"
              >Google says AI weather model masters 15-day forecast</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 19:41:38</span
              ><span class="points-container"
                >Points: <span class="points">213</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42343480"
                  >Comments</a
                ><span class="descendants">: 154</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42307968">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41591-024-03306-x"
              >Hypothalamic deep brain stimulation augments walking after spinal
              cord injury</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-03 @ 16:28:33</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42307968"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42305301">
          <h3>
            <a class="item" href="https://www.fsoft.it/VVV/index.html"
              >VVV: Virtual Volumes View</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-03 @ 12:08:32</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42305301"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42305117">
          <h3>
            <a
              class="item"
              href="https://mailchi.mp/quantamagazine.org/why-colliding-particles-reveal-reality-4865746?e=4ee9db7d79"
              >What I learned covering computer science in 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-03 @ 11:39:27</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42305117"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
