<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36910256">
          <h3>
            <a
              class="item"
              href="https://jonathanhaidt.substack.com/p/the-play-deficit"
              >Play deprivation is a major cause of the teen mental health
              crisis</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 17:28:41</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36910256"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36910245">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/news/technology-66336058"
              >Threads users down by more than a half</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 17:27:57</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36910245"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36910146">
          <h3>
            <a
              class="item"
              href="https://www.fsf.org/blogs/community/web-environment-integrity-is-an-all-out-attack-on-the-free-internet"
              >“Web Environment Integrity” is an attack on the free Internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 17:20:55</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36910146"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36909867">
          <h3>
            <a class="item" href="https://skio.com/careers/"
              >Skio (YC S20) is hiring – Subscriptions for Shopify, ReCharge
              migrations</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 17:01:12</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36909673">
          <h3>
            <a
              class="item"
              href="https://scopeblog.stanford.edu/2023/07/26/how-an-ultra-sensitive-on-off-switch-helps-axolotls-regrow-limbs/"
              >An ultra-sensitive on-off switch helps axolotls regrow limbs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 16:49:18</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36909673"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36909525">
          <h3>
            <a class="item" href="https://github.com/domfarolino/observable"
              >Observable API Proposal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 16:39:20</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36909525"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36909427">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2023/07/28/why-is-dns-still-hard-to-learn/"
              >Why is DNS still hard to learn?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 16:33:51</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36909427"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36908623">
          <h3>
            <a
              class="item"
              href="https://cioinfluence.com/machine-learning/intel-accelerates-ai-development-with-reference-kits/"
              >Intel Accelerates AI Development with Reference Kits</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 15:47:08</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36908623"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36908574">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36908574"
              >I'm Peter Roberts, immigration attorney who does work for YC and
              startups. AMA</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 15:43:56</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36908574"
                  >Comments</a
                ><span class="descendants">: 168</span></span
              >
            </h4>
            <div class="text">
              <a href="https://news.ycombinator.com/submitted?id=proberts"
                >https://news.ycombinator.com/submitted?id=proberts</a
              >.
              <p>
                I'll be here for the next 2-3 hours and then after a break of
                about 1 hour for another 2-3 hours. As usual, there are many
                possible topics and I'll be guided by whatever you're concerned
                with. Please remember that I can't provide legal advice on
                specific cases for obvious liability reasons because I won't
                have access to all the facts. Please stick to a factual
                discussion in your questions and comments and I'll try to do the
                same in my answers!
              </p>
            </div>
          </section>
        </section>
        <section id="36908309">
          <h3>
            <a
              class="item"
              href="https://capnproto.org/news/2023-07-28-capnproto-1.0.html"
              >Cap'n Proto 1.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 15:28:04</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36908309"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36908265">
          <h3>
            <a class="item" href="https://flashmuseum.org/">Flash Museum</a>
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 15:25:59</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36908265"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36908136">
          <h3>
            <a
              class="item"
              href="https://edsource.org/2023/california-moves-to-silence-stanford-researchers-who-got-state-data-to-study-education-issues/694920"
              >California moves to silence Stanford researchers who got data to
              study education</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 15:19:58</span
              ><span class="points-container"
                >Points: <span class="points">301</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36908136"
                  >Comments</a
                ><span class="descendants">: 186</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36907829">
          <h3>
            <a
              class="item"
              href="https://www.npr.org/2023/07/27/1190568472/dan-ariely-francesca-gino-harvard-dishonesty-fabricated-data"
              >Fabricated data in research about honesty</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 15:04:18</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36907829"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36907674">
          <h3>
            <a
              class="item"
              href="https://thedebrief.org/forget-solar-panels-here-come-rain-panels/"
              >Rain Panels: Harvesting the energy of falling raindrops</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 14:54:42</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36907674"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36907504">
          <h3>
            <a class="item" href="https://selecta.ciaran.co.za/"
              >Show HN: Selecta – Tune Your Own Spotify Recommendation
              Algorithm</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 14:42:22</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36907504"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                It allows you to talk to Spotify's recommendations API to
                specify musical features you'd like recommendations similar to.
              </p>
              <p>
                It's loads of fun to mess around with, and I've given it an
                overhaul to include many more dimensions ito. musical features,
                as well as the ability to log in with Spotify, and save things
                you find to a playlist. You don't need a subscription to Spotify
                to use the app either.
              </p>
              <p>
                Thanks to @Mockapapella for the tagline when I posted the first
                version:
                <a href="https://news.ycombinator.com/item?id=35907215"
                  >https://news.ycombinator.com/item?id=35907215</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36906623">
          <h3>
            <a class="item" href="https://monetal.app/index_en.php"
              >Monetal – Free Expense Tracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 13:40:09</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36906623"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36906472">
          <h3>
            <a
              class="item"
              href="https://9to5mac.com/2023/07/28/us-iphone-market-share-2/"
              >US iPhone market share jumps to 55% as Android shipments fall
              sharply</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 13:28:20</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36906472"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36906450">
          <h3>
            <a
              class="item"
              href="https://chie.app/posts/introduce-the-chie-app/"
              >Show HN: Chie – a cross-platform, native, and extensible desktop
              client for LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 13:26:32</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36906450"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              I'm submitting this before going to bed, so by the time it hits
              front page (if it does at all) I'll likely be asleep, so I won't
              be able to answer questions in time.
            </div>
          </section>
        </section>
        <section id="36906284">
          <h3>
            <a
              class="item"
              href="https://www.engadget.com/tor-dark-web-privacy-secure-browser-anonymous-130048839.html"
              >Tor’s shadowy reputation will only end if we all use it</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 13:12:15</span
              ><span class="points-container"
                >Points: <span class="points">252</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36906284"
                  >Comments</a
                ><span class="descendants">: 267</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36906140">
          <h3>
            <a class="item" href="https://cophone.io/"
              >Cophone – Mobile work phones running in the cloud</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 12:59:58</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36906140"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36906022">
          <h3>
            <a class="item" href="https://my90stv.com/"
              >Watch TV from the 90s and earlier</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 12:46:19</span
              ><span class="points-container"
                >Points: <span class="points">223</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36906022"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36905405">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/cities-with-psychological-syndromes-stockholm"
              >Cities with their own psychological disorders</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 11:32:48</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36905405"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36904080">
          <h3>
            <a
              class="item"
              href="https://arcadeblogger.com/2023/07/22/environmental-discs-of-tron-roadside-pickup/"
              >Finding “Discs of Tron” on the Roadside</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 07:48:13</span
              ><span class="points-container"
                >Points: <span class="points">236</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36904080"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36903862">
          <h3>
            <a class="item" href="https://pyro.ai/"
              >Pyro: A Universal, Probablistic Programming Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 07:10:38</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36903862"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36903149">
          <h3>
            <a
              class="item"
              href="https://acoup.blog/2023/07/21/collections-how-to-roman-republic-101-part-i-spqr/"
              >How to Roman Republic 101</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 04:37:23</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36903149"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36903103">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-cryptographer-who-ensures-we-can-trust-our-computers-20230727/"
              >Interview with Yael Tauman Kalai, a cryptographer at Microsoft</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-28 @ 04:27:28</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36903103"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36900782">
          <h3>
            <a class="item" href="https://developer.apple.com/news/?id=z6fu1dcu"
              >List of APIs that require declared reasons</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 22:06:37</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36900782"
                  >Comments</a
                ><span class="descendants">: 221</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36898068">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=-BKEZbYOMpI"
              >Knife Throwing Machine (2022) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 18:25:38</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36898068"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36893695">
          <h3>
            <a
              class="item"
              href="https://steveblank.com/2023/07/25/lean-meets-wicked-problems/"
              >Lean Meets Wicked Problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 14:03:43</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36893695"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36889656">
          <h3>
            <a
              class="item"
              href="https://github.com/remysucre/blog/blob/main/posts/sql-eq.md"
              >How to check if two SQL tables are the same</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-27 @ 06:22:12</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36889656"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
