<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39523245">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2024/02/apple-vision-pros-components-cost-1542-but-thats-not-the-full-story/"
              >Apple Vision Pro's components cost $1,542–but that's not the full
              story</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 12:30:14</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39523245"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39523241">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/bitcoin-breaks-57000-big-buyers-circle-2024-02-27/"
              >Bitcoin scorches past $57,000 as big buyers flock in</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 12:29:22</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39523241"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39523187">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/swiss-map-secrets"
              >Swiss Maps Are Full of Hidden Secrets</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 12:21:56</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39523187"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39523023">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/promoted/jobs/1dLskWr-apache-flink-expert"
              >Promoted.ai (YC W21) Is Hiring – Flink Expert</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 12:00:14</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39522798">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2022-08-rainwater-unsafe-due-chemicals.html"
              >Rainwater everywhere on the planet is unsafe to drink due to
              chemicals (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 11:27:17</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39522798"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39522770">
          <h3>
            <a
              class="item"
              href="https://erikbern.com/2021/04/19/software-infrastructure-2.0-a-wishlist.html"
              >Software Infrastructure 2.0: A Wishlist</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 11:23:17</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39522770"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39522499">
          <h3>
            <a class="item" href="https://studio.blender.org/films/"
              >Blender Open Movies. Featuring all the production files, assets,
              and artwork</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 10:42:50</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39522499"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39522348">
          <h3>
            <a
              class="item"
              href="https://docs.emailengine.app/how-i-turned-my-open-source-project-into/"
              >I turned my open-source project into a full-time business</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 10:16:18</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39522348"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39522031">
          <h3>
            <a
              class="item"
              href="https://react.dev/blog/2024/02/15/react-labs-what-we-have-been-working-on-february-2024"
              >React Labs: What We've Been Working On – February 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 09:33:21</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39522031"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39521930">
          <h3><a class="item" href="https://sive.rs/backup">I Backup</a></h3>
          <section>
            <h4>
              <span>2024-02-27 @ 09:20:01</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39521930"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39521802">
          <h3>
            <a
              class="item"
              href="https://breadchris.com/thinkies/finding-a-balance-while-coding/"
              >Balancing Optimization While Coding</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 09:03:08</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39521802"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39521650">
          <h3>
            <a
              class="item"
              href="https://www.hvdfonts.com/custom-cases/berlin-type"
              >Berlin TYPE: The official type for the city of Berlin (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 08:42:22</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39521650"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39521626">
          <h3>
            <a
              class="item"
              href="https://en.globes.co.il/en/article-houthis-hit-underwater-communications-cables-1001472165"
              >Submarine cables linking Africa-Asia-Europe severed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 08:39:15</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39521626"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39520250">
          <h3>
            <a
              class="item"
              href="https://joanwestenberg.com/blog/the-creator-economy-cant-rely-on-patreon"
              >The creator economy can't rely on Patreon</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 04:45:30</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39520250"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39519894">
          <h3>
            <a class="item" href="https://rapier.rs/docs/"
              >Rapier is a set of 2D and 3D physics engines written in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 03:39:02</span
              ><span class="points-container"
                >Points: <span class="points">210</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39519894"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39518791">
          <h3>
            <a
              class="item"
              href="https://netflixtechblog.com/announcing-bpftop-streamlining-ebpf-performance-optimization-6a727c1ae2e5?gi=223d75ac1771"
              >Bpftop: Streamlining eBPF performance optimization</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 01:04:09</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39518791"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39518202">
          <h3>
            <a
              class="item"
              href="https://vrroom.github.io/blog/2024/02/23/comic-frame-segmentation.html"
              >Segmenting Comic book Frames</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 23:33:55</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39518202"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39518161">
          <h3>
            <a class="item" href="https://github.com/fearedbliss/Cactus"
              >Cactus – A Modern Diablo II Version Switcher, Character Isolator,
              &amp;amp; Mod Manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 23:29:57</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39518161"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39517760">
          <h3>
            <a class="item" href="https://waxjs.net/"
              >Wax: The Word Processor for the Web</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 22:50:50</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39517760"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39517145">
          <h3>
            <a
              class="item"
              href="https://www.dmagazine.com/food-drink/2023/05/why-jalapeno-peppers-less-spicy-blame-aggies/"
              >Why jalapeño peppers are less spicy (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 21:50:37</span
              ><span class="points-container"
                >Points: <span class="points">245</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39517145"
                  >Comments</a
                ><span class="descendants">: 287</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39513054">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39513054"
              >Launch HN: Delve (YC W24) – HIPAA compliance as a service</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 16:17:54</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39513054"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
            <div class="text">
              <a href="https://getdelve.com">https://getdelve.com</a>). We help
              companies get HIPAA compliant fast, with 1-click infrastructure,
              streamlined legal policies, and real-time monitoring. Here’s a
              quick demo:
              <a href="https://youtu.be/mQbb5mprsUA"
                >https://youtu.be/mQbb5mprsUA</a
              >.
              <p>
                HIPAA is a US federal law passed back in 1996 that sets
                standards for protecting sensitive health information. Here’s an
                article that breaks it down pretty simply:
                <a href="https://www.getdelve.com/blog/quick-guide-to-hipaa"
                  >https://www.getdelve.com/blog/quick-guide-to-hipaa</a
                >.
              </p>
              <p>
                Most companies that process health information in the US need to
                become HIPAA compliant, a process that can be long and
                expensive. At our previous health tech company, we spent 6 weeks
                (and tens of thousands of dollars) on getting compliant. We had
                to complete a lot of manual work, even after purchasing an
                industry-standard compliance solution, and felt like we were
                hitting checkboxes with little confidence in our security. We
                realized that many parts of the compliance process could be
                streamlined and simplified, which led us to building Delve.
              </p>
              <p>
                To get HIPAA compliant, you need (1) secure infrastructure, (2)
                legal policies, and (3) logging/monitoring. At Delve, we help
                startups with all three. We provide 1-click HIPAA compliant
                infrastructure deployed in your cloud and a CI/CD pipeline to
                update infrastructure from git push (think Heroku but HIPAA
                compliant). Then, we provide legal policies, paperwork, and a
                complete task list customized to your infrastructure setup.
                Finally, we have a real-time monitoring dashboard to help
                oversee compliance, track system activity, and review logs.
              </p>
              <p>
                One thing we noticed the first time we ever got HIPAA compliant
                was that we had to use many tools along the way. We bought an
                industry-standard HIPAA compliance solution, hired a HIPAA
                DevOps contractor to help configure secure infrastructure, and
                worked with lawyers to adapt the boilerplate legal policies that
                our compliance solution had provided. When building Delve, we
                worked hard to give you everything you need in one place,
                reducing the hassle and cost.
              </p>
              <p>
                We currently charge on an annual flat-fee basis. However, we’re
                still exploring our pricing model (flat-fee vs. usage-based vs.
                combination of both), and if you have any thoughts to share on
                that, we’d love to hear them.
              </p>
              <p>
                We’re really excited about making it easier to build in
                healthcare and removing compliance bottlenecks. Thrilled to
                share this with you and hear your comments!
              </p>
            </div>
          </section>
        </section>
        <section id="39511676">
          <h3>
            <a class="item" href="https://superset.apache.org/"
              >Apache Superset</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 14:36:35</span
              ><span class="points-container"
                >Points: <span class="points">615</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39511676"
                  >Comments</a
                ><span class="descendants">: 172</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39510874">
          <h3>
            <a class="item" href="https://github.com/SciPhi-AI/R2R"
              >Show HN: R2R – Open-source framework for production-grade RAG</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 13:10:13</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39510874"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.sciphi.ai/">https://www.sciphi.ai/</a>), a
              startup working on simplifying˛Retrieval-Augmented Generation
              (RAG). Today we’re excited to share R2R (<a
                href="https://github.com/SciPhi-AI/R2R"
                >https://github.com/SciPhi-AI/R2R</a
              >), an open-source framework that makes it simpler to develop and
              deploy production-grade RAG systems.
              <p>
                Just a quick reminder: RAG helps Large Language Models (LLMs)
                use current information and specific knowledge. For example, it
                allows a programming assistant to use your latest documents to
                answer questions. The idea is to gather all the relevant
                information ("retrieval") and present it to the LLM with a
                question ("augmentation"). This way, the LLM can provide answers
                (“generation”) as though it was trained directly on your data.
              </p>
              <p>
                The R2R framework is a powerful tool for addressing key
                challenges in deploying RAG systems, avoiding the complex
                abstractions common in other projects. Through conversations
                with numerous developers, we discovered that many were
                independently developing similar solutions. R2R distinguishes
                itself by adopting a straightforward approach to streamline the
                setup, monitoring, and upgrading of RAG systems. Specifically,
                it focuses on reducing unnecessary complexity and enhancing the
                visibility and tracking of system performance.
              </p>
              <p>
                The key parts of R2R include: an Ingestion Pipeline that
                transforms different data types (like json, txt, pdf, html) into
                'Documents' ready for embedding. Next, the Embedding Pipeline
                takes text and turns it into vector embeddings through various
                processes (such as extracting text, transforming it, chunking,
                and embedding). Finally, the RAG Pipeline follows the steps of
                the embedding pipeline but adds an LLM provider to create text
                completions.
              </p>
              <p>
                R2R is currently in use at several companies building
                applications from B2B lead generation to educational tools for
                consumers.
              </p>
              <p>
                Our GitHub repo (<a href="https://github.com/SciPhi-AI/R2R"
                  >https://github.com/SciPhi-AI/R2R</a
                >) includes basic examples for application deployment and
                standalone use, demonstrating the framework's adaptability in a
                simple way.
              </p>
              <p>
                We’d love for you to give R2R a try, and welcome your feedback
                and comments as we refine and develop it further!
              </p>
            </div>
          </section>
        </section>
        <section id="39509927">
          <h3>
            <a
              class="item"
              href="https://wingolog.org/archives/2024/02/26/on-the-impossibility-of-composing-finalizers-and-ffi"
              >On the impossibility of composing finalizers and FFI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 11:09:56</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39509927"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39508467">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41467-023-43885-w"
              >Ants treat injured nestmates with antimicrobial compound in ant
              society</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 07:26:26</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39508467"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39508167">
          <h3>
            <a
              class="item"
              href="https://www.scs.stanford.edu/~dm/blog/param-pack.html"
              >C++20 Idioms for Parameter Packs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 06:26:40</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39508167"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39508046">
          <h3>
            <a class="item" href="https://kk.org/thetechnium/you-are-not-late/"
              >You are not late (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 05:54:31</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39508046"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39507820">
          <h3>
            <a class="item" href="https://multi.app/"
              >Multi – Multiplayer Collaboration for macOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 04:54:45</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39507820"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39505597">
          <h3>
            <a
              class="item"
              href="https://blog.ian.stapletoncordas.co/2024/02/a-retrospective-on-requests"
              >A Retrospective on Requests</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 22:31:32</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39505597"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39504323">
          <h3>
            <a
              class="item"
              href="https://www.sapiens.org/archaeology/neanderthal-art-paleolithic-archaeology/"
              >What's Behind the Evolution of Neanderthal Portraits</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 20:17:06</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39504323"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
