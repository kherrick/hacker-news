<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46759520">
          <h3>
            <a class="item" href="https://github.com/Jcparkyn/herd"
              >Show HN: A small programming language where everything is a
              value</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 23:01:06</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46759520"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <p>
                I started out following Crafting Interpreters, but gradually
                branched off that until I had almost nothing left in common.
              </p>
              <p>
                Tech stack: Rust, Cranelift (JIT compilation), LALRPOP (parser).
              </p>
              <p>
                Original title: "A small programming language where everything
                is a value" (edited based on comments)
              </p>
            </div>
          </section>
        </section>
        <section id="46759352">
          <h3>
            <a
              class="item"
              href="https://tomaszmachnik.pl/case-study-math-en.html"
              >Case study: Creative math – How AI fakes proofs</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 22:44:50</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46759352"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46758644">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41598-026-35389-6"
              >LED lighting undermines visual performance unless supplemented by
              wider spectra</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 21:44:10</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46758644"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46758450">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20190513-it-only-takes-35-of-people-to-change-the-world"
              >The '3.5% rule': How a small minority can change the world
              (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 21:27:11</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46758450"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46757944">
          <h3>
            <a
              class="item"
              href="https://consumerrights.wiki/w/Oneplus_phone_update_introduces_hardware_anti-rollback"
              >Oneplus phone update introduces hardware anti-rollback</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 20:39:25</span
              ><span class="points-container"
                >Points: <span class="points">358</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46757944"
                  >Comments</a
                ><span class="descendants">: 173</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46757465">
          <h3>
            <a
              class="item"
              href="https://www.techrepublic.com/article/news-149-million-passwords-exposed-infostealer-database/"
              >Data Leak Exposes 149M Logins, Including Gmail, Facebook</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 19:45:10</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46757465"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46757357">
          <h3>
            <a class="item" href="https://notes.nora.codes/atproto-again/"
              >I was right about ATProto key management</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 19:31:23</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46757357"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46757224">
          <h3>
            <a
              class="item"
              href="https://digitalseams.com/blog/the-behavioral-cost-of-personalized-pricing"
              >The behavioral cost of personalized pricing</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 19:19:12</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46757224"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46757162">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/c1m77dmxlvlo"
              >Spanish track was fractured before high-speed train disaster,
              report finds</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 19:12:50</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46757162"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46757067">
          <h3>
            <a class="item" href="https://gwern.net/blog/2026/make-me-care"
              >First, make me care</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 19:03:40</span
              ><span class="points-container"
                >Points: <span class="points">347</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46757067"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46756427">
          <h3>
            <a class="item" href="https://www.lighthouses.app/"
              >Show HN: An interactive map of US lighthouses and navigational
              aids</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 18:06:26</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46756427"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <p>
                I was sick at home with the flu this weekend, and went on a bit
                of a Wikipedia deep dive about active American lighthouses.
                Searching around a bit, it was very hard to find a single source
                or interactive map of active beacons, and a description of what
                the "characteristic" meant. The Coast Guard maintains a list of
                active lights though, that they publish annually (<a
                  href="https://www.navcen.uscg.gov/light-list-annual-publication"
                  >https://www.navcen.uscg.gov/light-list-annual-publication</a
                >). With some help from Claude Code, it wasn't hard to extract
                the lat/long and put together a small webapp that shows a map of
                these light stations and illustrates their characteristic with
                an animated visualization..
              </p>
              <p>
                Of course, this shouldn't be used as a navigational aid, merely
                for informational purposes! Though having lived in Seattle and
                San Francisco I thought it was quite interesting.
              </p>
            </div>
          </section>
        </section>
        <section id="46756117">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2026/01/report-ice-using-palantir-tool-feeds-medicaid-data"
              >ICE using Palantir tool that feeds on Medicaid data</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 17:36:19</span
              ><span class="points-container"
                >Points: <span class="points">929</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46756117"
                  >Comments</a
                ><span class="descendants">: 556</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46755115">
          <h3>
            <a
              class="item"
              href="https://www.diljitpr.net/blog-post-postgresql-dlq"
              >Using PostgreSQL as a Dead Letter Queue for Event-Driven
              Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 15:51:03</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46755115"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46754944">
          <h3>
            <a class="item" href="https://github.com/tldev/posturr"
              >A macOS app that blurs your screen when you slouch</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 15:34:51</span
              ><span class="points-container"
                >Points: <span class="points">478</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46754944"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46754724">
          <h3>
            <a class="item" href="https://github.com/danthegoodman1/netfence"
              >Show HN: Netfence – Like Envoy for eBPF Filters</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 15:13:46</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46754724"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <p>
                It allows you to define different DNS-based rules that are
                resolved in a local daemon to IPs, then pushed to the eBPF
                filter to allow traffic. By doing it this way, we can still
                allow DNS-defined rules, but prevent contacting random IPs.
              </p>
              <p>
                There's also no network performance penalty, since it's just DNS
                lookups and eBPF filters referencing memory.
              </p>
              <p>
                It also means you don't have to tamper with the base image,
                which the agent could potentially manipulate to remove rules
                (unless you prevent root maybe).
              </p>
              <p>
                It automatically manages the lifecycle of eBPF filters on
                cgroups and interfaces, so it works well for both containers and
                micro VMs (like Firecracker).
              </p>
              <p>
                You implement a control plane, just like Envoy xDS, which you
                can manage the rules of each cgroup/interface. You can even
                manage DNS through the control plane to dynamically resolve
                records (which is helpful as a normal DNS server doesn't know
                which interface/cgroup a request might be coming from).
              </p>
              <p>
                We specifically use this to allow our agents to only contact S3,
                pip, apt, and npm.
              </p>
            </div>
          </section>
        </section>
        <section id="46754522">
          <h3>
            <a
              class="item"
              href="https://dougallj.wordpress.com/2020/05/10/bitwise-conversion-of-doubles-using-only-floating-point-multiplication-and-addition/"
              >Bitwise conversion of doubles using only FP multiplication and
              addition (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 14:55:03</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46754522"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46753708">
          <h3>
            <a class="item" href="https://github.com/steffest/DPaint-js"
              >Web-based image editor modeled after Deluxe Paint</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 12:54:53</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46753708"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46753484">
          <h3>
            <a class="item" href="https://doombuds.com"
              >Doom has been ported to an earbud</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 12:22:12</span
              ><span class="points-container"
                >Points: <span class="points">354</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46753484"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46753336">
          <h3>
            <a class="item" href="https://jobs.ashbyhq.com/Nango"
              >Nango (YC W23, Dev Infrastructure) Is Hiring Remotely</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 12:02:01</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46753301">
          <h3>
            <a class="item" href="https://bonsplit.alasdairmonk.com"
              >Show HN: Bonsplit – Tabs and splits for native macOS apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 11:56:42</span
              ><span class="points-container"
                >Points: <span class="points">208</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46753301"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46753078">
          <h3>
            <a class="item" href="https://github.com/mitjafelicijan/xdgctl"
              >Show HN: TUI for managing XDG default applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 11:19:04</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46753078"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
            <div class="text">
              <p>Maybe some of you will find it useful.</p>
              <p>Happy to answer any questions.</p>
            </div>
          </section>
        </section>
        <section id="46752261">
          <h3>
            <a
              class="item"
              href="https://www.therpf.com/forums/threads/jurassic-park-tablet-device-on-nedrys-desk.169883/"
              >Jurassic Park - Tablet device on Nedry's desk? (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 09:22:17</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46752261"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46752151">
          <h3>
            <a
              class="item"
              href="https://statmodeling.stat.columbia.edu/2026/01/22/aking/"
              >A flawed paper in management science has been cited more than 6k
              times</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 09:04:30</span
              ><span class="points-container"
                >Points: <span class="points">634</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46752151"
                  >Comments</a
                ><span class="descendants">: 331</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46751826">
          <h3>
            <a
              class="item"
              href="https://dlt.github.io/blog/posts/introduction-to-postgresql-indexes/"
              >Introduction to PostgreSQL Indexes</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-25 @ 08:07:03</span
              ><span class="points-container"
                >Points: <span class="points">296</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46751826"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46718923">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2026/01/20/science/infinite-pancake-math-puzzle.html"
              >Infinite pancakes, anyone?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-22 @ 13:23:09</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46718923"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <a href="https://archive.ph/qNfbg">https://archive.ph/qNfbg</a>
            </div>
          </section>
        </section>
        <section id="46695467">
          <h3>
            <a class="item" href="https://github.com/Use-Tusk/fence"
              >Show HN: Fence – Sandbox CLI commands with network/filesystem
              restrictions</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 18:05:03</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46695467"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              <p>
                Fence wraps any command in a sandbox that blocks network by
                default and restricts filesystem writes. Useful for running
                semi-trusted code (package installs, build scripts, unfamiliar
                repos) with controlled side effects, or even just blocking tools
                that phone home.
              </p>
              <p>
                &gt; fence curl
                <a href="https://example.com">https://example.com</a> # -&gt;
                blocked
              </p>
              <p>
                &gt; fence -t code -- npm install # -&gt; template with
                registries allowed
              </p>
              <p>
                &gt; fence -m -- npm install # -&gt; monitor mode: see what gets
                blocked
              </p>
              <p>
                One use-case is to use it with AI coding agents to reduce the
                risk of running agents with fewer interactive permission
                prompts:
              </p>
              <p>&gt; fence -t code -- claude --dangerously-skip-permissions</p>
              <p>
                You can import existing Claude Code permissions with `fence
                import --claude`.
              </p>
              <p>
                Fence uses OS-native sandboxing (macOS sandbox-exec, Linux
                bubblewrap) + local HTTP/SOCKS proxies for domain filtering.
              </p>
              <p>
                Why I built this: I work on Tusk Drift, a system to record and
                replay real traffic as API tests (<a
                  href="https://github.com/Use-Tusk/tusk-drift-cli"
                  >https://github.com/Use-Tusk/tusk-drift-cli</a
                >). I needed a way to sandbox the service under test during
                replays to block localhost outbound connections (Postgres,
                Redis) and force the app to use mocks instead of real services.
                I quickly realized that this could be a general purpose tool
                that would also be useful as a permission manager across CLI
                agents.
              </p>
              <p>
                Limitations: Not strong containment against malware. Proxy-based
                filtering requires programs to respect `HTTP_PROXY`.
              </p>
              <p>
                Curious if others have run into similar needs, and happy to
                answer any questions!
              </p>
            </div>
          </section>
        </section>
        <section id="46693985">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46693985"
              >Ask HN: How do you keep system context from rotting over time?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 16:40:36</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46693985"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
            <div class="text">
              <p>
                I know there are a lot of tools focused on root cause analysis
                after things break. Cool, but that’s not what’s wearing me down.
                What actually hurts is the constant context switching while
                trying to understand how a system fits together, what depends on
                what, and what changed recently.
              </p>
              <p>
                As systems grow, this feels like it gets exponentially harder.
                Add logs and now you’ve created a million new events to reason
                about. Add another database and suddenly you’re dealing with
                subnet constraints or a DB choice that’s expensive as hell, and
                no one noticed until later. Everyone knows their slice, but the
                full picture lives nowhere, so bit rot just keeps creeping in.
              </p>
              <p>
                This feels even worse now that AI agents are pushing large
                amounts of code and config changes quickly. Things move faster,
                but shared understanding falls behind even faster.
              </p>
              <p>
                I’m honestly stuck on how people handle this well in practice.
                For folks dealing with real production systems, what’s actually
                helped? Diagrams, docs, tribal knowledge, tooling, something
                else? Where does it break down?
              </p>
            </div>
          </section>
        </section>
        <section id="46691152">
          <h3>
            <a
              class="item"
              href="https://tynanistyping.offprint.app/a/3mcsvjjceei23-publishing-on-the-atmosphere"
              >Publishing on the ATmosphere</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 12:33:32</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46691152"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46691130">
          <h3>
            <a class="item" href="https://github.com/haron/news.sh"
              >Hackable personal news reader in bash pipes</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 12:30:08</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46691130"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46689895">
          <h3>
            <a
              class="item"
              href="https://openjdk.org/projects/babylon/articles/hat-matmul/hat-matmul"
              >Optimizing GPU Programs from Java Using Babylon and Hat</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 09:41:23</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46689895"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
