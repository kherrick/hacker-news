<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42270966">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/australia-social-media-children-ban-safeguarding-harm-accounts-d0cde2603bdbc7167801da1d00ecd056"
              >Australian Parliament bans social media for under-16s</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 05:01:57</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42270966"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42270935">
          <h3>
            <a
              class="item"
              href="https://news.bloomberglaw.com/us-law-week/us-antitrust-watchdog-launches-broad-microsoft-investigation"
              >US antitrust watchdog launches broad Microsoft investigation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 04:55:23</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42270935"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42270610">
          <h3>
            <a
              class="item"
              href="https://www.energy-storage.news/byd-launches-sodium-ion-grid-scale-bess-product/"
              >BYD launches sodium-ion grid-scale BESS product</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 03:44:59</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42270610"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42270424">
          <h3>
            <a class="item" href="https://lwn.net/Articles/997094/"
              >The trouble with struct sockaddr's fake flexible array</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 03:01:59</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42270424"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42270389">
          <h3>
            <a class="item" href="https://github.com/vinceanalytics/vince"
              >Show HN: Vince – A self hosted alternative to Google Analytics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 02:54:00</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42270389"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <p>
                vince is a single binary, single user with multiple website
                system with zero runtime dependency.
              </p>
              <p>Key featues:</p>
              <p>
                - Automatic TLS - Outbounds link tracking - File downloads
                tracking - 404 pages tracking - Custom event tracking
              </p>
              <p>
                And so much more, basically everything that you see on plausible
                dashboard except funnels and custom properties.
              </p>
              <p>
                You can use vince as a drop in replacement for plausible for
                personal websites.
              </p>
              <p>
                The goal is to make the plausible dashboard easily accessible
                for people who like to self host.
              </p>
              <p>
                All features not related to the dashboard are non goal, hence
                not implemented.
              </p>
              <p>
                Full dashboard demo hosted on 6$ vultr instance
                <a
                  href="https://demo.vinceanalytics.com/share/vinceanalytics.com/v1/share/vinceanalytics.com?auth=Ls9tV4pzqOn7BJ7-&amp;demo=true"
                  >https://demo.vinceanalytics.com/share/vinceanalytics.com/v1/...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42270378">
          <h3>
            <a
              class="item"
              href="https://hez2010.github.io/async-runtimes-benchmarks-2024/"
              >How much memory do you need in 2024 to run 1M concurrent
              tasks?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 02:50:59</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42270378"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42270348">
          <h3>
            <a
              class="item"
              href="https://mrale.ph/blog/2024/11/27/microbenchmarks-are-experiments.html"
              >Microbenchmarks Are Experiments</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 02:45:39</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42270348"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42269897">
          <h3>
            <a class="item" href="https://github.com/tonghohin/screen-sharing"
              >Show HN: Screen Sharing in the Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 01:04:21</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42269897"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>How It Works:</p>
              <p>- One user opens a room and receives a unique code.</p>
              <p>
                - Participants join by simply entering the code to view the
                shared screen.
              </p>
              <p>
                After that initial build, I moved the project to Cursor to
                continue iterating and enhancing its features.
              </p>
              <p>
                Github:
                <a href="https://github.com/tonghohin/screen-sharing"
                  >https://github.com/tonghohin/screen-sharing</a
                >
              </p>
              <p>
                Demo:
                <a href="https://share-your-screen.vercel.app"
                  >https://share-your-screen.vercel.app</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42269691">
          <h3>
            <a
              class="item"
              href="https://www.canada.ca/en/competition-bureau/news/2024/11/competition-bureau-sues-google-for-anti-competitive-conduct-in-online-advertising-in-canada.html"
              >Canada Competition Bureau sues Google for anti-competitive
              conduct in online ads</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 00:26:23</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42269691"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42269227">
          <h3>
            <a
              class="item"
              href="https://news.alvaroduran.com/p/engineers-do-not-get-to-make-startup"
              >Engineers do not get to make startup mistakes when they build
              ledgers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 23:03:47</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42269227"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42268580">
          <h3>
            <a class="item" href="https://ContinueAndPersist.org"
              >Send someone you appreciate an official 'Continue and Persist'
              Letter</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 21:16:55</span
              ><span class="points-container"
                >Points: <span class="points">619</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42268580"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
            <div class="text">
              <p>
                That’s why we created: The Continue and Persist Letter. A
                official-looking legal letter that encourages and uplifts
                people, one that tells people to keep doing what they’re doing!
                Surprise someone you appreciate by sending them a Continue and
                Persist Letter.
              </p>
            </div>
          </section>
        </section>
        <section id="42268461">
          <h3>
            <a
              class="item"
              href="https://adamkarvonen.github.io/machine_learning/2024/06/11/sae-intuitions.html"
              >An Intuitive Explanation of Sparse Autoencoders for LLM
              Interpretability</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 20:54:26</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42268461"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42268310">
          <h3>
            <a
              class="item"
              href="https://neugierig.org/software/blog/2020/05/ninja.html"
              >The success and failure of Ninja (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 20:21:14</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42268310"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42268304">
          <h3>
            <a
              class="item"
              href="https://harpers.org/archive/2024/12/in-the-rockets-red-glare-rachel-kushner/"
              >In the Rockets' Red Glare: The past and future of hot-rodding in
              America</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 20:19:51</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42268304"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42267725">
          <h3>
            <a
              class="item"
              href="https://interactionmagic.com/UX-LEGO-Interfaces/"
              >The UX of Lego Interface Panels (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 19:00:47</span
              ><span class="points-container"
                >Points: <span class="points">308</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42267725"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42265817">
          <h3>
            <a class="item" href="https://pkg.go.dev/modernc.org/tk9.0"
              >Tk9.0: CGo-free, cross platform GUI toolkit for Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 15:18:57</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42265817"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42265533">
          <h3>
            <a
              class="item"
              href="https://121gigawatts.org/copper-sushi-power-flow-european-grid/"
              >A pretty visualisation of the European power grid (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 14:33:44</span
              ><span class="points-container"
                >Points: <span class="points">232</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42265533"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42264427">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42264427"
              >Hetzner cuts traffic on US VPSs, raises prices</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 11:22:44</span
              ><span class="points-container"
                >Points: <span class="points">320</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42264427"
                  >Comments</a
                ><span class="descendants">: 544</span></span
              >
            </h4>
            <div class="text">
              <p>
                We are writing to inform you about important changes to the
                tariff structure of our Cloud servers (CCX and CPX lines) and
                our Load balancers at our US locations in Ashburn and Hillsboro.
              </p>
              <p>What will change?</p>
              <p>
                Starting on 1 December 2024, 01:00 am CET, we will begin
                charging new prices for newly-created Cloud servers and
                introduce new amounts for included traffic for Cloud Servers and
                Load balancers at the US locations in Ashburn (ASH) and
                Hillsboro (HIL). This also applies to existing Cloud servers and
                Load balancers that are switched to a different tariff using the
                “Rescale” function. For any existing Cloud servers and Load
                balancers you have at these locations, the new prices and the
                new amounts for included traffic will apply later, starting on 1
                February 2025, 01:00 am CET. The price for traffic overage will
                remain unchanged in the new price structure.
              </p>
              <p>What are the new prices and amounts of included traffic?</p>
              <p>
                Below, you can see a list of the old and new prices and the
                included traffic.
              </p>
              <p>
                Product Old price New price Old included traffic New included
                traffic
              </p>
              <p>CPX11 € 3.85 € 4.49 20 TB 1 TB</p>
              <p>CPX21 € 7.05 € 8.99 20 TB 2 TB</p>
              <p>CPX31 € 13.10 € 15.99 20 TB 3 TB</p>
              <p>CPX41 € 24.70 € 29.99 20 TB 4 TB</p>
              <p>CPX51 € 54.40 € 59.99 20 TB 5 TB</p>
              <p>CCX13 € 11.99 € 12.99 20 TB 1 TB</p>
              <p>CCX23 € 23.99 € 25.99 20 TB 2 TB</p>
              <p>CCX33 € 47.99 € 49.99 30 TB 3 TB</p>
              <p>CCX43 € 95.99 € 99.99 40 TB 4 TB</p>
              <p>CCX53 € 191.99 € 199.99 50 TB 6 TB</p>
              <p>CCX63 € 287.99 € 299.99 60 TB 8 TB</p>
              <p>LB11 € 5.39 unchanged 20 TB 1 TB</p>
              <p>LB21 € 16.40 unchanged 20 TB 2 TB</p>
              <p>LB31 € 32.90 unchanged 20 TB 3 TB</p>
              <p>
                All monthly prices are excl. VAT and excl. IPv4 addresses. Why
                are we making these changes?
              </p>
              <p>
                With the new tariff structure, we want to make conditions for
                our customers around the world as fair as possible. To do that,
                we will calculate our prices based on local conditions in
                Europe, Singapore, and the USA. Until this change, customers who
                have used fewer resources have covered the costs, in a way, for
                other customers who have used much more resources. We want to
                make things more balanced. The new prices will give our
                customers the best possible price for the resources they use.
              </p>
              <p>...</p>
            </div>
          </section>
        </section>
        <section id="42264345">
          <h3>
            <a
              class="item"
              href="https://www.welivesecurity.com/en/eset-research/bootkitty-analyzing-first-uefi-bootkit-linux/"
              >Bootkitty: Analyzing the first UEFI bootkit for Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 11:02:45</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42264345"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42260027">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/news/articles/cje050wz22qo"
              >London's 850-year-old food markets to close</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 21:36:38</span
              ><span class="points-container"
                >Points: <span class="points">282</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42260027"
                  >Comments</a
                ><span class="descendants">: 235</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42259184">
          <h3>
            <a
              class="item"
              href="https://qwenlm.github.io/blog/qwq-32b-preview/"
              >QwQ: Alibaba's O1-like reasoning LLM</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 20:00:25</span
              ><span class="points-container"
                >Points: <span class="points">340</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42259184"
                  >Comments</a
                ><span class="descendants">: 244</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42249609">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2411.16544"
              >Float Self-Tagging</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-26 @ 20:19:57</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42249609"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42244791">
          <h3>
            <a class="item" href="https://borgo-lang.github.io/"
              >Borgo Programming Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-26 @ 11:33:50</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42244791"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42242392">
          <h3>
            <a
              class="item"
              href="https://www.neh.gov/humanities/2018/winter/feature/the-thinker-who-believed-in-doing-0"
              >William James and the philosophy of pragmatism (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-26 @ 03:44:04</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42242392"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42238603">
          <h3>
            <a
              class="item"
              href="https://onlinelibrary.wiley.com/doi/10.1111/maps.14288"
              >Rapid colonization of a space-returned Ryugu sample by
              terrestrial microorganism</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-25 @ 18:19:02</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42238603"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42236903">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/lifeandstyle/2024/nov/25/new-start-after-60-hummingbird-for-people-with-dementia-volunteering-care-home"
              >A new start after 60: I became a 'hummingbird' for people with
              dementia</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-25 @ 15:10:09</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42236903"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42236103">
          <h3>
            <a
              class="item"
              href="https://www.revolvermag.com/music/author-punisher-how-tool-approved-industrial-metal-mad-scientist-found-hope-amid-doom/"
              >Mechanical Engineer creates instruments for his one man
              industrial metal band</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-25 @ 13:28:14</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42236103"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42234323">
          <h3>
            <a class="item" href="https://github.com/ilevd/cwp"
              >Show HN: Indentation-based syntax for Clojure</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-25 @ 08:29:25</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42234323"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42219809">
          <h3>
            <a class="item" href="http://www.uscrpl.com/aftershock-ii"
              >Aftershock II</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-23 @ 08:26:26</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42219809"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42215520">
          <h3>
            <a
              class="item"
              href="https://www.soniajoseph.ai/multimodal-interpretability-in-2024/"
              >Multimodal Interpretability in 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-22 @ 17:07:01</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42215520"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
