<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38011387">
          <h3>
            <a class="item" href="https://www.sobyte.net/post/2023-07/mptcp-go/"
              >Mptcp: An overlooked new feature in Go 1.21</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 10:47:06</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38011387"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38011085">
          <h3>
            <a
              class="item"
              href="https://jobs.lever.co/photoroom/fc379626-eb33-4eb6-839c-10e5d578e2ed?lever-origin=applied&amp;lever-source%5B%5D=yc"
              >PhotoRoom Is Hiring a Senior Developer in Paris (Cross-Platform,
              Rust, Wgpu)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 09:53:49</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010718">
          <h3>
            <a class="item" href="https://austinkleon.com/2010/01/31/logbook/"
              >On Keeping a Logbook (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 08:53:21</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010718"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010429">
          <h3>
            <a class="item" href="https://huggingface.co/segmind/SSD-1B"
              >50% smaller and 60% faster distilled Stable Diffusion XL</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 08:07:11</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010429"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010407">
          <h3>
            <a class="item" href="https://github.com/ARPSyndicate/puncia"
              >Puncia – Subdomain and Exploit Hunter Powered by AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 08:02:42</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010407"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010391">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/society/2023/oct/24/brisk-minute-walk-offset-harmful-effects-sitting-study"
              >Brisk 22-minute walk could offset harmful effects of sitting,
              study suggests</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 08:00:55</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010391"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010384">
          <h3>
            <a class="item" href="https://next.ossinsight.io/analyze/vercel"
              >Show HN: GitHub Organization Analytics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 07:59:29</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010384"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010267">
          <h3>
            <a class="item" href="https://flawless.dev/"
              >Flawless – Durable execution engine for Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 07:39:11</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010267"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38010244">
          <h3>
            <a
              class="item"
              href="https://www.daemonology.net/blog/2023-10-25-2%5E18-dollars-to-open-source.html"
              >Tarsnap has given 2^18 dollars to open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 07:35:42</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38010244"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38009963">
          <h3>
            <a
              class="item"
              href="https://shkspr.mobi/blog/2021/10/ebcdic-is-incompatible-with-gdpr/"
              >EBCDIC Is Incompatible with GDPR</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 06:51:12</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38009963"
                  >Comments</a
                ><span class="descendants">: 260</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38009458">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/unix/DupSharedOffsetNecessary"
              >Dup()'s shared file IO offset is a necessary part of Unix</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 05:29:25</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38009458"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38009372">
          <h3>
            <a
              class="item"
              href="https://admccartney.mur.at/programming/idkproc/"
              >Not knowing the /proc file system</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 05:13:11</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38009372"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38009175">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Sunflower_(mathematics)"
              >Sunflower (Mathematics)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 04:36:12</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38009175"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38009174">
          <h3>
            <a
              class="item"
              href="https://stefanlesser.substack.com/p/finding-meaning-in-the-nature-of"
              >Finding Meaning in the Nature of Order</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 04:36:05</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38009174"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38009172">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Neskowin_Ghost_Forest"
              >Neskowin Ghost Forest</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 04:35:54</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38009172"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38008461">
          <h3>
            <a class="item" href="https://www.mamedev.org/?p=530">MAME 0.260</a>
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 02:31:12</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38008461"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38007906">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Judas_goat"
              >Judas goat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-25 @ 01:07:56</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38007906"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38006814">
          <h3>
            <a class="item" href="https://restaurants.rip/"
              >Show HN: Restaurants in Peace – leave a remembrance for a closed
              restaurant</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-24 @ 22:54:17</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38006814"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
            <div class="text">
              <p>
                It’s been a project long in the making - it started in 2019,
                before everything shut down/changed. The list of closed
                restaurants I found - for New York only - was already really
                long. So now (that I have time to work on it at recurse.com) it
                really felt like I needed to do something about it.
              </p>
              <p>
                When a restaurant (or any business) shows up on Google Maps as
                “permanently closed”, in that bright red font, there’s always a
                tiny bit of a pang of sadness. It’s definitely more than a pang
                when you look for a place you loved and expected to visit again.
              </p>
              <p>
                The project’s “aesthetic” is inspired by early 2000s funeral
                homes’ websites. The combination of funeral + restaurant is what
                made it click for me. Maybe what we long for is a place to share
                our losses? Maybe.
              </p>
              <p>Thanks for checking it out! :)</p>
              <p>
                [0]
                <a href="https://restaurants.rip/about"
                  >https://restaurants.rip/about</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="38006512">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2023/10/30/the-mysteries-bill-watterson-book-review"
              >Life After “Calvin and Hobbes”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-24 @ 22:24:20</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38006512"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38002752">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/business/autos-transportation/california-suspends-gm-cruises-driverless-autonomous-vehicle-permits-2023-10-24/"
              >California suspends Cruise's autonomous vehicle deployment</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-24 @ 17:55:33</span
              ><span class="points-container"
                >Points: <span class="points">979</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38002752"
                  >Comments</a
                ><span class="descendants">: 1061</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38000723">
          <h3>
            <a
              class="item"
              href="http://blog.khinsen.net/posts/2023/10/09/deconstructing-the-mastodon-client/"
              >Deconstructing the Mastodon Client</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-24 @ 15:41:50</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38000723"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37999527">
          <h3>
            <a
              class="item"
              href="https://colab.research.google.com/drive/1DhaKW0tiSTHDCVmPjM-eoyL47BJ30xmP"
              >Show HN: Dlt – Python library to automate the creation of
              datasets</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-24 @ 14:20:48</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37999527"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              <p>
                We're Anna, Adrian, Marcin and Matt, developers of dlt. dlt is
                an open source library to automatically create datasets out of
                messy, unstructured data sources. You can use the library to
                move data from about anywhere into most of well known SQL and
                vector stores, data lakes, storage buckets, or local engines
                like DuckDB. It automates many cumbersome data engineering tasks
                and can by handled by anyone who knows Python.
              </p>
              <p>
                Here’s our Github:
                <a href="https://github.com/dlt-hub/dlt"
                  >https://github.com/dlt-hub/dlt</a
                >
              </p>
              <p>
                Here’s our Colab demo:
                <a
                  href="https://colab.research.google.com/drive/1DhaKW0tiSTHDCVmPjM-eoyL47BJ30xmP"
                  >https://colab.research.google.com/drive/1DhaKW0tiSTHDCVmPjM-...</a
                >
              </p>
              <p>— — —</p>
              <p>
                In the past we wrote hundreds of Python scripts to fit messy
                data sources into something that you can work with in Python - a
                database, Pandas frame or just a Python list. We were solving
                the same problems and making the similar mistakes again and
                again.
              </p>
              <p>
                This is why we built an easy to use Python library called dlt
                that will automate most data engineering tasks. It hides the
                complexities of data loading and automatically generates a
                structured and clean datasets for immediate querying and
                sharing.
              </p>
              <p>— — —</p>
              <p>
                At its core, dlt removes the need to create the dataset schemas,
                react to changing data, generate append or merge statements, and
                to move the data in transactional and idempotent manner. Those
                things are automated and can be declared right in the Python
                code, just by decorating functions.
              </p>
              <p>
                Add @dlt.resource decorator, give it a few hints, and convert
                any data into a simple pipeline that creates and updates
                datasets.
              </p>
              <p>dlt gets the details out of your way:</p>
              <p>
                1. You do not need to worry about the structure of a database or
                parquet files
              </p>
              <p>
                dlt will create a nice, typed schema out of your data and will
                migrate it when the data changes. You can put some data
                contracts and Pydantic models on top to keep your data clean.
              </p>
              <p>
                2. You do not need to write any INSERT/UPDATE or data copy
                statements
              </p>
              <p>
                dlt will push the data to DuckDB, Weaviate, storage buckets and
                many popular SQL stores. It will align the data types, file
                formats, and identifier names automatically
              </p>
              <p>
                3. You do not need to worry when you need to add new data or
                update the changes.
              </p>
              <p>
                dlt lets you declare how to load the data, how to increment it
                and will keep the loading state together so they are always in
                sync.
              </p>
              <p>4. You keep how you develop and test your code</p>
              <p>
                Iterate and test quickly on your laptop or in a dev container.
                Run locally on DuckDB and just swap destination name to go to
                the cloud - your code, schema and data will stay the same.
              </p>
              <p>5. You can work with data on your laptop.</p>
              <p>
                Combine dlt with other tools and libraries to process data
                locally. duckdb, Pandas, Arrow tables and Rust based loading
                libraries like ConnectorX work nicely with dlt and process data
                blazingly fast, compared to the cloud.
              </p>
              <p>
                6. You do not need to worry if your pipeline will work when you
                deploy it.
              </p>
              <p>
                dlt is a minimalistic Python library, requires no backend and
                works whenever Python works. You can finetune it to work on
                constrained environments like AWS Lambda or run with Airflow,
                GitHub Actions or Dagster.
              </p>
              <p>
                dlt has an Apache 2.0 license. We plan to make money by offering
                organizations a paid control plane, where dlt users can track
                and policy what every pipeline does, manage schemas and
                contracts across organization, create data catalogues, and share
                them with the team members and customers.
              </p>
            </div>
          </section>
        </section>
        <section id="37999035">
          <h3>
            <a class="item" href="https://animatedai.github.io/">Animated AI</a>
          </h3>
          <section>
            <h4>
              <span>2023-10-24 @ 13:39:54</span
              ><span class="points-container"
                >Points: <span class="points">633</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37999035"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37998923">
          <h3>
            <a class="item" href="https://codeforces.com/blog/entry/85638"
              >Voronoi Diagram and Delaunay Triangulation in O(nlog(n))
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-24 @ 13:29:54</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37998923"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37994460">
          <h3>
            <a
              class="item"
              href="https://twitter.com/dvassallo/status/1716585205400756514"
              >A similarity between the CAP theorem and our heart</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-24 @ 03:07:05</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37994460"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37985489">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2023/Oct/23/embeddings/"
              >Embeddings: What they are and why they matter</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-23 @ 13:42:12</span
              ><span class="points-container"
                >Points: <span class="points">391</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37985489"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37979590">
          <h3>
            <a
              class="item"
              href="https://www.honest-broker.com/p/my-lost-gumby-essay"
              >My Lost Gumby Essay</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-22 @ 22:18:56</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37979590"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37975526">
          <h3>
            <a class="item" href="https://www.around.com/bugs/"
              >Chasing bugs in the electronic village (1992)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-22 @ 14:09:47</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37975526"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37975306">
          <h3>
            <a class="item" href="https://icecube.wisc.edu/science/icecube/"
              >IceCube – South Pole Neutrino Observatory</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-22 @ 13:45:51</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37975306"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37974743">
          <h3>
            <a
              class="item"
              href="https://vercel.com/blog/announcing-v0-generative-ui"
              >V0: Generative UI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-22 @ 12:24:51</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37974743"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
