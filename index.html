<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40905719">
          <h3>
            <a class="item" href="https://github.com/victrixsoft/bashbro"
              >Bashbro – Make Any Comp a Web-Based File Server</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 14:24:24</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40905719"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40905706">
          <h3>
            <a
              class="item"
              href="https://www.theglobeandmail.com/canada/alberta/article-for-the-first-time-in-more-than-150-years-albertas-electricity-is-coal/"
              >For the first time in more than 150 years, Alberta's electricity
              is coal free</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 14:23:17</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40905706"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40904862">
          <h3>
            <a class="item" href="https://github.com/onlook-dev/studio"
              >Show HN: Open-sourced Webflow for your own app</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 12:36:10</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40904862"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <p>
                Technical details: This is technically a web browser that can
                point to your localhost, which injects some CSS into the page
                that allows you to select, drag, and drop DOM elements, then
                track and translate those changes back into React code.
                Theoretically, you could do this with any compiled framework but
                I wanted a reasonable scope for the launch (the first version
                was actually in Svelte).
              </p>
              <p>
                Some interesting challenges: 1. There is a React parser that is
                used to parse, insert the style, and serialize it back to code
                2. There is a React pre-processor that traces the DOM elements
                to the corresponding code 3. There's also CSS parsing,
                injection, and converting to Tailwind 4. This is also an
                Electron app so there’s a browser within a browser within a node
                app which makes message passing… interesting
              </p>
              <p>
                What’s next? We’ve already built a proof-of-concept for
                inspecting and selecting layers, dragging to reorder, and
                inserting new DOM elements that I’m working on porting over from
                our private codebase. We’re also exploring opening more tabs in
                new frames in order to A/B test the changes before committing to
                code. There’s a long tail of exciting features we can do but I
                want to put this out there first and see what others would need.
              </p>
              <p>
                Let me know what you think/feedback. It's been a blast working
                on this so far and I think it’s just neat :)
              </p>
            </div>
          </section>
        </section>
        <section id="40904654">
          <h3>
            <a
              class="item"
              href="https://finchwench.wordpress.com/2011/09/06/cosmoquails/"
              >Birds in Space II: Quails in the Cosmos (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 12:09:21</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40904654"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40904587">
          <h3>
            <a class="item" href="https://up.codes/careers?utm_source=HN"
              >UpCodes (YC S17) is hiring remote SWEs, PMs to help make
              buildings cheap</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 12:00:34</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40904407">
          <h3>
            <a
              class="item"
              href="https://prospect.org/economy/2024-06-05-three-algorithms-in-a-room/"
              >Three Algorithms in a Room</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 11:24:05</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40904407"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40903870">
          <h3>
            <a class="item" href="https://github.com/Xpra-org/xpra"
              >Xpra: Persistent Remote Applications for X11</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 09:15:47</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40903870"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40903690">
          <h3>
            <a
              class="item"
              href="https://nonzero.substack.com/p/ode-to-a-world-saving-idea-f4b"
              >Ode to a world-saving idea: attribution error and cognitive
              empathy (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 08:42:03</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40903690"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40902749">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2024/07/08/boeing-to-plead-guilty-to-criminal-fraud-charge-stemming-from-737-max-crashes.html"
              >Boeing to plead guilty to criminal fraud charge stemming from 737
              MAX crashes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 05:06:34</span
              ><span class="points-container"
                >Points: <span class="points">356</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40902749"
                  >Comments</a
                ><span class="descendants">: 355</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40902740">
          <h3>
            <a
              class="item"
              href="https://brooker.co.za/misc-blog/2024/01/23/skis.html"
              >Do Skis Get Blunt?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 05:04:58</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40902740"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40902012">
          <h3>
            <a
              class="item"
              href="https://dgerrells.com/blog/how-fast-is-javascript-simulating-20-000-000-particles"
              >Show HN: Simulating 20M Particles in JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 01:52:54</span
              ><span class="points-container"
                >Points: <span class="points">432</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40902012"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
            <div class="text">
              <p>Skip to the end to play around with the final app.</p>
              <p>
                Open to ideas on how to simulate more whilst staying in js land.
              </p>
            </div>
          </section>
        </section>
        <section id="40901623">
          <h3>
            <a
              class="item"
              href="https://noamzeise.com/2024/07/05/mini-monitor.html"
              >A Mini Monitor for a Pi</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-08 @ 00:27:58</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40901623"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40900029">
          <h3>
            <a class="item" href="https://unit.software/"
              >Unit is a general purpose visual programming system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 19:58:22</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40900029"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899393">
          <h3>
            <a
              class="item"
              href="http://www.righto.com/2024/07/pentium-standard-cells.html"
              >Standard cells: Looking at individual gates in the Pentium
              processor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:19:49</span
              ><span class="points-container"
                >Points: <span class="points">189</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899393"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899371">
          <h3>
            <a class="item" href="https://github.com/virtualsquare/vde-2"
              >VDEv2: Virtual Distributed Ethernet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:16:51</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899371"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899309">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2407.02678"
              >Reasoning in Large Language Models: A Geometric Perspective</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:09:25</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899309"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899281">
          <h3>
            <a class="item" href="https://hbr.org/2005/01/managing-oneself"
              >Managing Oneself (2005)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:04:38</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899281"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899242">
          <h3>
            <a class="item" href="https://satyrn.app/"
              >Show HN: A modern Jupyter client for macOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 17:59:31</span
              ><span class="points-container"
                >Points: <span class="points">531</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899242"
                  >Comments</a
                ><span class="descendants">: 140</span></span
              >
            </h4>
            <div class="text">
              <p>
                It starts up really fast (faster time-to-execution than VS Code
                or JupyterLab), you can launch notebooks right from the Finder,
                and the design is super minimalist. It's got an OpenAI
                integration (use your own API key) for multi-cell generation
                with your notebook as context (I'll add other LLMs soon). And
                many more useful features like a virtual environment management
                UI, Black code formatting, and easy image/table copy buttons.
              </p>
              <p>
                Full disclosure: it's built with Electron. I originally wrote it
                in Swift but couldn't get the editor experience to where I
                wanted it. Now it supports autocomplete, multi-cursor editing,
                and moving the cursor between cells just like you'd expect from
                JupyterLab or VS Code.
              </p>
              <p>
                Satyrn sits on top of the jupyter-server, so it works with all
                your existing python kernels, Jupyter configuration, and ipynb
                files. It only works with local files at the moment, but I'm
                planning to extend it to support remote servers as well.
              </p>
              <p>
                I'm an indie developer, and I will try to monetize at some
                point, but it's free while in alpha. If you're interested,
                please try it out!
              </p>
              <p>
                I'd love your feedback in the comments, or you can contact me at
                jack-at-satyrn-dot-app.
              </p>
            </div>
          </section>
        </section>
        <section id="40898640">
          <h3>
            <a class="item" href="https://github.com/pythops/impala"
              >TUI for Managing WiFi on Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 16:25:31</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40898640"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40898313">
          <h3>
            <a
              class="item"
              href="https://github.com/ElliotKillick/rss2newsletter"
              >Show HN: I made an open source Mailchimp RSS-to-Email
              alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 15:26:07</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40898313"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                The idea for this project came out of necessity, as I wanted to
                share my articles via email newsletter. I was looking for a
                super minimal, lightweight, and open source solution, and when
                none existed, I decided to create one.
              </p>
              <p>
                For any sizable number of email recipients, a popular platform
                like Mailchimp will easily cost you hundreds or even thousands
                per month in per-contact fees. rss2newsletter, on the other
                hand, allows you to use Amazon SES, so you can reach your
                audience at pennies on the dollar.
              </p>
              <p>
                Beyond these factors, I also wanted something that could run on
                an internet-connected potato it's so easy on your system and
                fully automated so you can set it and forget it.
              </p>
              <p>So, I created (and put under a free software license):</p>
              <p>
                <a href="https://github.com/ElliotKillick/rss2newsletter"
                  >https://github.com/ElliotKillick/rss2newsletter</a
                >
              </p>
              <p>
                rss2newsletter (integrating with Listmonk and Amazon SES for
                ultra-low-cost emails) is a drop-in solution that requires
                almost no setup besides connecting with SES and styling your
                emails. It's also competitive at what it does with proprietary
                self-hosted solutions like Sendy, which requires your system/VPS
                to have some rather beefy specs to run well.
              </p>
              <p>
                Let me know if there are any other features you would like to
                see. I hope you can find my project helpful to you!
              </p>
            </div>
          </section>
        </section>
        <section id="40897506">
          <h3>
            <a
              class="item"
              href="https://notes.eatonphil.com/2024-07-07-systems-meetups.html"
              >A reawakening of systems programming meetups</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 13:20:37</span
              ><span class="points-container"
                >Points: <span class="points">335</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40897506"
                  >Comments</a
                ><span class="descendants">: 136</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40896873">
          <h3>
            <a class="item" href="https://github.com/sebastianwessel/quickjs"
              >Show HN: Execute JavaScript in a WebAssembly QuickJS sandbox</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 11:37:25</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40896873"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
            <div class="text">
              <p>Features</p>
              <p>
                - *Security*: Run untrusted JavaScript code in a safe, isolated
                environment.
              </p>
              <p>- *File System*: Can mount a virtual file system</p>
              <p>- *Custom Node Modules*: Custom node modules are mountable</p>
              <p>
                - *Fetch Client*: Can provide a fetch client to make http(s)
                calls
              </p>
              <p>
                - *Test-Runner*: Includes a test runner and chai based `expect`
              </p>
              <p>
                - *Performance*: Benefit from the lightweight and efficient
                QuickJS engine.
              </p>
              <p>
                - *Versatility*: Easily integrate with existing TypeScript
                projects.
              </p>
              <p>
                - *Simplicity*: User-friendly API for executing and managing
                JavaScript code in the sandbox.
              </p>
            </div>
          </section>
        </section>
        <section id="40891372">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/06/28/cold-shipping-might-be-the-next-industry-that-batteries-disrupt/"
              >Cold shipping might be the next industry that batteries
              disrupt</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-06 @ 16:16:47</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40891372"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40884917">
          <h3>
            <a class="item" href="https://dl.acm.org/doi/10.1145/3656404"
              >Refined Input, Degraded Output: The Counterintuitive World of
              Compiler Behavior</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-05 @ 18:25:29</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40884917"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40880551">
          <h3>
            <a
              class="item"
              href="https://www.advancedsciencenews.com/tiny-robots-with-a-big-impact-scientists-develop-microrobots-for-single-cell-handling/"
              >Tiny robots with a big impact: microrobots for single-cell
              handling</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-05 @ 07:38:09</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40880551"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40880302">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/detect-migrating-birds-with-sound"
              >Detect Migrating Birds with a Plastic Dish and a Cheap
              Microphone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-05 @ 06:41:50</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40880302"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40876840">
          <h3>
            <a class="item" href="https://github.com/KwaiVGI/LivePortrait"
              >LivePortrait: A fast, controllable portrait animation model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-04 @ 18:02:50</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40876840"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
            <div class="text">
              <p>
                Related Resources: - Homepage:
                <a href="https://liveportrait.github.io"
                  >https://liveportrait.github.io</a
                >
              </p>
              <p>
                - Paper:
                <a href="https://arxiv.org/abs/2407.03168"
                  >https://arxiv.org/abs/2407.03168</a
                >
              </p>
              <p>
                - Code:
                <a href="https://github.com/KwaiVGI/LivePortrait"
                  >https://github.com/KwaiVGI/LivePortrait</a
                >
              </p>
              <p>
                - Jupyter:
                <a href="https://github.com/camenduru/LivePortrait-jupyter"
                  >https://github.com/camenduru/LivePortrait-jupyter</a
                >
              </p>
              <p>
                - ComfyUI:
                <a href="https://github.com/kijai/ComfyUI-LivePortraitKJ"
                  >https://github.com/kijai/ComfyUI-LivePortraitKJ</a
                >
                and
                <a href="https://github.com/shadowcz007/comfyui-liveportrait"
                  >https://github.com/shadowcz007/comfyui-liveportrait</a
                >
              </p>
              <p>We hope you give it a try and enjoy!</p>
            </div>
          </section>
        </section>
        <section id="40873726">
          <h3>
            <a
              class="item"
              href="https://lu.sagebl.eu/notes/can-i-save-space-with-grayscale-jpegs/"
              >Do grayscale images take less space?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-04 @ 10:10:45</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40873726"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40864085">
          <h3>
            <a
              class="item"
              href="https://mathshistory.st-andrews.ac.uk/Extras/Euler_letters/"
              >Leonhard Euler's Letters to a German Princess</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-03 @ 08:57:23</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40864085"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40862749">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40862749"
              >Ask HN: Programmable Lasers?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-03 @ 04:38:13</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40862749"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text"><p>Anyone can shed some light on this?</p></div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
