<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42392088">
          <h3>
            <a class="item" href="https://start.boldvoice.com/accent-guesser"
              >AI Guesses Your Accent</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 19:54:20</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42392088"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42391486">
          <h3>
            <a
              class="item"
              href="https://chromewebstore.google.com/detail/linkedin-to-resume-by-cvg/bhdcmampnnhholkenaahdeaddmodmeem"
              >Show HN: Convert your LinkedIn profile to a resume</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 19:06:15</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42391486"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42391203">
          <h3>
            <a
              class="item"
              href="https://docs.fcc.gov/public/attachments/DOC-408083A1.txt"
              >Voice providers face removal for failing robocall mitigation
              requirements</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 18:41:57</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42391203"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42390768">
          <h3>
            <a class="item" href="https://x41-dsec.de/news/2024/12/11/mullvad/"
              >X41 Reviewed Mullvad VPN</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 18:08:13</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42390768"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42390761">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42390761"
              >Launch HN: Azalea Robotics (YC S24) – Baggage-handling robots for
              airports</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 18:07:11</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42390761"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.azalearobotics.com"
                >https://www.azalearobotics.com</a
              >). We build robots to handle passenger baggage in airports. Here
              are some videos to give you the idea:
              <p>
                Unedited autonomous ops:
                <a href="https://www.youtube.com/watch?v=DuJ3ZORnO1o"
                  >https://www.youtube.com/watch?v=DuJ3ZORnO1o</a
                >
              </p>
              <p>
                Teleoperated (sped up, so no sound):
                <a href="https://www.youtube.com/watch?v=LeK8NQLnYgA"
                  >https://www.youtube.com/watch?v=LeK8NQLnYgA</a
                >
              </p>
              <p>
                The marketing version:
                <a href="https://www.youtube.com/watch?v=k0SDPm09U6s"
                  >https://www.youtube.com/watch?v=k0SDPm09U6s</a
                >
              </p>
              <p>
                Robotics is in an interesting place right now, with many
                warehouse automation companies humming along for almost a
                decade, and a lot of new effort going to full general purpose
                hardware with humanoids and software via generalist robotics
                foundation models. We love these efforts (David used to work on
                one at Google X with Everyday Robots), but we also see a lot of
                utility in the current wave of robotics planning and perception
                tech that can enable new use cases today.
              </p>
              <p>
                Airlines in the US compete primarily on efficiency and customer
                loyalty, and baggage handling hits both (John B. has first-hand
                experience from working on baggage optimization projects at
                United Airlines). 2% of flights are delayed by baggage errors,
                leading to downstream network delays. Baggage handling is also a
                major complaint in customer experience—almost everyone has a
                horror story of a missing bag, and sometimes people vow never to
                fly an airline again for losing their belongings. Furthermore,
                it’s a really dangerous job for employees from a repetitive
                stress standpoint. EU regulation is coming to reflect this,
                protecting workers with a maximum number of bags transferred per
                shift to alleviate back and tendon injuries that are inherent to
                this job.
              </p>
              <p>
                Unfortunately for airlines, passengers don’t package their
                luggage in nicely uniform cardboard boxes. If they did, then the
                airlines could benefit directly from the recent takeoff in
                manipulator tech for warehouses. But airline luggage is way more
                wacky and irregular. If robots are going to handle it, they need
                to reason about how to grasp each item, handle its
                deformability, stack it in a stable way, and do all of this
                quickly, safely, and reliably.
              </p>
              <p>
                This is what we’re tackling at Azalea. We’re bringing our
                expertise in deformable object manipulation, perception, robot
                learning, and planning, to this logistical problem.
              </p>
              <p>
                We have a few strong bets behind what we’re working on: (1) The
                hardware to solve this problem has been available or
                manufacturable for decades, what’s been missing is perception,
                planning, and control. (2) Cobots, robots designed to operate
                alongside humans, aren’t enough for safety. To do this task
                efficiently, you need to move up to 50 kg bags very quickly,
                which can be dangerous no matter how well the cobots are
                designed. Light curtains (arrays of lasers that stop a machine
                when interrupted) and machine cages are the current industrial
                standard and remain the way to go. (3) Software for generalist
                robots needs more data than most people today believe, and it
                will be at least 15 years before deployment: we should focus on
                specialized problems of economic value.
              </p>
              <p>Our core technical developments are in a few areas:</p>
              <p>
                - Grasp synthesis and selection: From visual data only, how can
                we identify good candidate grasp points and rank them? For this,
                we use a mix of physical reasoning, heuristics, and a lot of
                learning from previous data, combined in a single objective
                function. Furthermore, success must be evaluated as both a
                successful grasp and continual hold throughout the transfer.
              </p>
              <p>
                - Placement planning: How do we lay out luggage in the module
                we’re loading? There’s a nice ramp-up in difficulty for this
                problem, from open-loop “divide the world into a grid”
                approaches, to 3d bin-packing optimization, to reinforcement
                learning. An interesting aspect of this problem for us is that
                the bags should be physically stable when the cart starts
                driving, and lighter, deformable objects shouldn’t be underneath
                heavy, hard objects. We use a similar mix of physics and
                learning to model this problem.
              </p>
              <p>
                - Fast collision-free planning: Off the shelf planners work
                great for the most part but can fail in heavily cluttered areas
                or dynamic scenes. We leverage the fact that we’re always
                solving a series of similar problems to provide initial guesses
                for downstream trajectory optimization algorithms. Since each
                problem is so similar, we can use techniques similar to
                generative models to propose these initial plans.
              </p>
              <p>
                - Mechanical design: The perfect tool to pick up everything
                checked down a conveyor belt isn’t an easy thing to design.
                We’re building tools with multiple modes of grasping to handle
                wide varieties of objects. The videos we linked to are all with
                suction only – which can be surprisingly powerful! An
                interesting aspect of autonomy becomes choosing which mode to
                use when, and how to use it.
              </p>
              <p>
                These problems can be deeply interlinked: where you grasp an
                object depends on what your tooling looks like and informs where
                you can put it– so a perfect solution would jointly reason about
                both problems simultaneously. We’re looking forward to getting
                there as we collect more data and continue our efforts.
              </p>
              <p>
                Check out our demo videos above! We have a brand new hardware
                stack coming soon (and we’ve added a new end effector that we’re
                keeping hush), but it’s amazing what you can do with pure
                suction.
              </p>
              <p>
                We’re proud of our progress so far but would love to hear your
                thoughts and feedback. Let us know if you’ve had a particularly
                bad baggage horror story and/or have personal experience with
                the industry.
              </p>
            </div>
          </section>
        </section>
        <section id="42390650">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cd605e48q1vo"
              >Chatbot 'encouraged teen to kill parents over screen time
              limit'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 17:58:09</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42390650"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42390344">
          <h3>
            <a
              class="item"
              href="https://docs.fcc.gov/public/attachments/DOC-408129A1.txt"
              >FCC opens entire 6 GHz band to low power device operations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 17:35:04</span
              ><span class="points-container"
                >Points: <span class="points">206</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42390344"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42390236">
          <h3>
            <a
              class="item"
              href="https://water.usgs.gov/nawqa/pnsp/features/feature.php"
              >Estimated concentrations of atrazine in agricultural
              groundwater</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 17:25:25</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42390236"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42389895">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/charge-robotics/jobs/ml4f9l4-senior-mechanical-engineer"
              >Charge Robotics (YC S21) is hiring MechEs to build robots that
              build solar farms</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 17:00:41</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42389532">
          <h3>
            <a
              class="item"
              href="https://www.sifive.com/blog/hifive-premier-p550-development-boards-with-ubuntu"
              >RISC-V HiFive Premier P550 Development Boards with Ubuntu Now
              Available</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 16:33:56</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42389532"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42388973">
          <h3>
            <a class="item" href="https://pgroll.com/"
              >Pgroll – Zero-downtime, reversible, schema changes for PostgreSQL
              (new website)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 15:51:22</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42388973"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42388901">
          <h3>
            <a
              class="item"
              href="https://cloud.google.com/blog/products/compute/trillium-tpu-is-ga"
              >Trillium TPU Is GA</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 15:44:58</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42388901"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42388870">
          <h3>
            <a
              class="item"
              href="https://pilcrowonpaper.com/blog/dear-oauth-providers/"
              >Dear OAuth Providers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 15:42:20</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42388870"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42388783">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/google-deepmind/google-gemini-ai-update-december-2024/"
              >Gemini 2.0: our new AI model for the agentic era</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 15:33:54</span
              ><span class="points-container"
                >Points: <span class="points">479</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42388783"
                  >Comments</a
                ><span class="descendants">: 250</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42388665">
          <h3>
            <a class="item" href="https://dioxuslabs.com/blog/release-060/"
              >Dioxus 0.6 – Crossplatform apps with Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 15:24:10</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42388665"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42388488">
          <h3>
            <a class="item" href="https://joinpeertube.org/news/peertube-app"
              >PeerTube mobile app: discover videos while caring for your
              attention</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 15:09:56</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42388488"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://play.google.com/store/apps/details?id=org.framasoft.peertube"
                >https://play.google.com/store/apps/details?id=org.framasoft....</a
              >
              <p>
                iOS:
                <a href="https://apps.apple.com/fr/app/peertube/id6737834858"
                  >https://apps.apple.com/fr/app/peertube/id6737834858</a
                >
              </p>
              <p>
                Repo:
                <a
                  href="https://framagit.org/framasoft/peertube/mobile-application"
                  >https://framagit.org/framasoft/peertube/mobile-application</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42388340">
          <h3>
            <a
              class="item"
              href="https://andyatkinson.com/django-python-postgres-busy-rails-developer"
              >Django and Postgres for the Busy Rails Developer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 14:56:29</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42388340"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42388009">
          <h3>
            <a
              class="item"
              href="https://cowfreedom.de/#dot_product/introduction/"
              >The GPU is not always faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 14:28:42</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42388009"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42387013">
          <h3>
            <a
              class="item"
              href="https://developers.redhat.com/articles/2024/12/11/making-memcpynull-null-0-well-defined"
              >Making memcpy(NULL, NULL, 0) well-defined</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 12:19:12</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42387013"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42386971">
          <h3>
            <a class="item" href="https://github.com/mherrmann/helium"
              >Helium: Lighter Web Automation with Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 12:11:28</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42386971"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42384921">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/12/10/business/media/the-onion-infowars-alex-jones.html"
              >Bankruptcy judge rejects sale of Infowars to The Onion</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 04:53:54</span
              ><span class="points-container"
                >Points: <span class="points">449</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42384921"
                  >Comments</a
                ><span class="descendants">: 696</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42384768">
          <h3>
            <a
              class="item"
              href="https://gilkalai.wordpress.com/2024/12/09/the-case-against-googles-claims-of-quantum-supremacy-a-very-short-introduction/"
              >The case against Google's claims of "quantum supremacy"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-11 @ 04:22:10</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42384768"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42382829">
          <h3>
            <a
              class="item"
              href="https://www.courtlistener.com/docket/69221176/64/wpengine-inc-v-automattic-inc/"
              >WPEngine, Inc. vs. Automattic– Order on Motion for Preliminary
              Injunction</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-10 @ 23:20:34</span
              ><span class="points-container"
                >Points: <span class="points">287</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42382829"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42366753">
          <h3>
            <a
              class="item"
              href="https://restofworld.org/2024/how-whatsapp-for-business-changed-the-world/"
              >How WhatsApp for business changed the world</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-09 @ 14:57:01</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42366753"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42357377">
          <h3>
            <a
              class="item"
              href="https://www.sapiens.org/culture/smartphones-cyborgs-phantom-limb/"
              >Phantom Vibrations of a Lost Smartphone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-08 @ 14:39:28</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42357377"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42357272">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2024/12/03/bi-elliptic-transfer/"
              >Bi-elliptic transfer orbit maneuver</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-08 @ 14:16:38</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42357272"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42356016">
          <h3>
            <a
              class="item"
              href="https://opensource.com/article/22/10/rexx-scripting-language"
              >Consider Rexx for Scripting (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-08 @ 09:15:32</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42356016"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42348716">
          <h3>
            <a class="item" href="https://github.com/Fajar-RahmadJaya/KeyTik"
              >Show HN: KeyTik: The All-in-One Automation Tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-07 @ 10:19:50</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42348716"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42348655">
          <h3>
            <a class="item" href="https://odinbook.com/"
              >Understanding the Odin Programming Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-07 @ 10:08:34</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42348655"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42341337">
          <h3>
            <a class="item" href="https://github.com/OpenLoco/OpenLoco"
              >OpenLoco: An open source re-implementation of Chris Sawyer's
              Locomotion</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 16:40:35</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42341337"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
