<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39141682">
          <h3>
            <a
              class="item"
              href="https://app.dover.io/Optery/careers/41840615-ceb2-4629-93a5-42d49fa8987d"
              >Optery (YC W22) is hiring a full-stack dev with Node experience
              (Latin America)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 12:00:07</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39141413">
          <h3>
            <a
              class="item"
              href="http://grognardia.blogspot.com/2024/01/fifty-years-ago-today.html"
              >Dungeons and Dragons turns 50 today</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 11:24:35</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39141413"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39141011">
          <h3>
            <a
              class="item"
              href="https://www.schneier.com/essays/archives/2024/01/dont-talk-to-people-like-theyre-chatbots.html"
              >Don't Talk to People Like They're Chatbots</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 10:28:34</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39141011"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39140849">
          <h3>
            <a class="item" href="https://jacobfilipp.com/arvid-vhs/"
              >ArVid: Russians squeezed 4 hard drives into one VHS tape in the
              90s</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 10:10:57</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39140849"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39140843">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/travel/article/20240125-mottainai-in-japan-creativity-is-key-to-a-no-waste-ideal"
              >The Japanese philosophy for a no-waste world</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 10:10:17</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39140843"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39140390">
          <h3>
            <a class="item" href="https://www.bbc.co.uk/news/business-68079300"
              >Post Office plan to sack Horizon IT reviewer kept secret,
              documents reveal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 09:13:14</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39140390"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39139999">
          <h3>
            <a
              class="item"
              href="https://river.com/learn/terms/c/cantillon-effect/"
              >Cantillon Effect</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 08:11:59</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39139999"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39139540">
          <h3>
            <a
              class="item"
              href="https://cps.ca/en/documents/position/outdoor-risky-play"
              >Balancing Outdoor Risky Play and Injury Prevention in Childhood
              Development</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 06:39:28</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39139540"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39138755">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/959069/c96f34ed67a168e4/"
              >The things nobody wants to pay for</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 03:51:01</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39138755"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39138128">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/feeding-gods-hundreds-skulls-reveal-massive-scale-human-sacrifice-aztec-capital"
              >Skulls reveal scale of human sacrifice in Aztec capital</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 02:05:31</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39138128"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39138042">
          <h3>
            <a
              class="item"
              href="https://willcrichton.net/notes/portable-epubs/#epub-content%2FEPUB%2Findex.xhtml$"
              >Portable EPUBs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 01:53:11</span
              ><span class="points-container"
                >Points: <span class="points">313</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39138042"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39137755">
          <h3>
            <a class="item" href="https://www.peterkrautzberger.org/0136/"
              >I don't always use LaTeX, but when I do, I compile to HTML
              (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 01:13:21</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39137755"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39137502">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/AMD-XDNA-Linux-Driver-Ryzen-AI"
              >AMD Publishes XDNA Linux Driver: Support for Ryzen AI on Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-26 @ 00:38:11</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39137502"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39136472">
          <h3>
            <a
              class="item"
              href="https://adamdrake.com/command-line-tools-can-be-235x-faster-than-your-hadoop-cluster.html"
              >Command-line Tools can be 235x Faster than your Hadoop Cluster
              (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 22:44:41</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39136472"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39136238">
          <h3>
            <a class="item" href="https://github.com/NativeVision/viro"
              >Show HN: NativeVision, helping React Native devs to build XR apps
              for any device</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 22:24:40</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39136238"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              <p>
                We've discovered an open source library named Viro that hadn't
                been updated in over two years. We've revitalized the library,
                enabling the creation of XR apps on the latest iOS and Android
                platforms. Our goal is to transform NativeVision into a
                versatile library that can be used across various XR devices,
                including Apple Vision Pro and Meta Quest.
              </p>
              <p>
                Our aim is to make it easy for React developers to start working
                on XR projects using React Native or Expo, much like how they
                would for iOS or Android apps.
              </p>
              <p>If you have any feedback please share as it helps a lot!</p>
            </div>
          </section>
        </section>
        <section id="39136123">
          <h3>
            <a class="item" href="https://qwertle.friedman.in"
              >Show HN: Qwertle, yet another daily word game</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 22:14:34</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39136123"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
            <div class="text">
              A new Wordle-like game, where guesses are ranked by how close
              letters are on a QWERTY keyboard. Try it out and let me know what
              you think!
            </div>
          </section>
        </section>
        <section id="39135779">
          <h3>
            <a class="item" href="https://www.improbableisland.com"
              >Improbable Island, one of the largest and longest-running online
              text adventures</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 21:42:35</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39135779"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39135192">
          <h3>
            <a
              class="item"
              href="https://www.agileconnection.com/article/two-sides-software-testing-checking-and-exploring"
              >Two sides of software testing: Checking and exploring (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 20:59:04</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39135192"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39134349">
          <h3>
            <a
              class="item"
              href="https://www.nasa.gov/news-release/after-three-years-on-mars-nasas-ingenuity-helicopter-mission-ends/"
              >Due to blade damage, Mars Helicopter Ingenuity will not fly
              again</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 19:58:09</span
              ><span class="points-container"
                >Points: <span class="points">463</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39134349"
                  >Comments</a
                ><span class="descendants">: 184</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39132766">
          <h3>
            <a class="item" href="https://github.com/andrewnguonly/Lumos"
              >Show HN: Lumos, a local LLM Chrome extension</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 18:24:40</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39132766"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <p>
                - Summarize long threads on issue tracking sites, forums, and
                social media sites
              </p>
              <p>- Summarize news articles</p>
              <p>- Ask questions about reviews on business and product pages</p>
              <p>- Ask questions about long, technical documentation</p>
              <p>- What else?</p>
            </div>
          </section>
        </section>
        <section id="39132453">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2024/01/apple-announces-changes-to-ios-safari-and-the-app-store-in-the-european-union/"
              >Apple announces changes to iOS, Safari, and the App Store in the
              European Union</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 18:03:26</span
              ><span class="points-container"
                >Points: <span class="points">1802</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39132453"
                  >Comments</a
                ><span class="descendants">: 2120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39131010">
          <h3>
            <a
              class="item"
              href="https://www.windytan.com/2024/01/smoother-sailing-steamboat-willie-flutter.html"
              >Smoother sailing: Studying audio imperfections in Steamboat
              Willie</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 16:05:36</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39131010"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39130684">
          <h3>
            <a
              class="item"
              href="https://www.esa.int/Science_Exploration/Space_Science/Capturing_the_ripples_of_spacetime_LISA_gets_go-ahead"
              >Capturing the ripples of spacetime: LISA gets go-ahead</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 15:40:38</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39130684"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39129680">
          <h3>
            <a
              class="item"
              href="https://www.rorvswild.com/blog/2024/ruby-on-rails-load-testing-habits"
              >Ruby on Rails load testing habits</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 14:07:24</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39129680"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39128902">
          <h3>
            <a
              class="item"
              href="https://twitter.com/graycrawford/status/1750225562281632048"
              >I realized chess pieces can be redesigned to be geometric attack
              directions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-25 @ 12:36:24</span
              ><span class="points-container"
                >Points: <span class="points">665</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39128902"
                  >Comments</a
                ><span class="descendants">: 223</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39124018">
          <h3>
            <a
              class="item"
              href="https://www.usenix.org/system/files/conference/woot15/woot15-paper-burgess.pdf"
              >Replication Prohibited: Attacking Restricted Keyways with 3D
              Printing [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 23:22:23</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39124018"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39121392">
          <h3>
            <a class="item" href="https://babashka.org/"
              >Babashka: Fast native Clojure scripting runtime</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 19:09:51</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39121392"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39120687">
          <h3>
            <a
              class="item"
              href="https://inference-review.com/article/the-man-who-carried-computer-science-on-his-shoulders"
              >Edsger Dijkstra carried computer science on his shoulders
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 18:14:17</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39120687"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39119835">
          <h3>
            <a class="item" href="https://zed.dev/blog/zed-is-now-open-source"
              >Zed, a collaborative code editor, is now open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 17:15:19</span
              ><span class="points-container"
                >Points: <span class="points">1456</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39119835"
                  >Comments</a
                ><span class="descendants">: 540</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39119198">
          <h3>
            <a
              class="item"
              href="https://softwaredoug.com/blog/2024/01/24/are-we-at-peak-vector-db"
              >Are we at peak vector database?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 16:23:52</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39119198"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
