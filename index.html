<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41172961">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/20240730-00/?p=110062"
              >Who Wrote the Blue Screens of Death</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 17:19:03</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41172961"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41172938">
          <h3>
            <a
              class="item"
              href="https://www.studiobinder.com/blog/what-is-rotoscope-animation-definition/"
              >What Is Rotoscope Animation? The Process Explained (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 17:16:21</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41172938"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41172923">
          <h3>
            <a
              class="item"
              href="https://www.axios.com/2024/07/31/din-tai-fung-soup-dumplings"
              >Soup Dumpling Index: How prices compare around the world</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 17:15:31</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41172923"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41172899">
          <h3>
            <a class="item" href="https://coe.psu.ac.th/ad/nashSim/"
              >Finding Nash equilibria through simulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 17:13:46</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41172899"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41172751">
          <h3>
            <a class="item" href="https://www.workatastartup.com/jobs/65936"
              >Danswer (YC W24) Is Hiring Founding Full Stack Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 17:00:15</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41172509">
          <h3>
            <a class="item" href="https://github.com/dagmawibabi/ScholArxiv"
              >ScholArxiv – an open-source aesthetic and minimal research paper
              explorer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 16:37:48</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41172509"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41172036">
          <h3>
            <a class="item" href="https://fleak.ai/"
              >Show HN: I built a serverless data API builder – no storage, low
              latency</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 15:49:07</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41172036"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm Bo, cofounder of Fleak.ai. Over the past several months, our
                team has been hard at work developing Fleak, a data API backend
                builder, and we would love your feedback on what we've built so
                far.
              </p>
              <p>
                What Fleak Does: Fleak simplifies the process of building and
                deploying API backends. It features a no-code IDE UI that lets
                you create workflows by chaining together steps such as native
                SQL transformations, calling LLM models, AWS Lambda functions,
                and more. With a single click, you can deploy these workflows to
                a production endpoint (during test, we are able to handle 5000
                QPS without LLM node).
              </p>
              <p>Key Features:</p>
              <p>
                Native SQL Transformation: Work with SQL directly, without the
                need for a storage layer. Simplified Setup: No more cluster
                configuration and script juggling. Efficient Deployment:
                Streamlines the deployment cycle and reduces the need for
                constant monitoring. The inspiration for Fleak came from my
                frustration with maintaining production data pipelines,
                especially with the added complexity brought by LLMs. Fleak aims
                to simplify life for data practitioners.
              </p>
              <p>
                Known restrictions: 1. not all SQL syntax is supported, we are
                adding daily 2. free version has rate limit due to cost 3. LLM
                node latency is not optimized due to cost, but our base rate
                limit is higher than out of box models and can be elastic.
              </p>
              <p>
                Our codebase is meticulously maintained, though it's not open
                source yet as we're still considering which parts to release.
                You can check out Fleak at www.fleak.ai. We are hosting a small
                product feedback lunch on Stanford campus this thursday 8/8
                1:30pm-2:30pm. Come join us!
                <a href="https://lu.ma/0beq21pd">https://lu.ma/0beq21pd</a>
              </p>
              <p>We'd love to hear your thoughts:</p>
              <p>
                Does this sound useful to you? What features would you like to
                see? Any advice on open-sourcing? Thanks!
              </p>
            </div>
          </section>
        </section>
        <section id="41171060">
          <h3>
            <a
              class="item"
              href="https://blog.google/products/google-nest/chromecast-history/"
              >We’re ending production of Chromecast</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 14:15:41</span
              ><span class="points-container"
                >Points: <span class="points">473</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41171060"
                  >Comments</a
                ><span class="descendants">: 454</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41170925">
          <h3>
            <a class="item" href="https://github.com/d3witt/viking"
              >Show HN: I built a simple, open-source tool to manage servers and
              SSH keys</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 13:58:24</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41170925"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41170454">
          <h3>
            <a
              class="item"
              href="https://azeemba.com/posts/understanding-3d-graphics.html"
              >Understanding 3D Graphics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 12:59:51</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41170454"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41169611">
          <h3>
            <a
              class="item"
              href="https://www.engineersneedart.com/stereographer/stereographer.html"
              >Stereographer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 10:56:30</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41169611"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41169244">
          <h3>
            <a
              class="item"
              href="https://text.marvinborner.de/2024-04-16-10.html"
              >Crafting formulas: Lambdas all the way down</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 09:54:31</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41169244"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41168971">
          <h3>
            <a class="item" href="https://github.com/useplunk/plunk"
              >Plunk: The open source email platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 08:54:58</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41168971"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41167615">
          <h3>
            <a
              class="item"
              href="https://books.worksinprogress.co/book/maintenance-of-everything/communities-of-practice/the-soul-of-maintaining-a-new-machine/1"
              >The Soul of Maintaining a New Machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 03:49:20</span
              ><span class="points-container"
                >Points: <span class="points">214</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41167615"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41167116">
          <h3>
            <a class="item" href="https://slingcode.net/"
              >Slingcode – App platform in a single HTML file, QR-code
              transmittable apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 01:31:49</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41167116"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41167060">
          <h3>
            <a
              class="item"
              href="https://www.philipotoole.com/building-rqlite-9-0-cutting-disk-usage-by-half/"
              >Building rqlite 9.0: Cutting disk usage by half</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 01:20:22</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41167060"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41166774">
          <h3>
            <a class="item" href="https://www.henrikkarlsson.xyz/p/unfolding"
              >Everything that turned out well in my life followed the same
              design process</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 00:14:41</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41166774"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41166036">
          <h3>
            <a
              class="item"
              href="https://blog.zsa.io/diy-voyager-trackpad-saucer/"
              >The Saucer – A DIY trackpad attachment for the Voyager</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-05 @ 22:02:24</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41166036"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41164993">
          <h3>
            <a class="item" href="https://github.com/datoviz/datoviz"
              >Show HN: Datoviz – Vulkan-based GPU scientific visualization
              (C/C++/Python)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-05 @ 20:03:38</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41164993"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                Datoviz is a key part of the CZI-funded Vispy 2.0 project and
                will serve as its main GPU backend. Datoviz provides core GPU
                visualization capabilities while VisPy 2.0 will provide
                high-level plotting functionality (a bit similar to NumPy vs
                SciPy).
              </p>
              <p>What I'm looking for from the community:</p>
              <p>
                1. Compatibility feedback: I'd appreciate quick feedback on how
                these precompiled Python wheels perform across different
                operating systems and graphics hardware.
              </p>
              <p>
                2. Library feedback: Datoviz is still in its early stages and
                actively evolving. The API is subject to change, and I'd
                appreciate any feedback on its functionality and design.
              </p>
              <p>Please report issues on GitHub.</p>
              <p>
                Since the initial 2021 v0.1 release, the underlying technology
                has matured significantly. The internal architecture is now more
                robust and modular, paving the way for support for other
                rendering technologies like WebGPU and WebAssembly in the medium
                term.
              </p>
              <p>
                While still somewhat limited, the focus is on ensuring
                stability, performance, and visual quality. Available visuals
                include points, markers, line segments, paths, glyphs, images,
                spheres, 3D meshes, and basic volume rendering. Some important
                features, like axes and picking, are planned for v0.3 and later.
              </p>
              <p>
                Please give it a try, report any issues on GitHub, and feel free
                to ask questions. You're also welcome to contribute. I'm looking
                forward to your feedback!
              </p>
            </div>
          </section>
        </section>
        <section id="41164885">
          <h3>
            <a
              class="item"
              href="https://sunshowers.io/posts/rustc-segfault-illumos/"
              >Debugging a rustc segfault on Illumos</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-05 @ 19:54:45</span
              ><span class="points-container"
                >Points: <span class="points">217</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41164885"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41164833">
          <h3>
            <a
              class="item"
              href="https://blog.yossarian.net/2020/08/16/Hiding-messages-in-x86-binaries-using-semantic-duals"
              >Hiding messages in x86 binaries using semantic duals (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-05 @ 19:50:02</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41164833"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41161831">
          <h3>
            <a class="item" href="https://myhsu.xyz/llvm-sched-model-1/"
              >Scheduling Model in LLVM</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-05 @ 14:43:40</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41161831"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41161674">
          <h3>
            <a class="item" href="https://flakm.com/posts/phantom_leak/"
              >Phantom Menance: memory leak that wasn't there</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-05 @ 14:28:01</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41161674"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41154650">
          <h3>
            <a class="item" href="https://www.w3.org/2014/strint/papers/65.pdf"
              >The Internet Is Broken: Idealistic Ideas for Building a GNU
              Network [pdf] (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 16:39:30</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41154650"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41147651">
          <h3>
            <a class="item" href="https://creduse.com"
              >Show HN: I made a credit system API</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 16:44:26</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41147651"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built Creduse because more and more users want pay-as-you-go
                models, and founders need new ways to increase user engagement
                or nicely limit cost-intensive features (see AI).
              </p>
              <p>
                Creduse is built by a developer for developers. I hope it will
                help as many startups as possible.
              </p>
              <p>Feedback are very much appreciated.</p>
              <p>Francesco</p>
            </div>
          </section>
        </section>
        <section id="41142767">
          <h3>
            <a
              class="item"
              href="https://scitechdaily.com/revolutionary-submarine-discovers-ice-shelf-mysteries-then-disappears-without-a-trace/"
              >Unmanned submarine discovers ice shelf mysteries, then
              disappears</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-02 @ 21:16:58</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41142767"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41138388">
          <h3>
            <a class="item" href="https://github.com/pladams9/hexsheets"
              >Hexsheets: Hexagonal Spreadsheets</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-02 @ 12:43:20</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41138388"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41137266">
          <h3>
            <a class="item" href="https://mirror-cube.martinpiala.com/"
              >Show HN: Three.js mirror cube that stays in sync</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-02 @ 09:19:02</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41137266"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                Mirror Cube is a Three.js based 3D model of a Rubiks cube
                variant. It keeps unscrambling itself doing random moves, but
                the moves are (ehm.. should be) synced across all devices.
              </p>
              <p>
                I built this over one week and I thought you might find it
                interesting.
              </p>
              <p>Let me know what you think and if you find any bugs!</p>
              <p>Martin</p>
            </div>
          </section>
        </section>
        <section id="41134606">
          <h3>
            <a
              class="item"
              href="https://www.popularmechanics.com/science/a32131826/ancient-multiplication-method/"
              >Japanese multiplication method and other ways to multiply
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-01 @ 23:10:25</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41134606"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41129081">
          <h3>
            <a
              class="item"
              href="https://djharper.dev/post/2019/05/21/i-dont-know-how-cpus-work-so-i-simulated-one-in-code/"
              >I don't know how CPUs work so I simulated one in code (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-01 @ 13:54:00</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41129081"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
