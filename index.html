<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36783348">
          <h3>
            <a
              class="item"
              href="https://twitter.com/fosdembsd/status/1681574924282998784"
              >Nvidia just released FreeBSD Display Driver 535.86.05
              (2023.7.18)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 08:07:02</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36783348"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36783019">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/resources/models-and-libraries/llama-downloads/"
              >Llama 2 is not open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 07:12:55</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36783019"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36782935">
          <h3>
            <a
              class="item"
              href="https://bitmovin.com/careers/senior-software-engineer-java-6834404002/"
              >Bitmovin (YC S15) Is Hiring a Senior Software Engineer (Java) in
              Austria</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 07:00:09</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36782918">
          <h3>
            <a
              class="item"
              href="https://www.windowscentral.com/microsoft/microsoft-faces-antitrust-scrutiny-from-the-european-union"
              >Microsoft faces antitrust scrutiny from the EU over Teams, Office
              365</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 06:56:25</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36782918"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36782884">
          <h3>
            <a
              class="item"
              href="https://maciej.codes/2022-06-09-local-async.html"
              >Local Async Executors and Why They Should be the Default
              (Rust)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 06:50:52</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36782884"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36782761">
          <h3>
            <a
              class="item"
              href="https://web.archive.org/web/20070916144913/https://wp.netscape.com/newsref/pr/newsrelease67.html"
              >Netscape and Sun announce JavaScript (1995)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 06:27:06</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36782761"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36782314">
          <h3>
            <a
              class="item"
              href="https://fablestudio.github.io/showrunner-agents/"
              >AI-Generated South Park</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 05:07:56</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36782314"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36782018">
          <h3>
            <a class="item" href="https://github.com/jesseduffield/lazygit"
              >Lazygit: Simple terminal UI for Git commands</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 04:07:08</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36782018"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36781860">
          <h3>
            <a
              class="item"
              href="https://www.businessinsider.com/meta-tells-managers-its-harder-to-get-promotions-2023-7"
              >Meta Tells Managers Promotions Will Be Few and Far Between</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 03:39:28</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36781860"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36781594">
          <h3>
            <a
              class="item"
              href="http://bitsavers.trailing-edge.com/pdf/ibm/360/pls/GC28-0786-0_Guide_to_PL_S_Generated_Listings_Jul72.pdf"
              >IBM PL/S Machine-oriented programming language [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 02:56:06</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36781594"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36781525">
          <h3>
            <a class="item" href="https://github.com/tebe6502/Mad-Pascal"
              >Mad Pascal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 02:42:26</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36781525"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36781487">
          <h3>
            <a class="item" href="https://github.com/tonsky/FiraCode"
              >FiraCode: Free monospaced font with programming ligatures</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 02:35:30</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36781487"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36781248">
          <h3>
            <a
              class="item"
              href="https://www.intel.com/content/www/us/en/newsroom/news/intel-nuc-systems-agreement.html"
              >Intel and Asus agree to term sheet to take NUC systems product
              line forward</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 01:48:10</span
              ><span class="points-container"
                >Points: <span class="points">297</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36781248"
                  >Comments</a
                ><span class="descendants">: 176</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36781015">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2307.09009"
              >How is ChatGPT's behavior changing over time?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-19 @ 01:06:12</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36781015"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36780297">
          <h3>
            <a class="item" href="https://www.radiomarine.org/mrhs-events"
              >Enigma Crypto Transmission from KPH at 426 KHz and Shortwave</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 23:20:56</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36780297"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36779215">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/how-quantum-physics-describes-earths-weather-patterns-20230718/"
              >Quantum physicists explained earth’s oscillating weather
              patterns</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 21:16:13</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36779215"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36778905">
          <h3>
            <a class="item" href="https://github.com/jesseduffield/lazydocker"
              >Lazydocker: a lazier way to manage everything Docker</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 20:52:09</span
              ><span class="points-container"
                >Points: <span class="points">337</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36778905"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36778617">
          <h3>
            <a
              class="item"
              href="https://cython.readthedocs.io/en/latest/src/changes.html"
              >Cython 3.0 Released</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 20:26:23</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36778617"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36778566">
          <h3>
            <a class="item" href="https://www.val-lang.dev/"
              >Val, a high-level systems programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 20:22:29</span
              ><span class="points-container"
                >Points: <span class="points">349</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36778566"
                  >Comments</a
                ><span class="descendants">: 207</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36778318">
          <h3>
            <a
              class="item"
              href="https://blog.europython.eu/kraken-technologies-how-we-organize-our-very-large-pythonmonolith/"
              >Kraken Technologies: How we organise our large Python monolith</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 19:56:07</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36778318"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36778041">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2023/Jul/18/accessing-llama-2/"
              >Accessing Llama 2 from the command-line with the LLM-replicate
              plugin</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 19:33:33</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36778041"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36777576">
          <h3>
            <a class="item" href="https://pdos.csail.mit.edu/~baford/vm/"
              >Vx32: Portable, efficient, safe user-space execution of untrusted
              x86 code (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 18:59:07</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36777576"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36777536">
          <h3>
            <a
              class="item"
              href="https://www.gamingalexandria.com/wp/2023/07/nintendo-64-test-cart-rom/"
              >Nintendo 64 Test Cart ROM</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 18:56:42</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36777536"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36777396">
          <h3>
            <a
              class="item"
              href="https://bytewax.io/blog/data-parallel-task-parallel-and-agent-actor-architectures"
              >Data Parallel, Task Parallel, and Agent Actor Architectures</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 18:46:02</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36777396"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36777053">
          <h3>
            <a
              class="item"
              href="https://www.citusdata.com/blog/2023/07/18/citus-12-schema-based-sharding-for-postgres/"
              >Citus 12: Schema-based sharding for PostgreSQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 18:22:16</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36777053"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36774627">
          <h3><a class="item" href="https://ai.meta.com/llama/">Llama 2</a></h3>
          <section>
            <h4>
              <span>2023-07-18 @ 16:01:49</span
              ><span class="points-container"
                >Points: <span class="points">2078</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36774627"
                  >Comments</a
                ><span class="descendants">: 752</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36774611">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36774611"
              >Launch HN: Highlight.io (YC W23) – Open-source, full stack web
              app monitoring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 16:01:08</span
              ><span class="points-container"
                >Points: <span class="points">223</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36774611"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
            <div class="text">
              <a href="https://highlight.io">https://highlight.io</a>). We’re
              building a truly open source [1] observability platform for modern
              web applications. We posted some of our tools to HN in recent
              months [2][3]. Today, we’re excited to formally launch the
              project, share more about where we’re going, and of course, poll
              the community for some feedback. A bit of background: Vadim and I
              have worked at quite a few startups at this point, and a recurring
              challenge we’ve faced was tracing usability issues on the frontend
              to downstream errors and logs on the server. Understanding the
              real reason behind customer issues was always a chaotic juggling
              of multiple tools. With the rise of "frontend-forward" frameworks
              such as NextJS, which blur the boundary between the client and
              server, the complexity of tracing these issues is only growing.
              <p>
                This is where Highlight.io comes in: our product bridges the gap
                between client and server to give you a holistic view of your
                entire application.
              </p>
              <p>
                At its core, Highlight.io has three main “products”: Session
                Replay, Error Monitoring, and Logging. The novelty here is not
                in each product but in how they are connected. For example, in
                Highlight.io it’s very easy to click from a given error to the
                associated user session where it is thrown [4], and from a given
                error, you can easily inspect all of the logs that fired leading
                up to it. Ensuring that all of our products work together
                seamlessly with little to no effort is a core principle of our
                product strategy. If you’re using a common framework [5], for
                example, we’ll automatically link your frontend sessions with
                backend errors and logs. No agents, configuring facets, or
                anything else, It just works.
              </p>
              <p>
                We depend on several open source projects that help us move
                quickly. OpenTelemetry (OTEL) [6] is one of them, which helps us
                with maintainability, i.e. for every language that we support,
                we only maintain a thin wrapper around its respective OTEL SDK.
                OTEL is also a great way to enable the community to contribute,
                and we’re already seeing traction in this space (ie. an open
                source contributor built a wrapper for a Java SDK [7]).
              </p>
              <p>
                rrweb [8] is another project we leverage heavily for our session
                replay product. It drives our ability to record and replay the
                DOM to visualize user flows in the frontend. We’ve had the
                privilege to work closely with the rrweb team to ship
                improvements, and we’re now actively sponsoring the project [9].
              </p>
              <p>
                ClickHouse [10] has recently become a loved database on our
                team, as we historically used Opensearch for search-heavy
                workloads and started to hit growing pains with ingest
                throughput. We recently rolled it out for our logging product
                [3] and plan to replace our sessions and errors (and upcoming
                tracing work) with the database as well.
              </p>
              <p>
                From a business perspective, Highlight.io is open source under
                the Apache 2.0 license, and we make money with our hosted
                product [11]. For the hosted product, you can set billing caps
                for each offering and we don’t charge for seats. At this point,
                we have 100+ companies paying for our product (some of which are
                large enterprises), and thousands of sole developers use
                Highlight.io every week.
              </p>
              <p>
                On our roadmap [12] for the future includes metrics, tracing,
                release management and more. We also are launching several
                updates this week on our launch week page [13].
              </p>
              <p>
                Overall, we’re excited to be sharing Highlight.io with the
                world, and Vadim and I are particularly excited to get some
                feedback from the HN community. Please give us a test-drive at
                <a href="https://app.highlight.io">https://app.highlight.io</a>
                and let us know what you think. We would love to learn about
                what you wish you had in an observability product as well as any
                other experiences and ideas in this space. We look forward to
                hearing from you!
              </p>
              <p>
                1:
                <a
                  href="https://github.com/highlight/highlight/blob/main/LICENSE"
                  >https://github.com/highlight/highlight/blob/main/LICENSE</a
                >
              </p>
              <p>
                2:
                <a href="https://news.ycombinator.com/item?id=34897645"
                  >https://news.ycombinator.com/item?id=34897645</a
                >
              </p>
              <p>
                3:
                <a href="https://news.ycombinator.com/item?id=35643255"
                  >https://news.ycombinator.com/item?id=35643255</a
                >
              </p>
              <p>
                4:
                <a href="https://youtu.be/EvGsmbt0F7s?t=65"
                  >https://youtu.be/EvGsmbt0F7s?t=65</a
                >
              </p>
              <p>
                5:
                <a href="https://highlight.io/frameworks"
                  >https://highlight.io/frameworks</a
                >
              </p>
              <p>
                6:
                <a href="https://opentelemetry.io/"
                  >https://opentelemetry.io/</a
                >
              </p>
              <p>
                7:
                <a href="https://github.com/highlight/highlight/pull/4812"
                  >https://github.com/highlight/highlight/pull/4812</a
                >
              </p>
              <p>
                8:
                <a href="https://github.com/rrweb-io/rrweb"
                  >https://github.com/rrweb-io/rrweb</a
                >
              </p>
              <p>
                9:
                <a href="https://github.com/rrweb-io/rrweb#gold-sponsors-"
                  >https://github.com/rrweb-io/rrweb#gold-sponsors-</a
                >
              </p>
              <p>
                10:
                <a href="https://clickhouse.com/blog/overview-of-highlightio"
                  >https://clickhouse.com/blog/overview-of-highlightio</a
                >
              </p>
              <p>
                11:
                <a href="https://highlight.io/pricing"
                  >https://highlight.io/pricing</a
                >
              </p>
              <p>
                12:
                <a href="https://www.highlight.io/docs/general/roadmap"
                  >https://www.highlight.io/docs/general/roadmap</a
                >
              </p>
              <p>
                13:
                <a href="https://highlight.io/launch-week-2"
                  >https://highlight.io/launch-week-2</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36771662">
          <h3>
            <a
              class="item"
              href="https://resobscura.substack.com/p/wilfrid-voynich-bookseller-revolutionary"
              >Wilfrid Voynich: Bookseller, revolutionary, cryptologist…
              suspected spy?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 13:17:26</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36771662"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36770968">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=HMYiktO0D64"
              >Training Video for Bell Labs' Holmdel Computing Center (1973)
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 12:11:39</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36770968"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36757726">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/1981/12/14/a-i"
              >A.I. (1981)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 12:58:59</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36757726"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
