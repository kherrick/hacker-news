<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44075353">
          <h3>
            <a class="item" href="https://hcker.news"
              >Show HN: Hcker.news â€“ an ergonomic, timeline-based Hacker News
              front page</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 18:44:31</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44075353"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've built an alternative Hacker News front page. It is inspired
                by and meant to be a replacement for hckrnews.com.
              </p>
              <p>
                I built this because HN is woefully underfeatured, but most
                sites that try to improve it seem to assume that the visual
                design is the problem. hcker.news tries to maintain HN's
                familiarity while adding useful enhancements.
              </p>
              <p>There are three primary views:</p>
              <p>
                - Timeline View: Browse top stories by votes or comments grouped
                by day, week, or month (e.g., top 20 per day, top 100 per week).
              </p>
              <p>
                - Aggregate View: See top stories by votes or comments over
                custom time ranges.
              </p>
              <p>- Front Page View: The original HN front page, untouched.</p>
              <p>Feed Filtering:</p>
              <p>
                - Custom Keyword Filters: Include/exclude keywords (e.g.,
                include "Rust," exclude "DOGE") or set a minimum score
                threshold.
              </p>
              <p>
                - No HN Algorithm: Timeline and Aggregate Views show stories
                usually downranked by the HN algo (e.g., flagged posts or those
                with too many comments).
              </p>
              <p>UI:</p>
              <p>
                - Unread Flags: Quickly spot new stories or ones you haven't
                seen.
              </p>
              <p>
                - Two Layouts: Classic HN style or a compact story view inspired
                by hckrnews.com.
              </p>
              <p>
                - Multi-column &amp; High-density Modes: Fit more content on
                screen.
              </p>
              <p>- Themes: Light, Dark, and Manila.</p>
              <p>I'd love your feedback and suggestions. Cheers!</p>
            </div>
          </section>
        </section>
        <section id="44075254">
          <h3>
            <a
              class="item"
              href="https://www.pencilofrays.com/lens-design-forms/"
              >Types of optical systems in a lens designer's toolbox (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 18:33:07</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44075254"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44075105">
          <h3>
            <a
              class="item"
              href="https://www.stephendiehl.com/posts/post_transformers/"
              >Attention Wasn't All We Needed</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 18:14:29</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44075105"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44074684">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/05/22/world/canada/alberta-separatism-referendum.html"
              >Alberta separatism push roils Canada</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 17:22:20</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44074684"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44074668">
          <h3>
            <a
              class="item"
              href="https://www.cip.org/blog/llm-judges-are-unreliable"
              >Positional preferences, order effects, prompt sensitivity
              undermine AI judgments</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 17:20:40</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44074668"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44074637">
          <h3>
            <a
              class="item"
              href="https://jordanwtaylor2.substack.com/p/into-the-tunnel"
              >Into The Tunnel: The secret life of wind tunnels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 17:17:26</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44074637"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44074531">
          <h3>
            <a
              class="item"
              href="https://superlinked.com/vectorhub/articles/why-do-not-need-re-ranking"
              >You Don't Need Re-Ranking: Understanding the Superlinked Vector
              Layer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 17:03:10</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44074531"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44074487">
          <h3>
            <a
              class="item"
              href="https://www.choicesmagazine.org/choices-magazine/submitted-articles/unintended-consequences-of-allergen-food-labeling"
              >Sesame Scheme: Unintended Consequences of Allergen Food
              Labeling</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 16:58:39</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44074487"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44074340">
          <h3>
            <a
              class="item"
              href="https://shagbark.substack.com/p/how-to-live-on-432-a-month-in-america"
              >How to live on $432 a month in America</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 16:40:55</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44074340"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44074111">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2505.13775"
              >Beyond Semantics: Unreasonable Effectiveness of Reasonless
              Intermediate Tokens</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 16:13:43</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44074111"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44074017">
          <h3>
            <a
              class="item"
              href="https://foundersatwork.posthaven.com/find-your-people"
              >Find Your People</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 16:02:02</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44074017"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44073870">
          <h3>
            <a class="item" href="https://granta.com/slime/">Slime (2021)</a>
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 15:43:54</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44073870"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44073867">
          <h3>
            <a
              class="item"
              href="https://www.abc.net.au/news/science/2025-05-20/metre-treaty-anniversary-metric-system-measurement-metrology/105302024"
              >The metre originated in the French Revolution</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 15:43:16</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44073867"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44073785">
          <h3>
            <a
              class="item"
              href="https://www.anildash.com//2025/05/20/mcp-web20-20/"
              >MCP is the coming of Web 2.0 2.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 15:33:00</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44073785"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44073588">
          <h3>
            <a
              class="item"
              href="https://techcommunity.microsoft.com/blog/adforpostgresql/announcing-a-new-ide-for-postgresql-in-vs-code-from-microsoft/4414648"
              >Postgres IDE in VS Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 15:12:44</span
              ><span class="points-container"
                >Points: <span class="points">362</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44073588"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44073185">
          <h3>
            <a
              class="item"
              href="https://charliesabino.com/caesars-last-breath/"
              >Caesar's Last Breath</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 14:22:53</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44073185"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44072788">
          <h3>
            <a class="item" href="https://github.com/MayankPratap/Samchika"
              >Show HN: Samchika â€“ A Java Library for Fast, Multithreaded File
              Processing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 13:39:26</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44072788"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
            <div class="text">
              <p>
                Most Java file processing solutions either involve a lot of
                boilerplate or donâ€™t handle concurrency, backpressure, or
                metrics well out of the box. I needed something fast, clean, and
                production-friendly â€” so I built this.
              </p>
              <p>Key features:</p>
              <p>
                Multi-threaded line/batch processing using a configurable thread
                pool
              </p>
              <p>Producer/consumer model with built-in backpressure</p>
              <p>Buffered, asynchronous writing with optional auto-flush</p>
              <p>
                Live metrics: memory usage, throughput, thread times, queue
                stats
              </p>
              <p>Simple builder API â€” minimal setup to get going</p>
              <p>Output metrics to JSON, CSV, or human-readable format</p>
              <p>Use cases:</p>
              <p>Large CSV or log file parsing</p>
              <p>ETL pre-processing</p>
              <p>Line-by-line filtering and transformation</p>
              <p>Batch preparation before ingestion</p>
              <p>
                Iâ€™d really appreciate your feedback â€” feature ideas, performance
                improvements, critiques, or whether this solves a real problem
                for others. Thanks for checking it out!
              </p>
            </div>
          </section>
        </section>
        <section id="44071900">
          <h3>
            <a
              class="item"
              href="https://www.wordonfire.org/articles/remembering-alasdair-macintyre-1929-2025/"
              >Remembering Alasdair MacIntyre</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 11:37:07</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44071900"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44071690">
          <h3>
            <a class="item" href="https://rachelbythebay.com/w/2025/05/22/ssl/"
              >Why I no longer have an old-school cert on my HTTPS site</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 10:56:12</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44071690"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44071610">
          <h3>
            <a
              class="item"
              href="https://github.com/notactuallytreyanastasio/genstage_tutorial_2025/blob/main/README.md"
              >Writing A Job Runner (In Elixir) (Again) (10 years later)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 10:41:12</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44071610"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44070042">
          <h3>
            <a
              class="item"
              href="https://twitter.com/ID_AA_Carmack/status/1925710474366034326"
              >John Carmack talk at Upper Bound 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 05:14:16</span
              ><span class="points-container"
                >Points: <span class="points">404</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44070042"
                  >Comments</a
                ><span class="descendants">: 269</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44067409">
          <h3>
            <a class="item" href="https://github.com/kepano/defuddle"
              >Show HN: Defuddle, an HTML-to-Markdown alternative to
              Readability</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 21:40:54</span
              ><span class="points-container"
                >Points: <span class="points">369</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44067409"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built Defuddle while working on Obsidian Web Clipper[1] (also
                MIT-licensed) because Mozilla's Readability[2] appears to be
                mostly abandoned, and didn't work well for many sites.
              </p>
              <p>
                It's still very much a work in progress, but I thought I'd share
                it today, in light of the announcement that Mozilla is shutting
                down Pocket. This library could be helpful to anyone building a
                read-it-later app.
              </p>
              <p>Defuddle is also available as a CLI:</p>
              <p>
                <a href="https://github.com/kepano/defuddle-cli"
                  >https://github.com/kepano/defuddle-cli</a
                >
              </p>
              <p>
                [1]
                <a href="https://github.com/obsidianmd/obsidian-clipper"
                  >https://github.com/obsidianmd/obsidian-clipper</a
                >
              </p>
              <p>
                [2]
                <a href="https://github.com/mozilla/readability"
                  >https://github.com/mozilla/readability</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44050465">
          <h3>
            <a
              class="item"
              href="https://slate.com/culture/2025/05/birds-movies-charlies-angels-2000-pygmy-nuthatch.html"
              >The Curious Case of the Pygmy Nuthatch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-21 @ 11:52:40</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44050465"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44049926">
          <h3>
            <a
              class="item"
              href="https://tech.marksblogg.com/depth-anything-v2-maxar-ai-detection.html"
              >Satellites Spotting Depth</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-21 @ 10:12:32</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44049926"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44048574">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2504.05652"
              >Sugar-Coated Poison: Benign Generation Unlocks LLM
              Jailbreaking</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-21 @ 05:36:16</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44048574"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44038067">
          <h3>
            <a
              class="item"
              href="https://www.thenation.com/article/society/christopher-hill-life-of/"
              >Christopher Hill's History from Below</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-20 @ 05:23:54</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44038067"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44032995">
          <h3>
            <a
              class="item"
              href="https://blog.polybdenum.com/2025/02/14/designing-type-inference-for-high-quality-type-errors.html"
              >Designing type inference for high quality type errors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-19 @ 18:22:34</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44032995"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44031755">
          <h3>
            <a
              class="item"
              href="https://www.darwin.cam.ac.uk/lectures/entry/bits-with-soul/"
              >Bits with Soul</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-19 @ 16:48:29</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44031755"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44031082">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/turbocharged-mitochondria-power-birds-epic-migratory-journeys-20250519/"
              >'Turbocharged' Mitochondria Power Birds' Epic Migratory
              Journeys</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-19 @ 15:47:51</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44031082"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44027471">
          <h3>
            <a class="item" href="https://modvion.com/"
              >Tallest Wooden Wind Turbine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-19 @ 07:58:59</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44027471"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
