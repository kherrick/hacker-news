<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39235036">
          <h3>
            <a
              class="item"
              href="https://news.rice.edu/news/2024/rice-scientists-pull-quantum-coup"
              >Rice scientists pull off quantum coup</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 22:00:15</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39235036"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39234899">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/tesla-investigation-steering-control-lost-f29be580500a4ca97a280d6090259f05"
              >US investigation of Tesla steering problems is now one step
              closer to a recall</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 21:46:00</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39234899"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39234327">
          <h3>
            <a
              class="item"
              href="https://www.ziprecruiter.com/jobs/kodable-fd6f1626/senior-full-stack-software-engineer-c215f839"
              >Kodable is hiring a Full Stack Engineer to help teach kids to
              code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 21:01:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39233943">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/959562/0578b8e463f790c1/"
              >OpenBSD System-Call Pinning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 20:33:33</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39233943"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39233855">
          <h3>
            <a
              class="item"
              href="https://www.schneier.com/blog/archives/2024/02/david-kahn.html"
              >David Kahn has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 20:27:59</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39233855"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39233802">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/tech/annals-of-technology/where-will-virtual-reality-take-us"
              >Where Will Virtual Reality Take Us?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 20:24:52</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39233802"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39233239">
          <h3>
            <a
              class="item"
              href="https://www.hive.co.uk/Product/Ingrid-Robeyns/Limitarianism--The-Case-Against-Extreme-Wealth/28866492"
              >Limitarianism: The Case Against Extreme Wealth: Ingrid Robeyns</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 19:46:33</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39233239"
                  >Comments</a
                ><span class="descendants">: 216</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39233080">
          <h3>
            <a
              class="item"
              href="https://www.techdirt.com/2024/02/02/we-shouldnt-allow-a-new-super-secret-surveillance-court-cover-up-the-civil-liberties-problems-of-the-old-super-secret-surveillance-court/"
              >New Super Secret Surveillance Court Covering Old Super Secret
              Surveillance Court</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 19:32:31</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39233080"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39232580">
          <h3>
            <a
              class="item"
              href="https://computer.rip/2024-01-31-multi-channel-audio-part-2.html"
              >Multi-channel Audio Part 2</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 18:49:20</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39232580"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39232572">
          <h3>
            <a class="item" href="https://polyreplay.com/minesweepertwist"
              >Show HN: The classic Minesweeper on an irregular grid</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 18:48:53</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39232572"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
            <div class="text">
              <p>This is a first game based on Minesweeper.</p>
              <p>
                The changes an irregular grid brings are that cells don't all
                have 8 neighbors. Some can have less, some can have more. So
                when you try and deduce if a tile has a mine, you have to pay
                closer attention at the number clues and which tiles neighbors
                it.
              </p>
              <p>
                My intention is to make a very classic game a bit more
                challenging &amp; fun.
              </p>
              <p>
                I've also released a first version of Checkers/Draughts, and
                plan to test similar variants for Chess, Othello and Go.
              </p>
            </div>
          </section>
        </section>
        <section id="39232004">
          <h3>
            <a
              class="item"
              href="https://www.preethamrn.com/posts/when-should-you-give-up"
              >When should you give up on a project that doesn't work?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 18:07:15</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39232004"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39231663">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2014/09/06/how-to-read-an-executable/"
              >How is a binary executable organized? Let's explore it (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 17:43:33</span
              ><span class="points-container"
                >Points: <span class="points">274</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39231663"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39231488">
          <h3>
            <a class="item" href="https://million.dev/blog/million-3.en-US"
              >Show HN: Million 3 – Optimizing compiler for React</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 17:32:15</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39231488"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39230939">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-02-bone-bandage-material-bones.html"
              >Researchers develop novel 'bone bandage' material for cracked
              bones</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 16:51:41</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39230939"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39230263">
          <h3>
            <a
              class="item"
              href="https://www.npr.org/2024/02/02/1228540721/forever-chemicals-pfas-epa-hazardous"
              >The EPA is proposing that 'forever chemicals' be considered
              hazardous substances</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 16:09:44</span
              ><span class="points-container"
                >Points: <span class="points">285</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39230263"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39230244">
          <h3>
            <a class="item" href="https://pinballmap.com/"
              >Pinball Map: Crowd-sourced worldwide map of public pinball
              machines</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 16:08:51</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39230244"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39229746">
          <h3>
            <a class="item" href="https://github.com/saneef/color-color"
              >Open Source color palettes generator in HSLuv color space</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 15:33:13</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39229746"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39227831">
          <h3>
            <a class="item" href="https://www.tints.dev/"
              >Tailwind color palette generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 12:26:37</span
              ><span class="points-container"
                >Points: <span class="points">407</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39227831"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39226754">
          <h3>
            <a class="item" href="https://matan-h.com/another-secret-browser"
              >Google has another secret browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-02 @ 09:17:00</span
              ><span class="points-container"
                >Points: <span class="points">583</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39226754"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39217000">
          <h3>
            <a
              class="item"
              href="https://github.com/highlight/highlight/blob/3cc29388f99716833055d1aaa4a53d938d9e786e/README.md"
              >Show HN: An open source performance monitoring tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-01 @ 15:32:18</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39217000"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <a href="https://highlight.io">https://highlight.io</a>). We’re
              building an open source [1] monitoring platform for web
              applications.
              <p>
                Today we’re excited to be sharing a performance tool we’ve been
                working on, which helps you inspect the latency of code
                execution from the client to the server. As engineers at past
                startups, we often had to debug slow queries, poor load times,
                inconsistent errors, etc... While tools like Jaegar [2] helped
                us inspect server-side performance, we had no way to tie user
                events to the traces we were inspecting. In other words,
                although we had an idea of what API route was slow, there wasn’t
                much visibility into the actual bottleneck.
              </p>
              <p>
                This is where our performance product comes in: we’re rethinking
                a tracing/performance tool that focuses on bridging the gap
                between the client and server.
              </p>
              <p>
                What’s unique about our approach is that we lean heavily into
                creating traces from the frontend. For example, if you’re using
                our Next.js SDK, we automatically connect browser HTTP requests
                with server-side code execution, all from the perspective of a
                user. We find this much more powerful because you can understand
                what part of your frontend codebase causes a given trace to
                occur. There’s an example here [3].
              </p>
              <p>
                From an instrumentation perspective, we’ve built our SDKs on-top
                of OTel, so you can create custom spans to expand
                highlight-created traces in server routes that will
                transparently roll up into the flame graph you see in our UI.
                You can also send us raw OTel traces and manually set up the
                client-server connection if you want. [4] Here’s an example of
                what a trace looks like with a database integration using our
                Golang GORM SDK, triggered by a frontend GraphQL query [5] [6].
              </p>
              <p>
                In terms of how it's built, we continue to rely heavily on
                ClickHouse as our time-series storage engine. Given that traces
                require that we also query based on an ID for specific groups of
                spans (more akin to an OLTP db), we’ve leveraged the power of CH
                materialized views to make these operations efficient (described
                here [7]).
              </p>
              <p>
                To try it out, you can spin up the project with our self hosted
                docs [8] or use our cloud offering at app.highlight.io. The
                entire stack runs in docker via a compose file, including an
                OpenTelemetry collector for data ingestion. You’ll need to point
                your SDK to export data to it by setting the relevant OTLP
                endpoint configuration (ie. environment variable
                OTEL_EXPORTER_OTLP_LOGS_ENDPOINT [9]).
              </p>
              <p>
                Overall, we’d really appreciate feedback on what we’re building
                here. We’re also all ears if anyone has opinions on what they’d
                like to see in a product like this!
              </p>
              <p>
                [1]
                <a
                  href="https://github.com/highlight/highlight/blob/main/LICENSE"
                  >https://github.com/highlight/highlight/blob/main/LICENSE</a
                >
              </p>
              <p>
                [2]
                <a href="https://www.jaegertracing.io"
                  >https://www.jaegertracing.io</a
                >
              </p>
              <p>
                [3]
                <a
                  href="https://app.highlight.io/1383/sessions/COu90Th4Qc3PVYTXbx9Xee7xbQqN?ts=5.243&amp;network-resource-id=25"
                  >https://app.highlight.io/1383/sessions/COu90Th4Qc3PVYTXbx9Xe...</a
                >
              </p>
              <p>
                [4]
                <a
                  href="https://www.highlight.io/docs/getting-started/native-opentelemetry/overview"
                  >https://www.highlight.io/docs/getting-started/native-opentel...</a
                >
              </p>
              <p>
                [5]
                <a href="https://static.highlight.io/assets/docs/gorm.png"
                  >https://static.highlight.io/assets/docs/gorm.png</a
                >
              </p>
              <p>
                [6]
                <a
                  href="https://github.com/highlight/highlight/blob/1fc9487a676409f12fb84709603dcdf0b4440952/backend/main.go#L218-L266"
                  >https://github.com/highlight/highlight/blob/1fc9487a676409f1...</a
                >
              </p>
              <p>
                [7]
                <a
                  href="https://highlight.io/blog/clickhouse-materialized-views"
                  >https://highlight.io/blog/clickhouse-materialized-views</a
                >
              </p>
              <p>
                [8]
                <a
                  href="https://www.highlight.io/docs/getting-started/self-host/self-hosted-hobby-guide"
                  >https://www.highlight.io/docs/getting-started/self-host/self...</a
                >
              </p>
              <p>
                [9]
                <a
                  href="https://opentelemetry.io/docs/concepts/sdk-configuration/otlp-exporter-configuration/#otel_exporter_otlp_endpoint"
                  >https://opentelemetry.io/docs/concepts/sdk-configuration/otl...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="39214966">
          <h3>
            <a class="item" href="https://and0uille.net/misc/debug90.html"
              >Reverse Engineering DOS Software as If It Were 1990</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-01 @ 11:49:51</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39214966"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39213809">
          <h3>
            <a
              class="item"
              href="https://ochagavia.nl/blog/the-undercover-generalist/"
              >The Undercover Generalist</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-01 @ 08:21:12</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39213809"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39213772">
          <h3>
            <a
              class="item"
              href="https://hackaday.com/2024/01/31/check-out-these-amazing-self-soldering-sleeves-from-world-war-ii/"
              >Check Out These Self-Soldering Sleeves from World War II</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-01 @ 08:11:57</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39213772"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39213648">
          <h3>
            <a
              class="item"
              href="https://encore.dev/blog/thundering-herd-problem"
              >The Thundering Herd Problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-01 @ 07:46:09</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39213648"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39213595">
          <h3>
            <a class="item" href="https://github.com/n7space/aerugo"
              >Aerugo – RTOS for aerospace uses written in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-01 @ 07:34:57</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39213595"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39213485">
          <h3>
            <a
              class="item"
              href="https://writings.stephenwolfram.com/2021/03/a-little-closer-to-finding-what-became-of-moses-schonfinkel-inventor-of-combinators/"
              >A Little Closer to Finding What Became of M. Schönfinkel Inventor
              of Combinators</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-01 @ 07:14:51</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39213485"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39208702">
          <h3>
            <a
              class="item"
              href="http://strangeco.blogspot.com/2024/01/the-burial-of-william-conqueror-comedy.html"
              >The Burial of William the Conqueror: A Comedy of Errors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-31 @ 20:09:53</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39208702"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39200716">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/01/10/hobbes_os2_archive_shut_down/"
              >The Hobbes OS/2 Archive logs off permanently in April</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-31 @ 06:37:27</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39200716"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39164010">
          <h3>
            <a class="item" href="https://fck-nat.dev/v1.3.0/"
              >Fck-nat: The (f)easible (C)ost (k)onfigurable NAT</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-28 @ 09:42:37</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39164010"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39164002">
          <h3><a class="item" href="https://pandoc.org">Pandoc</a></h3>
          <section>
            <h4>
              <span>2024-01-28 @ 09:41:43</span
              ><span class="points-container"
                >Points: <span class="points">554</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39164002"
                  >Comments</a
                ><span class="descendants">: 220</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
