<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37894081">
          <h3>
            <a
              class="item"
              href="https://www.utep.edu/newsfeed/2023/extroverts-more-likely-to-resist-vaccines-study-shows.html"
              >Extroverts more likely to resist vaccines, study shows</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 22:43:37</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37894081"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37894072">
          <h3>
            <a class="item" href="https://thewalrus.ca/margaret-atwood-ai/"
              >Margaret Atwood Reviews a Margaret Atwood Story by AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 22:43:06</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37894072"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37894030">
          <h3>
            <a
              class="item"
              href="http://oldvcr.blogspot.com/2023/10/teaching-apple-cyberdog-10-new-tricks.html"
              >Teaching Apple Cyberdog 1.0 new tricks (featuring OpenDoc)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 22:35:58</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37894030"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37893601">
          <h3>
            <a
              class="item"
              href="https://www.insider.com/2-florida-men-scammed-more-than-1-million-uber-eats-2023-8"
              >Florida men scammed more than $1M out of Uber Eats</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 21:35:51</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37893601"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37893555">
          <h3>
            <a class="item" href="https://github.com/skiselev/8088_bios"
              >GPL-3.0 licensed BIOS for Intel 8088 based computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 21:30:27</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37893555"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37893467">
          <h3>
            <a
              class="item"
              href="https://www.latimes.com/environment/story/2023-10-05/klamath-dam-removal-tribes"
              >The largest dam removal in history stirs hopes of restoring
              tribes' way of life</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 21:17:29</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37893467"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37893337">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/freshpaint/bfe56523-bff4-4ca3-936b-0ba15fb4e572?utm_source=hn"
              >Freshpaint (YC S19) Is Hiring Software Engineers to Protect
              Patient Privacy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 21:00:30</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37893291">
          <h3>
            <a
              class="item"
              href="https://nicole.express/2023/bang-bang-youre-dead.html"
              >Yes, You Can Use Lightguns on LCDs– Sometimes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 20:52:25</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37893291"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37893111">
          <h3>
            <a
              class="item"
              href="https://thechipletter.substack.com/p/bytecode-and-the-busicom"
              >Bytecode and the Busicom (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 20:27:17</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37893111"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37893091">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/obituary/2023/10/04/the-sycamore-gap-tree-held-a-particularly-deep-place-in-peoples-hearts"
              >The Sycamore Gap tree held a particularly deep place in people's
              hearts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 20:24:20</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37893091"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37892684">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2023/10/mastercard-should-stop-selling-our-data"
              >Mastercard Should Stop Selling Our Data</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 19:33:35</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37892684"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37892654">
          <h3>
            <a
              class="item"
              href="https://lists.debian.org/debian-devel/2023/10/msg00083.html"
              >Hyphens in man pages</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 19:30:25</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37892654"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37892560">
          <h3>
            <a class="item" href="https://open-earable.teco.edu/"
              >OpenEarable: A new, open-source, Arduino-based platform for
              ear-based sensing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 19:20:45</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37892560"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37892028">
          <h3>
            <a class="item" href="https://github.com/jtesta/ssh-audit"
              >SSH-audit: SSH server and client security auditing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 18:18:44</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37892028"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37890742">
          <h3>
            <a class="item" href="https://omnivore.app/"
              >Omnivore – free, open source, read-it-later App</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 15:48:33</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37890742"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37890725">
          <h3>
            <a
              class="item"
              href="https://chriscoyier.net/2023/10/03/being-picky-about-a-css-reset-for-fun-pleasure/"
              >Being picky about a CSS reset for fun</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 15:47:07</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37890725"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37890723">
          <h3>
            <a
              class="item"
              href="https://blog.ploeh.dk/2020/03/02/impureim-sandwich/"
              >Impureim Sandwich (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 15:46:59</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37890723"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37890685">
          <h3>
            <a
              class="item"
              href="https://dzidas.com/ml/2023/10/15/blind-spot-ds/"
              >Causal inference as a blind spot of data scientists</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 15:43:19</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37890685"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37890453">
          <h3>
            <a
              class="item"
              href="https://alexis.bernard.io/blog/2023-10-15-background-job-queues-and-priorities-may-be-the-wrong-path.html"
              >Background job queues and priorities may be the wrong path</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 15:18:39</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37890453"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37890369">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=leYj--P4CgQ"
              >Mark Twain filmed by Thomas Edison in 1909</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 15:08:39</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37890369"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37890206">
          <h3>
            <a class="item" href="https://www.charlesatlas.com/index.html"
              >The official website of Charles Atlas</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 14:45:45</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37890206"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37890176">
          <h3>
            <a
              class="item"
              href="https://www.signtime.apple/applecare/us-EN/asl"
              >Signtime.apple: One-on-one sign language interpreting by Apple</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 14:42:55</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37890176"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37889224">
          <h3>
            <a class="item" href="https://stateofthemap.eu/"
              >State of the Map EU 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 12:34:21</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37889224"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37888606">
          <h3>
            <a class="item" href="https://italianpoetry.it/"
              >Show HN: "Interactive" Italian Poetry for English Speakers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 10:37:13</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37888606"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
            <div class="text">
              <p>
                I basically implemented what I would like to have when I listen
                to songs or poems in a language I don't speak: karaoke-like,
                word by word, literal translation, with notes about word usage
                and some context when needed.
              </p>
              <p>
                And some stuff about the language itself --- the part needed for
                the poems, at least.
              </p>
              <p>
                The tech stack is as minimal as it gets: I was hoping for an old
                web vibe.
              </p>
              <p>Feedback welcome!</p>
            </div>
          </section>
        </section>
        <section id="37875924">
          <h3>
            <a
              class="item"
              href="https://gonzoml.substack.com/p/building-machines-that-learn-and"
              >"Building Machines That Learn and Think Like People", 7 Years
              Later</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-13 @ 21:39:58</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37875924"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37875898">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/scitranslmed.ade1283"
              >Single-cell genomic atlas for maturation of human cerebellum in
              early childhood</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-13 @ 21:37:48</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37875898"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37875193">
          <h3>
            <a
              class="item"
              href="https://512pixels.net/2023/10/the-history-of-cover-flow/"
              >The History of Cover Flow</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-13 @ 20:23:28</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37875193"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37862546">
          <h3>
            <a
              class="item"
              href="https://www.observatoiredeparis.psl.eu/revue-fortement-a-la-baisse.html"
              >Revisited mass of the Milky Way is much smaller than expectations
              from cosmology</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 20:10:35</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37862546"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37862532">
          <h3>
            <a class="item" href="https://www.npmjs.com/package/stark-db"
              >Stark-DB: SQLite-backed, change-tracking database available over
              HTTP</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 20:09:47</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37862532"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37862317">
          <h3>
            <a class="item" href="https://demo.openble.org"
              >Show HN: OpenBLE, Swagger for Bluetooth</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 19:53:45</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37862317"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              <p>
                Bluetooth development is a mess. Too many datasheets, too little
                documentation and SDK fragmentation across platforms. I built
                this tool to improve documentation, version control and
                development speed for BLE programs.
              </p>
              <p>
                Even though shunned by Apple and Mozilla, Web Bluetooth enjoys
                wide support and just works. It makes sense to build the
                frontend for OpenBLE using web Bluetooth. No SDK hell, no
                installations, wide support albeit experimental. I could ship
                the spec, SDK, code generator and testing framework in pure
                JavaScript.
              </p>
            </div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
