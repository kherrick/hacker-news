<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39019465">
          <h3>
            <a class="item" href="https://github.com/stevekrenzel/pick-ems"
              >NFL Pick-Em's LLM Bot</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 21:34:49</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39019465"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39019063">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39019063"
              >Y Combinator needs another infrastructure software engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 21:00:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                I currently run YC’s infrastructure and I need some help! Over
                the last 7 years I’ve been at YC, our software team has grown
                considerably both in engineers and in products. We need to
                invest more in our infrastructure so we can keep shipping our
                products quickly.
              </p>
              <p>
                The main thing you’ll need in this job is curiosity; I work at
                every layer of a very large stack. One day you might dig into
                AWS apis, another it’s a 3rd party Ruby gem or our git history.
                Or maybe you get paged that all the SSDs for Hacker News
                (primary and standby!) died on the same day :)
                <a href="https://news.ycombinator.com/item?id=32028511"
                  >https://news.ycombinator.com/item?id=32028511</a
                >.
              </p>
              <p>
                The first few months will be heavier on infrastructure work but
                in the future the job will hopefully be equal parts developer
                experience, infrastructure work, and product engineering that
                impacts all of our products (think SSO, sending email, security,
                etc). This isn't just an SRE role; we also ship products to
                users.
              </p>
              <p>
                The main products we support are all Ruby on Rails apps running
                in AWS (mostly in ECS); ideally you’ve already worked on apps
                like that. You have at least 5 years of experience. Part of that
                was shipping code to customers but you’ve also got cloud
                experience (we try to mostly use Terraform). You’re probably the
                person people turn to when there’s a fire to put out.
              </p>
              <p>
                YC has excellent compensation and benefits (see more in the
                formal job description:
                <a
                  href="https://www.ycombinator.com/companies/y-combinator/jobs/0EwhV3s-infrastructure-software-engineer"
                  >https://www.ycombinator.com/companies/y-combinator/jobs/0Ewh...</a
                >). The team and the work life balance are great. About half of
                us are former founders and many of us are parents. And if you’re
                curious about startups (and possibly starting one someday), this
                job gives you amazing access to interact with YC’s programs,
                partners, and founders.
              </p>
              <p>
                If you’re interested, I’d love to chat! I’m
                mark@ycombinator.com.
              </p>
            </div>
          </section>
        </section>
        <section id="39018769">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/6174">6174</a>
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 20:35:37</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39018769"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39018106">
          <h3>
            <a
              class="item"
              href="https://www.righto.com/2024/01/bendix-cadc-pressure-transducers.html"
              >The mechanical Bendix Air Data Computer, part 3: pressure
              transducers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 19:48:36</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39018106"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39017607">
          <h3>
            <a
              class="item"
              href="https://developer.chrome.com/blog/supercharge-web-ai-testing"
              >Web AI Model Testing: WebGPU, WebGL, and Headless Chrome</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 19:16:12</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39017607"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39016405">
          <h3>
            <a class="item" href="https://leftoverlocals.com/"
              >LeftoverLocals: A vulnerability that allows data recovery from
              GPU memory</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 17:58:31</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39016405"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39016337">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/Linux-Caching-Time-Block-IO"
              >5 minutes of coding yields a 6%+ boost to Linux I/O
              performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 17:53:17</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39016337"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39016123">
          <h3>
            <a class="item" href="https://www.lilygo.cc/products/t-keyboard"
              >Lilygo T-Keyboard: An ESP32 Bluetooth Blackberry keyboard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 17:37:08</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39016123"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39016086">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2312.14135"
              >V*: Guided Visual Search as a Core Mechanism in Multimodal
              LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 17:34:22</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39016086"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39016040">
          <h3>
            <a
              class="item"
              href="https://greenrosechemistry.com/how-scientists-proved-that-bees-can-perceive-time/"
              >Bees have an internal sense of time (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 17:31:31</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39016040"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39015377">
          <h3>
            <a
              class="item"
              href="https://zolutal.github.io/understanding-paging/"
              >Understanding x86_64 Paging</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 16:44:30</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39015377"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39015159">
          <h3>
            <a
              class="item"
              href="https://worldsensorium.com/why-is-everything-an-orchid/"
              >Why is everything an orchid?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 16:28:16</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39015159"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39014985">
          <h3>
            <a class="item" href="https://artificialanalysis.ai"
              >Benchmarks and comparison of LLM AI models and API hosting
              providers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 16:11:31</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39014985"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                The site consolidates different quality benchmarks, pricing
                information and our own technical benchmarking data. Technical
                benchmarking (throughput, latency) is conducted through sending
                API requests every 3 hours.
              </p>
              <p>
                Check out the site at
                <a href="https://artificialanalysis.ai"
                  >https://artificialanalysis.ai</a
                >, and our twitter at
                <a href="https://twitter.com/ArtificialAnlys"
                  >https://twitter.com/ArtificialAnlys</a
                >
              </p>
              <p>
                Twitter thread with initial insights:
                <a
                  href="https://twitter.com/ArtificialAnlys/status/1747264832439734353"
                  >https://twitter.com/ArtificialAnlys/status/17472648324397343...</a
                >
              </p>
              <p>
                All feedback is welcome and happy to discuss methodology, etc.
              </p>
            </div>
          </section>
        </section>
        <section id="39014866">
          <h3>
            <a class="item" href="https://www.ikkaro.net/what-tinyml-is/"
              >TinyML: Ultra-low power machine learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 16:03:25</span
              ><span class="points-container"
                >Points: <span class="points">218</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39014866"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39014737">
          <h3>
            <a
              class="item"
              href="https://www.thediff.co/archive/a-theory-of-grift/"
              >A Theory of Grift</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 15:54:21</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39014737"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39014652">
          <h3>
            <a class="item" href="https://github.com/timfraedrich/OutRun"
              >OutRun – Open-source, privacy oriented, outdoor fitness
              tracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 15:48:47</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39014652"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39014521">
          <h3>
            <a
              class="item"
              href="https://www.oneusefulthing.org/p/centaurs-and-cyborgs-on-the-jagged"
              >Field experimental evidence of AI on knowledge worker
              productivity and quality</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 15:41:10</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39014521"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39014426">
          <h3>
            <a class="item" href="http://www.madscientistsclub.com/books.html"
              >Mad Scientists' Club: The Books</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 15:35:42</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39014426"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39013497">
          <h3>
            <a
              class="item"
              href="https://downloads.webis.de/publications/papers/bevendorff_2024a.pdf"
              >Is Google Getting Worse? A Longitudinal Investigation of SEO Spam
              in Search [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 14:21:21</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39013497"
                  >Comments</a
                ><span class="descendants">: 175</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39013229">
          <h3>
            <a
              class="item"
              href="https://barkeywolf.consulting/posts/barcode-scanner-webassembly/#meet-zbar"
              >Using the ZBar barcode scanning suite in the browser with
              WebAssembly</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 13:49:26</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39013229"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39012697">
          <h3>
            <a class="item" href="https://github.com/kffl/speedbump"
              >Speedbump – a TCP proxy to simulate variable network latency</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 12:47:30</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39012697"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39012262">
          <h3>
            <a
              class="item"
              href="https://www.nsa.gov/Press-Room/Press-Releases-Statements/Press-Release-View/Article/3631341/five-cryptologic-giants-to-be-inducted-into-nsas-cryptologic-hall-of-honor/"
              >Five cryptologic giants to be inducted into NSA's Cryptologic
              Hall of Honor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 11:51:39</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39012262"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39012235">
          <h3>
            <a
              class="item"
              href="https://nashby.github.io/2024/01/15/ruby-3-on-rails-1/"
              >Ruby 3.3 on Rails 1.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 11:48:07</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39012235"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39012054">
          <h3>
            <a class="item" href="https://github.com/outline/outline"
              >Outline: Self hostable, realtime, Markdown compatible knowledge
              base</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 11:19:40</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39012054"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39011850">
          <h3>
            <a
              class="item"
              href="https://1f6042.blogspot.com/2024/01/stdclamp-still-generates-less-efficient.html"
              >Std: Clamp generates less efficient assembly than
              std:min(max,std:max(min,v))</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 10:53:15</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39011850"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39010454">
          <h3>
            <a class="item" href="https://github.com/Ostorlab/KEV"
              >Open-Source Detector of CISA's Known Exploitable
              Vulnerabilities</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-16 @ 07:29:40</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39010454"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39000905">
          <h3>
            <a class="item" href="https://github.com/buzzm/postgresbson"
              >Show HN: BSON Extension for Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-15 @ 13:46:44</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39000905"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              JSON support in postgres is superb but sometimes you really want
              decimal, date, and binary types, "carefree" UTF8 string handling
              (i.e. no escaping), and robust roundtrippability. So I made an
              extension for BSON.
            </div>
          </section>
        </section>
        <section id="38998914">
          <h3>
            <a
              class="item"
              href="https://maskray.me/blog/2024-01-14-exploring-object-file-formats"
              >Exploring Object File Formats</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-15 @ 09:35:50</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38998914"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38995035">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/lifeandstyle/2024/jan/14/an-aged-hobby-enthusiasts-struggle-to-keep-model-railway-industry-on-track"
              >Enthusiasts struggle to keep model railway industry on track</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-14 @ 22:23:56</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38995035"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38989917">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s42003-023-05587-3"
              >The origins of the Guinness stout yeast</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-14 @ 12:40:26</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38989917"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
