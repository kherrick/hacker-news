<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35744130">
          <h3>
            <a
              class="item"
              href="https://ma.ttias.be/theres-more-than-one-way-to-write-an-ip-address/"
              >Thereâ€™s more than one way to write an IP address (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 17:07:47</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35744130"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35744069">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35744069"
              >Ask HN: How to Protect Ideas and Implementation?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 17:03:24</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35744069"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <i>may</i> not be unique afterall) - but as a solo founder, I need
              to have some protection so someone doesn't copy the exact things
              (UIs and backend implementation). Can anyone provide any pointers
              how best to build some protection after product goes live ? I
              worry larger players may just copy what I do. Are patents a good
              idea ? Less likely I could do it, if it's expensive though
            </div>
          </section>
        </section>
        <section id="35744018">
          <h3>
            <a
              class="item"
              href="https://github.com/laudspeaker/laudspeaker/tree/Hiring"
              >Laudspeaker hiring engineer to build open source customer journey
              software</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 17:00:35</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35743778">
          <h3>
            <a
              class="item"
              href="https://www.slidebook.io/blog/article/on-the-road-to-failure/"
              >Pitch decks by FTX, Enron, Theranos, Celsius and other corporate
              failures</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 16:43:13</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35743778"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35743727">
          <h3>
            <a
              class="item"
              href="https://stability.ai/blog/deepfloyd-if-text-to-image-model"
              >Stability AI releases DeepFloyd IF, a powerful text-to-image
              model</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 16:39:44</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35743727"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35743433">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=UaL2tYC0Zuw"
              >GM EV1 Drag Race vs. Miata and 300zx [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 16:20:48</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35743433"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35743175">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/cars/2023/04/daimler-is-setting-up-a-650-million-charging-network-for-commercial-evs/"
              >Daimler is setting up a $650M charging network for commercial
              EVs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 16:06:41</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35743175"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35742476">
          <h3>
            <a
              class="item"
              href="https://mastodon.social/@haeckerfelix/110272427676278609"
              >Check if your IKEA chair is compatible with your screen</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 15:30:56</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35742476"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35741922">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/GrafanaLokiSimpleNotRecommended"
              >I can't recommend serious use of an all-in-one local Grafana Loki
              setup</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 14:47:31</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35741922"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35741892">
          <h3>
            <a class="item" href="https://9fans.github.io/plan9port/"
              >Plan 9 from User Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 14:45:29</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35741892"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35741700">
          <h3>
            <a
              class="item"
              href="https://securityaffairs.com/145406/cyber-crime/ukraine-cyber-police-arrested-man.html"
              >The Ukrainian police arrested a man for selling data of over 300M
              people</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 14:30:42</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35741700"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35741416">
          <h3>
            <a class="item" href="http://wiki.c2.com/?TupleSpace"
              >Tuple Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 14:06:30</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35741416"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35740836">
          <h3>
            <a class="item" href="https://github.com/xtekky/gpt4free"
              >Gpt4free repo given takedown notice by OpenAI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 13:08:53</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35740836"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35740794">
          <h3>
            <a
              class="item"
              href="https://extism.org/blog/extending-fly-io-distributed-game-system-part-3/"
              >GameBox is a programmable, turn-based, WebAssembly game
              platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 13:03:57</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35740794"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35740683">
          <h3>
            <a
              class="item"
              href="https://blog.airsequel.com/exciting-sqlite-improvements-since-2020/"
              >Exciting SQLite Improvements Since 2020</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 12:52:47</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35740683"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35740613">
          <h3>
            <a class="item" href="https://github.com/qadron/cuboid"
              >Cuboid: An application-centric, decentralised and distributed
              computing project</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 12:45:25</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35740613"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35740581">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2023/04/many-public-salesforce-sites-are-leaking-private-data/"
              >Many Public Salesforce Sites Are Leaking Private Data</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 12:43:02</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35740581"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35740494">
          <h3>
            <a
              class="item"
              href="https://clojure.org/news/2023/04/28/introducing-morse"
              >Morse, an open-source interactive tool for inspecting Clojure</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 12:31:38</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35740494"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35740277">
          <h3>
            <a class="item" href="https://billmei.net/blog/bribe-friends"
              >How to spend money on your friends without it looking like
              bribery</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 12:06:47</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35740277"
                  >Comments</a
                ><span class="descendants">: 164</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35740001">
          <h3>
            <a
              class="item"
              href="https://blog.benjojo.co.uk/post/quickcam-usb-userspace-driver"
              >Driver adventures for a 1999 webcam</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 11:33:08</span
              ><span class="points-container"
                >Points: <span class="points">281</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35740001"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35738829">
          <h3>
            <a
              class="item"
              href="https://www.neowin.net/news/senior-microsoft-exec-says-windows-11-kernel-will-soon-be-booting-with-rust-inside/"
              >Microsoft exec says Windows 11 kernel will soon be booting with
              Rust inside</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 08:19:47</span
              ><span class="points-container"
                >Points: <span class="points">306</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35738829"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35737877">
          <h3>
            <a
              class="item"
              href="https://www.voguebusiness.com/sustainability/recycled-denim-have-pangaia-and-evrnu-made-a-big-breakthrough"
              >Recycled denim: a breakthrough?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 05:48:36</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35737877"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35737863">
          <h3>
            <a
              class="item"
              href="https://www.just-food.com/news/upward-farms-throws-in-towel-ten-years-after-founding-vertical-farming-business/"
              >Upward Farms throws in towel ten years after founding
              vertical-farming business</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 05:46:41</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35737863"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35737862">
          <h3>
            <a
              class="item"
              href="https://probablydance.com/2023/04/27/beautiful-branchless-binary-search/"
              >Beautiful branchless binary search</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 05:46:40</span
              ><span class="points-container"
                >Points: <span class="points">308</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35737862"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35737838">
          <h3>
            <a
              class="item"
              href="https://www.salon.com/2022/12/10/nibblerids-provora-new-branch-on-tree-of-life/"
              >Provora: tiny predators that have been evolving separately for
              millions of years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 05:42:14</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35737838"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35729232">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35729232"
              >Ask HN: Most interesting tech you built for just yourself?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 15:04:56</span
              ><span class="points-container"
                >Points: <span class="points">693</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35729232"
                  >Comments</a
                ><span class="descendants">: 900</span></span
              >
            </h4>
            <div class="text">
              Maybe you've created your own AR program for wearables that shows
              the definition of a word when you highlight it IRL, or you've
              built a personal calendar app for your family to display on a
              monitor in the kitchen. Whatever it is, I'd love to hear it.
            </div>
          </section>
        </section>
        <section id="35723609">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20230424-how-agrivoltaics-helped-save-italys-citron-and-lemon-trees"
              >The Italian farmers saving an ancient fruit with solar power</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 05:20:53</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35723609"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35722648">
          <h3>
            <a
              class="item"
              href="http://oldvcr.blogspot.com/2023/04/of-sun-ray-laptops-mips-and-getting.html"
              >Of Sun Ray laptops, MIPS and getting root on them</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 02:36:50</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35722648"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35722340">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/inside-the-struggle-to-make-lab-grown-meat-12cf46ab"
              >The Struggle to Make Lab-Grown Meat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-27 @ 01:56:15</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35722340"
                  >Comments</a
                ><span class="descendants">: 164</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35712163">
          <h3>
            <a class="item" href="https://scrapscript.org"
              >Show HN: ScrapScript â€“ A tiny functional language for sharable
              software</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 11:45:38</span
              ><span class="points-container"
                >Points: <span class="points">348</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35712163"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
            <div class="text">
              <p>
                I started casually working on scrapscript in 2015. I built a few
                compilers over the years to test out various
                ideas/implementations, and I think I'm finally happy with the
                overall design.
              </p>
              <p>
                The code is not public yet. Email me at hello@taylor.town if
                you're interested in joining the core team later this year.
              </p>
              <p>Let me know if you have any questions or feedback :)</p>
            </div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
