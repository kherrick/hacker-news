<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43227881">
          <h3>
            <a
              class="item"
              href="https://www.sesame.com/research/crossing_the_uncanny_valley_of_voice"
              >Crossing the uncanny valley of conversational voice</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 06:13:01</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43227881"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43227303">
          <h3>
            <a
              class="item"
              href="https://helloanselm.com/writings/knowing-css-is-mastery-to-frontend-development"
              >Knowing CSS is mastery to Front end Development</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 04:32:06</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43227303"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43227131">
          <h3>
            <a class="item" href="https://whatdidyoudolastweek.biz"
              >Show HN: What did you do last week? – Evaluates your 5 bullet
              points</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 03:57:35</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43227131"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43226089">
          <h3>
            <a class="item" href="https://linuxmom.net/@vkc/114089626244932902"
              >Mozilla site down due to "overdue hosting payments"</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 01:20:17</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43226089"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43225886">
          <h3>
            <a
              class="item"
              href="https://admiralcloudberg.medium.com/passing-the-buck-the-story-of-the-2022-wings-over-dallas-air-show-collision-9bbe5947297b"
              >Passing the Buck: The story of the 2022 Wings Over Dallas air
              show collision</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 00:47:23</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43225886"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43225686">
          <h3>
            <a class="item" href="https://lwn.net/Articles/928581/"
              >The early days of Linux (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 00:18:21</span
              ><span class="points-container"
                >Points: <span class="points">189</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43225686"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43225560">
          <h3>
            <a class="item" href="https://www.flashgamehistory.com/"
              >How Flash games shaped the video game industry (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 00:05:30</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43225560"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43224107">
          <h3>
            <a
              class="item"
              href="https://plus.nasa.gov/scheduled-video/firefly-blue-ghost-mission-1-lunar-landing/"
              >Firefly Blue Ghost Mission 1 Lunar Landing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 21:53:34</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43224107"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43223718">
          <h3>
            <a class="item" href="https://www.swapfest.berlin/"
              >Show HN: Berlin Swapfest – Electronics flea market</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 21:11:26</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43223718"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <p>
                After scrounging the local classifieds and our version of
                Craigslist to find pre-owned equipment and getting frustrated I
                decided that there needs to be a flea market but for electronics
                tools and homelab stuff. The Berlin Swapfest follows in the same
                spirit as the MIT Swapfest!
              </p>
              <p>
                I’ve partners with a long time hacker space in Berlin c-base who
                will be hosting this event!
              </p>
              <p>
                Would love for local hackers to come by and buy and sell their
                old gear!
              </p>
              <p>Details on the site!</p>
            </div>
          </section>
        </section>
        <section id="43223596">
          <h3>
            <a
              class="item"
              href="https://www.euclid-ec.org/einstein-ring-in-ngc-6505/"
              >Euclid finds complete Einstein Ring in NGC galaxy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 20:56:03</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43223596"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43222344">
          <h3>
            <a
              class="item"
              href="https://xnacly.me/posts/2025/json-parser-in-c-with-methods/"
              >Abusing C to implement JSON parsing with struct methods</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 18:53:20</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43222344"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43222168">
          <h3>
            <a class="item" href="https://efabless.com/notice"
              >Efabless – Shutdown Notice</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 18:37:09</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43222168"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43222099">
          <h3>
            <a
              class="item"
              href="https://apps.apple.com/ca/app/painteresque-photo-to-sketch/id6742038583"
              >Show HN: I took over Painteresque, a 14 year old Objective-C app
              and rebuilt it</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 18:30:51</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43222099"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              <p>
                The app is called Painteresque. It lets you turn photos to
                charcoal drawings, paintings etc while doing all the processing
                locally on device:
              </p>
              <p>
                <a
                  href="https://apps.apple.com/ca/app/painteresque-photo-to-sketch/id6742038583"
                  >https://apps.apple.com/ca/app/painteresque-photo-to-sketch/i...</a
                >
              </p>
              <p>
                The app is entirely free to use, has no ads, third party
                analytics, trackers, subscriptions or other junk. It does offer
                5 options for tips (which are basically consumable in app
                purchases), portion of which I will share with the original
                developer. However, based on my past experiences with tips, they
                are rarely given by users.
              </p>
              <p>Here's a screenshot of the OLD app:</p>
              <p>
                <a href="https://i.imgur.com/fPhoqlp.jpeg"
                  >https://i.imgur.com/fPhoqlp.jpeg</a
                >
              </p>
              <p>
                The old app was built like 12-14 years ago in a combination of
                objective c and vanilla C. The "filters" were built in C while
                the UI was in objective c.
              </p>
              <p>
                The codebase was so old that it wasn't even using ARC (Automatic
                Reference Counting).
              </p>
              <p>
                The app would also instantly crash because back in those days,
                using the camera or adding photos to photo library didn't
                require declaring permission things like
                `NSCameraUsageDescription`,
                `NSLocationWhenInUseUsageDescription`.
              </p>
              <p>
                Also had to remove obsolete frameworks to get it to run on
                devices iOS 12 onwards.
              </p>
              <p>
                It was also not built for retina displays, nor handling safe
                area layout guides.
              </p>
              <p>
                After fixing all these things, I got the old app to work on
                phone. But the UI was very rough and rudimentary. Back in those
                days, it would get approved by Apple. But nowadays, Apple is
                very strict about these things.
              </p>
              <p>
                So, I decided to rebuild the app from scratch in Swift with,
                what I think, is a better UI design. I still used the old
                vanilla C code for the filters with some small changes and extra
                filters of my own. But the rest of the UI is all from scratch. I
                also incorporated things like `NSOperationQueue` for background
                processing of the image filtration as it can take a few seconds
                to generate. I incorporated caching of the images, preview
                thumbnails etc. to disk because the current phones have cameras
                which take humongous photos that can use a lot of ram if kept in
                memory.
              </p>
              <p>
                The only package dependency the app uses is SnapKit to make auto
                layout simpler. The UI is made with code instead of storyboards.
              </p>
              <p>
                The App Store screenshots are all made by me from scratch using
                Photopea, a browser alternative to Photoshop. The app icon is
                still the old icon, except I changed the background to be an
                off-white color instead of the old blue color to make it look a
                bit more modern.
              </p>
              <p>
                Overall, this process took about 3 weeks. Most of the important
                work was done in about 1.5-2 weeks. The rest of the time was
                spent adding things like tipping in app purchases, UI
                improvements, tweaking the filters, adding feedback button etc.
              </p>
              <p>
                The App Store review was fast. I submitted at 6:30 PM and it was
                approved at 4 AM. Also got an update approved last night to fix
                some slowness issue when opening new images.
              </p>
              <p>
                The new app on iOS is only around 1.8 MB, most of it used by
                images for the buttons and app icon.
              </p>
              <p>
                Ask me anything you'd like about this experience. Have any of
                you taken over an old app and rebuilt it?
              </p>
            </div>
          </section>
        </section>
        <section id="43222027">
          <h3>
            <a
              class="item"
              href="https://bengarcia.dev/making-o1-o3-and-sonnet-3-7-hallucinate-for-everyone"
              >Making o1, o3, and Sonnet 3.7 hallucinate for everyone</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 18:24:22</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43222027"
                  >Comments</a
                ><span class="descendants">: 173</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43221697">
          <h3>
            <a class="item" href="https://varun.ch/posts/videowall/"
              >The most unhinged video wall, made out of Chromebooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 17:54:55</span
              ><span class="points-container"
                >Points: <span class="points">398</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43221697"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43217195">
          <h3>
            <a
              class="item"
              href="https://amitp.blogspot.com/2025/02/emacs-tree-sitter-custom-highlighting.html"
              >Emacs Tree-sitter custom highlighting</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 08:17:29</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43217195"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43214263">
          <h3>
            <a
              class="item"
              href="https://worksinprogress.co/issue/the-housing-theory-of-everything/"
              >The housing theory of everything (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 00:59:13</span
              ><span class="points-container"
                >Points: <span class="points">274</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43214263"
                  >Comments</a
                ><span class="descendants">: 298</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43212952">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/why-its-so-hard-to-build-a-jet-engine"
              >Why it's so hard to build a jet engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 23:05:21</span
              ><span class="points-container"
                >Points: <span class="points">371</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43212952"
                  >Comments</a
                ><span class="descendants">: 174</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43207831">
          <h3>
            <a
              class="item"
              href="https://josephmate.github.io/2025-02-26-3200p-cpu-util/"
              >3,200% CPU Utilization</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 17:01:43</span
              ><span class="points-container"
                >Points: <span class="points">469</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43207831"
                  >Comments</a
                ><span class="descendants">: 207</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43205968">
          <h3>
            <a
              class="item"
              href="https://www.oddbird.net/2025/02/12/fluid-type/"
              >Reimagining Fluid Typography</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 14:28:26</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43205968"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43204032">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-02-drone-captures-narwhals-tusks-explore.html"
              >Drone captures narwhals using their tusks to explore, forage and
              play</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 10:31:00</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43204032"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43203180">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-025-00554-w"
              >'Slime' keeps the brain safe ― and could guard against ageing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 08:31:27</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43203180"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43191773">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/history/rifling-through-archives-legendary-historian-robert-caro-180985956/"
              >Rifling through the archives with Robert Caro</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-27 @ 06:05:46</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43191773"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43191696">
          <h3>
            <a
              class="item"
              href="https://ballingt.com/python-second-language-empathy/"
              >Python as a second language empathy (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-27 @ 05:46:32</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43191696"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43183873">
          <h3>
            <a
              class="item"
              href="http://toughsf.blogspot.com/2019/04/nuclear-reactor-lasers-from-fission-to.html"
              >Nuclear Reactor Lasers: From fission to photon</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-26 @ 14:27:15</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43183873"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43183635">
          <h3>
            <a class="item" href="https://lifeweeks.app/"
              >Show HN: I made a website where you can create your own "Life in
              Weeks" timeline</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-26 @ 13:58:24</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43183635"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43180977">
          <h3>
            <a class="item" href="https://github.com/myanvoos/algoMIDI"
              >AlgoMIDI – A Mathematical 'Music Studio'</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-26 @ 05:40:14</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43180977"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43175793">
          <h3>
            <a class="item" href="https://blog.transparency.dev/ct-in-firefox"
              >Certificate Transparency in Firefox</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 18:52:59</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43175793"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43174453">
          <h3>
            <a class="item" href="https://github.com/mobile-dev-inc/Maestro"
              >Maestro – Next generation mobile UI automation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 17:01:13</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43174453"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43171007">
          <h3>
            <a
              class="item"
              href="https://themicrodose.substack.com/p/what-do-people-see-when-theyre-tripping"
              >What do people see when they're tripping? Analyzing Erowid's trip
              reports</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 12:27:30</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43171007"
                  >Comments</a
                ><span class="descendants">: 195</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
