<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39594687">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2303.15343"
              >Sigmoid Loss for Language Image Pre-Training</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 19:17:17</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39594687"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39594541">
          <h3>
            <a
              class="item"
              href="https://doubleagent.net/telecommunications/backdoor/gtp/2024/02/27/GTPDOOR-COVERT-TELCO-BACKDOOR"
              >Gtpdoor – A novel backdoor tailored for covert access over the
              roaming exchange</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 19:06:18</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39594541"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39594362">
          <h3>
            <a
              class="item"
              href="https://smallcultfollowing.com/babysteps/blog/2024/03/04/borrow-checking-without-lifetimes/"
              >Borrow checking without lifetimes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 18:52:53</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39594362"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39594164">
          <h3>
            <a class="item" href="https://blog.gitbutler.com/git-worktrees/"
              >Git Worktrees and GitButler</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 18:38:45</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39594164"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39593647">
          <h3>
            <a
              class="item"
              href="https://twitter.com/oatmealdome/status/1764704580724576465"
              >Yuzu emulator developers settle Nintendo lawsuit, pay $2.4M in
              damages</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 18:00:26</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39593647"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39593256">
          <h3>
            <a class="item" href="https://opus-codec.org/demo/opus-1.5/"
              >Opus 1.5 released: Opus gets a machine learning upgrade</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 17:36:42</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39593256"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39593008">
          <h3>
            <a class="item" href="https://github.com/harshadmanglani/polaris"
              >Show HN: Workflow orchestrator in Golang</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 17:21:42</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39593008"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>Would love to hear your thoughts and feedback!</p>
            </div>
          </section>
        </section>
        <section id="39592993">
          <h3>
            <a
              class="item"
              href="https://www.surfertoday.com/surfing/the-woman-who-coined-the-expression-surfing-the-internet"
              >The women who coined the expression 'surfing the internet'
              (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 17:20:34</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39592993"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39592771">
          <h3>
            <a
              class="item"
              href="https://www.ubicloud.com/blog/improving-network-performance-with-linux-flowtables"
              >Improving Network Performance with Linux Flowtables</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 17:05:46</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39592771"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39592704">
          <h3>
            <a class="item" href="https://skio.com/careers/"
              >Skio (YC S20) – Subscriptions for Shopify, ReCharge migrations
              – Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 17:00:14</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39592689">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/pc-components/gpus/nvidia-bans-using-translation-layers-for-cuda-software-to-run-on-other-chips-new-restriction-apparently-targets-zluda-and-some-chinese-gpu-makers"
              >Nvidia bans using translation layers for CUDA software to run on
              other chips</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 16:58:51</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39592689"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39592499">
          <h3>
            <a
              class="item"
              href="https://www.futureflight.aero/news-article/2024-02-27/us-air-force-evaluating-pivotals-blackfly-ultralight-evtol-aircraft"
              >U.S. Air Force Evaluating Pivotal's Blackfly Ultralight EVTOL
              Aircraft</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 16:46:53</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39592499"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39592444">
          <h3>
            <a class="item" href="https://www.hillelwayne.com/post/graph-types/"
              >The hunt for the missing data type</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 16:42:14</span
              ><span class="points-container"
                >Points: <span class="points">234</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39592444"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39592288">
          <h3>
            <a
              class="item"
              href="https://www.macstories.net/stories/macpad-how-i-created-the-hybrid-mac-ipad-laptop-and-tablet-that-apple-wont-make/"
              >MacPad: I created the hybrid Mac-iPad laptop and tablet that
              Apple won't make</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 16:30:55</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39592288"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39591972">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39591972"
              >Launch HN: Just words (YC W24) – Optimize your product's copy for
              user growth</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 16:03:45</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39591972"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <a href="https://justwords.ai">https://justwords.ai</a>). We help
              companies gain users through product copy optimization across any
              app surface or webpage, using inferences from past performance
              data. Here’s a demo video:
              <a href="https://youtu.be/e6PuRzHad7M"
                >https://youtu.be/e6PuRzHad7M</a
              >, and a live playground:
              <a href="https://justwords.ai/live-demo"
                >https://justwords.ai/live-demo</a
              >.
              <p>
                “Copy” in this context means short-form content such as landing
                page titles or email subject lines. Small and seemingly
                insignificant changes to these can lead to massive growth gains.
                We observed this on many occasions while working at Twitter.
                Tweaking a push notification copy from “Jack tweeted” to “Jack
                just Tweeted” brought 800K additional users to Twitter.
              </p>
              <p>
                However, coming up with the copy, testing it, and optimizing
                different variants across users would take us forever—sometimes
                months. There was no methodical way to optimize copy on the fly
                and use what we learned for subsequent iterations. The entire
                process was managed ad hoc in docs and spreadsheets.
              </p>
              <p>
                After experiencing this pain at Twitter, we observed the same
                problem at other companies like Reddit. After years of this, we
                are convinced that there’s enough evidence for this pain across
                the industry.
              </p>
              <p>
                In our experience, the main challenges with copy optimization
                are:
              </p>
              <p>
                Engineering effort: Copies are hard-coded, either in code or
                config files. Every small change requires redeployment of the
                app. To run an A/B test, engineers must write if/else logic for
                each variant. As a result, one copy optimization becomes a
                2-week project on an engineer’s roadmap, and companies are only
                able to prioritize a small number of changes a year.
              </p>
              <p>
                Fragmented content: There is no copy repository, so companies
                lose track of the history of changes on a particular string,
                learnings from past experiments, and their occurrences across
                the product. With no systematic view, product teams make copy
                changes based on “vibes”. There is no way to fine-tune next
                iterations based on patterns obtained from previous experiments.
              </p>
              <p>
                Lack of context: Companies either test 1 copy change at a time
                for all users, or rotate a pool of copies randomly. In an ideal
                world, they should be able to present the best copy to different
                users based on their context.
              </p>
              <p>
                We built Just Words to solve these problems through 3 main
                features:
              </p>
              <p>
                No-code copy experimentation: You can change any copy, A/B test
                it, and ship it to production with zero code changes. All copy
                changes made in our UI get published to a dynamic config system
                that controls the production copy and the experimentation logic.
                This is a one-time setup with 3 lines of code. Once it’s done,
                all copy changes and experiments can be done via the UI, without
                code changes, deploys or app releases.
              </p>
              <p>
                Nucleus of all product copy: All product copy versioning,
                experiment learnings, and occurrences across the product are in
                one place. We are also building integrations to copywriting and
                experimentation tools like statsig, so the entire workflow from
                editing to shipping, can be managed and reviewed in one place.
                By storing all this in one place, we draw patterns across
                experiments to infer complex learnings over time and assist with
                future iterations.
              </p>
              <p>
                Smart copy optimization: We run contextual Bayesian optimization
                to automatically decide the best-performing copy across many
                variants. This helps product teams pick the winner in a short
                amount of time with one experiment, instead of running many
                sequential A/B tests.
              </p>
              <p>
                We are opening up our private beta with this launch. Our pricing
                is straightforward - a 60-day refundable pilot for $2000 (use
                discount code: CTJW24), for one of the following use cases:
                landing pages, push notifications, email subject lines, or paid
                ad text. We will show visible growth gains to give you a
                substantial ROI on your pilot and refund the amount if we fail
                to deliver on it. We are inviting companies with &gt;2K monthly
                users to try us out here:
                <a href="https://forms.gle/Q3xthubQFfZcXZe88"
                  >https://forms.gle/Q3xthubQFfZcXZe88</a
                >. (Sorry for the form link! We haven’t built out a signup
                interface yet because our focus is on the core product for the
                time being. We’ll add everything else later.)
              </p>
              <p>
                We would love to get feedback from the HN community on (1) the
                flavor of problems you have experienced in the world of copy
                changes, (2) how your or other companies are solving it (3)
                feedback on the product so far, or (4) anything you’d like to
                share!
              </p>
            </div>
          </section>
        </section>
        <section id="39591772">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/03/04/science/moon-landing-sideways-gravity.html"
              >Why it's so challenging to land upright on the moon</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 15:46:03</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39591772"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39591694">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2311.05063"
              >Rust for Embedded Systems: Current state, challenges and open
              problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 15:38:22</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39591694"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39591529">
          <h3>
            <a class="item" href="https://astro.sshh.io/">Show HN: Astro App</a>
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 15:24:35</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39591529"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
            <div class="text">
              <p>Right now you can:</p>
              <p>View the altitude chart of objects and 3D view</p>
              <p>Create lists of objects of interest</p>
              <p>
                View the annual max/min daily altitude of an object to find the
                best time of year to view
              </p>
              <p>
                See live clouds from GOES satellite view + weekly night-centric
                forecast
              </p>
            </div>
          </section>
        </section>
        <section id="39590852">
          <h3>
            <a
              class="item"
              href="https://theintercept.com/2024/03/04/signal-app-username-phone-number-privacy/"
              >Ephemeral usernames safeguard privacy and make Signal harder to
              subpoena</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 14:24:37</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39590852"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39590683">
          <h3>
            <a class="item" href="https://github.com/rerun-io/revy"
              >Revy – proof-of-concept time-travel debugger for the Bevy game
              engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 14:09:46</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39590683"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39590666">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/news/claude-3-family"
              >Claude 3 model family</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 14:08:51</span
              ><span class="points-container"
                >Points: <span class="points">637</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39590666"
                  >Comments</a
                ><span class="descendants">: 385</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39589924">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2024/03/apple-unveils-the-new-13-and-15-inch-macbook-air-with-the-powerful-m3-chip/"
              >New 13- and 15‑inch MacBook Air with M3 chip</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 13:00:38</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39589924"
                  >Comments</a
                ><span class="descendants">: 388</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39589479">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=-C6AcRnUmbE"
              >I made a bad camera lens from some old glasses [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 12:10:59</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39589479"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39588899">
          <h3>
            <a
              class="item"
              href="https://nhigham.com/2022/05/11/what-is-a-schur-decomposition/"
              >What Is a Schur Decomposition? (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 10:36:14</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39588899"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39588830">
          <h3>
            <a
              class="item"
              href="https://mainlymiles.com/2024/03/03/singapore-airlines-concorde-full-story/"
              >Singapore Airlines Concorde</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 10:21:35</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39588830"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39587344">
          <h3>
            <a
              class="item"
              href="https://heathermeeker.com/2024/02/17/french-court-issues-damages-award-for-violation-of-gpl/"
              >French court issues damages award for violation of GPL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-04 @ 05:40:07</span
              ><span class="points-container"
                >Points: <span class="points">826</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39587344"
                  >Comments</a
                ><span class="descendants">: 360</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39579725">
          <h3>
            <a
              class="item"
              href="https://www.anandtech.com/show/21276/intel-previews-sierra-forest-with-288-e-cores-announces-granite-rapids-d-for-2025-launch-at-mwc-2024"
              >Intel Previews Sierra Forest with 288 E-Cores, Announces Granite
              Rapids-D</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 09:46:15</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39579725"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39578796">
          <h3>
            <a class="item" href="http://www.velato.net/"
              >Velato: A programming language where source code must be a valid
              MIDI music file</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-03 @ 05:55:37</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39578796"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39575102">
          <h3>
            <a class="item" href="https://wiki.xxiivv.com/site/uxntal.html"
              >Tal is the programming language for the Uxn virtual machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 19:29:06</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39575102"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39574137">
          <h3>
            <a
              class="item"
              href="https://commoncog.com/what-the-ceo-wants-you-to-know/"
              >What the CEO wants you to know (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-02 @ 17:37:14</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39574137"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
