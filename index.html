<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37858369">
          <h3>
            <a
              class="item"
              href="https://flyte.org/blog/getting-started-with-large-language-models-key-things-to-know#what-are-llms"
              >Want to get started with LLMs? Here's what you need to know</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 15:15:11</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37858369"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37858198">
          <h3>
            <a
              class="item"
              href="https://www.thefp.com/p/the-human-beings-who-live-as-lab"
              >The Humans Who Live as Lab Rats</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 15:03:23</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37858198"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857991">
          <h3>
            <a
              class="item"
              href="https://blog.withedge.com/p/when-xml-in-word-became-illegal"
              >When XML in Word Became Illegal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:49:31</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857991"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857958">
          <h3>
            <a
              class="item"
              href="https://www.thedrive.com/news/new-entry-level-lucid-air-pure-rwd-starts-at-78675-still-offers-410-mile-range"
              >New Entry-Level Lucid Air Pure RWD Starts at $78,675, Still with
              410-Mile Range</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:47:47</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857958"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857765">
          <h3>
            <a class="item" href="https://www.diceright.com/"
              >Show HN: I built a virtual tabletop for playing Dungeons and
              Dragons</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:35:56</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857765"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <a href="https://tinyurl.com/diceright"
                >https://tinyurl.com/diceright</a
              >. And there’s a list of the main features right on the homepage.
              <p>
                It’s a Ruby on Rails site that makes heavy use of action cable
                for keeping the maps and tokens in sync for all players. On the
                front end, I’m using HTML canvas for the maps and a js library
                called fabric.js for interacting with the canvas. Otherwise,
                just jQuery on the front end. I optimized it all to work on
                mobile too.
              </p>
              <p>
                I built this as a side project for fun over of the past couple
                years. It took a lot longer than expected, but it was also a lot
                of fun. I did all the design / UX for it too which was a
                struggle at first but was a great learning experience.
              </p>
              <p>
                Let me know what you think and if you have any questions.
                Thanks!
              </p>
            </div>
          </section>
        </section>
        <section id="37857699">
          <h3>
            <a
              class="item"
              href="https://twitter.com/natfriedman/status/1712470683207532906"
              >Major Breakthrough in the Vesuvius Challenge</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:30:58</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857699"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857564">
          <h3>
            <a
              class="item"
              href="https://www.marketplace.org/shows/marketplace-tech/san-francisco-is-becoming-a-tech-hub-again-y-combinator-ceo-says/"
              >San Francisco is becoming a tech hub again, Y Combinator CEO
              says</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:21:20</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857564"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857544">
          <h3>
            <a class="item" href="https://12factor.net/"
              >The Twelve-Factor App</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:19:46</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857544"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857535">
          <h3>
            <a
              class="item"
              href="https://sixcolors.com/post/2023/10/boox-palma-review-a-phone-shaped-e-reader/"
              >Boox Palma review: A phone-shaped e-reader</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:18:58</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857535"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857521">
          <h3>
            <a
              class="item"
              href="https://www.interconnects.ai/p/ai-research-job-market"
              >The AI research job market shit show (and my experience)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:18:07</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857521"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857417">
          <h3>
            <a class="item" href="https://scrollprize.org/firstletters"
              >First word discovered in unopened Herculaneum scroll by 21yo CS
              student</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:11:18</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857417"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857229">
          <h3>
            <a
              class="item"
              href="https://zitadel.com/blog/migrate-from-keycloak"
              >Migrate Users from Keycloak to Zitadel</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 13:58:38</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857229"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857175">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/health/2023/10/common-red-food-dye-banned-in-calif-30-years-after-fda-found-cancer-risk-in-rats/"
              >The data and puzzling history behind California's new red food
              dye ban</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 13:55:03</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857175"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857017">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37857017"
              >Ask HN: Googlers, Will Google Disable Accounts for Using
              Adblockers on YouTube?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 13:44:46</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857017"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
            <div class="text">
              <p>
                But I got the pop-up this morning saying that adblockers are not
                allowed on YouTube. Fair enough.
              </p>
              <p>
                But it got me wondering: would Google go so far as to disable
                accounts that do this? Losing access to my Google account would
                be bad, even though I have degoogled as much as possible.
              </p>
              <p>
                If Google would do this, I think I'll stop YouTube, which is
                fine too; my account is just too critical at this point. I would
                love if it weren't.
              </p>
              <p>
                So Googlers, whether speaking for yourself and giving your own
                opinion, or officially, would Google do that?
              </p>
              <p>
                For everyone else, would it even be legal for Google to do that?
                Why or why not?
              </p>
            </div>
          </section>
        </section>
        <section id="37856895">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/markets/deals/atlassian-agrees-buy-video-messaging-provider-loom-nearly-1-bln-2023-10-12/"
              >Atlassian to buy Loom for nearly $1B</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 13:33:58</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37856895"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37855719">
          <h3>
            <a
              class="item"
              href="https://www.rit.edu/vignellicenter/product-timecapsule/nasa-capillary-cup"
              >NASA: Capillary Cup</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 11:18:50</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37855719"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37855213">
          <h3>
            <a
              class="item"
              href="https://www.engadget.com/microsoft-reveals-irs-notice-asking-for-289-billion-in-back-taxes-055326006.html"
              >Microsoft reveals IRS notice asking for $28.9B in back taxes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 09:55:51</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37855213"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37855057">
          <h3>
            <a
              class="item"
              href="https://www.tokyoweekender.com/art_and_culture/entertainment-art_and_culture/47-anime-locations-47-prefectures-japan/"
              >47 Anime for 47 Prefectures in Japan</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 09:26:50</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37855057"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854995">
          <h3>
            <a class="item" href="https://git-send-email.io/"
              >Email and Git = &amp;lt;3</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 09:16:14</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37854995"
                  >Comments</a
                ><span class="descendants">: 161</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854846">
          <h3>
            <a class="item" href="https://openintro-ims2.netlify.app/"
              >Introduction to Modern Statistics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 08:45:10</span
              ><span class="points-container"
                >Points: <span class="points">377</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37854846"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854844">
          <h3>
            <a class="item" href="https://nostalgist.js.org/"
              >Show HN: Nostalgist.js – Run emulators of retro consoles, within
              web browsers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 08:44:16</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37854844"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854358">
          <h3>
            <a
              class="item"
              href="https://www.cambridge.org/core/journals/utilitas/article/benthams-mugging/9C67002F344B20661A6C35C960F25A86"
              >Bentham's Mugging (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 07:16:46</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37854358"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854269">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/handle-com/jobs/lgchJ3v-abm-campaigns-manager"
              >Handle.com (YC W19) Is Hiring (ABM Manager)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 07:00:55</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854159">
          <h3>
            <a
              class="item"
              href="https://www.kapwing.com/blog/slacks-google-drive-integration-shares-private-documents/"
              >Slack's Google Drive App can share your private Docs and Drive
              files</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 06:44:17</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37854159"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854115">
          <h3>
            <a
              class="item"
              href="https://github.com/ohler55/ojg/blob/develop/design.md"
              >A Journey building a fast JSON parser and full JSONPath</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 06:36:11</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37854115"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37853434">
          <h3>
            <a class="item" href="https://github.com/declassed-art/armvuan"
              >Armbian and Devuan = Armvuan</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 04:15:36</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37853434"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37853181">
          <h3>
            <a class="item" href="https://metric-time.com/">Metric Time</a>
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 03:27:19</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37853181"
                  >Comments</a
                ><span class="descendants">: 244</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37852711">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37852711"
              >Ask HN: Has anyone gotten complete, permanent relief from
              tinnitus?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 02:10:00</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37852711"
                  >Comments</a
                ><span class="descendants">: 294</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm wondering if any subscribers here have had tinnitus and
                experience <i>permanent relief</i> from the ringing? Not just
                reduction, but actual permanent relief that never comes back
                even when doing things that previously worsened the tinnitus.
              </p>
              <p>
                If you can't tell, I'm trying to establish an "existence proof"
                here, if no one has ever gotten permanent relief then it seems
                like it might not be worth bothering with the "symptom
                reduction" therapies since they would most likely lead to
                focusing on the symptoms more intensely.
              </p>
            </div>
          </section>
        </section>
        <section id="37852135">
          <h3>
            <a
              class="item"
              href="https://www.tumfatig.net/2023/using-openbsd-relayd8-as-an-application-layer-gateway/"
              >Using OpenBSD Relayd(8) as an Application Layer Gateway</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 00:34:59</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37852135"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37850265">
          <h3>
            <a
              class="item"
              href="https://www.indieretronews.com/2023/10/grind-first-person-shooter-for-amiga.html"
              >Grind – A first person shooter for Amiga 500</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-11 @ 21:06:44</span
              ><span class="points-container"
                >Points: <span class="points">293</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37850265"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
