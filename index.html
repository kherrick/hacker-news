<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40739725">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/06/20/oracle_java_licence_teams/"
              >Oracle Java license teams set to begin targeting unknowing Oracle
              users</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 15:19:02</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40739725"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40739431">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40739431"
              >Ask HN: Could AI be a dot com sized bubble?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 14:54:23</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40739431"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <p>
                I do expect the current trajectory of generative models will
                eventually be incredibly important just like the internet was
                and is, but it seems there’s a lot of high expectations of how
                useful it can be in the near future with fuzzy ideas around
                business models like in the dot com era.
              </p>
              <p>
                If these near future expectations don’t pan out, could companies
                slow down their R&amp;D expenditures which are floating NVIDIA,
                Microsoft, et al and lead to a sizable stock market correction?
              </p>
            </div>
          </section>
        </section>
        <section id="40738916">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/news/claude-3-5-sonnet"
              >Claude 3.5 Sonnet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 14:03:46</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40738916"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40738833">
          <h3>
            <a class="item" href="https://github.com/robertdavidgraham/wc2"
              >Wc2: Investigates optimizing 'wc', the Unix word count program</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 13:54:51</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40738833"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40738088">
          <h3><a class="item" href="https://adonisjs.com/">AdonisJS</a></h3>
          <section>
            <h4>
              <span>2024-06-20 @ 12:42:18</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40738088"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40737901">
          <h3>
            <a class="item" href="https://midday.ai"
              >Show HN: Midday – Run your business smarter (open-source)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 12:25:10</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40737901"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
            <div class="text">
              <p>
                It's fully open-source, and we are adopting an open startup
                approach with public metrics.
              </p>
              <p>We'd love to hear your thoughts!</p>
            </div>
          </section>
        </section>
        <section id="40737674">
          <h3>
            <a class="item" href="https://jobs.lever.co/buildzoom"
              >BuildZoom (better way to build custom homes) Is hiring a Growth
              Associate</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 12:00:23</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40737508">
          <h3>
            <a
              class="item"
              href="https://borischerny.com/javascript,/typescript/2024/06/19/ES-Modules-Are-A-Mess.html"
              >NPM and NodeJS should do more to make ES Modules easy to use</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 11:40:26</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40737508"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40737308">
          <h3>
            <a
              class="item"
              href="https://www.propublica.org/article/delusion-advanced-chemical-plastic-recycling-pyrolysis"
              >The Delusion of Advanced Plastic Recycling</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 11:12:36</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40737308"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40737294">
          <h3>
            <a class="item" href="https://erikdemaine.org/fonts/tetris/"
              >Tetris as Font</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 11:11:16</span
              ><span class="points-container"
                >Points: <span class="points">310</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40737294"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40737249">
          <h3>
            <a
              class="item"
              href="https://tritonstation.com/2024/06/18/rotation-curves-still-flat-after-a-million-light-years/"
              >Rotation curves: still flat after a million light-years</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 11:04:07</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40737249"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40736771">
          <h3>
            <a
              class="item"
              href="https://stackdiary.com/eu-council-has-withdrawn-the-vote-on-chat-control/"
              >EU Council has withdrawn the vote on Chat Control</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 09:45:41</span
              ><span class="points-container"
                >Points: <span class="points">577</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40736771"
                  >Comments</a
                ><span class="descendants">: 281</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40736577">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/978463/608c876c1153fd31/"
              >Free software hijacked Philip Hazel's life</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 09:14:25</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40736577"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40735859">
          <h3>
            <a
              class="item"
              href="https://v2thegreat.com/2024/06/19/lessons-learned-from-scaling-to-multi-terabyte-datasets/"
              >Lessons Learned from Scaling to Multi-Terabyte Datasets</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 07:20:38</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40735859"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40735743">
          <h3>
            <a class="item" href="https://doi.org/10.1016/j.jasrep.2024.104636"
              >Oldest white wine in the world found in a first-century tomb in
              Spain</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 06:58:01</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40735743"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40734560">
          <h3>
            <a class="item" href="https://scottaaronson.blog/?p=710"
              >Rosser's Theorem via Turing Machines (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 03:24:41</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40734560"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40733705">
          <h3>
            <a class="item" href="https://osrd.fr/en/"
              >OSRD: Open-Source Railway Designer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-20 @ 00:21:00</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40733705"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40733160">
          <h3>
            <a class="item" href="https://hypermedia.systems/"
              >Hypermedia Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-19 @ 22:39:41</span
              ><span class="points-container"
                >Points: <span class="points">201</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40733160"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40731360">
          <h3>
            <a class="item" href="https://easyos.org/"
              >EasyOS: An experimental Linux distribution</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-19 @ 18:59:40</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40731360"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40729906">
          <h3>
            <a
              class="item"
              href="http://www.chrisfenton.com/1-25-scale-cray-c90-wristwatch/"
              >1/25-scale Cray C90 wristwatch</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-19 @ 16:40:15</span
              ><span class="points-container"
                >Points: <span class="points">359</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40729906"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40729671">
          <h3>
            <a class="item" href="https://www.devever.net/~hl/mildlydynamic"
              >The demise of the mildly dynamic website (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-19 @ 16:17:01</span
              ><span class="points-container"
                >Points: <span class="points">234</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40729671"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40726735">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40726735"
              >Ask HN: What happens when I click "Request for quote" on your
              SaaS?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-19 @ 10:06:54</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40726735"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              How do you come up with the pricing that is offered to me on your
              enterprise plan?
            </div>
          </section>
        </section>
        <section id="40725970">
          <h3>
            <a
              class="item"
              href="https://blog.jgc.org/2024/06/two-ways-to-use-led-as-light-sensor.html"
              >Two ways to use an LED as a light sensor with Arduino</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-19 @ 08:02:13</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40725970"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40725924">
          <h3>
            <a
              class="item"
              href="https://science.nasa.gov/missions/hubble/nasa-releases-hubble-image-taken-in-new-pointing-mode/"
              >NASA Releases Hubble Image Taken in New Pointing Mode Using Only
              Single Gyro</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-19 @ 07:53:34</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40725924"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40722784">
          <h3>
            <a
              class="item"
              href="https://hakaimagazine.com/videos-visuals/rice-farming-gets-an-ai-upgrade/"
              >Agricultural drones are transforming rice farming in the Mekong
              River delta</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-18 @ 22:32:37</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40722784"
                  >Comments</a
                ><span class="descendants">: 196</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40717398">
          <h3>
            <a class="item" href="https://www.radius.to"
              >Show HN: Radius – A Meetup.com alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-18 @ 13:08:15</span
              ><span class="points-container"
                >Points: <span class="points">292</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40717398"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
            <div class="text">
              <p>What can you do on Radius?</p>
              <p>
                - Want to create a group, post events and gather RSVPs? You're
                covered!
              </p>
              <p>- Want event discovery? Coming soon™!</p>
              <p>
                I'm a software engineer based in the UK. My first attempt to
                make this failed spectacularly when I hired a budget dev years
                ago to "build an MVP" when I had next to no knowledge of
                software development. So naturally, I changed my career and
                learned how to build it myself.
              </p>
              <p>
                I wanted to build something that made it easy to find out what
                was happening around you. We have all these platforms focused on
                ticketing, meetups, and other event types - but they're all
                niche enough that they each only list a fragment of what's going
                on around us. Then you have another subset of groups which host
                their own website/mailing list and may only advertise an event
                on -insert social network- and you never know about it until
                it's too late.
              </p>
              <p>The issue I have with existing platforms:</p>
              <p>
                - Meetup excludes too many groups by not offering a free tier
                for smaller/non-profit groups which make up for a huge number of
                small communities. So many groups just end up dying because one
                person has to pay the fees. Then there's the fact that their
                search experience is just terrible. FWIW, I also think they have
                a marketing issue with the name Meetup.
              </p>
              <p>
                - Eventbrite does ticketing pretty well, but completely failed
                to develop the group/community aspect and doesn't seem to have
                put much emphasis on the discovery of events either. They, like
                Meetup, only attract a certain subset of groups/events as well.
              </p>
              <p>
                So, it feels like there's an opportunity to fill the gap with
                something that focuses on a wider range of events/groups and
                emphasises discovery and community. There's so much activity
                happening around us in the real world - and that's what I'd
                eventually like Radius to capture.
              </p>
              <p>
                I'm aware that the discovery app category falls into the list of
                "YC honeypot ideas" but in the time that I've cared about this,
                nobody has built the thing I wanted to exist, damn it (Maybe
                that's a sign NOT to build it..).
              </p>
              <p>
                At best, people might find this useful and at worst, it's been a
                fantastic learning experience.
              </p>
              <p>--</p>
              <p>Feedback -</p>
              <p>
                There are a bunch of groups using it for events at the moment,
                and they've given great feedback to date. I haven't advertised
                it much though, so this is my attempt at gathering the next wave
                of feedback. Feel free to:
              </p>
              <p>
                - Try it out: See if Radius works for your groups and events.
              </p>
              <p>
                - Give feedback: Let me know what you think and how we can
                improve.
              </p>
              <p>
                - Request features: Tell me what features would make Radius even
                better.
              </p>
              <p>Thanks!</p>
              <p>
                Link:-
                <a href="https://www.radius.to/">https://www.radius.to/</a>
              </p>
              <p>
                Example group:-
                <a href="https://www.radius.to/groups/toronto-ruby"
                  >https://www.radius.to/groups/toronto-ruby</a
                >
              </p>
              <p>
                Example event:-
                <a
                  href="https://www.radius.to/groups/toronto-ruby/events/s1tczn2usqf5"
                  >https://www.radius.to/groups/toronto-ruby/events/s1tczn2usqf...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="40717126">
          <h3>
            <a class="item" href="https://www.carabinercollection.com/"
              >Carabiner Collection</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-18 @ 12:40:32</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40717126"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40716032">
          <h3>
            <a
              class="item"
              href="https://tech.marksblogg.com/yolo-umbra-sar-satellites-ship-detection.html"
              >Satellites Spotting Ships</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-18 @ 10:29:49</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40716032"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40716031">
          <h3>
            <a
              class="item"
              href="https://ocw.mit.edu/courses/18-098-street-fighting-mathematics-january-iap-2008/"
              >Street-Fighting Mathematics (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-18 @ 10:29:23</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40716031"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40712359">
          <h3>
            <a
              class="item"
              href="https://www.npr.org/2024/06/10/1247296780/screen-apnea-why-screens-cause-shallow-breathing"
              >What happens to our breath when we type, tap, scroll</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-17 @ 23:23:09</span
              ><span class="points-container"
                >Points: <span class="points">265</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40712359"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
