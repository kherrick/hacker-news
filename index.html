<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43105961">
          <h3>
            <a
              class="item"
              href="https://www.rnz.co.nz/news/national/542294/who-still-has-a-landline-phone"
              >Kids Love Landline Phones</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 19:01:15</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43105961"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43105959">
          <h3>
            <a
              class="item"
              href="https://blog.btcpayserver.org/case-study-unbank/"
              >Building a Bitcoin Exchange with FOSS BTC Pay Server</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 19:01:03</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43105959"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43105950">
          <h3>
            <a
              class="item"
              href="https://www.psypost.org/physical-attractiveness-outweighs-intelligence-in-daughters-and-parents-mate-choices/"
              >Physical attractiveness outweighs intelligence in decision
              making</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 19:00:31</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43105950"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43105444">
          <h3>
            <a class="item" href="https://typst.app/blog/2025/typst-0.13/"
              >Typst 0.13 is out now</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 18:22:09</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43105444"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43105357">
          <h3>
            <a
              class="item"
              href="https://www.inversecos.com/2025/02/an-inside-look-at-nsa-equation-group.html"
              >An inside look at NSA tactics, techniques and procedures from
              China's lens</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 18:16:06</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43105357"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43105035">
          <h3>
            <a
              class="item"
              href="https://www.courthousenews.com/bill-prohibiting-police-from-lying-to-children-passes-virginia-senate/"
              >Bill prohibiting police from lying to children passes Virginia
              Senate</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 17:49:11</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43105035"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43105028">
          <h3>
            <a class="item" href="https://jazco.dev/2025/02/19/imperfection/"
              >When imperfect systems are good: Bluesky's lossy timelines</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 17:48:08</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43105028"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43105014">
          <h3>
            <a
              class="item"
              href="https://forum.watmm.com/announcement/67-the-future-of-watmm-please-read/"
              >The Future of WATMM</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 17:47:15</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43105014"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43104400">
          <h3>
            <a
              class="item"
              href="https://x.com/danielhanchen/status/1891194528931209644"
              >Unsloth AI (YC S24) is hiring ML engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 17:00:42</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43104071">
          <h3>
            <a
              class="item"
              href="https://azure.microsoft.com/en-us/blog/quantum/2025/02/19/microsoft-unveils-majorana-1-the-worlds-first-quantum-processor-powered-by-topological-qubits/"
              >Microsoft unveils Majorana 1 quantum processor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 16:35:51</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43104071"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43103604">
          <h3>
            <a
              class="item"
              href="https://peter.horne-khan.com/relaxed-radix-balanced-trees/"
              >Relaxed Radix Balanced Trees (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 16:05:10</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43103604"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43103073">
          <h3>
            <a class="item" href="https://github.com/mastra-ai/mastra"
              >Show HN: Mastra – Open-source JS agent framework, by the
              developers of Gatsby</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 15:25:08</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43103073"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
            <div class="text">
              <a href="https://mastra.ai">https://mastra.ai</a>), an open-source
              JavaScript SDK for building agents on top of Vercel’s AI SDK.
              <p>
                You can start a Mastra project with `npm create mastra` and
                create workflow graphs that can suspend/resume, build a RAG
                pipeline and write evals, give agents memory, create multi-agent
                workflows, and view it all in a local playground.
              </p>
              <p>
                Previously, we built Gatsby, the open-source React web
                framework. Later, we worked on an AI-powered CRM but it felt
                like we were having to roll all the AI bits (agentic workflows,
                evals, RAG) ourselves. We also noticed our friends building AI
                applications suffering from long iteration cycles: they were
                getting stuck debugging prompts, figuring out why their agents
                called (or didn’t call) tools, and writing lots of custom memory
                retrieval logic.
              </p>
              <p>
                At some point we just looked at each other and were like, why
                aren't we trying to make this part easier, and decided to work
                on Mastra.
              </p>
              <p>
                Demo video:
                <a href="https://www.youtube.com/watch?v=8o_Ejbcw5s8"
                  >https://www.youtube.com/watch?v=8o_Ejbcw5s8</a
                >
              </p>
              <p>
                One thing we heard from folks is that seeing input/output of
                every step, of every run of every workflow, is very useful. So
                we took XState and built a workflow graph primitive on top with
                OTel tracing. We wrote the APIs to make control flow explicit:
                `.step()` for branching, `.then()` for chaining, and `.after()`
                for merging. We also added .`.suspend()/.resume()` for
                human-in-the-loop.
              </p>
              <p>
                We abstracted the main RAG verbs like `.chunk()`, `embed()`,
                `.upsert(),’ `.query()`, and `rerank()` across document types
                and vector DBs. We shipped an eval runner with evals like
                completeness and relevance, plus the ability to write your own.
              </p>
              <p>
                Then we read the MemGPT paper and implemented agent memory on
                top of AI SDK with a `lastMessages` key, `topK` retrieval, and a
                `messageRange` for surrounding context (think `grep -C`).
              </p>
              <p>
                But we still weren’t sure whether our agents were behaving as
                expected, so we built a local dev playground that lets you curl
                agents/workflows, chat with agents, view evals and traces across
                runs, and iterate on prompts with an assistant. The playground
                uses a local storage layer powered by libsql (thanks Turso
                team!) and runs on localhost with `npm run dev` (no Docker).
              </p>
              <p>
                Mastra agents originally ran inside a Next.js app. But we
                noticed that AI teams’ development was increasingly decoupled
                from the rest of their organization, so we built Mastra so that
                you can also run it as a standalone endpoint or service.
              </p>
              <p>
                Some things people have been building so far: one user automates
                support for an iOS app he owns with tens of thousands of paying
                users. Another bundled Mastra inside an Electron app that
                ingests aerospace PDFs and outputs CAD diagrams. Another is
                building WhatsApp bots that let you chat with objects like your
                house.
              </p>
              <p>
                We did (for now) adopt an Elastic v2 license. The agent space is
                pretty new, and we wanted to let users do whatever they want
                with Mastra but prevent, eg, AWS from grabbing it.
              </p>
              <p>
                If you want to get started: - On npm: npm create mastra@latest -
                Github repo:
                <a href="https://github.com/mastra-ai/mastra"
                  >https://github.com/mastra-ai/mastra</a
                >
                - Demo video:
                <a href="https://www.youtube.com/watch?v=8o_Ejbcw5s8"
                  >https://www.youtube.com/watch?v=8o_Ejbcw5s8</a
                >
                - Our website homepage:
                <a href="https://mastra.ai">https://mastra.ai</a> (includes some
                nice diagrams and code samples on agents, RAG, and links to
                examples) - And our docs:
                <a href="https://mastra.ai/docs">https://mastra.ai/docs</a>
              </p>
              <p>
                Excited to share Mastra with everyone here – let us know what
                you think!
              </p>
            </div>
          </section>
        </section>
        <section id="43102528">
          <h3>
            <a
              class="item"
              href="https://research.google/blog/accelerating-scientific-breakthroughs-with-an-ai-co-scientist/"
              >Accelerating scientific breakthroughs with an AI co-scientist</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 14:32:54</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43102528"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43102491">
          <h3>
            <a
              class="item"
              href="https://www.openculture.com/2025/02/hear-the-jazz-funk-musical-adaptation-of-dune-by-david-matthews-1977.html"
              >1977 Jazz-Funk Musical Adaptation of Dune</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 14:29:11</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43102491"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43102284">
          <h3>
            <a
              class="item"
              href="https://cloud.google.com/blog/topics/threat-intelligence/russia-targeting-signal-messenger"
              >Multiple Russia-aligned threat actors actively targeting Signal
              Messenger</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 14:05:23</span
              ><span class="points-container"
                >Points: <span class="points">282</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43102284"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43101430">
          <h3>
            <a
              class="item"
              href="https://www.ubicloud.com/blog/debugging-hetzner-uncovering-failures-with-powerstat-sensors-and-dmidecode"
              >Debugging Hetzner: Uncovering failures with powerstat, sensors,
              and dmidecode</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 12:40:58</span
              ><span class="points-container"
                >Points: <span class="points">237</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43101430"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43101383">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/broken-legs-and-ankles-heal-better-if-you-walk-on-them-within-weeks/"
              >Broken Legs and Ankles Heal Better If You Walk on Them Within
              Weeks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 12:36:06</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43101383"
                  >Comments</a
                ><span class="descendants">: 140</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43098705">
          <h3>
            <a
              class="item"
              href="https://www.whitehouse.gov/presidential-actions/2025/02/ensuring-accountability-for-all-agencies/"
              >"Ensuring Accountability for All Agencies" – Executive Order</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 04:49:46</span
              ><span class="points-container"
                >Points: <span class="points">316</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43098705"
                  >Comments</a
                ><span class="descendants">: 416</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43098318">
          <h3>
            <a class="item" href="https://jon.bo/posts/daylight-computer-1/"
              >Thoughts on Daylight Computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 03:41:48</span
              ><span class="points-container"
                >Points: <span class="points">244</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43098318"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43097932">
          <h3>
            <a class="item" href="https://saurabhalone.com/blogs/llama3/web"
              >Implementing LLaMA3 in 100 Lines of Pure Jax</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 02:37:10</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43097932"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43096477">
          <h3>
            <a class="item" href="https://github.com/subtrace/subtrace"
              >Show HN: Subtrace – Wireshark for Docker Containers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-18 @ 23:29:17</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43096477"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <a href="https://subtrace.dev">https://subtrace.dev</a>) to let
              you see all incoming and outgoing requests in your backend
              server—like Wireshark, but for Docker containers. It comes with a
              Chrome DevTools-like interface. Check out this video:
              <a href="https://www.youtube.com/watch?v=OsGa6ZwVxdA"
                >https://www.youtube.com/watch?v=OsGa6ZwVxdA</a
              >, and see our docs for examples:
              <a href="https://docs.subtrace.dev">https://docs.subtrace.dev</a>.
              <p>
                Subtrace lets you see every request with full payload, headers,
                status code, and latency details. Tools like Sentry and
                OpenTelemetry often leave out these crucial details, making prod
                debugging slow and annoying. Most of the time, all I want to see
                are the headers and JSON payload of real backend requests, but
                it's impossible to do that in today's tools without excessive
                logging, which just makes everything slower and more annoying.
              </p>
              <p>
                Subtrace shows you every backend request flowing through your
                system. You can use simple filters to search for the requests
                you care about and inspect their details.
              </p>
              <p>
                Internally, Subtrace intercepts all network-related Linux
                syscalls using Seccomp BPF so that it can act as a proxy for all
                incoming and outgoing TCP connections. It then parses HTTP
                requests out of the proxied TCP stream and sends them to the
                browser over WebSocket. The Chrome DevTools Network tab is
                already ubiquitous for viewing HTTP requests in the frontend, so
                we repurposed it to work in the browser like any other app (we
                were surprised that it's just a bunch of TypeScript).
              </p>
              <p>
                Setup is just one command for any Linux program written in any
                language.
              </p>
              <p>
                You can use Subtrace by adding a `subtrace run` prefix to your
                backend server startup command. No signup required. Try for
                yourself:
                <a href="https://docs.subtrace.dev"
                  >https://docs.subtrace.dev</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43096422">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/innovation/how-alice-hamilton-waged-one-woman-campaign-get-lead-out-everything-180985960/"
              >Alice Hamilton waged a one-woman campaign to get the lead out of
              everything</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-18 @ 23:22:22</span
              ><span class="points-container"
                >Points: <span class="points">355</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43096422"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43095811">
          <h3>
            <a class="item" href="https://humane.com/media/humane-hp"
              >HP Acquires Humane's AI Software</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-18 @ 22:15:05</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43095811"
                  >Comments</a
                ><span class="descendants">: 241</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43094260">
          <h3>
            <a
              class="item"
              href="https://github.com/ValveSoftware/source-sdk-2013/commit/0759e2e8e179d5352d81d0d4aaded72c1704b7a9"
              >Valve releases Team Fortress 2 code</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-18 @ 19:57:17</span
              ><span class="points-container"
                >Points: <span class="points">1730</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43094260"
                  >Comments</a
                ><span class="descendants">: 367</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43093939">
          <h3>
            <a
              class="item"
              href="https://www.cea.fr/english/Pages/News/nuclear-fusion-west-beats-the-world-record-for-plasma-duration.aspx"
              >Nuclear fusion: WEST beats the world record for plasma
              duration</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-18 @ 19:26:33</span
              ><span class="points-container"
                >Points: <span class="points">446</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43093939"
                  >Comments</a
                ><span class="descendants">: 431</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43088124">
          <h3>
            <a
              class="item"
              href="https://experience.prfalken.dev/english/subway-poker/"
              >A secret poker game you can play on the subway</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-18 @ 10:37:55</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43088124"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43087944">
          <h3>
            <a
              class="item"
              href="https://www.chiark.greenend.org.uk/~sgtatham/quasiblog/xor/"
              >XOR</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-18 @ 10:02:30</span
              ><span class="points-container"
                >Points: <span class="points">518</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43087944"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43080445">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/louis-armstrong-jazz-highlife-ghana"
              >How Louis Armstrong shaped the sound of Ghana</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 16:15:48</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43080445"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43077091">
          <h3>
            <a
              class="item"
              href="https://paperstack.com/an_early_social_unnetwork/"
              >An early social un-network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 09:56:55</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43077091"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43066927">
          <h3>
            <a
              class="item"
              href="https://www.projectaria.com/research-kit/?_fb_noscript=1"
              >Meta Project Aria - Smart Glasses Research Kit</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 10:13:31</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43066927"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
