<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35429198">
          <h3>
            <a
              class="item"
              href="https://fas.org/blogs/security/2023/04/volkel-nuclear-weapon-accident/"
              >Was There a U.S. Nuclear Weapons Accident at a Dutch Air Base?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 18:42:57</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35429198"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35428847">
          <h3>
            <a
              class="item"
              href="https://www.zdnet.com/article/pop-os-has-a-complicated-name-but-it-makes-using-linux-so-easy/"
              >Pop_OS has a complicated name but it makes using Linux so easy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 18:20:44</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35428847"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35428568">
          <h3>
            <a
              class="item"
              href="https://jimclair.com/why-paid-masterminds-are-mental/"
              >Why paid masterminds are mental masturbation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 18:05:43</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35428568"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35428379">
          <h3>
            <a
              class="item"
              href="https://www.omglinux.com/star64-is-a-risc-v-single-board-pc/"
              >$70 RISC-V Computer from Pine64 Goes on Sale April 4 – OMG
              Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 17:54:24</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35428379"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35428225">
          <h3>
            <a
              class="item"
              href="https://www.djangoproject.com/weblog/2023/apr/03/django-42-released/"
              >Django 4.2 Released</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 17:47:45</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35428225"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35427769">
          <h3>
            <a
              class="item"
              href="https://www.carexpert.com.au/car-news/tesla-removes-parking-sensors-to-save-money-the-results-are-predictably-terrible"
              >Tesla removes parking sensors, the results are predictably
              terrible</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 17:24:23</span
              ><span class="points-container"
                >Points: <span class="points">367</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35427769"
                  >Comments</a
                ><span class="descendants">: 410</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35427526">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2023/04/03/google-to-cut-down-on-employee-laptops-services-and-staplers-to-save.html"
              >Google to cut down on employee laptops, services and staplers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 17:10:50</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35427526"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35427410">
          <h3>
            <a
              class="item"
              href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2954173"
              >Algorithmic Entities (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 17:04:29</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35427410"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35427343">
          <h3>
            <a class="item" href="https://github.com/hocus-dev/hocus"
              >Show HN: Hocus – self-hosted alternative to GitHub Codespaces
              using Firecracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 17:00:42</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35427343"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35427338">
          <h3>
            <a
              class="item"
              href="https://blog.fontawesome.com/hiring-a-product-designer/"
              >Font Awesome (YC S15) Is Hiring a Remote, US-Based Product
              Designer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 17:00:31</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35426781">
          <h3>
            <a
              class="item"
              href="https://systemsapproach.substack.com/p/was-mpls-traffic-engineering-worthwhile"
              >Was MPLS Traffic Engineering Worthwhile?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 16:32:08</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35426781"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35426679">
          <h3>
            <a
              class="item"
              href="https://twitter.com/jeremyphoward/status/1642726595436883969"
              >Why MMAP in llama.cpp hides true memory usage</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 16:27:09</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35426679"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35426586">
          <h3>
            <a
              class="item"
              href="https://twitter.com/DrJimFan/status/1642921475849203712"
              >Adobe Firefly vs. MidJourney AI image generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 16:23:21</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35426586"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35426482">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35426482"
              >Launch HN: OutSail (YC W23) – Wingsails to reduce cargo ship fuel
              consumption</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 16:18:48</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35426482"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
            <div class="text">
              <a href="https://outsailshipping.com/"
                >https://outsailshipping.com/</a
              >). We’re building a sail the size of a 747 that rolls up into a
              shipping container. When deployed, it will generate thrust from
              the wind to reduce the fuel consumption of a cargo ship. An array
              of these devices will reduce fuel consumption on ships by up to
              20%. These sails are easily stowed and removed to cause no
              interference with cargo operations. Here’s a short video showing
              our prototype:
              <a href="https://www.youtube.com/watch?v=VUpVqzpym54"
                >https://www.youtube.com/watch?v=VUpVqzpym54</a
              >.
              <p>
                Sails powered ships for millennia; but then the convenience of
                energy-dense fuels displaced sails. As ship speeds eventually
                exceeded wind speeds, the consensus became that sails had no
                place in shipping and were relegated to hobbyists and sport.
                Fast forward a century and a half, and maritime shipping, like
                all other industries, is facing a reckoning to mitigate the
                greenhouse gasses produced by their activities.
              </p>
              <p>
                The International Maritime Organization (IMO) has introduced new
                regulations which use a vessel’s Carbon Intensity Indicator
                (CII) to grade ships. This grading scale becomes more aggressive
                over time, and any ship with a poor grade must take corrective
                action. The corrective actions can be as non-invasive as
                reducing speed (aka: slow steaming) or as extreme as a retrofit
                to use a different, cleaner fuel source. This costs millions and
                takes a ship out of commission for months, and it’s difficult to
                ensure your (now more expensive) fuel is available at every port
                of call. Ship owners are hedging their bets that slow steaming
                will dominate their future, with ship order books full to
                reflect the increased capacity needed when containers take 20%
                longer to cross the ocean.
              </p>
              <p>
                Or option three. There is sufficient wind on the ocean to power
                the entire shipping industry, if you’re willing to grab it. Wind
                Assisted Ship Propulsion (WASP) devices can be used as a
                corrective action to improve a vessel’s CII rating, without
                reducing ship speed or changing the route. In other words, a
                return of sails.
              </p>
              <p>
                We are hardware engineers with over two decades of experience
                between us, working at Tesla, SpaceX, JPL, Relativity, and some
                startups. The idea for OutSail came from Arpan and Joseph
                getting coffee after work one day. When we asked each other
                “What would you do if you weren’t building satellites?” maritime
                cargo came up from both sides; Arpan from having studied the
                industry for opportunities to reduce emissions, and Joseph from
                a love of hydrodynamics and maybe too many sea-shanties. Bailey
                and Arpan, meanwhile, had been looking at working on bicycling
                infrastructure. What brought the three of us together was
                actually a Dungeons &amp; Dragons game where we realized we made
                a good team! We settled on OutSail as a good fit for our
                hardware hacking mentality, trading in our druids staffs for
                spanners.
              </p>
              <p>
                Aerodynamically, sails are simply vertical wings. Wind blowing
                across the vessel causes the sail to generate lift and drag, and
                the resultant vector has some forward component to pull the ship
                through the water. However, if the wind comes from an angle too
                close to the direction of travel, there is no thrust. As an
                added complication, the sail only sees the <i>relative</i> wind.
                If the ship travels faster, the wind will appear to come from
                closer and closer to the direction of travel, even if the true
                wind is coming from perpendicular to your course! Despite this,
                standard sails can still produce forward thrust as long as the
                wind is at least 20 degrees off from directly in front of the
                vessel. This is how our sails can still save power, even on a
                fast moving vessel.
              </p>
              <p>
                There are many sail technologies out there. A common question we
                get asked is “Are you going to use flettner rotors/suction
                airfoils?”. Both of these technologies use power supplied by the
                ship to increase the lift produced by a surface; rotor-sails
                spin, and suction airfoils…suck? Each of these have a place,
                especially at low vessel speeds. But our customers ask us for a
                solution that works for container ships cruising at the
                relatively high speed of 22kt. At these speeds, the relative
                wind is almost always ahead of you, so lift/drag becomes more
                important. Powered sails suffer from poor lift/drag, both from
                the high induced drag from very high lift coefficients, and
                system losses from drawing on ship’s power. So no we are not
                going with flettner rotors/suction airfoils. While they are the
                new exciting technology on the block, if you factor in their
                power usage and high drag ratio, they are just not as practical
                as a simple sail.
              </p>
              <p>
                So now that we’ve given a general summary of sailing, it’s time
                to explain how a 747 wing will ever fit inside a 9ft tall cargo
                container. It’s simple really: imagine a tape measure. In a tape
                measure a thin, flexible strip of metal is wound into a spiral.
                Then, when the metal is uncoiled, it naturally returns to its
                original shape. That’s exactly how we plan to make our sails.
                The skin of our sail or the inner spars (we haven’t finalized
                our design) will be made of tape measure like material (2mm
                thick steel) and the wing will be able to extend out of the
                cargo container. The video in the first paragraph explains this
                in a bit more detail.
              </p>
              <p>
                By fitting our sail into a cargo container we allow for our
                device to be installed on any cargo ship right at port. Remember
                how we mentioned that some shippers are ordering a lot more
                ships and some ships are getting retrofitted with new fuel?
                Well, shipyards are backed up for the next 5 years. By making a
                device that requires no shipyard to install, not only will we
                drastically outcompete other retrofit WASP companies in terms of
                deployment cost, but we will be the only company with a product
                shippers can put on their ship without a multiple year wait
                time.
              </p>
              <p>
                Do you have any interesting stories around sailing or wind tech?
                We would love to hear your ideas, experiences, and feedback on
                any and all of the above!
              </p>
            </div>
          </section>
        </section>
        <section id="35425897">
          <h3>
            <a
              class="item"
              href="https://every.to/no-small-plans/how-to-do-hard-things"
              >How to Do Hard Things</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 15:52:47</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35425897"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35424807">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35424807"
              >Ask HN: Who is hiring? (April 2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 15:02:02</span
              ><span class="points-container"
                >Points: <span class="points">212</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35424807"
                  >Comments</a
                ><span class="descendants">: 216</span></span
              >
            </h4>
            <div class="text">
              <i>not</i> an option, include ONSITE.
              <p>
                Please only post if you personally are part of the hiring
                company—no recruiting firms or job boards. One post per company.
                If it isn't a household name, explain what your company does.
              </p>
              <p>
                Commenters: please don't reply to job posts to complain about
                something. It's off topic here.
              </p>
              <p>
                Readers: please only email if you are personally interested in
                the job.
              </p>
              <p>
                Searchers: try
                <a href="https://hnhired.fly.dev">https://hnhired.fly.dev</a>,
                <a href="https://kennytilton.github.io/whoishiring/"
                  >https://kennytilton.github.io/whoishiring/</a
                >,
                <a href="https://hnjobs.emilburzo.com"
                  >https://hnjobs.emilburzo.com</a
                >,
                <a href="https://news.ycombinator.com/item?id=10313519"
                  >https://news.ycombinator.com/item?id=10313519</a
                >.
              </p>
              <p>Don't miss these other fine threads:</p>
              <p>
                <i>Who wants to be hired?</i>
                <a href="https://news.ycombinator.com/item?id=35424805"
                  >https://news.ycombinator.com/item?id=35424805</a
                >
              </p>
              <p>
                <i>Freelancer? Seeking freelancer?</i>
                <a href="https://news.ycombinator.com/item?id=35424806"
                  >https://news.ycombinator.com/item?id=35424806</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="35424805">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35424805"
              >Ask HN: Who wants to be hired? (April 2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 15:02:01</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35424805"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
            <div class="text">
              <p></p>
              <pre><code>  Location:
  Remote:
  Willing to relocate:
  Technologies:
  Résumé/CV:
  Email:
</code></pre>
              Readers: please only email these addresses to discuss work
              opportunities.
            </div>
          </section>
        </section>
        <section id="35424678">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/business/2023/03/30/alibaba-breaks-itself-up-in-six"
              >Alibaba breaks itself up in six</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 14:56:22</span
              ><span class="points-container"
                >Points: <span class="points">237</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35424678"
                  >Comments</a
                ><span class="descendants">: 205</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35423569">
          <h3>
            <a
              class="item"
              href="https://github.com/pandas-dev/pandas/releases/tag/v2.0.0"
              >Pandas 2.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 13:53:28</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35423569"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35421962">
          <h3>
            <a
              class="item"
              href="https://jeremykun.com/2023/04/01/were-knot-friends/"
              >We're Knot Friends</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 11:56:01</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35421962"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35421034">
          <h3>
            <a class="item" href="https://mullvad.net/en/browser"
              >The Mullvad Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 10:11:50</span
              ><span class="points-container"
                >Points: <span class="points">848</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35421034"
                  >Comments</a
                ><span class="descendants">: 291</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35420946">
          <h3>
            <a
              class="item"
              href="https://www.macrumors.com/2023/04/03/apple-stopped-m2-chip-production-1q-2023/"
              >Apple halted M2 chip production in January amid 'plummeting' Mac
              sales</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 09:58:44</span
              ><span class="points-container"
                >Points: <span class="points">357</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35420946"
                  >Comments</a
                ><span class="descendants">: 794</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35420553">
          <h3>
            <a
              class="item"
              href="http://richg42.blogspot.com/2023/04/a-dead-simple-lossless-or-lossy-lz4.html"
              >Near-lossless image formats using ultra-fast LZ codecs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 09:09:24</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35420553"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35419771">
          <h3>
            <a class="item" href="https://pouria.dev/unknown-pleasures"
              >Show HN: Unknown Pleasures, a tiny web experiment with WebGL</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 07:28:01</span
              ><span class="points-container"
                >Points: <span class="points">575</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35419771"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35418303">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/collection/blights-of-the-bookish"
              >An Essay on Diseases Incidental to Literary and Sedentary Persons
              (1768)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 03:42:33</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35418303"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35407578">
          <h3>
            <a
              class="item"
              href="https://daily.jstor.org/what-it-sounds-like-when-doves-cry/"
              >Transcribing bird sound as human speech</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-02 @ 05:47:46</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35407578"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35404505">
          <h3>
            <a
              class="item"
              href="https://www.scmp.com/news/china/science/article/3214761/chinese-scientists-find-clue-bone-regrowth-deer-antler-study"
              >Deer don't regrow antlers the way lower animals regrow limbs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-01 @ 21:56:16</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35404505"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35401895">
          <h3>
            <a
              class="item"
              href="https://www.inverse.com/input/features/tropetrainer-thomas-buchler-torah-software"
              >His software sang the words of God. Then it went silent</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-01 @ 17:03:02</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35401895"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35400671">
          <h3>
            <a
              class="item"
              href="https://www.rogerebert.com/reviews/solaris-1976"
              >Solaris movie review and film summary (1976)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-01 @ 14:43:36</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35400671"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35399221">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=pwGdw0eZVCQ"
              >3Dfx Voodoo Memory Upgrade – 6MB Mod [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-01 @ 11:03:54</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35399221"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
