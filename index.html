<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36980475">
          <h3>
            <a class="item" href="https://www.bbc.com/news/business-66379366"
              >Fitch Downgrades US Debt</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 02:04:36</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36980475"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36980110">
          <h3>
            <a
              class="item"
              href="https://www.natecation.com/life-at-the-margin-credit-card-debt/"
              >Life at the Margin: How I got $25,000 in debt</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 01:14:26</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36980110"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36980082">
          <h3>
            <a
              class="item"
              href="https://www.cpomagazine.com/cyber-security/over-200000-compromised-openai-credentials-available-for-purchase-on-the-dark-web/"
              >200k Compromised OpenAI Credentials Available for Purchase on the
              Dark Web</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 01:10:58</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36980082"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36979886">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2308.01192"
              >Observation of zero resistance above 100 K in Pb₁₀₋ₓCuₓ(PO₄)₆O</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 00:43:14</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36979886"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36979532">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/security/2023/08/microsoft-cloud-security-blasted-for-its-culture-of-toxic-obfuscation/"
              >Microsoft comes under blistering criticism for “grossly
              irresponsible” security</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 23:56:33</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36979532"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36979190">
          <h3>
            <a
              class="item"
              href="https://ergodicityeconomics.com/2023/07/28/the-infamous-coin-toss/"
              >The infamous coin toss</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 23:15:23</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36979190"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36978931">
          <h3>
            <a class="item" href="http://mkweb.bcgsc.ca/fun/hdtr/"
              >High Dynamic Time Range Images (2006)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 22:50:33</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36978931"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36978350">
          <h3>
            <a class="item" href="https://exptv.org/"
              >EXP TV – endless stream of obscure media and video ephemera</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 22:05:04</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36978350"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36978199">
          <h3>
            <a
              class="item"
              href="https://www.eurekalert.org/news-releases/997141"
              >New targeted chemotherapy able to kill all solid tumors in
              preclinical research</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 21:54:40</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36978199"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36977863">
          <h3>
            <a
              class="item"
              href="https://www.meta.com/en-gb/blog/quest/reality-labs-research-display-systems-siggraph-2023-butterscotch-varifocal-flamera/"
              >Meta’s Reality Labs prototype hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 21:31:24</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36977863"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36977624">
          <h3>
            <a
              class="item"
              href="https://blog.persistent.info/2023/08/infinite-mac-cd-roms.html"
              >Infinite Mac: Disks, CD-ROMs and custom instances</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 21:17:15</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36977624"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36976670">
          <h3>
            <a
              class="item"
              href="https://daverupert.com/2023/07/why-not-webcomponents/"
              >If Web Components are so great, why am I not using them?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 20:13:42</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36976670"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36975701">
          <h3>
            <a
              class="item"
              href="https://docs.fcc.gov/public/attachments/DA-23-652A1.txt"
              >FCC allows blocking traffic from robocall-friendly provider One
              Owl</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 19:17:07</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36975701"
                  >Comments</a
                ><span class="descendants">: 170</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36974681">
          <h3>
            <a
              class="item"
              href="https://twitter.com/lipez400/status/1686793608626663441"
              >LK-99: Team of Southeast University observed zero resistance
              below 110 K</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 18:14:04</span
              ><span class="points-container"
                >Points: <span class="points">552</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36974681"
                  >Comments</a
                ><span class="descendants">: 305</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36974082">
          <h3>
            <a
              class="item"
              href="https://pluralistic.net/2023/07/31/seize-the-means-of-computation/#the-internet-con"
              >Kickstarting a book to end enshittification, because Amazon will
              not carry it</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 17:34:18</span
              ><span class="points-container"
                >Points: <span class="points">286</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36974082"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36973807">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/b9582d62-cc6f-4b76-b0f9-5b37cf15dce4"
              >Companies with good ESG scores pollute as much as low-rated
              rivals</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 17:16:31</span
              ><span class="points-container"
                >Points: <span class="points">271</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36973807"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36973584">
          <h3>
            <a
              class="item"
              href="https://ollama.ai/blog/run-llama2-uncensored-locally"
              >Run Llama 2 uncensored locally</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 17:00:49</span
              ><span class="points-container"
                >Points: <span class="points">622</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36973584"
                  >Comments</a
                ><span class="descendants">: 187</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36973287">
          <h3>
            <a
              class="item"
              href="https://fedoramagazine.org/coming-soon-fedora-for-apple-silicon-macs/"
              >Coming Soon: Fedora for Apple Silicon Macs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 16:40:17</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36973287"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36972398">
          <h3>
            <a class="item" href="https://github.com/reflex-dev/reflex"
              >Reflex – Web apps in pure Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:40:04</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36972398"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36972347">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/blog/audiocraft-musicgen-audiogen-encodec-generative-ai-audio/"
              >Open-sourcing AudioCraft: Generative AI for audio</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:36:31</span
              ><span class="points-container"
                >Points: <span class="points">809</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36972347"
                  >Comments</a
                ><span class="descendants">: 291</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36971975">
          <h3>
            <a
              class="item"
              href="https://praveshkoirala.com/2023/06/13/a-non-mathematical-introduction-to-kalman-filters-for-programmers/"
              >A non-mathematical introduction to Kalman filters for
              programmers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:11:48</span
              ><span class="points-container"
                >Points: <span class="points">457</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36971975"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36971888">
          <h3>
            <a
              class="item"
              href="https://chargebackstop.com/blog/card-networks-exploitation/"
              >The underground world of credit card network exploitation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:05:16</span
              ><span class="points-container"
                >Points: <span class="points">418</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36971888"
                  >Comments</a
                ><span class="descendants">: 226</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36970135">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36970135"
              >Launch HN: Certainly Health (YC S23) – Book doctors without
              surprise bills</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 12:45:59</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36970135"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
            <div class="text">
              <a href="https://certainlyhealth.com/"
                >https://certainlyhealth.com/</a
              >), a marketplace that lets you shop for doctors and compare your
              out-of-pocket costs upfront (currently only in NYC). Using each
              patient's insurance and machine learning, we predict and guarantee
              out-of-pocket costs to prevent surprise bills.
              <p>
                We grew up in immigrant families, and for both of us, our
                parents would honestly tell us to not trust doctors because of
                unexpected medical bills. They really believed that doctors were
                adding on unnecessary things that didn’t help in order to make
                more money. As adults, we’ve both had first-hand experiences
                receiving surprise bills even with good insurance while working
                at tech companies, so solving this problem is personal to us.
              </p>
              <p>
                It turns out 38% of Americans delay medical care for fear of the
                bill while prices vary 2-10x across health providers, even when
                using insurance. This led us to believe that creating a
                marketplace with transparent out-of-pocket costs could be a
                solution.
              </p>
              <p>
                However, it wasn’t until the July 2022 Transparency in Coverage
                Rule (<a
                  href="https://www.cms.gov/healthplan-price-transparency"
                  >https://www.cms.gov/healthplan-price-transparency</a
                >) that we had the payer pricing data (that’s actually high
                quality compared to hospital data) to create this marketplace.
                Certainly is the first company to use this data to predict and
                guarantee prices for consumers to book doctors.
              </p>
              <p>
                We know the HN community has been interested in applications of
                healthcare price transparency data (<a
                  href="https://news.ycombinator.com/item?id=32738783"
                  >https://news.ycombinator.com/item?id=32738783</a
                >), so we’re excited to share how we’re using this data to
                predict and guarantee prices for a consumer application.
              </p>
              <p>
                With Certainly, patients can enter their insurance, compare
                guaranteed out-of-pocket costs across doctors, and book an
                appointment with price transparency. For providers, we guarantee
                any patient we send them will always pay. Partner providers pay
                us any time we send them a new patient. Eventually, we’ll
                convert providers to using our SaaS platform to guarantee
                payments from existing patients.
              </p>
              <p>
                We are currently focused on shoppable services - anything that
                can be scheduled in advance. Our solution falls between two ends
                of the spectrum for consumer shopping experiences. At one end is
                healthcare, where the status quo is you go to a doctor and you
                have no idea what will happen and you have no idea how much it
                will cost. At the other end is going to a restaurant, having a
                menu of items with corresponding prices, and deciding which
                items you want to order.
              </p>
              <p>
                Certainly Health lets you see what services could happen during
                your visit and how much they will cost. We guarantee that if
                those services happen, you will not pay more than the
                out-of-pocket costs you saw upfront for each of those services.
                But it is ultimately the doctor who decides which services you
                end up getting (like a chef deciding which dishes you will be
                served). As a result, you can compare upfront out-of-pocket
                costs specific to your insurance and book a provider without
                worrying about surprise bills.
              </p>
              <p>
                A common misconception is that patient out-of-pocket costs are
                set by doctors. Prices of healthcare services are actually the
                result of negotiations between providers and insurance
                companies. Groups with more negotiating power, like large
                hospital systems, are able to command higher rates than private
                practice physicians. This variance in cost is enormous across
                almost all procedures we've looked at, even between providers a
                few blocks from each other. It might cost $105 to get an
                orthopedic consultation with one doctor, and $550 to get a
                consultation with another doctor across the street, for example.
                This price variance means the out-of-pocket cost also varies for
                patients with high deductible plans or plans where the copay
                does not cover all services (which we’ve encountered very
                often).
              </p>
              <p>
                We do not use hospital price data which is inconsistent and
                messy (<a
                  href="https://www.kff.org/health-costs/press-release/analysis-inconsistencies-within-hospital-price-transparency-data-make-cost-comparisons-difficult/"
                  >https://www.kff.org/health-costs/press-release/analysis-inco...</a
                >). Instead, our guaranteed prices are based on three things:
                (1) health insurance published rates for procedures, as required
                by regulation; (2) patient eligibility/benefits information
                (e.g. deductible, copay, coinsurance); and (3) an online
                learning model to account for variance across thousands of plans
                and patient conditions.
              </p>
              <p>
                As we process payments and claims, we create an accurate
                platform for predicting out-of-pocket costs by accounting for
                variations such as whether certain procedures are covered by an
                insurance plan/copay, and how the rate changes based on
                diagnosis code (we discovered V97.33XD is for "Sucked into jet
                engine, subsequent encounter”), number of units, medical coding
                modifiers, and other factors.
              </p>
              <p>
                Certainly is currently available in NYC where you can choose
                from over 5k doctors to book without surprise bills for free at
                <a href="https://certainlyhealth.com/"
                  >https://certainlyhealth.com/</a
                >. We plan to expand to other cities once we prove that we can
                establish a low CAC on both the supply and demand sides in NYC.
              </p>
              <p>
                Although we’re early, we’re starting to see intended results.
                One patient saved $850 on a podiatrist visit booked through us
                compared to a previous visit with a different doctor for the
                exact same services. Another was charged for an annual physical,
                but we identified the mistake and got a refund issued to him.
                Most of our customers have had surprise bills in the past and
                are happy to have peace of mind with our upfront, guaranteed
                prices.
              </p>
              <p>
                We’d love to hear your ideas, experiences, feedback and any
                feature requests!
              </p>
            </div>
          </section>
        </section>
        <section id="36965144">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-08-intermediate-polars-astronomers.html"
              >Two intermediate polars investigated by astronomers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 00:14:15</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36965144"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36961201">
          <h3>
            <a
              class="item"
              href="https://kevinbinz.com/2022/06/12/the-evolution-of-senescence/"
              >The Evolution of Senescence (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 19:23:02</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36961201"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36960800">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=Lk_57TP6RFk"
              >How pencils are made in a Japanese factory [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 18:59:55</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36960800"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36958008">
          <h3>
            <a
              class="item"
              href="https://ghdi.ghi-dc.org/sub_document.cfm?document_id=2320"
              >Transcript of taped conversations among German nuclear physicists
              (1945)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 16:12:44</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36958008"
                  >Comments</a
                ><span class="descendants">: 170</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36954936">
          <h3>
            <a
              class="item"
              href="https://therealmjp.github.io/posts/shader-permutations-part1/"
              >The Shader Permutation Problem – Part 1: How Did We Get Here?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 12:02:11</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36954936"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36954934">
          <h3>
            <a
              class="item"
              href="https://hackaday.com/2023/08/01/pixel-pump-the-open-source-vacuum-pickup-tool-is-now-shipping/"
              >Pixel Pump, the Open Source Vacuum Pickup Tool Is Now Shipping</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 12:02:03</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36954934"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36953195">
          <h3>
            <a class="item" href="https://oxocard.ch/en/"
              >Oxocards: Interactive programmable minicomputers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 07:01:17</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36953195"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
