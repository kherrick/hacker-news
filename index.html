<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45496406">
          <h3>
            <a
              class="item"
              href="https://hugodaniel.com/posts/webgpu-diagnostics/"
              >WebGPU and the Price of Compiling WGSL</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 21:14:51</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45496406"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45496146">
          <h3>
            <a
              class="item"
              href="https://technology.riotgames.com/news/valorants-128-tick-servers"
              >Valorant's 128-Tick Servers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 20:47:25</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45496146"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45495738">
          <h3>
            <a
              class="item"
              href="https://fnands.com/blog/2025/sklearn-mojo-dbscan-inner/"
              >Translating Cython to Mojo, a first attempt</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 20:09:44</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45495738"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45495711">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/ideas/archive/2025/10/ambigrams-words-double-meanings-art/684404/"
              >My Life in Ambigrammia</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 20:07:25</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45495711"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <a href="https://archive.ph/SFi0a">https://archive.ph/SFi0a</a>
            </div>
          </section>
        </section>
        <section id="45494558">
          <h3>
            <a class="item" href="https://developers.openai.com/apps-sdk/"
              >Apps SDK</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 18:27:33</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45494558"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45493718">
          <h3>
            <a class="item" href="https://github.com/openai/chatkit-js"
              >OpenAI ChatKit</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 17:23:20</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45493718"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45493453">
          <h3>
            <a class="item" href="https://up.codes/careers?utm_source=HN"
              >UpCodes (YC S17) is hiring remote engineers across the
              Americas</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 17:01:31</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45493432">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=hS1YqcewH0c"
              >OpenAI DevDay 2025: Opening keynote [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 17:00:05</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45493432"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45493358">
          <h3>
            <a
              class="item"
              href="https://twitter.com/awesomekling/status/1974781722953953601"
              >Ladybird passes the Apple 90% threshold on web-platform-tests</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 16:52:58</span
              ><span class="points-container"
                >Points: <span class="points">613</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45493358"
                  >Comments</a
                ><span class="descendants">: 162</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45493143">
          <h3>
            <a
              class="item"
              href="https://earthsky.org/human-world/1-to-2-starlink-satellites-falling-back-to-earth-each-day/"
              >One to two Starlink satellites are falling back to Earth each
              day</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 16:32:30</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45493143"
                  >Comments</a
                ><span class="descendants">: 199</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45492803">
          <h3>
            <a
              class="item"
              href="https://engineering.fb.com/2025/10/06/developer-tools/openzl-open-source-format-aware-compression-framework/"
              >OpenZL: An open source format-aware compression framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 16:01:58</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45492803"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/facebook/openzl"
                >https://github.com/facebook/openzl</a
              >
              <p>
                <a href="https://arxiv.org/abs/2510.03203"
                  >https://arxiv.org/abs/2510.03203</a
                >
              </p>
              <p><a href="https://openzl.org/">https://openzl.org/</a></p>
            </div>
          </section>
        </section>
        <section id="45492564">
          <h3>
            <a class="item" href="https://getgrapevine.ai/"
              >Launch HN: Grapevine (YC S19) – A company GPT that actually
              works</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 15:39:59</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45492564"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
            <div class="text">
              <a href="https://getgrapevine.ai">https://getgrapevine.ai</a>), a
              knowledge search system for AI agents that connects Slack, GDrive,
              Notion, codebases, and more. Our first app is a company GPT that
              significantly outperforms existing alternatives.
              <p>
                Anyone can setup a Grapevine Slack bot and have it respond to
                and optionally proactively answer questions that require company
                context. Here’s a demo video with examples:
                <a href="https://youtu.be/_nrfbZzvxU8"
                  >https://youtu.be/_nrfbZzvxU8</a
                >
              </p>
              <p>
                We built Grapevine because we were interested in a ChatGPT that
                fully understands your company. We'd tried many of the existing
                tools (including expensive enterprise ones), but while they were
                good at answering “what is X team’s Q4 goal,” they weren’t good
                at the day-to-day questions that actually blocked people.
              </p>
              <p>
                So, our founders and early engineers created a set of 100+
                representative questions, from hard technical questions to
                company-specific knowledge questions. At first, the
                state-of-the-art “enterprise search” products were getting about
                50% of them correct, and our in-house system was getting 35%.
                But as we solved details in data processing, search algorithm,
                and more, we eventually achieved 85%. (For reference, the best
                human score our founders got was 70%)
              </p>
              <p>
                It’s changed the way we work: popular engineering channels that
                have 5+ questions / day are fully answered proactively by AI,
                and people across departments go to the bot first for bug
                reports, incidents, and support tickets. Dozens of our beta
                customers have been consistently surprised by the quality of the
                answers, too.
              </p>
              <p>
                Security is obviously super important for a product like this.
                We will never train on your data. In addition, your data is
                encrypted at rest, in an isolated database from other customers,
                and the system is SOC 2 compliant with regularly scheduled pen
                tests. We built it to Gather’s (<a href="https://gather.town/"
                  >https://gather.town/</a
                >) SOC 2 Type II standards - that’s the original virtual office
                product we launched (and still maintain) out of YC, but we’ve
                since pivoted to Grapevine.
              </p>
              <p>
                We put a lot of effort into making Grapevine easy to set up. You
                can try it now, for free, at
                <a href="https://getgrapevine.ai">https://getgrapevine.ai</a>
              </p>
            </div>
          </section>
        </section>
        <section id="45491621">
          <h3>
            <a class="item" href="https://github.com/jdx/mise/discussions/6564"
              >Mise: Monorepo Tasks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 14:07:46</span
              ><span class="points-container"
                >Points: <span class="points">266</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45491621"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45491609">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/swatson555/8cc36d8d022d7e5cc44a5edb2c4f7d0b"
              >Show HN: Kent Dybvig's Scheme Machine in 400 Lines of C
              (Heap-Memory Model)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 14:06:29</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45491609"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45490549">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/business/amd-signs-ai-chip-supply-deal-with-openai-gives-it-option-take-10-stake-2025-10-06/"
              >AMD signs AI chip-supply deal with OpenAI, gives it option to
              take a 10% stake</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 12:17:59</span
              ><span class="points-container"
                >Points: <span class="points">352</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45490549"
                  >Comments</a
                ><span class="descendants">: 286</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45489999">
          <h3>
            <a class="item" href="https://www.monsterwriter.com"
              >Show HN: I've build a platform for writing technical/scientific
              documents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 10:58:14</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45489999"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45489533">
          <h3>
            <a
              class="item"
              href="https://www.nobelprize.org/prizes/medicine/2025/press-release/"
              >Nobel Prize in Physiology or Medicine 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 09:41:16</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45489533"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45488261">
          <h3>
            <a class="item" href="https://structuredprocrastination.com"
              >Structured Procrastination (1995)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 06:35:36</span
              ><span class="points-container"
                >Points: <span class="points">420</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45488261"
                  >Comments</a
                ><span class="descendants">: 150</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45487771">
          <h3><a class="item" href="https://gem.coop/">Gem.coop</a></h3>
          <section>
            <h4>
              <span>2025-10-06 @ 04:59:39</span
              ><span class="points-container"
                >Points: <span class="points">408</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45487771"
                  >Comments</a
                ><span class="descendants">: 196</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45487519">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/10/05/well/sam-terblanche-virus-death-columbia.html"
              >It's just a virus, the E.R. told him – days later, he was dead</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 03:57:26</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45487519"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45480354">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/business/sharpie-us-production-cost-cutting-d9ba2abd"
              >Sharpie found a way to make pens more cheaply by manufacturing
              them in the U.S.</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 10:01:00</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45480354"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://www.wsj.com/business/sharpie-us-production-cost-cutting-d9ba2abd?st=ZGgTBQ"
                >https://www.wsj.com/business/sharpie-us-production-cost-cutt...</a
              >
              <p>
                <a href="https://archive.ph/hdUzo">https://archive.ph/hdUzo</a>
              </p>
            </div>
          </section>
        </section>
        <section id="45475623">
          <h3>
            <a class="item" href="https://reiner.org/cuckoo-hashing"
              >Cuckoo hashing improves SIMD hash tables (and other hash table
              tradeoffs)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-04 @ 18:45:55</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45475623"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45469376">
          <h3>
            <a
              class="item"
              href="https://windscribe.com/blog/the-vpn-relationship-map/"
              >Who owns Express VPN, Nord, Surfshark? VPN relationships
              explained (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-04 @ 00:30:44</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45469376"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45465824">
          <h3>
            <a
              class="item"
              href="https://www.inkandswitch.com/ink/notes/ink-deformation-review/"
              >Ink deformation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-03 @ 18:01:59</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45465824"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45458050">
          <h3>
            <a class="item" href="https://folklore.org/Mister_Macintosh.html"
              >Mister Macintosh (2004)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-03 @ 02:03:16</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45458050"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45457825">
          <h3>
            <a
              class="item"
              href="https://alvinwan.com/how-to-tile-matrix-multiplication/"
              >How to tile matrix multiplication (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-03 @ 01:37:23</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45457825"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45456965">
          <h3>
            <a class="item" href="https://web.evanchen.cc/napkin.html"
              >Basic Math Textbook: The Napkin Project</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 23:46:40</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45456965"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45452472">
          <h3>
            <a class="item" href="https://jeremymaluf.com/onebag/"
              >Indefinite Backpack Travel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 17:12:23</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45452472"
                  >Comments</a
                ><span class="descendants">: 201</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45451217">
          <h3>
            <a
              class="item"
              href="https://docs.jax.dev/en/latest/pallas/gpu/blackwell_matmul.html"
              >Writing high-performance matrix multiplication kernels for
              Blackwell</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 15:43:01</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45451217"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45449015">
          <h3>
            <a
              class="item"
              href="https://physicsworld.com/a/kirigami-inspired-parachute-falls-on-target/"
              >Kirigami-inspired parachute falls on target</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 12:54:13</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45449015"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
