<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42496104">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2024-12-23/nordstrom-family-to-take-company-private-in-6-25-billion-deal"
              >Nordstrom Family to Take Company Private in $6.25B Deal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 17:38:25</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42496104"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42496032">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/Windows11/comments/1hkkrb0/switched_back_to_windows_after_10_years_and_a/"
              >Switched Back to Windows After over 10 Years on Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 17:31:13</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42496032"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42495936">
          <h3>
            <a
              class="item"
              href="https://www.goodfire.ai/papers/mapping-latent-spaces-llama/"
              >Show HN: Llama 3.3 70B Sparse Autoencoders with API access</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 17:18:17</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42495936"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42495703">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2412.15143"
              >Supernovae Evidence for Foundational Change to Cosmological
              Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 16:44:28</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42495703"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42495683">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=X2UxtKLZnNo"
              >Unitree Robot Off-Road</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 16:41:12</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42495683"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42495473">
          <h3>
            <a class="item" href="https://phrack.org"
              >Phrack 72 "40th Anniversary Edition" Call for Papers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 16:17:32</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42495473"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42495431">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-12-neanderthals-cold-ready-ribcage-reconstruction.html"
              >Neanderthals cold-adapted? Ribcage reconstruction may hold the
              answer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 16:11:28</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42495431"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42495262">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2007/12/10/the-checklist"
              >A Life-Saving Checklist (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 15:53:48</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42495262"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42495077">
          <h3>
            <a
              class="item"
              href="https://blog.fogus.me/2024/12/23/the-best-things-and-stuff-of-2024/"
              >Fogus: Things and Stuff of 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 15:30:35</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42495077"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42494997">
          <h3>
            <a class="item" href="https://keypub.sh/"
              >Show HN: Keypub.sh â€“ OAuth for the terminal using SSH keys</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 15:19:08</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42494997"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              <p>
                - No installation needed - works with existing SSH setup -
                Privacy-focused: users control what email info is shared -
                Simple email verification process - Free public service -
                Perfect for CLI app developers who don't want to build user
                verification
              </p>
              <p>Try it with: `$ ssh keypub.sh about`</p>
              <p>
                Source code:
                <a href="https://github.com/skariel/keypub"
                  >https://github.com/skariel/keypub</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42494780">
          <h3>
            <a
              class="item"
              href="https://rubenerd.com/building-a-replacement-486-cmos-motherboard-battery/"
              >Building a replacement 386/486 CMOS battery</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 14:52:21</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42494780"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42494746">
          <h3>
            <a
              class="item"
              href="https://medicalxpress.com/news/2024-12-commercial-tea-bags-millions-microplastics.html"
              >Commercial tea bags release microplastics, entering human
              cells</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 14:47:56</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42494746"
                  >Comments</a
                ><span class="descendants">: 197</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42494733">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/health/2024/12/journal-that-published-faulty-black-plastic-study-removed-from-science-index/"
              >Journal that published faulty black plastic study removed from
              science index</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 14:46:09</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42494733"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42494291">
          <h3>
            <a
              class="item"
              href="https://denisdefreyne.com/articles/2024-memoization/"
              >The intricacies of implementing memoization in Ruby</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 13:37:13</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42494291"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42494067">
          <h3>
            <a
              class="item"
              href="https://newsroom.lexmark.com/2024-12-23-Xerox-to-Acquire-Lexmark"
              >Xerox to acquire Lexmark</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 12:57:45</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42494067"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42493464">
          <h3>
            <a
              class="item"
              href="https://xenaproject.wordpress.com/2024/12/22/can-ai-do-maths-yet-thoughts-from-a-mathematician/"
              >Can AI do maths yet? Thoughts from a mathematician</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 10:50:30</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42493464"
                  >Comments</a
                ><span class="descendants">: 164</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42493312">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2412.16145"
              >Offline Reinforcement Learning for LLM Multi-Step Reasoning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 10:16:33</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42493312"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42492753">
          <h3>
            <a class="item" href="https://webextension.net/collections"
              >I built a platform for discovering and sharing Chrome extension
              collections</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-23 @ 08:15:48</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42492753"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42488983">
          <h3>
            <a
              class="item"
              href="https://twtxt.readthedocs.io/en/latest/index.html"
              >Twtxt is a decentralised, minimalist microblogging service for
              hackers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-22 @ 20:51:44</span
              ><span class="points-container"
                >Points: <span class="points">288</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42488983"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42486610">
          <h3>
            <a
              class="item"
              href="https://avi.im/blag/2024/sqlite-past-present-future/"
              >How bloom filters made SQLite 10x faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-22 @ 14:44:30</span
              ><span class="points-container"
                >Points: <span class="points">436</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42486610"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42485938">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/tech/ai/openai-gpt5-orion-delays-639e7693"
              >GPT-5 is behind schedule</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-22 @ 12:29:33</span
              ><span class="points-container"
                >Points: <span class="points">517</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42485938"
                  >Comments</a
                ><span class="descendants">: 919</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42485795">
          <h3>
            <a
              class="item"
              href="https://corelatus.com/blog/Decoding_the_telephony_signals_in_Pink_Floyd_s__The_Wall_.html"
              >Decoding the telephony signals in Pink Floyd's 'The Wall'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-22 @ 11:49:12</span
              ><span class="points-container"
                >Points: <span class="points">394</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42485795"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42485423">
          <h3>
            <a class="item" href="https://github.com/princeton-vl/infinigen"
              >Infinigen: Infinite Photorealistic Worlds Using Procedural
              Generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-22 @ 09:59:28</span
              ><span class="points-container"
                >Points: <span class="points">235</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42485423"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42485113">
          <h3>
            <a class="item" href="https://github.com/Brandon-c-tech/RAG-logger"
              >RAG Logger: An Open-Source Alternative to LangSmith</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-22 @ 08:34:14</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42485113"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42485106">
          <h3>
            <a
              class="item"
              href="https://jessylin.com/2024/11/12/co-adapting-human-interfaces/"
              >Co-Adapting Human Interfaces and LMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-22 @ 08:32:48</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42485106"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42479040">
          <h3>
            <a class="item" href="https://github.com/samwho/spacer"
              >CLI tool to insert spacers when command output stops</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 11:27:39</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42479040"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42479014">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/12/20/why-apple-sends-spyware-victims-to-this-nonprofit-security-lab/"
              >Why Apple sends spyware victims to this nonprofit security lab</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 11:24:37</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42479014"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42470729">
          <h3>
            <a
              class="item"
              href="https://sy1.sh/posts/2024-19-12-investigation-on-scams/"
              >Tracking Down the Bulgarian Marketplace Scams</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-20 @ 12:59:29</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42470729"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42464185">
          <h3>
            <a class="item" href="https://www.owlears.com"
              >Show HN: OwlEars â€“ Raw feedback, straight from your customers'
              minds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-19 @ 18:13:09</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42464185"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                Years ago, I built a personal feedback platform called Sarahah
                that got famous but was eventually removed from stores. One
                unique aspect of Sarahah was its simple, plain message box.
              </p>
              <p>
                Now, I'm using this concept to help businesses gather raw
                feedback (yes, just plain free text) from their customers. This
                approach contrasts with guided surveys that can often frame and
                limit responses. On the business side, we use AI to analyze this
                feedback and provide valuable insights and recommendations.
              </p>
              <p>
                I would really appreciate hearing your thoughts Additionally, if
                you're interested in using this in your startup where we hear
                your feedback and tailor it to your needs, please let me know
              </p>
            </div>
          </section>
        </section>
        <section id="42463253">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/5122706e-39ca-4bbc-95cc-373188a9b1c9"
              >Happy 400th birthday to the worldâ€™s oldest bond</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-19 @ 16:47:51</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42463253"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
