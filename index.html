<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36089171">
          <h3>
            <a
              class="item"
              href="https://www.theglobeandmail.com/opinion/article-ai-programs-like-chatgpt-are-built-on-mass-copyright-infringement/"
              >AI tools like ChatGPT are built on mass copyright infringement</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 20:31:57</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36089171"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36089104">
          <h3>
            <a
              class="item"
              href="https://github.com/thestinger/daniel.micay.dev/commit/79e44b41190cd5c64c4ccd9fec4301ee6008da53"
              >Daniel Micay publicly steps down from GrapheneOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 20:23:59</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36089104"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36089084">
          <h3>
            <a
              class="item"
              href="https://www.winglang.io/post/cloud-why-so-difficult"
              >Cloud, Why So Difficult?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 20:22:13</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36089084"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36089055">
          <h3>
            <a
              class="item"
              href="https://www.supervised.news/p/what-neevas-quiet-exit-tells-us-about"
              >What Neeva's quiet exit tells us about the future of AI
              startups</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 20:19:20</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36089055"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36088783">
          <h3>
            <a
              class="item"
              href="https://github.com/weiweihuanghuang/Times-New-Bastard"
              >Times New Bastard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 19:53:17</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36088783"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36088704">
          <h3>
            <a class="item" href="https://elc.github.io/posts/recursion-python/"
              >Show HN: Python Recursion: A Trampoline from the Mutual Head to
              the...</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 19:45:13</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36088704"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36088693">
          <h3>
            <a
              class="item"
              href="https://twitter.com/DrJimFan/status/1662115266933972993"
              >What if we set GPT-4 free in Minecraft?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 19:44:30</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36088693"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36088672">
          <h3>
            <a class="item" href="https://play0ad.com/"
              >0AD, an open source historical RTS in development for 22 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 19:42:12</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36088672"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36088359">
          <h3>
            <a class="item" href="https://logicboard.com/demo"
              >Show HN: I made an in-browser code editor with code replay and
              REPL</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 19:06:59</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36088359"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                Code-replay lets you run the coding session like a movie, I
                wrote a blog post on how I implemented this:
                <a href="https://logicboard.com/blog/code-replay"
                  >https://logicboard.com/blog/code-replay</a
                >
              </p>
              <p>
                You can try out the demo here:
                <a href="https://logicboard.com/demo/:replay"
                  >https://logicboard.com/demo/:replay</a
                >
              </p>
              <p>
                And play around with the code editor here:
                <a href="https://logicboard.com/demo/"
                  >https://logicboard.com/demo/</a
                >
              </p>
              <p>
                Logicboard also has an REPL shell, just type "start()" and hit
                enter in the output area.
              </p>
            </div>
          </section>
        </section>
        <section id="36088224">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36088224"
              >Can we create a thread for some of the best materials on CS
              available online?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 18:55:01</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36088224"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              <p>
                What are some of the best materials (courses, books, notes,
                video talks, etc) on any CS/programming topic that you have gone
                through or know of?
              </p>
              <p>Also mention a bit about why it is useful.</p>
            </div>
          </section>
        </section>
        <section id="36087464">
          <h3>
            <a
              class="item"
              href="https://codingnest.com/modern-sat-solvers-fast-neat-underused-part-1-of-n/"
              >Modern SAT solvers: fast, neat and underused (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 17:50:15</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36087464"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36087442">
          <h3>
            <a class="item" href="https://www.foldnfly.com/#/1-1-1-1-1-1-1-1-2"
              >Paper Airplane Designs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 17:48:12</span
              ><span class="points-container"
                >Points: <span class="points">258</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36087442"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36087330">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=ZMQbHMgK2rw"
              >Micromouse: The Fastest Maze-Solving Competition on Earth
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 17:39:20</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36087330"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36087252">
          <h3>
            <a
              class="item"
              href="https://there.oughta.be/a/bullet-time-video-booth"
              >There oughta be a bullet time video booth</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 17:33:20</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36087252"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36086984">
          <h3>
            <a
              class="item"
              href="https://www.highsignal.io/companies/making-10k-m-french-learning-app/"
              >Making $10k/m from a French learning app</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 17:14:19</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36086984"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36086858">
          <h3>
            <a
              class="item"
              href="https://www.dig.security/post/gcp-cloudsql-vulnerability-leads-to-internal-container-access-and-data-exposure"
              >GCP CloudSQL Vulnerability Leads to Internal Container Access and
              Data Exposure</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 17:04:52</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36086858"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36086537">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2023/05/phishing-domains-tanked-after-meta-sued-freenom/"
              >Phishing domains tanked after Meta sued Freenom</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 16:42:58</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36086537"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36086099">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-01732-4"
              >Gravitational-wave detector LIGO is back</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 16:15:58</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36086099"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36085538">
          <h3>
            <a class="item" href="https://github.com/kyegomez/tree-of-thoughts"
              >Tree of Thoughts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 15:34:59</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36085538"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36084503">
          <h3>
            <a class="item" href="https://www.fretboardfly.com"
              >Show HN: I created a game to memorize the fretboard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 14:18:58</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36084503"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
            <div class="text">
              <p>“Uhh…Where’s the C# here?”</p>
              <p>“Where’s the flat-3rd of this root on the 4th string?”</p>
              <p>
                “Sure would be nice to know the closest min7 triad shape to play
                over here..”
              </p>
              <p>
                I tried memorizing the fretboard the obvious way but it
                extreeemly boring for me. Being a developer, I decided to turn
                it into a game. I'd love for you guys to try it out and let me
                know what you think: It's at [www.fretboardfly.com](<a
                  href="https://www.fretboardfly.com"
                  >https://www.fretboardfly.com</a
                >)
              </p>
              <p>
                I've only built the first module right now which is for note
                memorization but there's been enough interest that I'm planning
                on building more modules. Please let me know if you like it,
                what you'd change about it and what other modules you'd like to
                see in future.
              </p>
              <p>
                The stack is Vue 3/Nuxt 3/Firebase/Firestore/Tailwind deployed
                on Vercel. Happy to field questions on the tech side of things
                as well
              </p>
            </div>
          </section>
        </section>
        <section id="36084450">
          <h3>
            <a class="item" href="https://deno.com/blog/node-builtins-on-deploy"
              >Node.js built-ins on Deno Deploy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 14:14:22</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36084450"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36083620">
          <h3>
            <a
              class="item"
              href="https://twitter.com/PGeldsetzer1/status/1661776663074738176"
              >Evidence that the shingles vaccine prevents a good chunk of
              dementia cases</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 13:11:50</span
              ><span class="points-container"
                >Points: <span class="points">450</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36083620"
                  >Comments</a
                ><span class="descendants">: 203</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36083306">
          <h3>
            <a
              class="item"
              href="https://www.texasmonthly.com/travel/want-to-buy-a-west-texas-ghost-town-nows-your-chance/"
              >Want to buy a West Texas ghost town? Now’s your chance</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 12:44:22</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36083306"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36083155">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=isyO5tQfeqM"
              >A Technical Film Report on Project Deep Ops (1972) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 12:26:44</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36083155"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36082650">
          <h3>
            <a
              class="item"
              href="https://dailynous.com/2023/05/25/am-i-the-unethical-one-a-philosophy-professor-his-cheating-students/"
              >Am I the Unethical One?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 11:17:11</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36082650"
                  >Comments</a
                ><span class="descendants">: 215</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36082308">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/world/europe/killer-whales-wreck-boat-latest-attack-off-spain-2023-05-25/"
              >Killer whales wreck boat in latest attack off Spain</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 10:27:50</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36082308"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36082180">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/programming/OnHTMLViaStringTemplates"
              >That people produce HTML with string templates is telling us
              something</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 10:07:19</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36082180"
                  >Comments</a
                ><span class="descendants">: 291</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36080209">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/sonnets-are-machines-for-thinking-through-complex-emotions"
              >The Sonnet Machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 05:10:43</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36080209"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36075587">
          <h3>
            <a
              class="item"
              href="https://twitter.com/mbostock/status/1661814623962812416"
              >Observable Plot 0.6.7 released: pointer interaction, tip mark</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-25 @ 20:16:21</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36075587"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36068682">
          <h3>
            <a class="item" href="https://ogris.de/howtos/freebsd-jails.html"
              >Jails on FreeBSD</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-25 @ 09:37:40</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36068682"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
