<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36682468">
          <h3>
            <a class="item" href="https://web.dev/inp/"
              >Google's new metrics: Interaction to Next Paint (INP)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 15:35:30</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36682468"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36682403">
          <h3>
            <a
              class="item"
              href="https://oldbytes.space/@48kRAM/110695813509755748"
              >Windows 9x and Word 9x at 800x600 resolution. Spacious. Comfy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 15:31:17</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36682403"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36682166">
          <h3>
            <a
              class="item"
              href="https://volted.substack.com/p/rethinking-high-school-to-electrify-everything"
              >Shop Class 2.0: Rethinking High School to Accelerate
              Electrification</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 15:15:11</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36682166"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36682139">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/7/11/23779039/microsoft-activision-blizzard-ftc-trial-win"
              >Microsoft wins FTC fight to buy Activision Blizzard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 15:12:30</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36682139"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36682070">
          <h3>
            <a
              class="item"
              href="https://neon.tech/blog/http-vs-websockets-for-postgres-queries-at-the-edge"
              >HTTP vs. WebSockets: Which one is the fastest for Postgres
              queries at the Edge</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 15:06:42</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36682070"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36682008">
          <h3>
            <a class="item" href="https://keras.io/keras_core/announcement/"
              >Introducing Keras Core: Keras for TensorFlow, Jax, and PyTorch</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 15:02:04</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36682008"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36681982">
          <h3>
            <a
              class="item"
              href="https://www-files.anthropic.com/production/images/Model-Card-Claude-2.pdf"
              >Claude 2 Model Card [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 15:00:24</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681982"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36681912">
          <h3>
            <a class="item" href="https://firejail.wordpress.com/"
              >Firejail: Light, featureful and zero-dependency security sandbox
              for Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 14:55:43</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681912"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36681839">
          <h3>
            <a
              class="item"
              href="https://www.trygloo.com/blog/classify-text-llms-learnings"
              >What we learned from using GPT for 500k+ classifications</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 14:51:19</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681839"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36681814">
          <h3>
            <a
              class="item"
              href="https://hackaday.com/2023/07/11/displayport-a-better-video-interface/"
              >Displayport: A Better Video Interface</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 14:50:23</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681814"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36681597">
          <h3>
            <a class="item" href="https://www.jetbrains.com/rust/"
              >IntelliJ Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 14:37:14</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681597"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36681491">
          <h3>
            <a
              class="item"
              href="https://unchartedterritories.tomaspueyo.com/p/solar-energy-solves-global-warming"
              >Solar Energy Solves Global Warming</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 14:30:59</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681491"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36681471">
          <h3>
            <a class="item" href="https://github.com/clickvote/clickvote"
              >Show HN: Clickvote – Open-source upvotes, likes, and reviews to
              any context</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 14:29:35</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681471"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                Showing real-time updates of likes, upvotes, and reviews between
                clients.
              </p>
              <p>Learn about your members through deep analytics.</p>
              <p>Deal with an unlimited amount of clicks per second.</p>
              <p>You can read the full article here:</p>
              <p>
                <a href="https://links.github20k.com/click-vote"
                  >https://links.github20k.com/click-vote</a
                >
              </p>
              <p>The open-source Library is here:</p>
              <p>
                <a href="https://github.com/clickvote/clickvote"
                  >https://github.com/clickvote/clickvote</a
                >
              </p>
              <p>Please let me know your thoughts!</p>
              <p>Am I building something useless?</p>
            </div>
          </section>
        </section>
        <section id="36681459">
          <h3>
            <a
              class="item"
              href="https://www.fast.ai/posts/2023-11-07-dislightenment.html"
              >AI Safety and the Age of Dislightenment</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 14:28:27</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681459"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36681178">
          <h3>
            <a
              class="item"
              href="https://www.scylladb.com/2023/07/10/why-scylladb-is-moving-to-a-new-replication-algorithm-tablets/"
              >ScyllaDB is Moving to a New Replication Algorithm: Tablets</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 14:06:55</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681178"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36681101">
          <h3>
            <a class="item" href="https://cqcumbers.com/github_achievements/"
              >GitHub Profile Achievements</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 14:01:07</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36681101"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36680835">
          <h3><a class="item" href="https://lawsofux.com/">Laws of UX</a></h3>
          <section>
            <h4>
              <span>2023-07-11 @ 13:41:37</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36680835"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36680755">
          <h3>
            <a class="item" href="https://www.anthropic.com/index/claude-2"
              >Claude 2</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 13:35:58</span
              ><span class="points-container"
                >Points: <span class="points">199</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36680755"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36680535">
          <h3>
            <a
              class="item"
              href="https://tigerbeetle.com/blog/2023-07-11-we-put-a-distributed-database-in-the-browser/"
              >We put a distributed database in the browser and made a game of
              it</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 13:15:49</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36680535"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36679368">
          <h3>
            <a class="item" href="https://github.com/photoprism/photoprism"
              >PhotoPrism: Browse Your Life in Pictures</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 11:18:48</span
              ><span class="points-container"
                >Points: <span class="points">188</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36679368"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36679128">
          <h3>
            <a
              class="item"
              href="https://stratechery.com/2023/threads-and-the-social-communications-map/"
              >Threads and the Social/Communications Map</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 10:47:54</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36679128"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36678795">
          <h3>
            <a class="item" href="https://mjg59.dreamwidth.org/66907.html"
              >Roots of Trust Are Difficult</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 10:09:57</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36678795"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36678457">
          <h3>
            <a
              class="item"
              href="https://nnethercote.github.io/2023/07/11/back-end-parallelism-in-the-rust-compiler.html"
              >Back-end parallelism in the Rust compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 09:33:12</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36678457"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36677034">
          <h3>
            <a
              class="item"
              href="https://github.com/mshumer/gpt-prompt-engineer"
              >GPT-Prompt-Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 06:16:14</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36677034"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36676415">
          <h3>
            <a class="item" href="https://playlaser.xyz"
              >Show HN: Laser, a new game played on a chess board</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 04:27:41</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36676415"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
            <div class="text">
              <i>laser</i> piece, which can shoot diagonally through every piece
              on the board except for the <i>wall</i>, which blocks it. The
              detailed rules are on the website.
              <p>
                I made the website as a super minimal way to play online against
                friends. Nobody really knows about it so it might be hard to
                find a game, but maybe you will against someone on HN if people
                read this. It uses the lichess.org chessboard UI which is super
                pretty and allows you to draw on the board, make premoves, etc.
                The code is public if you are interested:
                github.com/melgrove/laser
              </p>
              <p>If you are playing, good luck, and don't get lasered!</p>
            </div>
          </section>
        </section>
        <section id="36675934">
          <h3>
            <a
              class="item"
              href="https://threadreaderapp.com/thread/1678545170508267522.html"
              >GPT-4 details leaked?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-11 @ 03:00:19</span
              ><span class="points-container"
                >Points: <span class="points">520</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36675934"
                  >Comments</a
                ><span class="descendants">: 441</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36669810">
          <h3>
            <a
              class="item"
              href="https://www.hillelwayne.com/post/always-more-history/"
              >There's always more history (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 17:34:05</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36669810"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36667840">
          <h3>
            <a
              class="item"
              href="https://www.japantimes.co.jp/life/2023/07/09/food/iwanohara-vineyard-niigata-joestu/"
              >At Japan’s first winery, the country’s oldest grape lives on</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 15:28:08</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36667840"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36667539">
          <h3>
            <a
              class="item"
              href="https://rarehistoricalphotos.com/hughes-h-4-hercules-spruce-goose-1945-1947/"
              >The story in pictures of the Hughes H-4 Hercules, 1945-1947</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 15:07:12</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36667539"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36663947">
          <h3>
            <a
              class="item"
              href="http://modernescpp.com/index.php/c-23-the-next-c-standard"
              >C++23: The Next C++ Standard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-10 @ 09:31:16</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36663947"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
