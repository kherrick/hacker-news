<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44611320">
          <h3>
            <a
              class="item"
              href="https://www.macintoshrepository.org/44146-mr-browser"
              >Mr Browser – Macintosh Repository file downloader that runs
              directly on 68k Macs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-19 @ 00:20:48</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44611320"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44611270">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/Intel-Ends-Clear-Linux"
              >Intel Announces It's Shutting Down Clear Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-19 @ 00:12:13</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44611270"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44611223">
          <h3>
            <a
              class="item"
              href="https://optimizedbyotto.com/post/debcraft-easy-debian-packaging/"
              >Debcraft – Easiest way to modify and build Debian packages</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-19 @ 00:04:31</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44611223"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44611098">
          <h3>
            <a
              class="item"
              href="https://community.clearlinux.org/t/all-good-things-come-to-an-end-shutting-down-clear-linux-os/10716"
              >Shutting Down Clear Linux OS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 23:45:12</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44611098"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44610925">
          <h3>
            <a class="item" href="https://github.com/ryoppippi/ccusage"
              >Ccusage: A CLI tool for analyzing Claude Code usage from local
              JSONL files</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 23:22:49</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44610925"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44610623">
          <h3>
            <a
              class="item"
              href="https://varunraghu.com/im-rebelling-against-the-algorithm/"
              >I'm Rebelling Against the Algorithm</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 22:45:32</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44610623"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44610468">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/1026694/3413f4b43c862629/"
              >How to write Rust in the Linux kernel: part 3</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 22:27:17</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44610468"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44609969">
          <h3>
            <a
              class="item"
              href="http://www.davidtinapple.com/illich/1983_silence_commons.html"
              >Silence Is a Commons by Ivan Illich (1983)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 21:21:50</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44609969"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44609479">
          <h3>
            <a
              class="item"
              href="https://consolebytes.com/wii-u-sdboot1-exploit-paid-the-beak/"
              >Wii U SDBoot1 Exploit “paid the beak”</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 20:30:36</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44609479"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44609137">
          <h3>
            <a
              class="item"
              href="https://burn.dev/blog/sota-multiplatform-matmul/"
              >Multiplatform Matrix Multiplication Kernels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 19:59:49</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44609137"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44609130">
          <h3>
            <a
              class="item"
              href="https://paulkedrosky.com/honey-ai-capex-ate-the-economy/"
              >AI capex is so big that it's affecting economic statistics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 19:59:04</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44609130"
                  >Comments</a
                ><span class="descendants">: 240</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44608856">
          <h3>
            <a
              class="item"
              href="https://github.com/bitnami/charts/issues/35164"
              >Broadcom to discontinue free Bitnami Helm charts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 19:29:52</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44608856"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44608840">
          <h3>
            <a class="item" href="https://www.librari.io/"
              >Show HN: I built library management app for those who outgrew
              spreadsheets</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 19:28:34</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44608840"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                The Problem: I have 500+ books across multiple rooms in my house
                and was desperately looking for an app to manage them properly.
                Most library management apps are either too basic or designed
                for institutional libraries with rigid workflows that don't fit
                personal use.
              </p>
              <p>What I Built:</p>
              <p>
                - Multiple libraries: manage collections in different locations
              </p>
              <p>
                - Location tracking - remember exactly which shelf each book is
                on
              </p>
              <p>- Loan management - track books you've lent to friends</p>
              <p>
                - Custom fields &amp; tags - store any additional book info the
                way YOU think about them
              </p>
              <p>
                - Reading progress tracking - dates, duration, personal ratings
              </p>
              <p>- Modern UI/UX - clean &amp; actually enjoyable to use</p>
              <p>Current Status:</p>
              <p>- Beta version live</p>
              <p>
                - Working on improving the responsiveness of the app and
                addressing initial user feedback
              </p>
              <p>Would love feedback! Especially curious about:</p>
              <p>
                - What features would make YOU actually use a library management
                app?
              </p>
              <p>- UI/UX feedback always welcome</p>
              <p>
                - Any book collectors here who'd be interested in beta testing?
              </p>
              <p>Looking forward to your thoughts! Thank you in advance.</p>
            </div>
          </section>
        </section>
        <section id="44608754">
          <h3>
            <a
              class="item"
              href="https://kristoff.it/blog/asynchrony-is-not-concurrency/"
              >Asynchrony is not concurrency</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 19:21:38</span
              ><span class="points-container"
                >Points: <span class="points">189</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44608754"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44608622">
          <h3>
            <a class="item" href="https://eprint.iacr.org/2025/1237"
              >Replication of Quantum Factorisation Records with a VIC-20, an
              Abacus, and a Dog</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 19:09:07</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44608622"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44608312">
          <h3>
            <a class="item" href="https://molab.marimo.io/notebooks"
              >Show HN: Molab, a cloud-hosted Marimo notebook workspace</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 18:40:30</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44608312"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <p>
                Rather than try to convince Google to replace their notebook
                with marimo, we decided to just build our own cloud-hosted
                notebook service instead. We're calling this molab (mo for
                marimo), and we're launching it today.
              </p>
              <p>
                You can try it at
                <a href="https://molab.marimo.io">https://molab.marimo.io</a>
              </p>
              <p>Some features:</p>
              <p>- Persistent storage</p>
              <p>
                - Link sharing (notebooks are public but undiscoverable, like
                secret GitHub Gists)
              </p>
              <p>
                - Download notebooks to your machine, reuse them as Python
                scripts or apps
              </p>
              <p>
                - Upload local notebooks to the cloud from our CLI (coming soon)
              </p>
              <p>- Real-time collaboration (coming soon)</p>
              <p>
                - Configure computational resources to obtain more CPU or GPU
                (coming soon)
              </p>
              <p>
                marimo is a modern notebook for modern data workflows; we also
                built molab on a modern tech stack:
              </p>
              <p>
                - Notebook dependencies are managed by uv, enabling
                lighting-fast package installation (thanks to uv’s cache and
                more generally its performant implementation). uv makes it easy
                to run molab notebooks locally, too: uvx marimo edit
                &lt;notebook-url&gt; brings the notebook down to your machine.
              </p>
              <p>
                - Persistent storage is powered by R2, Cloudflare’s zero-egress
                object store.
              </p>
              <p>- We use Pydantic logfire to monitor our deployment.</p>
              <p>
                - While our implementation is agnostic to the compute backend
                (stay tuned!), we’re currently running on Modal for fast
                startups (not to mention a slick developer experience). Modal
                sandboxes make it easy for us define containers at runtime,
                containing notebook code and their dependencies. (Shout out to
                Eric Zhang from Modal for helping us get started.)
              </p>
              <p>
                molab is free to use, as long as usage is reasonable. Our goal
                is to make is as easy as possible for our community to use
                marimo notebooks.
              </p>
              <p>
                Finally, learn more at our announcement blog:
                <a href="https://marimo.io/blog/announcing-molab"
                  >https://marimo.io/blog/announcing-molab</a
                >
              </p>
              <p>
                If this interests you, please give molab a shot and please share
                feedback — here or on Discord (<a
                  href="https://marimo.io/discord"
                  >https://marimo.io/discord</a
                >).
              </p>
              <p>
                P.S. This is not our commercial product, this is really just for
                our community.
              </p>
              <p>
                [1]
                <a href="https://github.com/marimo-team/marimo"
                  >https://github.com/marimo-team/marimo</a
                >
                [2]
                <a
                  href="https://github.com/googlecolab/colabtools/issues?q=is%3Aissue%20state%3Aopen%20sort%3Areactions-%2B1-desc"
                  >https://github.com/googlecolab/colabtools/issues?q=is%3Aissu...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44608295">
          <h3>
            <a
              class="item"
              href="https://www.sciencenews.org/article/cancer-tumor-dna-blood-test-screening"
              >Cancer DNA is detectable in blood years before diagnosis</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 18:39:06</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44608295"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44608294">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/mango-health/jobs/3bjIHus-founding-engineer"
              >Mango Health (YC W24) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 18:39:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44608275">
          <h3>
            <a
              class="item"
              href="https://blog.nilenso.com/blog/2025/06/23/how-i-keep-up-with-ai-progress/"
              >How I keep up with AI progress</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 18:36:39</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44608275"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44607838">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2025/07/18/meta-europe-ai-code.html"
              >Meta says it wont sign Europe AI agreement, calling it growth
              stunting overreach</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 17:56:37</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44607838"
                  >Comments</a
                ><span class="descendants">: 176</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44607403">
          <h3>
            <a
              class="item"
              href="https://www.filfre.net/2025/07/the-year-of-peak-might-and-magic/"
              >The year of peak might and magic</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 17:21:49</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44607403"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44606184">
          <h3>
            <a
              class="item"
              href="https://www.pcgamer.com/software/platforms/valve-confirms-credit-card-companies-pressured-it-to-delist-certain-adult-games-from-steam/"
              >Valve confirms credit card companies pressured it to delist
              certain adult games</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 15:54:46</span
              ><span class="points-container"
                >Points: <span class="points">251</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44606184"
                  >Comments</a
                ><span class="descendants">: 294</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44605670">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/a-new-geometry-for-einsteins-theory-of-relativity-20250716/"
              >A New Geometry for Einstein's Theory of Relativity</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 15:19:17</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44605670"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44604050">
          <h3>
            <a
              class="item"
              href="https://rockorager.dev/log/lsr-ls-but-with-io-uring/"
              >lsr: ls with io_uring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 12:40:41</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44604050"
                  >Comments</a
                ><span class="descendants">: 152</span></span
              >
            </h4>
            <div class="text">
              <a href="https://tangled.sh/@rockorager.dev/lsr"
                >https://tangled.sh/@rockorager.dev/lsr</a
              >
            </div>
          </section>
        </section>
        <section id="44603066">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/cpm-creator-gary-kildalls-memoirs-released-as-free-download"
              >CP/M creator Gary Kildall's memoirs released as free download</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 10:22:15</span
              ><span class="points-container"
                >Points: <span class="points">236</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44603066"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44593441">
          <h3>
            <a class="item" href="https://blog.m-ou.se/floats/"
              >Converting Integers to Floats Using Hyperfocus (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-17 @ 13:52:14</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44593441"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44572807">
          <h3>
            <a class="item" href="https://www.ibm.com/history/sage"
              >Sage: An atomic bomb kicked off the biggest computing project in
              history</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 16:21:59</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44572807"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44572068">
          <h3>
            <a class="item" href="https://github.com/sushrut141/ketu"
              >Show HN: Simulating autonomous drone formations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 15:18:48</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44572068"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44570113">
          <h3>
            <a class="item" href="https://cofault.com/zero-cost-static.html"
              >C++: zero-cost static initialization</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 11:39:18</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44570113"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44569032">
          <h3>
            <a class="item" href="https://tazj.in/blog/trying-guix"
              >Trying Guix: A Nixer's impressions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 08:11:19</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44569032"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
