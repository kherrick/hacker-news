<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39431130">
          <h3>
            <a
              class="item"
              href="https://www.sonarsource.com/blog/union-intersection-difference-javascript-sets/"
              >Union, intersection, difference, and more are coming to
              JavaScript Sets</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 15:55:24</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39431130"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39430678">
          <h3>
            <a
              class="item"
              href="https://wccftech.com/amd-zen-5-cpus-reportedly-made-on-tsmc-3nm-process-q2-mass-production-q3-2024/amp/"
              >AMD Zen 5 CPUs Reportedly Made on TSMC's 3nm Process, Mass
              Production in Q3</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 15:18:39</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39430678"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39430095">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/b845e8ab-9cbc-482c-aa22-0b5c020be099"
              >AstraZeneca unveils successes in treatment of lung cancer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 14:31:18</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39430095"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39430027">
          <h3>
            <a
              class="item"
              href="https://forums.wyze.com/t/update-on-investigation-of-2-16-24-security-issue/291002"
              >Wyze security incident update</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 14:24:40</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39430027"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39429627">
          <h3>
            <a class="item" href="https://gcc.gnu.org/gcc-14/porting_to.html#c"
              >Porting to GCC 14: C language issues</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 13:43:32</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39429627"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39429370">
          <h3>
            <a class="item" href="https://leanrada.com/htmz/"
              >Show HN: htmz – a low power tool for HTML</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 13:12:18</span
              ><span class="points-container"
                >Points: <span class="points">218</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39429370"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39429160">
          <h3>
            <a
              class="item"
              href="https://www.winuae.net/2024/02/19/winuae-5-2-0/"
              >Amiga Emulator: WinUAE 5.2.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 12:46:36</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39429160"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39428880">
          <h3>
            <a class="item" href="https://groq.com/"
              >Groq runs Mixtral 8x7B-32k with 500 T/s</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 12:06:01</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39428880"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39428874">
          <h3>
            <a class="item" href="https://skio.com/careers/"
              >Skio (YC S20) – Subscriptions for Shopify, ReCharge Migrations
              – Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 12:05:16</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39428766">
          <h3>
            <a class="item" href="https://coderev.app"
              >Show HN: CodeRev.app – Code Review as Interview</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 11:46:49</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39428766"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
            <div class="text">
              <p>
                Project-based interviews can also be challenging because it can
                end up filtering out folks who don't want to spend several hours
                building something in their free time.
              </p>
              <p>
                I met up with a friend last year -- a very senior dev -- who had
                taken some time off to study leetcode exercises while preparing
                for FAANG interviews. It struck me that one of the key measures
                of whether a candidate is a fit for a team is rather
                <i>synthetic</i>.
              </p>
              <p>
                CodeRev.app is a simple, lightweight tool that helps teams
                evaluate candidates using code reviews. While programming tends
                to be a more isolated activity, code reviews tend to be more
                open ended, collaborative, and reflective of how a candidate
                communicates, interacts, and provides feedback day-to-day. It
                may also be a better yardstick for roles that are biased towards
                reading code rather than writing code (engineering manager,
                support, QA).
              </p>
              <p>
                More interesting is that as we come to rely on AI generated code
                in our workflows, testing for the ability to read and evaluate
                the quality of generated code and whether it is fit-for-purpose
                becomes more important. Being able to quickly identify security
                flaws, logical flaws, and domain specific gaps (auditing,
                logging, etc.) becomes increasingly important.
              </p>
              <p>
                More in depth thoughts here:
                <a
                  href="https://chrlschn.dev/blog/2023/07/interviews-age-of-ai-ditch-leetcode-try-code-reviews-instead/"
                  >https://chrlschn.dev/blog/2023/07/interviews-age-of-ai-ditch...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="39428640">
          <h3>
            <a
              class="item"
              href="https://www.syracuse.com/business/2024/02/globalfoundries-wins-31-billion-in-chips-act-subsidies-for-upstate-ny-vermont-expansion.html"
              >GlobalFoundries wins $3.1B in CHIPS Act subsidies for NY,
              Vermont</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 11:31:26</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39428640"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39428609">
          <h3>
            <a class="item" href="https://github.com/kaspermarstal/plprql"
              >Show HN: PRQL in PostgreSQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 11:27:51</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39428609"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
            <div class="text">
              <p>
                When I first saw PRQL on Hacker News a few months ago, I was
                immediately captivated by the idea, yet equally disappointed
                that there was no integration for PostgreSQL. Having previous
                experience with writing PostgreSQL extensions in C, I thought
                this was a great opportunity to try out the pgrx framework and
                decided to integrate PRQL with PostgreSQL myself.
              </p>
              <p>
                The maintainers of both PRQL and pgrx were very nice to work
                with. Thanks guys.
              </p>
            </div>
          </section>
        </section>
        <section id="39428409">
          <h3>
            <a
              class="item"
              href="https://github.com/black7375/Firefox-UI-Fix/wiki/%5BArticle%5D-1.-How-to-make-a-better-default-Firefox-UI"
              >How to make a better default Firefox UI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 11:02:39</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39428409"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39428047">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2402.06184"
              >The boundary of neural network trainability is fractal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 10:27:52</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39428047"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39427940">
          <h3>
            <a class="item" href="https://whichbachcantata.be/"
              >Bach’s Cantata Calendar</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 10:11:11</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39427940"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39427876">
          <h3>
            <a class="item" href="https://blog.raed.dev/posts/goodbye_spotify"
              >The day I canceled my Spotify subscription</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 09:57:37</span
              ><span class="points-container"
                >Points: <span class="points">298</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39427876"
                  >Comments</a
                ><span class="descendants">: 341</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39427202">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/biologists-discover-four-new-octopus-species-deep-ocean-costa-rica-180983631/"
              >Biologists discover four new octopus species</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 08:00:43</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39427202"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39426631">
          <h3>
            <a class="item" href="https://castle-engine.io/"
              >Castle Engine – Free open-source cross-platform 3D/2D game engine
              using Pascal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 06:03:38</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39426631"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39426341">
          <h3>
            <a class="item" href="https://a.exozy.me/posts/floats-weird/"
              >Floats Are Weird</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 04:52:38</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39426341"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39426310">
          <h3>
            <a
              class="item"
              href="https://github.com/akalenuk/the_namingless_programming_language"
              >The Namingless Programming Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 04:45:08</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39426310"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39426209">
          <h3>
            <a class="item" href="https://github.com/TimeSurgeLabs/athenadb"
              >Show HN: I built a vector database API on Cloudflare</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 04:24:52</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39426209"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39425706">
          <h3>
            <a class="item" href="https://ramstickprices.com/"
              >Show HN: RAM Prices</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 02:39:12</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39425706"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
            <div class="text">
              <a href="https://news.ycombinator.com/item?id=39066480"
                >https://news.ycombinator.com/item?id=39066480</a
              >
              about diskprices.com last month, and decided to go ahead and make
              a site for RAM. It's my first time building anything like this!
              Any tips / suggestions / calls for complete overhaul are welcome
              :)
            </div>
          </section>
        </section>
        <section id="39422778">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/desktops/house-cleaners-find-two-of-the-worlds-first-desktop-pcs-in-random-boxes"
              >House cleaners find two of the first desktop PCs in random
              boxes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 20:23:25</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39422778"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418468">
          <h3>
            <a
              class="item"
              href="https://londonist.com/2013/06/a-colour-chart-for-london"
              >A Colour Chart for London (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 12:21:40</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418468"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418107">
          <h3>
            <a
              class="item"
              href="https://logicgrimoire.wordpress.com/2023/12/05/an-extreme-antipattern-for-programming-books/"
              >Programming book authors: put all the code in the book</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 11:08:01</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418107"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39417905">
          <h3>
            <a
              class="item"
              href="https://github.com/noctuid/dotfiles/blob/master/emacs/editing.org"
              >Notes on Text Editing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 10:28:15</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39417905"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39408770">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2024/02/its-a-fake-mysterious-280-million-year-old-fossil-is-mostly-just-black-paint/"
              >Mysterious 280M-year-old fossil is mostly just black paint</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-17 @ 12:17:13</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39408770"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39408135">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Master_of_the_Playing_Cards"
              >Master of the Playing Cards</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-17 @ 10:15:54</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39408135"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39396373">
          <h3>
            <a class="item" href="https://taylor.town/compress-code"
              >Clean your codebase with basic information theory</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-16 @ 13:01:20</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39396373"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39391675">
          <h3>
            <a
              class="item"
              href="https://www.orange-kiwi.com/posts/optimization-example-mandelbrot-part-1/"
              >Optimization Example: Mandelbrot Set (part 1)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-16 @ 01:01:03</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39391675"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
