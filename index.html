<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40579508">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/continue/jobs/smcxRnM-founding-engineer"
              >Continue (YC S23) is hiring a founding engineer in San
              Francisco</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 22:15:16</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40578705">
          <h3>
            <a
              class="item"
              href="https://www.andreinc.net/2024/04/24/from-the-circle-to-epicycles"
              >An animated introduction to Fourier series</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 20:39:52</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40578705"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40578668">
          <h3>
            <a
              class="item"
              href="https://lcamtuf.substack.com/p/some-notes-on-influenceering"
              >Some notes on influenceering</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 20:34:30</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40578668"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40578460">
          <h3>
            <a
              class="item"
              href="https://gothamist.com/news/things-the-guys-who-stole-my-phone-have-texted-me-to-try-to-get-me-to-unlock-it"
              >Things the guys who stole my phone have texted me to try to get
              me to unlock it</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 20:10:23</span
              ><span class="points-container"
                >Points: <span class="points">293</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40578460"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40578414">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/975565/bcce68a68d82d63a/"
              >Debian's /tmpest in a teapot</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 20:05:24</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40578414"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40578206">
          <h3>
            <a
              class="item"
              href="https://dougallj.wordpress.com/2020/01/13/bit-twiddling-addition-with-unknown-bits/"
              >Bit-twiddling abstract addition with unknown bits</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 19:42:02</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40578206"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40578176">
          <h3>
            <a
              class="item"
              href="https://www.moore.org/article-detail?newsUrlName=particle-accelerators-for-the-microchip-era"
              >Particle accelerators for the microchip era</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 19:39:26</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40578176"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40578060">
          <h3>
            <a class="item" href="https://github.com/EwenQuim/entropy"
              >Entropy, a CLI that scans files to find high entropy lines (might
              be secrets)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 19:25:47</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40578060"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40577800">
          <h3>
            <a class="item" href="https://herbie.uwplse.org/demo/"
              >Herbie: Optimize Floating-Point Expressions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 18:59:40</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40577800"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40577726">
          <h3>
            <a
              class="item"
              href="https://cepr.org/voxeu/columns/how-influencer-cartels-manipulate-social-media-fraudulent-behaviour-hidden-plain"
              >Influencer cartels manipulate social media</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 18:51:34</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40577726"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40577622">
          <h3>
            <a
              class="item"
              href="https://androidoffsec.withgoogle.com/posts/attacking-android-binder-analysis-and-exploitation-of-cve-2023-20938/"
              >Attacking Android Binder</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 18:41:02</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40577622"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40577216">
          <h3>
            <a class="item" href="https://future.mozilla.org/builders/"
              >Mozilla Builders Accelerator 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 18:00:44</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40577216"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40576132">
          <h3>
            <a
              class="item"
              href="https://digilent.com/blog/why-do-electronic-components-have-such-odd-values/"
              >Why do electronic components have such odd values? (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 16:20:49</span
              ><span class="points-container"
                >Points: <span class="points">245</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40576132"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40575538">
          <h3>
            <a class="item" href="https://www.shortbreadapp.com/"
              >Show HN: Shortbread App – AI-powered, romantic comics for
              women</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 15:22:31</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40575538"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
            <div class="text">
              <p>
                You can see two comics episodes at
                <a
                  href="https://create.shortbread.ai/viewer/3d25370c-a4eb-4df4-af8e-9980a72f2bd5"
                  >https://create.shortbread.ai/viewer/3d25370c-a4eb-4df4-af8e-...</a
                >
                <a
                  href="https://create.shortbread.ai/viewer/866c2873-9962-4ebe-8f0c-64a154c263bf"
                  >https://create.shortbread.ai/viewer/866c2873-9962-4ebe-8f0c-...</a
                >, and read more in the app via
                <a href="https://www.shortbreadapp.com/"
                  >https://www.shortbreadapp.com/</a
                >.
              </p>
              <p>
                All comics in the app are made by artists using the Shortbread
                AI Comics Studio (<a href="https://shortbread.ai"
                  >https://shortbread.ai</a
                >). It is a powerful Photoshop-like editor that speeds up comic
                creation 10x with AI. The editor provides consistency and
                granular artistic control. More below.
              </p>
              <p>
                We first posted on HN 6 months ago when we built a
                prompt-to-comics AI (<a
                  href="https://news.ycombinator.com/item?id=37792444"
                  >https://news.ycombinator.com/item?id=37792444</a
                >). We sunsetted this soon after - it was a fun experiment but
                it didn’t meet the real need of comic artists. Shortbread Studio
                now changes this by enhancing how creators naturally work
                instead of replacing them.
              </p>
              <p>The tech:</p>
              <p>
                One-shot Character LoRA: Artists upload a single photo of their
                character. Our backend uses prompt engineering and ControlNet
                pipelines to generate a synthetic dataset from this photo. This
                dataset shows the character in all kinds of angles, poses and
                facial expressions that the artist can pick the best from. It’s
                then sent to our LoRA training service to create a LoRA model.
                This takes about 7 minutes.
              </p>
              <p>
                Control -&gt; Redraw -&gt; Refine Workflow: In real life
                drawing, you draw, erase, and draw again. The human creative
                process is iterative. In Shortbread Studio, artists can start
                from a text prompt, a sketch, a web image or a pose reference as
                a basis, create an initial panel and quickly modify and
                regenerate until they get what they want. If you spend 5
                seconds, you get a decent panel. If you spend 10 minutes, you
                can push the limits and get pro results.
              </p>
              <p>
                Built-in Post-Processing: The editor’s features include liquify,
                upscale, remove background, and outpainting to extend an image.
                This allows artists to remove, add, or modify parts of an image
                on a pixel level without drawing by hand. We combine this with
                segmentation models like Segment Anything (<a
                  href="https://github.com/facebookresearch/segment-anything"
                  >https://github.com/facebookresearch/segment-anything</a
                >) to support intelligently selecting and editing a part of an
                image.
              </p>
              <p>
                Google-docs like collaboration: The Studio runs in the browser
                and supports comments and collaboration.
              </p>
              <p>
                LLM Powered Copy Editor: Comics need text. An AI agent
                proofreads speech bubbles, fixes lettering and identifies
                grammar mistakes.
              </p>
              <p>
                Read our comics:
                <a href="https://shortbreadapp.com/"
                  >https://shortbreadapp.com/</a
                >
                (free to download + read, iOS + Android)
              </p>
              <p>
                All of the above are built by a team of 3 engineers including
                myself. I will be around to answer any questions in this thread!
              </p>
            </div>
          </section>
        </section>
        <section id="40573790">
          <h3>
            <a class="item" href="https://github.com/DrDroidLab/PlayBooks"
              >Show HN: PlayBooks – Jupyter Notebooks style on-call
              investigation documents</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 12:29:16</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40573790"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/DrDroidLab/playbooks"
                >https://github.com/DrDroidLab/playbooks</a
              >), an open source tool to write executable notebooks for on-call
              investigations / remediations instead of Google Docs or Wikis.
              There’s a demo video here:
              <a href="https://www.youtube.com/watch?v=_e-wOtIm1gk"
                >https://www.youtube.com/watch?v=_e-wOtIm1gk</a
              >, and our docs are here:
              <a href="https://docs.drdroid.io/docs/playbooks"
                >https://docs.drdroid.io/docs/playbooks</a
              >
              <p>
                We were in YC’s W23 batch working on a data lakehouse with
                support for dynamic log schemas. Eventually we realized it was a
                product in search of a market and decided to stop building it.
                When pivoting, we decided to work on something that we
                originally prototyped (before even YC) but didn’t execute on.
              </p>
              <p>
                In our previous jobs, we were at a food delivery startup in
                India with a busy on-call routine for backend &amp; devops
                engineers and a small tech team. Often business impacting issues
                (e.g. orders dropped by &gt;5% in the last 15 minutes) would
                escalate to Dipesh as he was the lead dev who had been around
                for a while and he always had 4-5 hypotheses on what might have
                failed. To avoid becoming the bottleneck, he used to write
                scripts that fetched custom metrics &amp; order related
                application logs every 5 minutes during peak traffic. So if an
                issue was reported, engineers would check the output of those
                scripts with all the usual suspects first, before diving into a
                generic exploration. This was the inspiration to get started on
                PlayBooks.
              </p>
              <p>
                We’ve put together a platform that can help any dev create
                scripts with flexibility and without requiring to code much. Our
                goals were: (1) it can be automated to run and send updates; (2)
                investigation progress can be shared easily with other team
                members so everyone has the right context; (3) It can all be
                done without being on-call or having a laptop access.
              </p>
              <p>
                Using PlayBooks, a user can configure the steps as data queries
                or actions within their observability stack. Here are the
                integrations we currently support: - Run bash commands on a
                remote server; - Fetch logs from AWS Cloudwatch and Azure Log
                Analytics; - Fetch metrics from any PromQL compatible db, AWS
                Cloudwatch, Datadog and New Relic; - Query PostgreSQL,
                ClickHouse or any other JDBC compatible databases; - Write a
                custom API call; - Query events from EKS / GKE; - Add an iFrame
              </p>
              <p>
                The platform focuses on not just running the tasks but also
                displaying information in a meaningful form with relevant graphs
                / logs / text outputs alongside the steps in a notebook format.
                Some of our users have shared feedback that on-call decision
                making overload has reduced with PlayBooks as relevant data from
                multiple tools is presented upfront in one page.
              </p>
              <p>
                Here are some of the key features that we believe will further
                increase the value to users looking to improve developer
                experience for their on-call engineers: - Automated surfacing of
                PlayBooks against alerts &amp; enriching alerts with
                above-mentioned data; - AI-supported interpretation layer —
                connect with LLM or ML models to auto-analyze the data in the
                playbook; - Logs of historical executions to ease the effort of
                creating post-mortems / timelines and/or share information with
                peers.
              </p>
              <p>
                If this looks like something that would have been useful for you
                on-call or will be in your current workspace, we welcome you to
                try our sandbox:
                <a href="https://sandbox.drdroid.io/"
                  >https://sandbox.drdroid.io/</a
                >. We have added a default playbook. Just click on one of the
                steps in the playbook and then the “Run” button to see the
                playbook in action.
              </p>
              <p>
                We are excited to hear what you like about the PlayBooks and
                what you think could improve the oncall developer experience for
                your team. Please drop your comments here – we will read them
                eagerly and respond!
              </p>
            </div>
          </section>
        </section>
        <section id="40573387">
          <h3>
            <a
              class="item"
              href="https://www.daveperrett.com/articles/2012/05/16/underscores-are-stupid-get-a-japanese-keyboard/"
              >Underscores are stupid? Get a Japanese keyboard (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 11:44:39</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40573387"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40571995">
          <h3>
            <a
              class="item"
              href="https://mathstodon.xyz/@tao/112557248794707738"
              >A breakthrough towards the Riemann hypothesis</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 08:25:19</span
              ><span class="points-container"
                >Points: <span class="points">394</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40571995"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40571727">
          <h3>
            <a class="item" href="https://emildziewanowski.com/flat-planets/"
              >Sphere Rendering: Flat Planets</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 07:42:01</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40571727"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40571463">
          <h3>
            <a class="item" href="https://huewords.snellman.net/"
              >Show HN: Huewords, a Word and Logic Puzzle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 07:01:58</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40571463"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              <p>
                The effort allocation was pretty different from what I've done
                in the past.
              </p>
              <p>
                The game design snapped together very quickly: I had the initial
                idea, played a couple of games on a spreadsheet to get a feel
                for the idea, and made one change based on those plays. After
                that everything felt just right through multiple rounds of
                playtesting. Likewise the puzzle generation is nowhere near as
                elaborate as in my previous game, fairly simple methods worked
                well and provided good variety.
              </p>
              <p>
                Instead I ended up spending silly amounts of time on curating
                the word list (including using LLMs to guide the curation) and
                on iterating on the UI. The basic UI concept never changed, but
                the details basically never survived for very long after
                starting a new playtest round.
              </p>
            </div>
          </section>
        </section>
        <section id="40571402">
          <h3>
            <a
              class="item"
              href="https://unherd.com/2024/05/dont-be-terrified-of-pale-fire/"
              >Don't be terrified of Pale Fire</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 06:48:55</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40571402"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40571270">
          <h3>
            <a
              class="item"
              href="https://alexwlchan.net/2024/creating-a-safari-webarchive/"
              >Creating a Safari webarchive from the command line</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 06:24:39</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40571270"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40569385">
          <h3>
            <a class="item" href="https://github.com/jstrieb/poker-chipper"
              >Show HN: Allocate poker chips optimally with mixed-integer
              nonlinear programming</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-04 @ 00:29:37</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40569385"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
            <div class="text">
              <p>
                Try it out here (the submitted link goes to the GitHub repo):
                <a href="https://jstrieb.github.io/poker-chipper/"
                  >https://jstrieb.github.io/poker-chipper/</a
                >
              </p>
              <p>
                It turns out that picking chip denominations optimally—such that
                as many chips are distributed as possible, and such that the
                denominations are nice—is hard (in the computational complexity
                sense). Upon reflection, the problem seemed to be a perfect fit
                for constrained optimization.
              </p>
              <p>
                I first got a CLI prototype working with Z3 (an SMT solver with
                optimization capabilities
                <a href="https://github.com/Z3Prover/z3"
                  >https://github.com/Z3Prover/z3</a
                >) in Python. Then, I cross-compiled SCIP (<a
                  href="https://www.scipopt.org/"
                  >https://www.scipopt.org/</a
                >) to web assembly, and ported my code to use SCIP instead of Z3
                so it could run in the browser.
              </p>
              <p>
                The web interface is designed to be fast and easy to use on
                desktop and mobile.
              </p>
              <p>
                I would love to answer questions and discuss design choices. I'm
                also open to feedback and bug reports. Thanks for taking a look!
              </p>
            </div>
          </section>
        </section>
        <section id="40564489">
          <h3>
            <a class="item" href="https://www.mdpi.com/1424-8220/24/11/3349"
              >The state of the art in copter drones and flight control
              systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-03 @ 16:45:01</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40564489"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40561440">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/05/31/fifty_years_of_sql/"
              >Half a century of SQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-03 @ 11:04:06</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40561440"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40560979">
          <h3>
            <a class="item" href="https://poets.org/text/poets-odd-jobs"
              >Poets' Odd Jobs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-03 @ 09:51:37</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40560979"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40560010">
          <h3>
            <a
              class="item"
              href="https://samcurry.net/hacking-millions-of-modems"
              >Hacking millions of modems and investigating who hacked my
              modem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-03 @ 06:51:24</span
              ><span class="points-container"
                >Points: <span class="points">391</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40560010"
                  >Comments</a
                ><span class="descendants">: 224</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40559316">
          <h3>
            <a class="item" href="https://boz.com/articles/inbox-ten"
              >Inbox Ten</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-03 @ 04:22:18</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40559316"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40555415">
          <h3>
            <a
              class="item"
              href="https://blog.winter-software.com/2024/06/02/ctr-cart-protocol"
              >A Brief Look at the 3DS Cartridge Protocol</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-02 @ 16:39:31</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40555415"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40552257">
          <h3>
            <a class="item" href="https://github.com/andyk/ht"
              >ht: Headless Terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-02 @ 07:53:14</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40552257"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40544546">
          <h3>
            <a
              class="item"
              href="https://worldsensorium.com/learning-to-grow-with-the-hamptons-pepper-professionals/"
              >Learning to grow with the Hampton's pepper professionals</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-01 @ 10:48:00</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40544546"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
