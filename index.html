<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44397367">
          <h3>
            <a
              class="item"
              href="https://www.wakunguma.com/blog/rust-weird-expr"
              >Weird Expressions in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 15:08:26</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44397367"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44397168">
          <h3>
            <a
              class="item"
              href="https://parkerhiggins.net/2025/04/10-years-of-pomological-watercolors/"
              >10 Years of Pomological Watercolors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 14:42:04</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44397168"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44397124">
          <h3>
            <a class="item" href="https://qwenlm.github.io/blog/qwen-vlo/"
              >Qwen VLo: From "Understanding" the World to "Depicting" It</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 14:35:04</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44397124"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44396518">
          <h3>
            <a class="item" href="https://jameshard.ing/pilot"
              >Show HN: I'm an airline pilot – I built interactive graphs/globes
              of my flights</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 13:06:54</span
              ><span class="points-container"
                >Points: <span class="points">568</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44396518"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
            <div class="text">
              <p>
                Pilots everywhere are required to keep a logbook of all their
                flying hours, aircraft, airports, and so on. Since I track
                everything digitally (some people still just use paper
                logbooks!), I put together some data visualizations and a few 3D
                globes to show my flying history.
              </p>
              <p>
                This globe is probably my favourite so far:
                <a href="https://jameshard.ing/pilot/globes/all"
                  >https://jameshard.ing/pilot/globes/all</a
                >
              </p>
              <p>
                If you’ve got ideas for other graphs or ways to show this kind
                of data, I’d love to hear them!
              </p>
            </div>
          </section>
        </section>
        <section id="44396487">
          <h3>
            <a
              class="item"
              href="https://www.empirical.health/blog/effect-of-noise-on-sleep/"
              >The Effect of Noise on Sleep</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 13:03:10</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44396487"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44396342">
          <h3>
            <a
              class="item"
              href="https://supernuclear.substack.com/p/the-power-and-beauty-of-incrementalism"
              >The Power and Beauty of Incrementalism</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 12:39:53</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44396342"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44395810">
          <h3>
            <a class="item" href="https://github.com/dmf-archive/PILF"
              >Show HN: PILF, The ultimate solution to catastrophic oblivion on
              AI models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 11:10:54</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44395810"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44395799">
          <h3>
            <a
              class="item"
              href="https://kramkow.ski/article/2025/06/27/my_lights_run_on_bash.html"
              >My Lights Run on Bash – Tomasz Kramkowski</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 11:09:42</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44395799"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44394929">
          <h3>
            <a class="item" href="https://github.com/e6a5/zenta"
              >Show HN: Zenta – Mindfulness for Terminal Users</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 08:28:28</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44394929"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44394386">
          <h3>
            <a class="item" href="https://pj5cpu.wordpress.com/">PJ5 TTL CPU</a>
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 07:05:58</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44394386"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44394201">
          <h3>
            <a
              class="item"
              href="https://panadestein.github.io/blog/posts/mp.html"
              >Blazing Matrix Products</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 06:29:51</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44394201"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44394051">
          <h3>
            <a class="item" href="https://github.com/sirbread/sink"
              >Show HN: Sink – Sync any directory with any device on your local
              network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 06:01:37</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44394051"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
            <div class="text">
              <p>
                it just uses your local wifi. run it on your machines, tell them
                to trust each other, and you're set. and if you manage to edit
                the same file at once, it handles the conflict and saves both
                copies.
              </p>
              <p>
                for anyone who just wants to get files from point a to b without
                the headache. hope it makes your life a bit less annoying.
              </p>
              <p>
                github:
                <a href="https://github.com/sirbread/sink"
                  >https://github.com/sirbread/sink</a
                >
                binary:
                <a href="https://github.com/sirbread/sink/releases/tag/v0.1"
                  >https://github.com/sirbread/sink/releases/tag/v0.1</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44393942">
          <h3>
            <a class="item" href="https://nullprogram.com/blog/2025/06/26/"
              >Parameterized types in C using the new tag compatibility rule</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 05:31:56</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44393942"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44393817">
          <h3>
            <a class="item" href="https://github.com/pacocoursey/xslt"
              >XSLT – Native, zero-config build system for the Web</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 05:00:41</span
              ><span class="points-container"
                >Points: <span class="points">344</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44393817"
                  >Comments</a
                ><span class="descendants">: 263</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44393160">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/travel/when-a-lumberjacks-imagination-ran-wild-he-created-more-than-200-sculptures-in-wisconsins-northwoods-180986840/"
              >A lumberjack created more than 200 sculptures in Wisconsin's
              Northwoods</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 02:02:22</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44393160"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44390781">
          <h3>
            <a class="item" href="https://angadh.com/space-data-centers-1"
              >Starcloud can’t put a data centre in space at $8.2M in one
              Starship</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 20:06:28</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44390781"
                  >Comments</a
                ><span class="descendants">: 253</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44390501">
          <h3>
            <a
              class="item"
              href="https://alternativelayoutsystem.com/scripts/#same-sizer"
              >Alternative Layout System</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 19:31:29</span
              ><span class="points-container"
                >Points: <span class="points">328</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44390501"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44390488">
          <h3>
            <a
              class="item"
              href="https://sharnoff.io/blog/why-rust-compiler-slow"
              >Why is the Rust compiler so slow?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 19:29:32</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44390488"
                  >Comments</a
                ><span class="descendants">: 320</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44390452">
          <h3>
            <a
              class="item"
              href="https://justinfagnani.com/2025/06/26/the-time-is-right-for-a-dom-templating-api/"
              >The time is right for a DOM templating API</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 19:23:28</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44390452"
                  >Comments</a
                ><span class="descendants">: 178</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44387828">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44387828"
              >Launch HN: Issen (YC F24) – Personal AI language tutor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 14:32:28</span
              ><span class="points-container"
                >Points: <span class="points">295</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44387828"
                  >Comments</a
                ><span class="descendants">: 261</span></span
              >
            </h4>
            <div class="text">
              <a href="https://issen.com">https://issen.com</a>), a foreign
              language voice tutor app that adapts to your interests, goals, and
              needs.
              <p>
                Demo:
                <a
                  href="https://www.loom.com/share/a78e713d46934857a2dc88aed1bb100d?sid=ec4dc1f3-1a4f-4d75-8e87-efbb3d2b2e90"
                  >https://www.loom.com/share/a78e713d46934857a2dc88aed1bb100d?...</a
                >
              </p>
              <p>
                We started this company after struggling to find great tools to
                practice speaking Japanese and French. Having a tutor can be
                awesome, but there are downsides: they can be expensive (since
                you pay by the hour), difficult to schedule, and have a high
                upfront cost (finding a tutor you like often forces you to cycle
                through a few that you don’t).
              </p>
              <p>
                We wanted something that would talk with us — realistically, in
                full conversations — and actually help us improve. So we built
                it ourselves. The app relies on a custom voice AI pipeline
                combining STT (speech-to-text), TTS (text-to-speech), LLMs, long
                term memory, interruptions, turn-taking, etc. Getting
                speech-to-text to work well for learners was one of the hardest
                parts — especially with accents, multi-lingual sentences, and
                noisy environments. We now combine Gemini Flash, Whisper,
                Scribe, and GPT-4o-transcribe to minimize errors and keep the
                conversation flowing.
              </p>
              <p>
                We didn’t want to focus too much on gamification. In our
                experience, that leads to users performing well in the app,
                achieving long streaks and so on, without actually getting
                fluent in the language you're wanting to learn.
              </p>
              <p>
                With ISSEN you instantly speak and immerse yourself in the
                language, which, while not easy, is a much more efficient way to
                learn.
              </p>
              <p>
                We combine this with a word bank and SRS flashcards for new
                words learned in the AI voice chats, which allows very rapid
                improvement in both vocabulary and speaking skills. We also
                create custom curriculums for each student based on goals,
                interests, and preferences, and fully customizable settings like
                speed, turn taking, formality, etc.
              </p>
              <p>
                App: <a href="https://issen.com">https://issen.com</a> (works on
                web, iOS, Android) Pricing: 20 min free trial, $20–29/month
                (depending on duration and specific geography)
              </p>
              <p>
                We’d love your feedback — on the tech, the UX, or what you’d
                wish from a tool like this. Thanks!
              </p>
            </div>
          </section>
        </section>
        <section id="44387659">
          <h3>
            <a
              class="item"
              href="https://deepmind.google/discover/blog/alphagenome-ai-for-better-understanding-the-genome/"
              >AlphaGenome: AI for better understanding the genome</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 14:16:00</span
              ><span class="points-container"
                >Points: <span class="points">498</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44387659"
                  >Comments</a
                ><span class="descendants">: 165</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44385562">
          <h3>
            <a class="item" href="https://snowemu.com/"
              >Snow - Classic Macintosh emulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 09:08:00</span
              ><span class="points-container"
                >Points: <span class="points">270</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44385562"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/twvd/snow"
                >https://github.com/twvd/snow</a
              >, Announcement from creator:
              <a href="https://www.emaculation.com/forum/viewtopic.php?t=12509"
                >https://www.emaculation.com/forum/viewtopic.php?t=12509</a
              >, Originally-submitted source with further details:
              <a href="https://oldbytes.space/@smallsco/114747196289375530"
                >https://oldbytes.space/@smallsco/114747196289375530</a
              >
            </div>
          </section>
        </section>
        <section id="44361681">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2025/06/these-va-tech-scientists-are-building-a-better-fog-harp/"
              >VA Tech scientists are building a better fog harp</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-24 @ 00:33:00</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44361681"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44361288">
          <h3>
            <a
              class="item"
              href="https://jdiaz97.github.io/greenblog/posts/flutter_to_egui/"
              >I Switched from Flutter and Rust to Rust and Egui</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 23:31:13</span
              ><span class="points-container"
                >Points: <span class="points">188</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44361288"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44359454">
          <h3>
            <a class="item" href="https://mihaiolteanu.me/language-abstractions"
              >A Lisp adventure on the calm waters of the dead C (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 20:00:24</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44359454"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44359045">
          <h3>
            <a
              class="item"
              href="https://www.spacebar.news/moonbase-alpha-nasa-video-game/"
              >Moonbase Alpha: That time NASA made a meme video game</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 19:13:38</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44359045"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44358448">
          <h3>
            <a
              class="item"
              href="https://veitner.bearblog.dev/calculating-the-fibonacci-numbers-on-gpu/"
              >Calculating the Fibonacci numbers on GPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 18:10:19</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44358448"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44356456">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2025/06/this-archaeologist-built-a-replica-boat-to-sail-like-the-vikings/"
              >Sailing the fjords like the Vikings yields unexpected insights</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 14:56:02</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44356456"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44356385">
          <h3>
            <a class="item" href="https://samestep.com/blog/random-access/"
              >How much slower is random access, really?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 14:49:31</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44356385"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44356130">
          <h3>
            <a
              class="item"
              href="https://github.com/hansake/Whitesmiths-C-compiler"
              >Whitesmiths C compiler: One of the earliest commercial C
              compilers available</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 14:25:56</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44356130"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
