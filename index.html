<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40139837">
          <h3>
            <a class="item" href="https://nutjs.dev/blog/i-give-up"
              >I'm giving up on open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 02:34:31</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40139837"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40139510">
          <h3>
            <a class="item" href="https://beebase.sourceforge.io"
              >BeeBase, a programmable relational database with graphical user
              interface</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 01:44:47</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40139510"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40139503">
          <h3>
            <a class="item" href="https://www.opencompute.org/about"
              >The Open Compute Project</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 01:43:54</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40139503"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40139434">
          <h3>
            <a class="item" href="https://emildziewanowski.com/flowfields/"
              >Simulating Jupiter</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 01:32:39</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40139434"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40139398">
          <h3>
            <a class="item" href="https://github.com/apple/corenet"
              >Apple releases CoreNet, a library for training deep neural
              networks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 01:26:48</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40139398"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40139291">
          <h3>
            <a
              class="item"
              href="https://undark.org/2024/04/22/darkness-in-chile-atacama-desert/"
              >Protecting the Darkness in Chile's Atacama Desert</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 01:10:51</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40139291"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40138824">
          <h3>
            <a
              class="item"
              href="https://www.ftc.gov/legal-library/browse/rules/noncompete-rule"
              >FTC adopts a comprehensive ban on new noncompetes with all
              workers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-24 @ 00:01:51</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40138824"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40138579">
          <h3>
            <a
              class="item"
              href="https://xlinux.nist.gov/dads/HTML/americanFlagSort.html"
              >American Flag Sort</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 23:26:58</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40138579"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40138228">
          <h3>
            <a class="item" href="https://esphome.io/index.html">ESPHome</a>
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 22:46:44</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40138228"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40138193">
          <h3>
            <a
              class="item"
              href="http://www.lel.ed.ac.uk/~gpullum/loopsnoop.html"
              >Scooping the Loop Snooper (2000)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 22:42:12</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40138193"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40138063">
          <h3>
            <a class="item" href="https://github.com/FlowTestAI/FlowTest"
              >Show HN: Use LLMs to Interact with APIs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 22:23:01</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40138063"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://blog.langchain.dev/empowering-development-with-flowtestai/"
                >https://blog.langchain.dev/empowering-development-with-flowt...</a
              >
              , use LLMs to construct an API first runnable workflow with an IDE
              experience.
            </div>
          </section>
        </section>
        <section id="40137201">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/shortbread/jobs/8jV0RY9-founding-engineer"
              >Shortbread (YC W23) is hiring a founding engineer in SF for AI
              comics creation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 21:01:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40136440">
          <h3>
            <a
              class="item"
              href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2023SW003807"
              >Digitized Continuous Magnetic Recordings for the 1859 Carrington
              Event</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 19:50:45</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40136440"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40136208">
          <h3>
            <a class="item" href="https://graph.henryn.ca"
              >Network visualization of 50k blogs and links</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 19:33:21</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40136208"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40136076">
          <h3>
            <a
              class="item"
              href="https://www.willusher.io/graphics/2024/04/22/webgpu-marching-cubes"
              >GPU compute in the browser at the speed of native: WebGPU
              marching cubes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 19:22:22</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40136076"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40136026">
          <h3>
            <a class="item" href="https://github.com/dafny-lang/dafny"
              >Dafny is a verification-aware programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 19:18:00</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40136026"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40135458">
          <h3>
            <a class="item" href="https://github.com/thomiceli/opengist"
              >Opengist: Open-source alternative to GitHub Gists</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 18:33:12</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40135458"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40134921">
          <h3>
            <a
              class="item"
              href="https://www.theturnsignalblog.com/apples-risky-bet-on-carplay/"
              >Apple's risky bet on CarPlay</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 17:54:52</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40134921"
                  >Comments</a
                ><span class="descendants">: 294</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40134534">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/2024/04/22/intel-meteor-lakes-npu/"
              >Intel Meteor Lake's NPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 17:24:04</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40134534"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40133976">
          <h3>
            <a
              class="item"
              href="https://www.wheresyoured.at/the-men-who-killed-google/"
              >The man who killed Google Search?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 16:43:59</span
              ><span class="points-container"
                >Points: <span class="points">1228</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40133976"
                  >Comments</a
                ><span class="descendants">: 577</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40132719">
          <h3>
            <a
              class="item"
              href="https://twitter.com/gf_256/status/1782656618015904103"
              >Reverse engineering a software crack</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 14:58:23</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40132719"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40132373">
          <h3>
            <a class="item" href="https://getada.dev"
              >Show HN: Getada: rustup-like installer for Ada's
              toolchain/package manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 14:26:26</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40132373"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
            <div class="text">
              <p>
                Getada was inspired by Rustup[2] and aside from the init script
                is written entirely in Ada.
              </p>
              <p>
                It's completely open source and you can check out the readme and
                code on github[3]. It currently supports all non-windows
                platforms that Alire has an official release for, which at
                present is Linux (glibc) and MacOS. If you try running it on an
                unsupported platform, it tries to point you in the right
                direction. For example, you can install Alire on windows with an
                already-existing installer.
              </p>
              <p>
                It downloads the latest version of Alire[4] (Ada's toolchain and
                package manager, similar to Cargo) for your platform as a zip
                file to a temporary directory and then extracts it to a binary
                directory. By default the temporary directory (configure with
                "-t /directory" or "--tmp=/directory") defaulted to $TMPDIR or
                /tmp. The config directory is ~/.getada (change via "-c
                /directory", "--cfg=/directory", or $GETADA_CFG), and the alr
                and getada binaries go in ~/.getada/bin (configure with ""-b
                /directory", "--bin=/directory", or $GETADA_BIN). It also tries
                to add the file to your path by dropping a "env.sh" file into
                ~/.profile/ (disable with -p or --no-path).
              </p>
              <p>
                If you don't allow executables in temporary or home directories,
                you can change all of these via environmental variables or
                passing parameters.
              </p>
              <p>You can remove it all by running: getada --uninstall</p>
              <p>
                Now you can create a brand new Ada project with: alr init --bin
                my_project (How to use Alire[5] for more details)
              </p>
              <p>
                Since one of the biggest complaints about Ada is getting the
                toolchain [6], I hope this can solve a lot of problems for
                newcomers to the language.
              </p>
              <p>
                [1] <a href="https://www.getada.dev">https://www.getada.dev</a>
              </p>
              <p>[2] <a href="https://rustup.rs/">https://rustup.rs/</a></p>
              <p>
                [3]
                <a href="https://github.com/aj-ianozi/getada"
                  >https://github.com/aj-ianozi/getada</a
                >
              </p>
              <p>
                [4] <a href="https://alire.ada.dev/">https://alire.ada.dev/</a>
              </p>
              <p>
                [5]
                <a href="https://www.getada.dev/how-to-use-alire.html"
                  >https://www.getada.dev/how-to-use-alire.html</a
                >
              </p>
              <p>
                [6]
                <a href="https://programming.dev/comment/9438211"
                  >https://programming.dev/comment/9438211</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="40131674">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/mathematicians-marvel-at-crazy-cuts-through-four-dimensions-20240422/"
              >Mathematicians marvel at 'crazy' cuts through four dimensions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 13:21:14</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40131674"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40130924">
          <h3>
            <a
              class="item"
              href="https://leanprover-community.github.io/con-nf//"
              >New Foundations is consistent â€“ a difficult mathematical proof
              proved using Lean</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 12:01:03</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40130924"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40130605">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2024-04-22/meta-is-opening-up-quest-headset-operating-system-to-rivals"
              >Meta 'Opening Up' Quest Headset Operating System to Rivals</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 11:24:28</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40130605"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40129225">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40129225"
              >Ask HN: How does deploying a fine-tuned model work</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 06:48:32</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40129225"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
            <div class="text">
              If I've managed to build my own model, say a fine-tuned version of
              Llama and trained it on some GPUs, how do I then deploy it and use
              it in an app. Does it need to be running on the GPUs all the time
              or can I host the model on a web server or something. Sorry if
              this is an obvious/misinformed question, I'm a beginner in this
              space
            </div>
          </section>
        </section>
        <section id="40128837">
          <h3>
            <a class="item" href="https://sfxr.me/"
              >Jsfxr: 8-Bit sound maker and sfx generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-23 @ 05:35:25</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40128837"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40114127">
          <h3>
            <a
              class="item"
              href="https://vgnotepad.blogspot.com/2024/04/bottle-plotter.html"
              >Bottle Plotter</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-22 @ 13:26:02</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40114127"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40112013">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2024/04/everest-mountaineer-george-mallorys-letters-have-been-digitized-for-posterity/"
              >Explore a digitized collection of doomed Everest climber's
              letters home</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-22 @ 07:03:52</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40112013"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40103416">
          <h3>
            <a
              class="item"
              href="https://without.boats/blog/coroutines-and-effects/"
              >Coroutines and Effects</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-21 @ 05:41:40</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40103416"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
