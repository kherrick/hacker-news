<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35765921">
          <h3>
            <a
              class="item"
              href="https://www.npr.org/2023/04/29/1172775448/people-murder-unsolved-killings-record-high"
              >More people are getting away with murder. Unsolved killings reach
              a record high</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 19:39:11</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35765921"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35765882">
          <h3>
            <a
              class="item"
              href="https://github.com/ggerganov/whisper.cpp/releases/tag/v1.4.0"
              >Whisper.cpp v1.4.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 19:35:32</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35765882"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35765707">
          <h3>
            <a class="item" href="https://github.com/dylanaraps/pure-sh-bible"
              >Pure Sh Bible</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 19:16:41</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35765707"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35765373">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/by-invitation/2023/04/28/yuval-noah-harari-argues-that-ai-has-hacked-the-operating-system-of-human-civilisation"
              >AI has hacked the operating system of human civilisation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 18:42:11</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35765373"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35765177">
          <h3>
            <a
              class="item"
              href="https://thechipletter.substack.com/p/the-risc-wars-part-1-the-cambrian-c55"
              >The RISC Wars Part 1: The Cambrian Explosion</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 18:20:33</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35765177"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35764635">
          <h3>
            <a class="item" href="https://pysaas.io"
              >Show HN: The pure Python SaaS starter kit</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 17:22:42</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35764635"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>
                Recently, I’ve noticed there’s a decently high barrier to entry
                in developing competitive, full-stack SaaS applications.
              </p>
              <p>
                Beside the standard, boring features that take months to
                implement, you typically have to know several languages and
                frameworks, and be familiar with fancy frontend styling classes.
              </p>
              <p>
                I’m working hard right now to solve this problem by building
                PySaaS- The 100% pure Python SaaS starter kit.
              </p>
              <p>
                PySaaS is a boilerplate Python codebase that takes care of the
                fundamental components standard to all SaaS applications.
              </p>
              <p>
                The codebase uses the Pynecone web framework to compile your
                frontend into a NextJS app, so you never have to touch any HTML,
                CSS, or Javascript. Pynecone is easy to learn, yet fully
                flexible and powerful enough for advanced use cases. We
                implement out-of-the-box functionality for secure Firebase user
                authentication, Lemon Squeezy subscription management (MoR
                removes a major tax headache), Notion as a headless blog CMS,
                and more.
              </p>
              <p>
                Our mission is to help developers and founders save months of
                development time and focus on building unique features, which
                will in turn provide more opportunities to generate revenue and
                give value to customers.
              </p>
              <p>
                And easily do it in pure Python! Frontend. Backend. All in
                Python.
              </p>
              <p>
                To check out the live demo for free, click the link and then the
                “See Demo” button.
              </p>
              <p>Let me know what you think.</p>
            </div>
          </section>
        </section>
        <section id="35764584">
          <h3>
            <a
              class="item"
              href="https://www.thecurb.com.au/40-years-of-koyaanisqatsi/"
              >40 Years of Koyaanisqatsi</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 17:17:09</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35764584"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35764476">
          <h3>
            <a
              class="item"
              href="https://www.nbcnews.com/now/video/engineers-develop-water-filtration-system-that-removes-forever-chemicals-171419717913"
              >Engineers develop water filtration that permanently removes
              “forever chemicals”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 17:03:24</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35764476"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35764445">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/patterns"
              >Patterns (YC S21) Is Hiring AI Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 17:00:37</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35764355">
          <h3>
            <a class="item" href="https://github.com/georgia-tech-db/eva"
              >Show HN: Eva AI-Relational Database System for Faster AI-Powered
              Applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 16:52:01</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35764355"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <p>
                We are building EVA, an AI-Relational database system with
                first-class support for deep learning models. Our goal with EVA
                is to create a platform that supports AI-powered multi-modal
                database applications operating on structured (tables, feature
                vectors, etc.) and unstructured data (videos, podcasts, pdf,
                etc.) with deep learning models. EVA comes with a wide range of
                models for analyzing unstructured data, including models for
                object detection, OCR, text summarization, audio speech
                recognition, and more.
              </p>
              <p>
                The key feature of EVA is its AI-centric query optimizer. This
                optimizer is designed to speed up AI-powered applications using
                a collection of optimizations inspired by relational database
                systems. Two of the most important optimizations are:
              </p>
              <p>
                + Caching: EVA automatically reuses previous query results
                (e.g., inference results), eliminating redundant computation and
                saving you money on inference.
              </p>
              <p>
                + Predicate Reordering: EVA optimizes the order in which query
                predicates are evaluated (e.g., running faster, more selective
                deep learning models first), leading to faster queries.
              </p>
              <p>
                Besides saving money spent on inference, EVA also makes it
                easier to write SQL queries to set up multi-modal AI pipelines.
                With EVA, you can quickly integrate your AI models into the
                database system and seamlessly query structured and unstructured
                data.
              </p>
              <p>
                We are constantly working on improving EVA and would love to
                hear your feedback!
              </p>
            </div>
          </section>
        </section>
        <section id="35764212">
          <h3>
            <a class="item" href="https://lwn.net/Articles/691932/"
              >Function multi-versioning in GCC 6 (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 16:38:35</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35764212"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35763483">
          <h3>
            <a class="item" href="https://github.com/mlc-ai/mlc-llm"
              >MLC-LLM: GPT/Llama on consumer-class GPUs and phones</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 15:30:17</span
              ><span class="points-container"
                >Points: <span class="points">228</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35763483"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35763100">
          <h3>
            <a
              class="item"
              href="https://ishadeed.com/article/rebuild-featured-news-modern-css/"
              >Rebuilding a featured news section with modern CSS: Vox news</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 14:55:55</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35763100"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35762780">
          <h3>
            <a
              class="item"
              href="https://covertactionmagazine.com/2023/04/25/whistleblowers-are-the-conscience-of-society-yet-suffer-gravely-for-trying-to-hold-the-rich-and-powerful-accountable-for-their-sins/"
              >Whistleblowers are the conscience of society, yet suffer
              gravely</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 14:17:46</span
              ><span class="points-container"
                >Points: <span class="points">612</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35762780"
                  >Comments</a
                ><span class="descendants">: 259</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35762483">
          <h3>
            <a class="item" href="http://www.braeunig.us/space/orbmech.htm"
              >Orbital Mechanics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 13:45:37</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35762483"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35762284">
          <h3>
            <a
              class="item"
              href="https://chess24.com/en/watch/live-tournaments/nepo-ding-world-chess-championship-2023/2/1/4"
              >Fide World Chess Championship Decided in Rapid Tiebreaks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 13:20:09</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35762284"
                  >Comments</a
                ><span class="descendants">: 139</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35762175">
          <h3>
            <a class="item" href="https://github.com/Textualize/frogmouth"
              >Show HN: Frogmouth – A Markdown browser for your terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 13:05:01</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35762175"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
            <div class="text">
              <p>
                Frogmouth is a TUI to display Markdown files. It does a passable
                job of displaying Markdown, with code blocks and tables. No
                image support as yet.
              </p>
              <p>
                It's very browser like, with navigation stack, history, and
                bookmarks. Works with both the mouse and keyboard.
              </p>
              <p>
                There are shortcuts for viewing README.md files and other
                Markdown on GitHub and GitLab.
              </p>
              <p>License is MIT.</p>
              <p>Let me know what you think...</p>
            </div>
          </section>
        </section>
        <section id="35761979">
          <h3>
            <a class="item" href="https://www.dbpilot.io/"
              >Show HN: I built a database GUI with ChatGPT integration</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 12:36:46</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35761979"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
            <div class="text">
              <p>
                Simply ask what data you are looking for - GPT will figure out
                which tables to use, how to join them, and then write a query
                for you.
              </p>
              <p>
                The AI assistant knows which tables and columns exist in your
                database, meaning it can write queries specific to your schema.
              </p>
              <p>
                Besides that, it doesn't have access to any actual data from
                your database though, meaning your data doesn't get exposed to
                OpenAI.
              </p>
            </div>
          </section>
        </section>
        <section id="35761706">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/boeing-max-crashes-faa-ea8fac0ad2758b08c58d2d64756fbf37"
              >FAA overruled engineers, let Boeing Max keep flying</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 11:48:16</span
              ><span class="points-container"
                >Points: <span class="points">199</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35761706"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35761671">
          <h3>
            <a
              class="item"
              href="https://mlc.ai/chapter_introduction/index.html#what-is-ml-compilation"
              >What Is ML Compilation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 11:41:28</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35761671"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35761457">
          <h3>
            <a
              class="item"
              href="https://brickexperimentchannel.wordpress.com/2023/04/29/lego-googol-machine/"
              >Lego Googol Machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 11:06:41</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35761457"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35761368">
          <h3>
            <a class="item" href="https://mlc.ai/mlc-llm/#iphone"
              >Vicuna on iPhone</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 10:49:16</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35761368"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35761296">
          <h3>
            <a
              class="item"
              href="https://github.com/juliusgeo/branchless_bisect"
              >Beating Bisect with Branchless Binary Search</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 10:36:25</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35761296"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35760489">
          <h3>
            <a
              class="item"
              href="https://github.com/ggerganov/llama.cpp/discussions/1220"
              >llama.cpp: Roadmap May 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 07:55:35</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35760489"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35760265">
          <h3>
            <a class="item" href="https://gwern.net/review/bakewell"
              >The invention of selective breeding was unbelievably late
              (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 06:58:47</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35760265"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35760087">
          <h3>
            <a
              class="item"
              href="https://internationalbanker.com/brokerage/why-are-lithium-prices-collapsing/"
              >Why Are Lithium Prices Collapsing?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 06:16:12</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35760087"
                  >Comments</a
                ><span class="descendants">: 395</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35759314">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/04/26/books/review/knowing-what-we-know-simon-winchester.html"
              >Simon Winchester devotes his anecdotal powers to why and how we
              know what we do</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 02:49:00</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35759314"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35758842">
          <h3>
            <a
              class="item"
              href="https://grist.org/technology/microsoft-right-to-repair-quietly-supported-legislation-to-make-it-easier-to-fix-devices-heres-why-thats-a-big-deal/"
              >Microsoft quietly supported legislation to make it easier to fix
              devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-30 @ 01:14:02</span
              ><span class="points-container"
                >Points: <span class="points">491</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35758842"
                  >Comments</a
                ><span class="descendants">: 273</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35756136">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/04/29/arts/william-bache-album-smithsonian-arsenic.html"
              >Digitized Silhouette Portraits Shed Light on 19th Century Life</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-29 @ 19:15:38</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35756136"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35738632">
          <h3>
            <a
              class="item"
              href="https://www.infoq.com/news/2023/04/late-arch-functional-programming/"
              >Late Architecture with Functional Programming</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-28 @ 07:47:03</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35738632"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
