<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41333059">
          <h3>
            <a class="item" href="https://www.tesorio.com/careers#job-openings"
              >Tesorio Is Hiring a Senior GenAI Engineer and Django Engineer
              (100% Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 21:01:15</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332891">
          <h3>
            <a
              class="item"
              href="https://variety.com/2024/film/news/megalopolis-trailer-fake-quotes-ai-lionsgate-1236116485/"
              >'Megalopolis' Trailer's Fake Critic Quotes Were AI-Generated</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 20:38:49</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332891"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332682">
          <h3>
            <a
              class="item"
              href="https://newsroom.ucla.edu/releases/molecule-restores-cognition-memory-in-alzheimers-disease-model-mice"
              >Molecule restores cognition and memory in Alzheimer's disease
              mouse study</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 20:13:09</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332682"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332537">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/gamedev/comments/1ezirdx/how_i_lost_my_google_play_dev_account_forever/"
              >How I lost my Google Play dev account forever</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 19:56:20</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332537"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332427">
          <h3>
            <a class="item" href="https://xeiaso.net/blog/2024/k8s-irc-client/"
              >My IRC client runs on Kubernetes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 19:46:40</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332427"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332342">
          <h3>
            <a
              class="item"
              href="https://marc.info/?l=openbsd-cvs&amp;m=172443408727088&amp;w=2"
              >We have reached OpenBSD of Theseus</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 19:39:11</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332342"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332338">
          <h3>
            <a
              class="item"
              href="https://daniel.haxx.se/blog/2024/07/03/wcurl-is-here/"
              >Wcurl Is Here</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 19:38:28</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332338"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41331369">
          <h3>
            <a
              class="item"
              href="https://www.macrumors.com/2024/08/23/meta-cancels-high-end-headset/"
              >Meta cancels high-end mixed reality headset after Apple Vision
              Pro struggles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 18:00:17</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41331369"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41330852">
          <h3>
            <a
              class="item"
              href="https://android-developers.googleblog.com/2024/08/adding-16-kb-page-size-to-android.html"
              >Adding 16 kb page size to Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 17:14:05</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41330852"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41330478">
          <h3>
            <a
              class="item"
              href="https://jxnl.co/writing/2024/09/21/chase-bank-small-business-nightmare/"
              >Cautionary tale on using Chase bank for indie business</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 16:38:18</span
              ><span class="points-container"
                >Points: <span class="points">217</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41330478"
                  >Comments</a
                ><span class="descendants">: 180</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41330319">
          <h3>
            <a class="item" href="https://www.filfre.net/2024/08/sanitarium/"
              >Sanitarium</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 16:22:12</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41330319"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41330258">
          <h3>
            <a class="item" href="https://blog.isosceles.com/openssh-backdoors/"
              >OpenSSH Backdoors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 16:14:54</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41330258"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41329750">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41329750"
              >Launch HN: Moonglow (YC S24) – Serverless Jupyter Notebooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 15:20:20</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41329750"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
            <div class="text">
              <a href="https://moonglow.ai">https://moonglow.ai</a>). We let you
              run local Jupyter notebooks on remote cloud GPUs. Here’s a quick
              demo video:
              <a href="https://www.youtube.com/watch?v=Bf-xTsDT5FQ"
                >https://www.youtube.com/watch?v=Bf-xTsDT5FQ</a
              >. If you want to try it out directly, there are instructions
              below.
              <p>
                With Moonglow, you can start and stop pre-configured remote
                cloud machines within VSCode, and it makes those servers appear
                to VSCode like normal Jupyter kernels that you can connect your
                notebook to.
              </p>
              <p>
                We built this because we learned from talking to data scientists
                and ML researchers that scaling up experiments is hard. Most
                researchers like to start in a Jupyter notebook, but they
                rapidly hit a wall when they need to scale up to more powerful
                compute resources. To do so, they need to spin up a remote
                machine and then also start a Jupyter server on it so they can
                access it from their laptop. To avoid wasting compute resources,
                they might end up setting this up and tearing it down multiple
                times a day.
              </p>
              <p>
                When Trevor used to do ML research at Stanford, he faced this
                exact problem: often, he needed to move between cloud providers
                to find GPU availability. This meant he was constantly clicking
                through various cloud compute UIs, as well as copying both
                notebook files and data across different providers over and over
                again.
              </p>
              <p>
                Our goal with Moonglow is to make it easy to transfer your dev
                environment from your local machine to your cloud GPU. If you’ve
                used Google Colab, you’ve seen how easy it is to switch from a
                CPU to a GPU - we want to bring that experience to VSCode and
                Cursor.
              </p>
              <p>
                If you’re curious, here’s some background on how it works. You
                can model a local Jupyter server as actually having three parts:
                a frontend (also known as a notebook), a server and an
                underlying backend kernel. The frontend is where you enter code
                into your notebook, the kernel is what actually executes it, and
                the server in the middle is responsible for spinning up and
                restarting kernels. Moonglow is a rewrite of this middle server
                part: where an ordinary Jupyter server would just start and stop
                kernels, we’ve added extra orchestration that provisions a
                machine from your cloud, starts a kernel on it, then sets up a
                tunnel between you and that kernel.
              </p>
              <p>
                In the demo video (<a
                  href="https://www.youtube.com/watch?v=Bf-xTsDT5FQ"
                  >https://www.youtube.com/watch?v=Bf-xTsDT5FQ</a
                >), you can see Trevor demonstrate how he uses Moonglow to train
                a ResNet to 94% accuracy on the CIFAR-10 classification
                benchmark in 1m16s of wall clock time. (In fact, it only takes 5
                seconds of H100 time; the rest of it is all setup.)
              </p>
              <p>
                On privacy: we tunnel your code and notebook output through our
                servers. We don’t store or log this data if you are bringing
                your own compute provider. However, we do monitor it if you are
                using compute provided by us, to make sure that what you are
                running doesn’t break our compute vendor’s terms of service.
              </p>
              <p>
                We currently aren’t charging individuals for Moonglow. When we
                do, we plan to price individuals a reasonable amount per-seat,
                and we have a business plan for teams with more requirements.
              </p>
              <p>
                Right now, we support Runpod and AWS. We’ll add support for GCP
                and Azure soon, too. (If you’d like to use us to connect to your
                own AWS account, please email me at trevor@moonglow.ai.)
              </p>
              <p>
                For today’s launch on HN only, you can get a free API key at
                <a href="https://app.moonglow.ai/hn-launch"
                  >https://app.moonglow.ai/hn-launch</a
                >. You don’t need to sign in and you don’t need to bring your
                own compute; we’ll let you run it on servers we provide. This
                API key will give you enough credit to run Moonglow with an A40
                for an hour.
              </p>
              <p>
                If you're signed in, you won't be able to see the free credits
                page, but your account will have automatically had free credits
                added to it.
              </p>
              <p>
                We’re still very early, and there are a lot of features we’d
                still like to add, but we’d love to get your feedback on this.
                We look forward to your comments!
              </p>
            </div>
          </section>
        </section>
        <section id="41329505">
          <h3>
            <a class="item" href="https://github.com/dpjudas/SurrealEngine"
              >SurrealEngine: Open-source reimplementation of Unreal Engine with
              playable UT99</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 14:50:09</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41329505"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41328784">
          <h3>
            <a
              class="item"
              href="https://torrentfreak.com/17-year-old-student-exposes-germanys-secret-pirate-site-blocklist-240822/"
              >17-Year-Old Student Exposes Germany's 'Secret' Pirate Site
              Blocklist</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 13:20:19</span
              ><span class="points-container"
                >Points: <span class="points">349</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41328784"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41328749">
          <h3>
            <a class="item" href="https://vega.github.io/vega/"
              >Vega – A declarative language for interactive visualization
              designs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 13:15:40</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41328749"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41328677">
          <h3><a class="item" href="http://textbundle.org/">TextBundle</a></h3>
          <section>
            <h4>
              <span>2024-08-23 @ 13:06:05</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41328677"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41328447">
          <h3>
            <a class="item" href="https://github.com/PlatformLab/NanoLog"
              >Nanolog supports logging with 7 ns median latency</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 12:32:15</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41328447"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41328185">
          <h3>
            <a class="item" href="https://snapdiagram.xyz/"
              >SnapDiagram – Instantly Convert Hand-Drawn Diagrams to Digital
              with AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 11:57:31</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41328185"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41327735">
          <h3>
            <a class="item" href="https://github.com/beac0n/ruroco"
              >Show HN: Ruroco – like port knocking, but better</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 10:19:07</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41327735"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
            <div class="text">
              <p>
                ruroco (RUn RemOte COmmand) is a tool that lets you execute
                commands on a server by sending UDP packets (instead of knocking
                on ports).
              </p>
              <p>the tool consist of 3 binaries:</p>
              <p>
                - client -&gt; runs on your notebook/computer and sends the UDP
                packets
              </p>
              <p>
                - server -&gt; receives the UDP packets and makes sure that they
                are valid
              </p>
              <p>
                - commander -&gt; runs the command encoded by the data of the
                UDP packet if it's valid
              </p>
              <p>
                The commands are configured on the server side, so the client
                does not define what is going to be executed, it only picks from
                existing commands.
              </p>
              <p>
                I use this tool to open up the SSH port on my server via ufw,
                but only for the IP address from where I'm connecting, so the
                SSH port appears closed for everyone else, except me.
              </p>
              <p>
                This is my very first "real" rust project, so any feedback is
                highly appreciated :)
              </p>
              <p>Enjoy!</p>
            </div>
          </section>
        </section>
        <section id="41326604">
          <h3>
            <a
              class="item"
              href="https://takes.jamesomalley.co.uk/p/secret-paf-report"
              >We need to liberate the Postcode Address File</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 06:36:29</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41326604"
                  >Comments</a
                ><span class="descendants">: 262</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41326357">
          <h3>
            <a
              class="item"
              href="https://nautil.us/confessions-of-a-theoretical-physicist-787199/"
              >Confessions of a Theoretical Physicist</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 05:14:35</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41326357"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41326179">
          <h3>
            <a class="item" href="https://github.com/w3c/epubcheck"
              >EPUBCheck – The official conformance checker for ePub
              publications</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 04:31:35</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41326179"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41325889">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2024/Aug/23/anthropic-dangerous-direct-browser-access/"
              >Claude's API now supports CORS requests, enabling client-side
              applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 03:05:33</span
              ><span class="points-container"
                >Points: <span class="points">325</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41325889"
                  >Comments</a
                ><span class="descendants">: 151</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41322818">
          <h3>
            <a class="item" href="https://blog.val.town/blog/codegen/"
              >How we built Townie – an app that generates fullstack apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-22 @ 18:01:01</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41322818"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41312834">
          <h3>
            <a class="item" href="https://fly.io/blog/accident-forgiveness/"
              >Accident Forgiveness</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 18:27:56</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41312834"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41307918">
          <h3>
            <a class="item" href="https://github.com/jhj0517/Whisper-WebUI"
              >Whisper-WebUI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 08:01:01</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41307918"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41302695">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=xyLr8z5-q5Q"
              >SwissMicros DM32 Released [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 18:36:34</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41302695"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294663">
          <h3>
            <a class="item" href="https://github.com/gruhn/typescript-sudoku"
              >Playing Sudoku in TypeScript while the type checker highlights
              mistakes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 21:18:19</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294663"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41293299">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/the-physics-of-cold-water-may-have-jump-started-complex-life/"
              >The Physics of Cold Water May Have Jump-Started Complex Life</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 18:10:31</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41293299"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
