<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45604823">
          <h3>
            <a
              class="item"
              href="https://www.rilldata.com/blog/why-pivot-tables-never-die"
              >Like MS Excel, Pivot tables never die</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 13:03:47</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45604823"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45604700">
          <h3>
            <a class="item" href="https://github.com/inkeep/agents"
              >Launch HN: Inkeep (YC W23) – Open Source Agent Builder</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 12:50:08</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45604700"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <a href="https://go.inkeep.com/video"
                >https://go.inkeep.com/video</a
              >.
              <p>
                As a developer, the flow is: 1) Build AI Chat Assistants or AI
                Workflows with the TypeScript SDK 2) Run `inkeep push` from your
                CLI to publish 3)Edit agents in the visual builder (or hand off
                to non-technical teams) 4) Run `inkeep pull to edit in code
                again.
              </p>
              <p>
                We built this because we wanted the accessibility of no-code
                workflow builders (n8n, Zapier), but the flexibility and devex
                of code-based agent frameworks (LangGraph, Mastra). We also
                wanted first-class support for chat assistants with interactive
                UIs, not just workflows. OpenAI got close, but you can only do a
                one-time export from visual builder to code and there’s vendor
                lock-in.
              </p>
              <p>
                How I've used it: I bootstrapped a few agents for our marketing
                and sales teams, then was able to hand off so they can maintain
                and create their own agents. This has enabled us to adopt agents
                across technical and non-technical roles in our company on a
                single platform.
              </p>
              <p>
                To try it, here’s the quickstart:
                <a href="https://go.inkeep.com/quickstart"
                  >https://go.inkeep.com/quickstart</a
                >.
              </p>
              <p>
                We leaned on open protocols to make it easy to use agents
                anywhere: An MCP endpoint, so agents can be used from
                Cursor/Claude/ChatGPT A Chat UI library with interactive
                elements you can customize in React An API endpoint compatible
                with the Vercel AI SDK `useChat` hook Support for Agent2Agent
                (A2A) so they work with other agent ecosystems
              </p>
              <p>
                We made some practical templates like a customer_support,
                deep_research, and docs_assistant. Deployment is easy with
                Vercel/Docker with a fair-code license and there's a traces UI
                and OTEL logs for observability.
              </p>
              <p>
                Under the hood, we went all-in on a multi-agent architecture.
                Agents are made up of LLMs, MCPs, and agent-to-agent
                relationships. We’ve found this approach to be easier to
                maintain and more flexible than traditional “if/else” approaches
                for complex workflows.
              </p>
              <p>
                The interoperability works because the SDK and visual builder
                share a common underlying representation, and the Inkeep CLI
                bridges it with a mix of LLMs and TypeScript syntactic sugar.
                Details in our docs:
                <a href="https://docs.inkeep.com">https://docs.inkeep.com</a>.
              </p>
              <p>
                We’re open to ideas and contributions! And would love to hear
                about your experience building agents - what works, hasn’t
                worked, what’s promising?
              </p>
            </div>
          </section>
        </section>
        <section id="45604673">
          <h3>
            <a class="item" href="https://hyperflask.dev/"
              >Hyperflask – Full stack Flask and Htmx framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 12:46:28</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45604673"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45604451">
          <h3>
            <a
              class="item"
              href="https://100x.bot/a/a-stateful-browser-agent-using-self-healing-dom-maps"
              >A stateful browser agent using self-healing DOM maps</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 12:21:36</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45604451"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45604372">
          <h3>
            <a
              class="item"
              href="https://journal.media-culture.org.au/index.php/mcjournal/article/view/3108"
              >Nightmare Fuel: What is Skibidi Toilet, How it demos a
              non-narrative future</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 12:11:18</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45604372"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45604308">
          <h3>
            <a class="item" href="https://www.workatastartup.com/jobs/44310"
              >Jiga (YC W21) Is Hiring Full Stacks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 12:00:45</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45602676">
          <h3>
            <a
              class="item"
              href="https://github.com/liquibase/liquibase/issues/7374"
              >Liquibase continues to advertise itself as "open source" despite
              license switch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 08:02:52</span
              ><span class="points-container"
                >Points: <span class="points">255</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45602676"
                  >Comments</a
                ><span class="descendants">: 198</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45602197">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-hidden-math-of-ocean-waves-crashes-into-view-20251015/"
              >The Hidden Math of Ocean Waves Crashes Into View</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 06:54:23</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45602197"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45602124">
          <h3>
            <a
              class="item"
              href="https://www.usmint.gov/news/press-releases/united-states-mint-releases-2026-american-innovation-one-dollar-coin-program-designs"
              >Steve Jobs and Cray-1 to be featured on 2026 American Innovations
              $1 coin</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 06:39:09</span
              ><span class="points-container"
                >Points: <span class="points">199</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45602124"
                  >Comments</a
                ><span class="descendants">: 184</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45601982">
          <h3>
            <a class="item" href="https://lwn.net/Articles/1039073/"
              >Upcoming Rust language features for kernel development</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 06:12:51</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45601982"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45601834">
          <h3>
            <a class="item" href="https://ollama.com/blog/coding-models"
              >New coding models and integrations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 05:46:50</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45601834"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45601750">
          <h3>
            <a
              class="item"
              href="https://www.propublica.org/article/inside-turbotax-20-year-fight-to-stop-americans-from-filing-their-taxes-for-free"
              >TurboTax’s 20-year fight to stop Americans from filing taxes for
              free (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 05:31:31</span
              ><span class="points-container"
                >Points: <span class="points">462</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45601750"
                  >Comments</a
                ><span class="descendants">: 234</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45601230">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2507.16126"
              >TaxCalcBench: Evaluating Frontier Models on the Tax Calculation
              Task</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 03:45:39</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45601230"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45601177">
          <h3>
            <a
              class="item"
              href="https://exploring-better-ways.bellroy.com/free-applicatives-the-handle-pattern-and-remote-systems.html"
              >Free applicatives, the handle pattern, and remote systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 03:33:35</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45601177"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45597006">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/ai/google-gemma-ai-cancer-therapy-discovery/"
              >A Gemma model helped discover a new potential cancer therapy
              pathway</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-15 @ 19:04:07</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45597006"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45595724">
          <h3>
            <a
              class="item"
              href="https://www.backblaze.com/blog/are-hard-drives-getting-better-lets-revisit-the-bathtub-curve/"
              >Are hard drives getting better?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-15 @ 17:18:13</span
              ><span class="points-container"
                >Points: <span class="points">245</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45595724"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45595403">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/news/claude-haiku-4-5"
              >Claude Haiku 4.5</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-15 @ 16:55:06</span
              ><span class="points-container"
                >Points: <span class="points">677</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45595403"
                  >Comments</a
                ><span class="descendants">: 265</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://assets.anthropic.com/m/99128ddd009bdcb/original/Claude-Haiku-4-5-System-Card.pdf"
                >https://assets.anthropic.com/m/99128ddd009bdcb/original/Clau...</a
              >
            </div>
          </section>
        </section>
        <section id="45594920">
          <h3>
            <a class="item" href="https://zed.dev/blog/zed-for-windows-is-here"
              >Zed is now available on Windows</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-15 @ 16:24:29</span
              ><span class="points-container"
                >Points: <span class="points">489</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45594920"
                  >Comments</a
                ><span class="descendants">: 312</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45592271">
          <h3>
            <a
              class="item"
              href="https://www.bleepingcomputer.com/news/security/f5-says-hackers-stole-undisclosed-big-ip-flaws-source-code/"
              >F5 says hackers stole undisclosed BIG-IP flaws, source code</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-15 @ 13:33:27</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45592271"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://www.sec.gov/ix?doc=/Archives/edgar/data/1048695/000104869525000149/ffiv-20251015.htm"
                >https://www.sec.gov/ix?doc=/Archives/edgar/data/1048695/0001...</a
              >
            </div>
          </section>
        </section>
        <section id="45591799">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2025/10/apple-unleashes-m5-the-next-big-leap-in-ai-performance-for-apple-silicon/"
              >Apple M5 chip</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-15 @ 13:02:53</span
              ><span class="points-container"
                >Points: <span class="points">1177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45591799"
                  >Comments</a
                ><span class="descendants">: 1262</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45590949">
          <h3>
            <a class="item" href="https://github.com/squidowl/halloy"
              >Show HN: Halloy – Modern IRC client</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-15 @ 11:45:47</span
              ><span class="points-container"
                >Points: <span class="points">347</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45590949"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
            <div class="text">
              <p>
                Three years later, I’ve made new friends who have become core
                contributors, and there are now over 200 people idling in our
                #halloy channel on Libera.
              </p>
              <p>
                My hope is that this client will outlive me and that IRC will
                live on.
              </p>
            </div>
          </section>
        </section>
        <section id="45590756">
          <h3>
            <a class="item" href="https://www.unkey.com/blog/serverless-exit"
              >Leaving serverless led to performance improvement and a
              simplified architecture</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-15 @ 11:20:35</span
              ><span class="points-container"
                >Points: <span class="points">441</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45590756"
                  >Comments</a
                ><span class="descendants">: 238</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45571647">
          <h3>
            <a
              class="item"
              href="https://ciamweekly.substack.com/p/credential-stuffing"
              >Credential Stuffing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 18:20:00</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45571647"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45557591">
          <h3>
            <a
              class="item"
              href="https://www.nasa.gov/space-flight-awareness/silver-snoopy-award/"
              >Silver Snoopy Award</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 12:04:05</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45557591"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45554004">
          <h3>
            <a
              class="item"
              href="https://www.pnas.org/doi/10.1073/pnas.2503399122"
              >VOC injection into a house reveals large surface reservoir
              sizes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 00:23:35</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45554004"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45546575">
          <h3>
            <a
              class="item"
              href="https://www.consumerreports.org/health/food-safety/radioactive-shrimp-explained-a5493175857/"
              >What is going on with all this radioactive shrimp?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-11 @ 04:31:15</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45546575"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45545017">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20251009-rescuing-knowledge-trapped-on-old-floppy-disks"
              >The people rescuing forgotten knowledge trapped on old floppy
              disks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-10 @ 23:36:04</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45545017"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45542536">
          <h3>
            <a
              class="item"
              href="https://www.youtube.com/watch?v=bwjMLyBU4RU&amp;list=PLyR4neQXqQo5nPdEiMbaEJxWiy_UuyNN4&amp;index=1"
              >Build a Superscalar 8-Bit CPU (YouTube Playlist) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-10 @ 19:03:20</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45542536"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45539262">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/thousands-of-flies-keep-landing-on-north-sea-oil-rigs-then-taking-off-a-few-hours-later-heres-why-265622"
              >Flies keep landing on North Sea oil rigs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-10 @ 14:07:46</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45539262"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45539079">
          <h3>
            <a class="item" href="https://justsketch.me"
              >JustSketchMe – Digital Posing Tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-10 @ 13:53:38</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45539079"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
