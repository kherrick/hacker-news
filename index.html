<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40803448">
          <h3>
            <a
              class="item"
              href="https://www.businessinsider.com/airbnb-numbers-shrink-hotel-prices-soar-ban-nyc-2024-6"
              >NYC banned Airbnbs to make housing cheaper, but only made hotels
              more expensive</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 19:13:27</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40803448"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40802676">
          <h3>
            <a class="item" href="https://www.figma.com/slides/"
              >Figma Slides</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 18:04:34</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40802676"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40802423">
          <h3>
            <a
              class="item"
              href="https://www.figma.com/blog/introducing-figma-ai/"
              >Figma AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 17:39:50</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40802423"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40802296">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/personal-finance/taxes/irs-customer-service-phone-call-data-fe7c0e65"
              >Millions of Taxpayers Call the IRS for Help. Two-Thirds Don't
              Reach Anyone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 17:28:04</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40802296"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40802066">
          <h3>
            <a
              class="item"
              href="https://howonlee.github.io/2020/02/12/I-20Add-2020-20Seconds-20of-20Latency-20to-20Every-20Website-20I-20Visit.html"
              >I Add 3-25 Seconds of Latency to Every Page I Visit (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 17:01:33</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40802066"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40802054">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/motion/731e6994-c9b0-43ae-b7e4-28cbca03920f?utm_source=hn"
              >Motion (YC W20) Is Hiring Our First DevOps Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 17:00:17</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40801523">
          <h3>
            <a
              class="item"
              href="https://rabbitu.de/articles/security-disclosure-2"
              >Rabbit failed to properly reset keys: emails can be sent from
              rabbit.tech domain</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 16:05:36</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40801523"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40801494">
          <h3>
            <a class="item" href="https://usefind.ai/"
              >Show HN: Find AI – Perplexity Meets LinkedIn</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 16:02:57</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40801494"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
            <div class="text">
              <p>
                I started building Find AI to make it easier to search for
                people. I initially started just having GPT review people's
                LinkedIn profiles and websites, but it cost thousands of dollars
                per search (!). The product we're launching today can now run
                the same searches in seconds for pennies.
              </p>
              <p>
                Find AI is Perplexity-style search over LinkedIn-type data. Ask
                vague questions, and the AI will go find and analyze people to
                get you matches.
              </p>
              <p>
                The results are really impressive - here are some questions I've
                used:
              </p>
              <p>
                - Find potential future founders by looking for tech company PMs
                who previously started a company
              </p>
              <p>
                - Find potential chief science officers by looking for PhDs with
                industry experience who now work at a startup but have never
                founded a company before
              </p>
              <p>
                - Find other founders who have a dog and might want my vet app
                product
              </p>
              <p>
                The database currently consists of tech companies and people,
                but we're working to scale up to more people. The data is all
                first-party and retrieved from public sources.
              </p>
              <p>
                Our first customers have been VCs, who are using Find AI to keep
                track of new AI companies. We just launched email alerts on
                searches, so you can get updates as new companies match your
                criteria.
              </p>
              <p>Try it out and let me know what you think.</p>
            </div>
          </section>
        </section>
        <section id="40801475">
          <h3>
            <a
              class="item"
              href="https://twobithistory.org/2019/08/22/readline.html"
              >Things you didn't know about GNU readline (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 16:00:15</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40801475"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40800869">
          <h3>
            <a class="item" href="https://onemillioncheckboxes.com/"
              >One Million Checkboxes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 15:02:38</span
              ><span class="points-container"
                >Points: <span class="points">257</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40800869"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40799791">
          <h3>
            <a class="item" href="https://github.com/SciPhi-AI/R2R"
              >Show HN: R2R V2 – A open source RAG engine with prod features</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 13:27:14</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40799791"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/SciPhi-AI/R2R"
                >https://github.com/SciPhi-AI/R2R</a
              >], an open source RAG answer engine that is built on top of
              Postgres+Neo4j. The best way to get started is with the docs -
              <a href="https://r2r-docs.sciphi.ai/introduction"
                >https://r2r-docs.sciphi.ai/introduction</a
              >.
              <p>
                This is a major update from our V1 which we have spent the last
                3 months intensely building after getting a ton of great
                feedback from our first Show HN (<a
                  href="https://news.ycombinator.com/item?id=39510874"
                  >https://news.ycombinator.com/item?id=39510874</a
                >). We changed our focus to building a RAG engine instead of a
                framework, because this is what developers asked for the most.
                To us this distinction meant working on an opinionated system
                instead of layers of abstractions over providers. We built
                features for multimodal data ingestion, hybrid search with
                reranking, advanced RAG techniques (e.g. HyDE), automatic
                knowledge graph construction alongside the original goal of an
                observable RAG system built on top of a RESTful API that we
                shared back in February.
              </p>
              <p>
                What's the problem? Developers are struggling to build accurate,
                reliable RAG solutions. Popular tools like Langchain are complex
                and overly abstracted and lack crucial production features such
                as user/document management, observability, and a default API.
                There was a big thread about this a few days ago:
                <i>Why we no longer use LangChain for building our AI agents</i>
                (<a href="https://news.ycombinator.com/item?id=40739982"
                  >https://news.ycombinator.com/item?id=40739982</a
                >)
              </p>
              <p>
                We experienced these challenges firsthand while building a
                large-scale semantic search engine, having users report numerous
                hallucinations and inaccuracies. This highlighted that
                search+RAG is a difficult problem. We're convinced that these
                missing features, and more, are essential to effectively monitor
                and improve such systems over time.
              </p>
              <p>
                Teams have been using R2R to develop custom AI agents with their
                own data, with applications ranging from B2B lead generation to
                research assistants. Best of all, the developer experience is
                much improved. For example, we have recently seen multiple teams
                use R2R to deploy a user-facing RAG engine for their application
                within a day. By day 2 some of these same teams were using their
                generated logs to tune the system with advanced features like
                hybrid search and HyDE.
              </p>
              <p>
                Here are a few examples of how R2R can outperform classic RAG
                with semantic search only:
              </p>
              <p>
                1. “What were the UK's top exports in 2023?". R2R with hybrid
                search can identify documents mentioning "UK exports" and
                "2023", whereas semantic search finds related concepts like
                trade balance and economic reports.
              </p>
              <p>
                2. "List all YC founders that worked at Google and now have an
                AI startup." Our knowledge graph feature allows R2R to
                understand relationships between employees and projects,
                answering a query that would be challenging for simple vector
                search.
              </p>
              <p>
                The built in observability and customizability of R2R helps you
                to tune and improve your system long after launching. Our plan
                is to keep the API ~fixed while we iterate on the internal
                system logic, making it easier for developers to trust R2R for
                production from day 1.
              </p>
              <p>
                We are currently working on the following: (1) Improve semantic
                chunking through third party providers or our own custom LLMs;
                (2) Training a custom model for knowledge graph triples
                extraction that will allow KG construction to be 10x more
                efficient. (This is in private beta, please reach out if
                interested!); (3) Ability to handle permissions at a more
                granular level than just a single user; (4) LLM-powered online
                evaluation of system performance + enhanced analytics and
                metrics.
              </p>
              <p>
                Getting started is easy. R2R is a lightweight repository that
                you can install locally with `pip install r2r`, or run with
                Docker. Check out our quickstart guide:
                <a href="https://r2r-docs.sciphi.ai/quickstart"
                  >https://r2r-docs.sciphi.ai/quickstart</a
                >. Lastly, if it interests you, we are also working on a cloud
                solution at <a href="https://sciphi.ai">https://sciphi.ai</a>.
              </p>
              <p>
                Thanks a lot for taking the time to read! The feedback from the
                first ShowHN was invaluable and gave us our direction for the
                last three months, so we'd love to hear any more comments you
                have!
              </p>
            </div>
          </section>
        </section>
        <section id="40799090">
          <h3>
            <a
              class="item"
              href="https://www.nycresistor.com/2012/08/21/ghosts-in-the-rom/"
              >Ghosts in the ROM (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 12:15:46</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40799090"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40797070">
          <h3>
            <a
              class="item"
              href="https://www.popsci.com/environment/why-blue-animals-are-rare/"
              >Why blue animals are so rare</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 06:46:56</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40797070"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40790642">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=_DTpQ4Kk2wA"
              >APL Demonstration (1975) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-25 @ 16:42:14</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40790642"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40789339">
          <h3>
            <a
              class="item"
              href="https://mused.com/en/guided/923/the-tomb-of-nefertari-valley-of-the-queens"
              >Show HN: The Tomb of Nefertari [QV 66] Guided Virtual Tour</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-25 @ 14:48:21</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40789339"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              <p>
                I wasn't able to take photogrammetry photos of the artifacts
                from the tomb in the Museo Egizio in Turin because they were
                traveling while I was there (and now the museum is closed to
                install a new roof anyhow), so I tried to include comparanda
                from other museums where I had scanned artifacts.
              </p>
              <p>
                I tested the same dataset with 3d Gaussian Splatting but that
                had lower resolution results for great complexity in frontend
                code and reduced performance on older devices. [3DGS tour:
                <a
                  href="https://mused.com/en/tours/860/learn-about-3d-gaussian-splatting"
                  >https://mused.com/en/tours/860/learn-about-3d-gaussian-splat...</a
                >]
              </p>
              <p>
                Moving forward, if anyone's working on the same idea, I didn't
                find a good path to monetization through web-based 3d content,
                so I'll take the high resolution photogrammetry of spaces into
                Unreal and switch to desktop and headset builds.
              </p>
            </div>
          </section>
        </section>
        <section id="40789179">
          <h3>
            <a
              class="item"
              href="https://www.geekwire.com/2024/seattles-living-computers-museum-logs-off-for-good-as-paul-allen-estate-will-auction-vintage-items/"
              >Living Computers Museum to permanently close, auction vintage
              items</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-25 @ 14:35:07</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40789179"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40774833">
          <h3>
            <a
              class="item"
              href="https://developers.redhat.com/articles/2022/09/17/gccs-new-fortification-level"
              >GCC's new fortification level: The gains and costs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-24 @ 11:42:03</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40774833"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40774748">
          <h3>
            <a
              class="item"
              href="https://btmc.substack.com/p/tracing-garbage-collection-for-arenas"
              >Tracing garbage collection for arenas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-24 @ 11:31:16</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40774748"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40773125">
          <h3>
            <a class="item" href="https://olano.dev/blog/from-rss-to-my-kindle"
              >From RSS to My Kindle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-24 @ 06:47:47</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40773125"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40771104">
          <h3>
            <a
              class="item"
              href="https://languagelog.ldc.upenn.edu/nll/?p=64579"
              >The semiotics of barbed wire fence</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-23 @ 22:21:29</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40771104"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40769636">
          <h3>
            <a
              class="item"
              href="https://www.theautopian.com/this-is-how-electronic-ignition-works-and-also-how-to-make-a-spark-plug-play-music/"
              >How electronic ignition works and also how to make a spark plug
              play music</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-23 @ 18:50:08</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40769636"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40768959">
          <h3>
            <a
              class="item"
              href="https://www.viksnewsletter.com/p/how-automotive-radar-measures-velocity"
              >How automotive radar measures the velocity of objects</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-23 @ 17:17:12</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40768959"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40768237">
          <h3>
            <a
              class="item"
              href="https://www.dolthub.com/blog/2024-06-21-channel-three-ways/"
              >Three ways to think about Go channels</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-23 @ 15:39:20</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40768237"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40767207">
          <h3>
            <a
              class="item"
              href="https://www.jeremykun.com/2021/10/14/group-actions-and-hashing-unordered-multisets/"
              >Group actions and hashing unordered multisets (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-23 @ 13:07:08</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40767207"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40765770">
          <h3>
            <a class="item" href="https://grantkot.com/ll/">Liquid Layers</a>
          </h3>
          <section>
            <h4>
              <span>2024-06-23 @ 08:43:29</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40765770"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <a href="https://twitter.com/kotsoft"
                >https://twitter.com/kotsoft</a
              >
            </div>
          </section>
        </section>
        <section id="40762912">
          <h3>
            <a
              class="item"
              href="https://nicole.express/2024/have-you-hacked-atari-today.html"
              >Composite modding another Atari, because colors are hard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-22 @ 22:45:53</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40762912"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40752111">
          <h3>
            <a
              class="item"
              href="https://pikuma.com/blog/understanding-computer-cache"
              >Exploring How Cache Memory Works</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-21 @ 18:04:30</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40752111"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40749924">
          <h3>
            <a
              class="item"
              href="https://leap71.com/2024/06/18/leap-71-hot-fires-3d-printed-liquid-fuel-rocket-engine-designed-through-noyron-computational-model/"
              >Test firing of a 3D-printed rocket engine designed through
              computational model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-21 @ 14:21:14</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40749924"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40749401">
          <h3>
            <a class="item" href="https://mmapped.blog/posts/29-plan-execute"
              >The plan-execute pattern</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-21 @ 13:27:51</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40749401"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40749345">
          <h3>
            <a
              class="item"
              href="https://unicorn-utterances.com/posts/documentation-driven-development"
              >Documentation Driven Development (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-21 @ 13:21:56</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40749345"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
