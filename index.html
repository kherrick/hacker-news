<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42290011">
          <h3>
            <a class="item" href="https://caseymuratori.com/blog_0010"
              >The Color of Noise – The Witness (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 19:05:10</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42290011"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42289955">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42289955"
              >How can I grow as an engineer without good seniors to learn
              from?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 18:56:22</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42289955"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
            <div class="text">
              <p>
                I was hired 6 months ago as a freelance data engineer, and after
                proving myself through my work quality, I am now essentially
                functioning as a tech lead, with full responsibility and
                ownership of designing, implementing, and hiring for the
                projects I'm assigned.
              </p>
              <p>
                Our company is not a tech company, so I only have a couple of
                tech-oriented colleagues, and I barely interact with them. Now I
                directly report to the director of the company, who in all
                senses is awesome, with 40+ years of combined experience in some
                of the biggest oil and drilling companies globally.
              </p>
              <p>
                However, I have some strong FOMO about not being able to learn
                much technical stuff from my peers or seniors. I am trying my
                best to learn and pick things up on my own, learning design
                principles, getting code reviews from chatGPT, etc. But even
                then, I'm afraid I am not producing the software to the highest
                standards of the industry since we don't have any rigorous
                cross-checking, and might be missing out on a lot of learning.
              </p>
              <p>
                Can someone who has been in positions similar to these please
                guide me?
              </p>
            </div>
          </section>
        </section>
        <section id="42289913">
          <h3>
            <a
              class="item"
              href="https://deadreckonings.com/2007/12/07/heavisides-operator-calculus/"
              >Heaviside’s Operator Calculus (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 18:47:38</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42289913"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42289798">
          <h3>
            <a class="item" href="https://www.asimov.press/p/crick"
              >Francis Crick Was Misunderstood</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 18:24:26</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42289798"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42289345">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/infisical/jobs/2OGBQMt-full-stack-engineer-sf"
              >Infisical (YC W23) Is Hiring Full Stack Engineers in SF and
              Remotely</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 17:00:49</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42289310">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2411.12580"
              >Procedural knowledge in pretraining drives reasoning in large
              language models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 16:54:26</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42289310"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42289109">
          <h3>
            <a class="item" href="https://github.com/MinishLab/vicinity"
              >Show HN: Vicinity – Fast, Lightweight Nearest Neighbors with
              Flexible Back Ends</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 16:15:04</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42289109"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>Main features:</p>
              <p>- Lightweight: the base package only uses Numpy</p>
              <p>
                - Unified interface: use any of the supported algorithms and
                backends with a single interface: HNSW, Annoy, FAISS, and many
                more algorithms and libraries are supported
              </p>
              <p>
                - Easy evaluation: evaluate the performance of your backend with
                a simple function to measure queries per second vs recall
              </p>
              <p>- Serialization: save and load your index for persistence</p>
              <p>
                After working with a large number of ANN libraries over the
                years, we found it increasingly cumbersome to learn the
                interface, features, quirks, and limitations of every library.
                After writing custom evaluation code to measure the speed and
                performance for the 100th time to compare libraries, we decided
                to build this as a way to easily use a large number of
                algorithms and libraries with a unified, simple interface that
                allows for quick comparison and evaluation.
              </p>
              <p>
                We are curious to hear your feedback! Are there any algorithms
                that are missing that you use? Any extra evaluation metrics that
                are useful?
              </p>
            </div>
          </section>
        </section>
        <section id="42288956">
          <h3>
            <a
              class="item"
              href="https://bilbof.com/posts/kubernetes-on-hetzner"
              >Kubernetes on Hetzner: cutting my infra bill by 75%</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 15:43:40</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42288956"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42288449">
          <h3>
            <a
              class="item"
              href="https://www.sciencealert.com/the-worlds-rarest-mineral-is-so-rare-its-only-ever-been-found-once"
              >Kyawthuite is so rare it's only ever been found once</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 13:49:00</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42288449"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42288341">
          <h3>
            <a
              class="item"
              href="https://www.openread.academy/en/paper/reading?corpusId=503252214"
              >Handwriting but not typewriting leads to widespread connectivity
              in brain</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 13:26:56</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42288341"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42287795">
          <h3>
            <a
              class="item"
              href="https://worldsensorium.com/turning-bogs-from-wastelands-to-nature-scapes/"
              >Turning bogs from wastelands to nature-scapes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 11:24:43</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42287795"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42287345">
          <h3>
            <a
              class="item"
              href="http://cadlag.org/posts/a-review-of-freedman-pisani-purves-statistics.html"
              >Review of "Statistics" by Freedman, Pisani, and Purves (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 09:37:56</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42287345"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42287231">
          <h3>
            <a class="item" href="https://adventofcode.com/2024/about"
              >Advent of Code 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 09:09:35</span
              ><span class="points-container"
                >Points: <span class="points">806</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42287231"
                  >Comments</a
                ><span class="descendants">: 312</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42286397">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2411.01747"
              >DynaSaur: Large Language Agents Beyond Predefined Actions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 05:21:59</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42286397"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42285128">
          <h3>
            <a
              class="item"
              href="https://twitter.com/JeffDean/status/1858540085794451906"
              >Jeff Dean responds to EDA industry about AlphaChip</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 00:28:04</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42285128"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42284563">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/an-83-year-old-short-story-by-borges-portends-a-bleak-future-for-the-internet-242998"
              >An 83-year-old short story by Borges portends a bleak future for
              the internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-30 @ 22:38:13</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42284563"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42284412">
          <h3>
            <a class="item" href="https://github.com/privastead/privastead"
              >Show HN: Open-source private home security camera system
              (end-to-end encryption)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-30 @ 22:13:49</span
              ><span class="points-container"
                >Points: <span class="points">415</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42284412"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
            <div class="text">
              <p>
                Based on some of the discussions I've seen online, it seems like
                there are other users who are also concerned with the privacy
                implications of home security cameras. Therefore, I decided to
                open source my solution for everyone to use. If you need a
                privacy-preserving home security camera, please give it a try
                and provide feedback. Note that trying out the system requires
                you to have a supported IP camera, a local machine connected to
                the IP camera, a server, and an Android smartphone. I have put
                together detailed instructions on setting up the system, which I
                hope makes it easier for others to get the system up and
                running.
              </p>
              <p>
                In addition, consider contributing to the project. The prototype
                currently has a lot of limitations: mainly that it has only been
                tested with one IP camera, only allows the use of one camera,
                and only supports Android. I'll continue to improve the
                prototype as time permits, but progress will be much faster if
                there are other contributors as well.
              </p>
            </div>
          </section>
        </section>
        <section id="42283950">
          <h3>
            <a class="item" href="https://github.com/maharmstone/ntfs2btrfs"
              >Ntfs2btrfs does in-place conversion of NTFS filesystem to the
              open-source Btrfs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-30 @ 20:50:08</span
              ><span class="points-container"
                >Points: <span class="points">372</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42283950"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42283933">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/p/amd-disables-zen-4s-loop-buffer"
              >AMD Disables Zen 4's Loop Buffer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-30 @ 20:47:35</span
              ><span class="points-container"
                >Points: <span class="points">283</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42283933"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42280570">
          <h3>
            <a
              class="item"
              href="https://blog.lucasholten.com/rust-query-announcement/"
              >Safe relational database queries using the Rust type system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-30 @ 09:29:39</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42280570"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42277850">
          <h3>
            <a
              class="item"
              href="https://www.theparisreview.org/blog/2017/02/15/rhythmical-lines/"
              >Geometric line-art of Wacław Szpakowski (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 22:54:12</span
              ><span class="points-container"
                >Points: <span class="points">447</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42277850"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42268319">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/dont-cancel-aristotle-we-need-his-ideas-to-hone-ours"
              >Who can claim Aristotle?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 20:23:56</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42268319"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42256968">
          <h3>
            <a
              class="item"
              href="https://buttondown.com/jaffray/archive/fine-ill-play-with-skiplists/"
              >Fine, I'll Play With Skiplists</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 15:50:21</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42256968"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42254737">
          <h3>
            <a
              class="item"
              href="https://geo-ant.github.io/blog/2024/rust-linear-types-use-once/"
              >Cursed Linear Types in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 10:14:13</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42254737"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42254144">
          <h3>
            <a
              class="item"
              href="https://buttondown.com/hillelwayne/archive/the-opposite-of-documentation-is-superstition/"
              >The Opposite of Documentation is Superstition (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 08:32:39</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42254144"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42253640">
          <h3>
            <a class="item" href="https://sha.org/bottle/"
              >Historic Bottle Website</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 06:59:07</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42253640"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42251140">
          <h3>
            <a
              class="item"
              href="https://adamj.eu/tech/2024/11/26/django-fix-view-using-pdb/"
              >Django: Fix a view using a debugger with breakpoint()</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-26 @ 23:08:45</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42251140"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42244472">
          <h3>
            <a class="item" href="https://shader-slang.com"
              >The Slang Shading Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-26 @ 10:40:53</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42244472"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42235412">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/mobile-3d-printer"
              >Mobile 3D Printer Can Print Directly on Your Floor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-25 @ 11:41:12</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42235412"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42220596">
          <h3>
            <a class="item" href="https://github.com/hfiref0x/WinDepends"
              >WinDepends – A Rewrite of the Dependency Walker</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-23 @ 12:48:06</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42220596"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
