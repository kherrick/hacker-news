<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43329030">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43329030"
              >Ask HN: What are things to work on that are not AI or QC?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-11 @ 04:01:10</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43329030"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              I am working on a trademark and some IP that I started way back in
              2020 for my own AI and looks like I made the right choice
              considering the paywalls and having to pay for API access and what
              not. So my question to Hackernews is what are things that you
              think we should focus on for the future? I really liked the
              /r/selfhosted project that someone made to diagnose their own
              medical issues and what not so that is great. But what are some
              fields and other important things to focus on. I am from Canada by
              the way sadly. It seems like I will have a really good shot at
              releasing meta made in canada games and I think they would get a
              lot of traction. But not too interested in making games, very
              interested in building tooling for game developers to make their
              life easier though and I have been using deep research to compile
              some interesting information that I would like to compile and
              build something for my fellow gamedevs that want to build stuff
              for le Steamdeck. But anyway, what are some markets that we need
              to be on the lookout for in NA? I am interested in social
              networks, especially with whatever DDOS thing that Twitter/X is
              having right now and I did make a previous post asking how we can
              build our own social network and it seems like right now a good
              topic of discussion would also be how to make ddos resistant
              social networks. I remember studying this a bit when I was
              building my own manga readerr when mangadex initially went down
              and I had an approach wtih Rust (for any of you that reads manga
              from onemanga or batoto and thsoe days and even mangadex days
              knows how slow it was to read manga and how easy it was for people
              to ddos the shit out of it) - anyway this is suppose to be a fun
              discussion.
            </div>
          </section>
        </section>
        <section id="43328736">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/03/09/movies/flow-movie-pets-oscars.html"
              >Pets Can't Stop Watching 'Flow,' the Oscar-Winning Cat Movie</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-11 @ 03:00:15</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43328736"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43328095">
          <h3>
            <a class="item" href="https://www.seven39.com"
              >Seven39 â€“ a social media app that is only open for 3 hours every
              evening</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-11 @ 01:05:10</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43328095"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43327758">
          <h3>
            <a class="item" href="https://github.com/eduardoagarcia/shef"
              >Shef</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-11 @ 00:16:54</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43327758"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43327730">
          <h3>
            <a class="item" href="https://www.fourmilab.ch/gravitation/foobar/"
              >Bending Spacetime in the Basement</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-11 @ 00:11:33</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43327730"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43326275">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2025/03/17/rot-padraic-x-scanlan-book-review"
              >What made the Irish famine so deadly</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 21:24:06</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43326275"
                  >Comments</a
                ><span class="descendants">: 184</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43323946">
          <h3>
            <a
              class="item"
              href="https://github.com/MathFoundationRL/Book-Mathematical-Foundation-of-Reinforcement-Learning"
              >Mathematical Foundations of Reinforcement Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 18:27:32</span
              ><span class="points-container"
                >Points: <span class="points">236</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43323946"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43323860">
          <h3>
            <a
              class="item"
              href="https://tinlizzie.org/VPRIPapers/tr2012001_steps.pdf"
              >STEPS Toward the Reinvention of Programming (2012) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 18:22:57</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43323860"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43323071">
          <h3>
            <a
              class="item"
              href="https://www.analog.com/media/en/training-seminars/design-handbooks/Software-Defined-Radio-for-Engineers-2018/SDR4Engineers.pdf"
              >Software-Defined Radio for Engineers (2018) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 17:40:40</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43323071"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43322245">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2025/03/music-labels-will-regret-coming-for-the-internet-archive-sound-historian-says/"
              >Music labels will regret coming for the Internet Archive, sound
              historian says</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 16:28:44</span
              ><span class="points-container"
                >Points: <span class="points">366</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43322245"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43321688">
          <h3>
            <a class="item" href="https://playscl.com/make"
              >Show HN: Editable Games</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 15:31:57</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43321688"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been working on canvas language for 15 years now. Not very
                successful, but editable gifs turned out okay. Since it's my
                passion, I keep trying, and my latest is editable games - I'm
                not officially calling it that though.
              </p>
              <p>
                I've had some interest in advergames and this would allow
                designers to easily customize games for their clients - the
                hidden objects game being the best example for this, and the
                only one made specifically for the purpose.
              </p>
              <p>
                Anyways, games are interpreted at runtime by JavaScript. To
                publish, for example on itch or your own website, you need to
                submit your project file (download it from the dev studio) and
                wait a few minutes. You'll get back a JS file that contains your
                game.
              </p>
              <p>
                ngl, although a passion project, I'd like this to one day be
                profitable - trying to work that out.
              </p>
              <p>
                If interested, the main project site is
                <a href="https://canvaslanguage.com"
                  >https://canvaslanguage.com</a
                >
              </p>
              <p>
                I'd love to get some feedback. Although to be honest, I just
                want to show somebody my newest creation :)
              </p>
              <p>Thank you.</p>
            </div>
          </section>
        </section>
        <section id="43321523">
          <h3>
            <a class="item" href="https://blog.kuzudb.com/post/kuzu-wasm-rag/"
              >Show HN: In-Browser Graph RAG with Kuzu-WASM and WebLLM</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 15:12:57</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43321523"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
            <div class="text">
              <p>
                We will soon also be releasing a vector index as part of Kuzu
                that you can also use in the browser to build traditional RAG or
                Graph RAG that retrieves from both vectors and graphs. The
                system has come a long way since we open sourced it about 2
                years ago, so please give us feedback about how it can be more
                useful!
              </p>
            </div>
          </section>
        </section>
        <section id="43321131">
          <h3>
            <a
              class="item"
              href="https://www.mcmordie.co.uk/acornhistory/index.shtml"
              >A technical history of Acorn Computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 14:35:05</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43321131"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43320230">
          <h3>
            <a
              class="item"
              href="https://exclusivearchitecture.com/03-technical-articles-CLT-12-autofocus-systems.html"
              >Canon EF and RF Lenses â€“ All Autofocus Motors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 13:12:38</span
              ><span class="points-container"
                >Points: <span class="points">411</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43320230"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
            <div class="text">
              Hi there! I have written an e-book about all autofocus motor types
              used in Canon EF &amp;amp; RF lenses from the past 40 years.
            </div>
          </section>
        </section>
        <section id="43320024">
          <h3>
            <a
              class="item"
              href="https://glasskube.dev/blog/kubernetes-zero-downtime-deployments-aws-eks/"
              >Zero-Downtime Kubernetes Deployments on AWS with EKS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 12:48:32</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43320024"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43318624">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2502.05244"
              >Probabilistic Artificial Intelligence</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 09:50:33</span
              ><span class="points-container"
                >Points: <span class="points">288</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43318624"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43317887">
          <h3>
            <a class="item" href="https://blog.ecosia.org/trees-not-profits/"
              >Trees not profits: we're giving up our right to ever sell Ecosia
              (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 07:42:11</span
              ><span class="points-container"
                >Points: <span class="points">293</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43317887"
                  >Comments</a
                ><span class="descendants">: 176</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43317592">
          <h3>
            <a
              class="item"
              href="https://blog.nelhage.com/post/cpython-tail-call/"
              >Performance of the Python 3.14 tail-call interpreter</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 06:44:27</span
              ><span class="points-container"
                >Points: <span class="points">544</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43317592"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43315406">
          <h3>
            <a
              class="item"
              href="https://raoulpop.com/2012/04/15/chasing-rfi-waves-part-seven/"
              >Chasing RFI Waves â€“ Part Seven</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 00:16:54</span
              ><span class="points-container"
                >Points: <span class="points">286</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43315406"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43314657">
          <h3>
            <a
              class="item"
              href="https://randomaugustine.medium.com/on-apple-exclaves-d683a2c37194"
              >Apple Exclaves</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-09 @ 22:38:57</span
              ><span class="points-container"
                >Points: <span class="points">451</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43314657"
                  >Comments</a
                ><span class="descendants">: 181</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43308111">
          <h3>
            <a class="item" href="https://vegard.blog.engen.priv.no/?p=423"
              >Kubernetes Home â€“ what do you do if your ISP changes your IP
              addresses?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-09 @ 11:29:46</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43308111"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43307833">
          <h3>
            <a
              class="item"
              href="https://siginthistorian.blogspot.com/2025/02/sigint-in-fiction.html"
              >Sigint in Fiction</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-09 @ 10:29:27</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43307833"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43307541">
          <h3>
            <a
              class="item"
              href="https://alexop.dev/posts/how-to-implement-a-cosine-similarity-function-in-typescript-for-vector-comparison/"
              >How to Implement a Cosine Similarity Function in TypeScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-09 @ 09:20:20</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43307541"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43301848">
          <h3>
            <a
              class="item"
              href="https://opengears.medium.com/hackintoshing-as-a-sustainable-environmental-practice-78baf2cdd353"
              >Hackintoshing as a Sustainable Environmental Practice</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-08 @ 17:36:54</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43301848"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43300414">
          <h3>
            <a class="item" href="https://thomwolf.io/blog/scientific-ai.html"
              >The Einstein AI Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-08 @ 14:14:22</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43300414"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43298945">
          <h3>
            <a
              class="item"
              href="https://github.com/vnglst/when-ai-fails/blob/main/shepards-dog/README.md"
              >Asking LLMs to create my game Shepard's Dog</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-08 @ 10:06:01</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43298945"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43289994">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cq6yg204pvmo"
              >Planes are having their GPS hacked. Could new clocks keep them
              safe?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-07 @ 13:31:46</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43289994"
                  >Comments</a
                ><span class="descendants">: 242</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43289140">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/mcdonalds-gives-its-restaurants-an-ai-makeover-2134f01e"
              >McDonald's Gives Its Restaurants an AI Makeover</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-07 @ 10:56:24</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43289140"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43288691">
          <h3>
            <a
              class="item"
              href="https://randomascii.wordpress.com/2021/02/16/arranging-invisible-icons-in-quadratic-time/"
              >Arranging invisible icons in quadratic time (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-07 @ 09:42:03</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43288691"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43288410">
          <h3>
            <a class="item" href="https://hypershell.tech/en-us"
              >HyperShell X Outdoor PowerSuit Exoskeleton</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-07 @ 08:54:00</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43288410"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
