<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41119415">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41119415"
              >Ask HN: How are you finding the job market in July 2024?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 14:21:49</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41119415"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <p>Has it got better at all where you are?</p>
              <p>
                PS I know there's the monthly hiring HN threads here tomorrow.
              </p>
            </div>
          </section>
        </section>
        <section id="41119166">
          <h3>
            <a
              class="item"
              href="https://juliawise.net/sugar-rush-in-children-seems-to-be-confirmation-bias/"
              >"Sugar rush" in children seems to be confirmation bias</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 13:51:41</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41119166"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41119151">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/business/2024/07/31/data-breach-resistance/"
              >Our data isn't safe. Resist giving it up whenever you can</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 13:49:07</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41119151"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41119080">
          <h3>
            <a
              class="item"
              href="https://eos.org/science-updates/how-great-was-the-great-oxidation-event"
              >How Great Was the "Great Oxidation Event"?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 13:40:49</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41119080"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41118962">
          <h3>
            <a
              class="item"
              href="https://worrydream.com/refs/Lockhart_2002_-_A_Mathematician%27s_Lament.pdf"
              >A Mathematician's Lament [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 13:21:22</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41118962"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41118864">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/Servo-Multi-Core-HTML-Tables"
              >Servo Web Engine Now Leverages Multiple CPU Cores for Rendering
              HTML Tables</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 13:05:28</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41118864"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41118638">
          <h3>
            <a
              class="item"
              href="https://www.telegraph.co.uk/obituaries/2024/07/29/robin-warren-nobel-ulcers-helicobacter-obituary/"
              >Robin Warren Has Died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 12:29:50</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41118638"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41118418">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/play/jobs/f7pIIqU-product-engineer-at-play-yc-w23"
              >PlayAI (YC W23) Is Hiring Product Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 12:00:22</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41117451">
          <h3>
            <a
              class="item"
              href="https://www.penzba.co.uk/cgi-bin/PvsNP.py?SpikeySpheres#HN2"
              >Spikey Spheres (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 08:53:33</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41117451"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41116813">
          <h3>
            <a
              class="item"
              href="https://fermatslibrary.com/s/cargo-cult-science"
              >Cargo Cult Science (1974)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 06:26:36</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41116813"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41116639">
          <h3>
            <a class="item" href="https://words.filippo.io/rustgo/"
              >Rustgo: Calling Rust from Go with near-zero overhead (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 05:43:33</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41116639"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41116473">
          <h3>
            <a class="item" href="https://github.com/sickcodes/Docker-OSX"
              >macOS in Docker Container</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 04:51:12</span
              ><span class="points-container"
                >Points: <span class="points">324</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41116473"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41116414">
          <h3>
            <a class="item" href="https://github.com/mcastillof/FakeTraveler"
              >FakeTraveler: Fake where your phone is located (Mock location for
              Android)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 04:30:15</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41116414"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41116253">
          <h3>
            <a class="item" href="https://coldwar-ct.com/Home_Page_S1DO.html"
              >Construction of the AT&amp;amp;T Long Lines "Cheshire"
              underground site</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 03:47:42</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41116253"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41115941">
          <h3>
            <a
              class="item"
              href="https://ogiekako.vercel.app/blog/find_mkdir_tc"
              >`find` + `mkdir` is Turing complete</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 02:22:41</span
              ><span class="points-container"
                >Points: <span class="points">246</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41115941"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41115619">
          <h3>
            <a
              class="item"
              href="https://blog.activision.com/activision/2024/activision-releases-call-of-duty-warzone-caldera-data-set"
              >Call of Duty: Warzone Caldera Data Set for Academic Use</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 01:06:09</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41115619"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41115591">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/new-superconductor-microprocessor-yields-a-substantial-boost-in-efficiency"
              >Superconducting Microprocessors? Turns Out They're
              Ultra-Efficient (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 01:00:26</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41115591"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41114839">
          <h3>
            <a
              class="item"
              href="https://blog.trailofbits.com/2024/07/30/our-audit-of-homebrew/"
              >Our audit of Homebrew</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 22:39:21</span
              ><span class="points-container"
                >Points: <span class="points">650</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41114839"
                  >Comments</a
                ><span class="descendants">: 128</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41114825">
          <h3>
            <a
              class="item"
              href="https://shwin.co/blog/creativity-fundamentally-comes-from-memorization"
              >Creativity fundamentally comes from memorization</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 22:37:24</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41114825"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41114569">
          <h3>
            <a class="item" href="https://lock.cmpxchg8b.com/slowterm.html"
              >Troubleshooting: Terminal Lag</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 22:04:39</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41114569"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41112854">
          <h3>
            <a class="item" href="https://porffor.dev/"
              >Porffor: A from-scratch experimental ahead-of-time JS engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 18:55:10</span
              ><span class="points-container"
                >Points: <span class="points">388</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41112854"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41111208">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/underwater-marble-floor-mosaic-discovered-off-the-coast-of-naples-180984772/"
              >Divers Discover Mesmerizing Roman Mosaic Beneath the Sea</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 16:46:15</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41111208"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41111129">
          <h3>
            <a
              class="item"
              href="https://www.swift.org/blog/announcing-swift-homomorphic-encryption/"
              >Swift Homomorphic Encryption</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 16:40:13</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41111129"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41111115">
          <h3>
            <a class="item" href="https://www.stat.cmu.edu/~cshalizi/TALR/"
              >The Truth About Linear Regression (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 16:38:40</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41111115"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41110850">
          <h3>
            <a class="item" href="https://github.com/ssoready/ssoready"
              >Launch HN: SSOReady (YC W24) â€“ Making SAML SSO painless and open
              source</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 16:19:45</span
              ><span class="points-container"
                >Points: <span class="points">283</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41110850"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/ssoready/ssoready"
                >https://github.com/ssoready/ssoready</a
              >).
              <p>
                SSOReady is an open-source (MIT) service that lets you implement
                SAML single sign-on without ever touching SAML yourself. You
                just need to implement two API endpoints: one to initiate SAML
                logins and another to receive incoming SAML messages. And then
                you're pretty much done.
              </p>
              <p>
                Here's me setting up SAML single sign-on in under a minute: (<a
                  href="https://www.youtube.com/watch?v=_HVtFkW8xCI"
                  >https://www.youtube.com/watch?v=_HVtFkW8xCI</a
                >).
              </p>
              <p>
                You can use our service with whatever tech stack or programming
                language you prefer.
              </p>
              <p>
                Earlier in my career, I worked on SAML authentication at
                Segment. I've been pretty obsessed with SAML since then. In the
                depths of the COVID pandemic, I even wrote an implementation of
                SAML in Go to entertain myself (<a
                  href="https://github.com/ucarion/saml"
                  >https://github.com/ucarion/saml</a
                >).
              </p>
              <p>
                Over the years, I've gotten really itchy to build better SAML
                tooling. There just aren't a lot of great options out there.
                Almost no one seems interested in making SAML easy for
                developers. Almost no one seems interested in writing clear
                documentation.
              </p>
              <p>
                We're hoping to change that with SSOReady. We've open-sourced
                our codebase on an MIT license. You can do pretty much whatever
                you want with the code. Fork us. Self-host us.
              </p>
              <p>We've also made the product entirely free.</p>
              <p>
                Why free and open source? We're focused solitarily on becoming
                developers' first choice for SAML SSO. If it makes developers'
                lives easier, it works for us. We expect to monetize in the
                future by building extra features that serve large companies
                with complex needs. We don't see any point to being secretive or
                squeezing dollars out of small companies.
              </p>
              <p>
                I'd be thrilled if you gave the product a try, and I'd be really
                grateful for any feedback on your experience.
              </p>
              <p>
                If you have any questions or concerns, my cofounder Ned and I
                will stay active on this thread throughout the day. You can also
                reach us directly at founders@ssoready.com. (We really mean
                this! We want to hear from you!)
              </p>
            </div>
          </section>
        </section>
        <section id="41108662">
          <h3>
            <a
              class="item"
              href="https://www.tunglevo.com/note/crafting-interpreters-with-rust-on-garbage-collection/"
              >Crafting Interpreters with Rust: On Garbage Collection</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 12:57:18</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41108662"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41105229">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/ckdgp7r5y11o"
              >Missing Henry VIII portrait found after random X post</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 01:10:28</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41105229"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41091225">
          <h3>
            <a
              class="item"
              href="https://knowablemagazine.org/content/article/mind/2024/animals-change-social-habits-old-age-macaques-deer-sheep"
              >It's not just us: Other animals change their social habits in old
              age</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-28 @ 04:28:06</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41091225"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41087798">
          <h3>
            <a
              class="item"
              href="https://theprintshop.club/2024/07/26/the-people-behind-the-print-shop/"
              >People Behind "The Print Shop" (1985)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-27 @ 16:52:06</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41087798"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41076021">
          <h3>
            <a
              class="item"
              href="https://blog.poisson.chat/posts/2024-07-26-adt-history.html"
              >Where does the name "algebraic data type" come from?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 05:32:05</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41076021"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
