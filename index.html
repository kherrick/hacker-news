<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46663507">
          <h3>
            <a class="item" href="https://css.csail.mit.edu/6.858/2024/"
              >Computer Systems Security 6.566 / Spring 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-18 @ 00:09:43</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46663507"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46663467">
          <h3>
            <a class="item" href="https://polysoftit.co.uk/irisc-web/"
              >IRISC: An ARMv7 assembly interpreter and computer architecture
              simulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-18 @ 00:05:02</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46663467"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46663338">
          <h3>
            <a
              class="item"
              href="https://mastodon.social/@heliographe_studio/115890819509545391"
              >If you put Apple icons in reverse it looks like someone getting
              good at design</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 23:47:16</span
              ><span class="points-container"
                >Points: <span class="points">323</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46663338"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46662662">
          <h3>
            <a
              class="item"
              href="https://willhbr.net/2025/10/20/light-mode-infffffflation/"
              >Light Mode InFFFFFFlation</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 22:19:25</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46662662"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46662399">
          <h3>
            <a class="item" href="https://speedminers.fun/"
              >Show HN: Speed Miners – A tiny RTS resource mini-game</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 21:40:53</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46662399"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Objective: You have a base at the center and you need to mine
                and "refine" all of the resources on the map in as short a time
                as possible.
              </p>
              <p>
                By default, the game will play automatically, but not optimally
                (moving and buying upgrades). You can disable that with the
                buttons. You can select drones and right click to move them to
                specific resources patches and buy upgrades as you earn upgrade
                points.
              </p>
              <p>
                I've implemented three different levels and some basic sounds. I
                used Phaser at the game library (first time using it). It won't
                work well on a mobile.
              </p>
            </div>
          </section>
        </section>
        <section id="46662078">
          <h3>
            <a class="item" href="https://github.com/chunkhound/chunkhound"
              >Show HN: ChunkHound, a local-first tool for understanding large
              codebases</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 21:03:52</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46662078"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                I’d love your feedback — and if you have, thank you for being
                part of the journey!
              </p>
            </div>
          </section>
        </section>
        <section id="46661897">
          <h3>
            <a class="item" href="https://github.com/kip-dili/kip"
              >Kip: A programming language based on grammatical cases of
              Turkish</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 20:44:52</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46661897"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46661132">
          <h3>
            <a
              class="item"
              href="https://www.honeycomb.io/blog/you-had-one-job-why-twenty-years-of-devops-has-failed-to-do-it"
              >What twenty years of DevOps has failed to do</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 19:21:38</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46661132"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46660663">
          <h3>
            <a
              class="item"
              href="https://www.stephenlewis.me/blog/the-thing-that-brought-me-joy/"
              >The thing that brought me joy</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 18:42:39</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46660663"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46660543">
          <h3>
            <a
              class="item"
              href="https://blog.yakkomajuri.com/blog/raising-money-fucked-me-up"
              >Raising money fucked me up</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 18:29:00</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46660543"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46659550">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20260116-an-elizabethan-mansions-secrets-for-staying-warm"
              >An Elizabethan mansion's secrets for staying warm</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 16:53:24</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46659550"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46659456">
          <h3>
            <a class="item" href="https://resonantcomputing.org/"
              >The Resonant Computing Manifesto</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 16:43:59</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46659456"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46659219">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/why-theres-no-single-best-way-to-store-information-20260116/"
              >There's no single best way to store information</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 16:17:58</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46659219"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46658345">
          <h3>
            <a
              class="item"
              href="https://www.caimito.net/en/blog/2025/12/07/the-recurring-dream-of-replacing-developers.html"
              >The recurring dream of replacing developers</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 14:31:33</span
              ><span class="points-container"
                >Points: <span class="points">347</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46658345"
                  >Comments</a
                ><span class="descendants">: 273</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46657296">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/culture/article/20260113-hello-hiya-aloha-what-our-greetings-reveal"
              >The 600-year-old origins of the word 'hello'</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 11:51:44</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46657296"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46657122">
          <h3>
            <a class="item" href="https://alexharri.com/blog/ascii-rendering"
              >ASCII characters are not pixels: a deep dive into ASCII
              rendering</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 11:15:26</span
              ><span class="points-container"
                >Points: <span class="points">910</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46657122"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46656834">
          <h3>
            <a class="item" href="https://github.com/originalankur/maptoposter"
              >Map To Poster – Create Art of your favourite city</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 10:13:57</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46656834"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46656552">
          <h3>
            <a class="item" href="https://langfuse.com/blog/joining-clickhouse"
              >ClickHouse acquires Langfuse</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 09:15:45</span
              ><span class="points-container"
                >Points: <span class="points">202</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46656552"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46655524">
          <h3>
            <a
              class="item"
              href="https://eugeneyan.com/writing/counterfactual-evaluation/"
              >Counterfactual evaluation for recommendation systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 05:20:20</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46655524"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46646475">
          <h3>
            <a
              class="item"
              href="https://www.astralcodexten.com/p/the-dilbert-afterlife"
              >The Dilbert Afterlife</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-16 @ 14:09:32</span
              ><span class="points-container"
                >Points: <span class="points">471</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46646475"
                  >Comments</a
                ><span class="descendants">: 313</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46619059">
          <h3>
            <a class="item" href="https://xous.dev/">Xous Operating System</a>
          </h3>
          <section>
            <h4>
              <span>2026-01-14 @ 17:29:09</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46619059"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46598244">
          <h3>
            <a
              class="item"
              href="https://www.ianvisits.co.uk/articles/how-london-finally-cracked-mobile-phone-coverage-on-the-underground-86784/"
              >How London cracked mobile phone coverage on the Underground</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-13 @ 07:37:47</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46598244"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46592419">
          <h3>
            <a
              class="item"
              href="https://community.firstinspires.org/new-era-first-lego-league-future-edition"
              >A New Era for FIRST LEGO League: Inspiring the Next Generation of
              Learners</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 18:38:22</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46592419"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46588972">
          <h3>
            <a class="item" href="https://labs.ramp.com/rct"
              >We put Claude Code in Rollercoaster Tycoon</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 14:28:17</span
              ><span class="points-container"
                >Points: <span class="points">395</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46588972"
                  >Comments</a
                ><span class="descendants">: 224</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46586714">
          <h3>
            <a class="item" href="https://mapreading.co.uk/what-are-tithe-maps/"
              >What are Tithe Maps (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 10:50:13</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46586714"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46584880">
          <h3>
            <a
              class="item"
              href="https://philipotoole.com/common-misunderstandings-about-large-software-companies/"
              >Common misunderstandings about large software companies</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 06:38:51</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46584880"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46578601">
          <h3>
            <a class="item" href="https://maniek86.xyz/projects/m8sbc_486.php"
              >M8SBC-486 (Homebrew 486 computer)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-11 @ 18:58:19</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46578601"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46576581">
          <h3>
            <a
              class="item"
              href="https://www.abortretry.fail/p/the-olivetti-company"
              >The Olivetti Company</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-11 @ 15:33:04</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46576581"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46576091">
          <h3>
            <a class="item" href="https://belowthesurface.amsterdam/en/vondsten"
              >Below the Surface: Archeological Finds from the Amsterdam
              Noord/Zuid Metro Line</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-11 @ 14:36:13</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46576091"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46574989">
          <h3>
            <a
              class="item"
              href="https://www.royalbhati.com/posts/js-array-vs-typedarray"
              >Why Object of Arrays beat interleaved arrays: a JavaScript
              performance issue</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-11 @ 12:05:17</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46574989"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
