<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46881568">
          <h3>
            <a
              class="item"
              href="https://www.openpetition.de/petition/online/recognition-of-work-on-open-source-as-volunteering-in-germany"
              >Petition for Recognition of Work on Open-Source as Volunteering
              in Germany</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-04 @ 04:46:15</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46881568"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46881264">
          <h3>
            <a
              class="item"
              href="https://www.jernesto.com/articles/thinking_hard"
              >I miss thinking hard</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-04 @ 03:54:11</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46881264"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46878338">
          <h3>
            <a
              class="item"
              href="https://securelist.com/notepad-supply-chain-attack/118708/"
              >Notepad++ supply chain attack breakdown</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 22:35:27</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46878338"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46877403">
          <h3>
            <a
              class="item"
              href="https://dl.acm.org/doi/10.1145/3774934.3786425"
              >FlashAttention-T: Towards Tensorized Attention</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 21:15:48</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46877403"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46876105">
          <h3>
            <a class="item" href="https://civai.org/blog/space-data-centers"
              >Data centers in space makes no sense</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 19:37:30</span
              ><span class="points-container"
                >Points: <span class="points">424</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46876105"
                  >Comments</a
                ><span class="descendants">: 536</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46875228">
          <h3>
            <a class="item" href="https://github.com/alibaba/AliSQL"
              >AliSQL: Alibaba's open-source MySQL with vector and DuckDB
              engines</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 18:40:18</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46875228"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46875033">
          <h3>
            <a
              class="item"
              href="https://fortune.com/2026/02/03/famed-startup-incubator-y-combinator-to-let-founders-receive-funds-in-stablecoins/"
              >Y Combinator will let founders receive funds in stablecoins</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 18:28:48</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46875033"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46874619">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2026/02/xcode-26-point-3-unlocks-the-power-of-agentic-coding/"
              >Xcode 26.3 – Developers can leverage coding agents directly in
              Xcode</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 18:04:08</span
              ><span class="points-container"
                >Points: <span class="points">280</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46874619"
                  >Comments</a
                ><span class="descendants">: 226</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46874097">
          <h3>
            <a
              class="item"
              href="https://deno.com/blog/introducing-deno-sandbox"
              >Deno Sandbox</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 17:33:20</span
              ><span class="points-container"
                >Points: <span class="points">383</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46874097"
                  >Comments</a
                ><span class="descendants">: 128</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46873574">
          <h3>
            <a
              class="item"
              href="https://fredbenenson.com/blog/2026/02/03/221-cannon-is-not-for-sale/"
              >221 Cannon is Not For Sale</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 16:56:06</span
              ><span class="points-container"
                >Points: <span class="points">214</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46873574"
                  >Comments</a
                ><span class="descendants">: 167</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46873539">
          <h3>
            <a
              class="item"
              href="https://waspdev.com/articles/2026-01-11/kilobyte-is-1000-bytes"
              >1 kilobyte is precisely 1000 bytes?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 16:53:50</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46873539"
                  >Comments</a
                ><span class="descendants">: 270</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46873294">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/europe-digital-sovereignty-big-tech-9f5388b68a0648514cebc8d92f682060"
              >France dumps Zoom and Teams as Europe seeks digital autonomy from
              the US</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 16:39:18</span
              ><span class="points-container"
                >Points: <span class="points">866</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46873294"
                  >Comments</a
                ><span class="descendants">: 456</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46873138">
          <h3>
            <a class="item" href="https://github.com/j178/prek"
              >Prek: A better, faster, drop-in pre-commit replacement,
              engineered in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 16:29:34</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46873138"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46872733">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46872733"
              >Launch HN: Modelence (YC S25) – App Builder with TypeScript /
              MongoDB Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 16:03:21</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46872733"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
            <div class="text">
              <a href="https://modelence.com">https://modelence.com</a>). After
              spending years on scaling our previous startup’s platform, we
              built an open-source full-stack TypeScript + MongoDB framework to
              stop solving the same auth / database / API / cron job
              implementations every time we created an app, and we didn’t like
              the idea of using multiple managed platforms for each of these to
              run our apps either.
              <p>
                (Here’s our prior Show HN post for reference:
                <a href="https://news.ycombinator.com/item?id=44902227"
                  >https://news.ycombinator.com/item?id=44902227</a
                >)
              </p>
              <p>
                At the same time, we were excited by the whole AI app builder
                boom and realized that the real challenge there is the platform
                rather than the tool itself. Now we’re making Modelence the
                first full-stack framework that’s built for coding agents and
                humans alike:
              </p>
              <p>
                - TypeScript is already great for AI coding because it provides
                guardrails and catches many errors at build time, so agents can
                auto-correct
              </p>
              <p>
                - MongoDB eliminates the schema management problem for agents,
                which is where they fail the most often otherwise (+ works great
                with TS/Node.js)
              </p>
              <p>
                - Built-in auth, database, cron jobs and else that just works
                together out of the box means agents only focus on your product
                logic and don’t fail at trying to set these things up (+ less
                tokens spent on boilerplate).
              </p>
              <p>
                You can now try the Modelence app builder (based on Claude Agent
                SDK) by just typing a prompt on our landing page (
                <a href="https://modelence.com">https://modelence.com</a> ) -
                watch a demo video here:
                <a href="https://youtu.be/BPsYvj_nGuE"
                  >https://youtu.be/BPsYvj_nGuE</a
                >
              </p>
              <p>
                Then you can check it out locally and continue working in your
                own IDE, while still using Modelence Cloud as your backend, with
                a dev cloud environment, and later deploy and run on Modelence
                Cloud with built-in observability around every operation running
                in your app.
              </p>
              <p>
                We’re also going to add a built-in DevOps agent that lives in
                the same cloud, knows the framework end-to-end, and will use all
                this observability data to act on errors, alerts, and incidents
                - closing the loop, because running in production is much harder
                than just building.
              </p>
              <p>
                We launched the app builder as a quick start for developers, to
                demonstrate the framework and Modelence Cloud without having to
                manually read docs and follow the steps to set up a new app. Our
                main focus is still the platform itself, since we believe the
                real challenge in AI coding is the framework and the platform
                rather than the builder tool itself.
              </p>
            </div>
          </section>
        </section>
        <section id="46872706">
          <h3>
            <a class="item" href="https://qwen.ai/blog?id=qwen3-coder-next"
              >Qwen3-Coder-Next</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 16:01:50</span
              ><span class="points-container"
                >Points: <span class="points">618</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46872706"
                  >Comments</a
                ><span class="descendants">: 379</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46872540">
          <h3>
            <a
              class="item"
              href="https://blog.adafruit.com/2026/02/03/new-york-wants-to-ctrlaltdelete-your-3d-printer/"
              >New York’s budget bill would require “blocking technology” on all
              3D printers</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 15:51:42</span
              ><span class="points-container"
                >Points: <span class="points">338</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46872540"
                  >Comments</a
                ><span class="descendants">: 380</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46871173">
          <h3>
            <a class="item" href="https://agentskills.io/home">Agent Skills</a>
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 14:09:54</span
              ><span class="points-container"
                >Points: <span class="points">420</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46871173"
                  >Comments</a
                ><span class="descendants">: 218</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46870015">
          <h3>
            <a
              class="item"
              href="https://bunny.net/blog/meet-bunny-database-the-sql-service-that-just-works/"
              >Bunny Database</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 12:13:44</span
              ><span class="points-container"
                >Points: <span class="points">268</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46870015"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46868998">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/ce3ex92557jo"
              >X offices raided in France as UK opens fresh investigation into
              Grok</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 10:08:52</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46868998"
                  >Comments</a
                ><span class="descendants">: 480</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46848876">
          <h3>
            <a
              class="item"
              href="https://www.simonberens.com/p/lessons-learned-shipping-500-units"
              >Lessons learned shipping 500 units of my first hardware
              product</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-01 @ 20:01:00</span
              ><span class="points-container"
                >Points: <span class="points">473</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46848876"
                  >Comments</a
                ><span class="descendants">: 212</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46847690">
          <h3>
            <a class="item" href="https://github.com/puemos/craftplan"
              >Show HN: Craftplan – I built my wife a production management tool
              for her bakery</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-01 @ 17:25:39</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46847690"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                Craftplan handles recipes (versioned BOMs with cost rollups),
                inventory (lot traceability, demand forecasting, allergen
                tracking), orders, production batch planning, and purchasing.
                Built with Elixir, Ash Framework, Phoenix LiveView, and
                PostgreSQL.
              </p>
              <p>
                Live demo:
                <a href="https://craftplan.fly.dev"
                  >https://craftplan.fly.dev</a
                >
                (test@test.com / Aa123123123123)
              </p>
              <p>
                GitHub:
                <a href="https://github.com/puemos/craftplan"
                  >https://github.com/puemos/craftplan</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46846253">
          <h3>
            <a class="item" href="https://pinchito.es/2026/avis-lxxx"
              >Flying Around the World in under 80 Days</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-01 @ 13:56:57</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46846253"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46846101">
          <h3>
            <a class="item" href="https://banteg.xyz/posts/crimsonland/"
              >Resurrecting Crimsonland – Decompiling and preserving a cult 2003
              classic game</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-01 @ 13:32:58</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46846101"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46845650">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/science.adz1187"
              >Heritability of intrinsic human life span is about 50%</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-01 @ 12:13:22</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46845650"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46844157">
          <h3>
            <a class="item" href="https://foxmoss.com/blog/kurrat/"
              >Reimplementing Tor from Scratch for a Single-Hop Proxy</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-01 @ 06:53:42</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46844157"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46833798">
          <h3>
            <a
              class="item"
              href="https://blogs.igalia.com/alice/reference-target-having-your-encapsulation-and-eating-it-too/"
              >Reference Target: having your encapsulation and eating it too</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-31 @ 05:32:12</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46833798"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46833534">
          <h3>
            <a
              class="item"
              href="https://www.pugetsystems.com/labs/articles/puget-systems-most-reliable-hardware-of-2025/"
              >Puget Systems Most Reliable Hardware of 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-31 @ 04:34:25</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46833534"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46822717">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2026/01/29/science/zapotec-tomb-mexico-scli-intl"
              >1,400-year-old tomb featuring giant owl sculpture discovered in
              Mexico</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-30 @ 10:26:54</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46822717"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46813029">
          <h3>
            <a
              class="item"
              href="https://www.thedrive.com/news/youll-have-that-on-those-big-jobs-the-worlds-largest-zip-tie-is-nearly-4-feet-long-and-75"
              >The largest zip tie is nearly 4 feet long and $75</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-29 @ 17:08:20</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46813029"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46795961">
          <h3>
            <a
              class="item"
              href="https://thewrongtools.wordpress.com/2019/10/10/the-everdeck/"
              >The Everdeck: A Universal Card System (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-28 @ 14:38:21</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46795961"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
