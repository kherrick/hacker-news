<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39507831">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39507831"
              >Ask HN: What do I do with my side projects?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 04:57:07</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39507831"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                Even if I don’t make any revenue, I think they will help me
                stand out in the job market. I think some of them would be a
                better fit for open source than others. Most of them would
                probably be more useful to power users than general users. I
                would be a little upset with myself if I give them away and get
                nothing when there is a chance to make some income.
              </p>
              <p>
                Either way, I’ve heard that marketing is important. Now that
                they are mostly done, this will probably be what I work on next.
                For some advice, I've been in contact with a successful
                independent developer. They attribute their success to hard
                work, and a large portion to luck and timing.
              </p>
              <p>
                If you also have any personal experience with side projects you
                can share that might relate to my situation I would appreciate
                it. Did you release the project as open source or closed? What
                went well? What mistakes did you make? Etc.
              </p>
              <p>
                Some more background information for those interested. There are
                a few bigger projects that I have worked on. The first is a goal
                management app with a focus on habit creation that uses the
                Beeminder API. The next is a tool to help learn more advanced
                keyboard shortcuts. A couple are related to window management
                and window switching, sort of an alt tab enhancement. One is
                educational content for having a better relationship with your
                screen based devices.
              </p>
              <p>
                I graduated from college close to four years ago. After I
                graduated I was struggling to find a job related to my degree
                (Applied Computing Technology) so I took on a job to get by and
                I started to work on my side projects more. Before I knew I it I
                was working on them a lot. It has gotten to the point where I
                have finished most the major work on them. I want to do
                something with at least a couple of them as I get more serious
                about applying for jobs related to my degree again.
              </p>
            </div>
          </section>
        </section>
        <section id="39507758">
          <h3>
            <a
              class="item"
              href="https://www.baldurbjarnason.com/2024/disillusioned-with-deno/"
              >Disillusioned with Deno</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 04:42:39</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39507758"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39507553">
          <h3>
            <a
              class="item"
              href="https://tomcritchlow.com/2024/02/16/narrative-strategy/"
              >Business Narrative Strategy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 04:07:39</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39507553"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39507402">
          <h3>
            <a
              class="item"
              href="https://github.com/kutinden/buyingacar/blob/main/README.md"
              >New car buying guide: the algorithm</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 03:36:22</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39507402"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39507230">
          <h3>
            <a
              class="item"
              href="https://www.fda.gov/news-events/press-announcements/fda-approves-first-medication-help-reduce-allergic-reactions-multiple-foods-after-accidental"
              >FDA approves first medication to reduce allergic reactions to
              multiple foods</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 03:02:30</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39507230"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39506929">
          <h3>
            <a
              class="item"
              href="https://computer.rip/2024-02-25-a-history-of-the-tty.html"
              >A History of the TTY</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 02:06:41</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39506929"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39506622">
          <h3>
            <a
              class="item"
              href="https://health.mil/Military-Health-Topics/Centers-of-Excellence/Psychological-Health-Center-of-Excellence/Real-Warriors-Campaign/Articles/Stress-Reduction-Techniques-for-High-Stress-Operations"
              >Stress Reduction Techniques for High Stress Operations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 01:05:01</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39506622"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39506420">
          <h3>
            <a
              class="item"
              href="http://manuals.chudov.com/Servo-Tuning/PID-without-a-PhD.pdf"
              >PID Without a PhD [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 00:22:52</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39506420"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39506000">
          <h3>
            <a class="item" href="https://github.com/snazzy-d/sdc"
              >The Snazzy D Compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 23:21:32</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39506000"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39504981">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2024/03/04/inside-north-koreas-forced-labor-program-in-china"
              >Inside North Korea's Forced Labor Program</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 21:31:30</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39504981"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39504859">
          <h3>
            <a
              class="item"
              href="https://www.daube.ch/docu/glossary/drawingtools.html"
              >Drawing and illustrating in the pre-digital time (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 21:17:53</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39504859"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39504715">
          <h3>
            <a class="item" href="https://nekoweb.org/"
              >Show HN: Nekoweb – a retro static web hosting</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 21:03:14</span
              ><span class="points-container"
                >Points: <span class="points">258</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39504715"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39504271">
          <h3>
            <a
              class="item"
              href="https://ensia.com/features/saola-endangered-conservation-biodiversity-annamite-mountains-southeast-asia/"
              >In Search of the Last Saola</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 20:10:32</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39504271"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39504266">
          <h3>
            <a
              class="item"
              href="https://hackneybooks.co.uk/books/364/686/Pleasures.html"
              >Pleasures by Aldous Huxley (1920)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 20:09:46</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39504266"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39504072">
          <h3>
            <a
              class="item"
              href="https://frontendmasters.com/blog/console-delight/"
              >Console.delight</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 19:43:38</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39504072"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39503777">
          <h3>
            <a
              class="item"
              href="https://matthewrocklin.com/write-dumb-code.html"
              >Write Dumb Code (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 19:14:02</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39503777"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39503193">
          <h3>
            <a class="item" href="https://altair-viz.github.io/index.html"
              >Vega-Altair: Declarative Visualization in Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 18:12:31</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39503193"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39502433">
          <h3>
            <a class="item" href="https://patterns.app/"
              >Patterns (YC S21) is hiring to automate analytics with LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 17:01:01</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39502276">
          <h3>
            <a
              class="item"
              href="https://www.chiark.greenend.org.uk/~sgtatham/coroutines.html"
              >Coroutines in C (2000)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 16:45:03</span
              ><span class="points-container"
                >Points: <span class="points">246</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39502276"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39502165">
          <h3>
            <a
              class="item"
              href="https://pubs.acs.org/doi/10.1021/acsomega.2c07780"
              >Efficient recovery and recycling of cobalt from spent lithium-ion
              batteries</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 16:33:21</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39502165"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39501982">
          <h3>
            <a
              class="item"
              href="https://www.kolaayonrinde.com/blog/2024/02/11/mamba.html"
              >Mamba Explained: The State Space Model Taking On Transformers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 16:16:17</span
              ><span class="points-container"
                >Points: <span class="points">223</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39501982"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39501469">
          <h3>
            <a
              class="item"
              href="https://bigmedium.com/ideas/design-system-pace-layers-slow-fast.html"
              >Ship faster by building design systems slower (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 15:22:39</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39501469"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39501073">
          <h3>
            <a class="item" href="https://usoldering.com/switch-lite/"
              >Show HN: Reverse-Engineering a Switch Lite with 1,917 wires</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 14:27:54</span
              ><span class="points-container"
                >Points: <span class="points">429</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39501073"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
            <div class="text">
              <p>
                Most public boardviews are almost entirely the result of
                industrial espionage, other than a few encrypted subscription
                based software platforms that provide extensive access. The
                process output is released as donationware, as my main concern
                is that even released as a low-cost purchase, there is a very
                strong culture to share this type of information at no cost. I
                would like to have a more sophisticated suggested donation
                system adaptive to user country, but I wasn't able to find a
                good solution.
              </p>
              <p>
                In terms of 'good startup ideas', I don't think this is one of
                them. The very high level of soldering skill required makes it
                difficult to scale, and the prevailing piracy culture makes it
                challenging to monetize. My main advantage is that costs are
                very low now that I have the entire thing working. Other than
                forge ahead at a loss and hope for the best, or to pivot hard
                leveraging the imaging technology, I'm not sure what other
                options I have. It feels too complicated and repetitive for
                shoft-form video content. If you have any feedback, questions,
                suggestions, etc., I'd love to hear them.
              </p>
            </div>
          </section>
        </section>
        <section id="39500386">
          <h3>
            <a
              class="item"
              href="https://robbowen.digital/wrote-about/abandoned-side-projects/"
              >It's OK to abandon your side-project</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 12:52:13</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39500386"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39499074">
          <h3>
            <a
              class="item"
              href="https://hakaimagazine.com/news/working-with-purpose-forever/"
              >Working with Purpose, Forever</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 09:09:10</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39499074"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39495378">
          <h3>
            <a
              class="item"
              href="https://jpmens.net/2024/02/23/totp-codes-in-the-terminal/"
              >TOTP Codes in the Terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 21:42:00</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39495378"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39493363">
          <h3>
            <a class="item" href="https://github.com/epogrebnyak/justpath"
              >Show HN: Justpath – a simple utility to explore the PATH
              environment variable</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 17:32:29</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39493363"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39492618">
          <h3>
            <a class="item" href="https://taylor.town/frugly"
              >Frugly vs. Freemium</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 16:08:37</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39492618"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39490892">
          <h3>
            <a
              class="item"
              href="https://www.vanityfair.com/news/life-aboard-a-nuclear-submarine"
              >Life Aboard a Nuclear Submarine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 11:57:42</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39490892"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39490740">
          <h3>
            <a
              class="item"
              href="https://astrid.tech/2024/02/24/0/conda-recipe-selector-abuse/"
              >Abusing Conda's Turing-Complete YAML Comments</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 11:14:31</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39490740"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
