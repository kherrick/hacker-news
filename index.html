<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39119014">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2210.15723"
              >Birdwatch: Crowd Wisdom and Algorithms to Understand and Reduce
              Misinformation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 16:08:02</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39119014"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39118988">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/2024/jan/18/pig-liver-animal-to-human-transplants"
              >Experimental use of pig liver to filter blood offers hope for
              patients</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 16:06:21</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39118988"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39118963">
          <h3>
            <a
              class="item"
              href="https://blogs.nvidia.com/blog/rtx-video-hdr-remix-studio-driver/"
              >AI-Powered Nvidia RTX Video HDR Transforms Standard Video into
              HDR Video</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 16:04:40</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39118963"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39118866">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/forensics-gone-wrong-when-dna-snares-innocent"
              >Forensics Gone Wrong: When DNA Snares the Innocent</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 15:57:51</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39118866"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39118570">
          <h3>
            <a
              class="item"
              href="https://techxplore.com/news/2024-01-today-architects-lost-ventilation-19th.html"
              >Today's architects can learn from a 19th century's lost
              ventilation system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 15:37:50</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39118570"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39118314">
          <h3>
            <a class="item" href="http://eulerarchive.maa.org/hedi/index.html"
              >How Euler did it? (by Ed Sandifer)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 15:17:09</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39118314"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39117903">
          <h3>
            <a
              class="item"
              href="https://nvd.nist.gov/vuln/detail/CVE-2024-0519"
              >Out of bounds memory access in V8 in Google Chrome prior to
              120.0.6099.224</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 14:46:43</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39117903"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39117609">
          <h3>
            <a
              class="item"
              href="https://www.space.com/pentagon-us-military-declassify-secret-space-programs"
              >Pentagon moves to declassify some secret space programs and
              technologies</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 14:19:38</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39117609"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39117304">
          <h3>
            <a
              class="item"
              href="https://www.bleepingcomputer.com/news/security/tesla-hacked-24-zero-days-demoed-at-pwn2own-automotive-2024/"
              >Security researchers collect awards for Tesla exploits at Pwn2Own
              Automotive</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 13:49:39</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39117304"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39117155">
          <h3><a class="item" href="https://duplicity.us/">Duplicity</a></h3>
          <section>
            <h4>
              <span>2024-01-24 @ 13:37:40</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39117155"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39116290">
          <h3>
            <a
              class="item"
              href="https://jamsocket.com/blog/senior-rust-engineer"
              >Jamsocket (YC W22) is hiring a senior Rust systems engineer
              (NYC/remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 12:00:43</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39116195">
          <h3>
            <a
              class="item"
              href="https://github.com/goenning/google-indexing-script"
              >Show HN: Open-source script to get your site indexed on Google</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 11:49:04</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39116195"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39115934">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-00165-x"
              >All arabica coffee is genetically similar: how can beans taste so
              different?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 11:02:09</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39115934"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39114535">
          <h3>
            <a
              class="item"
              href="https://www.argmin.net/p/should-you-go-for-2-down-8"
              >Should you go for 2 down 8?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 07:16:46</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39114535"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39114259">
          <h3>
            <a class="item" href="https://www.secretlifeofmachines.com/"
              >The Secret Life of Machines (1988)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 06:23:42</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39114259"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39114075">
          <h3>
            <a class="item" href="https://lumiere-video.github.io/"
              >Lumiere: A space-time diffusion model for realistic video
              generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 05:49:09</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39114075"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39113972">
          <h3>
            <a class="item" href="https://github.com/nlmatics/nlm-ingestor"
              >Show HN: Open-source Rule-based PDF parser for RAG</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 05:31:11</span
              ><span class="points-container"
                >Points: <span class="points">213</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39113972"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
            <div class="text">
              <p>The PDF Parser offers the following features:</p>
              <p>
                * Sections and subsections along with their levels. * Paragraphs
                - combines lines. * Links between sections and paragraphs. *
                Tables along with the section the tables are found in. * Lists
                and nested lists. * Join content spread across pages. * Removal
                of repeating headers and footers. * Watermark removal. * OCR
                with boundary boxes
              </p>
            </div>
          </section>
        </section>
        <section id="39113879">
          <h3>
            <a class="item" href="https://teachyourselfmath.app/"
              >Show HN: I wished for a site with a growing list of math
              problems, I built it</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 05:12:49</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39113879"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
            <div class="text">
              <p>
                teachyourselfmath is a side project that was born out of this
                need. At its core, it is a math PDF extraction engine. The
                engine has some machine learning going on behind the scenes to
                extract math problems in LaTeX from any image or document.
              </p>
              <p>
                A little bit about me: I am Vivek, a software engineer based out
                of India with a diverse set of interests including math. This
                project is close to my heart for many different reasons and
                nothing would make me happier than finding people on the
                internet who would find this website to be useful.
              </p>
              <p>I’d love to hear your feedback on this. Thanks!</p>
            </div>
          </section>
        </section>
        <section id="39113168">
          <h3>
            <a class="item" href="https://overpass-turbo.eu/"
              >Overpass Turbo: A Web Based Data Mining Tool for OpenStreetMap</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 03:13:32</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39113168"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39112848">
          <h3>
            <a
              class="item"
              href="https://www.fishmanafnewsletter.com/p/balancing-engineering-cultures-debate-vs-do"
              >Balancing engineering cultures: Debate everything vs. just tell
              me what to build</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 02:21:10</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39112848"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39111991">
          <h3>
            <a class="item" href="http://worrydream.com/MagicInk/"
              >Magic Ink (2006)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-24 @ 00:28:13</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39111991"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39111406">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/20230324-00/?p=107966"
              >The case of the jump into the middle of an instruction from
              nowhere (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 23:21:09</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39111406"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39110434">
          <h3>
            <a class="item" href="https://waterwaymap.org">Waterway Map</a>
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 21:51:06</span
              ><span class="points-container"
                >Points: <span class="points">373</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39110434"
                  >Comments</a
                ><span class="descendants">: 135</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39106464">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/01/23/health/deaf-gene-therapy.html"
              >Gene therapy allows an 11-year-old boy to hear</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 17:26:34</span
              ><span class="points-container"
                >Points: <span class="points">409</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39106464"
                  >Comments</a
                ><span class="descendants">: 198</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39104913">
          <h3>
            <a
              class="item"
              href="https://www.os2museum.com/wp/tarbell-to-cromemco/"
              >Tarbell to Cromemco</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 15:46:31</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39104913"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39104504">
          <h3>
            <a class="item" href="https://bernsteinbear.com/blog/scrapscript/"
              >scrapscript.py</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 15:19:22</span
              ><span class="points-container"
                >Points: <span class="points">264</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39104504"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39103419">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2401.09514"
              >Is the emergence of life an expected phase transition in the
              evolving universe?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 14:06:03</span
              ><span class="points-container"
                >Points: <span class="points">417</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39103419"
                  >Comments</a
                ><span class="descendants">: 348</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39098013">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=wuN-bW_zS0Q"
              >Ode to Internet – V.90 56k dialup modem handshake for orchestra
              (1996) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 01:07:11</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39098013"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39088592">
          <h3>
            <a class="item" href="https://www.mdpi.com/2409-9252/4/1/2"
              >The Evolution of Warfare and Weapons in Japan, 792-1392</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 12:06:48</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39088592"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39086632">
          <h3>
            <a
              class="item"
              href="https://www.csail.mit.edu/news/study-smart-devices-ambient-light-sensors-pose-imaging-privacy-risk"
              >Ambient light sensors pose imaging privacy risk</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 05:34:39</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39086632"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
