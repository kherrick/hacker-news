<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46711346">
          <h3>
            <a class="item" href="https://docs.freebsd.org/en/books/handbook/"
              >FreeBSD</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 20:49:05</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46711346"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46711313">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Deaths_linked_to_chatbots"
              >Deaths Linked to AI Chatbots</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 20:47:01</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46711313"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46710108">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46710108"
              >Ask HN: How are you automating your coding work?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 19:13:44</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46710108"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
            <div class="text">
              With the increase of vibe coding I am interested in knowing some
              creative ways people are automating their coding work.
            </div>
          </section>
        </section>
        <section id="46709727">
          <h3>
            <a
              class="item"
              href="https://www.linuxfromscratch.org/lfs/view/stable/"
              >Linux from Scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 18:44:40</span
              ><span class="points-container"
                >Points: <span class="points">282</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46709727"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46709548">
          <h3>
            <a class="item" href="https://www.blueorigin.com/terawave"
              >TeraWave Satellite Communications Network</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 18:31:58</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46709548"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46709543">
          <h3>
            <a class="item" href="https://railsui.com/">Show HN: Rails UI</a>
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 18:31:19</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46709543"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46709179">
          <h3>
            <a
              class="item"
              href="https://www.sciencedaily.com/releases/2026/01/260120000333.htm"
              >Stanford scientists found a way to regrow cartilage and stop
              arthritis</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 18:05:36</span
              ><span class="points-container"
                >Points: <span class="points">192</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46709179"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46708990">
          <h3>
            <a class="item" href="https://jobswithgpt.com/company-profiles/"
              >Show HN: Company hiring trends and insights from job postings</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 17:52:17</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46708990"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <a href="https://jobswithgpt.com/company-profiles/openai/"
                >https://jobswithgpt.com/company-profiles/openai/</a
              >
              <a
                href="https://jobswithgpt.com/company-profiles/advanced-micro-devices-inc/"
                >https://jobswithgpt.com/company-profiles/advanced-micro-devi...</a
              >
            </div>
          </section>
        </section>
        <section id="46708766">
          <h3>
            <a
              class="item"
              href="https://www.saturdayeveningpost.com/2017/06/didion/"
              >Slouching Towards Bethlehem – Joan Didion (1967)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 17:36:09</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46708766"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46708678">
          <h3>
            <a class="item" href="https://blog.kagi.com/waiting-dawn-search"
              >Waiting for dawn in search: Search index, Google rulings and
              impact on Kagi</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 17:28:03</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46708678"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46708315">
          <h3>
            <a class="item" href="https://atg.science/"
              >Autonomous (YC F25) is hiring – AI-native financial advisor at 0%
              advisory fees</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 17:00:54</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46708096">
          <h3>
            <a class="item" href="https://www.yyzkevin.com/picopcmcia/"
              >PicoPCMCIA – a PCMCIA development board for retro-computing
              enthusiasts</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 16:43:57</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46708096"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46708032">
          <h3>
            <a class="item" href="https://tildeweb.nl/~michiel/jxl/"
              >JPEG XL Test Page</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 16:38:26</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46708032"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46707699">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46707699"
              >Tell HN: Bending Spoons laid off almost everybody at Vimeo
              yesterday</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 16:14:39</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46707699"
                  >Comments</a
                ><span class="descendants">: 251</span></span
              >
            </h4>
            <div class="text">
              As expected. Almost the whole company is gone, less than 15 people
              left in engineering.
            </div>
          </section>
        </section>
        <section id="46707572">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/news/claude-new-constitution"
              >Claude's New Constitution</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 16:04:49</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46707572"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46706947">
          <h3><a class="item" href="https://docs.smartos.org/">SmartOS</a></h3>
          <section>
            <h4>
              <span>2026-01-21 @ 15:23:18</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46706947"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46706906">
          <h3>
            <a class="item" href="https://skip.dev/blog/skip-is-free/"
              >Skip Is Now Free and Open Source</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 15:20:53</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46706906"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46706796">
          <h3>
            <a class="item" href="https://github.com/borenstein/yolo-cage"
              >Show HN: yolo-cage – AI coding agents that can't exfiltrate
              secrets</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 15:13:29</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46706796"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
            <div class="text">
              <p>
                Backstory: I've been using many agents in parallel as I work on
                a somewhat ambitious financial analysis tool. I was juggling
                agents working on epics for the linear solver, the persistence
                layer, the front-end, and planning for the second-generation
                solver. I was losing my mind playing whack-a-mole with the
                permission prompts. YOLO mode felt so tempting. And yet.
              </p>
              <p>
                Then it occurred to me: what if YOLO mode isn't so bad? Decision
                fatigue is a thing. If I could cap the blast radius of a
                confused agent, maybe I could just review once. Wouldn't that be
                safer?
              </p>
              <p>
                So that day, while my kids were taking a nap, I decided to see
                if I could put YOLO-mode Claude inside a sandbox that blocks
                exfiltration and regulates git access. The result is yolo-cage.
              </p>
              <p>
                Also: the AI wrote its own containment system from inside the
                system's own prototype. Which is either very aligned or very
                meta, depending on how you look at it.
              </p>
            </div>
          </section>
        </section>
        <section id="46706668">
          <h3>
            <a class="item" href="https://dashboard.infracost.io/"
              >Show HN: See the carbon impact of your cloud as you code</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 15:04:07</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46706668"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.infracost.io">https://www.infracost.io</a>).
              Infracost helps engineers see and reduce the cloud cost of each
              infrastructure change before they merge their code. The way
              Infracost works is we gather pricing data from Amazon Web
              Services, Microsoft Azure and Google Cloud. What we call a
              ‘Pricing Service’, which now holds around 9 million live price
              points (!!). Then we map these prices to infrastructure code. Once
              the mapping is done, it enables us to show the cost impact of a
              code change before it is merged, directly in GitHub, GitLab etc.
              Kind of like a checkout-screen for cloud infrastructure.
              <p>
                We’ve been building since 2020 (we were part of YC W21 batch),
                and iterating on the product, building out a team etc. However,
                back in 2020 one of our users asked if we can also show the
                carbon impact alongside costs.
              </p>
              <p>
                It has been itching my brain since then. The biggest challenge
                has always been the carbon data. The mapping of carbon data to
                infrastructure is time consuming, but it is possible since we’ve
                done it with cloud costs. But we need the raw carbon data first.
                The discussions that have happened in the last few years finally
                led me to a company called Greenpixie in the UK. A few of our
                existing customers were using them already, so I immediately
                connected with the founder, John.
              </p>
              <p>
                Greenpixie said they have the data (AHA!!) And their data is
                verified (ISO-14064 &amp; aligned with the Greenhouse Gas
                Protocol). As soon as I talked to a few of their customers, I
                asked my team to see if we can actually finally do this, and
                build it.
              </p>
              <p>
                My thinking is this: some engineers will care, and some will not
                (or maybe some will love it and some will hate it!). For those
                who care, cost and carbon are actually linked; meaning if you
                reduce the carbon, you usually reduce the cost of the cloud too.
                It can act as another motivation factor.
              </p>
              <p>
                And now, it is here, and I’d love your feedback. Try it out by
                going to
                <a href="https://dashboard.infracost.io/"
                  >https://dashboard.infracost.io/</a
                >, create an account, set up with the GitHub app or GitLab app,
                and send a pull request with Terraform changes (you can use our
                example terraform file). It will then show you the cost impact
                alongside the carbon impact, and how you can optimize it.
              </p>
              <p>
                I’d especially love to hear your feedback on if you think carbon
                is a big driver for engineers within your teams, or if carbon is
                a big driver for your company (i.e. is there anything top-down
                about carbon).
              </p>
              <p>AMA - I’ll be monitoring the thread :)</p>
              <p>Thanks</p>
            </div>
          </section>
        </section>
        <section id="46706528">
          <h3>
            <a class="item" href="https://github.com/ChartGPU/ChartGPU"
              >Show HN: ChartGPU – WebGPU-powered charting library (1M points at
              60fps)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 14:54:56</span
              ><span class="points-container"
                >Points: <span class="points">402</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46706528"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
            <div class="text">
              <p>
                The core insight: Canvas2D is fundamentally CPU-bound. Even
                WebGL chart libraries still do most computation on the CPU. So I
                moved everything to the GPU via WebGPU:
              </p>
              <p>
                - LTTB downsampling runs as a compute shader - Hit-testing for
                tooltips/hover is GPU-accelerated - Rendering uses instanced
                draws (one draw call per series)
              </p>
              <p>The result: 1M points at 60fps with smooth zoom/pan.</p>
              <p>
                Live demo:
                <a
                  href="https://chartgpu.github.io/ChartGPU/examples/million-points/"
                  >https://chartgpu.github.io/ChartGPU/examples/million-points/</a
                >
              </p>
              <p>
                Currently supports line, area, bar, scatter, pie, and
                candlestick charts. MIT licensed, available on npm: `npm install
                chartgpu`
              </p>
              <p>
                Happy to answer questions about WebGPU internals or architecture
                decisions.
              </p>
            </div>
          </section>
        </section>
        <section id="46705201">
          <h3>
            <a class="item" href="https://susam.net/nested-code-fences.html"
              >Nested Code Fences in Markdown</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 13:08:35</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46705201"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46703763">
          <h3>
            <a class="item" href="https://www.eu-inc.org/"
              >EU–INC – A new pan-European legal entity</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 10:49:20</span
              ><span class="points-container"
                >Points: <span class="points">674</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46703763"
                  >Comments</a
                ><span class="descendants">: 640</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://ec.europa.eu/commission/presscorner/detail/da/speech_26_150"
                >https://ec.europa.eu/commission/presscorner/detail/da/speech...</a
              >
            </div>
          </section>
        </section>
        <section id="46703317">
          <h3>
            <a
              class="item"
              href="https://atempleton.bearblog.dev/i-made-zig-compute-33-million-satellite-positions-in-3-seconds-no-gpu-required/"
              >I Made Zig Compute 33M Satellite Positions in 3 Seconds. No GPU
              Required</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 09:51:27</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46703317"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46702411">
          <h3>
            <a
              class="item"
              href="https://eclecticlight.co/2026/01/21/can-you-slim-macos-down/"
              >Can you slim macOS down?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 07:48:06</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46702411"
                  >Comments</a
                ><span class="descendants">: 178</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46696300">
          <h3>
            <a
              class="item"
              href="https://karllorey.com/posts/without-benchmarking-llms-youre-overpaying"
              >Without benchmarking LLMs, you're likely overpaying</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 19:03:25</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46696300"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46663931">
          <h3>
            <a class="item" href="https://elliotarledge.com/blog/batmobile"
              >Batmobile: 10-20x Faster CUDA Kernels for Equivariant Graph
              Neural Networks</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-18 @ 01:29:42</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46663931"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46662515">
          <h3>
            <a class="item" href="https://afska.github.io/emudevz/"
              >EmuDevz: A game about developing emulators</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 21:57:21</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46662515"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46662247">
          <h3>
            <a class="item" href="https://github.com/soegaard/webracket"
              >The WebRacket language is a subset of Racket that compiles to
              WebAssembly</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-17 @ 21:23:58</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46662247"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46652173">
          <h3>
            <a
              class="item"
              href="https://borretti.me/article/letting-claude-play-text-adventures"
              >Letting Claude Play Text Adventures</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-16 @ 21:02:25</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46652173"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46649853">
          <h3>
            <a class="item" href="https://www.getagentcraft.com/"
              >RTS for Agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-16 @ 18:20:15</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46649853"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
