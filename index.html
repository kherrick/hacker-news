<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46633488">
          <h3>
            <a
              class="item"
              href="https://www.culpium.com/p/exclusiveapple-is-fighting-for-tsmc"
              >Apple Is Fighting for TSMC Capacity as Nvidia Takes Center
              Stage</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 15:02:42</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46633488"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46633429">
          <h3>
            <a
              class="item"
              href="https://github.com/obsproject/obs-studio/releases/tag/32.1.0-beta1"
              >OBS Studio 32.1.0 Beta 1 available</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 14:57:53</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46633429"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46633378">
          <h3>
            <a
              class="item"
              href="https://www.404media.co/elite-the-palantir-app-ice-uses-to-find-neighborhoods-to-raid/"
              >The Palantir app helping ICE raids in Minneapolis</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 14:54:51</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46633378"
                  >Comments</a
                ><span class="descendants">: 137</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46632768">
          <h3>
            <a class="item" href="https://github.com/chrisdiana/TinyCity"
              >Show HN: TinyCity – A tiny city SIM for MicroPython (Thumby micro
              console)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 14:11:30</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46632768"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46632039">
          <h3>
            <a
              class="item"
              href="https://github.com/kulesh/dotfiles/blob/main/dev/dev/docs/programming-evolved.md"
              >Programming, Evolved: Lessons and Observations</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 13:18:10</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46632039"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46632023">
          <h3>
            <a class="item" href="https://wikipedia25.org"
              >25 Years of Wikipedia</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 13:17:07</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46632023"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46632004">
          <h3>
            <a
              class="item"
              href="https://torrentfreak.com/french-court-orders-popular-vpns-to-block-more-pirate-sites-despite-opposition/"
              >French Court Orders Popular VPNs to Block More Pirate Sites,
              Despite Opposition</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 13:15:40</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46632004"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46631728">
          <h3>
            <a
              class="item"
              href="https://investinglive.com/news/the-500000-ton-typo-why-data-center-copper-math-doesnt-add-up-20260113/"
              >The 500k-ton typo: Why data center copper math doesn't add up</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 12:53:34</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46631728"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46631276">
          <h3>
            <a class="item" href="https://jiga.io/about-us"
              >Jiga (YC W21) Is Hiring Full Stack Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 12:00:37</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46630798">
          <h3>
            <a
              class="item"
              href="https://nothings.org/gamedev/thief_rendering.html"
              >The 3D Software Rendering Technology of 1998's Thief: The Dark
              Project (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 10:59:08</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46630798"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46630369">
          <h3>
            <a
              class="item"
              href="https://e360.yale.edu/digest/china-renewable-photo-essay"
              >Photos Capture the Breathtaking Scale of China's Wind and Solar
              Buildout</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 09:54:10</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46630369"
                  >Comments</a
                ><span class="descendants">: 236</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46629964">
          <h3>
            <a
              class="item"
              href="https://adamj.eu/tech/2026/01/14/python-introducing-tprof/"
              >Python: Tprof, a Targeting Profiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 09:00:47</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46629964"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46629682">
          <h3>
            <a
              class="item"
              href="https://www.jeffgeerling.com/blog/2026/raspberry-pi-ai-hat-2/"
              >Raspberry Pi's New AI Hat Adds 8GB of RAM for Local LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 08:23:02</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46629682"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46629191">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46629191"
              >Show HN: MailPilot – Freedom to go anywhere while your agents
              work</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 07:20:02</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46629191"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
            <div class="text">
              <a href="https://mailpilot.chat">https://mailpilot.chat</a>
              <p>
                What is this? A local TUI (like Claude, Codex, Gemini, OpenCode
                or Copilot) that wraps your agent and sends each turn to an
                email in a nice format.
              </p>
              <p>
                What does it enable? It lets you email your agents. And them
                email you. So They Keep Working on the tasks you want, and You
                go and do What You Want. No need to stay at your desk. Be free.
              </p>
              <p>
                I built this for me, but thought others would find it useful, so
                I turned it into a product. I want get outside, and away from my
                desk, but still have the agents work.
              </p>
              <p>
                The accidental killer feature: You can CC your team. If you
                forward the thread to a coworker, their reply goes straight to
                the agent context too. It turns a local session into an async
                multiplayer thread.
              </p>
              <p>
                Works out of the box with Claude, Codex, Gemini, Copilot, and
                OpenCode. Happy to answer questions!
              </p>
              <p><a href="https://mailpilot.chat">https://mailpilot.chat</a></p>
            </div>
          </section>
        </section>
        <section id="46627652">
          <h3>
            <a class="item" href="https://creepylink.com/"
              >The URL shortener that makes your links look as suspicious as
              possible</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 03:28:20</span
              ><span class="points-container"
                >Points: <span class="points">605</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46627652"
                  >Comments</a
                ><span class="descendants">: 118</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46626836">
          <h3>
            <a
              class="item"
              href="https://patrickmccanna.net/a-better-way-to-limit-claude-code-and-other-coding-agents-access-to-secrets/"
              >Bubblewrap: A nimble way to prevent agents from accessing your
              .env files</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 01:45:22</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46626836"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46626410">
          <h3>
            <a
              class="item"
              href="https://furiosa.ai/blog/introducing-rngd-server-efficient-ai-inference-at-data-center-scale"
              >Furiosa: 3.5x efficiency over H100s</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 00:53:21</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46626410"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46626210">
          <h3>
            <a
              class="item"
              href="https://webkit.org/blog/17746/new-safari-developer-tools-provide-insight-into-css-grid-lanes/"
              >New Safari developer tools provide insight into CSS Grid Lanes</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-15 @ 00:34:59</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46626210"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46624658">
          <h3>
            <a class="item" href="https://craftinginterpreters.com/"
              >Crafting Interpreters</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-14 @ 22:26:17</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46624658"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46624541">
          <h3>
            <a class="item" href="https://cursor.com/blog/scaling-agents"
              >Scaling long-running autonomous coding</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-14 @ 22:18:04</span
              ><span class="points-container"
                >Points: <span class="points">241</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46624541"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46624352">
          <h3>
            <a
              class="item"
              href="https://cryptography.io/en/latest/statements/state-of-openssl/"
              >The State of OpenSSL for pyca/cryptography</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-14 @ 22:04:10</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46624352"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46622328">
          <h3>
            <a
              class="item"
              href="https://www.promptarmor.com/resources/claude-cowork-exfiltrates-files"
              >Claude Cowork exfiltrates files</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-14 @ 20:12:25</span
              ><span class="points-container"
                >Points: <span class="points">774</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46622328"
                  >Comments</a
                ><span class="descendants">: 341</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46619464">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46619464"
              >Ask HN: What did you find out or explore today?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-14 @ 17:54:25</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46619464"
                  >Comments</a
                ><span class="descendants">: 260</span></span
              >
            </h4>
            <div class="text">
              Doesn't matter what domain and how big or small.
            </div>
          </section>
        </section>
        <section id="46618714">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46618714"
              >Ask HN: Share your personal website</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-14 @ 17:07:42</span
              ><span class="points-container"
                >Points: <span class="points">731</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46618714"
                  >Comments</a
                ><span class="descendants">: 2001</span></span
              >
            </h4>
            <div class="text">
              <p>
                As you can see, the directory currently has only a handful of
                entries. I need your help to grow it. If you have a personal
                website, I would be glad if you shared it here. If your website
                is hosted on a web space where you have full control over its
                design and content, and if it has been well received in past HN
                discussions, I might add it to the directory. Just drop a link
                in the comments. Please let me know if you do not want your
                website to be included in the directory.
              </p>
              <p>
                Also, I intend this to be a community maintained resource, so if
                you would like to join the GitHub project as a maintainer,
                please let me know either here or via the IRC link in the
                README.
              </p>
              <p>
                By the way, see also 'Ask HN: Could you share your personal blog
                here?' - https://news.ycombinator.com/item?id=36575081 - July
                2023 - (1014 points, 1940 comments). In this post, the scope is
                not restricted to blogs though. Any personal website is welcome,
                whether it is a blog, digital garden, personal wiki or something
                else entirely.
              </p>
              <p>
                UPDATE: It is going to take a while to go through all the
                submissions and add them. If you'd like to help with the
                process, please send a PR directly to this project:
                https://github.com/hnpwd/hnpwd.github.io
              </p>
            </div>
          </section>
        </section>
        <section id="46617360">
          <h3>
            <a class="item" href="https://www.ismypubfucked.com/"
              >Find a pub that needs you</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-14 @ 15:44:22</span
              ><span class="points-container"
                >Points: <span class="points">346</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46617360"
                  >Comments</a
                ><span class="descendants">: 320</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46616529">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46616529"
              >Ask HN: How are you doing RAG locally?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-14 @ 14:38:29</span
              ><span class="points-container"
                >Points: <span class="points">270</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46616529"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
            <div class="text">
              <p>
                Are you using a vector database, some type of semantic search, a
                knowledge graph, a hypergraph?
              </p>
            </div>
          </section>
        </section>
        <section id="46587284">
          <h3>
            <a class="item" href="https://impeccable.style">Impeccable Style</a>
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 12:03:00</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46587284"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46584523">
          <h3>
            <a class="item" href="https://sunrise-ev.com/z80.htm"
              >Z80 Mem­ber­ship Card</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 05:42:09</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46584523"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46566065">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/9b1ff0b8-a1e8-4869-8d61-620c5ed32d35"
              >Investing with GIFs: A Visual Guide</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-10 @ 14:38:21</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46566065"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46558224">
          <h3>
            <a
              class="item"
              href="https://www.toxel.com/tech/2025/09/17/san-remo-pasta-measurer/"
              >San Remo Pasta Measurer</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-09 @ 19:39:53</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46558224"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
