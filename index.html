<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42154583">
          <h3>
            <a class="item" href="https://github.com/hengyoush/kyanos"
              >Kyanos: eBPF-based network issue analysis tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-16 @ 05:34:57</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42154583"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42154410">
          <h3>
            <a class="item" href="https://llamaocr.com/"
              >Llama-OCR: Document to Markdown</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-16 @ 04:57:44</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42154410"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42154355">
          <h3>
            <a
              class="item"
              href="https://www.sfgate.com/travel/article/caltrain-electrification-project-paying-off-19917422.php"
              >Caltrain's electrification project is paying off</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-16 @ 04:47:10</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42154355"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42154311">
          <h3>
            <a
              class="item"
              href="https://ifesunmola.com/a-basic-introduction-to-the-classfile-api/"
              >A basic introduction to the classfile API in Java</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-16 @ 04:40:54</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42154311"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42153577">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/how-public-key-cryptography-really-works-20241115/"
              >How public key cryptography works, using only simple math</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-16 @ 02:19:53</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42153577"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42153535">
          <h3>
            <a class="item" href="https://github.com/captainys/FreeTOWNSOS"
              >Tsugaru OS – A New Free FM-Towns OS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-16 @ 02:14:15</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42153535"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42152928">
          <h3>
            <a
              class="item"
              href="https://twitter.com/DSCCRoss/status/1857208745014776215"
              >M4 MacBook Pros use a quantum dot (QD) film rather than a red KSF
              phosphor film</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-16 @ 00:21:34</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42152928"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42152341">
          <h3>
            <a
              class="item"
              href="https://nandland.com/book-getting-started-with-fpga/"
              >Getting Started with FPGAs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 23:09:52</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42152341"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42152076">
          <h3>
            <a
              class="item"
              href="https://labs.quansight.org/blog/dataframe-group-by"
              >Non-elementary group-by aggregations in Polars vs pandas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 22:40:20</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42152076"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42152068">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2024/11/ftc-to-launch-investigation-into-microsofts-cloud-business/"
              >FTC to launch investigation into Microsoft's cloud business</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 22:39:49</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42152068"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42151569">
          <h3>
            <a
              class="item"
              href="https://outdoors.stackexchange.com/questions/15801/why-did-people-rub-snow-on-frozen-feet"
              >Why did people rub snow on frozen feet? (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 21:50:30</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42151569"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42150933">
          <h3>
            <a
              class="item"
              href="https://lists.freebsd.org/archives/freebsd-hackers/2024-November/004068.html"
              >First Impressions: Lenovo T14s with Qualcomm Snapdragon ARM64
              CPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 20:57:05</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42150933"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42150550">
          <h3>
            <a
              class="item"
              href="https://security.googleblog.com/2024/11/retrofitting-spatial-safety-to-hundreds.html"
              >Retrofitting spatial safety to lines of C++</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 20:25:19</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42150550"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42149694">
          <h3>
            <a
              class="item"
              href="https://slimsaas.com/blog/django-scaling-performance/"
              >The Practical Guide to Scaling Django</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 18:49:32</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42149694"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42149433">
          <h3>
            <a
              class="item"
              href="https://www.nps.gov/gaar/learn/nature/wood-frog-page-2.htm"
              >Biological Miracle – Wood Frog</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 18:16:08</span
              ><span class="points-container"
                >Points: <span class="points">358</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42149433"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42149044">
          <h3>
            <a class="item" href="https://closingwtf.com"
              >Show HN: Free mortgage analysis tool to avoid getting screwed by
              closing costs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 17:38:49</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42149044"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42148543">
          <h3>
            <a class="item" href="https://github.com/thomasschafer/scooter"
              >Show HN: Scooter – Interactive find and replace in the
              terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 16:45:46</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42148543"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42148220">
          <h3>
            <a class="item" href="https://github.com/pex-tool/pex"
              >Pex: A tool for generating .pex (Python EXecutable) files, lock
              files and venvs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 16:13:47</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42148220"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42147934">
          <h3>
            <a class="item" href="https://github.com/noneback/go-taskflow"
              >Go-taskflow: A taskflow-like General-purpose Task-parallel
              Programming Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 15:49:07</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42147934"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42146957">
          <h3>
            <a
              class="item"
              href="https://www.privatdozent.co/p/the-battle-line-at-louvain-1914"
              >The Battle Line at Louvain</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 13:55:15</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42146957"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42146338">
          <h3>
            <a class="item" href="https://github.com/epasveer/seer"
              >Seer: A GUI front end to GDB for Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 12:36:09</span
              ><span class="points-container"
                >Points: <span class="points">321</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42146338"
                  >Comments</a
                ><span class="descendants">: 162</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42145419">
          <h3>
            <a class="item" href="https://onair.io/"
              >Show HN: OnAir – create link, receive calls</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 09:58:11</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42145419"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
            <div class="text">
              <p>
                This is bootstrapped/indie hacker-ish. Would appreciate
                feedback.
              </p>
              <p>
                What it is: You create a link (e.g. onair/yourname), and anyone
                can call you from it. Caller uses a web browser to make the call
                (not dedicated app). You can create as many links as you want,
                and can direct calls to colleagues in a round-robin or
                escalation manner.
              </p>
              <p>
                In a way, it's like the "opposite of Calendly"; whereas Calendly
                is about meetings in the future, OnAir is about immediate
                meetings.
              </p>
              <p>
                Motivation behind it: One of our SaaS products was struggling to
                grow. We believed that if we provide more "hand holding" to
                visitors on the landing page, it will increase conversion. It's
                like speaking to the guy behind the counter before making a
                purchase. That idea/experiment, over time, became OnAir.
              </p>
              <p>
                Feedback: Identifying the perfect use case / customer has not
                been easy. E-Commerce store owners, which I thought would be
                ideal customer profile, are not responding as expected (e.g.
                "why use this instead of a WhatsApp button?"). The value of
                branded links, round-robin, recording/transcription, lead
                capture, etc does not seem to matter much to them. Ideas are
                welcome.
              </p>
            </div>
          </section>
        </section>
        <section id="42135520">
          <h3>
            <a
              class="item"
              href="https://jan.miksovsky.com/posts/2024/11-12-momboard"
              >MomBoard: E-ink display for a parent with amnesia</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 12:20:40</span
              ><span class="points-container"
                >Points: <span class="points">1893</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42135520"
                  >Comments</a
                ><span class="descendants">: 234</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42116038">
          <h3>
            <a class="item" href="https://github.com/nimrag-b/emiT-C"
              >Emit-C: A time travelling programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-12 @ 15:10:25</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42116038"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42105752">
          <h3>
            <a
              class="item"
              href="https://physicsworld.com/a/four-wave-mixing-could-boost-optical-communications-in-space/"
              >Four-wave mixing could boost optical communications in space</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-11 @ 09:44:02</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42105752"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42102761">
          <h3>
            <a class="item" href="https://danyk.cz/digitrony_en.html"
              >Nixie Tubes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-10 @ 21:33:42</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42102761"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42100653">
          <h3>
            <a
              class="item"
              href="https://www.bleepingcomputer.com/news/security/hackers-now-use-zip-file-concatenation-to-evade-detection/"
              >Hackers use ZIP file concatenation to evade detection</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-10 @ 15:19:46</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42100653"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42099646">
          <h3>
            <a class="item" href="https://pokemontcgpocket.app"
              >Pokemon TCG Pocket Hub – Open-Source Multilingual Card Game
              Resource Platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-10 @ 11:27:49</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42099646"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42096107">
          <h3>
            <a
              class="item"
              href="https://americanhistory.si.edu/subs/anglesdangles/taming.html"
              >The Taming of the Screw</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-09 @ 18:46:37</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42096107"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42095134">
          <h3>
            <a
              class="item"
              href="https://www.cell.com/iscience/fulltext/S2589-0042(24)02416-7"
              >Chimpanzees' performance on computer tasks changes when people
              watching them</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-09 @ 16:08:35</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42095134"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
