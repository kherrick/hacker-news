<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45340251">
          <h3>
            <a class="item" href="https://review.thorntale.com/"
              >Show HN: Perfect your presentation with a panel of AI
              reviewers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 22:12:25</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45340251"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                We (Thorntale) are a startup building presentation tools, we
                noticed that while people disliked the tedium of making slide
                decks, a lot of people actively dread <i>presenting</i> those
                decks, especially if it's a high-stakes call or if they're
                inexperienced. Speaking from experience, practice helps a lot,
                but it can feel embarrassing to give the same pitch to your
                friend or cofounder for the tenth time.
              </p>
              <p>
                We built this prototype
                <a href="https://review.thorntale.com/"
                  >https://review.thorntale.com/</a
                >
                as a way to practice; upload a PDF deck, give your presentation,
                and the selected AI "personas" will analyze the slides and
                transcript and provide feedback. At the moment, we've tuned
                "personas" to give you feedback from the perspective of an
                investor, a teacher, or a marketing/branding lead (as well as a
                few entertaining extras.) If you have a particular use case,
                shoot us a comment, we're refining the persona system and
                planning what else to build there.
              </p>
              <p>
                The tool is totally free and doesn't require signup or login;
                we'd love any feedback if you check it out!
              </p>
              <p>
                <a href="https://review.thorntale.com/"
                  >https://review.thorntale.com/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="45340133">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2509.06917"
              >Paper2Agent: Stanford Reimagining Research Papers as Interactive
              AI Agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 22:02:01</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45340133"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45338625">
          <h3>
            <a
              class="item"
              href="https://rohany.github.io/blog/warp-specialization/"
              >Unweaving warp specialization on modern tensor core GPUs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 19:53:42</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45338625"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45337450">
          <h3>
            <a
              class="item"
              href="https://www.filfre.net/2025/09/choose-your-own-adventure/"
              >Choose Your Own Adventure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 18:22:53</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45337450"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45337433">
          <h3>
            <a
              class="item"
              href="https://blog.ml.cmu.edu/2025/09/22/diffusion-beats-autoregressive-in-data-constrained-settings/"
              >Diffusion Beats Autoregressive in Data-Constrained Settings</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 18:21:29</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45337433"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45337400">
          <h3>
            <a
              class="item"
              href="https://www.pavlinbg.com/posts/python-speech-to-text-guide"
              >Show HN: Python Audio Transcription: Convert Speech to Text
              Locally</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 18:18:56</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45337400"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45337253">
          <h3>
            <a
              class="item"
              href="https://hbr.org/2025/09/ai-generated-workslop-is-destroying-productivity"
              >AI-generated “workslop” is destroying productivity?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 18:07:13</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45337253"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45336989">
          <h3>
            <a class="item" href="https://github.com/QwenLM/Qwen3-Omni"
              >Qwen3-Omni: Native Omni AI model for text, image and video</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 17:50:21</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45336989"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45336282">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45336282"
              >Mentra (YC W25) is hiring to build smart glasses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 17:01:04</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                This year we launched MentraOS, graduated Y Combinator, and
                raised an $8M seed round to bring smart glasses software and
                hardware to market.
              </p>
              <p>
                We're a small team (~11 people) shipping thousands of our first
                pair of smart glasses in December.
              </p>
              <p>
                We need help in engineering (build smart glasses), design
                (design glasses interfaces), and growth (make glasses go viral).
              </p>
              <p>
                Apply on the job board or if you don't see a fitting role, email
                me cayden@mentra.glass
              </p>
            </div>
          </section>
        </section>
        <section id="45335635">
          <h3>
            <a
              class="item"
              href="https://nedbatchelder.com/blog/202509/testing_is_better_than_dsa.html"
              >Testing is better than data structures and algorithms</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 16:21:35</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45335635"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45335474">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/openai-nvidia-systems-partnership/"
              >OpenAI and Nvidia announce partnership to deploy 10GW of Nvidia
              systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 16:10:15</span
              ><span class="points-container"
                >Points: <span class="points">352</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45335474"
                  >Comments</a
                ><span class="descendants">: 474</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45335452">
          <h3>
            <a class="item" href="https://github.com/scaleapi/SWE-bench_Pro-os"
              >SWE-Bench Pro</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 16:08:57</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45335452"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45334545">
          <h3>
            <a
              class="item"
              href="https://planetscale.com/blog/planetscale-for-postgres-is-generally-available"
              >PlanetScale for Postgres is now GA</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 15:10:48</span
              ><span class="points-container"
                >Points: <span class="points">240</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45334545"
                  >Comments</a
                ><span class="descendants">: 137</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45334250">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/a-simple-way-to-measure-knots-has-come-unraveled-20250922/"
              >A simple way to measure knots has come unraveled</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 14:49:16</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45334250"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45333978">
          <h3>
            <a
              class="item"
              href="https://interjectedfuture.com/what-is-algebraic-about-algebraic-effects/"
              >What is algebraic about algebraic effects?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 14:30:10</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45333978"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45333021">
          <h3>
            <a
              class="item"
              href="https://marcobambini.substack.com/p/why-local-first-apps-havent-become"
              >Why haven't local-first apps become popular?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 13:17:59</span
              ><span class="points-container"
                >Points: <span class="points">234</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45333021"
                  >Comments</a
                ><span class="descendants">: 255</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45332883">
          <h3>
            <a
              class="item"
              href="https://blog.cloudflare.com/capnweb-javascript-rpc-library/"
              >Cap'n Web: a new RPC system for browsers and web servers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 13:05:32</span
              ><span class="points-container"
                >Points: <span class="points">313</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45332883"
                  >Comments</a
                ><span class="descendants">: 154</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45332860">
          <h3>
            <a
              class="item"
              href="https://blog.cloudflare.com/supporting-the-future-of-the-open-web/"
              >Cloudflare is sponsoring Ladybird and Omarchy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 13:03:33</span
              ><span class="points-container"
                >Points: <span class="points">565</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45332860"
                  >Comments</a
                ><span class="descendants">: 358</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45332859">
          <h3>
            <a
              class="item"
              href="https://simonhartcher.com/posts/2025-09-22-why-im-spoiled-by-apple-silicon-but-still-love-framework/"
              >I'm spoiled by Apple Silicon but still love Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 13:03:10</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45332859"
                  >Comments</a
                ><span class="descendants">: 185</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45332814">
          <h3>
            <a
              class="item"
              href="https://quesma.com/blog/introducing-compilebench/"
              >CompileBench: Can AI Compile 22-year-old Code?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 12:59:30</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45332814"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45332196">
          <h3>
            <a
              class="item"
              href="https://blog.jgc.org/2025/09/is-movie-prop-ultimate-laptop-bag.html"
              >Is a movie prop the ultimate laptop bag?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 11:59:01</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45332196"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45332130">
          <h3>
            <a class="item" href="https://skilldrick.github.io/easyforth/"
              >Easy Forth (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 11:52:41</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45332130"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45331030">
          <h3>
            <a class="item" href="https://hsu.cy/2025/09/how-to-read-hn/"
              >Beyond the Front Page: A Personal Guide to Hacker News</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 09:37:12</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45331030"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45330407">
          <h3>
            <a class="item" href="https://github.com/sgi-demos"
              >SGI demos from long ago in the browser via WASM</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 08:03:59</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45330407"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45329310">
          <h3>
            <a
              class="item"
              href="https://research.colfax-intl.com/categorical-foundations-for-cute-layouts/"
              >Categorical Foundations for Cute Layouts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 05:16:32</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45329310"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45325792">
          <h3>
            <a
              class="item"
              href="https://apiguy.substack.com/p/a-board-members-perspective-of-the"
              >A board member's perspective of the RubyGems controversy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-21 @ 19:20:23</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45325792"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45325208">
          <h3>
            <a class="item" href="https://dspace.mit.edu/handle/1721.1/162684"
              >Transforming recursion into iteration for LLVM loop
              optimizations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-21 @ 18:13:09</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45325208"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://dspace.mit.edu/bitstream/handle/1721.1/162684/cuevas-eliec-meng-eecs-2025-thesis.pdf?sequence=1&amp;isAllowed=y"
                >https://dspace.mit.edu/bitstream/handle/1721.1/162684/cuevas...</a
              >
            </div>
          </section>
        </section>
        <section id="45323027">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2503.05136"
              >The Beginner's Textbook for Fully Homomorphic Encryption</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-21 @ 14:26:10</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45323027"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
            <div class="text">
              <a href="https://fhetextbook.github.io/"
                >https://fhetextbook.github.io/</a
              >
            </div>
          </section>
        </section>
        <section id="45322030">
          <h3>
            <a
              class="item"
              href="https://martinalderson.com/posts/what-happens-when-coding-agents-stop-feeling-like-dialup/"
              >What happens when coding agents stop feeling like dialup?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-21 @ 12:11:18</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45322030"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45302073">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/features/2025-09-19/multimillion-dollar-hacking-spree-scattered-spider-teen-s-jailhouse-confessions"
              >Jailhouse confessions of a teen hacker</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-19 @ 14:29:23</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45302073"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <a href="https://archive.is/sMrZA">https://archive.is/sMrZA</a>
            </div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
