<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44158658">
          <h3>
            <a
              class="item"
              href="https://www.omgubuntu.co.uk/2025/05/linux-format-magazine-closes"
              >After 25 Years, Linux Format Magazine Is No More</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 13:29:26</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44158658"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44158353">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44158353"
              >How do I learn robotics in 2025?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 12:58:10</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44158353"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              i wish to make something. it should be more accessible than ever
              and the next thing but only the tech giants seem to capture most
              of the conversation.
            </div>
          </section>
        </section>
        <section id="44157701">
          <h3>
            <a
              class="item"
              href="https://shkspr.mobi/blog/2025/05/whatever-happened-to-cheap-ereaders/"
              >Whatever happened to cheap eReaders?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 11:28:28</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44157701"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44157618">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2505.24650"
              >Beyond the Black Box: Interpretability of LLMs in Finance</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 11:16:06</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44157618"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44157584">
          <h3>
            <a
              class="item"
              href="https://github.com/DmitriBogdanov/UTL/blob/master/docs/module_random.md"
              >Show HN: Fast Random Library for C++17</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 11:09:45</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44157584"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <p>
                Random number generation feels is a somewhat underrepresented
                topic in the C++ realm. There is a lot of questionable info
                about it found online and even the standard library is quite
                behind the times in terms of it's algorithms. It suffers from
                trying to accommodate sometimes impractical standard
                requirements and has several ways of getting significantly bad
                statistical results. This leaves a lot easily achievable
                performance &amp; quality on the table.
              </p>
              <p>
                So, being a mathematician who mostly works with stochastic
                models and wants these models to run fast and well, I embarked
                on a journey of trying to summarize "what is good and what is
                bad" and implement the "best stuff there currently is".
              </p>
              <p>
                Thankfully, the design of C++ &lt;random&gt; is quite flexible
                and easy to extend. With some cleanup, generalization and
                compile-time logic all the different algorithms can be wrapped
                in a generic standard-compatible API.
              </p>
              <p>
                A result of this work is single-header RNG library which has:
              </p>
              <p></p>
              <pre><code>  - &lt;random&gt;-compatible generators (PRNGSs) with 3x-6x better performance
  - Cryptographically secure generators (CSPRNGs)
  - Faster uniform / normal distributions that produce same sequences on every platform
  - Quick approximations of some non-linear distributions
  - More reliable entropy sources that std::random_device()
  - rand()-like API for when we just want random numbers without the boilerplate of proper a &lt;random&gt; setup
</code></pre>
              Effectively all of this gets us 2x-8x speedups on many workloads
              while producing even better statistical quality.
              <p>
                Don't think there is anything else like it, so I would like to
                showcase the result here and hear some opinions on its
                improvement:
              </p>
              <p>
                <a
                  href="https://github.com/DmitriBogdanov/UTL/blob/master/docs/module_random.md"
                  >https://github.com/DmitriBogdanov/UTL/blob/master/docs/modul...</a
                >
              </p>
              <p>
                For those interested, there is a more detailed rundown of all
                the quirks of this topic at end of the docs, might prove an
                interesting read.
              </p>
            </div>
          </section>
        </section>
        <section id="44157378">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2411.00782"
              >TradeExpert, a trading framework that employs a mix of experts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 10:25:51</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44157378"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44157177">
          <h3>
            <a class="item" href="https://github.com/kanbn/kan"
              >Show HN: Kan.bn – An open-source alterative to Trello</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 09:47:48</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44157177"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44157077">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2505.24760"
              >ReasoningGym: Reasoning Environments for RL with Verifiable
              Rewards</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 09:27:26</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44157077"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44156935">
          <h3>
            <a
              class="item"
              href="https://betterthanrandom.substack.com/p/if-you-are-useful-it-doesnt-mean"
              >If you are useful, it doesn't mean you are valued</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 08:59:37</span
              ><span class="points-container"
                >Points: <span class="points">454</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44156935"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44155761">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2025/06/09/the-phoenician-scheme-movie-review"
              >Is “The Phoenician Scheme” Wes Anderson's Most Emotional Film?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 04:05:26</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44155761"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44155746">
          <h3>
            <a
              class="item"
              href="https://www.jeetmehta.com/posts/thrive-in-obscurity"
              >How to post when no one is reading</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 04:01:00</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44155746"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44155741">
          <h3>
            <a class="item" href="https://github.com/MubarakNative/MBCompass"
              >Show HN: MBCompass – Android Compass App</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 03:58:58</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44155741"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built MBCompass, a lightweight, privacy-friendly compass app
                for Android. It works fully offline, doesn’t ask for unnecessary
                permissions (no GPS, no internet), and is open source.
              </p>
              <p>
                Most compass apps out there are bloated or ad-heavy. I wanted
                something clean, fast, and featurish. So I made this!
              </p>
              <p>
                It’s only ~1.7 in size and uses a low-pass filter to smooth
                sensor readings.
              </p>
              <p>
                I’d love feedback or thoughts – especially from others building
                simple, privacy-first apps!
              </p>
              <p>
                <a href="https://f-droid.org/packages/com.mubarak.mbcompass/"
                  >https://f-droid.org/packages/com.mubarak.mbcompass/</a
                >
              </p>
              <p>
                <a href="https://github.com/MubarakNative/MBCompass"
                  >https://github.com/MubarakNative/MBCompass</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44155635">
          <h3>
            <a class="item" href="https://github.com/howerj/lfsr-vhdl"
              >LFSR CPU Running Forth</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 03:35:07</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44155635"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44155247">
          <h3>
            <a
              class="item"
              href="https://esoteric.codes/blog/published-for-the-first-time-the-original-intercal72-compiler-code"
              >The Princeton INTERCAL Compiler's source code</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 01:54:33</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44155247"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44155069">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2505.22610"
              >TPDE: A Fast Adaptable Compiler Back-End Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-02 @ 01:17:54</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44155069"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44154032">
          <h3>
            <a
              class="item"
              href="https://animationobsessive.substack.com/p/the-visual-world-of-samurai-jack"
              >The Visual World of 'Samurai Jack'</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-01 @ 21:57:35</span
              ><span class="points-container"
                >Points: <span class="points">420</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44154032"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44153738">
          <h3><a class="item" href="https://librivox.org/">LibriVox</a></h3>
          <section>
            <h4>
              <span>2025-06-01 @ 21:02:58</span
              ><span class="points-container"
                >Points: <span class="points">208</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44153738"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44153732">
          <h3>
            <a
              class="item"
              href="https://notsocommonthoughts.com/blog/ai-and-judgement/"
              >The rise of judgement over technical skill</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-01 @ 21:02:17</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44153732"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44149718">
          <h3>
            <a
              class="item"
              href="https://www.pushing-pixels.org/2025/05/20/cinematography-of-andor-interview-with-christophe-nuyens.html"
              >Cinematography of “Andor”</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-01 @ 09:44:04</span
              ><span class="points-container"
                >Points: <span class="points">409</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44149718"
                  >Comments</a
                ><span class="descendants">: 371</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44144240">
          <h3>
            <a
              class="item"
              href="https://inferencemagazine.substack.com/p/bohemians-at-the-gate"
              >Bohemians at the Gate?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-31 @ 13:41:44</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44144240"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44143253">
          <h3>
            <a class="item" href="https://github.com/words/cuss"
              >Cuss: Map of profane words to a rating of sureness</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-31 @ 10:18:40</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44143253"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44142955">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/unix/POSIXAllowsZeroInode"
              >In POSIX, you can theoretically use inode zero</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-31 @ 08:57:12</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44142955"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44142650">
          <h3>
            <a class="item" href="https://github.com/ROCm/hip"
              >Hip: C++ Heterogeneous-Compute Interface for Portability</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-31 @ 07:37:21</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44142650"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44142359">
          <h3>
            <a
              class="item"
              href="https://nibblestew.blogspot.com/2025/05/writing-your-own-c-standard-library.html"
              >Writing your own C++ standard library part 2</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-31 @ 06:46:41</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44142359"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44142259">
          <h3>
            <a
              class="item"
              href="https://milofultz.com/2025-05-27-i-made-a-chair.html"
              >I made a chair</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-31 @ 06:24:01</span
              ><span class="points-container"
                >Points: <span class="points">229</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44142259"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44131324">
          <h3>
            <a
              class="item"
              href="https://www.galois.com/articles/what-works-and-doesnt-selling-formal-methods"
              >What works (and doesn't) selling formal methods</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-29 @ 23:21:48</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44131324"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44130915">
          <h3>
            <a
              class="item"
              href="https://whatisnuclear.com/the-story-of-the-atomic-airplane.html"
              >The Atomic Airplane</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-29 @ 22:16:18</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44130915"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44129480">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/global/2019/apr/21/why-did-the-chicken-cross-the-globe-french-sailor-guirec-soudee-monique"
              >A man who sailed round the world with a chicken (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-29 @ 19:38:09</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44129480"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44125793">
          <h3>
            <a class="item" href="https://www.heidisql.com/forum.php?t=44068"
              >HeidiSQL Available Also for Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-29 @ 13:16:00</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44125793"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44125334">
          <h3>
            <a class="item" href="https://easytier.cn/en/"
              >EasyTier – P2P mesh VPN written in Rust using Tokio</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-29 @ 12:25:19</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44125334"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
