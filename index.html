<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35886559">
          <h3>
            <a class="item" href="https://io.google/2023/">Google I/O 2023</a>
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 12:49:06</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35886559"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35886288">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35886288"
              >We should start to add ‚Äúai.txt‚Äù as we do for ‚Äúrobots.txt‚Äù</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 12:20:05</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35886288"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              <p>
                It can be great if the website somehow ends up in a training
                dataset (who knows), and it can be super helpful for AI website
                crawlers, instead of using thousands of tokens to know what your
                website is about, they can do it with just a few hundred.
              </p>
            </div>
          </section>
        </section>
        <section id="35886103">
          <h3>
            <a class="item" href="https://github.com/DNedic/lockfree"
              >A collection of lock-free data structures written in standard
              C++11</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 11:56:14</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35886103"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35886033">
          <h3>
            <a class="item" href="https://trygalaxy.com/"
              >Try Galaxy: A web app to demo Samsung‚Äôs OS on an iPhone</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 11:42:18</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35886033"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885999">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2023-05-10/nearshoring-push-fuels-tech-job-demand-in-latin-america"
              >‚ÄòNearshoring‚Äô Push Is Fueling Tech Job Demand in Latin America</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 11:37:04</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885999"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885797">
          <h3>
            <a
              class="item"
              href="https://mazzzystar.github.io/2023/05/10/LLM-for-individual/"
              >The Leverage of LLMs for Individuals</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 11:01:25</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885797"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885638">
          <h3>
            <a
              class="item"
              href="https://www.indiewire.com/features/general/how-much-does-it-cost-to-run-movie-theater-1234859340/"
              >Running a Movie Theater Is More Expensive Than You Can Possibly
              Imagine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 10:28:39</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885638"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885342">
          <h3>
            <a
              class="item"
              href="https://www.teamblind.com/post/My-friends-who-cheated-in-interviews-are-getting-promoted-üò°üò°üò°üò°-XnYM4nLs"
              >My friends who cheated in interviews are getting promoted
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 09:26:31</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885342"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885066">
          <h3>
            <a class="item" href="https://github.com/ipyflow/ipyflow"
              >IPyflow: Reactive Python Notebooks in Jupyter(Lab)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 08:30:03</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885066"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885004">
          <h3>
            <a
              class="item"
              href="https://www.cs.cmu.edu/afs/cs/academic/class/15740-f18/www/papers/hpca01-jiminez-perceptron.pdf"
              >Dynamic Branch Prediction with Perceptrons [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 08:20:46</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885004"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35884668">
          <h3>
            <a
              class="item"
              href="https://blog.koehntopp.info/2023/05/06/50-years-in-filesystems-1984.html"
              >50 years in filesystems: 1984 BSD FFS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 07:23:23</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35884668"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35884437">
          <h3>
            <a class="item" href="https://subtls.pages.dev/"
              >See this page fetch itself, byte by byte, over TLS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 06:51:33</span
              ><span class="points-container"
                >Points: <span class="points">626</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35884437"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35884272">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/collection/punctuation-personified"
              >Punctuation Personified (1824)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 06:22:49</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35884272"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35884176">
          <h3>
            <a
              class="item"
              href="https://julialang.org/blog/2023/04/julia-1.9-highlights/"
              >Julia 1.9</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 06:05:44</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35884176"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35883891">
          <h3>
            <a class="item" href="https://compute.toys/"
              >An experimental editor for WebGPU compute shaders</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 05:15:50</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35883891"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35882985">
          <h3>
            <a
              class="item"
              href="https://github.com/wqweto/VbAsyncSocket/blob/master/src/mdTlsThunks.bas"
              >A TLS 1.3 stack written in Visual Basic 6</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 02:34:52</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35882985"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35882967">
          <h3>
            <a class="item" href="https://github.com/antirez/freakwan"
              >Freakwan: A MicroPython driver for the SX1276 LoRa chip</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 02:31:59</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35882967"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35882735">
          <h3>
            <a class="item" href="http://kylerank.in/tempus_nectit/"
              >Tempus Nectit Knitting Clock</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 02:00:06</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35882735"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35881963">
          <h3>
            <a class="item" href="https://livefir.fly.dev/"
              >Show HN: Build progressively enhanced reactive HTML apps using Go
              and Alpine.js</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 00:03:52</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35881963"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
            <div class="text">
              <p>
                The Fir toolkit is designed for Go developers with moderate
                html/css &amp; js skills who want to progressively build
                reactive web apps without mastering complex web frameworks. It
                includes a Go library and an Alpine.js plugin.
              </p>
              <p>How it works ?</p>
              <p>
                On receiving user-interactions the fir server re-renders html
                templates and sends it over the wire where the fir client
                library selectively updates the changed areas.
              </p>
              <p>
                When a user event is received by a Fir route, an array of html
                templates are rendered on the server and returned as an array of
                DOM events to the browser. The DOM events are consumed by the
                alpinejs plugin and dispatched within the DOM where listeners
                attached to elements can use the event to update the DOM.
              </p>
              <p>
                See the demo and quickstart here:
                <a href="https://livefir.fly.dev/">https://livefir.fly.dev/</a>
              </p>
            </div>
          </section>
        </section>
        <section id="35881520">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/linux/FlockFcntlAndNFS"
              >File Locks on Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 23:06:48</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35881520"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35881170">
          <h3>
            <a
              class="item"
              href="https://urbanists.social/@sam/110339902538138997"
              >The AT protocol is the most obtuse crock of shit</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 22:28:44</span
              ><span class="points-container"
                >Points: <span class="points">307</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35881170"
                  >Comments</a
                ><span class="descendants">: 312</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35880997">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/arts-culture/these-intimate-photos-capture-a-family-farms-bittersweet-final-years-180982139/"
              >The last days of a 350-year-old family farm</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 22:08:13</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35880997"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35880517">
          <h3>
            <a
              class="item"
              href="https://eli.thegreenplace.net/2023/twenty-years-of-blogging/"
              >Twenty years of blogging</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 21:18:51</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35880517"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35880345">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35880345"
              >Aptible (YC S14) Is Hiring: Security Engineer and Head of
              Product</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 21:02:06</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                <a href="https://www.aptible.com/culture-hub/careers"
                  >https://www.aptible.com/culture-hub/careers</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="35879660">
          <h3>
            <a class="item" href="https://seclists.org/oss-sec/2023/q2/133"
              >Linux kernel use-after-free in Netfilter, local privilege
              escalation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 20:02:15</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35879660"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35877402">
          <h3>
            <a
              class="item"
              href="https://openai.com/research/language-models-can-explain-neurons-in-language-models"
              >Language models can explain neurons in language models</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 17:15:04</span
              ><span class="points-container"
                >Points: <span class="points">644</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35877402"
                  >Comments</a
                ><span class="descendants">: 406</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35876635">
          <h3>
            <a
              class="item"
              href="https://observablehq.com/@cmoog/polya-urn-simulation"
              >Polya Urn Simulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 16:18:56</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35876635"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35876466">
          <h3>
            <a
              class="item"
              href="https://ethz.ch/en/news-and-events/eth-news/news/2023/05/detailed-image-of-the-human-retina.html"
              >Detailed Image of the Human Retina</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 16:07:12</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35876466"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35875736">
          <h3>
            <a
              class="item"
              href="https://www.newscientist.com/article/2371594-mechanical-backpack-boosts-the-sensation-of-jumping-in-virtual-reality/"
              >Mechanical backpack boosts the sensation of jumping in virtual
              reality</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 15:22:24</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35875736"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35873686">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Darvaza_gas_crater"
              >Darvaza Gas Crater</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-09 @ 12:59:39</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35873686"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
