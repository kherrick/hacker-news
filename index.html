<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44220860">
          <h3>
            <a
              class="item"
              href="https://blog.freespeechextremist.com/blog/fse-vs-fbi.html"
              >Using Awk to find out the FBI was paying scrapers to find
              Torswats</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-09 @ 01:59:27</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44220860"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44220583">
          <h3>
            <a class="item" href="https://ipv4a-5539ad.gitlab.io/"
              >Analyzing IPv4 Trades with Gnuplot</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-09 @ 01:08:00</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44220583"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44220287">
          <h3>
            <a
              class="item"
              href="https://www.bramadams.dev/software-is-about-promises/"
              >Software Is About Promises</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-09 @ 00:04:28</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44220287"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44220179">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/travel/2025/jun/09/riding-high-in-germany-on-the-worlds-oldest-suspended-railway"
              >Riding high in Germany on the world's oldest suspended railway</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 23:38:58</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44220179"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44220135">
          <h3>
            <a
              class="item"
              href="https://lifehacker.com/health/ai-powered-calorie-counting-apps-worse-than-expected"
              >I used AI-powered calorie counting apps, and they were even worse
              than expected</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 23:25:41</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44220135"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44219857">
          <h3>
            <a class="item" href="https://ziglang.org/devlog/2025/#2025-06-08"
              >Zig Devlog: Self-Hosted x86 Back End Is Now Default in Debug
              Mode</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 22:24:14</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44219857"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44219755">
          <h3>
            <a
              class="item"
              href="https://www.cyberark.com/resources/threat-research-blog/poison-everywhere-no-output-from-your-mcp-server-is-safe"
              >Poison everywhere: No output from your MCP server is safe</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 22:00:12</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44219755"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44219519">
          <h3>
            <a
              class="item"
              href="https://helentoner.substack.com/p/supercomputers-for-autocrats"
              >Building supercomputers for autocrats probably isn't good for
              democracy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 21:11:18</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44219519"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44219405">
          <h3>
            <a
              class="item"
              href="https://jordemort.dev/blog/why-android-cant-use-cdc-ethernet/"
              >Why Android can't use CDC Ethernet (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 20:49:07</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44219405"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44219357">
          <h3>
            <a class="item" href="https://computer.rip/2025-06-08-Omnimax.html"
              >Omnimax</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 20:41:35</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44219357"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44219270">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/eruv-manhattan-invisible-wire-jewish-symbolic-religious-home"
              >The wire that transforms much of Manhattan into one big, symbolic
              home</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 20:22:33</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44219270"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44217876">
          <h3>
            <a
              class="item"
              href="https://www.owlposting.com/p/the-time-of-day-that-immunotherapy"
              >Administering immunotherapy in the morning seems to matter.
              Why?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 16:18:32</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44217876"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44217757">
          <h3>
            <a class="item" href="https://letsbend.de"
              >Show HN: Let’s Bend – Open-Source Harmonica Bending Trainer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 16:00:22</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44217757"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built a simple harmonica practice app that shows real-time
                pitch and bending targets for each hole. It helps blues harp
                players visualize their technique and improve intonation.
              </p>
              <p>No tracking, no ads, open source (MIT).</p>
              <p>
                The app is available on F-Droid and GitHub. You can find more
                details here:
                <a href="https://letsbend.de">https://letsbend.de</a>
              </p>
              <p>Feedback welcome!</p>
            </div>
          </section>
        </section>
        <section id="44217322">
          <h3>
            <a
              class="item"
              href="http://testou.free.fr/www.beatjapan.org/mirror/www.be.com/support/guides/hitachi_boot.html"
              >Launching the BeOS on Hitachi Flora Prius Systems (1999)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 14:46:21</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44217322"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44216630">
          <h3>
            <a
              class="item"
              href="https://www.netfort.gr.jp/~dancer/software/binfmtc.html.en"
              >Binfmtc – binfmt_misc C scripting interface</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 12:38:55</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44216630"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44215603">
          <h3>
            <a
              class="item"
              href="https://rohangautam.github.io/blog/chebyshev_gauss/"
              >Gaussian integration is cool</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 08:35:54</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44215603"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44215352">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/Jun/6/six-months-in-llms/"
              >The last six months in LLMs, illustrated by pelicans on
              bicycles</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 07:38:37</span
              ><span class="points-container"
                >Points: <span class="points">752</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44215352"
                  >Comments</a
                ><span class="descendants">: 188</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44215197">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/pc-components/storage/the-faa-seeks-to-eliminate-floppy-disk-usage-in-air-traffic-control-systems"
              >FAA to eliminate floppy disks used in air traffic control
              systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 07:11:34</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44215197"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44214522">
          <h3>
            <a
              class="item"
              href="https://danq.me/2020/11/11/blink-and-marquee/"
            >
              and (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-08 @ 04:17:43</span
              ><span class="points-container"
                >Points: <span class="points">206</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44214522"
                  >Comments</a
                ><span class="descendants">: 160</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44212441">
          <h3>
            <a
              class="item"
              href="https://www.folklore.org/Joining_Apple_Computer.html"
              >Joining Apple Computer (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-07 @ 20:32:54</span
              ><span class="points-container"
                >Points: <span class="points">399</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44212441"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44211273">
          <h3>
            <a
              class="item"
              href="https://www.ssp.sh/blog/self-host-self-independence/"
              >Self-Host and Tech Independence: The Joy of Building Your Own</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-07 @ 17:51:51</span
              ><span class="points-container"
                >Points: <span class="points">428</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44211273"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44197347">
          <h3>
            <a
              class="item"
              href="https://www.informationga.in/blog/building-an-ai-server-on-a-budget"
              >Building an AI server on a budget</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-06 @ 02:33:16</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44197347"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44189966">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41467-025-60001-2"
              >Efficient mRNA delivery to resting T cells to reverse HIV
              latency</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-05 @ 09:37:09</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44189966"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44189391">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44189391"
              >How to get started with writing tech video essays</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-05 @ 07:53:14</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44189391"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              I am thinking about starting my own YouTube channel that focuses
              on video essays on software technology like languages or software
              tools. For example an essay on the computer terminal. For all of
              you who have tech YouTube channels how do I set up for good
              content material and make my videos interesting and where can I
              find royalty free music and clips.
            </div>
          </section>
        </section>
        <section id="44189088">
          <h3>
            <a
              class="item"
              href="https://tunahansalih.github.io/blog/autoregressive-vision-generation-part-1/"
              >Generating Pixels One by One</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-05 @ 06:59:19</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44189088"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44188839">
          <h3>
            <a class="item" href="https://aavetis.github.io/ai-pr-watcher/"
              >Tracking Copilot vs. Codex vs. Cursor vs. Devin PR Performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-05 @ 06:22:09</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44188839"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44188373">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/apple/2025/06/new-filament-lets-you-3d-print-parts-in-authentic-1980s-apple-computer-color/"
              >Endangered classic Mac plastic color returns as 3D-printer
              filament</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-05 @ 04:44:37</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44188373"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44187765">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20250603-the-giant-firework-built-to-break-hitlers-atlantic-wall"
              >Panjandrum: The 'giant firework' built to break Hitler's Atlantic
              Wall</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-05 @ 02:21:28</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44187765"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44186008">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-06-cheap-ultrapure-titanium-metal-enable.amp"
              >Cheap yet ultrapure titanium might enable widespread use in
              industry (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-04 @ 22:00:38</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44186008"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44183299">
          <h3>
            <a
              class="item"
              href="https://xania.org/202506/how-compiler-explorer-works"
              >How Compiler Explorer Works in 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-04 @ 17:32:34</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44183299"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
