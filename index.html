<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41841366">
          <h3>
            <a class="item" href="https://www.greptile.com/blog/how-we-engineer"
              >Splitting engineering teams into defense and offense</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 20:07:27</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41841366"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840971">
          <h3>
            <a
              class="item"
              href="https://www.ifixit.com/News/101675/bike-manufacturers-are-making-bikes-less-repairable"
              >Bike Manufacturers Are Making Bikes Less Repairable</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 19:27:03</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840971"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840931">
          <h3>
            <a class="item" href="https://how-i-experience-web-today.com"
              >How I Experience Web Today (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 19:22:53</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840931"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840872">
          <h3>
            <a
              class="item"
              href="https://play.ht/news/introducing-play-3-0-mini/"
              >Play 3.0 mini – A lightweight, reliable, cost-efficient
              Multilingual TTS model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 19:16:17</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840872"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840769">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/business/energy-oil/google-nuclear-power-artificial-intelligence-87966624"
              >Google Funding Construction of Seven U.S. Nuclear Reactors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 19:06:22</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840769"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840655">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/artificial-intelligence/adobe-starts-roll-out-ai-video-tools-challenging-openai-meta-2024-10-14/"
              >Adobe starts roll-out of AI video tools, challenging OpenAI and
              Meta</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 18:55:44</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840655"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840390">
          <h3>
            <a class="item" href="https://jsomers.net/blog/gettiers"
              >The three-page paper that shook philosophy: Gettiers in software
              engineering</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 18:28:54</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840390"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840323">
          <h3>
            <a class="item" href="https://bolt.new/"
              >Show HN: Bolt.new – dev sandbox with AI from StackBlitz</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 18:21:40</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840323"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840023">
          <h3>
            <a
              class="item"
              href="https://medicalxpress.com/news/2024-10-commonly-arm-positions-substantially-overestimate.html"
              >Commonly used arm positions can overestimate blood pressure
              readings: study</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:57:00</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840023"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839994">
          <h3>
            <a class="item" href="https://github.com/payloadcms/payload"
              >PayloadCMS: Open-Source, Fullstack Next.js Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:55:13</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839994"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839776">
          <h3>
            <a
              class="item"
              href="https://coldwaters.substack.com/p/scale-ruins-everything"
              >Scale Ruins Everything</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:34:38</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839776"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839773">
          <h3>
            <a class="item" href="https://github.com/spiraldb/vortex"
              >Show HN: Vortex – a high-performance columnar file format in
              Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:34:26</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839773"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839766">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2410.08261"
              >Meissonic, High-Resolution Text-to-Image Synthesis on consumer
              graphics cards</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:33:51</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839766"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839719">
          <h3>
            <a
              class="item"
              href="https://mathspp.com/blog/teaching-the-worlds-largest-programming-lesson"
              >Teaching the Largest Programming Lesson</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:28:20</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839719"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41838589">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2405.14333"
              >DeepSeek: Advancing theorem proving in LLMs through large-scale
              synthetic data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 15:44:04</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41838589"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41838420">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=lQToTWKwtuw"
              >NASA's Europa Clipper Launch</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 15:28:33</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41838420"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41838337">
          <h3>
            <a class="item" href="https://busy.bar/?hn">Busy Status Bar</a>
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 15:19:12</span
              ><span class="points-container"
                >Points: <span class="points">605</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41838337"
                  >Comments</a
                ><span class="descendants">: 200</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41837204">
          <h3>
            <a class="item" href="https://github.com/splitbrain/clipscreen"
              >Show HN: X11 tool to share a screen area in any video meeting</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 13:11:56</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41837204"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41836903">
          <h3>
            <a class="item" href="http://www.technoblogy.com/show?4MGW"
              >Sound Lab – A Simple Analogue Synthesiser</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 12:31:26</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41836903"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41835040">
          <h3>
            <a class="item" href="https://github.com/gosub-io/gosub-engine"
              >Gosub – An open-source browser engine built in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 07:17:00</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41835040"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
            <div class="text">
              <p>
                Today, we're excited to introduce Gosub, a new open-source
                browser engine that we are building from the ground up in Rust!
              </p>
              <p>
                Gosub aims to be a modern, modular, and highly flexible browser
                engine. While still in the early development and experimentation
                phase, Gosub is shaping up nicely, and we’re looking to onboard
                more contributors to help us bring this project to life.
              </p>
              <p>Some of the key highlights:</p>
              <p></p>
              <pre><code>  * Written in Rust: We're leveraging Rust's safety and performance features to create a robust and efficient engine.
  * Modular Design: The project is organized around modules, allowing for clean separation of concerns and easier collaboration. It also allows us to easily swap components based on needs and allows more freedom for engine implementers in the future.
  * Collaborative and open source: We’re building Gosub with the intention of making it approachable and open to contributions, aiming to create a project that's easier to understand and collaborate on compared to existing browsers.
</code></pre>
              Instead of writing another shell around Chromium or WebKit, we
              decided to write a browser engine from scratch. We believe that
              having a diverse landscape of engines is the only way to defeat a
              monoculture that is currently threatening current browsers and by
              extension the internet itself. We cannot and should not let a very
              small number of large companies dictate the future of the web and
              its usage.
              <p>
                With Gosub, we're aiming to build something more approachable
                that can evolve with the latest web technologies, all while
                being open to contributors from day one.
              </p>
              <p>
                We’re looking for developers with or without experience in Rust.
                You just need to be interested in browser technologies. There
                are plenty of opportunities to work on core modules, document
                our progress, and help shape the project's direction.
              </p>
              <p>
                We can already render simple pages, including the hackernews
                front page. However, to render most sites correctly, it is still
                a long journey, so come and join us!
              </p>
            </div>
          </section>
        </section>
        <section id="41834548">
          <h3>
            <a
              class="item"
              href="https://blog.scottlogic.com/2021/09/14/120-years-timezone.html"
              >Exploring 120 years of timezones (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 05:44:17</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41834548"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41824990">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Larkin_Company"
              >The Larkin Soap Company</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-13 @ 03:41:34</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41824990"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41818676">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2024/10/11/style/europe-railroad-dining-cars-wagons-lits/index.html"
              >When railroad dining cars were the height of luxury</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-12 @ 12:46:55</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41818676"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41818620">
          <h3>
            <a
              class="item"
              href="https://www.cell.com/cancer-cell/pdf/S1535-6108(02)00133-2.pdf"
              >Can a biologist fix a radio? What I learned while studying
              apoptosis (2002) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-12 @ 12:34:55</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41818620"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41818609">
          <h3>
            <a class="item" href="https://www.kv4p.com/"
              >Turn your Android phone into a modern ham radio transceiver</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-12 @ 12:32:29</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41818609"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41816035">
          <h3>
            <a class="item" href="https://wescook.art">The Wes Cook Archive</a>
          </h3>
          <section>
            <h4>
              <span>2024-10-12 @ 03:00:17</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41816035"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41813471">
          <h3>
            <a
              class="item"
              href="https://www.bentasker.co.uk/posts/blog/house-stuff/using-graphene-infrared-heater-art-in-the-sitting-room.html"
              >Trying Out a Far Infrared Heated Poster</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-11 @ 20:37:09</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41813471"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41812762">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2024/oct/10/images-remarkable-preservation-ernest-shackleton-ship-endurance"
              >New images show state of preservation of Ernest Shackleton's
              ship</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-11 @ 19:33:18</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41812762"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41809107">
          <h3>
            <a
              class="item"
              href="https://www.cs.yale.edu/homes/wu-haomiao/publication/curlyCue.html"
              >Curly-Cue: Geometric Methods for Highly Coiled Hair</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-11 @ 13:01:42</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41809107"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41803457">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/dannguyen/faaa56cebf30ad51108a9fe4f8db36d8"
              >Extracting financial disclosure and police reports with OpenAI
              Structured Output</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-10 @ 20:51:14</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41803457"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
