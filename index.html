<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37696362">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/california-minimum-wage-increase-fast-food-newsom-69c26b7f07f2647149c37677446cea30"
              >New California law raises minimum wage for fast food workers to
              $20 per hour</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 21:50:55</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37696362"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37696118">
          <h3>
            <a
              class="item"
              href="https://popey.com/blog/2023/09/caps-lock-behaviour-disabled-in-gnome/"
              >Caps Lock Behaviour Disabled in Gnome</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 21:26:58</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37696118"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37696014">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/6b470a3a-178b-4f9a-95af-2d4a59b4c982"
              >Sweden turns to military to help police combat gang crime</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 21:18:35</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37696014"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37695530">
          <h3>
            <a class="item" href="https://github.com/fill3d/fill"
              >Show HN: Generative Fill with AI and 3D</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 20:41:30</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37695530"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                You've probably seen projects that add objects to an image from
                a style or text prompt, like InteriorAI (levelsio) and Adobe
                Firefly. The prevalent issue with these diffusion-based
                inpainting approaches is that they don't yet have great
                conditioning on lighting, perspective, and structure. You'll
                often get incorrect or generic shadows; warped-looking objects;
                and distorted backgrounds.
              </p>
              <p>
                What is Fill 3D? Fill 3D is an exploration on doing generative
                fill in 3D to render ultra-realistic results that harmonize with
                the background image, using industry-standard path tracing, akin
                to compositing in Hollywood movies.
              </p>
              <p>
                How does it work? 1. Deproject: First, deproject an image to a
                3D shell using both geometric and photometric cues from the
                input image. 2. Place: Draw rectangles and describe what you
                want in them, akin to Photoshop's Generative Fill feature. 3.
                Render: Use good ol' path tracing to render ultra-realistic
                results.
              </p>
              <p>
                Why Fill 3D? + The results are insanely realistic (see video in
                the github repo, or on the website). + Fast enough: Currently,
                generations take 40-80 seconds. Diffusion takes ~10seconds, so
                we're slower, but for the level of realism, it's pretty good. +
                Potential applications: I'm thinking of virtual staging in real
                estate media, what do you think?
              </p>
              <p>
                Check it out at
                <a href="https://fill3d.ai">https://fill3d.ai</a> + There's API
                access! :D + Right now, you need an image of an empty room. Will
                loosen this restriction over time.
              </p>
              <p>
                Fill 3D is built on Function (<a href="https://fxn.ai"
                  >https://fxn.ai</a
                >). With Function, I can run the Python functions that do the
                steps above on powerful GPUs with only code (no Dockerfile,
                YAML, k8s, etc), and invoke them from just about anywhere. I'm
                the founder of fxn.
              </p>
              <p>Tell me what you think!!</p>
              <p>PS: This is my first Show HN, so please be nice :)</p>
            </div>
          </section>
        </section>
        <section id="37695348">
          <h3>
            <a
              class="item"
              href="https://workspace.google.com/blog/product-announcements/next-phase-digital-whiteboarding"
              >Jamboard Being Deprecated 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 20:27:29</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37695348"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37695245">
          <h3>
            <a class="item" href="https://xlinux.nist.gov/dads/"
              >Dictionary of Algorithms and Data Structures</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 20:19:26</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37695245"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37695165">
          <h3>
            <a class="item" href="https://redbadger.github.io/crux/"
              >Crux: Cross-platform app development in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 20:13:28</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37695165"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37695035">
          <h3>
            <a
              class="item"
              href="https://rocknerd.co.uk/2023/09/28/bandcamp-has-been-sold-to-songtradr/"
              >Bandcamp has been sold to Songtradr. What does this mean for the
              musicians?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 20:04:13</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37695035"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37694910">
          <h3>
            <a class="item" href="https://github.com/Kautenja/RackNES"
              >RackNES: NES Module for VCV Rack</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 19:55:54</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37694910"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37694524">
          <h3>
            <a
              class="item"
              href="https://www.bleepingcomputer.com/news/security/bing-chat-responses-infiltrated-by-ads-pushing-malware/"
              >Bing Chat responses infiltrated by ads pushing malware</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 19:28:40</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37694524"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37694414">
          <h3><a class="item" href="https://librepcb.org/">LibrePCB</a></h3>
          <section>
            <h4>
              <span>2023-09-28 @ 19:23:04</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37694414"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37694333">
          <h3>
            <a class="item" href="https://amtrakexplorer.com/"
              >Amtrak Explorer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 19:17:33</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37694333"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37693766">
          <h3>
            <a
              class="item"
              href="https://retrocomputing.stackexchange.com/questions/27741/how-were-the-signs-for-logical-and-arithmetic-operators-decided"
              >How were the signs for logical and arithmetic operators
              decided?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 18:36:23</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37693766"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37692467">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37692467"
              >GoGoGrandparent (YC S16) is hiring a senior/staff back
              end/full-stack engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 17:00:47</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                The position: FULLY REMOTE | Full-time | US, UK, or able to work
                4+ hours overlap with mainland US
              </p>
              <p>
                Build high-quality, robust engineering at the rarest of things -
                a Silicon Valley startup that is both wholesome AND profitable.
                We have 8-figure revenue, are YC-backed, and growing fast.
              </p>
              <p>
                Tech stack (<i>required): Back-end heavy (Node</i>, Typescript<i
                  >, MySQL</i
                >, REST*+GraphQL), front-end (Vue), deploy (AWS, Docker/K8s)
              </p>
              <p>
                Minimum 4 years experience (with Node). If full-stack, you must
                be strongest on the backend.
              </p>
              <p>2-stage interview process.</p>
              <p>
                If you want to help older adults and people with disabilities,
                send your LinkedIn/CV to william@gogograndparent.com (keep it
                brief) or apply at
                <a
                  href="https://www.ycombinator.com/companies/gogograndparent/jobs"
                  >https://www.ycombinator.com/companies/gogograndparent/jobs</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="37692335">
          <h3>
            <a
              class="item"
              href="https://www.publicbooks.org/publishers-and-scholars-unite/"
              >Universities have disinvested from their presses just as much as
              their libraries</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 16:52:54</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37692335"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37692166">
          <h3>
            <a class="item" href="https://github.com/rzk-lang/rzk"
              >RZK: Experimental proof assistant for synthetic ∞-categories</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 16:41:42</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37692166"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37691547">
          <h3>
            <a
              class="item"
              href="https://www.figma.com/blog/what-codegen-is-actually-good-for/#aAkZ9"
              >What codegen is good for</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 16:01:49</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37691547"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37691232">
          <h3>
            <a class="item" href="https://jamesbvaughan.com/southwest-wifi/"
              >WiFi without internet on a Southwest flight</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 15:42:05</span
              ><span class="points-container"
                >Points: <span class="points">872</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37691232"
                  >Comments</a
                ><span class="descendants">: 417</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37691057">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/air-space-magazine/airliner-repair-247-9974457/"
              >Airliner Repair, 24/7 Boeing’s traveling fix-it team (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 15:31:03</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37691057"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37690392">
          <h3>
            <a class="item" href="https://arxiv.org/abs/1909.11090"
              >What if Planet 9 is a Primordial Black Hole? (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 14:53:14</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37690392"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37690372">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/a-medieval-french-skeleton-is-rewriting-the-history-of-syphilis/"
              >Rewriting the history of syphilis</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 14:51:34</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37690372"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37690320">
          <h3>
            <a
              class="item"
              href="https://tidyfirst.substack.com/p/coding-in-the-debugger"
              >Coding in the Debugger (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 14:48:51</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37690320"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37689282">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37689282"
              >Tell HN: Enterprises spend 10x more to build no-code solutions
              than coded ones</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 13:25:29</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37689282"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
            <div class="text">
              Code less sounds great for toy projects. People who aren't in tech
              aren't building no colde solutions beyond basic excel ones. So
              they end up hiring consultants to build them for them which costs
              at least 3-10x more if the solution were to be made with code. Ms
              powerapps for an example needs connector license for many basic
              things that costs a lot as well. This is from my experience as a
              consultant in many enterprises over last 3yrs watching code less
              explode in front my eyes.
            </div>
          </section>
        </section>
        <section id="37688887">
          <h3>
            <a class="item" href="https://www.freerdp.com/"
              >FreeRDP: A remote desktop protocol implementation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 12:48:14</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37688887"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37687846">
          <h3>
            <a
              class="item"
              href="https://chromium.googlesource.com/chromium/src/+/main/docs/security/research/graphics/webgpu_technical_report.md"
              >WebGPU Technical Report</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 10:59:01</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37687846"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37687699">
          <h3>
            <a
              class="item"
              href="https://www.openculture.com/2023/09/noam-chomsky-explains-why-nobody-is-really-a-moral-relativist-even-michel-foucault.html"
              >Chomsky explains why nobody is a moral relativist</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 10:38:22</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37687699"
                  >Comments</a
                ><span class="descendants">: 293</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37687134">
          <h3>
            <a
              class="item"
              href="https://aras-p.info/blog/2023/09/27/Making-Gaussian-Splats-more-smaller/"
              >Making Gaussian Splats more smaller</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 09:10:00</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37687134"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37686641">
          <h3>
            <a class="item" href="https://rackhackers.com/"
              >Upcycled Bicycle Panniers DIY</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 07:56:44</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37686641"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37686633">
          <h3>
            <a
              class="item"
              href="https://effectivetypescript.com/2023/09/27/closure-compiler/"
              >The saga of the Closure compiler, and why TypeScript won</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 07:55:38</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37686633"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37685580">
          <h3>
            <a
              class="item"
              href="https://www.raspberrypi.com/products/raspberry-pi-5/"
              >Raspberry Pi 5</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-28 @ 05:29:21</span
              ><span class="points-container"
                >Points: <span class="points">1276</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37685580"
                  >Comments</a
                ><span class="descendants">: 747</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
