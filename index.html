<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37078930">
          <h3>
            <a class="item" href="https://rhinolinux.org/"
              >Rhino Linux is a rolling release Ubuntu-based distribution</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 17:19:44</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37078930"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37078914">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2023-08-07/us-will-have-to-write-off-billions-in-student-debt-due-to-deaths"
              >US Will Have to Write Off Billions in Student Debt Due to
              Deaths</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 17:18:43</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37078914"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37078875">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/features/2023-08-10/why-being-an-airbnb-host-is-much-harder-than-in-the-past"
              >Is the Airbnb Dream Dead?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 17:15:37</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37078875"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37078708">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/memfault/jobs/zALzwIe-backend-engineer-systems-data"
              >Memfault (YC W19) Is Hiring a Data/Back End Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 17:01:03</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37078598">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/8/10/23827059/gm-no-carplay-android-auto-escalade-iq"
              >GM confirms $130k Cadillac won’t have Apple CarPlay or Android
              Auto</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 16:53:33</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37078598"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37078423">
          <h3>
            <a
              class="item"
              href="https://www.suse.com/news/OpenELA-for-a-Collaborative-and-Open-Future/"
              >CIQ, Oracle, SUSE Create Open Enterprise Linux Association</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 16:40:54</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37078423"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37077977">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/2023/aug/10/vigin-galactic-space-flight-vss-unity-landing"
              >Virgin Galactic successfully flies tourists to space for first
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 16:07:54</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37077977"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37077157">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/08/09/researchers-watched-100-hours-of-hackers-hacking-honeypot-computers/"
              >Researchers watched 100 hours of hackers hacking honeypot
              computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 15:10:41</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37077157"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37076933">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/two-students-shoot-down-a-widely-believed-math-conjecture-20230810/"
              >Students’ insight proves that the local-global conjecture doesn’t
              hold</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 14:54:44</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37076933"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37076693">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37076693"
              >Launch HN: Rubbrband (YC W23) – Deformity detection for
              AI-generated images</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 14:35:25</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37076693"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.rubbrband.com/">https://www.rubbrband.com/</a
              >). Rubbrband is software that evaluates the quality of images
              generated by Stable Diffusion (or Midjourney, DALL-e, etc…).
              <p>
                We actually stumbled into this idea while working on solving a
                different problem. While helping a few companies use Stable
                Diffusion in production, we found that these companies needed to
                use QA analysts to manually evaluate their images to make sure
                they were high quality once in prod. This process often took
                days just to go through thousands of images, so companies that
                have a text-to-image product with PMF couldn’t guarantee that
                their images were of high quality.
              </p>
              <p>
                From our initial set of customers, we found that evaluating the
                quality of their outputs at scale was an even larger problem
                than just using the model itself. So we pivoted our company into
                working on solving this problem using our skills from CV
                research. All three of us did computer vision research at UC
                Berkeley, and Abhi worked with John Canny, who invented many CV
                techniques like the Canny Edge Detector.
              </p>
              <p>
                We built a product that automates this process using computer
                vision. We’ve trained in-house several computer vision models
                that grade images based on different criteria.
              </p>
              <p>
                These include: - Detecting human deformities, such as a person
                with 7 fingers on a hand (image generation models generate
                deformed hands over 80% of the time when generating a photo of a
                person! This includes the state of the art: Midjourney, SDXL,
                Runway, etc…); - A score that rates how well the image aligns
                with the prompt(we do this using our own finetuned Visual
                Question Answer model); - A composition score (how well composed
                the image is according to photography “rules”)
              </p>
              <p>
                Using Rubbrband is pretty simple. You can send an image to us to
                process via our API or our web app, and you’ll get scores for
                each of those criteria back on your dashboard in less than 10
                seconds. Here is a quick Loom demo:
                <a
                  href="https://www.loom.com/share/961830347b3643dcbb92dfe80f8ca1f0?sid=faf1d9fb-5023-4dc8-96fc-5b3806ef3c6b"
                  >https://www.loom.com/share/961830347b3643dcbb92dfe80f8ca1f0?...</a
                >.
              </p>
              <p>
                You can filter your images based on certain criteria from the
                dashboard. For instance, if you want to see all images with
                deformed eyes, you can click the “deformed eyes” filter at the
                top of the screen to see all of those images.
              </p>
              <p>
                We store images generated by your image generation model. We’re
                like a logging tool for images, with evaluations on top. We
                currently charge $0.01 per image, with your first 1000 images
                free.
              </p>
              <p>
                We’re super excited to launch this to Hacker News. We’d love to
                hear what you think. Thanks in advance!
              </p>
            </div>
          </section>
        </section>
        <section id="37076523">
          <h3>
            <a
              class="item"
              href="https://learn.microsoft.com/en-us/microsoftteams/limits-specifications-teams"
              >MS Teams channels cannot contain MS-DOS device names</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 14:21:46</span
              ><span class="points-container"
                >Points: <span class="points">252</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37076523"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37076210">
          <h3>
            <a
              class="item"
              href="https://pair.withgoogle.com/explorables/grokking/"
              >Do Machine Learning Models Memorize or Generalize?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 13:56:24</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37076210"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37076125">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2308.00352"
              >MetaGPT: Meta Programming for Multi-Agent Collaborative
              Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 13:48:39</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37076125"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37074452">
          <h3>
            <a
              class="item"
              href="https://groups.google.com/g/vim_dev/c/dq9Wu5jqVTw"
              >The Future of the Vim Project</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 10:57:30</span
              ><span class="points-container"
                >Points: <span class="points">522</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37074452"
                  >Comments</a
                ><span class="descendants">: 309</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37073938">
          <h3>
            <a
              class="item"
              href="https://github.com/joonspk-research/generative_agents"
              >Generative Agents: Interactive Simulacra of Human Behavior, Now
              Open Source</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 09:39:06</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37073938"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37073885">
          <h3>
            <a class="item" href="https://speed.cloudflare.com/">Speed Test</a>
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 09:30:44</span
              ><span class="points-container"
                >Points: <span class="points">433</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37073885"
                  >Comments</a
                ><span class="descendants">: 158</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37072588">
          <h3>
            <a
              class="item"
              href="https://maritime-executive.com/article/world-s-strangest-research-vessel-heads-for-scrapyard-after-51-years"
              >Scripps Institution of Oceanography’s FLIP vessel decommissioned
              after 60 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 06:21:04</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37072588"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37072036">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/make-viking-funeral-flatbreads"
              >How to Make Viking Funerary Flatbread</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-10 @ 04:41:18</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37072036"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37068464">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/8/9/23826342/cnet-content-pruning-deleting-articles-google-seo"
              >CNET is deleting old articles to try to improve its Google Search
              ranking</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-09 @ 21:10:52</span
              ><span class="points-container"
                >Points: <span class="points">715</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37068464"
                  >Comments</a
                ><span class="descendants">: 509</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37066680">
          <h3>
            <a
              class="item"
              href="https://github.com/extesy/hoverzoom/discussions/670"
              >Temptations of an open-source Chrome extension developer
              (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-09 @ 18:28:30</span
              ><span class="points-container"
                >Points: <span class="points">1027</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37066680"
                  >Comments</a
                ><span class="descendants">: 334</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37065288">
          <h3>
            <a
              class="item"
              href="https://abcnews.go.com/Entertainment/wireStory/singer-songwriter-sixto-rodriguez-subject-searching-sugarman-documentary-102133209"
              >Sixto Rodriguez has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-09 @ 16:41:55</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37065288"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37061020">
          <h3>
            <a
              class="item"
              href="https://milkytracker.org/news/2023/07/05/version-1.04/"
              >MilkyTracker 1.04</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-09 @ 11:15:21</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37061020"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37060305">
          <h3>
            <a class="item" href="https://nonzerosum.games/thetetriseffect.html"
              >The Tetris Effect</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-09 @ 09:13:49</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37060305"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37053157">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/exoplanets-could-help-us-learn-how-planets-make-magnetism-20230807/"
              >Exoplanets Could Help Us Learn How Planets Make Magnetism</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-08 @ 18:08:41</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37053157"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37049415">
          <h3>
            <a
              class="item"
              href="https://twitter.com/milosstanojevic/status/1688896558790520832"
              >SynJax: Jax library for efficient probabilistic modeling of
              structured objects</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-08 @ 14:24:17</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37049415"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37049029">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/08/07/realestate/microgrid-solar-power-energy.html"
              >Developers are building communities that act as their own
              miniature power grids</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-08 @ 13:56:54</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37049029"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37048836">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37048836"
              >Ask HN: What are the economics of a streaming based record
              label?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-08 @ 13:41:26</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37048836"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                I have been looking at starting a record label as a side
                business. But it would be designed mostly to make money from
                Music Streaming services like Apple Music, Spotify, YouTube and
                others.
              </p>
              <p>
                I am thinking of using CD Baby for distribution of the music.
              </p>
              <p>
                Streaming services are not explicitly open about how much they
                pay per stream.
              </p>
              <p>
                I understand that the failure rate is high just like startups
                and movies.
              </p>
              <p>
                But I also realised that a hit song can accrue 500 million
                streams or even 1 Billion streams of its a big hit.
              </p>
              <p>
                My question is, how much interms of range should one expect to
                make incase they make such numbers.
              </p>
              <p>
                Is anyone here making money through streaming music? What's your
                estimated earning per stream across Spotify, Apple Music, &amp;
                YouTube?
              </p>
              <p>
                Also, any other tips of how to run the project or improve odds
                of success or learning/reading resources would be very much
                appreciated.
              </p>
            </div>
          </section>
        </section>
        <section id="37047529">
          <h3>
            <a
              class="item"
              href="https://themillions.com/2023/07/braille-is-alive-well-and-ever-evolving.html"
              >Braille Is Alive, Well, and Ever-Evolving</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-08 @ 11:49:59</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37047529"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37046353">
          <h3>
            <a
              class="item"
              href="https://download.clojure.org/papers/clojure-hopl-iv-final.pdf"
              >A History of Clojure (2020) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-08 @ 09:11:13</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37046353"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37046172">
          <h3>
            <a
              class="item"
              href="https://www.masswerk.at/nowgobang/2023/pet-keys-2001-edition"
              >Commodore PET Keys – Series 2001 Edition</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-08 @ 08:43:29</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37046172"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
