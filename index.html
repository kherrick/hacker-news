<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41154826">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/trellis/jobs/1ypWafM-founding-engineer-full-time-backend-ml-infra"
              >Trellis (YC W24) is hiring eng to build AI workflows for
              unstructured data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 17:01:59</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41154334">
          <h3>
            <a
              class="item"
              href="https://successfulsoftware.net/2024/08/04/making-your-own-hot-sauce/"
              >Making your own hot sauce</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 15:58:10</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41154334"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41154135">
          <h3>
            <a class="item" href="https://phoboslab.org/log/2024/08/high_impact"
              >Porting My JavaScript Game Engine to C for No Reason</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 15:26:34</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41154135"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41154053">
          <h3>
            <a
              class="item"
              href="https://blog.philosophicalsociety.org/2018/01/10/apprentice-journeyman-and-master-the-medieval-guild/"
              >Apprentice, Journeyman, and Master: The Medieval Guild</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 15:11:53</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41154053"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41154012">
          <h3>
            <a
              class="item"
              href="https://jsgroth.dev/blog/posts/snes-coprocessors-part-1/"
              >SNES Coprocessors: DSP-1 and Friends</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 15:07:40</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41154012"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41153902">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/science/archaeology/china-reaches-back-in-time-to-challenge-the-west-way-way-back-236c4e90"
              >China Reaches Back in Time to Challenge the West. Way, Way
              Back</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 14:50:00</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41153902"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41153712">
          <h3>
            <a class="item" href="https://kittycal.net"
              >Show HN: KittyCal – minimalist PWA calendar app for couples</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 14:15:00</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41153712"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm happy to share with you KittyCal, an installable calendar
                web app I made over the past two months. Existing calendar apps
                often focus on scheduling and require many steps to create one
                event. KittyCal, on the other hand, removes hourly scheduling
                and keeps everything on one screen.
              </p>
              <p>
                How does it work? Just enter your email address, and we will
                send you a pair of calendar links (blue and red). There is no
                login process, click the magic link or scan the QR code to
                access your calendar. You can then add the page to home screen
                and use it like a native app.
              </p>
              <p>
                Last year, I built a bare bones version of KittyCal for my
                partner and myself because we wanted a private calendar that
                launches instantly for casual note-taking. It's worked well for
                us since, and I'm hoping this multi-tenant version can benefit
                more people with similar needs.
              </p>
              <p>Please try it out and let me know what you think!</p>
            </div>
          </section>
        </section>
        <section id="41153093">
          <h3>
            <a
              class="item"
              href="https://www.politico.com/news/magazine/2024/08/04/us-spies-soviet-technology-00164126"
              >The Untold Story of How US Spies Sabotaged Soviet Technology</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 12:26:33</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41153093"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41153039">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2301.13142"
              >Self-Compressing Neural Networks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 12:17:16</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41153039"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41152654">
          <h3>
            <a
              class="item"
              href="https://margin.re/2024/07/you-cant-spell-webrtc-without-rce-part-1/"
              >You Can't Spell WebRTC Without RCE – Part 1</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 10:54:22</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41152654"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41152559">
          <h3>
            <a
              class="item"
              href="https://github.com/organicmaps/organicmaps/blob/master/docs/EXPERIMENTAL_PUBLIC_TRANSPORT_SUPPORT.md"
              >Organic maps: Experimental feed based public transport mapping</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 10:37:37</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41152559"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41152375">
          <h3>
            <a
              class="item"
              href="https://rabbitictranslator.com/contribute-to-kde-without-cpp/"
              >You can contribute to KDE with non-C++ code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 09:59:50</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41152375"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41152198">
          <h3>
            <a
              class="item"
              href="https://www.clearskyinstitute.com/ham/HamClock/"
              >HamClock – a real time space weather dashboard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 09:26:46</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41152198"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41151476">
          <h3>
            <a class="item" href="https://github.com/ataradov/usb-sniffer-lite"
              >USB Sniffer Lite for RP2040</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 06:24:53</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41151476"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41150249">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2024/08/03/polylog/"
              >Evaluating a class of infinite sums in closed form</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 00:20:10</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41150249"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41150095">
          <h3>
            <a class="item" href="https://farm.bot/"
              >Open Source Farming Robot</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 23:37:52</span
              ><span class="points-container"
                >Points: <span class="points">542</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41150095"
                  >Comments</a
                ><span class="descendants">: 274</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41149974">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/culture/cultural-comment/can-reading-make-you-happier"
              >Can reading make you happier? (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 23:10:17</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41149974"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41149931">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2205.12626"
              >Non-computability of solutions of certain equations on digital
              computers (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 23:02:33</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41149931"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41148532">
          <h3>
            <a
              class="item"
              href="https://cloud.google.com/blog/transform/ai-specialized-chips-tpu-history-gen-ai"
              >TPU transformation: A look back at 10 years of our AI-specialized
              chips</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 19:07:15</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41148532"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41148073">
          <h3>
            <a
              class="item"
              href="https://www.metacodes.pro/blog/computer_archeology_exploring_the_anatomy_of_an_ms_dos_virus/"
              >Computer Archeology: Exploring the Anatomy of an MS-DOS Virus</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 17:50:13</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41148073"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41147643">
          <h3>
            <a
              class="item"
              href="http://www.righto.com/2024/08/space-shuttle-interim-teleprinter.html"
              >Reverse engineering the 59-pound printer onboard the Space
              Shuttle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 16:43:09</span
              ><span class="points-container"
                >Points: <span class="points">301</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41147643"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41146860">
          <h3>
            <a class="item" href="https://blog.cr.yp.to/20240803-clang.html"
              >Clang vs. Clang</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 14:45:17</span
              ><span class="points-container"
                >Points: <span class="points">223</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41146860"
                  >Comments</a
                ><span class="descendants">: 317</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41146779">
          <h3>
            <a
              class="item"
              href="https://9to5mac.com/2024/08/02/developers-trick-app-store-review/"
              >Techniques used by developers to bypass App Store review</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 14:28:45</span
              ><span class="points-container"
                >Points: <span class="points">212</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41146779"
                  >Comments</a
                ><span class="descendants">: 186</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41146642">
          <h3>
            <a
              class="item"
              href="https://www.niemanlab.org/2024/07/to-preserve-their-work-and-drafts-of-history-journalists-take-archiving-into-their-own-hands/"
              >To preserve their work journalists take archiving into their own
              hands</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 13:57:49</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41146642"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41146278">
          <h3>
            <a
              class="item"
              href="https://matklad.github.io/2024/08/01/primitive-recursive-functions.html"
              >Primitive Recursive Functions for a Working Programmer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 12:32:01</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41146278"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41146239">
          <h3>
            <a
              class="item"
              href="https://jimmyhmiller.github.io/ugliest-beautiful-codebase"
              >"We ran out of columns"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 12:26:03</span
              ><span class="points-container"
                >Points: <span class="points">1397</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41146239"
                  >Comments</a
                ><span class="descendants">: 498</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41141163">
          <h3>
            <a
              class="item"
              href="https://slate.com/culture/2024/07/book-author-roland-allen-explains-the-history-of-the-diary-in-the-notebook-a-history-of-thinking-on-paper.html"
              >How Diaries Evolved from Lists to Personal Histories</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-02 @ 18:12:55</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41141163"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41131860">
          <h3>
            <a class="item" href="https://www.thespacereview.com/article/4738/1"
              >Review of Dark Star: A New History of the Space Shuttle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-01 @ 18:09:23</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41131860"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41120789">
          <h3>
            <a
              class="item"
              href="https://news.lettersofnote.com/p/i-miss-lorina-bulwer"
              >I miss Lorina Bulwer: A hand-stitched letter of note</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 16:42:12</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41120789"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41117005">
          <h3>
            <a
              class="item"
              href="https://www.mcgill.ca/oss/article/medical-critical-thinking/hype-around-photobiomodulation"
              >The Hype Around Photobiomodulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 07:11:53</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41117005"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
