<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38397817">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/webdev/comments/181vbmk/youtube_is_now_blocking_ad_blockers_so_i_just/"
              >YouTube is now blocking Ad Blockers – So I just make ads run 16x
              faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 21:33:26</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38397817"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38397404">
          <h3>
            <a
              class="item"
              href="https://www.euronews.com/next/2023/11/22/meet-the-first-spanish-ai-model-earning-up-to-10000-per-month"
              >The first Spanish AI model earning up to €10k per month</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 20:52:21</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38397404"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38396658">
          <h3>
            <a class="item" href="https://habr.com/en/articles/456476/"
              >Bluetooth stack modifications to improve audio quality on
              headphones without AA</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 19:41:49</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38396658"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38396345">
          <h3>
            <a class="item" href="https://www.shellcheck.net/"
              >Shellcheck finds bugs in your shell scripts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 19:16:08</span
              ><span class="points-container"
                >Points: <span class="points">189</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38396345"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38395813">
          <h3>
            <a
              class="item"
              href="https://forums.linuxmint.com/viewtopic.php?t=288004"
              >Snaps. Why? Please Stop</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 18:23:56</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38395813"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38394828">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/pepper/jobs/HiLVjDL-founding-data-product-engineer"
              >Pepper (YC S19) Is Hiring Founding Data Product Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 17:00:06</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38394635">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/the-story-of-titanium"
              >The story of titanium</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 16:43:25</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38394635"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38394391">
          <h3>
            <a
              class="item"
              href="https://css-tricks.com/snippets/css/complete-guide-grid/"
              >A Complete Guide to CSS Grid</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 16:19:02</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38394391"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38394383">
          <h3>
            <a
              class="item"
              href="https://ourworldindata.org/guinea-worm-path-eradication"
              >Guinea worm disease is close to being eradicated</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 16:18:45</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38394383"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38394364">
          <h3>
            <a
              class="item"
              href="https://seraleev.notion.site/Our-developer-account-was-removed-by-Apple-and-they-haven-t-paid-out-108-878-b61192711c74487480373badc70d42c0"
              >Developer account removed by Apple</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 16:16:22</span
              ><span class="points-container"
                >Points: <span class="points">620</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38394364"
                  >Comments</a
                ><span class="descendants">: 345</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38394156">
          <h3>
            <a class="item" href="https://www.qt.io/blog/qt-creator-12-released"
              >Qt Creator 12 Released</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 15:58:19</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38394156"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38393660">
          <h3>
            <a
              class="item"
              href="https://www.microbiologyresearch.org/content/journal/micro/10.1099/mic.0.001418"
              >C diff spores resist bleach and remain viable on surgical scrubs,
              fabrics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 15:20:05</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38393660"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38393390">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/pierre-de-fermats-link-to-a-high-school-students-prime-math-proof-20231122/"
              >Fermat's link to a high school student's prime math proof</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 14:57:20</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38393390"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38393384">
          <h3>
            <a
              class="item"
              href="https://nautil.us/digging-for-our-origins-in-the-bone-beds-of-an-african-park-449572/"
              >Digging for Our Origins in the Bone Beds of an African Park</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 14:56:50</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38393384"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38393238">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2023/11/23/branches-intuition-reality/"
              >Git Branches: Intuition and Reality</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 14:43:16</span
              ><span class="points-container"
                >Points: <span class="points">312</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38393238"
                  >Comments</a
                ><span class="descendants">: 174</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38393032">
          <h3>
            <a class="item" href="https://catern.com/services.html"
              >Write libraries instead of services, where possible</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 14:21:15</span
              ><span class="points-container"
                >Points: <span class="points">237</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38393032"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38392653">
          <h3>
            <a
              class="item"
              href="https://www.soundstagesolo.com/index.php/features/178-eardrum-suck-the-mystery-solved"
              >Eardrum Suck: The Mystery Solved (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 13:44:06</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38392653"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38392540">
          <h3>
            <a class="item" href="https://encore.dev/blog/retries"
              >Retries – An interactive study of request retry methods</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 13:32:16</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38392540"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38392277">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-03602-5"
              >Polio is on the brink of eradication</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 13:00:21</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38392277"
                  >Comments</a
                ><span class="descendants">: 197</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38391787">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/how-godels-proof-works-20200714/"
              >How Gödel's proof works (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 11:52:57</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38391787"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38391403">
          <h3>
            <a class="item" href="https://gbdev.io/pandocs/"
              >Gameboy technical reference for homebrew developers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 10:42:25</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38391403"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38391138">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/in-memoriam-nov-2023"
              >Luiz André Barroso has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 09:53:45</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38391138"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38390914">
          <h3><a class="item" href="https://ansel.photos/en/">Ansel</a></h3>
          <section>
            <h4>
              <span>2023-11-23 @ 09:10:58</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38390914"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38387464">
          <h3>
            <a class="item" href="https://jmmv.dev/2020/03/test-bracket.html"
              >test, [, and [[ (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-23 @ 00:31:33</span
              ><span class="points-container"
                >Points: <span class="points">412</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38387464"
                  >Comments</a
                ><span class="descendants">: 197</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38381573">
          <h3>
            <a
              class="item"
              href="https://ln.hixie.ch/?start=1700627373&amp;count=1"
              >Reflecting on 18 Years at Google</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-22 @ 16:44:15</span
              ><span class="points-container"
                >Points: <span class="points">2069</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38381573"
                  >Comments</a
                ><span class="descendants">: 983</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38379104">
          <h3>
            <a class="item" href="https://shuffle.dev/library-creator"
              >Show HN: UI Library Creator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-22 @ 13:51:44</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38379104"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                In the last three years, we have added 60+ professional UI
                libraries to Shuffle's catalog (Shuffle = visual editor for web
                developers). Still, we know we need more than this to satisfy
                our growing user base!
              </p>
              <p>
                That's why we created the UI Library Creator. In this tool, you
                can combine elements and styles to create unique UI libraries
                that work seamlessly with the Shuffle Editor and all its
                capabilities (drag-and-drop, customizations, live preview, and
                more).
              </p>
              <p>
                We provide you with UX solutions (components) written in
                Tailwind CSS and presets so you can quickly combine them to
                create what you need. You don't need to talk to a "black box" AI
                with a chat interface.
              </p>
              <p>Possible combinations are in gazillions.</p>
              <p>
                We aim for original creations, but you have complete control
                over the final effect.
              </p>
              <p>How to use the UI Library Creator:</p>
              <p>
                * Visit:
                <a href="https://shuffle.dev/library-creator"
                  >https://shuffle.dev/library-creator</a
                >
              </p>
              <p>
                * We recommend starting by selecting Assets and Copywriting for
                your target audience.
              </p>
              <p>
                * When these two options are locked, use the "Shuffle Styles"
                button to bootstrap your project with the first style.
              </p>
              <p>
                * If you like something, lock the category and then repeat
                shuffling. You can also change options manually, but with
                "Shuffle Styles," you can quickly see many creations.
              </p>
              <p>
                If you enjoy the final result, click "Publish now" and send your
                UI Library to Shuffle.
              </p>
              <p>
                Once processed, it will be available for use in your Dashboard.
              </p>
              <p>Let us know what you think!</p>
              <p>
                Video (2min) with product tour:
                <a href="https://www.youtube.com/watch?v=8ZFlWEDr7XM"
                  >https://www.youtube.com/watch?v=8ZFlWEDr7XM</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="38378557">
          <h3>
            <a class="item" href="https://lwn.net/Articles/351422/"
              >POSIX v. reality: A position on O_PONIES (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-22 @ 12:58:47</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38378557"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38378555">
          <h3>
            <a
              class="item"
              href="https://hakaimagazine.com/videos-visuals/the-secret-language-of-ships/"
              >The secret language of ships</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-22 @ 12:58:43</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38378555"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38378227">
          <h3>
            <a
              class="item"
              href="https://nymag.com/news/features/laundry-apps-2014-5/"
              >Silicon Valley's Laundry-App Race (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-22 @ 12:18:16</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38378227"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38377307">
          <h3>
            <a class="item" href="https://github.com/visioncortex/vtracer"
              >Vtracer: Next-Gen Raster-to-Vector Conversion</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-22 @ 10:10:49</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38377307"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
