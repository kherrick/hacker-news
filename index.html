<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42991859">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/infisical/jobs/ZHPybgI-full-stack-engineer"
              >Infisical (YC W23) Is Hiring Full Stack Engineers (US and
              Canada)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 17:02:06</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42991019">
          <h3>
            <a class="item" href="https://github.com/jtroo/kanata"
              >Kanata: Cross-platform multi-layer keyboard remapper with
              advanced customization</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 14:52:54</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42991019"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42991006">
          <h3>
            <a
              class="item"
              href="https://www.heise.de/en/news/Hard-disk-fraud-Increasing-evidence-of-origin-in-China-10269059.html"
              >Hard disk fraud: long runtimes on new Seagate hard disks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 14:50:11</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42991006"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42990948">
          <h3>
            <a
              class="item"
              href="https://www.latacora.com/blog/2019/07/24/how-not-to/"
              >How (not) to sign a JSON object (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 14:38:52</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42990948"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42990819">
          <h3>
            <a
              class="item"
              href="https://wingolog.org/archives/2025/02/09/baffled-by-generational-garbage-collection"
              >Baffled by generational garbage collection – wingolog</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 14:16:40</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42990819"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42990540">
          <h3>
            <a class="item" href="https://booktalk.club/"
              >Show HN: My first side project, streamlined book clubs on
              Slack</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 13:28:10</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42990540"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42990351">
          <h3>
            <a class="item" href="https://www.ocal.ai/"
              >Show HN: Ocal – AI Calendar That Schedules Assignments for You</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 12:49:48</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42990351"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <p>
                We realized that most students don’t struggle with time
                management because they’re lazy—they struggle because time
                planning itself is an overhead. The mental effort of estimating
                task durations, figuring out when to work, and actually doing
                the work is non-trivial. So we decided to eliminate that
                friction.
              </p>
              <p>
                How It Works: 1 LMS Integration (Canvas for now) – Ocal scans
                your assignments, extracts deadlines, and understands task
                complexity. 2 AI-Scheduled Work Blocks – Based on your habits
                (night owl vs. early bird), Ocal schedules the work comfortably
                ahead of deadlines—no more cramming. 3 Subtle Weekly Adjustments
                – Each week, Ocal subtly tweaks your schedule, nudging you
                toward your ideal workflow without a disruptive overhaul. 4
                Social Scheduling (Coming Soon) – Friend people, see when
                they’re free/busy (privacy-first), and let AI find optimal times
                for study groups, workouts, or board game nights.
              </p>
              <p>
                Why This Matters: Most productivity tools still rely on manual
                scheduling—we don’t. Ocal makes time blocking effortless,
                helping students get work done early and reclaim time. No
                decision fatigue. No planning paralysis. Just execution.
              </p>
              <p>
                What’s Next? We’ve been building for a week. Ocal is not fully
                built for institutions yet, but it’s developed enough for people
                to start testing. If you’re a student or productivity geek, we’d
                love for you to poke around and tell us what works, what sucks,
                and what features you'd love to see.
              </p>
              <p>Check it out &amp; let us know what you think!</p>
            </div>
          </section>
        </section>
        <section id="42990324">
          <h3>
            <a
              class="item"
              href="https://iquilezles.org/articles/gpuconditionals/"
              >Don't "optimize" conditional moves in shaders with
              mix()+step()</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 12:42:54</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42990324"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42990036">
          <h3>
            <a
              class="item"
              href="https://github.com/Pravko-Solutions/FlashLearn/tree/main/examples"
              >Classic Data science pipelines built with LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 11:39:38</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42990036"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42989923">
          <h3>
            <a class="item" href="http://www.colinux.org/"
              >Linux as co-operative Windows process (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 11:07:52</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42989923"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42989628">
          <h3>
            <a class="item" href="https://itizso.itch.io/retrofab"
              >RetroFab: Playable 3D simulations of vintage electronic games</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 09:50:35</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42989628"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42989609">
          <h3>
            <a
              class="item"
              href="https://asteriskmag.com/issues/08/chimes-at-midnight"
              >Chimes at Midnight (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 09:45:57</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42989609"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42989419">
          <h3>
            <a
              class="item"
              href="https://marktomforde.com/academic/miscellaneous/images/atiyah20thcentury.pdf"
              >Mathematics in the 20th century, by Michael Atiyah [pdf]
              (2002)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 08:54:37</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42989419"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42989320">
          <h3>
            <a class="item" href="https://thebullshitmachines.com"
              >Modern-Day Oracles or Bullshit Machines</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 08:24:17</span
              ><span class="points-container"
                >Points: <span class="points">347</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42989320"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42988946">
          <h3>
            <a class="item" href="https://github.com/fdavies93/daily-notes.nvim"
              >Show HN: Daily-notes.nvim – fuzzy time journal and planning
              plugin</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 06:42:10</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42988946"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <p>
                note: not using NLP, LLMs or 'true' fuzzy parsing as per
                academic literature; just normal recursive descent parsing
              </p>
            </div>
          </section>
        </section>
        <section id="42988303">
          <h3>
            <a
              class="item"
              href="https://www.cell.com/cell-reports/fulltext/S2211-1247(13)00570-6"
              >Brain Hyperconnectivity in Children with Autism and Its Links to
              Social Deficits (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 03:54:04</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42988303"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42987646">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41586-024-08514-6"
              >Emergence of collective oscillations in human crowds</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 01:20:04</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42987646"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42986320">
          <h3>
            <a class="item" href="https://jacksonpollock.org/"
              >Jacksonpollock.org (2003)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 21:22:49</span
              ><span class="points-container"
                >Points: <span class="points">450</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42986320"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42985427">
          <h3>
            <a class="item" href="https://johnkerl.org/doc/ortho/ortho.html"
              >Tips for mathematical handwriting (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 19:20:10</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42985427"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42985342">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-01-rwandan-scientists-local-yeast-banana.html"
              >Rwandan scientists develop local yeast for banana wine-makers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 19:09:21</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42985342"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42983699">
          <h3>
            <a class="item" href="https://github.com/xajik/thedeck"
              >The Deck: An open-source cross-platform multiplayer card game
              engine in Flutter</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 15:47:36</span
              ><span class="points-container"
                >Points: <span class="points">302</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42983699"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42978199">
          <h3>
            <a class="item" href="https://amanvir.com/obscure-islands"
              >Obscure islands I find interesting</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 22:23:31</span
              ><span class="points-container"
                >Points: <span class="points">466</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42978199"
                  >Comments</a
                ><span class="descendants">: 152</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42976698">
          <h3>
            <a
              class="item"
              href="https://blog.danslimmon.com/2019/07/15/do-nothing-scripting-the-key-to-gradual-automation/"
              >Do-nothing scripting: the key to gradual automation (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 19:48:16</span
              ><span class="points-container"
                >Points: <span class="points">516</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42976698"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42975492">
          <h3>
            <a
              class="item"
              href="https://kevin.burke.dev/kevin/norcal-cities-new-utility/"
              >Cities can cost effectively start their own utilities</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 17:55:40</span
              ><span class="points-container"
                >Points: <span class="points">344</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42975492"
                  >Comments</a
                ><span class="descendants">: 308</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42972982">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/how-noethers-theorem-revolutionized-physics-20250207/"
              >Noether's Theorem Revolutionized Physics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 14:33:32</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42972982"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42963414">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/quantum-error"
              >Antimony Atoms Function as Error-Resistant Qubits</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 15:42:23</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42963414"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42961855">
          <h3>
            <a
              class="item"
              href="https://bencane.com/cell-based-architecture-explained-with-zombies-f5e814d3e5d2"
              >Cell-Based Architecture Explained, with Zombies</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 12:52:52</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42961855"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42961572">
          <h3>
            <a class="item" href="https://codepen.io/AAMutlu20/pen/mdYxroj"
              >HTML Kaleidoscope</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 12:02:18</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42961572"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42950059">
          <h3>
            <a class="item" href="https://tenochtitlan.thomaskole.nl/"
              >3D reconstruction of the capital of the Aztec empire</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 15:40:27</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42950059"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42948590">
          <h3>
            <a
              class="item"
              href="https://blog.maximeheckel.com/posts/post-processing-as-a-creative-medium/"
              >Post-Processing Shaders as a Creative Medium</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 14:02:43</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42948590"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
