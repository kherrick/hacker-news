<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40409757">
          <h3>
            <a
              class="item"
              href="https://mzucker.github.io/2016/10/11/unprojecting-text-with-ellipses.html"
              >Unprojecting Text with Ellipses (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 21:08:17</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40409757"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40409718">
          <h3>
            <a
              class="item"
              href="https://jonatron.github.io/randomstuff/pivolt/"
              >Beating Jeff's 3.14 Ghz Raspberry Pi 5</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 21:02:36</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40409718"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40409710">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/interestingasfuck/comments/1cva6j6/meteor_just_seen_in_portugal_23h45/"
              >Meteor Just Seen in Portugal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 21:01:15</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40409710"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40409588">
          <h3>
            <a class="item" href="https://charm.li/"
              >Operation CHARM: Car repair manuals for everyone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 20:39:12</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40409588"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40409405">
          <h3>
            <a class="item" href="https://cs231n.github.io/"
              >Convolutional Neural Networks for Visual Recognition</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 20:04:54</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40409405"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40409309">
          <h3>
            <a
              class="item"
              href="https://meringue.readthedocs.io/en/latest/meringue_philosophy.html"
              >Meringue Philosophy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 19:49:04</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40409309"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40409290">
          <h3>
            <a
              class="item"
              href="https://lapcatsoftware.com/articles/2024/5/3.html"
              >Updating from macOS Ventura to Sonoma Silently Enables iCloud
              Keychain</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 19:44:24</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40409290"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40408880">
          <h3>
            <a
              class="item"
              href="https://github.com/naklecha/llama3-from-scratch"
              >Llama3 implemented from scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 18:42:06</span
              ><span class="points-container"
                >Points: <span class="points">279</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40408880"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40408515">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40408515"
              >Ask HN: Video streaming is expensive yet YouTube "seems" to do it
              for free. How?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 17:51:41</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40408515"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
            <div class="text">
              <p>
                Streaming, encoding, and storage demands enormous costs --
                especially at scale (e.g., on average each 4k video with close
                to 1 million views). Yet YouTube seems to charge no money for
                it.
              </p>
              <p>I know advertisements are a thing for YT, but is it enough?</p>
              <p>
                If tomorrow I want to start a platform that is supported with
                Advert revenues, I know I will likely fail. However, maybe at YT
                scale (or more specifically Google Advert scale) the economics
                works?
              </p>
              <p>
                ps: I would like this discussion to focus on the absolute
                necessary elements (e.g., storing, encoding, streaming) and not
                on other factors contributing to latency/cost like running view
                count algorithms.
              </p>
            </div>
          </section>
        </section>
        <section id="40408291">
          <h3>
            <a
              class="item"
              href="https://www.amygoodchild.com/blog/cursive-handwriting-in-javascript"
              >Coding My Handwriting</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 17:15:29</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40408291"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40407927">
          <h3>
            <a
              class="item"
              href="https://julienposture.substack.com/p/the-ai-doppelganger-experiment-part"
              >AI doppelgänger experiment – Part 1: The training</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 16:19:06</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40407927"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40407884">
          <h3>
            <a
              class="item"
              href="https://nicole.express/2024/elementary-midi-watson.html"
              >A floppy disk MIDI boombox: The Yamaha MDP-10</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 16:13:35</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40407884"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40407526">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40407526"
              >Make timelapses easily using FFmpeg</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 15:24:12</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40407526"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
            <div class="text">
              <p>
                ffmpeg -framerate 30 -pattern_type glob -i '*.JPG' -c:v libx264
                -r 30 -pix_fmt yuv420p timelapse.mp4
              </p>
            </div>
          </section>
        </section>
        <section id="40407228">
          <h3>
            <a
              class="item"
              href="https://astrobiology.com/2024/05/swarming-proxima-centauri-coherent-picospacecraft-swarms-over-interstellar-distances.html"
              >Swarming Proxima Centauri: Picospacecraft Swarms over
              Interstellar Distances</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 14:33:10</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40407228"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40407104">
          <h3>
            <a
              class="item"
              href="https://sep.turbifycdn.com/ty/cdn/paulgraham/bellanguage.txt"
              >The Bel Language (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 14:14:06</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40407104"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40406344">
          <h3>
            <a
              class="item"
              href="https://terraforming-mars-player-board.netlify.app/"
              >Show HN: Digital player board for Terraforming Mars</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 12:00:25</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40406344"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
            <div class="text">
              My cousin and I love the Terraforming Mars board game. But we'd
              often get overly excited and knock our pieces off of our boards,
              losing track of our progress. So I digitised it. It comes with a
              few cool features like resource conversions (e.g. converting
              plants to greenery), production phase, offline, mobile-friendly
              and keeps track of the history using the browser history itself.
              Sharing this here in case there are any other TM fans that could
              also find some use in this :)
            </div>
          </section>
        </section>
        <section id="40406194">
          <h3>
            <a class="item" href="https://bernsteinbear.com/blog/weval/"
              >Compilers for free with weval</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 11:33:43</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40406194"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40405578">
          <h3>
            <a
              class="item"
              href="https://theoverclockingpage.com/2024/05/13/tutorial-transforming-a-qlc-ssd-into-an-slc-ssd-dramatically-increasing-the-drives-endurance/?lang=en"
              >Transforming a QLC SSD into an SLC SSD</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 09:30:16</span
              ><span class="points-container"
                >Points: <span class="points">206</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40405578"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40404825">
          <h3>
            <a class="item" href="https://www.emergetools.com/careers"
              >Emerge Tools (YC W21) is hiring senior engineers to automate dead
              code deletion</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 07:01:00</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40404423">
          <h3>
            <a
              class="item"
              href="https://www.bigmessowires.com/2014/11/17/68-katy-68000-linux-on-a-solderless-breadboard/"
              >Katy – 68000 Linux on a Solderless Breadboard (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 05:12:28</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40404423"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40404054">
          <h3>
            <a class="item" href="https://www.filfre.net/2024/05/riven/"
              >Riven</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 03:34:45</span
              ><span class="points-container"
                >Points: <span class="points">452</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40404054"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40403962">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2405.04540"
              >Is artificial consciousness achievable? Lessons from the human
              brain</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-19 @ 03:18:04</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40403962"
                  >Comments</a
                ><span class="descendants">: 353</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40402719">
          <h3>
            <a class="item" href="https://github.com/hackyourlife/brawshot"
              >Show HN: Brawshot – Basic temporal denoise for videos in BRAW
              format</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-18 @ 22:47:29</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40402719"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                If you want to use this tool for artistic purposes, it will
                produce extreme motion blur depending on the window size you
                choose.
              </p>
              <p>
                I am aware that tools like ffmpeg or the paid version of DaVinci
                Resolve have denoising features, but at least ffmpeg's denoising
                filters are extremely slow and memory intensive, and it's fun to
                implement this as fast GPU accelerated open source software for
                this non-standard use case anyway.
              </p>
              <p>
                To use this tool, you'll need a Blackmagic Design camera which
                records in BRAW format (or you could hack the video decoder in
                the main.cpp file to decode some other source video file
                format).
              </p>
              <p>
                If someone has a good idea how to remove the remaining noise
                pattern which seems to be inherent in the image sensor and very
                slowly changes over time, I'd be very interested!
              </p>
            </div>
          </section>
        </section>
        <section id="40401852">
          <h3>
            <a
              class="item"
              href="https://longreads.com/2018/05/15/when-the-movies-went-west/"
              >When the movies went west (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-18 @ 20:31:11</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40401852"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40401758">
          <h3>
            <a
              class="item"
              href="https://theconvivialsociety.substack.com/p/the-ambling-mind"
              >The Ambling Mind</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-18 @ 20:19:47</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40401758"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40399224">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/style/eat-poison-ivy-oak-immunity-3207ec3c"
              >I couldn't escape poison oak, so I started eating it</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-18 @ 14:12:20</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40399224"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40398480">
          <h3>
            <a
              class="item"
              href="https://www.goto10retro.com/p/what-ever-happened-to-modula-2"
              >What ever happened to Modula-2?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-18 @ 12:32:53</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40398480"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40398094">
          <h3>
            <a
              class="item"
              href="https://www.roads.org.uk/blog/sorry-wrong-number"
              >Sorry, wrong number</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-18 @ 11:29:03</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40398094"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40397908">
          <h3>
            <a
              class="item"
              href="https://www.nj.com/news/2024/05/why-you-cant-see-out-the-window-on-some-nj-transit-trains.html"
              >Commuter train window cleaning conundrum in NJ</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-18 @ 10:52:33</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40397908"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40397834">
          <h3>
            <a
              class="item"
              href="https://austinmorlan.com/posts/unity_jumbo_build/"
              >Working with jumbo/unity builds in C/C++</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-18 @ 10:30:27</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40397834"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
