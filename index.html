<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43633383">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/news/anthropic-education-report-how-university-students-use-claude"
              >Anthropic Education Report: How University Students Use Claude</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 15:41:38</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43633383"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43633298">
          <h3>
            <a class="item" href="https://github.com/herol3oy/austen"
              >Show HN: I built an app to generate story relationships using
              Mermaidjs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 15:34:27</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43633298"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43633288">
          <h3>
            <a
              class="item"
              href="https://leaddev.com/culture/ai-coding-mandates-are-driving-developers-to-the-brink"
              >AI coding mandates are driving developers to the brink</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 15:33:53</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43633288"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43633256">
          <h3>
            <a
              class="item"
              href="https://www.itprotoday.com/software-development/german-military-to-replace-microsoft-software"
              >Bundeswehr to remove all Microsoft software from its systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 15:31:16</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43633256"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43632459">
          <h3>
            <a
              class="item"
              href="https://www.strongtowns.org/journal/2025/4/1/small-town-america-vs-big-box-stores"
              >Small Town America vs. Big Box Stores</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 14:20:14</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43632459"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43632379">
          <h3>
            <a
              class="item"
              href="https://livesys.se/posts/the-chroot-technique/"
              >The chroot Technique – a Swiss army multitool for Linux
              systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 14:12:47</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43632379"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43632278">
          <h3>
            <a class="item" href="https://fermi-game.andrewnoble.me/"
              >Show HN: Fermi – A Wordle-style game for order-of-magnitude
              thinking</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 14:04:17</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43632278"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                You build a rough logic chain using a few sliders and fixed
                quantities (e.g. weeks per year), and the goal is to get within
                an order of magnitude of the true answer. The math is simple;
                the thinking is the game.
              </p>
              <p>Would love feedback.</p>
            </div>
          </section>
        </section>
        <section id="43631822">
          <h3>
            <a class="item" href="https://spacetimedb.com/">SpacetimeDB</a>
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 13:27:30</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631822"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43631793">
          <h3>
            <a class="item" href="https://dynomate.io/"
              >Show HN: Dynomate– Fast, Git-Friendly DynamoDB GUI Client
              (Dynobase Alternative)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 13:24:51</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631793"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <p>Features:</p>
              <p>
                1. Request collections: Chain together multiple operations -
                put, query, update, and delete across tables, accounts and
                sessions. Use the output of one operation as input for the next.
              </p>
              <p>
                2. Environment Variables: Configure variables once and run the
                same requests across different environments (dev/staging/prod).
                No more manual parameter swapping.
              </p>
              <p>
                3. Multi-tab, multi-account support: Work with multiple tables
                across different AWS accounts, and sso sessions simultaneously.
              </p>
              <p>4. Easy SSO Login: Start sso login without leaving the GUI.</p>
              <p>
                5. Git sync: All requests configurations are saved locally as
                TOML files. Your data stays private, and you can version control
                with Git.
              </p>
              <p>I appreciate any feedback.</p>
            </div>
          </section>
        </section>
        <section id="43631672">
          <h3>
            <a
              class="item"
              href="https://whynothugo.nl/journal/2025/04/09/man-pages-are-great-man-readers-are-the-problem/"
              >Man pages are great, man readers are the problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 13:11:50</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631672"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43631656">
          <h3>
            <a class="item" href="https://jcarlosroldan.com/post/355"
              >Quality-of-Life in Tetris Games</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 13:10:44</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631656"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43631450">
          <h3>
            <a
              class="item"
              href="https://softwaredoug.com/blog/2025/04/08/llm-query-understand"
              >An LLM Query Understanding Service</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 12:46:59</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631450"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43631381">
          <h3>
            <a
              class="item"
              href="https://developers.googleblog.com/en/a2a-a-new-era-of-agent-interoperability/"
              >The Agent2Agent Protocol (A2A)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 12:38:20</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631381"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43631298">
          <h3>
            <a
              class="item"
              href="https://www.securityweek.com/treasurys-occ-says-hackers-had-access-to-150000-emails/"
              >Treasury's OCC Says Hackers Had Access to 150k Emails</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 12:28:01</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631298"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43631276">
          <h3>
            <a
              class="item"
              href="https://stratechery.com/2025/american-disruption/"
              >American Disruption</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 12:24:36</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631276"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43631274">
          <h3>
            <a
              class="item"
              href="https://blog.google/products/google-cloud/ironwood-tpu-age-of-inference/"
              >Ironwood: The first Google TPU for the age of inference</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 12:24:19</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631274"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43631004">
          <h3>
            <a
              class="item"
              href="https://overreacted.io/react-for-two-computers/"
              >React for Two Computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 11:35:36</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43631004"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43630733">
          <h3>
            <a class="item" href="https://buzzed.chat"
              >Show HN: I built a Yahoo Messenger-inspired web chat app – pure
              nostalgia</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 10:47:20</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43630733"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              <p>
                Room owners can customize things like backgrounds and even
                cursors of their room. Users can format their messages with
                basic markdown like bold, italics, and color texts (kind of like
                the old Yahoo! days).
              </p>
              <p>
                I even brought back the classic Yahoo! Messenger emoticons
                because… well, why not?
              </p>
              <p>
                You can try it out here:
                <a href="https://buzzed.chat">https://buzzed.chat</a> (Heads up:
                it's still pretty barebones, so excuse any bugs you might run
                into!)
              </p>
              <p>I'm thinking of adding a few more features next, like:</p>
              <p>• Audibles</p>
              <p>• A buddy list so you can add friends</p>
              <p>• Private chats between buddies</p>
              <p>
                Before I keep building, I wanted to check in and see what people
                think. Anyone else remember using Yahoo! Messenger back in the
                day? Any features you’d love to see again?
              </p>
              <p>Would genuinely love to hear your thoughts and ideas</p>
            </div>
          </section>
        </section>
        <section id="43630388">
          <h3>
            <a
              class="item"
              href="https://attackanddefense.dev/2025/04/09/hardening-the-firefox-frontend-with-content-security-policies.html"
              >Hardening the Firefox Front End with Content Security Policies</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 09:34:16</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43630388"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43629887">
          <h3>
            <a
              class="item"
              href="https://www.centauri-dreams.org/2025/04/08/on-sun-like-stars/"
              >'Sun-Like' Stars</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 08:01:38</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43629887"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43628500">
          <h3>
            <a class="item" href="https://github.com/DistroHopper39B/NTATV"
              >NTATV: Bringing Windows NT (Windows XP, Windows 2003) to the
              Original Apple TV</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 03:00:01</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43628500"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43627864">
          <h3>
            <a
              class="item"
              href="https://tomscii.sig7.se/2025/04/The-Barium-Experiment"
              >The Barium Experiment</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 00:44:22</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43627864"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43627758">
          <h3>
            <a class="item" href="https://www.drawdb.app/"
              >Show HN: DrawDB – open-source online database diagram editor (a
              retro)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 00:20:18</span
              ><span class="points-container"
                >Points: <span class="points">213</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43627758"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
            <div class="text">
              <p>
                In a year we somehow managed to hit 26k stars, grow a 1000+
                person discord community, and support 37 languages. I couldn't
                be more grateful for the community that helped this grow, but
                now i don't know what direction to take this project in.
              </p>
              <p>
                All of this was an accident. But now I feel like I'm missing out
                on not using this success. I have been thinking of monetization
                options, but not sure if I wanna go down that route. I like the
                idea of it being free and available for everyone but also can't
                help but think of everything that could be done if committed
                full-time or even had a small team. I keep telling myself(and
                others) i'll do something if i meet a co-founder, but doubt and
                fear of blowing this up keeps back.
              </p>
              <p>How would you proceed?</p>
            </div>
          </section>
        </section>
        <section id="43627646">
          <h3>
            <a
              class="item"
              href="https://blog.vectorchord.ai/postgresql-full-text-search-fast-when-done-right-debunking-the-slow-myth"
              >PostgreSQL Full-Text Search: Fast When Done Right (Debunking the
              Slow Myth)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 00:00:15</span
              ><span class="points-container"
                >Points: <span class="points">355</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43627646"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43625474">
          <h3>
            <a
              class="item"
              href="https://yuxi-liu-wired.github.io/essays/posts/cyc/"
              >Obituary for Cyc</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-08 @ 19:13:50</span
              ><span class="points-container"
                >Points: <span class="points">395</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43625474"
                  >Comments</a
                ><span class="descendants">: 209</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43624220">
          <h3>
            <a class="item" href="https://echarts.apache.org/en/index.html"
              >Apache ECharts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-08 @ 17:23:29</span
              ><span class="points-container"
                >Points: <span class="points">1482</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43624220"
                  >Comments</a
                ><span class="descendants">: 218</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43602652">
          <h3>
            <a class="item" href="https://avisoft.com/recorder-tests/"
              >Microphone Input Noise Comparison – Avisoft Bioacoustics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-06 @ 16:23:53</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43602652"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43597264">
          <h3>
            <a
              class="item"
              href="https://github.com/a13xp0p0v/linux-kernel-defence-map"
              >Linux Kernel Defence Map – Security Hardening Concepts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 22:16:54</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43597264"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43595193">
          <h3>
            <a
              class="item"
              href="https://news.mit.edu/2025/making-graphs-more-accessible-blind-low-vision-readers-0325"
              >A new way to make graphs more accessible to blind and low-vision
              readers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 17:47:10</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43595193"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43594090">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/science.ads1325"
              >Nonlinear soundsheet microscopy:imaging opaque organs
              capillary/cellular scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 15:13:00</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43594090"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
