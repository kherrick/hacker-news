<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35865257">
          <h3>
            <a
              class="item"
              href="https://www.thearchaeologist.org/blog/long-before-modern-humans-existed-100000-years-ago-neanderthals-built-boats-and-went-sailing"
              >Long before modern humans existed Neanderthals built boats and
              went sailing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 18:28:56</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35865257"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35865010">
          <h3>
            <a
              class="item"
              href="https://incisive.vc/2022/12/23/fundraising-stages-defined-angel-pre-seed-seed-series-a/"
              >Fundraising Stages Defined (Angel/Pre-Seed/Seed/Series A) –
              Incisive Ventures</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 18:10:06</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35865010"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35864661">
          <h3>
            <a class="item" href="https://cptn.io"
              >Show HN: Cptn.io – open-source integration platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 17:45:50</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35864661"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <a href="https://cptn.io">https://cptn.io</a>). The product is MIT
              licensed and the repo is at
              <a href="https://github.com/cptn-io/el-cptn"
                >https://github.com/cptn-io/el-cptn</a
              >.
              <p>
                I have started on my startup journey an year ago and launched a
                monitoring platform called DevRaven. Unfortunately the product
                did not takeoff as expected. That story is for another day.
              </p>
              <p>
                But during the course of building the product, I have built
                several integrations leveraging MQs and Cloud Functions. While
                building and deploying Cloud Functions for happy paths is easy,
                I had to monitor logs for failures, build retry mechanisms or
                manually process failed events, keep instances running to
                prevent cold start timeouts. It can also get expensive with
                charges for MQs, server time for running cloud functions etc and
                costs can be unpredictable.
              </p>
              <p>
                I thought of building a platform where I can build integrations
                quickly, have the ability to look at incoming/outgoing events,
                look at logs, retry any failed events etc. And finally,
                predictable costs for running the infrastructure. cptn.io
                provides all these capabilities and more. You can build
                pipelines to integrate with any cloud services, send data from
                your backend to data warehouses, listen to web hook events etc.
                The platform can be integrated into any stack by sending events
                to HTTP end points.
              </p>
              <p>
                Instead of trying to build a business first or launch an open
                source product under restrictive licenses, the platform will be
                available under MIT license so any user or customer can use it.
                There is no ee folder or complex dual licensing and I am also
                committing to releasing SSO under MIT. The plan is to offer a
                managed service in the cloud at a later time, accept sponsors
                for prioritizing features for enterprise customers and charge
                for enterprise support.
              </p>
              <p>
                It should take less than 5 minutes to get the platform running
                on your machine. Welcome any feedback, feature requests, PRs and
                bug reports.
              </p>
            </div>
          </section>
        </section>
        <section id="35864484">
          <h3>
            <a
              class="item"
              href="https://foiaonline.gov/foiaonline/action/public/submissionDetails?trackingNumber=EPA-2023-004020&amp;type=Request"
              >[EPA] Interim Decision to Artificial Intelligence Tools</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 17:34:01</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35864484"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35864429">
          <h3>
            <a class="item" href="https://www.nextcomputers.org/"
              >Next Computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 17:29:37</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35864429"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35864114">
          <h3>
            <a class="item" href="https://domainverification.org"
              >Show HN: Automatic Domain Verification</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 17:06:01</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35864114"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>
                The Domain Verification protocol stores a DNS TXT record at a
                DNS name derived from a hashed "verifiable identifier" (email,
                telephone, DID), enabling anyone that can prove control over the
                verifiable identifier to prove authority for the domain name,
                whilst preserving the privacy of the authorised party.
              </p>
              <p>
                Once setup, the record enables automatic domain verification for
                any service provider.
              </p>
              <p>
                This record could be automatically setup by domain registrars
                upon domain registration (with registrant opt-in) creating a
                fast lane for verification with service providers many new small
                businesses use (eg Google Ads, Facebook, Office365, Dropbox,
                etc).
              </p>
              <p>=====</p>
              <p>
                Many of us would have verified a domain name by pasting a string
                into a DNS TXT record. These methods are currently being
                discussed and standardised at the IETF [2].
              </p>
              <p>
                Let's Encrypt's DNS-01 method [3] is probably considered the
                state of the art. The differences between DNS-01 and Domain
                Verification protocol are:
              </p>
              <p>
                - DNS-01 requires a new TXT record for each service provider.
                With Domain Verification Protocol, multiple service providers
                can use the same record.
              </p>
              <p>
                - Instructions to setup a DNS-01 TXT record are instigated by
                the service provider, whereas a Domain Verification Protocol
                record can be setup independently by a user or a domain
                registrar. They could even pre-populated by a registrar upon
                domain registration (with registrant opt-in)
              </p>
              <p>
                - There’s no concept of permissions in DNS-01, the act of
                creating the record gives the user full access for the domain
                with the service provider. With Domain Verification protocol
                multiple records can be setup, limited permissions could be
                setup for different third parties. For example give a marketing
                agency authentication to claim the domain on social media but
                nowhere else.
              </p>
              <p>
                I'm still working on licensing but creating these records will
                always be free. I hope to find service providers that see
                significant upside in reducing friction for user onboarding that
                are willing to pay to license it.
              </p>
              <p>
                Worked example: Let's say you want to authenticate the user with
                the email user@example.com with the domain dvexample.com, these
                are the steps:
              </p>
              <p>
                a. HASH(user@example.com) -&gt;
                4i7ozur385y5nsqoo0mg0mxv6t9333s2rarxrtvlpag1gsk8pg
              </p>
              <p>
                b. Store Domain Verification record at:
                4i7ozur385y5nsqoo0mg0mxv6t9333s2rarxrtvlpag1gsk8pg._dv.dvexample.com
              </p>
              <p>c. TXT record determines permissions and time limit:</p>
              <p>
                @dv=1;d=Example user
                email;e=2025-01-01;s=[seo;email];h=4i7ozur385y5nsqoo0mg0mxv6t9333s2rarxrtvlpag1gsk8pg
              </p>
              <p>Thanks for taking a look,</p>
              <p>Elliott</p>
              <p>
                1.
                <a href="https://news.ycombinator.com/item?id=35827952"
                  >https://news.ycombinator.com/item?id=35827952</a
                >
              </p>
              <p>
                2.
                <a
                  href="https://datatracker.ietf.org/doc/draft-ietf-dnsop-domain-verification-techniques/"
                  >https://datatracker.ietf.org/doc/draft-ietf-dnsop-domain-ver...</a
                >
              </p>
              <p>
                3.
                <a href="https://letsencrypt.org/docs/challenge-types/"
                  >https://letsencrypt.org/docs/challenge-types/</a
                >
              </p>
              <p>=====</p>
              <p>Quick sidebar:</p>
              <p>
                This was originally submitted to HN under the title "Show HN:
                Make domain verification as easy as verifying an email or phone
                number" 3 days ago [1]. It was doing really well (#3 on front
                page) then totally disappeared from front page and went to
                bottom of page 1 of Show HN.
              </p>
              <p>
                After an email exchange with dang (incredibly helpful as
                always), he explained that it got flagged with the "overheated
                discussion detector" and it turned out I caused this by
                diligently responding to every comment as fast as my fingers
                would type because I wanted to keep engagement going. Helpfully
                dang took the flag off it about 12 hours later after our email
                exchange, but understandably the momentum was lost.
              </p>
              <p>
                So I feel like it kinda got killed, just as it was picking up
                pace and as the US west coast was waking up. So I am humbly
                reposting it with a modified description based on the comments
                of the last post.
              </p>
            </div>
          </section>
        </section>
        <section id="35864053">
          <h3>
            <a class="item" href="https://www.tesorio.com/careers#job-openings"
              >Tesorio (YC S15) Hiring Senior Back End Engineer, DevOps, Head of
              Data Science</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 17:01:39</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35863837">
          <h3>
            <a class="item" href="https://github.com/vadimdemedes/ink"
              >Ink: React for interactive command-line apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 16:46:41</span
              ><span class="points-container"
                >Points: <span class="points">173</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35863837"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35863746">
          <h3>
            <a
              class="item"
              href="https://www.damninteresting.com/colonels-of-truth/"
              >Colonels of Truth (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 16:41:25</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35863746"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35863309">
          <h3>
            <a
              class="item"
              href="https://aaronlou.com/blog/2023/reflected-diffusion/"
              >Reflected Diffusion Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 16:13:01</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35863309"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35863175">
          <h3>
            <a
              class="item"
              href="https://github.blog/2023-05-08-github-code-search-is-generally-available/"
              >GitHub code search is generally available</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 16:01:47</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35863175"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35863124">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/concrete"
              >Concrete goes carbon-negative</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 15:59:03</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35863124"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35862837">
          <h3>
            <a
              class="item"
              href="http://undeadly.org/cgi?action=article;sid=20230507122935"
              >OpenBSD cron(8) now supports random ranges with steps</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 15:40:33</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35862837"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35862799">
          <h3>
            <a
              class="item"
              href="https://qrper.com/2023/04/coax-cables-i-used-for-sota-pota-a-horror-story/"
              >A coax cable horror story</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 15:37:43</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35862799"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35862656">
          <h3>
            <a
              class="item"
              href="https://www.spytalk.co/p/exclusive-fbi-agents-accuse-cia-of"
              >FBI agents accuse CIA of 9/11 coverup</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 15:26:42</span
              ><span class="points-container"
                >Points: <span class="points">346</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35862656"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35862142">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/a-mutation-turned-ants-into-parasites-in-one-generation-20230508/"
              >A mutation turned ants into parasites in one generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 14:50:47</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35862142"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35861502">
          <h3>
            <a
              class="item"
              href="https://appventuretime.blog/how-to-design-software-architecture-for-startups"
              >How to design software architecture for startups</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 13:52:53</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35861502"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35861435">
          <h3>
            <a
              class="item"
              href="https://b-fg.github.io/2023/05/07/waterlily-on-gpu.html"
              >GPU vendor-agnostic fluid dynamics solver in Julia</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 13:44:16</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35861435"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35860827">
          <h3>
            <a
              class="item"
              href="https://blog.sigma-star.at/post/2023/05/sandbox-netns/"
              >Restricting network access using Linux Network Namespaces</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 12:31:12</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35860827"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35859877">
          <h3>
            <a
              class="item"
              href="https://github.com/keepassxreboot/keepassxc/pull/8825"
              >KeePassXC pull request to add basic support for WebAuthn</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 10:00:51</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35859877"
                  >Comments</a
                ><span class="descendants">: 175</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35859338">
          <h3>
            <a
              class="item"
              href="https://fabiensanglard.net/sf2_sheets/index.html"
              >Street Fighter II, paper trails (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 08:30:58</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35859338"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35858438">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/blog/2010/sep/08/slime-mould-physarum"
              >Let slime moulds do the thinking (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 05:28:48</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35858438"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35858375">
          <h3>
            <a class="item" href="https://ivanish.ca/hest-time-travel/"
              >Hest, Time Travel (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 05:16:26</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35858375"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35858268">
          <h3>
            <a
              class="item"
              href="https://bigthink.com/health/unlucky-history-rapamycin-anti-aging/"
              >Rapamycin: The unlucky history of an anti-aging drug</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-08 @ 04:59:25</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35858268"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35852710">
          <h3>
            <a
              class="item"
              href="https://gizmodo.com/casio-g-shock-digital-watch-fitness-tracking-heart-rate-1850357822"
              >Casio adds fitness features to original G-Shock digital watch</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-07 @ 15:52:43</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35852710"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35852516">
          <h3>
            <a
              class="item"
              href="https://www.chrbutler.com/what-i-want-from-the-internet"
              >What I want from the internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-07 @ 15:36:16</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35852516"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35852271">
          <h3>
            <a
              class="item"
              href="https://variety.com/2023/biz/news/writer-pay-up-or-down-1235559599/"
              >Is writer pay up or down? Depends how you look at it</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-07 @ 15:10:25</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35852271"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35837807">
          <h3>
            <a
              class="item"
              href="http://www.travelforaliving.co.uk/tips/know-about-new-york-destination-fee/"
              >The New York hotel destination fee scam (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 03:52:14</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35837807"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35836221">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35836221"
              >Ask HN: Suing Facebook in small claims?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 23:08:45</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35836221"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <p>
                I am still paying monthly for Facebook Ads for my small
                business. However, I cannot log in to cancel these Ads. I tried
                contacting my credit card company, but FB uses a different
                vendor account for each bill posted, making it difficult for the
                credit card company to stop these transactions.
              </p>
              <p>
                I attempted emailing FB several time to legal@facebook.com. And
                I wrote a letter twice, and sent in the mail via postage, with
                tracking, which was delivered, to cancel my Ad services and
                provide a refund. No response however.
              </p>
              <p>
                Should I proceed to small claims court to recover about $300 of
                lost Ad revenue, for a service which I can no longer use? I am
                still being billed to. Does anybody have any experience with
                this?
              </p>
            </div>
          </section>
        </section>
        <section id="35836019">
          <h3>
            <a class="item" href="https://mashpoe.github.io/favicon-dino-game/"
              >Favicon Dino Game</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 22:45:42</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35836019"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
