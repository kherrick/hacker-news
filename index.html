<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42028047">
          <h3>
            <a
              class="item"
              href="https://twitter.com/ServeTheHome/status/1850917031421399543"
              >Colossus AI Supercluster with over 100k Nvidia H100 GPUs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 18:08:44</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42028047"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42027654">
          <h3>
            <a class="item" href="https://lynx.boo"
              >Show HN: A minimalist (brutalist?) website for sharing all your
              links</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 17:10:25</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42027654"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm building a series of websites that have simple concepts but
                too many of the players have tried to make their product so big.
                I also used to live in a very rural area so my goal is to make
                websites that load fast even on very slow internet. I'm starting
                with Lynx.boo.
              </p>
              <p>
                A linktree style website that lets you fully customize your CSS
                (and adds a bunch of classes to your links to help style them
                easier as well as very non-restrictive CSS you can do
                html{display:none;} if you really want to) and the features
                aren't locked behind yet-another monthly fee. I'll be adding
                analytic support when I figure out the best way to do it.
              </p>
              <p>
                Also there isn't a user system (per se), you just confirm
                changes by email but you never register for the site and you
                won't be spammed. Please feel free to try to break the CSS (or
                anything) as much as you want. I think it's fairly robust but I
                would love any security vulnerabilities you see.
              </p>
              <p>Thank you for your time!</p>
            </div>
          </section>
        </section>
        <section id="42027564">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/britain-s-postwar-sugar-craze-confirms-harms-sweet-diets-early-life"
              >Britain's postwar sugar craze confirms harms of sweet diets in
              early life</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 16:56:26</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42027564"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42027187">
          <h3>
            <a class="item" href="https://github.com/rbbydotdev/someday"
              >Show HN: Someday, Open-Source Calendly Alternative for Gmail /
              Google App Script</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 16:04:40</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42027187"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              Free and open-source. Simple alternative to cal.com / calendly,
              built on Google-App-Script for Gmail users. Built with modern
              technologies like React, TypeScript, Shadcn/UI, and Vite.
            </div>
          </section>
        </section>
        <section id="42026054">
          <h3>
            <a class="item" href="https://github.com/fabiospampinato/cash"
              >Cash: An absurdly small jQuery alternative for modern browsers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 12:42:07</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42026054"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42025469">
          <h3>
            <a class="item" href="https://blog.spawek.com/SpawELO"
              >Show HN: SpawELO - small free matchmaking system for LAN
              parties</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 10:44:42</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42025469"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42024727">
          <h3>
            <a class="item" href="https://justine.lol/lex/"
              >Weird Lexical Syntax</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 07:45:26</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42024727"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42024554">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/tabular/jobs/nGeV93o-data-scientist-ai"
              >Tabular (YC S24) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 07:00:44</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42024439">
          <h3>
            <a
              class="item"
              href="https://keithamcgowan.blogspot.com/2024/11/breaking-image-12th-century-ai-weiwei.html"
              >Breaking the image: a 12th-century Ai Weiwei?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 06:29:18</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42024439"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42023667">
          <h3>
            <a
              class="item"
              href="https://daily.jstor.org/ghosts-in-the-machine/"
              >Ghosts in the Machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 02:41:08</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42023667"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42023237">
          <h3>
            <a class="item" href="https://github.com/dmd/morse"
              >Show HN: Midnight Reminders via Morse Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 01:11:29</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42023237"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42023089">
          <h3>
            <a
              class="item"
              href="https://jondlm.github.io/website/blog/leaving_stripe/"
              >My Time Working at Stripe</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 00:44:42</span
              ><span class="points-container"
                >Points: <span class="points">326</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42023089"
                  >Comments</a
                ><span class="descendants">: 298</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42022649">
          <h3>
            <a
              class="item"
              href="https://chromestatus.com/feature/6398297361088512"
              >Direct Sockets API in Chrome 131</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-01 @ 23:35:37</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42022649"
                  >Comments</a
                ><span class="descendants">: 128</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42021786">
          <h3>
            <a
              class="item"
              href="https://edmcman.github.io/blog/2024-01-11--fuzzy-hashing-for-code-comparisons/"
              >The performance of hashing for similar function detection</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-01 @ 21:36:01</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42021786"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42010136">
          <h3>
            <a
              class="item"
              href="https://mattgreer.dev/blog/cramming-solitaire-onto-a-nintendo-ereader-card/"
              >Cramming Solitaire onto a Nintendo E-Reader card</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-31 @ 18:50:00</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42010136"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42005821">
          <h3>
            <a
              class="item"
              href="https://skarredghost.com/2024/10/31/xpanceo-smart-contact-lenses-hands-on/"
              >Xpanceo smart contact lenses hands-on</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-31 @ 11:44:19</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42005821"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42004219">
          <h3>
            <a
              class="item"
              href="https://sharpsec.run/rce-vulnerability-in-qbittorrent/"
              >RCE Vulnerability in QBittorrent</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-31 @ 07:18:09</span
              ><span class="points-container"
                >Points: <span class="points">327</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42004219"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41998337">
          <h3>
            <a
              class="item"
              href="https://www.jhiblog.org/2024/10/28/a-serious-man/"
              >A Serious Man: On Bruno Latour</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-30 @ 18:06:28</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41998337"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41995589">
          <h3>
            <a
              class="item"
              href="https://planktonvalhalla.com/20241030-recursion-tidy-stars-and-water-lilies/"
              >Recursion, Tidy Stars, and Water Lilies</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-30 @ 14:50:23</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41995589"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41995549">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=F_7IPm7f1vI"
              >Boston Dynamics robot Atlas goes hands on [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-30 @ 14:46:10</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41995549"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41993096">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/toshiba-rice-cooker"
              >The inventor of the automatic rice cooker</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-30 @ 09:08:45</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41993096"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41991352">
          <h3>
            <a
              class="item"
              href="https://thecookscook.com/features/the-almost-lost-art-of-rosin-potatoes/"
              >The almost-lost art of rosin potatoes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-30 @ 02:20:59</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41991352"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41989260">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/collection/hokusai-s-ghost-stories-ca-1830/"
              >Hokusai's five ghoulish prints for the series Hyaku Monogatari
              (ca. 1830)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-29 @ 20:51:57</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41989260"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41987352">
          <h3>
            <a class="item" href="https://github.com/ryohey/signal"
              >Signal: Online MIDI Editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-29 @ 17:46:59</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41987352"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41984184">
          <h3>
            <a
              class="item"
              href="https://www.prisma.io/blog/announcing-prisma-postgres-early-access"
              >Prisma Postgres â€“ Runs on bare metal and unikernels</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-29 @ 14:27:39</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41984184"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41970571">
          <h3>
            <a
              class="item"
              href="https://dmytroengineering.com/content/projects/t2s-plus-thermal-camera-hacking"
              >Hacking the T2S+ Out of Fear: Get Lock-In Thermography for
              Free</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-28 @ 12:49:57</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41970571"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41970554">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/technology/2024/oct/28/microsoft-excel-spreadsheet-program-40-years"
              >'I grew up with it': readers on the enduring appeal of Microsoft
              Excel</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-28 @ 12:47:36</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41970554"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41970406">
          <h3>
            <a
              class="item"
              href="https://www.projectgus.com/2024/01/kona-motor-turns/"
              >The motor turns too much</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-28 @ 12:29:57</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41970406"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41967988">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/books/2024/oct/25/letters-by-oliver-sacks-review"
              >Letters by Oliver Sacks review</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-28 @ 05:00:34</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41967988"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41967849">
          <h3>
            <a
              class="item"
              href="https://www.historytoday.com/archive/explicit-content"
              >The 1600s were a watershed for swear words (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-28 @ 04:18:16</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41967849"
                  >Comments</a
                ><span class="descendants">: 118</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
