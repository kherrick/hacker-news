<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43800222">
          <h3>
            <a class="item" href="https://github.com/wh0am1-dev/adventure"
              >Colossal Cave Adventure (1976)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 01:52:32</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43800222"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43800153">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/lofty-math-problem-called-hilberts-sixth-closer-to-being-solved/"
              >Mathematicians just solved a 125-year-old problem, uniting 3
              theories in physics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 01:39:28</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43800153"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43800002">
          <h3>
            <a class="item" href="https://lite.berkeley-humanoid.org/"
              >Berkeley Humanoid Lite – Open-source robot</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 01:03:40</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43800002"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799820">
          <h3>
            <a
              class="item"
              href="https://samj.substack.com/p/that-joke-isnt-funny-any-more"
              >I wrote a book called "Crap Towns". It seemed funny at the
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 00:30:41</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799820"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799697">
          <h3>
            <a
              class="item"
              href="https://www.doliver.org/articles/rss-as-a-skill"
              >Reading RSS content is a skilled activity</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 00:08:14</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799697"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799396">
          <h3>
            <a class="item" href="https://tavianator.com/2025/configure.html"
              >Parallel ./configure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 23:19:56</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799396"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799306">
          <h3>
            <a
              class="item"
              href="https://cacm.acm.org/practice/call-for-papers-cacm-practice-section/"
              >ACM's flagship magazine seeks submissions by/for practitioners</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 23:04:54</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799306"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799302">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/technology/2025/04/25/wikipedia-nonprofit-ed-martin-letter/"
              >Wikipedia’s nonprofit status questioned by D.C. U.S. attorney</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 23:03:55</span
              ><span class="points-container"
                >Points: <span class="points">320</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799302"
                  >Comments</a
                ><span class="descendants">: 277</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43798832">
          <h3>
            <a
              class="item"
              href="https://docs.tscircuit.com/tutorials/building-led-matrix"
              >I designed my LED matrix PCB with code</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 21:43:33</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43798832"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43798757">
          <h3>
            <a
              class="item"
              href="https://madebyoll.in/posts/world_emulation_via_dnn/"
              >World Emulation via Neural Network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 21:33:57</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43798757"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43798467">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/gym-class-by-irl-studios/jobs/7UKmLED-gameplay-animation-engineer-staff-principal"
              >Gym Class (YC W22) Is Hiring Character Animation Engineering
              Lead</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 21:01:05</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43798009">
          <h3>
            <a class="item" href="https://ddili.org/ders/d.en/"
              >Programming in D: Tutorial and Reference</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 20:06:33</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43798009"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43797256">
          <h3>
            <a class="item" href="https://github.com/ndrwnaguib/principia"
              >Show HN: Formalizing Principia Mathematica using Lean</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 18:49:30</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43797256"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
            <div class="text">
              <p>
                <a href="https://ndrwnaguib.com/principia/"
                  >https://ndrwnaguib.com/principia/</a
                >
              </p>
              <p>
                <a href="https://github.com/ndrwnaguib/principia"
                  >https://github.com/ndrwnaguib/principia</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43797212">
          <h3>
            <a class="item" href="https://curry-lang.org/"
              >Curry: A functional logic programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 18:46:22</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43797212"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43796935">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2504.11651"
              >Lossless LLM compression for efficient GPU inference via
              dynamic-length float</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 18:20:53</span
              ><span class="points-container"
                >Points: <span class="points">296</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43796935"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43796898">
          <h3>
            <a class="item" href="https://citadel5.com/gs-calc.htm"
              >Show HN: A modern spreadsheet with Python integration</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 18:17:45</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43796898"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>
                Load GB/32 million-row files in seconds and use them without any
                crashes using up to about 500GB RAM.
              </p>
              <p>
                Load/edit in-place/split/merge/clean CSV/text files with up to
                32 million rows and 1 million columns.
              </p>
              <p>
                Use your Python functions as UDF formulas that can return to
                GS-Calc images and entire CSV files.
              </p>
              <p>Use a set of statistical pivot data functions.</p>
              <p>
                Solver functions virtually without limits for the number of
                variables.
              </p>
              <p>
                Create and display all popular chart types with millions of data
                points instantly.
              </p>
              <p>
                Suggestions for improvements are welcome (and often implemented
                quite quickly).
              </p>
            </div>
          </section>
        </section>
        <section id="43796419">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2504.17192"
              >Paper2Code: Automating Code Generation from Scientific Papers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 17:36:15</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43796419"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43796003">
          <h3>
            <a class="item" href="https://github.com/magnitudedev/magnitude"
              >Show HN: Magnitude – open-source, AI-native test framework for
              web apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 17:00:35</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43796003"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                We know there's a lot of noise about different browser agents.
                If you've tried any of them, you know they're slow, expensive,
                and inconsistent. That's why we built an agent specifically for
                running test cases and optimized it just for that:
              </p>
              <p>
                - Pure vision instead of error prone "set-of-marks" system (the
                colorful boxes you see in browser-use for example)
              </p>
              <p>
                - Use tiny VLM (Moondream) instead of OpenAI/Anthropic computer
                use for dramatically faster and cheaper execution
              </p>
              <p>
                - Use two agents: one for planning and adapting test cases and
                one for executing them quickly and consistently.
              </p>
              <p>
                The idea is the planner builds up a general plan which the
                executor runs. We can save this plan and re-run it with only the
                executor for quick, cheap, and consistent runs. When something
                goes wrong, it can kick back out to the planner agent and
                re-adjust the test.
              </p>
              <p>
                It’s completely open source. Would love to have more people try
                it out and tell us how we can make it great.
              </p>
              <p>
                Repo:
                <a href="https://github.com/magnitudedev/magnitude"
                  >https://github.com/magnitudedev/magnitude</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43795300">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-025-01266-x"
              >Reproducibility project fails to validate dozens of biomedical
              studies</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 16:14:08</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43795300"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43795090">
          <h3>
            <a class="item" href="https://research.swtch.com/diffcover"
              >Differential Coverage for Debugging</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 16:01:24</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43795090"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43794284">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/electric-cars/655527/slate-electric-truck-price-paint-radio-bezos"
              >A $20k American-made electric pickup with no paint, no stereo, no
              screen</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 15:01:37</span
              ><span class="points-container"
                >Points: <span class="points">1046</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43794284"
                  >Comments</a
                ><span class="descendants">: 931</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43794110">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/science.adr3026"
              >Tumor-derived erythropoietin acts as immunosuppressive switch in
              cancer immunity</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 14:42:27</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43794110"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43793526">
          <h3>
            <a
              class="item"
              href="https://scalewithlee.substack.com/p/when-etchsts-breaks-your-substack"
              >Writing "/etc/hosts" breaks the Substack editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 13:48:30</span
              ><span class="points-container"
                >Points: <span class="points">500</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43793526"
                  >Comments</a
                ><span class="descendants">: 282</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43793288">
          <h3>
            <a class="item" href="https://mitxela.com/projects/euroknob"
              >Eurorack Knob Idea</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 13:19:02</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43793288"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43793280">
          <h3>
            <a
              class="item"
              href="https://hiddenlayer.com/innovation-hub/novel-universal-bypass-for-all-major-llms/"
              >The Policy Puppetry Prompt: Novel bypass for major LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 13:18:17</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43793280"
                  >Comments</a
                ><span class="descendants">: 195</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43792248">
          <h3>
            <a class="item" href="https://gcc.gnu.org/gcc-15/">GCC 15.1</a>
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 10:53:59</span
              ><span class="points-container"
                >Points: <span class="points">212</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43792248"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43791992">
          <h3>
            <a class="item" href="https://clevercoloringbook.com/"
              >Show HN: I used OpenAI's new image API for a personalized
              coloring book service</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 10:05:39</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43791992"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
            <div class="text">
              <p>
                Last month, when OpenAI's Sora was released for public use I
                (foolishly) thought I'd manually drag-and-drop each order’s
                photos into Sora's UI and copy the resulting images back into my
                system. This took way too much time (about an hour for each of
                the few books I made and tested with family and friends). It
                clearly wasn't possible to release this version because I’d be
                losing a huge amount of time on every order. So instead, I
                decided I'd finish off the project as best I could, put it "on
                ice," and wait for the API release.
              </p>
              <p>
                The API is now released (quicker than I thought it'd be, too!)
                and I integrated it last night. I'd love your feedback on any
                and all aspects.
              </p>
              <p>
                The market is mostly family-based, but from my testing of the
                physical book I've found that both adults and kids enjoy
                coloring them in (it's surprisingly cathartic and creative). If
                you would like to order one you can get 10% off by tapping the
                total price line item five times.
              </p>
            </div>
          </section>
        </section>
        <section id="43791385">
          <h3>
            <a
              class="item"
              href="https://bfi.uchicago.edu/wp-content/uploads/2025/04/BFI_WP_2025-56-1.pdf"
              >Large language models, small labor market effects [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 08:15:18</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43791385"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43788255">
          <h3>
            <a
              class="item"
              href="https://www.swiss-miss.com/2025/04/a-love-letter-to-people-who-believe-in-people.html"
              >A Love Letter to People Who Believe in People</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-24 @ 22:35:01</span
              ><span class="points-container"
                >Points: <span class="points">317</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43788255"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43779398">
          <h3>
            <a
              class="item"
              href="https://www.leadedsolder.com/2025/04/22/vtech-socrates-pickup.html"
              >The VTech Socratic Method</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-24 @ 05:05:45</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43779398"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
