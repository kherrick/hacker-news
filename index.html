<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41607920">
          <h3>
            <a
              class="item"
              href="https://www.hollywoodreporter.com/lifestyle/lifestyle-news/tesla-robotaxi-warner-bros-reveal-hollywood-rejection-elon-musk-1236007945/"
              >Hollywood Can't Ditch Its Teslas Fast Enough:"They're Destroying
              Their Leases.."</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-21 @ 06:26:25</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41607920"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41607887">
          <h3>
            <a
              class="item"
              href="https://www.motor1.com/news/734156/porsche-six-stroke-combustion-engine/"
              >Porsche's Idea for a Six-Stroke Internal Combustion Engine Looks
              Brilliant</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-21 @ 06:15:01</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41607887"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41607569">
          <h3>
            <a
              class="item"
              href="https://blogyet.com/blog_posts/why-ruby-on-rails-will-never-die-a-veteran-coder-s-perspective"
              >Ruby on Rails continues to thrive</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-21 @ 04:53:29</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41607569"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41607166">
          <h3>
            <a
              class="item"
              href="https://www.ign.com/articles/what-the-heck-has-been-going-on-at-annapurna-interactive-an-investigation"
              >Inside Annapurna Interactive's Mass Walkout</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-21 @ 03:05:27</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41607166"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41607059">
          <h3>
            <a class="item" href="https://switowski.com/blog/i-like-makefiles/"
              >I Like Makefiles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-21 @ 02:37:44</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41607059"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41606916">
          <h3>
            <a class="item" href="https://github.com/winfsp/sshfs-win"
              >Sshfs for Windows</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-21 @ 02:05:34</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41606916"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41606530">
          <h3>
            <a
              class="item"
              href="https://www.macrumors.com/2024/09/20/iphone-16-repair-manual/"
              >Apple Shares Full iPhone 16 and iPhone 16 Pro Repair Manuals</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-21 @ 00:17:16</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41606530"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41606493">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/09/20/cisa_sloppy_vendors_cybercrime_villains/"
              >CISA boss: Makers of insecure software are the real cyber
              villains</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-21 @ 00:05:57</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41606493"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41605774">
          <h3>
            <a
              class="item"
              href="https://peelarchivesblog.com/2024/09/10/how-do-archivists-package-things-the-battle-of-the-boxes/"
              >How do archivists package things? The battle of the boxes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 21:45:35</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41605774"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41605680">
          <h3>
            <a
              class="item"
              href="https://blog.sonicwall.com/en-us/2024/09/critical-exploit-in-mediatek-wi-fi-chipsets-zero-click-vulnerability-cve-2024-20017-threatens-routers-and-smartphones/"
              >Critical Exploit in MediaTek Wi-Fi Chipsets: Zero-Click
              Vulnerability</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 21:28:49</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41605680"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41605471">
          <h3>
            <a class="item" href="https://up.codes/careers?utm_source=HN"
              >UpCodes (YC S17) Is Hiring a Marketing Leader</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 21:00:13</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41604840">
          <h3>
            <a class="item" href="https://github.com/taylorai/aiq"
              >Show HN: Open-source text classification CLI – train models with
              no labeled data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 19:22:11</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41604840"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              aiq lets you use a single CLI command to auto-label text data with
              a language model API &amp;amp; train an efficient classifier on
              the labels. Training and inference are super fast (both run on
              CPU).
            </div>
          </section>
        </section>
        <section id="41604262">
          <h3>
            <a class="item" href="https://container-desktop.com/"
              >Show HN: Container Desktop – Podman Desktop Companion</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 18:08:22</span
              ><span class="points-container"
                >Points: <span class="points">334</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41604262"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41604042">
          <h3>
            <a class="item" href="https://www.inngest.com/"
              >Show HN: Inngest 1.0 – Open-source durable workflows on every
              platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 17:33:15</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41604042"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
            <div class="text">
              <a href="https://inngest.com/">https://inngest.com/</a>)
              <p>
                Inngest is an open-source durable workflow platform that works
                on any cloud. Durable workflows are stateful, long running step
                functions written in code, which automatically retry on failure.
                It abstracts everything about queues, event streams and state
                for you, letting you focus on code. Some examples of uses:
                managing stateful AI chained step functions; managing search/rag
                indexes and data pipelines; integrations and webhooks; billing
                and payment flows.
              </p>
              <p>
                Technical details: unlike other solutions, we put lots of effort
                into designing our SDK’s step.run APIs to make them extremely
                easy to use — developer experience is the most important thing
                for us.
              </p>
              <p>
                We had to design and build our own queueing system to work with
                multi-tenancy, batching, and debouncing, and we’re iterating on
                this as we move to FoundationDB. It’s largely all Go in the
                backend, with a bunch of caching, clickhouse, event streams, and
                coordination on our behalf. Workers are shared nothing, and run
                based off of the queue and execution state.
              </p>
              <p>
                We did a post last year as we iterated on our TS SDK. The
                product has changed a lot since then and wanted to show the
                community what’s changed as we reach 1.0:
              </p>
              <p></p>
              <pre><code>    * Golang, Java, and Python SDKs with cross-language function invocation (across clouds, too)

    * Multi-tenant aware flow control (concurrency, throttling, debounce)

    * Batching, grouping many events into a single function call

    * Much improved dashboard, with tracing and metrics built in

    * Advanced recovery tools like function replay, temporary pausing,  bulk cancellation (with optional expressions).  No more dead letter queues!

    * Branch deploys built in, with staging env support out of the box

    * Full local testing with production parity

</code></pre>
              There's a ton on the roadmap, with more launching next week. We’re
              hiring systems &amp; infra engineers, too — it’s a fun job with
              lots of challenges!
              <p>
                Wanted to say thank you to the HN community for feedback so far!
                Happy Friday :)
              </p>
            </div>
          </section>
        </section>
        <section id="41603955">
          <h3>
            <a
              class="item"
              href="https://pierre-couy.dev/simulations/2024/09/gray-scott-shader.html"
              >Mitosis in the Gray-Scott model: writing shader-based chemical
              simulations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 17:22:06</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41603955"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41603865">
          <h3>
            <a class="item" href="https://any-skin.github.io"
              >Show HN: Put this touch sensor on a robot and learn super precise
              tasks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 17:11:48</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41603865"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
            <div class="text">
              <p>
                Our most exciting result: Learned visuotactile policies for
                precise tasks like inserting USBs and credit card swiping, that
                work out-of-the-box when you replace skins! To the best of our
                knowledge, this has never been shown before with any existing
                tactile sensor.
              </p>
              <p>
                Why is this important? For the first time, you could now collect
                data and train models on one sensor and expect them to
                generalize to new copies of the sensor -- opening the door to
                the kind of large foundation models that have revolutionized
                vision and language reasoning.
              </p>
              <p>
                Would love to hear the community's questions, thoughts and
                comments!
              </p>
            </div>
          </section>
        </section>
        <section id="41603546">
          <h3>
            <a class="item" href="https://github.com/lds133/weather_landscape"
              >Visualizing Weather Forecasts Through Landscape Imagery</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 16:31:00</span
              ><span class="points-container"
                >Points: <span class="points">420</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41603546"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41602474">
          <h3>
            <a class="item" href="https://github.com/qhjqhj00/MemoRAG"
              >MemoRAG – Enhance RAG with memory-based knowledge discovery for
              long contexts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 14:41:16</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41602474"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41602056">
          <h3>
            <a
              class="item"
              href="https://taylor.town/reactive-relational-algebra"
              >Reactive Relational Algebra</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 13:54:41</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41602056"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41601730">
          <h3>
            <a class="item" href="https://github.com/cupy/cupy"
              >CuPy: NumPy and SciPy for GPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 13:18:06</span
              ><span class="points-container"
                >Points: <span class="points">309</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41601730"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41601347">
          <h3>
            <a class="item" href="https://xn--treo-l3a.nz/"
              >Tō Reo – A Māori Spellchecker</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 12:30:11</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41601347"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41600756">
          <h3>
            <a
              class="item"
              href="https://dmitry.gr/?r=05.Projects&amp;proj=35.%20Linux4004"
              >Linux/4004: booting Linux on Intel 4004 for fun, art, and no
              profit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 11:04:15</span
              ><span class="points-container"
                >Points: <span class="points">455</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41600756"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41600179">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2409.12917"
              >Training Language Models to Self-Correct via Reinforcement
              Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 09:19:40</span
              ><span class="points-container"
                >Points: <span class="points">201</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41600179"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41600177">
          <h3>
            <a class="item" href="https://github.com/commaai/openpilot"
              >Openpilot – Operating system for robotics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 09:19:00</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41600177"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41598119">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/news/contextual-retrieval"
              >Contextual Retrieval</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 01:57:22</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41598119"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41597250">
          <h3>
            <a class="item" href="https://kibty.town/blog/arc/"
              >Gaining access to anyones Arc browser without them even visiting
              a website</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 23:04:42</span
              ><span class="points-container"
                >Points: <span class="points">1204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41597250"
                  >Comments</a
                ><span class="descendants">: 417</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41584141">
          <h3>
            <a
              class="item"
              href="https://venturebeat.com/games/sarah-andersen-comics-launches-sarahs-scribbles-hidden-art-game/"
              >Infinite zoom art turned into a game so fun</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-18 @ 19:08:19</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41584141"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41579591">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/09/18/open_source_maintainers_underpaid/"
              >Open source maintainers underpaid, swamped by security, and going
              gray</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-18 @ 13:39:44</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41579591"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41578274">
          <h3>
            <a class="item" href="https://github.com/Telemaco019/kubesafe"
              >Kubesafe: Never run Kubernetes commands on the wrong cluster
              again</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-18 @ 11:17:13</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41578274"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41569292">
          <h3>
            <a
              class="item"
              href="https://www.newscientist.com/article/2448049-cold-war-spy-satellites-and-ai-detect-ancient-underground-aqueducts/"
              >Cold war spy satellites and AI detect ancient underground
              aqueducts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 16:20:09</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41569292"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
