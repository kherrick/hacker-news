<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37910297">
          <h3>
            <a
              class="item"
              href="https://www.sligocki.com//2023/10/16/bb-3-3-is-hard.html"
              >BB(3, 3) is Hard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 03:41:07</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37910297"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37910148">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2023-10-10/hamas-outmaneuvered-israel-s-surveillance-prowess-by-going-dark"
              >Hamas Got Around Israel's Surveillance Prowess by Going Dark</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 03:17:39</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37910148"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37909433">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41589-023-01448-6"
              >Antibiotic Identified by AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 01:52:30</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37909433"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37908973">
          <h3>
            <a
              class="item"
              href="https://www.esa.int/Applications/Observing_the_Earth/Copernicus/Sentinel-1/Antarctic_ice_shelf_demise"
              >Antarctic Ice Shelf Demise</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 01:08:09</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37908973"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37908837">
          <h3>
            <a
              class="item"
              href="https://www.cbsnews.com/news/rite-aid-bankruptcy-opioids-lawsuits/"
              >Rite Aid Files for Bankruptcy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 00:52:08</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37908837"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37908760">
          <h3>
            <a class="item" href="https://astral.sh/blog/ruff-v0.1.0"
              >Ruff v0.1.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 00:43:54</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37908760"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37908655">
          <h3>
            <a class="item" href="https://rachelbythebay.com/w/2023/10/16/env/"
              >Getaddrinfo() on glibc calls getenv(), oh boy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 00:34:07</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37908655"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37908326">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-10-nasa-webb-captures-ethereal-view.html"
              >NASA's Webb captures an ethereal view of NGC 346</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 23:58:08</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37908326"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37908268">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/united-states/2023/10/05/detroit-wants-to-be-the-first-big-american-city-to-tax-land-value"
              >Detroit wants to be the first big American city to tax land
              value</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 23:51:24</span
              ><span class="points-container"
                >Points: <span class="points">237</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37908268"
                  >Comments</a
                ><span class="descendants">: 475</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37908055">
          <h3>
            <a class="item" href="https://skyview.social/"
              >Skyvew – View and share Bluesky threads without needing a Bluesky
              account</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 23:24:06</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37908055"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37907901">
          <h3>
            <a class="item" href="https://bitvm.org/bitvm.pdf"
              >BitVM: Compute Anything on Bitcoin [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 23:04:40</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37907901"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37907433">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37907433"
              >Ask HN: 20% of LinkedIn's recent layoffs were managers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 22:16:41</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37907433"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
            <div class="text">
              1 in 5 of those laid off were managers. Someone correct me if I’m
              wrong, but that’s higher than the typical ratio, correct?
            </div>
          </section>
        </section>
        <section id="37906601">
          <h3>
            <a class="item" href="https://onesignal.com/careers/4264311006"
              >OneSignal (YC S11) Is Hiring Software Engineers in the US</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 21:03:32</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37905638">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/10/16/23919551/bandcamp-layoffs-epic-songtradr"
              >About half of Bandcamp employees have been laid off</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 20:01:26</span
              ><span class="points-container"
                >Points: <span class="points">418</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37905638"
                  >Comments</a
                ><span class="descendants">: 458</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37905601">
          <h3>
            <a class="item" href="https://guanjunwu.github.io/4dgs/"
              >4D Gaussian Splatting for Real-Time Dynamic Scene Rendering</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 19:59:35</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37905601"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37903600">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Cecilia_Payne-Gaposchkin"
              >Cecilia Payne-Gaposchkin</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 17:56:34</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37903600"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37903489">
          <h3>
            <a class="item" href="https://paulstamatiou.com/stocketa/"
              >Stocketa – An app I designed, built and never launched</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 17:46:44</span
              ><span class="points-container"
                >Points: <span class="points">199</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37903489"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37903120">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-mathematician-who-shaped-string-theory-20231016/"
              >The Mathematician Who Sculpted the Shape of Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 17:22:21</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37903120"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37902679">
          <h3>
            <a class="item" href="https://napflix.tv/"
              >Napflix – Siesta Video Platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 16:52:57</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37902679"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37901902">
          <h3>
            <a class="item" href="https://github.com/cpacker/MemGPT"
              >MemGPT – LLMs with self-editing memory for unbounded context</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 16:07:56</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37901902"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37901120">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37901120"
              >Launch HN: Radical (YC W23) – Autonomous high-altitude solar
              aircraft</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 15:23:57</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37901120"
                  >Comments</a
                ><span class="descendants">: 174</span></span
              >
            </h4>
            <div class="text">
              <a href="https://youtu.be/E6oDxQYEksc"
                >https://youtu.be/E6oDxQYEksc</a
              >
              (edit—warning, there are rapidly flashing lights starting just
              after 1m, in case you're sensitive to that). Our website is at
              <a href="https://www.radicalaero.com/"
                >https://www.radicalaero.com/</a
              >, but it's pretty bare. If you use LinkedIn, we have a few more
              posts at
              <a href="https://www.linkedin.com/company/radicalaero"
                >https://www.linkedin.com/company/radicalaero</a
              >.
              <p>
                Our aircraft is designed to fly over specific areas for months,
                carrying various payloads for tasks like imagery, sensing, and
                telecommunications. What we’re building behaves like a drone in
                some ways, and like a satellite in other ways. Much like
                satellites, we’re able to provide service for long periods of
                time, but we’re also much closer to users (we fly at around 20
                km altitude) and able to maneuver or remain over an area of
                interest. This makes what we’re building really well suited to
                applications that require continuous coverage or
                high-resolution/bandwidth data.
              </p>
              <p>
                Examples of this include continuous real-time monitoring (such
                as in wildfire management or illegal fishing), high-resolution
                mapping and imagery (we’re able to collect sub-10 cm resolution
                imagery), and high-speed direct-to-device internet. The ability
                to permanently host sensors and devices in the sky in this way
                opens the door to lots of new opportunities. In truth, we still
                don’t know all the new applications that will arise from this
                (we’re really interested to hear your thoughts on potential
                applications!).
              </p>
              <p>
                As for the technical details: Our aircraft is battery electric
                and driven by propellers. It has a large wing for high
                aerodynamic efficiency and to generate the necessary lift
                required to fly in the thin air of the stratosphere. The wing is
                covered in solar cells, during the day, these power the aircraft
                and charge its batteries. Through the night, battery energy is
                deployed to continue flight. We repeat this process daily,
                enabling us to fly for up to a year without needing to land.
                Ultimately, battery cycle life is what limits our aircraft’s
                flight endurance - and we can land, carry out simple maintenance
                tasks and then re-launch to continue flying. Our aircraft has
                multiple tails which help to stabilize the ultra-lightweight
                structure (our 20 ft. prototype weighs just 13 lbs.). We also
                use these tails to control the aircraft, they provide roll
                control by twisting the main wing of the aircraft, increasing or
                decreasing lift as needed.
              </p>
              <p>
                The aircraft is fully autonomous; it has a full autopilot system
                onboard and various sensors for position, airspeed, and other
                key data streams (much like a typical drone or UAS). The
                aircraft flies at high altitudes of around 70,000 ft. (20 km)
                avoiding cloud cover, civil air traffic, and the turbulent winds
                of the troposphere.
              </p>
              <p>
                Long endurance flight has been the goal of many past projects.
                NASA’s Helios and the DARPA Vulture program tried to develop
                long endurance aircraft. Helios’s crash led to an overhaul of
                aircraft structural analysis codes, and DARPA Vulture led to
                advancements in battery and solar tech. More recently, both
                Facebook’s Aquila and Google’s Loon were discontinued. Recent
                advancements in battery and solar tech, and miniaturization of
                electronics mean long endurance flight is now feasible - but we
                are aware we need to do things differently to succeed. Unlike
                those before us, we’re not tying ourselves to a single
                application and are focused on bringing a cost-effective
                solution to market. That means avoiding research-grade
                components and moving quickly. Additionally, we firmly believe
                that iterating to a solution will allow us to continue making
                progress where others have stalled and lost momentum. We’ve seen
                this before in hard tech where companies like SpaceX and Helion
                Energy have made rapid progress against difficult problems.
              </p>
              <p>
                We approach our technology with an iterative design philosophy -
                we’ll keep building and learning as we go. We use-off-the-shelf
                components, iterate quickly, and design for easy assembly to
                keep costs low. For example, from clean sheet to flight, we
                designed, built, and flew our 20 ft. aircraft in less than two
                months. After our first flights, we prepared our 24-hour-capable
                prototype in two weeks, which successfully completed its
                non-stop 24-hour flight on first launch. Having proved our core
                technologies at a smaller scale, we’re now moving onto bigger
                things. Our next goal is to fly a full-scale 110 ft. wingspan
                aircraft in the stratosphere next year!
              </p>
              <p>
                Both of us have Masters degrees in Aerospace Engineering and we
                then spent 6 years working together on delivery drones at Amazon
                Prime Air. Whilst the application is very different - we’ve
                found our knowledge of drone and robotics hardware to be
                invaluable so far with Radical. By using readily available
                components, learning through iteration, and designing an
                aircraft that is easy to assemble, we can keep the cost of our
                aircraft low and address many markets that weren’t feasible
                before.
              </p>
              <p>
                We’re really excited about the technology we’re developing, it's
                a challenging physics problem that pushes the boundaries of what
                is possible. Super excited to share this with you and to hear
                your thoughts and comments!
              </p>
            </div>
          </section>
        </section>
        <section id="37900713">
          <h3>
            <a
              class="item"
              href="https://statmodeling.stat.columbia.edu/2023/10/16/a-successful-example-of-adversarial-collaboration-when-does-this-approach-work-and-when-does-it-not/"
              >A successful example of "adversarial collaboration"</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 14:57:12</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37900713"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37900458">
          <h3>
            <a class="item" href="https://invidious.io/"
              >Invidious – An open source alternative front-end to YouTube</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 14:38:36</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37900458"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37899993">
          <h3>
            <a
              class="item"
              href="https://a16z.com/the-techno-optimist-manifesto/"
              >The Techno-Optimist Manifesto</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 13:59:25</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37899993"
                  >Comments</a
                ><span class="descendants">: 233</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37897289">
          <h3>
            <a
              class="item"
              href="https://cprimozic.net/blog/wrapping-meshes-with-geodesic-walks/"
              >Wrapping Meshes with Geodesic Walks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 09:00:19</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37897289"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37897155">
          <h3>
            <a class="item" href="https://www.bunniestudios.com/blog/?cat=28"
              >Can we build trustable hardware? (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 08:41:22</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37897155"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37896416">
          <h3>
            <a
              class="item"
              href="https://github.com/mgarciaisaia/JavaScript-Is-Weird-as-a-compressor"
              >JavaScript Is Weird as a Compressor</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 06:17:56</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37896416"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37896151">
          <h3>
            <a
              class="item"
              href="https://www.damninteresting.com/89-263-201-500-337-480/"
              >89, 263, 201: A set of three encrypted notes from the nineteenth
              century (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 05:16:22</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37896151"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37888034">
          <h3>
            <a
              class="item"
              href="https://pharr.org/matt/blog/2018/04/18/ispc-origins"
              >Ispc: Origins (Part 1)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 08:33:59</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37888034"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37887058">
          <h3>
            <a class="item" href="https://www.usbmadesimple.co.uk/"
              >USB Made Simple (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 05:12:39</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37887058"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
