<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38226030">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38226030"
              >Ask HN: Is anyone else bearish on OpenAI?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 23:39:58</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38226030"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
            <div class="text">
              <p>
                This feels a lot like crypto where everyone is very excited
                about a new technology that very few people really understand,
                and are jumping on the bandwagon without asking any questions.
              </p>
              <p>
                It's also very much like crypto where for every one person doing
                something useful with it, there are 20 trying to exploit the
                newness and low comprehension the general public have of the
                tech such as:
              </p>
              <p></p>
              <pre><code>    - Trying to cash out on a ChatGPT wrapper company

    - Creating the nth "AI powered custom chat bot but for x vertical"

    - Using it to cheat on school assignments or interviews

    - Gluing together as many different "AI" services as possible to create a no touch business and sell low effort products
</code></pre>
              I'm not saying the company will go bankrupt but I'm also not
              buying into the hype that it's going to become the next Google or
              better / create AGI for us all.
              <p>What am I missing here?</p>
            </div>
          </section>
        </section>
        <section id="38225019">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2023/nov/10/iceland-declares-state-of-emergency-over-volcanic-eruption-threat"
              >Iceland declares state of emergency over volcanic eruption
              threat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 21:51:15</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38225019"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38224950">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2023/11/apple-discriminated-against-us-citizens-in-hiring-doj-says/"
              >Apple discriminated against US citizens in hiring, DOJ says</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 21:45:38</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38224950"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38224810">
          <h3>
            <a
              class="item"
              href="https://www.straitstimes.com/world/united-states/how-to-kidnap-339000-in-rare-japanese-kitkats"
              >The hijacking of rare Japanese KitKats</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 21:30:33</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38224810"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38224245">
          <h3>
            <a class="item" href="https://www.jeffwofford.com/?p=2089"
              >How to boss without being bossy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 20:42:09</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38224245"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38224217">
          <h3>
            <a
              class="item"
              href="https://9to5mac.com/2023/11/10/amazon-apple-special-deal-online-storefront/"
              >Amazon gives Apple 'massive preferential treatment' in secret
              deal report claims</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 20:39:33</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38224217"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38224117">
          <h3>
            <a class="item" href="https://permapeople.org/"
              >Discover plants, swap seeds, plan gardens, share knowledge</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 20:31:47</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38224117"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38223857">
          <h3>
            <a
              class="item"
              href="https://www.thisiscolossal.com/2017/07/the-ornate-bird-palaces-of-ottoman-era-turkey/"
              >Ottoman-Era Bird Palaces</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 20:08:32</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38223857"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38223822">
          <h3>
            <a
              class="item"
              href="https://twitter.com/krea_ai/status/1723067313392320607"
              >Real-time image editing using latent consistency models</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 20:06:08</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38223822"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38223771">
          <h3>
            <a
              class="item"
              href="https://www.tonymottaz.com/code-for-computers-and-humans/"
              >Writing code for both computers and humans</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 20:02:06</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38223771"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38223660">
          <h3>
            <a
              class="item"
              href="https://www.cbc.ca/news/science/echidna-video-1.7024966"
              >Rare egg-laying mammal (echidna) rediscovered in Indonesia</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 19:53:28</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38223660"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38222909">
          <h3>
            <a class="item" href="https://www.unixtimestamp.com/"
              >The Unix timestamp will begin with 17 this Tuesday</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 18:54:54</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38222909"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38222900">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Eltanin_Antenna"
              >Eltanin Antenna</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 18:54:33</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38222900"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38222277">
          <h3>
            <a
              class="item"
              href="https://cloud.google.com/blog/products/compute/the-worlds-largest-distributed-llm-training-job-on-tpu-v5e"
              >Google Cloud TPU Multislice Training</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 18:08:34</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38222277"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38221709">
          <h3>
            <a class="item" href="https://protege.stanford.edu/"
              >Protégé: A free, open-source ontology editor for building
              intelligent systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 17:29:05</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38221709"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38221552">
          <h3>
            <a class="item" href="https://www.builder.io/blog/build-ai"
              >Don't build AI products the way everyone else is doing it</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 17:20:08</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38221552"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38221379">
          <h3>
            <a
              class="item"
              href="https://github.com/githubnext/monaspace/blob/main/docs/Texture%20Healing.md"
              >Texture Healing for Monospace Fonts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 17:07:31</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38221379"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38221157">
          <h3>
            <a
              class="item"
              href="https://appleinsider.com/articles/19/11/10/how-steve-jobs-saved-apple-with-the-online-apple-store"
              >How Steve Jobs Saved Apple with the Online Apple Store</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 16:52:24</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38221157"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38220892">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2023-10-25/new-york-restaurants-bars-fight-back-against-reservations-by-bots"
              >New York restaurants fight back against reservations by bots</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 16:33:39</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38220892"
                  >Comments</a
                ><span class="descendants">: 164</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38220607">
          <h3>
            <a class="item" href="https://bernsteinbear.com/blog/ddcg/"
              >A quick look at destination-driven code generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 16:12:18</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38220607"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38220288">
          <h3>
            <a
              class="item"
              href="https://www.helen.fi/en/news/2021/gigantic-heat-caverns-in-mustikkamaa-filled"
              >Gigantic heat caverns in Mustikkamaa have now been filled with
              water (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 15:46:38</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38220288"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38219998">
          <h3>
            <a
              class="item"
              href="https://spacenorway.no/en/what-we-do/operational-infrastructure/the-svalbard-fibre-optic-cable-connection/"
              >The Svalbard fibre optic cable connection</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 15:26:11</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38219998"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38218667">
          <h3>
            <a
              class="item"
              href="https://blog.nordicsemi.com/getconnected/why-nordic-is-getting-involved-in-risc-v"
              >Nordic is getting involved in RISC-V</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 13:42:21</span
              ><span class="points-container"
                >Points: <span class="points">282</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38218667"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38218520">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/lago/jobs/z7tQqkS-data-scientist"
              >Lago – Open-source Stripe Billing alternative – is hiring a Data
              Scientist</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 13:28:46</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38218329">
          <h3>
            <a class="item" href="https://www.automa.site/"
              >Automa – Automate the browser by connecting blocks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 13:05:40</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38218329"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38217355">
          <h3>
            <a
              class="item"
              href="https://mullvad.net/en/blog/moving-our-encrypted-dns-servers-to-run-in-ram"
              >Moving our Encrypted DNS servers to run in RAM</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 10:51:48</span
              ><span class="points-container"
                >Points: <span class="points">307</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38217355"
                  >Comments</a
                ><span class="descendants">: 118</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38216556">
          <h3>
            <a
              class="item"
              href="https://mostlynerdless.de/blog/tag/lets-create-a-debugger-together/"
              >Let's create a Python Debugger together</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 08:40:25</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38216556"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38216503">
          <h3>
            <a
              class="item"
              href="https://sidecart.xyz/blog/2023/11/01/lessons-learned-by-software-guy-venturing-into-hardware/"
              >Lessons learned by a software guy venturing into hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 08:30:18</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38216503"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38216400">
          <h3>
            <a
              class="item"
              href="https://flak.tedunangst.com/post/write-your-own-terminal"
              >Write Your Own Terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 08:15:26</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38216400"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38213600">
          <h3>
            <a
              class="item"
              href="https://whyy.org/segments/father-of-cell-phone-reflects-on-making-first-call-and-history-50-years-ago/"
              >'Father of cell phone' reflects on making first call and history
              50 years ago</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-10 @ 01:02:43</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38213600"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
