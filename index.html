<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42267725">
          <h3>
            <a
              class="item"
              href="https://interactionmagic.com/UX-LEGO-Interfaces/"
              >The UX of Lego Interface Panels (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 19:00:47</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42267725"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42265817">
          <h3>
            <a class="item" href="https://pkg.go.dev/modernc.org/tk9.0"
              >Tk9.0: CGo-free, cross platform GUI toolkit for Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 15:18:57</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42265817"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42265533">
          <h3>
            <a
              class="item"
              href="https://121gigawatts.org/copper-sushi-power-flow-european-grid/"
              >A Pretty Visualisation of the European Power Grid (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 14:33:44</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42265533"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42264586">
          <h3>
            <a
              class="item"
              href="https://nautil.us/the-new-climate-math-on-hurricanes-1164220/"
              >The New Climate Math on Hurricanes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 11:56:51</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42264586"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42264345">
          <h3>
            <a
              class="item"
              href="https://www.welivesecurity.com/en/eset-research/bootkitty-analyzing-first-uefi-bootkit-linux/"
              >Bootkitty: Analyzing the first UEFI bootkit for Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 11:02:45</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42264345"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42264344">
          <h3>
            <a class="item" href="https://www.myphotos.site"
              >Show HN: Myphotos.site – Make a gallery website from Google
              Photos</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 11:02:17</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42264344"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
            <div class="text">
              <p>
                That's why we built myphotos.site - a micro SaaS that allows
                anyone to create a slick, minimal gallery website from Google
                Photos. Galleries can be iframe-embedded for those looking for
                full customization.
              </p>
              <p>
                One thing we haven't solved yet - many Google Photos users
                (myself included) do not have images pre-organized in albums, so
                the fact that <i>technically</i> it takes 60 seconds to build a
                website doesn't take into account that you have to spend time
                picking the right images.
              </p>
              <p>
                Would love to some feedback/ideas from hobbyist photographers
                here!
              </p>
            </div>
          </section>
        </section>
        <section id="42263834">
          <h3>
            <a
              class="item"
              href="https://lithub.com/in-praise-of-print-why-reading-remains-essential-in-an-era-of-epistemological-collapse/"
              >In Praise of Print: Reading Is Essential in an Era of
              Epistemological Collapse</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 09:23:01</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42263834"
                  >Comments</a
                ><span class="descendants">: 218</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42263383">
          <h3>
            <a class="item" href="https://github.com/mistweaverco/bananas"
              >Bananas: Cross-Platform screen sharing made simple</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 07:49:54</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42263383"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42263239">
          <h3>
            <a class="item" href="https://aikiwiki.com/"
              >Conversational Game Theory</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 07:23:23</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42263239"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42262308">
          <h3>
            <a class="item" href="https://proot-me.github.io/"
              >PRoot: User-space implementation of chroot, mount –bind, and
              binfmt_misc</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 03:58:49</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42262308"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42261909">
          <h3>
            <a class="item" href="https://github.com/abus-aikorea/voice-pro"
              >Show HN: Voice-Pro – AI Voice Cloning Magic: Transform Any Voice
              in 15 Seconds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-28 @ 02:37:01</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42261909"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
            <div class="text">
              <p>What sounds like science fiction is now reality.</p>
              <p>
                Voice-Pro is an open-source Gradio WebUI that breaks the
                boundaries of audio manipulation.
              </p>
              <p>
                Powered by cutting-edge Whisper engines, this tool turns voice
                replication into child's play.
              </p>
              <p>Key Features:</p>
              <p>- Zero-shot Voice Cloning</p>
              <p>- Voice Changer with 50+ Celebrity Voices</p>
              <p>- YouTube Audio Downloading</p>
              <p>- Vocal Isolation</p>
              <p>- Multi-Language Text-to-Speech (Edge-TTS, F5-TTS)</p>
              <p>- Multi-Language Translation</p>
              <p>
                - Powered by Whisper Engines (Whisper, Faster-Whisper,
                Whisper-Timestamped)
              </p>
              <p>Video Demos:</p>
              <p>
                1. Voice-Pro Usage Tutorial:
                <a href="https://youtu.be/z8g8LMhoh_o"
                  >https://youtu.be/z8g8LMhoh_o</a
                >
              </p>
              <p>
                2. Voice Cloning Celebrity Podcast Demo:
                <a href="https://youtu.be/Wfo7vQCD4no"
                  >https://youtu.be/Wfo7vQCD4no</a
                >
              </p>
              <p>
                3. Full Demo Playlist:
                <a
                  href="https://www.youtube.com/playlist?list=PLwx5dnMDVC9Y7dAjm9r26CZUw1uU5VIeq"
                  >https://www.youtube.com/playlist?list=PLwx5dnMDVC9Y7dAjm9r26...</a
                >
              </p>
              <p>
                Whether you're a content creator, developer, or audio experiment
                enthusiast,
              </p>
              <p>
                Voice-Pro provides a user-friendly interface to push the
                boundaries of audio manipulation.
              </p>
              <p>
                GitHub:
                <a href="https://github.com/abus-aikorea/voice-pro"
                  >https://github.com/abus-aikorea/voice-pro</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42261053">
          <h3>
            <a
              class="item"
              href="https://www.sheldonbrown.com/AluminumBikeProject.html"
              >MIT Aluminum Bicycle Project 1974 (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 23:59:38</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42261053"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42260364">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/semiconductor-fabrication"
              >The Forgotten Story of How IBM Invented the Automated Fab</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 22:18:58</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42260364"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42260030">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2411.16544"
              >Float Self-Tagging</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 21:36:52</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42260030"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42260027">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/news/articles/cje050wz22qo"
              >London's 850-year-old food markets to close</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 21:36:38</span
              ><span class="points-container"
                >Points: <span class="points">202</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42260027"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42260017">
          <h3>
            <a
              class="item"
              href="https://www.ftm.nl/artikelen/ruzie-tussen-ziekenhuis-en-farma-industrie-over-goedkeuring-kankermedicijn"
              >Developing a cancer drug without Big Pharma: this hospital shows
              it can be done</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 21:35:49</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42260017"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42259547">
          <h3>
            <a
              class="item"
              href="https://tratt.net/laurie/blog/2024/structured_editing_and_incremental_parsing.html"
              >Structured Editing and Incremental Parsing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 20:42:52</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42259547"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42259283">
          <h3>
            <a class="item" href="https://github.com/matomo-org/device-detector"
              >Device-detector: Universal Device Detection library from User
              Agent</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 20:11:21</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42259283"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42259278">
          <h3>
            <a class="item" href="https://github.com/xairy/lights-out"
              >Malware can turn off webcam LED and record video, demonstrated on
              ThinkPad X230</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 20:10:55</span
              ><span class="points-container"
                >Points: <span class="points">924</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42259278"
                  >Comments</a
                ><span class="descendants">: 484</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42258540">
          <h3>
            <a class="item" href="https://www.lukasmoro.com/paper"
              >Show HN: Feels Like Paper</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 18:43:04</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42258540"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
            <div class="text">
              "Feels Like Paper!" is a series of prototypes about augmenting
              physical paper through AI. Various ML models, LLMs and a mixed
              reality headset are used to infuse physical paper and ink with
              properties of the digital world without compromising on their
              physical traits.
            </div>
          </section>
        </section>
        <section id="42258103">
          <h3>
            <a class="item" href="https://bernsteinbear.com/blog/creduce/"
              >You can use C-Reduce for any language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 17:56:24</span
              ><span class="points-container"
                >Points: <span class="points">426</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42258103"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42256104">
          <h3>
            <a class="item" href="https://github.com/bjesus/teatime"
              >Show HN: TeaTime – distributed book library powered by SQLite,
              IPFS and GitHub</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 13:56:20</span
              ><span class="points-container"
                >Points: <span class="points">276</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42256104"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
            <div class="text">
              <p>
                A couple of years ago I was intrigued by phiresky's post[0]
                about querying SQLite over HTTP. It made me think that if anyone
                can publish a database using GitHub Pages, I could probably
                build a frontend in which users can decide which database to
                query. TeaTime is like that - when you first visit it, you'll
                need to choose your database. Everyone can create additional
                databases[1]. TeaTime then queries it, and fetches files using
                an IPFS gateway (I'm looking into using Helia so that users are
                also contributing nodes in the network). Files are then rendered
                in the website itself. Everything is done in the browser - no
                users, no cookies, no tracking. LocalStorage and IndexedDB are
                used for saving your last readings, and your position in each
                file.
              </p>
              <p>
                Since TeaTime is a static site, it's super easy (and free) to
                deploy. GitHub repo tags are used for maintaining a list of
                public instances[2].
              </p>
              <p>
                Note that a GitHub repository isn't mandatory for storing the
                SQLite files or the front end - it's only for the configuration
                file (config.json) of each database, and for listing instances.
                Both the instances themselves and the database files can be
                hosted on Netlify, Cloudflare Pages, your Raspberry Pi, or any
                other server that can host static files.
              </p>
              <p>
                I'm curious to see what other kinds of databases people can
                create, and what other types of files TeaTime could be used for.
              </p>
              <p>
                [0]
                <a href="https://news.ycombinator.com/item?id=27016630"
                  >https://news.ycombinator.com/item?id=27016630</a
                >
              </p>
              <p>
                [1]
                <a href="https://github.com/bjesus/teatime-json-database/"
                  >https://github.com/bjesus/teatime-json-database/</a
                >
              </p>
              <p>
                [2]
                <a
                  href="https://github.com/bjesus/teatime/wiki/Creating-a-TeaTime-instance"
                  >https://github.com/bjesus/teatime/wiki/Creating-a-TeaTime-in...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42254156">
          <h3>
            <a
              class="item"
              href="https://play.google.com/store/apps/details?id=com.actureunlock&amp;hl=en_US"
              >Show HN: App that asks ‘why?’ every time you unlock your phone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 08:34:35</span
              ><span class="points-container"
                >Points: <span class="points">747</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42254156"
                  >Comments</a
                ><span class="descendants">: 352</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42238730">
          <h3>
            <a
              class="item"
              href="https://newsreleases.sandia.gov/phone_signals/"
              >Study asks: Can cell phone signals help land a plane?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-25 @ 18:31:20</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42238730"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42236903">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/lifeandstyle/2024/nov/25/new-start-after-60-hummingbird-for-people-with-dementia-volunteering-care-home"
              >A new start after 60: I became a 'hummingbird' for people with
              dementia</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-25 @ 15:10:09</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42236903"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42224815">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/11/19/science/peru-glaciers-water-pollution.html"
              >Where Glaciers Melt, the Rivers Run Red</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-23 @ 23:49:51</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42224815"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42220371">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-cosmos-teems-with-complex-organic-molecules-20241113/"
              >The Cosmos Teems with Complex Organic Molecules</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-23 @ 11:25:38</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42220371"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42212745">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-11-shallow-sports-deep-social-hierarchies.html"
              >Shallow sports and deep social hierarchies: pecking orders aren't
              equal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-22 @ 10:49:31</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42212745"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42212134">
          <h3>
            <a
              class="item"
              href="https://3e8.org/pub/scheme/doc/lisp-pointers/v8i2/p15-tomoyuki.pdf"
              >Futures and Multiple Values in Parallel Lisp (1991) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-22 @ 08:34:44</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42212134"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42194025">
          <h3>
            <a class="item" href="https://spatialpixel.com/"
              >Spatial Pixel: a new kind of social computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 14:05:43</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42194025"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
