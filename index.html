<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36265774">
          <h3>
            <a
              class="item"
              href="https://worldspiritsockpuppet.com/2023/01/10/we-dont-trade-with-ants.html"
              >We Don’t Trade with Ants</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 23:32:09</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36265774"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36265771">
          <h3>
            <a
              class="item"
              href="https://gaodawei.wordpress.com/2023/06/08/1973-prc-notes-on-mao-kissinger-meeting-of-february-17-1973/"
              >The Mao-Kissinger Meeting of 1973</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 23:31:56</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36265771"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36265705">
          <h3>
            <a
              class="item"
              href="https://3quarksdaily.com/3quarksdaily/2023/06/a-gallup-through-a-horses-pedigree.html"
              >A Gallop Through a Horse’s Pedigree</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 23:24:25</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36265705"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36265685">
          <h3>
            <a
              class="item"
              href="https://www.newstatesman.com/ideas/2023/06/influence-edmund-burke-national-conservatism-intellectual-jewish"
              >Edmund Burke was a more complicated thinker than realized</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 23:21:55</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36265685"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36265316">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/apple-vision-pro"
              >Wow, Is Apple’s Vision Pro Loaded with Pixels</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 22:45:24</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36265316"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36265245">
          <h3>
            <a class="item" href="https://tech.lgbt/@xogium/110507457689374019"
              >A thread on the deterioration of accessibility in GTK4 and
              Wayland</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 22:39:06</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36265245"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36264744">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/history-of-computer-graphics-industry"
              >The computer graphics industry got started at the university of
              Utah</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 21:57:03</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36264744"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36264429">
          <h3>
            <a
              class="item"
              href="https://sifted.eu/articles/evroc-plan-hyperscale-cloud-news"
              >A Swedish startup’s bid to build a green rival to AWS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 21:32:52</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36264429"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36263975">
          <h3>
            <a class="item" href="https://zirias.github.io/poser/"
              >Show HN: Poser – Posix SERvices C framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 20:48:40</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36263975"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36263686">
          <h3>
            <a
              class="item"
              href="https://blog.daviskedrosky.com/p/jared-diamond-a-reply-to-his-critics"
              >Jared Diamond: A Reply to His Critics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 20:25:58</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36263686"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36263654">
          <h3>
            <a class="item" href="https://www.optoutproject.net/"
              >The Opt Out Project</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 20:23:11</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36263654"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36263349">
          <h3>
            <a
              class="item"
              href="https://writings.stephenwolfram.com/2023/06/introducing-chat-notebooks-integrating-llms-into-the-notebook-paradigm/"
              >Chat Notebooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 20:00:04</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36263349"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36263283">
          <h3>
            <a class="item" href="https://dirt.fyi/article/2023/06/bad-waitress"
              >Bad waitress: Dying on your feet</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 19:54:52</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36263283"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36263105">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/science-and-technology/2023/05/24/artificial-brains-are-helping-scientists-study-the-real-thing"
              >Artificial brains help understand real brains</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 19:43:25</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36263105"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36262821">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36262821"
              >Ask HN: Is it time to resurrect a Usenet clone?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 19:24:52</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36262821"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
            <div class="text">
              <p>
                1. There has to be a movement at both protocol and
                community-level to bring a Usenet like forum for general
                consumption. Different decetralized subgroups hosting and
                replicating the communities for others.
              </p>
              <p>
                2. The model needs to be rethought to ensure that the thoughts
                and knowledge of communities and users belong to them.
              </p>
              <p>
                3. These forums should encourage less anonymity and more
                persistent communication.
              </p>
              <p>
                4. Trustworthy individuals should run these forums, chosen by
                the community. Individual groups, academia, organizations
                running the communities but easily redistributed across to
                people who want it. This was usenet.
              </p>
              <p>
                Failure to address these issues allows mega companies to exploit
                data and control access against users' wishes.
              </p>
              <p>
                Taking action is crucial to prevent unfavorable outcomes and
                hold ourselves accountable.
              </p>
            </div>
          </section>
        </section>
        <section id="36261439">
          <h3>
            <a
              class="item"
              href="https://bigthink.com/strange-maps/comet-portraits/"
              >A 19th century family portrait of comets</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 17:52:56</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36261439"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36261411">
          <h3>
            <a
              class="item"
              href="https://balkaninsight.com/2023/06/09/turkish-citizens-personal-data-offered-online-after-govt-site-hacked/"
              >Turkish citizens' personal data offered online after government
              site hacked</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 17:51:12</span
              ><span class="points-container"
                >Points: <span class="points">223</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36261411"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36260961">
          <h3>
            <a class="item" href="https://github.com/BloopAI/bloop"
              >Show HN: Bloop – Answer questions about your code with an LLM
              agent</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 17:19:12</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36260961"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <a href="https://news.ycombinator.com/item?id=35236275"
                >https://news.ycombinator.com/item?id=35236275</a
              >) and received a huge amount of feedback (both positive +
              constructive). We've undertaken a rewrite of the core search
              framework, which now acts as an LLM agent, significantly improving
              the number of queries that can be successfully answered.
              <p>
                There's a bunch of hype surrounding LLM agents, but we're
                positive this is one of the first implementations of an agent
                that can deliver immediate value for engineers working on
                existing projects, especially larger ones. We'll do a full write
                up of how the agent works and the tools it can use soon, but we
                wanted to share our progress, now that we've got a stable
                release.
              </p>
              <p>
                bloop is a developer assistant that uses GPT-4 to answer
                questions about your codebase. The agent searches both your
                local and remote repositories with natural language, regex and
                filtered queries.
              </p>
              <p>
                Some of the ways engineers use bloop to improve their efficiency
                when working on large codebases:
              </p>
              <p>
                - Summarise how large files work and how multiple files work
                together
              </p>
              <p>
                - Understand how to use open source libraries when documentation
                is lacking
              </p>
              <p>- Identify the origin of errors</p>
              <p>
                - Ask questions about English-language codebases in other
                languages
              </p>
              <p>
                - Reduce code duplication by checking for existing functionality
              </p>
              <p>
                - Write new code, taking into account existing codebase context
                (eg: "write a dockerfile for this project")
              </p>
              <p>
                bloop runs as a free desktop app on Mac, Windows and Linux:
                <a href="https://github.com/bloopAI/bloop/releases/latest"
                  >https://github.com/bloopAI/bloop/releases/latest</a
                >. On desktop, your code is indexed with a MiniLM embedding
                model and stored locally, meaning at index time your codebase
                stays private. 'Private' here means that no code is shared with
                us or OpenAI at index time, and when a search is made only
                relevant code snippets are shared to generate the response.
                (This is more or less the same data usage as Copilot).
              </p>
              <p>
                We also have a paid cloud offering for teams ($45 per user per
                month). Members of the same organisation can search a shared
                index hosted by us and will get access to enterprise only
                features down the line (currently there's no feature gap between
                desktop and cloud).
              </p>
            </div>
          </section>
        </section>
        <section id="36260626">
          <h3>
            <a
              class="item"
              href="https://borretti.me/article/nixos-for-the-impatient"
              >NixOS for the Impatient</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 16:54:03</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36260626"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36260589">
          <h3>
            <a class="item" href="https://desktop.kerahq.com/"
              >Kera Desktop: open-source, cross-platform, web-based desktop
              environment</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 16:52:04</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36260589"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36260586">
          <h3>
            <a
              class="item"
              href="https://bigthink.com/the-well/eastern-philosophy-neuroscience-no-self/"
              >Eastern philosophy says there is no “self” – science agrees</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 16:51:49</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36260586"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36258234">
          <h3>
            <a
              class="item"
              href="https://acoup.blog/2023/06/09/fireside-friday-june-9-2023/"
              >The impact of the ‘long peace’ on modern military capabilities</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 14:23:16</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36258234"
                  >Comments</a
                ><span class="descendants">: 249</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36257963">
          <h3>
            <a class="item" href="https://gitlab.com/OpenMW/openmw"
              >OpenMW: Open-source TES3: Morrowind reimplementation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 14:03:31</span
              ><span class="points-container"
                >Points: <span class="points">290</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36257963"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36257255">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2305.10470"
              >Gravitational Machines</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 13:06:20</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36257255"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36252501">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/the-1970s-librarians-who-revolutionised-the-challenge-of-search"
              >1970s campus librarians foresaw our world of distributed
              knowledge and research</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 02:51:05</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36252501"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36251471">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/how-lossless-data-compression-works-20230531"
              >Data Compression Drives the Internet. Here’s How It Works</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 00:36:08</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36251471"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36248786">
          <h3>
            <a
              class="item"
              href="https://www.elle.com/culture/music/a43846386/meg-white-interview-2023/"
              >Searching for Meg White</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-08 @ 20:50:04</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36248786"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36248081">
          <h3>
            <a
              class="item"
              href="https://www.livescience.com/animals/cats/why-do-cats-knead"
              >Why do cats knead?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-08 @ 20:08:57</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36248081"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36246547">
          <h3>
            <a class="item" href="https://nskyc.com/"
              >Average color of the NYC sky every 5 minutes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-08 @ 18:36:47</span
              ><span class="points-container"
                >Points: <span class="points">487</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36246547"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36240264">
          <h3>
            <a class="item" href="https://subwaysheds.com/">NYC Subwaysheds</a>
          </h3>
          <section>
            <h4>
              <span>2023-06-08 @ 11:46:26</span
              ><span class="points-container"
                >Points: <span class="points">201</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36240264"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
