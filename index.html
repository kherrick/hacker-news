<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40079647">
          <h3>
            <a
              class="item"
              href="https://longreads.com/2024/04/18/crohns-life-without-eating/"
              >Insatiable: A Life Without Eating</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 19:06:42</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40079647"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40079516">
          <h3>
            <a
              class="item"
              href="https://www.museodelprado.es/visita-virtual-coleccion-2023"
              >El Prado Museum in Unprecedented Detail with New 360º Gigapixel
              Virtual Tour</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 18:54:46</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40079516"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40079330">
          <h3>
            <a class="item" href="https://github.com/Eclipse-Community/r3dfox"
              >R3dfox: A fork of Firefox made specifically for Windows 7 and 8
              compatibility</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 18:38:00</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40079330"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40079014">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smithsonian-institution/what-myths-about-the-anthropocene-get-wrong-180984181/"
              >What Myths About the Anthropocene Get Wrong</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 18:08:26</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40079014"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40078430">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/04/18/world-check-database-leaked-sanctions-financial-crimes-watchlist/"
              >Hackers threatening to publish a stolen sanctions and financial
              crimes watchlist</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 17:09:55</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40078430"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40078380">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2024/4/18/24133881/google-android-pixel-teams-reorg-rick-osterloh"
              >Google is combining its Android and hardware teams – and it's all
              about AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 17:04:32</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40078380"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40078340">
          <h3>
            <a class="item" href="https://www.keelinglabs.com"
              >Keeling Labs (YC W23) –RL for Battery Optimization–Is Hiring a
              Senior Data Eng</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 17:01:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40078195">
          <h3>
            <a
              class="item"
              href="https://blog.vapi.ai/show-hn-vapi-try-to-convince-our-voice-ai-to-give-you-the-secret-code/"
              >Show HN: Vapi – Convince our voice AI to give you the secret
              code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 16:50:04</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40078195"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40078106">
          <h3>
            <a
              class="item"
              href="https://www.simplermachines.com/why-you-need-a-wtf-notebook/"
              >You need a "WTF notebook" (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 16:42:04</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40078106"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40077793">
          <h3>
            <a
              class="item"
              href="https://nlnet.nl/news/2024/20240418-BlueHatsPrize1.html"
              >Dnsmasq wins the first BlueHats Prize</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 16:20:00</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40077793"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40077533">
          <h3>
            <a class="item" href="https://llama.meta.com/llama3/"
              >Meta Llama 3</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 15:57:22</span
              ><span class="points-container"
                >Points: <span class="points">1014</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40077533"
                  >Comments</a
                ><span class="descendants">: 435</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40077233">
          <h3>
            <a
              class="item"
              href="https://docs.hatchet.run/blog/multi-tenant-queues"
              >Multi-Tenant Queues in Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 15:26:57</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40077233"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40077048">
          <h3>
            <a class="item" href="https://github.com/nasa/openmct"
              >OpenMCT: A web based mission control framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 15:09:13</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40077048"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40077023">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2404.10102"
              >Chinchilla Scaling: A replication attempt</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 15:05:59</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40077023"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40076848">
          <h3>
            <a
              class="item"
              href="https://github.com/facebookexperimental/hermit"
              >Hermit is a hermetic and reproducible sandbox for running
              programs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 14:46:50</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40076848"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40076345">
          <h3>
            <a class="item" href="https://icode4.coffee/?p=738"
              >Halo 2 in HD: Pushing the Original Xbox to the Limit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 14:01:06</span
              ><span class="points-container"
                >Points: <span class="points">272</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40076345"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40075598">
          <h3>
            <a
              class="item"
              href="https://news.lettersofnote.com/p/my-mother-declared-my-bedroom-a-disaster"
              >My mother declared my bedroom a disaster area (1984)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 12:43:07</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40075598"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40075571">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40075571"
              >Launch HN: Volta Labs (YC W19) – Easier sample prep for
              genomics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 12:40:34</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40075571"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.voltalabs.com">https://www.voltalabs.com</a
              >), a genomics applications company that is using advanced
              electrowetting technology to solve one of the toughest challenges
              facing the genomics industry—scalable sample prep. We’ve built a
              walk-away benchtop sample prep system that comes preloaded with
              apps that require no user programming or optimization, enabling
              labs to maximize resources, scale sample throughput, and reduce
              risks related to manual handling. I filmed a quick video in the
              lab if you want to see what it looks like IRL:
              <a href="https://vimeo.com/935960826/d0efdf3f14"
                >https://vimeo.com/935960826/d0efdf3f14</a
              >.
              <p>
                Sample prep is the process of going from raw biological samples
                to sequenceable molecules. The process typically involves
                isolating nucleic acids from samples like blood/cells, breaking
                up these nucleic acids into small pieces, and adding barcodes at
                a molecular level.
              </p>
              <p>
                Although sequencing technologies have made huge advancements in
                general, sample preparation is largely still done manually and
                remains a bottleneck. Many companies, small and large, have
                attempted to develop solutions that haven’t panned out. A couple
                things make it so challenging:
              </p>
              <p>
                (1) The number of sample types - for humans alone, sample types
                include blood, saliva, various tissue types, buccal swab, etc.
                Each has its own requirements when it comes to handling to
                isolate nucleic acids, and even within each type there are
                significant differences. For example, blood from various donors
                has different cell density.
              </p>
              <p>
                (2) There is a large array of chemistries for different analyses
                and sequencing technologies, and there is a need for flexibility
                in throughputs to process a few samples at a time or run large
                batches.
              </p>
              <p>
                Developing a technology that is flexible enough to work with
                various sample types and chemistries while maintaining quality
                spans many disciplines: fluidic dynamics, thermal engineering,
                molecular biology, material science, mechanical engineering,
                electrical engineering, and software engineering.
              </p>
              <p>
                I didn’t set out to develop a way to automate sample prep. I was
                exploring the use of electrowetting to manipulate colored
                droplets on a circuit board during my research in the MIT Media
                Lab. During one of my demos, there was huge interest from
                biologists at the lab as well as from biotech/pharma sponsors. I
                quickly began to realize that the application of this technology
                and the potential impact it could have was much larger than I
                had anticipated. I immediately got to work studying biology,
                focusing on five broad markets that included DNA sequencing and
                synthetic biology. The opportunity in the well-established DNA
                sequencing market begging for a solution to improve the quality
                of samples, reduce costs and create throughput flexibility led
                me to developing a way to automate sample prep. And here we are
                today, bringing it to market.
              </p>
              <p>
                The Callisto Sample Prep System is a sequencer-agnostic benchtop
                system that enables a push-button, walkaway sample prep
                experience. This enables all labs—labs already using sequencing
                automation, and those new to sequencing—to free up resources and
                not rely on skilled labor to maximize throughput. By automating
                the process end to end, reliably, scientists can focus on other
                aspects of research and development.
              </p>
              <p>
                What exactly does the instrument do? It manipulates little
                droplets on a surface using electric and magnetic fields. These
                droplets contain DNA, RNA, enzymes and other biochemistries, or
                they can be raw samples such as blood, saliva, etc. Once these
                droplets are on the surface, we move, merge, mix and split them
                in various ways. We also incubate these samples to specific
                temperatures on the same surface. We also use traditional
                robotic technologies such as gantry and pipettors for a limited
                set of operations.
              </p>
              <p>
                Our approach has many advantages over existing technologies: it
                allows us to reduce total cost to our customers with less
                plastic waste and reagent usage; it improves quality of samples
                prepared; it provides reliable sample manipulation given the
                electric and magnetic nature of the technology; and it offers
                complete walk-away automation, bringing the push-button
                experience of a sequencer to sample prep.
              </p>
              <p>
                I’m proud to bring a solution to the market that is accessible
                for all labs, especially labs with lower budgets (which are the
                majority). Now small core labs can provide low-cost, competitive
                solutions relative to commercial service providers, and larger
                labs can scale up their processes to make new sequencing
                technologies available to their customers. Individual labs at
                universities can now bring sequencers in-house for
                cost-effective, efficient, and reliable sequencing. So many
                applications, with huge potential impact for consumers!
              </p>
              <p>
                Fewer than 5M humans have so far been exposed directly to
                sequencing technologies, yet sequencing technologies and life
                sciences tool development is what propels the modern world of
                biology. The only other field that has experienced advancements
                faster than sequencing technologies over the past two decades is
                AI, if that gives a basis of comparison for how big this is.
              </p>
              <p>
                This level of sample prep automation is new to genomics, new to
                the world! I’m excited to hear your comments, questions,
                thoughts, ideas - please share your insights and experiences to
                help us realize the full potential of this technology and make a
                tangible impact on science and society. And, go!
              </p>
            </div>
          </section>
        </section>
        <section id="40075539">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/business/retail/amazon-secret-operation-intel-rivals-eb82ea3c"
              >Inside Amazon’s Secret Operation to Gather Intel on Rivals</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 12:35:43</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40075539"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40075402">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/c/24070570/internet-cables-undersea-deep-repair-ships"
              >The invisible seafaring industry that keeps the internet
              afloat</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 12:16:30</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40075402"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40074086">
          <h3>
            <a class="item" href="https://www.andrewt.net/maths/domputer/"
              >The Domino Computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 08:22:04</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40074086"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40071826">
          <h3>
            <a class="item" href="https://github.com/loopj/short-stack"
              >Short Stack: World’s smallest Nintendo Wii</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-18 @ 00:51:16</span
              ><span class="points-container"
                >Points: <span class="points">553</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40071826"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40069599">
          <h3>
            <a class="item" href="https://tonsky.me/blog/centering/"
              >Hardest problem in computer science: centering things</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 20:17:11</span
              ><span class="points-container"
                >Points: <span class="points">1227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40069599"
                  >Comments</a
                ><span class="descendants">: 401</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40067939">
          <h3>
            <a
              class="item"
              href="https://www.consumerfinance.gov/about-us/newsroom/cfpb-takes-action-against-coding-boot-camp-bloomtech-and-ceo-austen-allred-for-deceiving-students-and-hiding-loan-costs/"
              >CFPB Takes Action Against Coding Boot Camp BloomTech and CEO
              Austen Allred</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:48:31</span
              ><span class="points-container"
                >Points: <span class="points">711</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067939"
                  >Comments</a
                ><span class="descendants">: 311</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40067857">
          <h3>
            <a
              class="item"
              href="https://github.com/spawnmason/randar-explanation/blob/master/README.md"
              >Randar: A Minecraft exploit that uses LLL lattice reduction to
              crack server RNG</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:42:51</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067857"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40067486">
          <h3>
            <a
              class="item"
              href="https://bawolf.substack.com/p/embeddings-are-a-good-starting-point"
              >Embeddings are a good starting point for the AI curious app
              developer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:09:14</span
              ><span class="points-container"
                >Points: <span class="points">629</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067486"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063555">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/why-feathers-are-one-of-evolutions-cleverest-inventions/"
              >Feathers are one of evolution's cleverest inventions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:17:08</span
              ><span class="points-container"
                >Points: <span class="points">240</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063555"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40061483">
          <h3>
            <a
              class="item"
              href="http://allsoftwaresucks.blogspot.com/2022/11/why-cve-2022-3602-was-not-detected-by.html"
              >Why CVE-2022-3602 was not detected by fuzz testing (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 07:14:28</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40061483"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40060697">
          <h3>
            <a
              class="item"
              href="https://www.sfgate.com/bayarea/article/Not-your-mother-s-mall-New-concepts-2526735.php"
              >Not your mother's mall (2003)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 05:14:41</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40060697"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40052159">
          <h3>
            <a
              class="item"
              href="https://news.arizona.edu/news/how-pluto-got-its-heart"
              >Pluto Got Its 'Heart'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 14:12:27</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40052159"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
