<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42808801">
          <h3>
            <a class="item" href="https://jprx.io/cve-2024-54507/"
              >Susctl CVE-2024-54507: A particularly 'sus' sysctl in the XNU
              kernel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 22:37:57</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42808801"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42807805">
          <h3>
            <a class="item" href="https://kevinheavey.github.io/modern-polars/"
              >Modern Polars – A side-by-side comparison of the Polars and
              Pandas libraries</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 20:36:11</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42807805"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42807653">
          <h3>
            <a
              class="item"
              href="https://madpsy.uk/link-between-the-soundtrack-of-the-exorcist-and-amateur-radio/"
              >Morse Code in Tubular Bells (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 20:19:59</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42807653"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42807173">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/news/introducing-citations-api"
              >Citations on the Anthropic API</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 19:29:29</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42807173"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42806616">
          <h3>
            <a
              class="item"
              href="https://github.com/fal-ai-community/video-starter-kit"
              >Show HN: Open-source AI video editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 18:34:38</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42806616"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                It all started as an internal experiment but as we tackled some
                of the issues it was clear there could be some value sharing it
                with the open source community.
              </p>
              <p>Some of the key points and tech stack details:</p>
              <p>
                - It uses IndexedDb, so all data is local (i.e. no auth, no
                cloud db)
              </p>
              <p>
                - Multiple AI models for video, image, music and voice-over.
                APIs are provided by fal.ai
              </p>
              <p>- Built with the typical React+Next.js, Shadcn front-end</p>
              <p>
                - Used remotion.dev for the realtime video preview (this is such
                a great project, without it the codebase would be twice as
                large)
              </p>
              <p>
                - File uploads so you can bring your own media by
                uploadthing.com
              </p>
              <p>
                - ffmpeg for encoding the final video and also some ui tricks,
                like the audio waveform
              </p>
              <p>
                We deployed a version of it and for now it's free to use. We do
                plan to add some rate limiting and a bring your own API Key
                next, but it's open source and I'm curious about what the
                community will build on top of it, or derive from it. Customize
                your own video app and if you do, please share.
              </p>
              <p>If you have any questions, hit me up!</p>
            </div>
          </section>
        </section>
        <section id="42806486">
          <h3>
            <a class="item" href="https://www.guedelon.fr/en/"
              >Building a Medieval Castle from Scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 18:24:30</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42806486"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42806328">
          <h3>
            <a class="item" href="https://github.com/ggml-org/llama.vim"
              >Llama.vim – Local LLM-assisted text completion</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 18:06:42</span
              ><span class="points-container"
                >Points: <span class="points">251</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42806328"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42806301">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/introducing-operator/"
              >Introducing Operator</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 18:03:40</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42806301"
                  >Comments</a
                ><span class="descendants">: 219</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42806247">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42806247"
              >Thank HN: My bootstrapped startup got acquired today</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 17:58:05</span
              ><span class="points-container"
                >Points: <span class="points">878</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42806247"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm Paras Chopra, founder of VWO. We're an A/B testing platform
                that was born here as a Show HN in 2009:
                <a href="https://news.ycombinator.com/item?id=876141"
                  >https://news.ycombinator.com/item?id=876141</a
                >
              </p>
              <p>
                Today, I sold the company to a private equity firm for $200mn.
              </p>
              <p>
                It's covered on TechCrunch:
                <a
                  href="https://techcrunch.com/2025/01/23/everstone-acquires-bootstrapped-indian-startup-wingify-for-200m/"
                  >https://techcrunch.com/2025/01/23/everstone-acquires-bootstr...</a
                >
              </p>
              <p>
                I was a 22 year old fresh graduate when I launched VWO on HN and
                got initial users. Feedback from people like @patio11 helped me
                get to PMF. And now, 15 years later, "site:ycombinator.com" is
                what I appended when I wanted to search for advice on what to
                keep in mind while selling my company.
              </p>
              <p>
                Thank you HN for sharing inspiration and wisdom all along. I
                honestly don't think I would have been an entrepreneur had it
                not been for hacker news.
              </p>
              <p>
                Every single day, HN is the first website I open! I'm feeling
                very grateful towards the community. Thanks @dang, and thank you
                Paul Graham for your essays and for creating this beautiful
                corner of the internet!
              </p>
            </div>
          </section>
        </section>
        <section id="42806105">
          <h3>
            <a
              class="item"
              href="https://scale.com/blog/humanitys-last-exam-results"
              >Results of "Humanity's Last Exam" benchmark published</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 17:44:07</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42806105"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42805699">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42805699"
              >Intrinsic (YC W23) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 17:00:58</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                <a href="https://withintrinsic.com/careers"
                  >https://withintrinsic.com/careers</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42805431">
          <h3>
            <a class="item" href="https://tmsu.org/"
              >TMSU: Command-line tool for applying tags and viewing virtual
              tagged filesystem</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 16:29:18</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42805431"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42805425">
          <h3>
            <a class="item" href="https://danluu.com/deconstruct-files/"
              >Working with Files Is Hard (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 16:28:34</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42805425"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42805421">
          <h3>
            <a
              class="item"
              href="https://www.redblobgames.com/x/1903-orbit-spirograph/"
              >Orbit Spirograph (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 16:28:07</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42805421"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42804961">
          <h3>
            <a class="item" href="https://github.com/c100k/libmodulor"
              >Show HN: libmodulor – An opinionated TS library to build
              multi-platform apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 15:30:12</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42804961"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been able to achieve this by relying on TypeScript, a
                4-layer architecture (UseCase =&gt; App =&gt; Product =&gt;
                Target) and dependency injection.
              </p>
              <p>
                This mechanism allows me to use whatever tech stack I want,
                provided the good adapters are developed. For instance, I have
                pre-built ones : node express (server), next.js (server), node
                hono (server in alpha), node parseArgs (CLI), node stricli
                (CLI), react-web-pure (web with no CSS), react-native (mobile),
                node mcp server (anthropic MCP in alpha), etc.
              </p>
              <p>
                The same goes with data storage : Postgres, SQLite, a txt file,
                whatever.
              </p>
              <p>It also comes with auto testing and auto documentation.</p>
              <p>
                Did I reinvent the wheel ? Probably on some aspects. Is it too
                much abstraction ? Probably as well. But I like the idea of
                modularity and portability.
              </p>
              <p>
                That's why it's not made for everyone, nor all types of
                projects.
              </p>
              <p>
                If you like testing new stuff, give it a try and feel free to
                ping me if needed, I'd love to help.
              </p>
              <p>
                I'm aware the documentation is not state of the art yet. I
                wanted to focus on the "Getting Started" Guide to give a quick
                overview instead of going to deeply into the details.
              </p>
              <p>Best,</p>
            </div>
          </section>
        </section>
        <section id="42804835">
          <h3>
            <a class="item" href="https://github.com/yassinebenaid/bunster"
              >Bunster: Compile bash scripts to self contained executables</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 15:17:26</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42804835"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42804566">
          <h3>
            <a
              class="item"
              href="https://benpence.com/blog/post/psychedelic-graphics-0"
              >Psychedelic Graphics 0: Introduction</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 14:49:43</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42804566"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42804506">
          <h3>
            <a
              class="item"
              href="https://www.americanscientist.org/article/third-base"
              >Third Base (2001)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 14:43:39</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42804506"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42804434">
          <h3>
            <a class="item" href="https://dhruvvidyut.co.in/"
              >Turn any bicycle electric</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 14:38:09</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42804434"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42803279">
          <h3>
            <a class="item" href="https://samcurry.net/hacking-subaru"
              >Hacking Subaru: Tracking and Controlling Cars via the Starlink
              Admin Panel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 12:22:19</span
              ><span class="points-container"
                >Points: <span class="points">282</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42803279"
                  >Comments</a
                ><span class="descendants">: 197</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42802778">
          <h3>
            <a
              class="item"
              href="https://www.abortretry.fail/p/the-british-micro-behemoth"
              >The British Micro Behemoth</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 10:53:01</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42802778"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42802498">
          <h3>
            <a
              class="item"
              href="https://diamondgeezer.blogspot.com/2025/01/londons-most-central-sheep.html"
              >Where is London's most central sheep?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 09:58:20</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42802498"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42800893">
          <h3>
            <a class="item" href="https://t4t.social/"
              >Show HN: I built an active community of trans people online</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-23 @ 05:07:35</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42800893"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
            <div class="text">
              <p>
                Lex is not well liked by its users. Its software feels heavy and
                it is full of cash grabs and anti-patterns. It was recently
                acquired and is sure to only become more hostile to its users as
                it turns towards profit generation.
              </p>
              <p>
                With this in mind I built t4t, an alternative specially designed
                for not only queer people, but specifically trans people.
              </p>
              <p>
                It is an extremely lightweight service. I built it with my most
                ideal stack: Flutter, Svelte, Supabase, Posthog.
              </p>
              <p>
                It has grown in the last year to about 4,000 monthly active
                users. I think it could grow way beyond that this year.
              </p>
            </div>
          </section>
        </section>
        <section id="42797260">
          <h3>
            <a class="item" href="https://www.byran.ee/posts/creation/"
              >Show HN: I made an open-source laptop from scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-22 @ 20:41:52</span
              ><span class="points-container"
                >Points: <span class="points">2530</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42797260"
                  >Comments</a
                ><span class="descendants">: 292</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/Hello9999901/laptop"
                >https://github.com/Hello9999901/laptop</a
              >
            </div>
          </section>
        </section>
        <section id="42796950">
          <h3>
            <a
              class="item"
              href="https://rustle.ca/posts/articles/work-from-home-lighting"
              >How to improve your WFH lighting to reduce eye strain</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-22 @ 20:08:57</span
              ><span class="points-container"
                >Points: <span class="points">608</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42796950"
                  >Comments</a
                ><span class="descendants">: 276</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42795237">
          <h3>
            <a class="item" href="https://tabboo.xyz/"
              >TabBoo – add random jumpscares to websites you're trying to
              avoid</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-22 @ 17:27:14</span
              ><span class="points-container"
                >Points: <span class="points">682</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42795237"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42780271">
          <h3>
            <a class="item" href="https://github.com/Trugamr/wol"
              >Wol: Wake up your devices with a single command or click</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-21 @ 14:15:12</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42780271"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42777948">
          <h3>
            <a
              class="item"
              href="https://lmnt.me/blog/the-most-mario-colors.html"
              >The Most Mario Colors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-21 @ 09:10:13</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42777948"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42765683">
          <h3>
            <a class="item" href="https://cefboud.github.io/posts/compression/"
              >Taking a Look at Compression Algorithms</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 06:44:58</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42765683"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42758425">
          <h3>
            <a
              class="item"
              href="https://www.esri.com/arcgis-blog/products/arcgis-living-atlas/water/the-most-detailed-map-of-us-waters-that-youve-ever-seen/"
              >The Most Detailed Map of US Waters That You've Ever Seen
              (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-19 @ 16:25:49</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42758425"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
