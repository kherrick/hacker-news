<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38674240">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/motion/4f5f6a29-3af0-4d79-99a4-988ff7c5ba05?utm_source=hn"
              >Motion (YC W20) Is Hiring Front End Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 17:00:45</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38673966">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-03953-z"
              >A bullying scandal closed a historic astronomy department</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 16:37:26</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38673966"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38673954">
          <h3>
            <a class="item" href="https://github.com/microsoft/promptbase"
              >microsoft/promptbase: All things prompt engineering</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 16:36:22</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38673954"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38673854">
          <h3>
            <a
              class="item"
              href="https://www.iflscience.com/new-mind-reading-braingpt-turns-thoughts-into-text-on-screen-72054"
              >BrainGPT turns thoughts into text</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 16:22:05</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38673854"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38673725">
          <h3>
            <a
              class="item"
              href="https://careercutler.substack.com/p/becoming-a-go-to-person-gets-you"
              >Becoming a go-to person gets you promoted</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 16:04:07</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38673725"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38673654">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-04045-8"
              >US nuclear-fusion lab enters new era: achieving 'ignition' over
              and over</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 15:55:34</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38673654"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38673608">
          <h3>
            <a
              class="item"
              href="https://qz.com/557639/everyone-on-earth-is-actually-your-cousin"
              >Everyone on Earth is your cousin (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 15:49:26</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38673608"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38673392">
          <h3>
            <a class="item" href="https://ptrchm.com/posts/base32-explained/"
              >How does Base32 (or any Base2^n) work exactly?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 15:17:13</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38673392"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38673292">
          <h3>
            <a
              class="item"
              href="https://www.charliechaplin.com/en/articles/29-the-final-speech-from-the-great-dictator-"
              >The Final Speech from The Great Dictator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 15:03:15</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38673292"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38673253">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38673253"
              >Ask HN: Does anyone here use Haxe?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 14:58:21</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38673253"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
            <div class="text">
              <p>
                I was (and still am, in some ways) against the idea of learning
                one language and trying to use it everywhere. But nowadays,
                there are so many transpilation and adapter systems going on
                that... everything is a bit fuzzy.
              </p>
              <p>
                That made me remember Haxe. Their goal all along was to have one
                unified language to deploy anywhere.
              </p>
              <p>
                Does anyone here use Haxe regularly? In production? I'd love to
                hear about your experiences and what you've used it in-place of.
              </p>
            </div>
          </section>
        </section>
        <section id="38672575">
          <h3>
            <a class="item" href="https://comfyuiweb.com/"
              >Show HN: A free text-to-image website that supports SDXL Turbo</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 13:02:48</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38672575"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              The homepage of the website allows for free image generation, and
              in the workflows, there are introductions to nodes related to
              ComfyUI. In the AI tools section, Pixart-Alpha is currently
              available for free use. I am still updating this website, and
              feedback and communication are welcome.
            </div>
          </section>
        </section>
        <section id="38672386">
          <h3>
            <a class="item" href="https://notgull.net/finding-a-forge/"
              >Evaluating new software forges</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 12:26:17</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38672386"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38671030">
          <h3>
            <a class="item" href="https://github.com/facebookresearch/Pearl"
              >Pearl: A Production-Ready Reinforcement Learning Agent</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 07:27:38</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38671030"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38670866">
          <h3>
            <a class="item" href="https://daviddfriedman.substack.com/p/torture"
              >The origin of the law of torture: A cautionary tale</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 06:40:28</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38670866"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38670850">
          <h3>
            <a
              class="item"
              href="https://magazine.atavist.com/the-divorce-colony/"
              >The Divorce Colony (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 06:38:00</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38670850"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38670845">
          <h3>
            <a
              class="item"
              href="https://1000wordphilosophy.com/2023/12/04/hylomorphism/"
              >Hylomorphism</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 06:36:10</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38670845"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38670760">
          <h3>
            <a
              class="item"
              href="https://www.teamtechnology.co.uk/tt/t-articl/apollo.htm"
              >The Apollo Syndrome</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 06:16:40</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38670760"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38670465">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2307.12108"
              >An Empirical Study and Evaluation of Modern CAPTCHAs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 05:10:31</span
              ><span class="points-container"
                >Points: <span class="points">329</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38670465"
                  >Comments</a
                ><span class="descendants">: 294</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38669781">
          <h3>
            <a class="item" href="https://nowdo.org/"
              >Show HN: NowDo â€“ MacOS todo app for procrastinators</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-17 @ 02:18:02</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38669781"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38668713">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/cfet-intel-samsung-tsmc"
              >Intel, Samsung, and TSMC Demo 3D-Stacked Transistors</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-16 @ 23:15:55</span
              ><span class="points-container"
                >Points: <span class="points">275</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38668713"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38666148">
          <h3>
            <a
              class="item"
              href="https://blog.dureuill.net/articles/recurring-lifetime/"
              >A curiously recurring lifetime issue</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-16 @ 17:37:05</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38666148"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38666045">
          <h3>
            <a
              class="item"
              href="https://www.righto.com/2023/12/386-xor-circuits.html"
              >Two interesting XOR circuits inside the Intel 386 processor</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-16 @ 17:26:41</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38666045"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38665900">
          <h3>
            <a
              class="item"
              href="https://theamericanscholar.org/the-quest-for-cather/"
              >The Quest for Cather</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-16 @ 17:13:36</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38665900"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38664643">
          <h3>
            <a
              class="item"
              href="https://www.commentary.org/articles/terry-teachout/the-art-of-conducting/"
              >The Art of Conducting (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-16 @ 14:54:11</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38664643"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38661981">
          <h3>
            <a class="item" href="https://wiki.c2.com/?ScheduleChicken"
              >Schedule Chicken (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-16 @ 05:27:28</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38661981"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38660007">
          <h3>
            <a
              class="item"
              href="https://www.binwang.me/2023-12-14-ZFS-Profiling-on-Arch-Linux.html"
              >ZFS Profiling on Arch Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-15 @ 23:09:27</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38660007"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38657847">
          <h3>
            <a class="item" href="https://blog.vito.nyc/posts/gil-balm/"
              >Balm in GILead: Fast string construction for CPython
              extensions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-15 @ 19:37:58</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38657847"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38656007">
          <h3>
            <a
              class="item"
              href="https://mattrucker.com/risk-management-is-not-project-management/"
              >Risk management is not project management</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-15 @ 16:57:53</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38656007"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38652619">
          <h3>
            <a
              class="item"
              href="https://kitemaker.co/blog/more_product_fewer_pms"
              >More product, fewer product managers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-15 @ 09:53:35</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38652619"
                  >Comments</a
                ><span class="descendants">: 192</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38652141">
          <h3>
            <a class="item" href="https://www.jurassicsystems.com/"
              >Jurassic Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-15 @ 08:20:49</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38652141"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
