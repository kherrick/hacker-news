<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42141761">
          <h3>
            <a
              class="item"
              href="https://computerhistory.org/blog/in-memoriam-thomas-e-kurtz-1928-2024/"
              >In Memoriam: Thomas E. Kurtz, 1928–2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 22:12:09</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42141761"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42141587">
          <h3>
            <a
              class="item"
              href="https://github.com/BAndysc/AvaloniaVisualBasic6"
              >Visual Basic 6 IDE recreated in C#</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 21:47:54</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42141587"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42141160">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/inspectmind-ai/jobs/rPuRKf1-software-engineer"
              >InspectMind AI (YC W24) Is Hiring for AI in Construction</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 21:00:51</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42139843">
          <h3>
            <a
              class="item"
              href="https://www.openmp.org/home-news/openmp-arb-releases-openmp-6-0-for-easier-programming/"
              >OpenMP 6.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 19:00:03</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42139843"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42139044">
          <h3>
            <a
              class="item"
              href="https://www.redhat.com/en/blog/red-hat-contribute-comprehensive-container-tools-collection-cloud-native-computing-foundation"
              >Red Hat to contribute container tech (Podman, bootc,
              ComposeFS...) to CNCF</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 17:59:27</span
              ><span class="points-container"
                >Points: <span class="points">199</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42139044"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42138289">
          <h3>
            <a class="item" href="https://dynomight.substack.com/p/chess"
              >Something weird is happening with LLMs and chess</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 17:05:40</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42138289"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42138115">
          <h3>
            <a
              class="item"
              href="https://news.virginmediao2.co.uk/o2-unveils-daisy-the-ai-granny-wasting-scammers-time/"
              >Daisy, an AI granny wasting scammers' time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 16:52:09</span
              ><span class="points-container"
                >Points: <span class="points">447</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42138115"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42137818">
          <h3>
            <a
              class="item"
              href="https://mathoverflow.net/questions/278130/the-letter-wp-name-origin"
              >The letter ℘: name and origin? (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 16:28:30</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42137818"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42137790">
          <h3>
            <a
              class="item"
              href="https://developer.mozilla.org/en-US/docs/Web/API/File_System_API/Origin_private_file_system"
              >Origin private file system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 16:24:51</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42137790"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42137527">
          <h3>
            <a
              class="item"
              href="https://www.gauge.sh/blog/ai-makes-tech-debt-more-expensive"
              >AI makes tech debt more expensive</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 16:01:59</span
              ><span class="points-container"
                >Points: <span class="points">292</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42137527"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42136711">
          <h3>
            <a
              class="item"
              href="https://blog.helix.ml/p/we-can-all-be-ai-engineers"
              >The barriers to AI engineering are crumbling fast</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 14:56:48</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42136711"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42136375">
          <h3>
            <a
              class="item"
              href="https://blog.pypi.org/posts/2024-11-14-pypi-now-supports-digital-attestations/"
              >PyPI now supports digital attestations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 14:25:39</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42136375"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42136259">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/11/14/business/media/alex-jones-infowars-the-onion.html"
              >The Onion buys Infowars</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 14:10:05</span
              ><span class="points-container"
                >Points: <span class="points">1321</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42136259"
                  >Comments</a
                ><span class="descendants">: 811</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42136136">
          <h3>
            <a
              class="item"
              href="https://obdev.at/blog/a-memory-leak-in-apples-network-extension-framework/"
              >A memory leak in Apple's Network Extension framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 13:53:58</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42136136"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42135520">
          <h3>
            <a
              class="item"
              href="https://jan.miksovsky.com/posts/2024/11-12-momboard"
              >MomBoard: E-ink display for a parent with amnesia</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 12:20:40</span
              ><span class="points-container"
                >Points: <span class="points">1138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42135520"
                  >Comments</a
                ><span class="descendants">: 139</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42134964">
          <h3>
            <a
              class="item"
              href="https://mrsuh.com/articles/2024/sqlite-index-visualization-structure/"
              >SQLite Index Visualization</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 10:51:24</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42134964"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42134125">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2406.04823"
              >BERTs Are Generative In-Context Learners</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 08:18:50</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42134125"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42133864">
          <h3>
            <a
              class="item"
              href="https://mtlynch.io/lessons-from-my-first-exit/"
              >Lessons from my first exit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 07:32:09</span
              ><span class="points-container"
                >Points: <span class="points">329</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42133864"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42133744">
          <h3>
            <a
              class="item"
              href="https://freudenbergs.de/vanessa/publications/Freudenberg-2014-SqueakJS.pdf"
              >SqueakJS: A modern and practical Smalltalk that runs in any
              browser (2014) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 06:59:26</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42133744"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
            <div class="text">
              <a href="https://x.com/dynlangsym/status/1856748088708210924"
                >https://x.com/dynlangsym/status/1856748088708210924</a
              >
              <p>
                This paper just received a Most Notable Paper award from the ACM
                SIGPLAN Dynamic Language Symposium, and it's a great paper. One
                of my favorites, up there with the original "Self" papers.
              </p>
              <p>
                It describes how Vanessa's groundbreaking Smalltalk VM
                implemented in JavaScript runs historic Smalltalk images, and
                elegantly and efficiently integrates Smalltalk's garbage
                collector with JavaScript's.
              </p>
              <p>
                I've written about her work and this paper previously on Hacker
                News:
                <a href="https://news.ycombinator.com/item?id=40917424"
                  >https://news.ycombinator.com/item?id=40917424</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42133282">
          <h3>
            <a
              class="item"
              href="https://www.gq.com/story/oral-history-we-built-this-city-worst-song-of-all-time"
              >An oral history of "We Built This City," the worst song of all
              time (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 04:59:02</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42133282"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42127882">
          <h3>
            <a class="item" href="https://codeium.com/windsurf/"
              >Show HN: Windsurf – Agentic IDE</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-13 @ 17:09:27</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42127882"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>
                We've stuffed a lot of cool features into Windsurf—a super fast
                autocomplete model, an inline diff generation experience that
                feels truly native, but we're most proud of Cascade, which is an
                evolution of the sidebar chat experience that many other
                extensions have. Cascade can perform deep reasoning on your
                existing codebase, access a vast array of tools that allow it to
                run terminal commands and find relevant files, and it's
                omniscient of all the actions that the user has taken
                independent of invoking the AI. (You can for example, start
                implementing a change manually and just ask Cascade to
                "continue").
              </p>
              <p>
                We've been using Cascade internally at Codeium on our actual
                production codebase, and we're getting actual value from it. We
                hope everyone here does too! You can find a bunch of demos of
                Cascade on our website but I want to show one that I made myself
                using Cascade to solve an interesting cryptography challenge:
              </p>
              <p>
                <a href="https://youtu.be/LbYepFmVB20"
                  >https://youtu.be/LbYepFmVB20</a
                >
              </p>
              <p>
                Cascade was able to explain the problem to me, install some
                libraries needed to interact with the challenge, give me some
                pointers towards a solution, and implement an attack that I
                described to it all by itself.
              </p>
            </div>
          </section>
        </section>
        <section id="42125888">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2024-11-13/openai-google-and-anthropic-are-struggling-to-build-more-advanced-ai"
              >OpenAI, Google and Anthropic are struggling to build more
              advanced AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-13 @ 13:28:51</span
              ><span class="points-container"
                >Points: <span class="points">310</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42125888"
                  >Comments</a
                ><span class="descendants">: 358</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42114688">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2024/nov/12/food-source-famine-leningrad-seed-bank-nikolai-vavilov"
              >The Leningrad botanists who saved the first seed bank</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-12 @ 11:31:59</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42114688"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42106368">
          <h3>
            <a
              class="item"
              href="https://www.abortretry.fail/p/the-internet-gopher-from-minnesota"
              >The Internet Gopher from Minnesota</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-11 @ 11:27:59</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42106368"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42104378">
          <h3>
            <a
              class="item"
              href="https://support.apple.com/en-sg/guide/iphone/iph66057d0f6/ios"
              >Control iPhone with the movement of your eyes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-11 @ 03:24:58</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42104378"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42098471">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-03491-2"
              >The brain summons deep sleep for healing from life-threatening
              injury</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-10 @ 03:47:48</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42098471"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42095263">
          <h3>
            <a
              class="item"
              href="https://henrikwarne.com/2024/11/09/my-simple-knowledge-management-and-time-tracking-system/"
              >My simple knowledge management and time tracking system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-09 @ 16:31:04</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42095263"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42092667">
          <h3>
            <a
              class="item"
              href="https://www.lesswrong.com/posts/vZcXAc6txvJDanQ4F/the-median-researcher-problem-1"
              >The Median Researcher Problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-09 @ 05:10:16</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42092667"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42087677">
          <h3>
            <a
              class="item"
              href="https://statmodeling.stat.columbia.edu/2024/11/08/bad-science-as-genre-fiction/"
              >Bad science as genre fiction</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 15:44:20</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42087677"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42073677">
          <h3>
            <a
              class="item"
              href="https://nfil.dev/coding/encryption/python/double-ratchet-example/"
              >Implementing Signal's Double Ratchet algorithm (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 05:27:16</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42073677"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
