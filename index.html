<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39185403">
          <h3>
            <a class="item" href="https://draculatheme.com/hacker-news"
              >Dracula Theme for Hacker News</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-30 @ 01:46:22</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39185403"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39185198">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/researchers-approach-new-speed-limit-for-seminal-problem-20240129/"
              >Linear Programming - Researchers Approach New Speed Limit for
              Seminal Problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-30 @ 01:19:41</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39185198"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39184674">
          <h3>
            <a
              class="item"
              href="https://hackaday.com/2024/01/29/a-mouse-becomes-a-camera/"
              >A Mouse Becomes a Camera</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-30 @ 00:19:44</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39184674"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39184149">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39184149"
              >Ask HN: Are you using a GPT to prompt-engineer another GPT?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 23:22:02</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39184149"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
            <div class="text">
              <p>
                It made me think that the obvious way to learn prompt
                engineering is… to not learn it, but to use another LLM to do
                that for you.
              </p>
              <p>Any experience with this? Happy? Unhappy?</p>
            </div>
          </section>
        </section>
        <section id="39183670">
          <h3>
            <a
              class="item"
              href="https://archive-it.org/post/the-stack-warc-file/"
              >An Introduction to the WARC File</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 22:31:41</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39183670"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39183063">
          <h3>
            <a
              class="item"
              href="https://www.statnews.com/2024/01/29/first-transmitted-alzheimers-disease-cases-growth-hormone-cadavers/"
              >Alzheimer’s cases tied to no-longer-used medical procedure</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 21:39:58</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39183063"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39182910">
          <h3>
            <a
              class="item"
              href="https://www.sonomamag.com/50-years-later-sonomas-summer-love/"
              >Two Sonoma communes’ psychedelic rise and fall (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 21:27:49</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39182910"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39182738">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39182738"
              >Ask HN: How can I back up an old vBulletin forum without admin
              access?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 21:16:36</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39182738"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
            <div class="text">
              <p>What we've run into:</p>
              <p>
                1. Admin/owner is nearly / absolutely unreachable, which causes
                a variety of issues. Mainly we cannot even request a traditional
                backup of the database underneath the forum software.
              </p>
              <p>
                2. As with anything, the forums don't get much active engagement
                other than older forum regulars. However, Google searches easily
                find useful posts for things like DIY maintenance, modification
                installs, test data from driving with ECU tunes, track day
                experiences, etc.
              </p>
              <p>
                3. It's easy to point people on other social networks at posts
                by their URL, but due to neglect the website constantly has
                problems making access increasingly complicated and
                inconsistent.
              </p>
              <p>
                Ideally, it'd be nice to find a way to scrape everything as
                closely as possible into a manageable database.
              </p>
              <p>
                Even more ideally, if we could convert said scraped data into a
                format that is easily publishable to a new platform, that would
                be handy. Even if the new platform is static and simply renders
                the old threads.
              </p>
              <p>
                I can't imagine we are the only forum that is experiencing
                problems like this with most forums probably dying in the last
                decade.
              </p>
              <p>
                Has anyone gone through this kind of archival process with
                vBulletin before?
              </p>
              <p>Thanks.</p>
            </div>
          </section>
        </section>
        <section id="39182721">
          <h3>
            <a
              class="item"
              href="https://www.fosskers.ca/en/blog/rounds-of-lisp"
              >A Tour of the Lisps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 21:15:36</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39182721"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39180953">
          <h3>
            <a class="item" href="https://www.boardzilla.io/"
              >Show HN: Boardzilla, a framework for making web-based board
              games</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 19:12:53</span
              ><span class="points-container"
                >Points: <span class="points">299</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39180953"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
            <div class="text">
              <p>
                Tldr: We’ve made a framework for web-based board games. You can
                try out some games over at
                <a href="https://boardzilla.io">https://boardzilla.io</a>, or
                you can take a look at
                <a href="https://docs.boardzilla.io"
                  >https://docs.boardzilla.io</a
                >
                to learn more about how to develop your own game. Source is
                available at
                <a href="https://github.com/boardzilla"
                  >https://github.com/boardzilla</a
                >
              </p>
              <p>
                Hey y’all. My brother and I have made a framework for board
                games. During the pandemic we started to look at BGA but got
                discouraged by how old-fashioned the tools were and how
                cumbersome the development process was. We set out to make our
                own framework where you could use the same code for both the
                client and server. Our hope is anyone familiar with Typescript
                and CSS could code up a game without worrying about state
                management, persistence or networking.
              </p>
              <p>
                It’s still very much a wip, and we're rapidly adding features
                and games. But we’ve got our first draft of developer docs done,
                and we've put up a few games we've developed to showcase and
                test out the platform. Source for the games and framework is
                available on Github, and we’re excited to code more games and
                hopefully encourage other people to try it out. Happy for any
                feedback.
              </p>
            </div>
          </section>
        </section>
        <section id="39180891">
          <h3>
            <a
              class="item"
              href="https://sudhir.io/the-big-little-guide-to-message-queues"
              >The Big Little Guide to Message Queues (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 19:08:52</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39180891"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39180430">
          <h3>
            <a
              class="item"
              href="https://www.answer.ai/posts/2024-01-26-freaktakes-lessons.html"
              >Lessons from history's greatest R&amp;amp;D labs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 18:42:35</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39180430"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39179121">
          <h3>
            <a
              class="item"
              href="https://www.synthmuseum.com/magazine/0102jw.html"
              >Thaddeus Cahill's Teleharmonium</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 17:26:12</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39179121"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39178753">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39178753"
              >Launch HN: Dashdive (YC W23) – Track your cloud costs
              precisely</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 17:03:18</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39178753"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.dashdive.com/">https://www.dashdive.com/</a
              >), which calculates the cloud cost incurred by each user action
              taken in your product. There’s a demo video at
              <a href="https://www.dashdive.com/#video"
                >https://www.dashdive.com/#video</a
              >
              and an interactive demo here:
              <a href="https://demo.dashdive.com">https://demo.dashdive.com</a>.
              <p>
                We talked to dozens of software engineers and kept hearing about
                three problems caused by poor cloud cost observability:
              </p>
              <p>
                (1)
                <i>Cost anomalies are slow to detect and hard to diagnose.</i>
                For example, a computer vision company noticed their AWS costs
                spiking one month. Costs accrued until they identified the
                culprit: one of their customers had put up a life-size cutout of
                John Wayne, and they were running non-stop facial recognition on
                it.
              </p>
              <p>
                (2) <i>No cost accountability in big orgs.</i> For example, a
                public tech company’s top priority last year was to increase
                gross margin. But they had no way to identify the highest cost
                managers/products or measure improvement despite tagging
                efforts.
              </p>
              <p>
                (3)
                <i>Uncertain and variable per-customer gross margins.</i> For
                example, a SaaS startup had one customer generating &gt;50% of
                its revenue. That customer’s usage of certain features had
                recently 1,000x’ed, and they weren’t sure the contract was still
                profitable.
              </p>
              <p>
                (If you’ve had an experience like this, we’d love to hear about
                it in the comments.)
              </p>
              <p>
                We built Dashdive because none of the existing cloud cost
                dashboard products solves all three of these problems, which
                often requires <i>sub-resource</i> cost attribution.
              </p>
              <p>
                Existing tools combine AWS, GCP, Datadog, Snowflake, etc. cost
                data in a single dashboard with additional features like
                alerting and cost cutting recommendations. This is sufficient in
                many cases, but it falls short when a company (a) wants
                per-customer, per-team or per-feature cost visibility and (b)
                has a multitenant architecture.
              </p>
              <p>
                By contrast, Dashdive uses observability tools to collect
                granular cloud usage data at the level of individual user
                actions (e.g. each API call or database transaction). We
                attribute this activity to the corresponding feature, the
                responsible customer and team and estimate its cost based on the
                applicable rate. The result is more detailed cost and usage data
                than can be obtained with tagging. This information can be used
                to detect anomalies in real-time and identify costly teams,
                features and customers. One of our customers is even using
                Dashdive to charge customers for their cloud usage.
              </p>
              <p>
                We use Kafka to ingest large volumes (&gt;100m/day) of product
                usage events, and our web dashboard supports real-time querying
                thanks to ClickHouse. This makes it fast and easy to answer
                questions like: “Over the past 14 days, how much vCPU time did
                customer X use on Kubernetes cluster A, and how much did that
                cost me?” You can answer such questions even when the same
                container or pod is shared by multiple customers, features
                and/or teams.
              </p>
              <p>
                You can test drive the product with example data here:
                <a href="https://demo.dashdive.com/"
                  >https://demo.dashdive.com/</a
                >. Given the high per-customer cost of our infrastructure and
                the manual steps required for setup on our part, we don’t offer
                self-serve onboarding or a public “free tier” to monitor your
                own cloud usage, but this demo gives a basic view of our
                product.
              </p>
              <p>
                Right now, Dashdive supports S3 and S3-compatible object storage
                providers. We’re working to add support for other providers and
                services, particularly compute services (EC2, GCP VMs, ECS, EKS,
                GKE, etc.).
              </p>
              <p>
                If there’s any service in particular you want to see supported,
                please tell us in the comments. We’re eager to see your
                comments, questions, concerns, etc.
              </p>
            </div>
          </section>
        </section>
        <section id="39178750">
          <h3>
            <a
              class="item"
              href="https://asteriskmag.com/issues/05/prediction-markets-have-an-elections-problem-jeremiah-johnson"
              >Prediction markets have an elections problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 17:02:56</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39178750"
                  >Comments</a
                ><span class="descendants">: 128</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39178521">
          <h3>
            <a class="item" href="https://github.com/oxidecomputer/helios"
              >Helios: A distribution of Illumos powering the Oxide Rack</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 16:47:05</span
              ><span class="points-container"
                >Points: <span class="points">334</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39178521"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39176877">
          <h3>
            <a
              class="item"
              href="https://www.freightwaves.com/news/how-walmart-uses-trucking-to-dominate-american-retail"
              >Why Walmart pays its truck drivers 6 figures</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 14:51:47</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39176877"
                  >Comments</a
                ><span class="descendants">: 285</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39176797">
          <h3>
            <a
              class="item"
              href="https://xuanwo.io/2024/02-what-i-talk-about-when-i-talk-about-query-optimizer-part-1/"
              >What I talk about when I talk about query optimizer (part 1): IR
              design</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 14:45:08</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39176797"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39176570">
          <h3>
            <a class="item" href="https://github.com/collabora/WhisperFusion"
              >Show HN: WhisperFusion – Low-latency conversations with an AI
              chatbot</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 14:23:10</span
              ><span class="points-container"
                >Points: <span class="points">248</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39176570"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
            <div class="text">
              WhisperFusion builds upon the capabilities of open source tools
              WhisperLive and WhisperSpeech to provide a seamless conversations
              with an AI chatbot.
            </div>
          </section>
        </section>
        <section id="39176297">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2024/01/29/amazon-terminates-irobot-deal-vacuum-maker-to-lay-off-31percent-of-staff.html"
              >Amazon and iRobot call off their planned acquisition</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 13:59:03</span
              ><span class="points-container"
                >Points: <span class="points">218</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39176297"
                  >Comments</a
                ><span class="descendants">: 353</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39175883">
          <h3>
            <a
              class="item"
              href="https://abcnews.go.com/GMA/Family/florida-house-representatives-approves-bill-ban-social-media/story?id=106672586"
              >Florida House of Representatives approves bill to ban social
              media for kids &amp;lt; 16</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 13:20:16</span
              ><span class="points-container"
                >Points: <span class="points">339</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39175883"
                  >Comments</a
                ><span class="descendants">: 546</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39175423">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/space/2024/01/now-that-weve-flown-on-mars-what-comes-next-in-aerial-planetary-exploration/"
              >Ingenuity had more computing power than all NASA deep space
              missions combined</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 12:19:17</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39175423"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39175393">
          <h3>
            <a class="item" href="https://svelte-native.technology/"
              >Svelte Native</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 12:13:58</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39175393"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39173455">
          <h3>
            <a
              class="item"
              href="https://nosferalatu.com/HigherOrderDerivativesTransforms.html"
              >Higher Order Derivatives of Transforms</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 06:44:10</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39173455"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39172829">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/is-it-possible-to-hold-truly-contradictory-beliefs-together"
              >What Is Incoherence?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 04:53:46</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39172829"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39172086">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/01/28/business/china-evergrande.html"
              >Real estate giant China Evergrande will be liquidated</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 02:31:22</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39172086"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39171857">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Pitch_drop_experiment"
              >Pitch Drop Experiment</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-29 @ 01:39:10</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39171857"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39169972">
          <h3>
            <a class="item" href="https://www.androidarts.com/df/dorf.htm"
              >Dorf Fort (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-28 @ 21:26:39</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39169972"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39168986">
          <h3>
            <a
              class="item"
              href="https://www.vitling.xyz/i-need-to-grow-away-from-these-roots/"
              >I need to grow away from these roots</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-28 @ 19:29:23</span
              ><span class="points-container"
                >Points: <span class="points">405</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39168986"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39165100">
          <h3>
            <a
              class="item"
              href="https://thehustle.co/the-lucrative-business-of-lost-airplane-luggage/"
              >A company that sells lost airplane luggage</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-28 @ 12:36:49</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39165100"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
