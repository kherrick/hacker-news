<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39480975">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/02/23/on_call/"
              >Work for you? Again? After you lied about the job and stole my
              stuff? No thanks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 14:30:38</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39480975"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39480751">
          <h3>
            <a
              class="item"
              href="https://strugglers.net/~andy/blog/2024/02/23/i-dont-think-the-cheapest-apc-back-ups-units-can-be-monitored-except-in-windows/"
              >I don't think the cheapest APC Back-UPS units can be monitored
              except in Windows</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 14:10:11</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39480751"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39480513">
          <h3>
            <a class="item" href="https://www.highinterest.io/"
              >High Interest Savings Leaderboard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 13:49:02</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39480513"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39480341">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/tech-industry/artificial-intelligence/jim-keller-criticizes-nvidias-cuda-and-x86-cudas-a-swamp-not-a-moat-x86-was-a-swamp-too"
              >Jim Keller criticizes Nvidia CUDA, x86 – 'CUDA's a swamp, not a
              moat, like x86'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 13:32:30</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39480341"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39479522">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39479522"
              >FlutterFlow (YC W21) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 12:01:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                FlutterFlow (<a href="https://flutterflow.io"
                  >https://flutterflow.io</a
                >) is a visual application development platform that allows
                product teams to execute faster than ever before. We're just
                scratching the surface of what's possible – for example, the
                following app
                <a href="https://dreambrush.ai/">https://dreambrush.ai/</a> was
                built by someone on our team in a matter of days.
              </p>
              <p>If you find unreasonable excitement in:</p>
              <p>
                - learning/growing and becoming more productive. - working on
                statistical reasoning / Math / Physics / algorithms problems. -
                training models / writing code / building things.
              </p>
              <p>
                Nice to haves: - PS5 development experience.
                <a href="https://www.youtube.com/watch?v=dINI98rJiNs"
                  >https://www.youtube.com/watch?v=dINI98rJiNs</a
                >
              </p>
              <p>Then we'd be thrilled to have you on the team.</p>
              <p>
                At a high level, you'll be working on applying AI towards our
                purpose: democratizing application development. Reach out for
                more info.
              </p>
              <p>
                Both of us, cofounders, spent most of our careers at Google
                doing Applied ML and we believe AI is going to tremendously
                impact all aspects of our lives.
              </p>
              <p>
                On the engineering side overall, we're lucky to have an
                incredibly talented team members who are passionate about our
                purpose. To help people all over the world bring their dreams
                and ideas to life as great products.
              </p>
              <p>
                Apply here:
                <a
                  href="https://www.ycombinator.com/companies/flutterflow/jobs/UnyHKVJ-software-engineer-ai-united-states"
                  >https://www.ycombinator.com/companies/flutterflow/jobs/UnyHK...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="39479478">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2402.14083"
              >Beyond A*: Better Planning with Transformers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 11:53:25</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39479478"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39479001">
          <h3>
            <a
              class="item"
              href="https://www.troyhunt.com/thanks-fedex-this-is-why-we-keep-getting-phished/"
              >Thanks FedEx, This Is Why We Keep Getting Phished</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 10:26:01</span
              ><span class="points-container"
                >Points: <span class="points">698</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39479001"
                  >Comments</a
                ><span class="descendants">: 235</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39478677">
          <h3>
            <a class="item" href="https://brave.com/leo-docsupport/"
              >Brave's AI assistant now integrates with PDFs and Google Drive</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 09:35:49</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39478677"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39478551">
          <h3>
            <a class="item" href="https://www.radgametools.com/oodleintel.htm"
              >Intel Processor Instability Causing Oodle Decompression
              Failures</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 09:14:59</span
              ><span class="points-container"
                >Points: <span class="points">206</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39478551"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39477848">
          <h3>
            <a class="item" href="https://gpupricecompare.com"
              >Show HN: GPU Prices on eBay</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 07:22:42</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39477848"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
            <div class="text">
              <p>
                Keeping with the trend of being influenced by
                <a href="https://diskprices.com">https://diskprices.com</a>, I
                wanted to make a resource for GPUs on eBay that also take into
                account a performance metric I tend to look at when checking
                GPUs.
              </p>
              <p>
                It's still a work in progress, but it's at a state where I think
                some of HN might find it useful!
              </p>
              <p>
                There are a few things that I have planned to add in the coming
                day(s): 1. Filters for compatible slots and connectors 2. Expand
                for different eBay regions, rather than just US focus
              </p>
              <p>
                Let me know if you have any questions or want more / different
                filters on the page or if I missed something important.
              </p>
            </div>
          </section>
        </section>
        <section id="39476304">
          <h3>
            <a
              class="item"
              href="https://kitchener.ctvnews.ca/facial-recognition-error-message-on-vending-machine-sparks-concern-at-university-of-waterloo-1.6779835"
              >Facial recognition error message on vending machine sparks
              concern at University</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 02:38:57</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39476304"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39476074">
          <h3>
            <a
              class="item"
              href="https://writing.exchange/@ernie/111977450241144169"
              >Vice website is shutting down</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 02:09:43</span
              ><span class="points-container"
                >Points: <span class="points">684</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39476074"
                  >Comments</a
                ><span class="descendants">: 364</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39476002">
          <h3>
            <a
              class="item"
              href="https://juicefs.com/en/blog/engineering/reduce-metadata-memory-usage"
              >A Distributed File System in Go Cut Average Metadata Memory Usage
              to 100 Bytes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 02:01:09</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39476002"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39475863">
          <h3>
            <a
              class="item"
              href="https://www.thebignewsletter.com/p/the-fed-is-behind-the-capital-onediscover"
              >The Fed is behind the Capital One/Discover merger</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 01:44:10</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39475863"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39475729">
          <h3>
            <a class="item" href="https://blog.mlich.cz/2024/02/fosdem-2024/"
              >FOSDEM 2024: PineTime Talk</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 01:23:31</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39475729"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39475467">
          <h3>
            <a class="item" href="https://www.formtodb.com/">Form to DB</a>
          </h3>
          <section>
            <h4>
              <span>2024-02-23 @ 00:49:03</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39475467"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39474909">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/live/2024/feb/22/nasa-odysseus-moon-landing-intuitive-machines"
              >Intuitive Machines successfully lands on the Moon</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 23:39:36</span
              ><span class="points-container"
                >Points: <span class="points">409</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39474909"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39474467">
          <h3>
            <a class="item" href="https://fastsdxl.ai/"
              >Show HN: Real-time image generation with SDXL Lightning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 22:52:46</span
              ><span class="points-container"
                >Points: <span class="points">367</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39474467"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39472693">
          <h3>
            <a
              class="item"
              href="https://web.mit.edu/nelsonr/www/Repenning=Sterman_CMR_su01_.pdf"
              >Nobody ever gets credit for fixing problems that never happened
              (2001) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 20:26:56</span
              ><span class="points-container"
                >Points: <span class="points">800</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39472693"
                  >Comments</a
                ><span class="descendants">: 351</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39471388">
          <h3>
            <a
              class="item"
              href="https://www.phind.com/blog/introducing-phind-70b"
              >Phind-70B: Closing the code quality gap with GPT-4 Turbo while
              running 4x faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 18:54:23</span
              ><span class="points-container"
                >Points: <span class="points">558</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39471388"
                  >Comments</a
                ><span class="descendants">: 262</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39471116">
          <h3>
            <a
              class="item"
              href="https://bsky.social/about/blog/02-22-2024-open-social-web"
              >Bluesky announces data federation for self hosters</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 18:30:44</span
              ><span class="points-container"
                >Points: <span class="points">674</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39471116"
                  >Comments</a
                ><span class="descendants">: 404</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39470381">
          <h3>
            <a class="item" href="https://xairy.io/articles/thinkpad-xdci"
              >I turned my ThinkPad into a programmable USB device</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 17:37:28</span
              ><span class="points-container"
                >Points: <span class="points">322</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39470381"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39467413">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39467413"
              >Launch HN: Danswer (YC W24) – Open-source AI search and chat over
              private data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 14:20:15</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39467413"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/danswer-ai/danswer"
                >https://github.com/danswer-ai/danswer</a
              >). We’re building an open source and self-hostable ChatGPT-style
              system that can access your team’s unique knowledge by connecting
              to 25 of the most common workplace tools (Slack, Google Drive,
              Jira, etc.). You ask questions in natural language and get back
              answers based on your team’s documents. Where relevant, answers
              are backed by citations and links to the exact documents used to
              generate them.
              <p>
                Quick Demo:
                <a href="https://youtu.be/hqSouur2FXw"
                  >https://youtu.be/hqSouur2FXw</a
                >
              </p>
              <p>
                Originally Danswer was a side project motivated by a challenge
                we experienced at work. We noticed that as teams scale, finding
                the right information becomes more and more challenging. I
                recall being on call and helping a customer recover from a
                mission critical failure but the error was related to some
                obscure legacy feature I had never used. For most projects, a
                simple question to ChatGPT would have solved it; but in this
                moment, ChatGPT was completely clueless without additional
                context (which I also couldn’t find).
              </p>
              <p>
                We believe that within a few years, every org will be using
                team-specific knowledge assistants. We also understand that
                teams don’t want to tell us their secrets and not every team has
                the budget for yet another SaaS solution, so we open-sourced the
                project. It is just a set of containers that can be deployed on
                any cloud or on-premise. All of the data is processed and
                persisted on that same instance. Some teams have even opted to
                self-host open-source LLMs to truly airgap the system.
              </p>
              <p>
                I also want to share a bit about the actual design of the system
                (<a href="https://docs.danswer.dev/system_overview"
                  >https://docs.danswer.dev/system_overview</a
                >). If you have questions about any parts of the flow such as
                the model choice, hyperparameters, prompting, etc. we’re happy
                to go into more depth in the comments.
              </p>
              <p>
                The system revolves around a custom Retrieval Augmented
                Generation (RAG) pipeline we’ve built. During indexing time (we
                pull documents from connected sources every 10 minutes),
                documents are chunked and indexed into hybrid keyword+vector
                indices (<a
                  href="https://github.com/danswer-ai/danswer/blob/main/backend/danswer/indexing/indexing_pipeline.py#L211"
                  >https://github.com/danswer-ai/danswer/blob/main/backend/dans...</a
                >).
              </p>
              <p>
                For the vector index (which gives the system the flexibility to
                understand natural language queries), we use state of the art
                prefix-aware embedding models trained with contrastive loss.
                Optionally the system can be configured to go over each doc with
                multiple passes of different granularity to capture wide context
                vs fine details. We also supplement the vector search with a
                keyword based BM25 index + N-Grams so that the system performs
                well even in low data domains. Additionally we’ve added in
                learning from feedback and time based decay—see our custom
                ranking function (<a
                  href="https://github.com/danswer-ai/danswer/blob/main/backend/danswer/document_index/vespa/app_config/schemas/danswer_chunk.sd#L187"
                  >https://github.com/danswer-ai/danswer/blob/main/backend/dans...</a
                >
                – this flexibility is why we love Vespa as a Vector DB).
              </p>
              <p>
                At query time, we preprocess the query with query-augmentation,
                contextual-rephrasing, as well as standard techniques like
                removing stopwords and lemmatization. Once the top documents are
                retrieved, we ask a smaller LLM to decide which of the chunks
                are “useful for answering the query” (this is something we
                haven’t seen much of elsewhere, but our tests have shown to be
                one of the biggest drivers for both precision and recall).
                Finally the most relevant passages are passed to the LLM along
                with the user query and chat history to produce the final
                answer. We post-process by checking guardrails and extracting
                citations to link the user to relevant documents. (<a
                  href="https://github.com/danswer-ai/danswer/blob/main/backend/danswer/prompts/chat_prompts.py#L20"
                  >https://github.com/danswer-ai/danswer/blob/main/backend/dans...</a
                >)
              </p>
              <p>
                The Vector and Keyword indices are both stored locally and the
                NLP models run on the same instance (we’ve chosen ones that can
                run without GPU). The only exception is that the default
                Generative model is OpenAI’s GPT, however this can also be
                swapped out (<a
                  href="https://docs.danswer.dev/gen_ai_configs/overview"
                  >https://docs.danswer.dev/gen_ai_configs/overview</a
                >).
              </p>
              <p>
                We’ve seen teams use Danswer on problems like: Improving
                turnaround times for support by reducing time taken to find
                relevant documentation; Helping sales teams get customer context
                instantly by combing through calls and notes; Reducing lost
                engineering time from answering cross-team questions, building
                duplicate features due to inability to surface old tickets or
                code merges, and helping on-calls resolve critical issues faster
                by providing the complete history on an error in one place;
                Self-serving onboarding for new members who don’t know where to
                find information.
              </p>
              <p>
                If you’d like to play around with things locally, check out the
                quickstart guide here:
                <a href="https://docs.danswer.dev/quickstart"
                  >https://docs.danswer.dev/quickstart</a
                >. If you already have Docker, you should be able to get things
                up and running in &lt;15 minutes. And for folks who want a
                zero-effort way of trying it out or don’t want to self-host,
                please visit our Cloud:
                <a href="https://www.danswer.ai/">https://www.danswer.ai/</a>
              </p>
            </div>
          </section>
        </section>
        <section id="39465485">
          <h3>
            <a
              class="item"
              href="https://20y.hu/~slink/journal/xylophone-duplo/"
              >The Xylophone Maze: Screen-free coding for children</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 11:09:20</span
              ><span class="points-container"
                >Points: <span class="points">248</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39465485"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39465049">
          <h3>
            <a
              class="item"
              href="https://hypercubed.github.io/joy/html/j02maf.html"
              >Mathematical Foundations of Joy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 09:42:26</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39465049"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39464998">
          <h3>
            <a class="item" href="https://forum.igkt.net/index.php?topic=4028.0"
              >Knots on Mars (and a few thoughts on NASA's knots) (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 09:33:35</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39464998"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39464938">
          <h3>
            <a
              class="item"
              href="https://fossil-scm.org/home/doc/trunk/www/sync.wiki"
              >The Fossil Sync Protocol</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-22 @ 09:24:17</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39464938"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39455522">
          <h3>
            <a
              class="item"
              href="https://archive.org/details/graphicpresentat00brinrich"
              >Graphic Presentation (1939)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 16:05:55</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39455522"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39453468">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2024/02/you-can-now-browse-charles-darwins-complete-personal-library-online/"
              >Darwin Online has virtually reassembled the naturalist's personal
              library</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 13:26:47</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39453468"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39451800">
          <h3>
            <a
              class="item"
              href="https://mikkeldengsoe.substack.com/p/data-will-not-tell-you-what-to-do"
              >Data will not tell you what to do</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 09:32:38</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39451800"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
