<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35839350">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41541-023-00661-7"
              >Risk assessment of retinal vascular occlusion after Covid-19
              vaccination</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 08:26:25</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35839350"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35838751">
          <h3>
            <a
              class="item"
              href="https://www.gotheborg.se/news/rescue-of-sailing-boat/"
              >Sailing Boat Rescued by the Götheborg</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 06:44:17</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35838751"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35838741">
          <h3>
            <a
              class="item"
              href="https://support.upwork.com/hc/en-us/articles/211062538-Freelancer-Service-Fees"
              >Upwork removing 5% commission bracket and moving everyone to 10%
              bracket</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 06:42:52</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35838741"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35838601">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/?p=108122"
              >How is it even possible to cheat on a musical performance
              practical exam?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 06:16:12</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35838601"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35838504">
          <h3>
            <a class="item" href="https://github.com/nadermx/backgroundremover"
              >Open source Background Remover: Remove Background from images and
              video using AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 05:58:09</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35838504"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35838407">
          <h3>
            <a class="item" href="https://www.gatesnotes.com/Wyoming-TerraPower"
              >I’m in Wyoming to celebrate the next nuclear breakthrough</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 05:43:06</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35838407"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35838222">
          <h3>
            <a
              class="item"
              href="https://www.ribbonfarm.com/2023/05/04/life-after-language/"
              >Life After Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 05:08:40</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35838222"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35837750">
          <h3>
            <a
              class="item"
              href="https://prirai.github.io/books/unix-koans.html"
              >Unix Koans</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 03:40:37</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35837750"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35837606">
          <h3>
            <a class="item" href="https://vaonis.com/hyperia/en/"
              >Vaonis Hyperia: $45k digital telescope</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 03:13:43</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35837606"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35837424">
          <h3>
            <a class="item" href="https://rachelbythebay.com/w/2023/05/05/dot/"
              >Fulfilling a reader's request for my “dot files”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 02:35:32</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35837424"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35836976">
          <h3>
            <a class="item" href="https://github.com/openai/shap-e"
              >Shap-E: Generate 3D objects conditioned on text or images</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 01:07:44</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35836976"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35836933">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35836933"
              >Generally Intelligent (YC S17) Is Hiring Senior Software Engineer
              (Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 01:00:08</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Machine Learning Engineer (Remote, Contract or Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/9411e2ec-502a-403f-a39a-0d44c676b6af?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/9411e2ec-502a-403...</a
                >
              </p>
              <p>
                Research Scientist (SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/6c25a25c-35ec-4d7b-8d7e-40e9c4c85fba?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/6c25a25c-35ec-4d7...</a
                >
              </p>
              <p>
                Machine Learning Research Engineer (SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/c2f4a435-1eef-489a-9972-fba95e4a0296?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/c2f4a435-1eef-489...</a
                >
              </p>
              <p>
                Systems Engineer (Remote or SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/7afede07-8f22-4c49-b247-19e1a0ca6953?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/7afede07-8f22-4c4...</a
                >
              </p>
              <p>
                Technical Lead Manager (SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/75fac008-22e5-49ab-9f4e-a4c459b52b41?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/75fac008-22e5-49a...</a
                >
              </p>
              <p>
                Infrastructure Engineer (Remote or SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/e66a55a3-a117-406c-9b07-8ba055047cea?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/e66a55a3-a117-406...</a
                >
              </p>
              <p>
                Senior Software Engineer (Remote, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/38a93a78-fb8d-4614-bb12-b6277a7f874e?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/38a93a78-fb8d-461...</a
                >
              </p>
              <p>
                Technical Interviewer (Remote or SF, Contract):
                <a
                  href="https://jobs.lever.co/generallyintelligent/8443234d-a8c7-439f-bb8a-8142e713edc4?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/8443234d-a8c7-439...</a
                >
              </p>
              <p>Technical Recruiter/Talent Coach (SF, Full-time):</p>
              <p>
                <a
                  href="https://jobs.lever.co/generallyintelligent/c4c09fff-ec4a-4965-9245-590750752285"
                  >https://jobs.lever.co/generallyintelligent/c4c09fff-ec4a-496...</a
                >
              </p>
              <p>
                Theory Engineer:
                <a
                  href="https://jobs.lever.co/generallyintelligent/63499488-91b1-4154-956e-26551d7ac500?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/63499488-91b1-415...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="35836679">
          <h3>
            <a class="item" href="https://www.unionx.io/"
              >Show HN: UnionX – GPT4-powered Copilot for Work with
              Jupyter-style notebooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-06 @ 00:14:07</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35836679"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <p>
                We're excited to introduce UnionX, an AI Copilot for Work
                designed to revolutionize the way you perform research, write
                long documents, and extract insights. Our platform is perfect
                for PMs, students, lawyers, finance professionals, and more.
              </p>
              <p>
                UnionX is built on cutting-edge technology, leveraging OpenAI's
                GPT4 model and Jupyter notebook-style workflows to create a
                seamless, AI-powered experience. Our block-based editor allows
                you to easily upload documents, analyze them, and generate new
                insights or docs with the help of AI. If you don't have ideas
                about what to do with your data, UnionX provides AI Actions that
                provide common and AI-generated suggestions to help you
                transform your documents and deliver your work on time.
              </p>
              <p>Some key features include:</p>
              <p>- Jupyter-style notebooks</p>
              <p>- Document &amp; spreadsheet editors</p>
              <p>- AI action &amp; chat blocks</p>
              <p>- Knowledge bases with large document support</p>
              <p>- Visualizations (coming soon)</p>
              <p>- Form filling (coming soon)</p>
              <p>
                Give our GPT4-powered beta a try for free and let us know what
                you think!
              </p>
              <p>
                Check it out: <a href="https://unionx.io">https://unionx.io</a>
              </p>
              <p>-David</p>
            </div>
          </section>
        </section>
        <section id="35836541">
          <h3>
            <a
              class="item"
              href="https://blog.zulip.com/2023/05/04/when-free-forever-is-4-months/"
              >When “free forever” means “free for the next 4 months”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 23:48:48</span
              ><span class="points-container"
                >Points: <span class="points">300</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35836541"
                  >Comments</a
                ><span class="descendants">: 165</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35836411">
          <h3>
            <a
              class="item"
              href="https://www.together.xyz/blog/redpajama-models-v1"
              >Releasing 3B and 7B RedPajama</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 23:29:11</span
              ><span class="points-container"
                >Points: <span class="points">300</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35836411"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35836115">
          <h3>
            <a class="item" href="https://gmunk.com/TRON-Legacy"
              >A Detailed Look Into The Making of Tron Legacy VFX</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 22:57:25</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35836115"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35835971">
          <h3>
            <a class="item" href="https://haasie.com"
              >Show HN: Avoiding Imgur Link Rot</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 22:40:23</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35835971"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
            <div class="text">
              <p>
                Then on Saturday, two weeks ago, I learnt that Imgur was going
                to delete all anonymous &amp; NSFW files on the 15th of May. It
                was pointed out that this would mean broken links in communities
                that had relied on Imgur. By the Sunday I had decided that I
                would build another DAM, initially with the intent of avoiding
                Imgur link rot.
              </p>
              <p>
                It was challenging to find time to spend on this, the project
                was put together over about 8 evenings. It still has rough
                patches, this is an early MVP (a Michael Seibel "brick").
              </p>
              <p>
                I have many ideas of where to take this project, but for now it
                only does one thing: backup Imgur files and produce new links
                that are easy to swap out for old soon-to-be-deleted Imgur
                links.
              </p>
            </div>
          </section>
        </section>
        <section id="35834106">
          <h3>
            <a
              class="item"
              href="https://blueskyweb.xyz/blog/5-5-2023-federation-architecture"
              >Bluesky's AT Protocol - Federation Architecture Overview</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 19:33:23</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35834106"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35834037">
          <h3>
            <a
              class="item"
              href="https://www.allthingsdistributed.com/2023/05/monoliths-are-not-dinosaurs.html"
              >Monoliths are not dinosaurs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 19:28:04</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35834037"
                  >Comments</a
                ><span class="descendants">: 135</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35832876">
          <h3>
            <a class="item" href="https://pioneerspacesim.net"
              >Pioneer – An Open Source space adventure game set in our
              galaxy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 17:58:53</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35832876"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35832802">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2305.01625"
              >Unlimiformer: Long-Range Transformers with Unlimited Length
              Input</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 17:53:50</span
              ><span class="points-container"
                >Points: <span class="points">289</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35832802"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35829733">
          <h3>
            <a class="item" href="https://quii.dev/HTMX_is_the_Future"
              >Htmx Is the Future</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 14:32:19</span
              ><span class="points-container"
                >Points: <span class="points">701</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35829733"
                  >Comments</a
                ><span class="descendants">: 531</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35828046">
          <h3>
            <a
              class="item"
              href="https://www.jeffgeerling.com/blog/2023/build-your-own-private-wireguard-vpn-pivpn"
              >Build your own private WireGuard VPN with PiVPN</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 11:49:46</span
              ><span class="points-container"
                >Points: <span class="points">474</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35828046"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35824654">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/books/2023/05/03/dean-koontz/"
              >What scares master of suspense Dean Koontz? Plenty</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-05 @ 02:39:05</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35824654"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35814707">
          <h3>
            <a
              class="item"
              href="https://blog.waymo.com/2023/05/waymo-one-doubles-service-area-in.html"
              >Waymo One doubles service area in Phoenix, continues growing in
              SF</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-04 @ 13:10:36</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35814707"
                  >Comments</a
                ><span class="descendants">: 278</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35813950">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/930173/c1a1f68dc4e20191/"
              >A Linux kernel without struct buffer_head</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-04 @ 11:51:02</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35813950"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35813322">
          <h3>
            <a
              class="item"
              href="https://www.semianalysis.com/p/google-we-have-no-moat-and-neither"
              >Google “We have no moat, and neither does OpenAI”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-04 @ 10:19:13</span
              ><span class="points-container"
                >Points: <span class="points">2224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35813322"
                  >Comments</a
                ><span class="descendants">: 994</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35813010">
          <h3>
            <a
              class="item"
              href="https://www.sfgate.com/obscuresf/article/nimitz-mansion-hidden-under-bay-bridge-17999245.php"
              >A mansion hidden directly under the Bay Bridge</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-04 @ 09:25:10</span
              ><span class="points-container"
                >Points: <span class="points">297</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35813010"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35806306">
          <h3>
            <a class="item" href="https://notes.mmm.page/paper"
              >An Internet Canvas</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-03 @ 19:00:06</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35806306"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35795177">
          <h3>
            <a
              class="item"
              href="https://www.macarthur.me/posts/maps-for-dom-nodes"
              >Why I Like Using Maps (and WeakMaps) for Handling DOM Nodes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-02 @ 22:42:13</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35795177"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
