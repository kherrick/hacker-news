<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40327872">
          <h3>
            <a
              class="item"
              href="https://torrentfreak.com/supreme-court-theres-no-time-limit-on-copyright-infringement-claims-240510/"
              >Supreme Court: There's No 'Time Limit' on Copyright Infringement
              Claims</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 13:19:25</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40327872"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40327857">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/NVIDIA-R560-Open-Default"
              >Nvidia Open GPU Linux Kernel Driver Soon Be the Default for
              Turing, Newer GPUs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 13:15:58</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40327857"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40327782">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Kardashev_scale"
              >Kardashev Scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 13:03:31</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40327782"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40327631">
          <h3>
            <a class="item" href="https://peazip.github.io/"
              >PeaZip: Open-source file compression and encryption software</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 12:19:00</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40327631"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40327307">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20240510-floppy-disks-why-some-people-are-still-in-love-with-this-obsolete-computer-storage-technology"
              >People who won't give up floppy disks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 10:41:22</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40327307"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40327279">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2405.05097"
              >Multidirectional joint distribution neurons reducing to KAN</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 10:35:19</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40327279"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40327236">
          <h3>
            <a class="item" href="https://tmpout.sh/3/03.html"
              >Unix Viruses 25th Anniversary Edition</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 10:21:03</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40327236"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40326615">
          <h3>
            <a class="item" href="https://github.com/NHAS/wag"
              >Show HN: Wag, MFA and Enrollment for WireGuard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 07:31:23</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40326615"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been building this project as both a side project and my
                job for a little while now. The rationale behind it is while
                wireguard is a fantastic protocol cryptographically it leaves a
                lot to be desired when it comes to enrollment and end user
                device security.
              </p>
              <p>
                Obviously instead of using an off the shelf solution like
                tailscale, I decided to reinvent the wheel which has honestly
                been quite fun with learning about eBPF, and recently clustering
                and HA with etcd!
              </p>
              <p>
                The most recent version (in the docker container) contains about
                6 months of very new work bringing it all from sqlite3 to etcd.
                So please be forgiving if it does some weird things!
              </p>
              <p>Hope you all enjoy!</p>
              <p>
                P.s Im not a web developer and any tips on that front to make it
                less teeth pullingly awful are welcome!
              </p>
            </div>
          </section>
        </section>
        <section id="40326563">
          <h3>
            <a
              class="item"
              href="https://github.com/francisrstokes/githublog/blob/main/2024/5/10/cordic.md"
              >Why the CORDIC algorithm lives rent-free in my head</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 07:18:39</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40326563"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40326507">
          <h3>
            <a class="item" href="https://bitmovin.com/careers/"
              >Bitmovin (YC S15) Is Hiring Interns in Sales, Engineering, HR in
              Austria</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 07:00:20</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40326362">
          <h3>
            <a
              class="item"
              href="https://karthinks.com/software/emacs-window-management-almanac/"
              >The Emacs Window Management Almanac</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 06:19:00</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40326362"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40326305">
          <h3>
            <a
              class="item"
              href="https://rjlipton.com/2014/08/19/the-derivative-of-a-number/"
              >The Derivative of a Number (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 06:03:58</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40326305"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40326269">
          <h3>
            <a
              class="item"
              href="https://overengineer.dev/blog/2024/05/10/thread/"
              >Thread: Tech we can’t use or teach?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-11 @ 05:51:18</span
              ><span class="points-container"
                >Points: <span class="points">245</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40326269"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40324179">
          <h3>
            <a
              class="item"
              href="https://www.foto-webcam.eu/webcam/lucknerhaus/"
              >Most of Europe is glowing pink under the aurora</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 21:59:03</span
              ><span class="points-container"
                >Points: <span class="points">1175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40324179"
                  >Comments</a
                ><span class="descendants">: 307</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40321821">
          <h3>
            <a
              class="item"
              href="https://www.spaceweatherlive.com/en/news/view/533/20240510-cme-impact-imminent-two-more-earth-directed-cmes.html"
              >Coronal mass ejection impact imminent, two more earth-directed
              CMEs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 17:50:52</span
              ><span class="points-container"
                >Points: <span class="points">469</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40321821"
                  >Comments</a
                ><span class="descendants">: 345</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40320406">
          <h3>
            <a
              class="item"
              href="https://www.simonsfoundation.org/2024/05/10/simons-foundation-co-founder-mathematician-and-investor-jim-simons-dies-at-86/"
              >Jim Simons has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 15:51:01</span
              ><span class="points-container"
                >Points: <span class="points">1060</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40320406"
                  >Comments</a
                ><span class="descendants">: 294</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40318714">
          <h3>
            <a class="item" href="https://github.com/MHNightCat/superfile"
              >Superfile – A fancy, pretty terminal file manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 13:27:20</span
              ><span class="points-container"
                >Points: <span class="points">364</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40318714"
                  >Comments</a
                ><span class="descendants">: 180</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40318542">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40318542"
              >Show HN: A web debugger an ex-Cloudflare team has been working on
              for 4 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 13:08:38</span
              ><span class="points-container"
                >Points: <span class="points">798</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40318542"
                  >Comments</a
                ><span class="descendants">: 194</span></span
              >
            </h4>
            <div class="text">
              <a href="https://jam.dev">https://jam.dev</a>
              <p>
                It’s called Jam and it prevents product managers (like I used to
                be) from being able to create vague and un-reproducible bug
                tickets (like I used to create).
              </p>
              <p>
                It’s actually really hard as a non-engineer to file useful bug
                tickets for engineers. Like, sometimes I thought I included a
                screenshot, but the important information the engineer needed
                was what was actually right outside the boundary of the
                screenshot I took. Or I'd write that something "didn't work" but
                the engineer wasn't sure if I meant that it returned an error or
                if it was unresponsive. So the engineer would be frustrated, I
                would be frustrated, and fixing stuff would slow to a halt while
                we went back and forth to clarify how to repro the issue over
                async Jira comments.
              </p>
              <p>
                It’s actually pretty crazy that while so much has changed in how
                we develop software (heck, we have types in javascript now*),
                the way we capture and report bugs is just as manual and lossy
                as it was in the 1990’s. We can run assembly in the browser but
                there’s still no tooling to help a non-engineer show a bug to an
                engineer productively.
              </p>
              <p>
                So that’s what Jam is. Dev tools + video in a link. It’s like a
                shareable HAR file synced to a video recording of the session.
                And besides video, you can use it to share an instant replay of
                a bug that just happened — basically a 30 second playback of the
                DOM as a video.
              </p>
              <p>
                We’ve spent a lot of time adding in a ton of niceties, like Jam
                writes automatic repro steps for you, and Jam’s dev tools use
                the same keyboard shortcuts you’re used to in Chrome dev tools,
                and our team’s personal favorite: Jam parses GraphQL responses
                and pulls out mutation names and errors (which is important
                because GraphQL uses one endpoint for all requests and always
                returns a 200, meaning you usually have to sift through every
                GraphQL request when debugging to find the one you’re looking
                for)
              </p>
              <p>
                We’re now 2 years in to the product being live and people have
                used Jam to fix more than 2 million bugs - which makes me so
                happy - but there’s still a ton to do. I wanted to open up for
                discussion here and get your feedback and opinions how can we
                make it even more valuable for you debugging?
              </p>
              <p>
                The worst part of the engineering job is debugging and not even
                being able to repro the issue, it’s not even really engineering,
                it’s just a communication gap, one that we should be able to
                solve with tools. So yeah excited to get your feedback and hear
                your thoughts how we can make debugging just a little less
                frustrating.
              </p>
              <p>
                (Jam is free to use forever — there is a paid tier for features
                real companies would need, but we’re keeping a large free plan
                forever. We learned to build products at Cloudflare and free
                tier is in our ethos, both my co-founder and I and about half
                the team is ex-Cloudflare) and what we loved there is how much
                great feedback we’d get because the product was mostly free to
                use. We definitely want to keep that going at Jam.)
              </p>
              <p>
                By the way, we’re hiring engineers and if this is a problem that
                excites you, we’d love to chat: jam.dev/careers
              </p>
            </div>
          </section>
        </section>
        <section id="40317629">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/05/09/science/hot-water-sound-cold.html"
              >You Can Hear the Temperature of Water</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 11:22:34</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40317629"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40317455">
          <h3>
            <a class="item" href="https://plasticscanner.com/"
              >Plastic Scanner</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 10:58:52</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40317455"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40317375">
          <h3>
            <a class="item" href="http://zuse-z1.zib.de/simulations/eniac/"
              >ENIAC Simulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 10:49:18</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40317375"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40316319">
          <h3>
            <a class="item" href="https://arxiv.org/pdf/cs/9301105"
              >The Foundation of a Generic Theorem Prover (1989) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 07:41:22</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40316319"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40315990">
          <h3>
            <a
              class="item"
              href="https://vgamuseum.info/images/doc/unreleased/pyramid3d/tritechpyramid3dpresentation.pdf"
              >Pyramid3D Real-time Graphics Processor (1997) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 06:35:59</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40315990"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40315724">
          <h3>
            <a class="item" href="https://www.multicians.org/unix.html"
              >Unix and Multics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 05:25:26</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40315724"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40315686">
          <h3>
            <a
              class="item"
              href="https://stevenharman.net/so-we-have-a-memory-leak"
              >So We've Got a Memory Leak</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-10 @ 05:14:14</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40315686"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40313613">
          <h3>
            <a
              class="item"
              href="https://www.nasa.gov/missions/roman-space-telescope/how-nasas-roman-mission-will-hunt-for-primordial-black-holes/"
              >Nasa’s Roman Mission Will Hunt for Primordial Black Holes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-09 @ 22:33:44</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40313613"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40313264">
          <h3>
            <a class="item" href="https://ventrella.com/Clusters/"
              >Life-like particle system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-09 @ 21:47:13</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40313264"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40292537">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40292537"
              >Seeking Ideas for Preschool/School Projects</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-07 @ 23:04:30</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40292537"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              <p>
                I have a background in computer science, primarily focused on
                web development these days. Additionally, I have loads of
                potentially useful toys at home, including a 3D printer, DIY CNC
                mill, webcams, Raspberry Pis, old laptops, etc.
              </p>
              <p>
                What are some engaging activities or projects I could bring to
                either level of the schools that would be both fun and
                educational for the kids? Particularly ideas we could do as a
                class vs breaking into smaller groups.
              </p>
              <p>
                I have had a couple of ideas so far - Processing based art
                interactive which the kids can suggest updates for and instantly
                see the changes. - Something RTLSDR based, so we can play with
                antennas and catch some radio waves.
              </p>
              <p>
                Looking forward to your creative ideas and suggestions, thank
                you.
              </p>
            </div>
          </section>
        </section>
        <section id="40275328">
          <h3>
            <a
              class="item"
              href="https://animationobsessive.substack.com/p/selling-ghost-in-the-shell"
              >Selling 'Ghost in the Shell'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 14:48:02</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40275328"
                  >Comments</a
                ><span class="descendants">: 135</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40258903">
          <h3>
            <a class="item" href="https://deno.com/blog/building-deno-kv"
              >Deno KV internals: building a database for the modern web</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-04 @ 17:01:25</span
              ><span class="points-container"
                >Points: <span class="points">210</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40258903"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
