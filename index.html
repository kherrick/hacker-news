<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45672788">
          <h3>
            <a
              class="item"
              href="https://blog.bostonorganics.com/chinas-42600-ton-meng-xiang-aims-drill-7-miles-deep-breaking-records/"
              >42,600 ton ship to break the world record for the deepest drill
              at 7 miles</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 17:56:54</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45672788"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45672405">
          <h3>
            <a
              class="item"
              href="https://arctotherium.substack.com/p/llm-exchange-rates-updated"
              >How do LLM's trade off lives between different categories?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 17:30:43</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45672405"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45672336">
          <h3>
            <a class="item" href="https://stalw.art/blog/jmap-collaboration/"
              >JMAP for Calendars, Contacts and Files Now in Stalwart</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 17:26:06</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45672336"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45672235">
          <h3>
            <a
              class="item"
              href="https://www.hp.com/us-en/printers/site-print/layout-robot.html"
              >HP SitePrint</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 17:18:33</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45672235"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45672199">
          <h3>
            <a
              class="item"
              href="https://manuelmoreale.com/thoughts/look-another-ai-browser"
              >Look, Another AI Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 17:15:38</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45672199"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45672035">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/bild-ai/jobs/m2ilR5L-founding-engineer-applied-ai"
              >Bild AI (YC W25) Is Hiring a Founding AI Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 17:02:10</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45671871">
          <h3>
            <a
              class="item"
              href="https://blog.google/products/android/samsung-galaxy-xr/"
              >Introducing Galaxy XR, the first Android XR headset</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 16:50:28</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45671871"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45671778">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/news/804253/meta-ai-research-layoffs-fair-superintelligence"
              >Meta is axing 600 roles across its AI division</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 16:44:43</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45671778"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45670516">
          <h3>
            <a class="item" href="http://www.kafalas.com/Logtime.html"
              >The Logarithmic Time Perception Hypothesis</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 15:20:59</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45670516"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45670443">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/research/quantum-echoes-willow-verifiable-quantum-advantage/"
              >Willow quantum chip demonstrates verifiable quantum advantage on
              hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 15:16:19</span
              ><span class="points-container"
                >Points: <span class="points">243</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45670443"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45670052">
          <h3>
            <a
              class="item"
              href="https://evanhahn.com/scripts-i-wrote-that-i-use-all-the-time/"
              >Scripts I wrote that I use all the time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 14:53:54</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45670052"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45669906">
          <h3>
            <a
              class="item"
              href="https://vexlio.com/features/interactive-diagrams-with-popups/"
              >Show HN: Create interactive diagrams with pop-up content</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 14:45:03</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45669906"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                TL;DR: easy creation of interactive diagrams, meaning diagrams
                that have mouse click/hover hooks that you can use to display
                pop-up content. The end result can be shared with a
                no-sign-in-required web link.
              </p>
              <p>
                My thought is that this is useful for system docs, onboarding or
                user guides, presentations, etc. Anything where there is a
                high-level view that should remain uncluttered + important
                metadata or details that still need to be available somewhere.
              </p>
              <p>
                You can try it out without signing up for anything, just launch
                the app here (<a href="https://app.vexlio.com/"
                  >https://app.vexlio.com/</a
                >), create a shape, select it with the main pointer tool and
                then click "Add popup" on the context toolbar.
              </p>
              <p>I'd be grateful for any and all feedback!</p>
            </div>
          </section>
        </section>
        <section id="45669593">
          <h3>
            <a
              class="item"
              href="https://www.botanica.software/blog/cryptographic-issues-in-cloudflares-circl-fourq-implementation"
              >Cryptographic Issues in Cloudflare's Circl FourQ Implementation
              (CVE-2025-8556)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 14:22:41</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45669593"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45669142">
          <h3>
            <a class="item" href="https://dfir.ch/posts/linux_capabilities/"
              >Linux Capabilities Revisited</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 13:50:20</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45669142"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45668990">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/mediacentre/2025/new-ebu-research-ai-assistants-news-content"
              >AI assistants misrepresent news content 45% of the time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 13:39:26</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45668990"
                  >Comments</a
                ><span class="descendants">: 234</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45668264">
          <h3>
            <a
              class="item"
              href="https://quesma.com/blog/local-llms-security-paradox/"
              >The security paradox of local LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 12:48:01</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45668264"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45668160">
          <h3>
            <a class="item" href="https://www.source.dev/journal/sourcefs"
              >SourceFS: A 2h+ Android build becomes a 15m task with a virtual
              filesystem</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 12:39:37</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45668160"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45667866">
          <h3>
            <a
              class="item"
              href="https://nednex.com/en/the-internets-biggest-annoyance-why-cookie-laws-should-target-browsers-not-websites/"
              >Internet's biggest annoyance: Cookie laws should target browsers,
              not websites</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 12:12:28</span
              ><span class="points-container"
                >Points: <span class="points">424</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45667866"
                  >Comments</a
                ><span class="descendants">: 446</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45666327">
          <h3>
            <a class="item" href="https://github.com/FarisZR/knocker"
              >Knocker, a knock based access control system for your homelab</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 08:37:31</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45666327"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45665452">
          <h3>
            <a
              class="item"
              href="https://github.com/minio/minio/issues/21647#issuecomment-3418675115"
              >MinIO stops distributing free Docker images</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 06:17:18</span
              ><span class="points-container"
                >Points: <span class="points">546</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45665452"
                  >Comments</a
                ><span class="descendants">: 332</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45665311">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cvgkm2j0xelo"
              >French ex-president Sarkozy begins jail sentence</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 05:49:58</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45665311"
                  >Comments</a
                ><span class="descendants">: 413</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45664848">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/p/evaluating-the-infinity-cache-in"
              >Evaluating the Infinity Cache in AMD Strix Halo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 04:20:09</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45664848"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45662368">
          <h3>
            <a
              class="item"
              href="https://drobinin.com/posts/designing-software-for-things-that-rot/"
              >Designing software for things that rot</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-21 @ 22:10:18</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45662368"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45633900">
          <h3>
            <a
              class="item"
              href="https://interconnected.org/home/2025/10/13/dichotomy"
              >Cyborgs vs. rooms, two visions for the future of computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-19 @ 13:16:25</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45633900"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45620330">
          <h3>
            <a
              class="item"
              href="https://commons.wikimedia.org/wiki/User:Birdman86"
              >Die shots of as many CPUs and other interesting chips as
              possible</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-17 @ 18:39:22</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45620330"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45605556">
          <h3>
            <a
              class="item"
              href="https://www.edn.com/poe-basics-and-beyond-what-every-engineer-should-know/"
              >Power over Ethernet (PoE) basics and beyond</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 14:09:21</span
              ><span class="points-container"
                >Points: <span class="points">236</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45605556"
                  >Comments</a
                ><span class="descendants">: 191</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45601855">
          <h3>
            <a
              class="item"
              href="https://www.backblaze.com/blog/backblaze_drive_farming/"
              >Farming Hard Drives (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-16 @ 05:50:39</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45601855"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45566730">
          <h3>
            <a class="item" href="https://cadenceguitar.com/"
              >Show HN: Cadence – A Guitar Theory App</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 10:18:29</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45566730"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
            <div class="text">
              <p>
                The idea was to make something for the eternally "intermediate"
                guitarist (myself included). There are a lot of beginner apps
                which rely on learning songs, toolkits which give you a bunch of
                stuff with no explanation but not many in-between apps to
                actually learn and practice more generic and somewhat advanced
                stuff.
              </p>
              <p>
                The app contains short lessons, recaps and most importantly
                challenges (visual, audio and pure theory) along with a very
                complete library.
              </p>
              <p>
                The challenges are made for practicing, they will get
                increasingly harder and getting to the max score is supposed to
                be quite hard. The idea being that you have to repeat them
                regularly until your brain has integrated the info and it flows
                naturally rather than being a one time quick dopamine shot. This
                is partly inspired by how language learning apps work.
              </p>
              <p>
                It has no ads, a lifetime purchase option and you can use it
                without an account if you don't care about multi-device sync or
                backing up your progress.
              </p>
              <p>
                Android:
                <a
                  href="https://play.google.com/store/apps/details?id=com.apizon.cadence.android"
                  >https://play.google.com/store/apps/details?id=com.apizon.cad...</a
                >
              </p>
              <p>
                iOS:
                <a
                  href="https://apps.apple.com/us/app/cadence-guitar-theory/id6747011447?platform=iphone"
                  >https://apps.apple.com/us/app/cadence-guitar-theory/id674701...</a
                >
              </p>
              <p>
                (This is my second and last post about this sorry for spam. My
                first post a few weeks ago didn't get any views and posting on a
                saturday might not have helped...)
              </p>
            </div>
          </section>
        </section>
        <section id="45565793">
          <h3>
            <a
              class="item"
              href="https://harrisoncramer.me/15-go-sublteties-you-may-not-already-know/"
              >Go subtleties</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 07:42:43</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45565793"
                  >Comments</a
                ><span class="descendants">: 141</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45543746">
          <h3>
            <a
              class="item"
              href="https://github.com/OpenDevicePartnership/patina"
              >Patina: a Rust implementation of UEFI firmware</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-10 @ 21:02:00</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45543746"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
