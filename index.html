<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46352248">
          <h3>
            <a class="item" href="https://kellett.im/a/inverse-parentheses"
              >Inverse Parentheses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-22 @ 08:29:03</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46352248"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46352047">
          <h3>
            <a
              class="item"
              href="https://qb64phoenix.com/forum/showthread.php?tid=4244"
              >QBasic64 Phoenix 4.3.0 Released</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-22 @ 07:25:43</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46352047"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46352004">
          <h3>
            <a
              class="item"
              href="https://eiratansey.com/2025/12/20/i-announced-my-divorce-on-instagram-and-then-ai-impersonated-me/"
              >I announced my divorce on Instagram and then AI impersonated
              me</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-22 @ 07:13:33</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46352004"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46351345">
          <h3>
            <a
              class="item"
              href="https://lcamtuf.substack.com/p/cursed-circuits-3-true-mathematics"
              >Cursed circuits #3: true mathematics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-22 @ 04:34:36</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46351345"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46350641">
          <h3>
            <a
              class="item"
              href="https://github.com/ibaryshnikov/android-iced-example"
              >Build Android apps using Rust and Iced</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-22 @ 02:14:32</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46350641"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                First things, I want to thank all the people who work on the
                foundational crates and tools such as: -
                <a href="https://github.com/rust-mobile/android-activity"
                  >https://github.com/rust-mobile/android-activity</a
                >
                -
                <a href="https://github.com/jni-rs/jni-rs"
                  >https://github.com/jni-rs/jni-rs</a
                >
                -
                <a href="https://github.com/gfx-rs/wgpu"
                  >https://github.com/gfx-rs/wgpu</a
                >
                -
                <a href="https://github.com/rust-windowing/winit"
                  >https://github.com/rust-windowing/winit</a
                >
                - and many others
              </p>
              <p>
                When I started I had to learn what tools and examples already
                exist. Luckily, there's a good set of examples using both
                NativeActivity and GameActivity:
                <a href="https://github.com/rust-mobile/rust-android-examples"
                  >https://github.com/rust-mobile/rust-android-examples</a
                >
              </p>
              <p>
                The basic approach is that we take android-activity, winit and
                wgpu and that's it. On top of that you can find a few egui
                examples in the rust-android-examples repo.
              </p>
              <p>
                Alright, so after I've got the basic examples running, I wanted
                to combine them with iced. Iced is a crossplatform gui library
                focusing on desktop and web. The mobile support is explicitly a
                non-goal, as far as I can tell at the moment of writing. Yet,
                there's an issue where some people posted their experiments.
                That's how I knew it was possible:
                <a href="https://github.com/iced-rs/iced/issues/302"
                  >https://github.com/iced-rs/iced/issues/302</a
                >
              </p>
              <p>
                There's a way to integrate iced in wgpu applications, so called
                integration example:
                <a
                  href="https://github.com/iced-rs/iced/tree/0.14.0/examples/integration"
                  >https://github.com/iced-rs/iced/tree/0.14.0/examples/integra...</a
                >
              </p>
              <p>
                Above I mentioned that using winit and wgpu in combination with
                android-activity is enough to build the app. Putting together 1
                + 1 I got 2: let's use iced integration example with
                android-activity. It was quite easy to compile with almost no
                errors. First issue I encountered is that there was no text
                rendered. I solved this by loading fonts the way it was shown
                here:
                <a
                  href="https://github.com/pop-os/cosmic-text/issues/243#issue-2189977938"
                  >https://github.com/pop-os/cosmic-text/issues/243#issue-21899...</a
                >
              </p>
              <p>
                Then I patched a few widgets to add touch support. And that's
                it. My role here was to take all the prior work and combine it
                together in a way that there's a working example.
              </p>
              <p>
                Some other ways of building Android apps using Rust: - xilem has
                an explicit goal to support mobile
                <a href="https://github.com/linebender/xilem"
                  >https://github.com/linebender/xilem</a
                >
                - egui supports mobile
                <a href="https://github.com/emilk/egui"
                  >https://github.com/emilk/egui</a
                >
                - game engines such as Fyrox and Bevy support mobile: -
                <a href="https://github.com/FyroxEngine/Fyrox"
                  >https://github.com/FyroxEngine/Fyrox</a
                >
                -
                <a href="https://github.com/bevyengine/bevy"
                  >https://github.com/bevyengine/bevy</a
                >
                - pretty much anything built on top of winit and wgpu
              </p>
              <p>
                All of the above is related to building native apps using either
                NativeActivity or GameActivity. I'm leaving webview out of scope
                of current post.
              </p>
              <p>
                What about iOS? As far as I know it should be similar or maybe
                simpler compared to Android. I haven't built it yet, but the
                next time I have a sizeable amount of free time, I'll try to
                make it work. The plan is the same: pick winit, wgpu, iced
                integration example, mix it together until it works. It'll
                require the same trick to load fonts, and maybe something else,
                but no visible blockers as of now.
              </p>
              <p>
                Once again, thanks to all the people who made it possible and I
                wish you have a great time building mobile apps with Rust!
              </p>
            </div>
          </section>
        </section>
        <section id="46350075">
          <h3>
            <a
              class="item"
              href="https://ym2132.github.io/ONNX_MLProgram_NN_exploration"
              >ONNX Runtime and CoreML May Silently Convert Your Model to
              FP16</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-22 @ 00:27:04</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46350075"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46348847">
          <h3>
            <a
              class="item"
              href="https://disneyparksblog.com/disney-experiences/robotic-olaf-marks-new-era-of-disney-innovation/"
              >Disney Imagineering Debuts Next-Generation Robotic Character,
              Olaf</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 21:46:20</span
              ><span class="points-container"
                >Points: <span class="points">192</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46348847"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46348455">
          <h3>
            <a
              class="item"
              href="https://www.bitsaboutmoney.com/archive/gift-card-accountability-sink/"
              >The gift card accountability sink</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 21:07:01</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46348455"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46348344">
          <h3>
            <a class="item" href="https://eulumdat.icu"
              >Show HN: Rust/WASM lighting data toolkit – parses legacy formats,
              generates SVGs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 20:56:54</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46348344"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built this to scratch my own itch and put it on crates.io and
                PyPI where nothing like it existed.
              </p>
              <p>
                The old file formats (EULUMDAT from 1990, IES from 1991) still
                work fine for basic photometry. But the industry is moving
                toward spectral data – full wavelength distributions instead of
                just lumen values.
              </p>
              <p>
                The new standards (TM-33, ATLA-S001) are barely supported by
                existing tools.
              </p>
              <p>
                So this handles both: legacy formats for compatibility, spectral
                data for anyone who wants to work with the new standards.
              </p>
              <p>
                Stack: Rust core, then UniFFI for bindings. One codebase
                compiles to WASM/Leptos, egui, SwiftUI, Jetpack Compose, PyO3.
              </p>
              <p>
                At one point the generated Swift boilerplate got so large GitHub
                classified it as a Swift project. 3D viewer is Bevy, loaded
                on-demand.
              </p>
              <p>
                Feedback welcome – especially on the SVG output and the 3D
                viewer.
              </p>
              <p>
                <a href="https://github.com/holg/eulumdat-rs"
                  >https://github.com/holg/eulumdat-rs</a
                >
                (MIT/Apache-2.0)
              </p>
            </div>
          </section>
        </section>
        <section id="46348329">
          <h3>
            <a
              class="item"
              href="https://www.aiforswes.com/p/you-dont-need-to-spend-100mo-on-claude"
              >A guide to local coding models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 20:55:15</span
              ><span class="points-container"
                >Points: <span class="points">418</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46348329"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46348318">
          <h3>
            <a class="item" href="https://scottaaronson.blog/?p=9425"
              >More on whether useful quantum computing is “imminent”</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 20:53:34</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46348318"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46348262">
          <h3>
            <a class="item" href="https://rue-lang.dev/"
              >Rue: Higher level than Rust, lower level than Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 20:46:02</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46348262"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://steveklabnik.com/writing/thirteen-years-of-rust-and-the-birth-of-rue/"
                >https://steveklabnik.com/writing/thirteen-years-of-rust-and-...</a
              >
            </div>
          </section>
        </section>
        <section id="46347080">
          <h3>
            <a
              class="item"
              href="https://mastodon.online/@mullvadnet/115742530333573065"
              >The Going Dark initiative or ProtectEU is a Chat Control 3.0
              attempt</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 18:39:46</span
              ><span class="points-container"
                >Points: <span class="points">556</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46347080"
                  >Comments</a
                ><span class="descendants">: 191</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46345897">
          <h3>
            <a
              class="item"
              href="https://hackernews-readings-613604506318.us-west1.run.app"
              >Show HN: Books mentioned on Hacker News in 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 16:21:04</span
              ><span class="points-container"
                >Points: <span class="points">448</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46345897"
                  >Comments</a
                ><span class="descendants">: 162</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46345745">
          <h3>
            <a class="item" href="https://walletwallet.alen.ro/"
              >Show HN: WalletWallet – create Apple passes from anything</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 16:04:05</span
              ><span class="points-container"
                >Points: <span class="points">374</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46345745"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
            <div class="text">
              I got my Apple developer certificate and built a simple app to
              solve a problem I had. One shop I buy from doesn't have Apple
              Wallet passes. Since you need signed certificates to build these
              very simple things, I created a minimal app that signs them. It's
              available if you need it too. It won't scan cards with AI - you
              manually enter the barcode, which I think makes it less prone to
              error.
            </div>
          </section>
        </section>
        <section id="46345506">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/co2-battery-energy-storage"
              >CO2 batteries that store grid energy take off globally</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 15:27:36</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46345506"
                  >Comments</a
                ><span class="descendants">: 199</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46345205">
          <h3>
            <a
              class="item"
              href="https://her.esy.fun/posts/0031-how-i-protect-my-forgejo-instance-from-ai-web-crawlers/index.html"
              >How I protect my Forgejo instance from AI web crawlers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-21 @ 14:46:53</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46345205"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46338437">
          <h3>
            <a
              class="item"
              href="https://timthompson.com/plum/cgi/showlist.cgi?sort=name&amp;concise=yes"
              >Programming languages used for music</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-20 @ 18:40:45</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46338437"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46331292">
          <h3>
            <a
              class="item"
              href="https://linusakesson.net/programming/kernighans-lever/index.php"
              >Kernighan's Lever</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-19 @ 21:42:55</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46331292"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46327337">
          <h3>
            <a
              class="item"
              href="https://kyo.iroiro.party/en/posts/juicemacs-exploring-jit-for-elisp/"
              >Exploring Speculative JIT Compilation for Emacs Lisp with Java</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-19 @ 16:08:39</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46327337"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46325475">
          <h3>
            <a
              class="item"
              href="https://science.nasa.gov/missions/webb/nasas-webb-observes-exoplanet-whose-composition-defies-explanation/"
              >Webb observes exoplanet that may have an exotic helium and carbon
              atmosphere</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-19 @ 13:16:57</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46325475"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46322631">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/evaluating-chain-of-thought-monitorability/"
              >Evaluating chain-of-thought monitorability</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-19 @ 05:49:33</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46322631"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46316050">
          <h3>
            <a
              class="item"
              href="https://www.schneier.com/blog/archives/2025/12/deliberate-internet-shutdowns.html"
              >Deliberate Internet Shutdowns</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-18 @ 17:49:10</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46316050"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46314947">
          <h3>
            <a class="item" href="https://gearsco.de/blog/bit-array-syntax/"
              >Making the most of bit arrays in Gleam</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-18 @ 16:37:22</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46314947"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46294694">
          <h3>
            <a
              class="item"
              href="https://www.scd31.com/posts/programming-on-the-subway"
              >I program on the subway</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 21:23:18</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46294694"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46290875">
          <h3>
            <a class="item" href="https://felt.com/blog/lightning-tiles"
              >Lightning: Real-time editing for tiled map data</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 16:51:19</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46290875"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46287253">
          <h3>
            <a class="item" href="https://jyn.dev/i-m-just-having-fun/"
              >I'm just having fun</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 11:19:29</span
              ><span class="points-container"
                >Points: <span class="points">345</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46287253"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46286906">
          <h3>
            <a
              class="item"
              href="https://www.lbjgruppen.com/en/posts/flocking-quadtrees"
              >Functional Flocking Quadtree in ClojureScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 10:26:52</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46286906"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46286813">
          <h3>
            <a
              class="item"
              href="https://xania.org/202512/15-aliasing-in-general"
              >Aliasing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 10:13:45</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46286813"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46286061">
          <h3>
            <a
              class="item"
              href="https://doisinkidney.com/posts/2018-02-17-single-pass-huffman.html"
              >Single-Pass Huffman Coding</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 08:18:03</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46286061"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
