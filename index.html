<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44352254">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2025/06/22/tesla-launches-robotaxi-rides-in-austin-with-big-promises-and-unanswered-questions/"
              >Tesla launches robotaxi rides in Austin</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 03:34:23</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44352254"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44351817">
          <h3>
            <a class="item" href="https://github.com/sdzx-1/polystate"
              >Polystate: Composable Finite State Machines</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 01:47:00</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44351817"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44351798">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2506.14364"
              >Tensor Manipulation Unit (TMU): Reconfigurable, Near-Memory,
              High-Throughput AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 01:43:11</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44351798"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44351580">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44351580"
              >Optifye.ai (YC W25) – Founding Back End Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 01:00:00</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Optifye is an AI performance monitoring system for factory
                workers backed by Y Combinator. We put cameras in factories and
                use computer vision to find shop-floor inefficiencies in
                real-time.
              </p>
              <p>
                Our clients are industry-leading manufacturers in the garments,
                automotive, medical, and FMCG industries across the world.
              </p>
              <p>
                We are looking to hire founding team members as we enter a
                high-growth phase.
              </p>
              <p>Must haves:</p>
              <p>
                - Deep GPU, CPU, and memory optimization knowledge - Experience
                scaling an application in production - Architected containerized
                deployments on the cloud - Extremely quick learner
              </p>
              <p>
                Compensation: Equity + industry-leading salary Location:
                On-site, Gurgaon (India)
              </p>
              <p>
                It’s going to be brutal, you’re going to have a lot of work but
                once the dust settles - you will have higher returns than
                everyone around you.
              </p>
              <p>Good Luck!</p>
            </div>
          </section>
        </section>
        <section id="44351487">
          <h3>
            <a
              class="item"
              href="https://sublevelgames.github.io/blogs/2025-06-22-nurikabe-map-gen-with-wfc/"
              >Using Wave Function Collapse to solve puzzle map generation at
              scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 00:42:34</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44351487"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44351310">
          <h3>
            <a class="item" href="https://github.com/Sakura-sx/cf-shield"
              >CF-Shield – An open source tool to protect any website with
              Cloudflare</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 00:11:00</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44351310"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44351068">
          <h3>
            <a class="item" href="https://codeforces.com/blog/entry/143279"
              >Finding a billion factorials in 60 ms with SIMD</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 23:12:50</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44351068"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44351028">
          <h3>
            <a class="item" href="https://isle.pizza"
              >Show HN: Lego Island Playable in the Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 23:03:00</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44351028"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44350978">
          <h3>
            <a class="item" href="http://www.hawaiihighways.com/"
              >Hawaii Highways</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 22:55:58</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44350978"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44350450">
          <h3>
            <a class="item" href="https://radio.garden/?2025">Radio Garden</a>
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 21:28:54</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44350450"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44350322">
          <h3>
            <a
              class="item"
              href="https://fransskarman.com/phd_thesis_in_typst.html"
              >I wrote my PhD Thesis in Typst</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 21:12:01</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44350322"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44350002">
          <h3>
            <a
              class="item"
              href="https://www.romanklasen.com/blog/beating-brainrot-by-button/"
              >Using Home Assistant, adguard home and an $8 smart outlet to
              avoid brain rot</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 20:26:08</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44350002"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44349761">
          <h3>
            <a
              class="item"
              href="https://www.laphamsquarterly.org/content/episode-3-francine-prose"
              >Interview with Francine Prose on early-1970s San Francisco
              [audio]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 19:51:44</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44349761"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44349525">
          <h3>
            <a
              class="item"
              href="https://www.kleinbottle.com/Amazon_Brand_Hijacking.html"
              >Klein Bottle Amazon Brand Hijacking (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 19:18:41</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44349525"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44348813">
          <h3>
            <a class="item" href="https://philarchive.org/archive/SCHAIM-14"
              >AGI is Mathematically Impossible 2: When Entropy Returns</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 17:51:55</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44348813"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44348448">
          <h3>
            <a
              class="item"
              href="https://apps.apple.com/us/app/idle-reporter-for-nyc-dep/id6747315971"
              >Show HN: Report idling vehicles in NYC (and get a cut of the
              fines) with AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 17:06:51</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44348448"
                  >Comments</a
                ><span class="descendants">: 171</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've filed a few reports, and I found the process frustrating
                and error-prone. The forms are fiddly, there's way too much
                information that needs to be copied down from the video by hand,
                you have to use a third-party app to take a timestamped video
                and a different app to compress it before uploading, and
                approximately none of it can be done on your phone — the device
                you probably used to record your video in the first place.
              </p>
              <p>
                I built Idle Reporter to make filing complaints into a
                five-minute process that you can do entirely from your phone.
              </p>
              <p>
                Idle Reporter uses AI to automatically extract all the required
                information and screenshots from the video and fill out the form
                for you. It compresses your video, adds the required
                screenshots, and uploads the whole thing to DEP. All you have to
                do is log in, give it a final check, and submit.
              </p>
              <p>
                The AI features cost me money to run, so I put those behind a
                subscription ($5.99/month, which can pay for itself after a
                single report). There's a one-week free trial so you can test it
                out. All the other features — including a fully-featured
                timestamp camera, which other apps charge for, and an editor for
                filling out the forms manually and submitting in a single step —
                will be free forever, as a service to the community.
              </p>
              <p>
                The app is iOS-only for now — part of this was an exercise in
                learning SwiftUI in my spare time.
              </p>
              <p>
                Check it out on the App Store and let me know what you think!
              </p>
              <p>
                [1]:
                <a
                  href="https://www.nyc.gov/site/dep/environment/idling-citizens-air-complaint-program.page"
                  >https://www.nyc.gov/site/dep/environment/idling-citizens-air...</a
                >
              </p>
              <p>
                [2]:
                <a
                  href="https://www.cbsnews.com/news/new-york-city-idling-law-reporters/"
                  >https://www.cbsnews.com/news/new-york-city-idling-law-report...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44347973">
          <h3>
            <a
              class="item"
              href="https://oyyy.substack.com/p/the-cultural-decline-of-literary"
              >The cultural decline of literary fiction</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 16:00:09</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44347973"
                  >Comments</a
                ><span class="descendants">: 246</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44347425">
          <h3>
            <a class="item" href="https://fellerts.no/projects/epoch.html"
              >Mechanical Watch: Exploded View</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 14:56:44</span
              ><span class="points-container"
                >Points: <span class="points">703</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44347425"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44345334">
          <h3>
            <a
              class="item"
              href="https://tylercipriani.com/blog/2022/11/19/git-notes-gits-coolest-most-unloved-feature/"
              >Git Notes: Git's coolest, most unloved­ feature (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 09:14:35</span
              ><span class="points-container"
                >Points: <span class="points">481</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44345334"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44344246">
          <h3>
            <a class="item" href="https://libredirect.github.io"
              >LibRedirect – Redirects popular sites to alternative
              privacy-friendly frontends</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 06:07:48</span
              ><span class="points-container"
                >Points: <span class="points">395</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44344246"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44342977">
          <h3>
            <a
              class="item"
              href="https://henryhmko.github.io/posts/tpu/tpu.html"
              >TPU Deep Dive</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-22 @ 02:51:03</span
              ><span class="points-container"
                >Points: <span class="points">386</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44342977"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44338976">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/how-french-merveilleux-scientifique-fiction-reframed-reality"
              >French 'merveilleux-scientifique' fiction reframed reality</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 16:52:35</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44338976"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44335583">
          <h3>
            <a
              class="item"
              href="https://siglog.org/winner-of-the-2025-alonzo-church-award/"
              >2025 Alonzo Church Award: Paul Blain Levy for Call-by-Push-Value
              (CBPV)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 07:51:19</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44335583"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44333155">
          <h3>
            <a
              class="item"
              href="https://tylerrussell.dev/2025/06/20/cross-account-and-region-backups-with-aws-backup-and-friends/"
              >Cross-Account and Cross-Region Backups with AWS Backup (and
              Friends)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 23:40:14</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44333155"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44331316">
          <h3>
            <a class="item" href="https://koaning.io/posts/giving-mojo-a-spin/"
              >Python can run Mojo now</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 19:46:33</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44331316"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44331201">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=oG5zz9Sjw3E"
              >Kilauea volcano errupts, lava more than 1k feet high [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 19:36:18</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44331201"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44327554">
          <h3>
            <a
              class="item"
              href="https://www.engadget.com/apps/adobe-project-indigo-is-a-new-photo-app-from-former-pixel-camera-engineers-213453207.html"
              >Adobe Project Indigo is a new photo app from former Pixel camera
              engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 13:27:21</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44327554"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44320285">
          <h3>
            <a
              class="item"
              href="https://github.com/izabera/bitwise-challenge-2048"
              >2048 with only 64 bits of state</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 16:43:17</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44320285"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44316093">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2025/06/the-controversial-dragon-man-skull-was-a-denisovan/"
              >We’ve had a Denisovan skull since the 1930s—only nobody knew</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 06:42:58</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44316093"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44313739">
          <h3>
            <a
              class="item"
              href="https://www.complexsystemspodcast.com/episodes/how-to-negotiate-your-salary-package/"
              >How to negotiate your salary package</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-18 @ 22:16:53</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44313739"
                  >Comments</a
                ><span class="descendants">: 226</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
