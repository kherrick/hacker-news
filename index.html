<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39451649">
          <h3>
            <a class="item" href="https://www.bbc.co.uk/news/uk-68355395"
              >Trident missile test fails for a second time in a row</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 09:07:41</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39451649"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39451016">
          <h3>
            <a class="item" href="https://gameprogrammingpatterns.com/"
              >Game Programming Patterns</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 07:23:55</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39451016"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39450943">
          <h3>
            <a
              class="item"
              href="https://becca.ooo/blog/so-you-want-to-ship-a-command-line-tool-for-macos/"
              >So You Want to Ship a Command-Line Tool for macOS (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 07:07:24</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39450943"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39450669">
          <h3>
            <a
              class="item"
              href="https://garymarcus.substack.com/p/chatgpt-has-gone-berserk"
              >ChatGPT Has Gone Berserk</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 06:09:10</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39450669"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39450574">
          <h3>
            <a class="item" href="https://github.com/jankae/LibreVNA"
              >100kHz to 6GHz 2 port USB based VNA</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 05:49:42</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39450574"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39450237">
          <h3>
            <a
              class="item"
              href="https://raypatrick.xyz/blog/2023/11/24/would-von-brauns-mars-landers-have-worked/"
              >Would von Braun's Mars Landers Have Worked?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 04:43:01</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39450237"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39449969">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2024/02/walmart-buying-tv-brand-vizio-for-its-ad-fueling-customer-data/"
              >Walmart buying TV-brand Vizio for its ad-fueling customer data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 03:57:57</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39449969"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39449748">
          <h3>
            <a
              class="item"
              href="https://finance.yahoo.com/news/japan-bets-67-billion-become-210013021.html"
              >Japan Bets $67B to Become a Global Chip Powerhouse Once Again</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 03:13:14</span
              ><span class="points-container"
                >Points: <span class="points">210</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39449748"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39449713">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/personal-finance/the-lifespan-of-large-appliances-is-shrinking-e5fb205b"
              >The Lifespan of Large Appliances Is Shrinking</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 03:07:55</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39449713"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39449424">
          <h3>
            <a class="item" href="http://www.gksoft.com/a/fun/architects.html"
              >If Architects had to work like Programmers (1995)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-21 @ 02:11:27</span
              ><span class="points-container"
                >Points: <span class="points">276</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39449424"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39448223">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2024/02/court-blocks-1-billion-copyright-ruling-that-punished-isp-for-its-users-piracy/"
              >Court blocks $1B copyright ruling that punished ISP for its
              users' piracy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 23:13:34</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39448223"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39448154">
          <h3>
            <a
              class="item"
              href="https://shop.flipperzero.one/products/video-game-module-for-flipper-zero"
              >Video Game Module for Flipper Zero</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 23:05:57</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39448154"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39447041">
          <h3>
            <a class="item" href="https://sidekick.kagi.com/"
              >Kagi Sidekick (alpha)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 21:18:20</span
              ><span class="points-container"
                >Points: <span class="points">552</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39447041"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39446853">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/spine-ai/jobs/Z1hz3BZ-lead-applied-ml-scientist"
              >Spine AI (YC S23) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 21:01:42</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39446617">
          <h3>
            <a
              class="item"
              href="https://popey.com/blog/2024/02/exodus-bitcoin-wallet-490k-swindle/"
              >Exodus Bitcoin Wallet: $490k swindle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 20:41:32</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39446617"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39446591">
          <h3>
            <a class="item" href="https://allrgb.com/kd-tree"
              >RGB K-D Tree (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 20:39:39</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39446591"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39446537">
          <h3>
            <a class="item" href="https://mitxela.com/projects/ledstud"
              >LED Matrix Earrings</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 20:34:12</span
              ><span class="points-container"
                >Points: <span class="points">439</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39446537"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39444500">
          <h3>
            <a
              class="item"
              href="https://signal.org/blog/phone-number-privacy-usernames/"
              >Keep your phone number private with Signal usernames</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 18:01:05</span
              ><span class="points-container"
                >Points: <span class="points">1176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39444500"
                  >Comments</a
                ><span class="descendants">: 701</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39444364">
          <h3>
            <a
              class="item"
              href="https://insidegovuk.blog.gov.uk/2024/02/19/updating-gov-uks-crown/"
              >Updating Gov.uk’s crown</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 17:51:18</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39444364"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39444282">
          <h3>
            <a class="item" href="https://www.hillelwayne.com/post/picat/"
              >Planner programming blows my mind</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 17:45:05</span
              ><span class="points-container"
                >Points: <span class="points">285</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39444282"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39443972">
          <h3>
            <a
              class="item"
              href="https://blog.llamaindex.ai/introducing-llamacloud-and-llamaparse-af8cedf9006b"
              >LlamaCloud and LlamaParse</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 17:20:46</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39443972"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39443965">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=zduSFxRajkE"
              >Let's Build the GPT Tokenizer [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 17:20:30</span
              ><span class="points-container"
                >Points: <span class="points">544</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39443965"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39443679">
          <h3>
            <a
              class="item"
              href="http://databasearchitects.blogspot.com/2024/02/ssds-have-become-ridiculously-fast.html"
              >SSDs have become fast, except in the cloud</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 16:59:43</span
              ><span class="points-container"
                >Points: <span class="points">483</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39443679"
                  >Comments</a
                ><span class="descendants">: 344</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39442368">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39442368"
              >Launch HN: Dart (YC W22) – Project management with automatic
              report generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 15:24:05</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39442368"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
            <div class="text">
              <a href="https://itsdart.com">https://itsdart.com</a>). Dart is a
              fully-featured project management tool that can automatically
              create reports, fill in task properties, generate subtasks, detect
              duplicate tasks, and more. Here’s a quick demo of some of the
              highlight features:
              <a href="https://youtu.be/CMsBAv9CCyU"
                >https://youtu.be/CMsBAv9CCyU</a
              >
              <p>
                Like many others we grew frustrated with the constant upkeep in
                creating and organizing tickets in Jira and other PM tools. We
                routinely wasted as much as seven hours a week on repetitive PM
                chores like cleaning up the backlog or drafting changelog
                updates. At Zack’s previous company he even built a system to
                try to automate some of this work. In conversations with other
                founders and engineers we learned that he was far from the only
                person doing this.
              </p>
              <p>
                We started Dart when we realized we could bring a new approach
                to this problem through techniques enabled by generative AI.
                There are of course a lot of project management tools out there,
                but none have the ability to automate most of the busywork
                without having to configure long sets of rules.
              </p>
              <p>
                For example, one of the most helpful functions is summarizing
                work that was accomplished over some time interval, by
                automatically creating a changelog update for it that can be
                pasted into company blogs or elsewhere. Another highly used
                feature is giving Dart a large task or PRD and generating a
                recommendation for how to break it up into more manageable
                subtasks.
              </p>
              <p>
                Over the last two years we’ve continued to build a broad set of
                PM functionality in Dart (task management, docs, roadmaps, etc.)
                along with what we hope is a neatly vertically integrated
                application of gen AI that adds value.
              </p>
              <p>
                Dart is built with Vue on the frontend, Django on the backend,
                and uses various gen AI models such as GPT-4. We embed almost
                all of the content that goes into the app for later retrieval
                and search. Over time we build up context for users, workspaces,
                working patterns, etc. and are able to provide this context to
                do situation specific few-shot prompting or RAG, depending on
                the situation. For better or worse we’ve implemented most of our
                LLM infrastructure internally and are largely calling OpenAI
                APIs directly.
              </p>
              <p>
                While Dart improves its recommendations as users work on more
                tasks, ultimately it’s not quite ready to replace your product
                manager. You’ll probably still need to evaluate if the
                recommendations make sense for your team, and make any
                adjustments before confirming them. By having a helpful
                companion offering suggestions as you go we’ve still found that
                this process ends up net saving time–about 12% of time spent in
                PM tools according to our users. You can think of it like a
                helpful tool for generating ideas as opposed to a product that
                will fully strategize and do all of your work for you (at least
                for now!).
              </p>
              <p>
                Our current users come from a wide range of backgrounds
                including other founders, developers, writers, small business
                owners, consultants, researchers, etc.
              </p>
              <p>
                You can try out Dart for free at
                <a href="https://app.itsdart.com/sign-up"
                  >https://app.itsdart.com/sign-up</a
                >. We’d really appreciate any and all feedback or ideas in the
                comments!
              </p>
            </div>
          </section>
        </section>
        <section id="39441677">
          <h3>
            <a class="item" href="https://github.com/hyperdiv/hyperdiv"
              >Show HN: Hyperdiv – Reactive, immediate-mode web UI framework for
              Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 14:23:50</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39441677"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm releasing Hyperdiv (<a href="https://hyperdiv.io"
                  >https://hyperdiv.io</a
                >), a framework for rapidly developing reactive browser UIs in
                Python, with immediate-mode syntax and using Shoelace (<a
                  href="https://shoelace.style"
                  >https://shoelace.style</a
                >) as its built-in component system.
              </p>
              <p>
                This short coding video will give you a good idea of what it is:
                <a href="https://www.youtube.com/watch?v=4XJKfxaqvGE"
                  >https://www.youtube.com/watch?v=4XJKfxaqvGE</a
                >
              </p>
              <p>
                I wrote a brief article about the motivation and approach:
                <a href="https://hyperdiv.io/intro.html"
                  >https://hyperdiv.io/intro.html</a
                >
              </p>
              <p>
                Hyperdiv doesn't aim to compete with serious full-stack
                frameworks. The core aim was to make it easy and fast to
                prototype apps and build UI-based tools. I was originally
                motivated by internal tools at work -- feeling the need to
                quickly put together UI-based tools to share with both technical
                and non-technical coworkers, without having to stand up and
                maintain a full internal stack.
              </p>
              <p>
                This is my first major open source release. I really appreciate
                your feedback and support. - Marius
              </p>
            </div>
          </section>
        </section>
        <section id="39440006">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/02/20/microsoft_os2_2_0_beta/"
              >Preview edition of Microsoft OS/2 2.0 sold on eBay</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 11:22:25</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39440006"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39438811">
          <h3>
            <a
              class="item"
              href="https://www.tritondatacenter.com/blog/tcp-puzzlers"
              >TCP Puzzlers (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-20 @ 07:23:30</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39438811"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39427479">
          <h3>
            <a
              class="item"
              href="http://daviddfriedman.blogspot.com/2006/10/economics-of-status.html"
              >The Economics of Status (2006)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 08:55:10</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39427479"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39427016">
          <h3>
            <a class="item" href="https://ctan.org/pkg/lwarp"
              >Lwarp – Converts LaTeX to HTML</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-19 @ 07:24:49</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39427016"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418536">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/civis/threads/secd-chews-up-cpu-cycles-and-watch-battery-life-goes-in-the-terlet.1485088/"
              >secd chews up CPU cycles and Watch battery life goes in the
              terlet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 12:35:37</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418536"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
