<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36330972">
          <h3>
            <a
              class="item"
              href="https://yonom.substack.com/p/native-json-output-from-gpt-4"
              >Native JSON Output from GPT-4</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 19:07:43</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36330972"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36330812">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/06/14/twitter-is-being-evicted-from-its-boulder-office-over-unpaid-rent/"
              >Twitter is being evicted from its Boulder office over unpaid
              rent</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 18:55:06</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36330812"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36330429">
          <h3>
            <a class="item" href="https://github.com/zigzap/zap"
              >Zap – Blazingly fast backends in Zig</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 18:31:14</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36330429"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36330116">
          <h3>
            <a
              class="item"
              href="https://blog.benjojo.co.uk/post/evil-bit-RFC3514-real-world-usage"
              >I may be the only evil (bit) user on the internet (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 18:14:27</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36330116"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36330012">
          <h3>
            <a class="item" href="https://github.com/JonLatane/jonline"
              >Show HN: Jonline, AGPLv3 Social Network Built with Rust, Flutter,
              React, gRPC</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 18:08:19</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36330012"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <a href="https://jonline.io">https://jonline.io</a> (to which I
              manually deploy) and
              <a href="https://getj.online">https://getj.online</a> (which is
              deployed to for any commit to main on GitHub). They're both
              running (side by side, in their own namespaces) on a bare minimum
              2GB/50GB DigitalOcean droplet using DOKS (DigitalOcean
              Kubernetes). The configurations are in:
              <a
                href="https://github.com/JonLatane/jonline/tree/main/deploys/k8s"
                >https://github.com/JonLatane/jonline/tree/main/deploys/k8s</a
              >
              <p>
                So far this is a solo endeavor, but with my recent CI
                integrations and consolidations of things within the codebase,
                it's pretty much ready for anyone who wants to contribute to do
                so. I've labeled some "good first issues" if anyone is
                interested in contributing:
                <a href="https://github.com/JonLatane/jonline/issues"
                  >https://github.com/JonLatane/jonline/issues</a
                >
              </p>
              <p>
                A few more tech details are available within the app itself, at
                <a href="https://jonline.io/about_jonline"
                  >https://jonline.io/about_jonline</a
                >
                or
                <a href="https://getj.online/about_jonline"
                  >https://getj.online/about_jonline</a
                >.
              </p>
              <p>
                Edit: Hug of death is in full effect! I think it's the CPU
                required for all the TLS stuff being done. I can't even `kubectl
                logs` to get more information.
              </p>
              <p>
                I should really be limiting the resources of my containers, etc.
                as I'm obviously running way beyond what my rinky-dink single
                server is really meant for. If you're interested, let me know!
              </p>
              <p>
                CPU/Load/Memory graphs in case y'all are curious (yes, I know
                I'm already using most of that poor server's memory!):
                <a href="https://imgur.com/7xGpvRI"
                  >https://imgur.com/7xGpvRI</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36329645">
          <h3>
            <a
              class="item"
              href="https://med.stanford.edu/news/all-news/2022/06/brain-fog-covid-chemo-brain.html"
              >Brain fog after Covid-19 has similarities to ‘chemo brain’ in
              mice: study</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 17:47:29</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36329645"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36329507">
          <h3>
            <a class="item" href="https://www.pythonguis.com">Python GUIs</a>
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 17:38:27</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36329507"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36329483">
          <h3>
            <a
              class="item"
              href="https://ogletree.com/insights/new-york-state-senate-passes-prohibitions-on-non-competes/"
              >New York State Senate passes prohibitions on non-competes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 17:36:52</span
              ><span class="points-container"
                >Points: <span class="points">336</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36329483"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36328580">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2023/06/what-reddit-got-wrong"
              >What Reddit Got Wrong</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 16:41:20</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36328580"
                  >Comments</a
                ><span class="descendants">: 158</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36328433">
          <h3>
            <a
              class="item"
              href="https://www.sfgate.com/tech/article/yel-review-fraud-kay-dean-18150617.php"
              >Bay Area woman is on a crusade to prove Yelp reviews can’t be
              trusted</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 16:32:52</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36328433"
                  >Comments</a
                ><span class="descendants">: 141</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36328320">
          <h3>
            <a
              class="item"
              href="https://www.somebits.com/weblog/culture/apis-for-content-sites-must-be-free.html"
              >APIs for content sites must be free</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 16:25:41</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36328320"
                  >Comments</a
                ><span class="descendants">: 151</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36328245">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2306.07695"
              >Freaky Leaky SMS: Extracting user locations by analyzing SMS
              timings</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 16:21:14</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36328245"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36327911">
          <h3>
            <a class="item" href="https://vercel.com/blog/vercel-ai-accelerator"
              >Vercel's AI Accelerator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 16:00:03</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36327911"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36327347">
          <h3>
            <a
              class="item"
              href="https://blog.hellolanding.tech/move-fast-avoid-sharp-edges-5d3a07f19a59"
              >Migrating from Heroku to EKS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 15:22:01</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36327347"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36326706">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/06/13/frances-mistral-ai-blows-in-with-a-113m-seed-round-at-a-260m-valuation-to-take-on-openai/"
              >France’s Mistral AI raises a $113M seed round to take on
              OpenAI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 14:38:50</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36326706"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36326525">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36326525"
              >Launch HN: Credal.ai (YC W23) – Data Safety for Enterprise AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 14:26:55</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36326525"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.credal.ai/">https://www.credal.ai/</a>). We
              provide a Chat UI and APIs that enforce PII redaction, audit
              logging, and data access controls for companies that want to use
              LLMs with their corporate data from Google Docs, Slack, or
              Confluence. There’s a demo video here:
              <a
                href="https://www.loom.com/share/2b5409fd64464dc9b5b6277f2be4e90f?sid=7a728d97-58ac-4355-9c87-75eaf12b0775"
                >https://www.loom.com/share/2b5409fd64464dc9b5b6277f2be4e90f?...</a
              >.
              <p>
                One big thing enterprises and businesses are worried about with
                LLMs is “what’s happening to my data”? The way we see it, there
                are three big security and privacy barriers companies need to
                solve:
              </p>
              <p>
                1. Controlling what data goes to whom: the basic stuff is just
                putting controls in place around customer and employee PII, but
                it can get trickier when you also want to be putting controls in
                place around business secrets, so companies can ensure the Coca
                Cola recipe doesn’t accidentally leave the company.
              </p>
              <p>
                2. Visibility: Enterprise IT wants to know exactly what data was
                shared by whom, when, at what time, and what the model responded
                with (not to mention how much the request cost!). Each provider
                gives you a piece of the puzzle in their dashboard, but getting
                all this visibility per request from either of the main
                providers currently requires writing code yourself.
              </p>
              <p>
                3. Access Controls: Enterprises have lots of documents that for
                whatever reason cannot be shared internally to everyone. So how
                do I make sure employees can use AI with this stuff, without
                compromising the sensitivity of the data?
              </p>
              <p>
                Typically this pain is something that is felt most acutely by
                Enterprise IT, but also of course by the developers and business
                people who get told not to build the great stuff they can
                envision. We think it’s critical to solve these issues since the
                more visibility and control we can give Enterprise IT about how
                data is used, the more we can actually build on top of these
                APIs and start applying some of the awesome capabilities of the
                foundation models across every business problem.
              </p>
              <p>
                You can easily grab data from sources like Google Docs via their
                APIs, but for production use cases, you have to respect the
                permissions on each Google Doc, Confluence Page, Slack channel
                etc. This gets tricky when these systems combine some
                permissions defined totally inside their product, with
                permissions that are inherited from the company’s SSO provider
                (often Okta or Azure AD). Respecting all these permissions
                becomes both hard and vital as the number of employees and tools
                accessing the data grows.
              </p>
              <p>
                The current state of the art is to use a vector database like
                Pinecone, Milvus, or Chroma, integrate your internal data with
                those systems, and then when a user asks a question, dynamically
                figure out which bits are relevant to the user’s question and
                send those to the AI as part of the prompt. We handle all this
                automatically for you (using Milvus for now, which we host
                ourselves), including the point and click connectors for your
                data (Google Docs/Sheets, Slack, Confluence with many more
                coming soon). You can use that data through our UI already and
                we’re in the process of adding this search functionality to the
                API as well.
              </p>
              <p>
                There’s other schlep work that devs would rather not worry
                about: building out request level audit logs, staying on top of
                the rapidly changing API formats from these providers,
                implementing failover for when these heavily overburdened APIs
                go down etc, We think individual devs should not have to do
                these themselves, but the foundation model providers are
                unlikely to provide consistent, customer centric approaches for
                them. The PII detection piece in some ways is the easiest -
                there are a lot of good open source models for doing this, and
                companies using Azure OpenAI and AWS Bedrock seem less concerned
                with it anyway. We expect that the emphasis companies place on
                the redactions we provide may actually go down over time, while
                the emphasis on unified, consistent audit logging and data
                access controls will increase.
              </p>
              <p>
                Right now we have three plans: a free tier (which is admittedly
                very limited but intended to give you a feel for the product),
                the business plan which starts at $500pm which gets you access
                to the data integration as well as the most powerful models like
                GPT 4 32k, Anthropic 100k etc, and an enterprise plan which
                starts at $5000pm, which is a scaled up version of the business
                tier and lets you go on-prem (more details on each plan are on
                the website). You can try the free tier self-serve, but we
                haven’t yet built out fully self service onboarding for the paid
                plans so for now it is a “book a meeting” button, apologies!
                (But it only takes 5 minutes and if you want it, we can fully
                onboard you in the meeting itself).
              </p>
              <p>
                When Jack and I started Credal, we actually set out to solve a
                different problem: an ‘AI Chief of Staff’ that could read your
                documents and task trackers, and guide your strategic decision
                making. We knew that data security was going to be a critical
                problem for enterprises. Jack and I were both deep in the
                Enterprise Data Security + AI space before Credal, so we
                naturally took a security first approach to building out our AI
                Chief of Staff. But in reality, when we started showing the
                product to customers, we learned pretty fast that the ‘Chief of
                Staff’ features were at best nice to have, and the security
                features were what they were actually excited by. So we stripped
                the product back to basics, and built out the thing our
                customers actually needed. Since then we’ve signed a bunch of
                customers and thousands of users, which has been really
                exciting.
              </p>
              <p>
                Now that our product is concretely helping a bunch of people at
                work, is SOC 2 T1 Compliant, and is ready for anyone to just
                walk up and use, we’re super excited to share it with the Hacker
                News community, which Jack and I have been avid readers of for a
                decade now. It’s still a very early product (the private beta
                opened in March), but we can’t wait to get your feedback and see
                how we can make it even better!
              </p>
            </div>
          </section>
        </section>
        <section id="36326495">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2010/12/27/dumb-and-gets-things-done/"
              >Dumb and Gets Things Done (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 14:24:49</span
              ><span class="points-container"
                >Points: <span class="points">173</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36326495"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36326384">
          <h3>
            <a
              class="item"
              href="https://blog.davetcode.co.uk/post/21st-century-emulator/"
              >Bringing emulation into the 21st century (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 14:19:20</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36326384"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36325986">
          <h3>
            <a
              class="item"
              href="https://rwmj.wordpress.com/2023/06/14/i-booted-linux-292612-times/"
              >I booted Linux 293k times in 21 hours</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 13:54:33</span
              ><span class="points-container"
                >Points: <span class="points">435</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36325986"
                  >Comments</a
                ><span class="descendants">: 128</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36325349">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/blog-post/always-same-warning-signs"
              >Always the same warning signs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 13:09:58</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36325349"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36324571">
          <h3>
            <a class="item" href="https://skio.com/careers/"
              >Skio (YC S20) – Subscriptions for Shopify, ReCharge Migrations Is
              Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 12:02:28</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36324546">
          <h3>
            <a class="item" href="https://fs.blog/deliberate-practice-guide/"
              >The Deliberate Practice Guide (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 12:00:13</span
              ><span class="points-container"
                >Points: <span class="points">241</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36324546"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36323275">
          <h3>
            <a
              class="item"
              href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2743249/"
              >Consciousness and Anaesthesia (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 09:00:15</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36323275"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36323058">
          <h3>
            <a
              class="item"
              href="https://www.peterullrich.com/listen-to-database-changes-with-postgres-triggers-and-elixir"
              >How to Listen to Database Changes Using Postgres Triggers in
              Elixir</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 08:24:27</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36323058"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36322395">
          <h3>
            <a class="item" href="https://murray-lab.caltech.edu/CTX/"
              >A 5.7 Terapixel Mosaic of the Surface of Mars</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 06:57:59</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36322395"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36321843">
          <h3>
            <a
              class="item"
              href="https://www.alphagalileo.org/en-gb/Item-Display/ItemId/234406?returnurl=https://www.alphagalileo.org/en-gb/Item-Display/ItemId/234406"
              >Serotonin booster leads to increased functional brain
              connectivity</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-14 @ 05:37:14</span
              ><span class="points-container"
                >Points: <span class="points">286</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36321843"
                  >Comments</a
                ><span class="descendants">: 246</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36317385">
          <h3>
            <a
              class="item"
              href="https://blog.tartanllama.xyz/writing-a-linux-debugger-setup/"
              >Writing a Linux Debugger (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-13 @ 21:09:26</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36317385"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36317153">
          <h3>
            <a class="item" href="https://snarky.ca/proposing-a-struct-syntax/"
              >Proposing a Struct Syntax for Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-13 @ 20:55:50</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36317153"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36316502">
          <h3>
            <a class="item" href="https://www.typecell.org/"
              >TypeCell, open source TypeScript notebooks live programming
              environment</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-13 @ 20:22:46</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36316502"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36311508">
          <h3>
            <a
              class="item"
              href="https://www.dragonflydb.io/blog/leveraging-power-of-lua-scripting"
              >Leveraging the power of Lua scripting with Dragonfly</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-13 @ 15:18:00</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36311508"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
