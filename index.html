<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43899959">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2504.08461"
              >Why it is (nearly) impossible that we live in a simulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 22:13:50</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43899959"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43899236">
          <h3>
            <a
              class="item"
              href="https://blog.yaakov.online/replacing-kubernetes-with-systemd/"
              >Replacing Kubernetes with systemd (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 20:40:14</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43899236"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43899028">
          <h3>
            <a class="item" href="https://github.com/KoljaB/RealtimeVoiceChat"
              >Show HN: Real-time AI Voice Chat at ~500ms Latency</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 20:17:32</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43899028"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43899016">
          <h3>
            <a
              class="item"
              href="https://www.upstartsmedia.com/p/scoop-databricks-talks-to-acquire-neon"
              >Databricks in Talks to Acquire Startup Neon for About $1B</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 20:16:29</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43899016"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43898380">
          <h3>
            <a
              class="item"
              href="https://kucharski.substack.com/p/possibly-a-serious-possibility"
              >Possibly a Serious Possibility</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 19:11:33</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43898380"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43897772">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/evolving-our-structure/"
              >Evolving OpenAI's Structure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 18:08:02</span
              ><span class="points-container"
                >Points: <span class="points">347</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43897772"
                  >Comments</a
                ><span class="descendants">: 399</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43897719">
          <h3>
            <a
              class="item"
              href="https://github.com/leontrolski/tkintergalactic"
              >Show HN: Tkintergalactic - Declarative Tcl/Tk UI Library for
              Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 18:02:20</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43897719"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43897320">
          <h3>
            <a class="item" href="https://minimaxir.com/2025/05/llm-use/"
              >As an experienced LLM user, I don't use generative LLMs often</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 17:22:40</span
              ><span class="points-container"
                >Points: <span class="points">244</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43897320"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43897138">
          <h3>
            <a class="item" href="https://www.instantdb.com/hiring/ts-hacker"
              >Instant (YC S22) Is Hiring a Founding TypeScript Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 17:00:26</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43897129">
          <h3>
            <a class="item" href="https://textquery.app/"
              >Show HN: TextQuery – Query CSV, JSON, XLSX Files with SQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 16:59:15</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43897129"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43896410">
          <h3>
            <a class="item" href="https://github.com/Klavis-AI/klavis"
              >Show HN: Klavis AI – Open-source MCP integration for AI
              applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 15:52:37</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43896410"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.klavis.ai/">https://www.klavis.ai/</a>,
              Github repo:
              <a href="https://github.com/Klavis-AI/klavis"
                >https://github.com/Klavis-AI/klavis</a
              >)
              <p>
                We're addressing a couple of key problems with using MCPs.
                First, many available MCP servers lack native or used-based
                authentications, creating security vulnerabilities and adding
                complexity during development.
              </p>
              <p>
                Second, many MCP servers are personal projects, not designed for
                the reliability needed in production.
              </p>
              <p>
                Connecting to these servers usually requires writing custom MCP
                client code for the MCP protocol itself, which is a barrier,
                especially if you already have function calling systems in
                place.
              </p>
              <p>
                Klavis AI aims to address these issues. To simplify access, we
                offer an API to launch production-ready, hosted MCP servers
                quickly via our API. The API also provides built-in OAuth and
                multi-tenancy auth support for MCP servers.
              </p>
              <p>
                We also want to remove the need for developers to write MCP
                client code. You can use our API to interact with any remote MCP
                servers directly from your existing backend infrastructure. For
                faster prototyping or direct user interaction, we also provide
                open-source client interfaces for Web, Slack, and Discord.
              </p>
              <p>
                The MCP servers and clients code is open source because we want
                to contribute to the MCP community.
              </p>
              <p>
                For a quick start in the hosted verions, log in to our website
                and generate an API key. Then start calling our APIs directly.
                You can find more details in our doc:
                <a href="https://docs.klavis.ai">https://docs.klavis.ai</a>
              </p>
              <p>
                For a quick start in the open source version, go to our github
                repository and check out the detailed readme on each MCP server
                and client.
              </p>
              <p>
                A little note about myself: my background includes working on
                the function calling for Google Gemini. During that time, I saw
                firsthand the challenges teams face when trying to connect AI
                agents to external tools. I want to bring my insights and energy
                to accelerate MCP adoption.
              </p>
              <p>
                This is an early release, and we’d appreciate feedback from the
                community. What are your worst pain points related to MCPs,
                either as a developer or a general user? What other MCP servers
                or features would be most valuable to you?
              </p>
              <p>We'll be around in the comments. Thanks for reading!</p>
            </div>
          </section>
        </section>
        <section id="43896199">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/dimension-126-contains-strangely-twisted-shapes-mathematicians-prove-20250505/"
              >Dimension 126 Contains Twisted Shapes, Mathematicians Prove</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 15:34:56</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43896199"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43896188">
          <h3>
            <a
              class="item"
              href="https://vin01.github.io/piptagole/cybcecrime/security/cybersecurity/2025/05/05/state-cyber-security.html"
              >How are cyber criminals rolling in 2025?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 15:33:57</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43896188"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43896011">
          <h3>
            <a class="item" href="https://vectorvfs.readthedocs.io/en/latest/"
              >Show HN: VectorVFS, your filesystem as a vector database</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 15:17:33</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43896011"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43895852">
          <h3>
            <a
              class="item"
              href="https://tobylam.xyz/2023/11/27/inverse-functions-legendre-part-1"
              >Geometrically understanding calculus of inverse functions
              (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 15:01:30</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43895852"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43895637">
          <h3>
            <a
              class="item"
              href="https://virtualize.sh/blog/you-cant-git-clone-a-team/"
              >You can't git clone a team</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 14:39:48</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43895637"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43895622">
          <h3>
            <a
              class="item"
              href="https://tomverbeure.github.io/2025/05/04/TDS684B-CCD-Memory.html"
              >A Tektronix TDS 684B Oscilloscope Uses CCD Analog Memory</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 14:37:51</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43895622"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43895456">
          <h3>
            <a class="item" href="https://github.com/evroon/bracket"
              >Show HN: Bracket – selfhosted tournament system</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 14:20:04</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43895456"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
            <div class="text">
              <p>
                I made this tournament system for my badminton club and hosted
                six paid tournaments successfully.
              </p>
              <p>
                It features flexible setups, where a tournament can have
                multiple stages and each stage can have multiple "items" (round
                robin, single elimination or swiss).
              </p>
              <p>
                Backend is written in async Python with FastAPI and frontend in
                Next.js with the great Mantine library.
              </p>
              <p>I would appreciate some feedback!</p>
              <p>
                GitHub:
                <a href="https://github.com/evroon/bracket"
                  >https://github.com/evroon/bracket</a
                >
              </p>
              <p>
                Demo:
                <a href="https://www.bracketapp.nl/demo"
                  >https://www.bracketapp.nl/demo</a
                >
              </p>
              <p>
                Docs:
                <a href="https://docs.bracketapp.nl"
                  >https://docs.bracketapp.nl</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43895237">
          <h3>
            <a
              class="item"
              href="https://www.atariarchive.org/blog/adventure-march-1980/"
              >History of "Adventure" for the Atari 2600</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 14:01:34</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43895237"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43894305">
          <h3>
            <a
              class="item"
              href="https://www.afterbabel.com/p/on-the-death-of-daydreaming"
              >The Death of Daydreaming</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 12:22:10</span
              ><span class="points-container"
                >Points: <span class="points">516</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43894305"
                  >Comments</a
                ><span class="descendants">: 206</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43894175">
          <h3>
            <a class="item" href="https://den.dev/blog/pihole/"
              >The Beauty of Having a Pi-Hole (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 12:06:11</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43894175"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43893906">
          <h3>
            <a
              class="item"
              href="https://www.token.security/blog/aws-built-a-security-tool-it-introduced-a-security-risk"
              >AWS Built a Security Tool. It Introduced a Security Risk</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 11:37:04</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43893906"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43893601">
          <h3>
            <a
              class="item"
              href="https://bjango.com/articles/daftpunkvocaleffects/"
              >The vocal effects of Daft Punk</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 10:48:21</span
              ><span class="points-container"
                >Points: <span class="points">347</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43893601"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43892096">
          <h3>
            <a class="item" href="https://svnscha.de/posts/ai-meets-windbg/"
              >AI Meets WinDBG</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 05:11:51</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43892096"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43886023">
          <h3>
            <a
              class="item"
              href="https://xenodium.com/journelly-like-tweeting-but-for-your-eyes-only"
              >Show HN: Journelly for iOS: like tweeting but for your eyes only
              (in plain text)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-04 @ 11:05:10</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43886023"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
            <div class="text">
              <p>
                My initial attempts at building such an app faded just the same,
                until I realized I wanted the same level of low-friction posting
                and browsing offered by social media apps, but for my quick
                notes. Not social, just easy posting, search, and a familiar
                feed.
              </p>
              <p>
                This is how Journelly came to be. I like to describe it as:
                tweeting, but for your eyes only (fully offline and in plain
                text).
              </p>
              <p>
                If you’re an Org markup user, you’ll be delighted to know it’s
                powered by unicorns under the hood.
              </p>
              <p>
                If you’re a Markdown fan, please get in touch! I’m recording
                interest for journelly + markdown at xenodium.com. The more
                requests I get, the sooner I’ll get Markdown support out the
                door.
              </p>
              <p>Hope you like the app!</p>
            </div>
          </section>
        </section>
        <section id="43881211">
          <h3>
            <a
              class="item"
              href="https://www.thehandbasket.co/p/independent-journalism-legacy-media-credit"
              >"An independent journalist" who won't remain nameless</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-03 @ 18:53:40</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43881211"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43880472">
          <h3>
            <a
              class="item"
              href="https://www.vanityfair.com/hollywood/2015/04/pulgasari-north-korea-cult-hit"
              >How Kim Jong Il Kidnapped a Director, Made a Cult Hit Godzilla
              Knockoff (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-03 @ 17:06:57</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43880472"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43875476">
          <h3>
            <a
              class="item"
              href="https://micahflee.com/tm-sgnl-the-obscure-unofficial-signal-app-mike-waltz-uses-to-text-with-trump-officials/"
              >Technical analysis of the Signal clone used by Trump officials</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-02 @ 23:20:59</span
              ><span class="points-container"
                >Points: <span class="points">531</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43875476"
                  >Comments</a
                ><span class="descendants">: 241</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43875134">
          <h3>
            <a class="item" href="https://akselmo.dev/posts/kate-python-lsp/"
              >Kate and Python Language Server</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-02 @ 22:27:35</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43875134"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43866810">
          <h3>
            <a
              class="item"
              href="https://www.lucidnonsense.net/p/the-uncanny-mirror"
              >The Uncanny Mirror: AI, Self-Doubt, and the Limits of
              Reflection</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-02 @ 06:36:33</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43866810"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
