<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42526693">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/e2ddd496-4f07-4dc8-a47c-314354da8d46"
              >Are we becoming a post-literate society?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 22:34:25</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42526693"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42526150">
          <h3>
            <a class="item" href="https://github.com/BytexGrid/NeatShift"
              >Show HN: NeatShift – Organize Windows files with symbolic
              links</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 21:21:30</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42526150"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built a lightweight Windows tool to organize files by
                relocating them while maintaining their accessibility through
                symbolic links.
              </p>
              <p>
                The idea came from needing to tidy up my cluttered file system
                without breaking file paths used by other applications.
                NeatShift solves this by automating symbolic link creation
                whenever files or folders are moved.
              </p>
              <p>Key Features:</p>
              <p>- Relocate files without breaking existing references.</p>
              <p>- Automatic system restore points for added safety.</p>
              <p>- Modern Windows 11-style UI with drag-and-drop support.</p>
              <p>- Manage and validate symbolic links easily.</p>
              <p>
                It’s free, open source, and still evolving, so I’d love to hear
                your feedback, suggestions, or contributions!
              </p>
              <p>
                GitHub: [<a
                  href="https://github.com/BytexGrid/NeatShift](https://github.com/BytexGrid/NeatShift)"
                  >https://github.com/BytexGrid/NeatShift](https://github.com/B...</a
                >
              </p>
              <p>
                Thanks for checking it out—I’m happy to answer any questions or
                hear ideas for improvement!
              </p>
            </div>
          </section>
        </section>
        <section id="42525719">
          <h3>
            <a class="item" href="https://divestos.org/pages/news#end"
              >DivestOS ROM shuts after ten years</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 20:26:11</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42525719"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42525633">
          <h3>
            <a class="item" href="https://www.plasticlist.org/report"
              >Plasticlist Report – Data on plastic chemicals in Bay Area
              foods</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 20:15:44</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42525633"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42525290">
          <h3>
            <a class="item" href="https://kando.menu/"
              >Show HN: Kando – A cross-platform pie menu for your desktop</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 19:32:37</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42525290"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              Kando is a cross-platform open source pie menu which I am
              currently developing! It offers an unconventional, fast, highly
              efficient, and fun way of interacting with your computer! You can
              use it to launch applications, simulate keyboard shortcuts, open
              files, and much more. Let me know what you think about it!
            </div>
          </section>
        </section>
        <section id="42524848">
          <h3>
            <a class="item" href="https://doodledreams.cc"
              >Show HN: I made a web app to bring children's drawings to life</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 18:50:15</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42524848"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
            <div class="text">
              <p>
                I used to spend hours drawing all kind of things as a kid. Sadly
                though, those drawings are long gone.
              </p>
              <p>
                Inspired by this, I created DoodleDreams. A webapp that brings
                drawings to life using AI and stores them as memories. You can
                always look back at the drawings, see who made them, and even
                know the age they were drawn at.
              </p>
              <p>
                I thought it was a fun way to preserve those memories. What do
                you think?
              </p>
              <p>Viktor</p>
            </div>
          </section>
        </section>
        <section id="42524568">
          <h3>
            <a
              class="item"
              href="https://www.ccc.de/en/updates/2024/das-ist-vollig-entgleist"
              >They have not been trained for this</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 18:19:25</span
              ><span class="points-container"
                >Points: <span class="points">350</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42524568"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42524493">
          <h3>
            <a class="item" href="https://houseplant.readthedocs.io/en/latest/"
              >Show HN: Houseplant – Database Migrations for ClickHouse</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 18:11:12</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42524493"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42524352">
          <h3>
            <a
              class="item"
              href="https://seanpedersen.github.io/posts/structure-of-neural-latent-space"
              >The Structure of Neural Embeddings</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 17:55:43</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42524352"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42523933">
          <h3>
            <a
              class="item"
              href="https://tidyfirst.substack.com/p/complain-and-propose"
              >Complain and Propose (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 17:12:56</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42523933"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42523745">
          <h3>
            <a class="item" href="https://www.lucaiaconistewart.com/model-777"
              >Scale Model of Boeing 777-300ER, Made from Manila Folders</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 16:53:33</span
              ><span class="points-container"
                >Points: <span class="points">351</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42523745"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42523061">
          <h3>
            <a class="item" href="https://bench.co/"
              >Notice of Service Closure</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 15:43:09</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42523061"
                  >Comments</a
                ><span class="descendants">: 152</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42521905">
          <h3>
            <a class="item" href="https://www.pqconnect.net/"
              >PQConnect – Automated Post-Quantum End-to-End Tunnels from DJB,
              Lange, ohters.</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 13:30:40</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42521905"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42521865">
          <h3>
            <a
              class="item"
              href="https://www.bcs.org/articles-opinion-and-research/does-current-ai-represent-a-dead-end/"
              >Does current AI represent a dead end?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 13:24:17</span
              ><span class="points-container"
                >Points: <span class="points">450</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42521865"
                  >Comments</a
                ><span class="descendants">: 832</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42521773">
          <h3>
            <a
              class="item"
              href="https://github.com/ThReinecke/dutch_vocabulary"
              >Show HN: I send myself automated emails to practice Dutch</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 13:05:38</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42521773"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42521769">
          <h3>
            <a class="item" href="https://gitdiagram.com/"
              >Show HN: Instantly visualize any codebase as an interactive
              diagram</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 13:04:17</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42521769"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
            <div class="text">
              <p>
                Given any public GitHub repository it generates diagrams in
                Mermaid.js with Claude 3.5 Sonnet
              </p>
              <p>
                I extract information from the file tree and README for details
                and interactivity (you can click components to be taken to
                relevant files and directories)
              </p>
              <p>
                Also, you can replace "hub" with "diagram" in any repository URL
                to access its diagram
              </p>
              <p>
                I created this because I wanted to contribute to open-source
                projects but quickly realized their codebases are too massive
                for me to dig through manually, so this helps me get started
              </p>
              <p>
                I do still plan on adding other features like private repository
                access if that becomes a thing people want
              </p>
              <p>
                This project was heavily inspired by
                <a href="https://gitingest.com/">https://gitingest.com/</a> so
                make sure to check that out as well!
              </p>
              <p>
                Hopefully this tool can help you and feedback is always welcome!
              </p>
            </div>
          </section>
        </section>
        <section id="42521718">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2412.13306"
              >Invariants: Computation and Applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 12:51:44</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42521718"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42521598">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/world/flight-deaths-shot-from-sky-rising-798fd31e"
              >Missiles are now the biggest killer of airline passengers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 12:21:53</span
              ><span class="points-container"
                >Points: <span class="points">494</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42521598"
                  >Comments</a
                ><span class="descendants">: 350</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42521503">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/harper/jobs/y8KjuRZ-founding-ai-engineer"
              >Harper (YC W25) Is Hiring Founding Engineer #2</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 12:01:16</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42521069">
          <h3>
            <a
              class="item"
              href="http://www.hanssummers.com/homebrew/homebrewbattery.html"
              >Homebrew Batteries</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 09:51:13</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42521069"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42520632">
          <h3>
            <a
              class="item"
              href="https://borretti.me/article/implementing-sm2-in-rust"
              >Implementing SM-2 in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 08:04:40</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42520632"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42520627">
          <h3>
            <a class="item" href="https://ztoz.blog/posts/memoria_technica/"
              >Programming Lewis Carroll's Memoria Technica</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 08:01:13</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42520627"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42520151">
          <h3>
            <a class="item" href="https://github.com/varkor/quiver"
              >Quiver: A Modern Commutative Diagram Editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-27 @ 05:27:41</span
              ><span class="points-container"
                >Points: <span class="points">308</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42520151"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42517447">
          <h3><a class="item" href="https://ghostty.org/">Ghostty 1.0</a></h3>
          <section>
            <h4>
              <span>2024-12-26 @ 20:14:57</span
              ><span class="points-container"
                >Points: <span class="points">2069</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42517447"
                  >Comments</a
                ><span class="descendants">: 600</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42515871">
          <h3>
            <a
              class="item"
              href="https://chromewebstore.google.com/detail/chatgpt-saved-chats/aonhnhcglgpnpopfghdplgcdkhchkkcg"
              >ChatGPT Saved Chats: Save and organize your important
              conversations in ChatGPT</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-26 @ 15:51:46</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42515871"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42514105">
          <h3>
            <a
              class="item"
              href="https://www.architecturaldigest.com/story/should-more-of-us-be-moving-to-live-near-friends"
              >Should more of us be moving to live near friends?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-26 @ 09:23:08</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42514105"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42513083">
          <h3>
            <a
              class="item"
              href="https://www.scirp.org/journal/paperinformation?paperid=104676"
              >Archimedes, Vitruvius and Leonardo: The Odometer Connection
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-26 @ 04:20:37</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42513083"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42498754">
          <h3>
            <a class="item" href="https://issung.com/posts/lanphotosarchive/"
              >1584 LAN party photos from 1996 – 2010 from Australia's island
              state archived</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-24 @ 00:40:30</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42498754"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42482805">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=xLaLpMeOyHk"
              >The hydraulic systems of the Alhambra Palace [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-21 @ 22:22:27</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42482805"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42469604">
          <h3>
            <a
              class="item"
              href="https://11011110.github.io/blog/2024/12/19/pseudonymity-academic-publishing.html"
              >Pseudonymity in Academic Publishing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-20 @ 09:50:28</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42469604"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
