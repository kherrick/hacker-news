<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40000430">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/ukraine-hackers-war"
              >Ukraine Is the First "Hackers' War"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 10:04:13</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40000430"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39999315">
          <h3>
            <a
              class="item"
              href="https://www.optometryadvisor.com/home/meetings/aaopt-2021/social-media-scrolling-detrimental-to-ocular-health/"
              >Continuous Social Media Scrolling Negatively Impacts Eye
              Movement</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 07:30:38</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39999315"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39998849">
          <h3>
            <a
              class="item"
              href="https://suno.com/song/da6d4a83-1001-4694-8c28-648a6e8bad0a/"
              >AI-generated sad girl with piano performs the text of the MIT
              License</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 06:01:32</span
              ><span class="points-container"
                >Points: <span class="points">462</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39998849"
                  >Comments</a
                ><span class="descendants">: 207</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39998404">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2024/apr/10/the-line-saudi-arabia-scaling-back-plans-105-mile-long-desert-megacity-crown-prince"
              >End of the Line? Saudi Arabia to scale back plans for desert
              megacity</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 04:33:02</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39998404"
                  >Comments</a
                ><span class="descendants">: 235</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39998346">
          <h3>
            <a class="item" href="https://rachelbythebay.com/w/2024/04/10/rtc/"
              >Going in circles without a real-time clock</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 04:22:04</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39998346"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39997975">
          <h3>
            <a class="item" href="https://eugeneyan.com/writing/ai-coach/"
              >Building an AI Coach to Tame My Monkey Mind</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 02:56:01</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39997975"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39997556">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/legal/amazon-owes-525-mln-cloud-storage-patent-fight-us-jury-says-2024-04-11/"
              >Amazon owes $525M in cloud-storage patent fight, US jury says</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 01:33:22</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39997556"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39997376">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39997376"
              >MixRank (YC S11) is hiring global remote software engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 01:00:52</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                MixRank processes petabytes of data every month from web
                crawling. We have hundreds of customers using our data products
                including Google, Amazon, Facebook, Intel, and Adobe, across
                industries including Recruiting, Finance, Security, Sales, and
                Marketing.
              </p>
              <p>
                Our team is 42 full-time, full-remote from 16+ countries. We're
                growing, profitable, employee-owned, no dependence on outside
                funding. Applicants from all geographies and backgrounds are
                welcome.
              </p>
              <p>
                We are looking for passionate individuals for whom programming
                is not just a job but it's something they love to do. We're
                obsessed with computers, programming, big data, databases,
                compilers, hardware, math, data science, and the internet. Does
                this sound like you? Please apply to join our team.
              </p>
              <p>
                Our code base is very friendly to new contributors. You'll have
                a (fully-automated) development environment and be pushing
                commits on your first day. Deployments to production happen
                multiple times per day and finish in less than 2 minutes. Our
                codebase is written in Python, SQL, Javascript/TypeScript, Rust,
                and Nix. The basic technologies you'll need to be productive are
                Python, PostgreSQL, Linux, and Git.
              </p>
              <p>
                We operate at a larger scale than typical startups. We operate
                two datacenters with high performance servers we've built that
                are capable of dealing with the volumes of data we process.
                We've implemented our own distributed file system. We do
                full-scale web crawls. We download and perform static analysis
                on the entire universe of Android APKs and iOS IPAs that are
                published. Unlike a typical startup where you'll spend half of
                your time in meetings, and the other half fixing bugs from Jira
                tickets— at MixRank you'll get to direct your entire focus into
                difficult technical problems that will help you to grow as an
                individual.
              </p>
              <p>--</p>
              <p>Junior Software Engineer</p>
              <p>
                We're looking for remote junior engineers that have 0-3 years of
                professional experience in software, and 5+ years of curiosity
                exploring computers, programming, and technical hobby projects.
                This is an open-ended entry role with mentorship and diverse
                opportunities to work on all areas of our product: databases,
                distributed systems, infrastructure and tooling, data analysis,
                machine learning, frontend/backend web development, APIs, data
                mining, data modeling, and more. To stand out, please highlight
                what makes you unique: passion for computing, curiosity and side
                projects, work ethic, niche research, etc.
              </p>
              <p>
                Ideally you've already finished with school, but if you still
                have one or more years left please feel free to apply anyway. If
                you're the right fit for the team we'll figure out a way to
                accommodate your schedule.
              </p>
              <p>--</p>
              <p>Software Engineer</p>
              <p>
                We're hiring generalist software engineers to work on web
                applications, data mining, machine learning/data science, data
                transformation/ETL, data modeling, database scaling,
                infrastructure, devops, and more. We'll customize the role to
                whatever subset of these areas match your interests.
              </p>
              <p>
                Beneficial experience includes PostgreSQL, Python, Linux,
                TypeScript, Rust, Nix, frontend/backend web development, and
                data mining.
              </p>
              <p>--</p>
              <p>
                Please apply here:
                <a href="https://www.ycombinator.com/companies/mixrank/jobs"
                  >https://www.ycombinator.com/companies/mixrank/jobs</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="39996947">
          <h3>
            <a class="item" href="https://koreader.rocks"
              >KOReader Document Viewer for E Ink devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 23:56:56</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39996947"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39996521">
          <h3>
            <a
              class="item"
              href="https://rednafi.com/misc/etag_and_http_caching/"
              >ETag and HTTP Caching</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 22:51:47</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39996521"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39996314">
          <h3>
            <a
              class="item"
              href="https://matduggan.com/why-cant-my-mom-email-me/"
              >Why can't my mom email me?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 22:21:48</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39996314"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39995908">
          <h3>
            <a
              class="item"
              href="https://github.com/bennyschmidt/next-token-prediction"
              >Show HN: Next-token prediction in JavaScript – build fast LLMs
              from scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 21:27:07</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39995908"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.youtube.com/watch?v=wjZofJX0v4M"
                >https://www.youtube.com/watch?v=wjZofJX0v4M</a
              >
              - I highly recommend watching it). I added it to the repo for
              reference.
              <p>
                When it clicked in my head that "knowing a fact" is nearly
                synonymous with predicting a word (or series of words), I wanted
                to put it to the test, because it seemed so simple. I chose
                JavaScript because I can exploit the way it structures objects
                to aid in the modeling of language.
              </p>
              <p>For example:</p>
              <p>
                "I want to be at the beach", "I will do it later", "I want to
                know the answer", ...
              </p>
              <p>becomes:</p>
              <p></p>
              <pre><code>  {
    I: { 
      want: { 
        to: { 
          be: { ... }, 
          know: { ... }
        }
      },
      will: { ... }
    },
    ...
  }
</code></pre>
              in JavaScript. You can exploit the language's fast object lookup
              speed to find known sentences this way, rather than recursively
              searching text - which is the convention and would take forever or
              not work at all considering there are several full books loaded in
              by default (and it could support many more).
              <p>
                Accompanying research yielded learnings about what "tokens" and
                "embeddings" are, what is meant by "training", and most of the
                rest - though I'm still learning jargon. I wrote a script to
                iterate over every single word of every single book to rank how
                likely it is that word will appear next, if given a cursor, and
                extended that to rank entire phrases. The base decoder started
                out what I'll call "token-agnostic" - didn't care if you were
                looking for the next letter... word... pixel... it's the same
                logic. But actually it's not, and it soon evolved into a text
                (language) model. But I have plans to get into image generation
                next (next-pixel prediction), using this. Overall the concepts
                are similar, but there are differences primarily around
                extraction and formatting.
              </p>
              <p>Goals of the project:</p>
              <p>
                - Demystify LLMs for people, show that it's just regular code
                that does normal stuff
              </p>
              <p>
                - Actually make a pretty good LLM in JavaScript, with a version
                at least capable of running in a browser tab
              </p>
            </div>
          </section>
        </section>
        <section id="39995782">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/now-we-know-where-dead-went-did-grave-robbers-plunder-battlefields"
              >Did grave robbers plunder battlefields?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 21:13:17</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39995782"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39995725">
          <h3>
            <a class="item" href="https://github.com/paul-gauthier/aider"
              >Aider: AI pair programming in your terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 21:06:42</span
              ><span class="points-container"
                >Points: <span class="points">315</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39995725"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39995112">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=bISBNVtXZ6M"
              >Nimble: A new columnar file format by Meta [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 20:00:21</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39995112"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39994339">
          <h3>
            <a class="item" href="https://forge.soutade.fr/soutade/libgourou"
              >Libgourou: A Free Implementation of Adobe's Adept DRM on ePub/PDF
              Files</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 18:49:47</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39994339"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39994301">
          <h3>
            <a class="item" href="https://github.com/BernardZhao/lenssort"
              >Lens sort, a masked pixel sort glitch effect</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 18:47:04</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39994301"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39993976">
          <h3>
            <a class="item" href="https://blog.val.town/blog/search-notes/"
              >Code search is hard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 18:15:08</span
              ><span class="points-container"
                >Points: <span class="points">243</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39993976"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39993626">
          <h3>
            <a
              class="item"
              href="https://github.com/google-deepmind/recurrentgemma"
              >Implementation of Google's Griffin Architecture – RNN LLM</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 17:47:11</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39993626"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39992817">
          <h3>
            <a class="item" href="https://sonauto.ai/"
              >Show HN: Sonauto – A more controllable AI music creator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 16:48:01</span
              ><span class="points-container"
                >Points: <span class="points">374</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39992817"
                  >Comments</a
                ><span class="descendants">: 197</span></span
              >
            </h4>
            <div class="text">
              <p>
                My cofounder and I trained an AI music generation model and
                after a month of testing we're launching 1.0 today. Ours is
                interesting because it's a latent diffusion model instead of a
                language model, which makes it more controllable:
                <a href="https://sonauto.ai/">https://sonauto.ai/</a>
              </p>
              <p>
                Others do music generation by training a Vector Quantized
                Variational Autoencoder like Descript Audio Codec (<a
                  href="https://github.com/descriptinc/descript-audio-codec"
                  >https://github.com/descriptinc/descript-audio-codec</a
                >) to turn music into tokens, then training an LLM on those
                tokens. Instead, we ripped the tokenization part off and
                replaced it with a normal variational autoencoder bottleneck
                (along with some other important changes to enable insane
                compression ratios). This gave us a nice, normally distributed
                latent space on which to train a diffusion transformer (like
                Sora). Our diffusion model is also particularly interesting
                because it is the first audio diffusion model to generate
                coherent lyrics!
              </p>
              <p>
                We like diffusion models for music generation because they have
                some interesting properties that make controlling them easier
                (so you can make <i>your own</i> music instead of just taking
                what the machine gives you). For example, we have a rhythm
                control mode where you can upload your own percussion line or
                set a BPM. Very soon you'll also be able to generate proper
                variations of an uploaded or previously generated song (e.g.,
                you could even sing into Voice Memos for a minute and upload
                that!). @Musicians of HN, try uploading your songs and using
                Rhythm Control/let us know what you think! Our goal is to enable
                more of you, not replace you.
              </p>
              <p>
                For example, we turned this drum line (<a
                  href="https://sonauto.ai/songs/uoTKycBghUBv7wA2YfNz"
                  >https://sonauto.ai/songs/uoTKycBghUBv7wA2YfNz</a
                >) into this full song (<a
                  href="https://sonauto.ai/songs/KSK7WM1PJuz1euhq6lS7"
                  >https://sonauto.ai/songs/KSK7WM1PJuz1euhq6lS7</a
                >
                skip to 1:05 if impatient) or this other song I like better (<a
                  href="https://sonauto.ai/songs/qkn3KYv0ICT9kjWTmins"
                  >https://sonauto.ai/songs/qkn3KYv0ICT9kjWTmins</a
                >
                - we accidentally compressed it with AAC instead of Opus which
                hurt quality, though)
              </p>
              <p>
                We also like diffusion models because while they're expensive to
                train, they're cheap to serve. We built our own efficient
                inference infrastructure instead of using those expensive
                inference as a service startups that are all the rage. That's
                why we're making generations on our site free and unlimited for
                as long as possible.
              </p>
              <p>
                We'd love to answer your questions. Let us know what you think
                of our first model!
                <a href="https://sonauto.ai/">https://sonauto.ai/</a>
              </p>
            </div>
          </section>
        </section>
        <section id="39987735">
          <h3>
            <a
              class="item"
              href="https://begin.com/blog/posts/2024-04-08-introducing-enhance-wasm"
              >Enhance WASM: Back End Agnostic SSR for Web Components</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 06:56:40</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39987735"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39987492">
          <h3>
            <a
              class="item"
              href="https://medium.com/@dwolela/are-you-fitting-the-gaussian-curve-or-is-it-fitting-you-89b59d0bce10"
              >Are you fitting the Gaussian curve or is it fitting you?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 06:19:22</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39987492"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39987158">
          <h3>
            <a class="item" href="https://urban-resources.net/untergunther.html"
              >Untergunther – Restoration of the Pantheon Clock</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 05:10:53</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39987158"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39979408">
          <h3>
            <a
              class="item"
              href="https://www.npr.org/2024/04/08/1242346659/genetically-modified-bioluminescent-petunias-make-their-own-light"
              >Bioluminescent Petunias at Home</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 13:49:05</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39979408"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39978423">
          <h3>
            <a class="item" href="https://celltypes.brain-map.org/data"
              >1.3k recordings and trace drawings of neurons</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 11:44:57</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39978423"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39976634">
          <h3>
            <a class="item" href="https://ohmygit.org/"
              >Oh My Git: An open source game about learning Git</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 06:22:43</span
              ><span class="points-container"
                >Points: <span class="points">251</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39976634"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39973088">
          <h3>
            <a class="item" href="https://github.com/wouterken/crystalruby"
              >Embed Crystal code directly in Ruby</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-08 @ 19:53:07</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39973088"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39972586">
          <h3>
            <a class="item" href="https://github.com/larryboyko/dimityjones"
              >Show HN: Dimity Jones in Puzzle Castle: An Electronic Escape
              Novel</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-08 @ 18:47:31</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39972586"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              <p>Think: escape room in the form of a novel.</p>
              <p>
                A computer, and rudimentary coding skills in a language of your
                choice, will be indispensable for performing the transformations
                -- and might help with the solving too!
              </p>
              <p>
                My wife, the author, passed away five years ago. This is not the
                last thing she wrote, but it is the most unusual,
                unapproachable, and personal of her major works. It is also, as
                the only novel of hers that I cannot breeze through in an
                afternoon (and despite my unflattering appearance in it), my
                favorite.
              </p>
              <p>
                Though _Dimity Jones_ was left unfinished, and perhaps
                abandoned, at the time of my wife's death, its elements were all
                there, on her hard disk, awaiting only a final compiling. My
                contribution to this text has therefore been little more than
                that of an occasional copyeditor (my wife was a meticulous
                speller and self-proofreader) and playtester.
              </p>
              <p>
                Before releasing this work more widely, I would love to have it
                test-driven by better coders and puzzlers than I.
              </p>
              <p>
                Any and all feedback is welcome, from positive to negative, from
                the sweeping to the picayune. Let me know what confuses or
                frustrates you -- and especially let me know if (where) you get
                stuck.
              </p>
              <p>
                Otherwise, there are no special instructions; it's all in the
                book.
              </p>
              <p>
                While _Dimity Jones_ is still in its debugging/proofreading
                phase, please refrain from sharing it or putting it any (other)
                public place. (Christine would have been horrified to see her
                work thus published before it was letter-perfect; but I have
                exhausted my pool of friends and colleagues both able and
                willing to tinker with it. This seems like the ideal community
                of potential testers.)
              </p>
              <p>Thanking you in advance. I hope you enjoy!</p>
            </div>
          </section>
        </section>
        <section id="39972047">
          <h3>
            <a
              class="item"
              href="https://www.thecollector.com/stolen-masterpieces-famous-artworks-missing/"
              >Stolen masterpieces that are still missing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-08 @ 17:43:57</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39972047"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39970136">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/20240408-00/?p=109627"
              >How does the classic Win32 ListView handle incremental
              searching?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-08 @ 14:32:03</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39970136"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
