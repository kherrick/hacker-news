<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42342382">
          <h3>
            <a class="item" href="https://everyuuid.com/">Every UUID Dot Com</a>
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 18:11:46</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42342382"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42342203">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2024/12/06/asia/tokyo-government-4-day-workweek-intl-hnk/index.html"
              >Tokyo government gives workers 4-day workweek to boost fertility,
              family time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 17:54:20</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42342203"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42342038">
          <h3>
            <a class="item" href="https://github.com/poeticoding/yolo_elixir"
              >Show HN: Real-Time YOLO Object Detection in Elixir: Fast, Simple,
              Extensible</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 17:39:54</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42342038"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42341922">
          <h3>
            <a
              class="item"
              href="https://security.googleblog.com/2024/12/announcing-launch-of-vanir-open-source.html"
              >Vanir: Open-Source Security Search and Patch Validation Tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 17:31:00</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42341922"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42341449">
          <h3>
            <a
              class="item"
              href="https://box86.org/2024/12/new-version-of-box64-v0-3-2-and-box86-v0-3-8/"
              >New Box64 v0.3.2 and Box86 v0.3.8 released (Native Flags,
              Benchmarks, Box32)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 16:51:25</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42341449"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42341388">
          <h3>
            <a
              class="item"
              href="https://huggingface.co/meta-llama/Llama-3.3-70B-Instruct"
              >Llama-3.3-70B-Instruct</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 16:44:56</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42341388"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42340959">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2024/12/06/tiktok-divestment-law-upheld-by-federal-appeals-court.html"
              >TikTok divestment law upheld by federal appeals court</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 16:00:51</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42340959"
                  >Comments</a
                ><span class="descendants">: 168</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42340792">
          <h3>
            <a class="item" href="https://www.nature.com/articles/475166a"
              >The Unplanned Impact of Mathematics (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 15:43:24</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42340792"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42340346">
          <h3>
            <a
              class="item"
              href="https://www.vulnu.com/p/inside-exxonmobils-alleged-hack-for-hire-campaign-targeting-climate-activists"
              >ExxonMobil's Alleged Hack-for-Hire Campaign Targeting Climate
              Activists</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 14:54:56</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42340346"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42340065">
          <h3>
            <a
              class="item"
              href="https://crackoverflow.com/docs/system_administration/containerization/install-docker-natively-on-android-phone-and-use-it-as-a-home-server/"
              >Install postmarketOS on Android phone and use Docker as a home
              server</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 14:23:17</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42340065"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42339856">
          <h3>
            <a class="item" href="https://github.com/bunkerity/bunkerweb"
              >Show HN: BunkerWeb – The Open-Source Web Application Firewall
              (WAF)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 14:00:08</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42339856"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42339819">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cn4x2epppego"
              >Romanian court annuls result of presidential election first
              round</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 13:55:49</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42339819"
                  >Comments</a
                ><span class="descendants">: 210</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42339302">
          <h3>
            <a
              class="item"
              href="https://jigsawstack.com/blog/jigsawstack-mixture-of-agents-moa-outperform-any-single-llm-and-reduce-cost-with-prompt-engine"
              >Show HN: Prompt Engine – Auto pick LLMs based on your prompts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 12:45:48</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42339302"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <p>Three key problems:</p>
              <p>
                - Choices, picking from 100s of LLMs the best LLM for that 1
                prompt is gonna be challenging, you're probably not picking the
                most optimized LLM for a prompt you wrote.
              </p>
              <p>
                - Scaling/Upgrading, similar to choices but you want to keep
                consistency of your output even when models depreciate or
                configurations change.
              </p>
              <p>
                - Prompt management is scary, if something works, you'll never
                want to touch it but you should be able to without fear of
                everything breaking.
              </p>
              <p>
                So we launched Prompt Engine which automatically runs your
                prompts for you on the best LLM every single time with all the
                tools like internet access. You can also store prompts for
                reusability and caching which increases performance on every
                run.
              </p>
              <p>How it works?</p>
              <p>
                tldr, we built a really small model that is trained on datasets
                comparing 100s of LLMs that can automatically pick a model based
                on your prompt.
              </p>
              <p>
                Here's an article explaining the details:
                <a
                  href="https://jigsawstack.com/blog/jigsawstack-mixture-of-agents-moa-outperform-any-single-llm-and-reduce-cost-with-prompt-engine"
                  >https://jigsawstack.com/blog/jigsawstack-mixture-of-agents-m...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42338986">
          <h3>
            <a
              class="item"
              href="https://remotejobs.org/companies/rankscience-remote-jobs"
              >RankScience (YC W17) is hiring to supercharge SEO for startups</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 12:00:38</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42338738">
          <h3>
            <a class="item" href="https://briandouglas.ie/sqlite-defaults/"
              >Sensible SQLite Defaults</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 11:21:58</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42338738"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42338327">
          <h3>
            <a class="item" href="https://hackerherald.com/"
              >Show HN: Hacker Herald – like HN but with crowdsourced pics and
              subtitles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 10:22:34</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42338327"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
            <div class="text">
              <p>
                To those wondering if there is a need for such a Hacker News
                front end, I would just point out that most newspaper websites
                are laid out like this - clearly some people like this kind of
                layout!
              </p>
              <p>
                Also for some stories a picture really does help - currently
                there is a HN story titled, "Portland airport grows with
                expansive mass timber roof canopy". But IMO it's better to
                actually see a picture of the timber roof while scrolling rather
                than having to click through to the article.
              </p>
            </div>
          </section>
        </section>
        <section id="42338134">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/1000485/670ef0045e5e8a3e/"
              >Debian opens a can of username worms</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 09:55:18</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42338134"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42336207">
          <h3>
            <a class="item" href="https://github.com/trailbaseio/trailbase"
              >Trailbase: Fast, single-file, open-source app server built using
              Rust and SQLite</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 04:00:19</span
              ><span class="points-container"
                >Points: <span class="points">271</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42336207"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42334697">
          <h3>
            <a
              class="item"
              href="https://www.fabricatedknowledge.com/p/the-death-of-intel-when-boards-fail"
              >Intel’s board, and an example of when boards and short-termism
              fail</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 00:44:23</span
              ><span class="points-container"
                >Points: <span class="points">319</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42334697"
                  >Comments</a
                ><span class="descendants">: 232</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42334323">
          <h3>
            <a
              class="item"
              href="https://design-milk.com/portland-airport-grows-with-expansive-mass-timber-roof-canopy/"
              >Portland airport grows with expansive mass timber roof canopy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-06 @ 00:01:53</span
              ><span class="points-container"
                >Points: <span class="points">375</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42334323"
                  >Comments</a
                ><span class="descendants">: 233</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42333052">
          <h3>
            <a
              class="item"
              href="https://www.businesswire.com/news/home/20241205391064/en/GitLab-Names-Bill-Staples-as-New-CEO"
              >Gitlab names Bill Staples as new CEO</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-05 @ 21:36:50</span
              ><span class="points-container"
                >Points: <span class="points">250</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42333052"
                  >Comments</a
                ><span class="descendants">: 218</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42328655">
          <h3>
            <a class="item" href="http://piazza.tech"
              >Show HN: Piazza, syncing the web in a vectorized DB</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-05 @ 14:41:54</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42328655"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/Piazza-tech/Piazza-Updater"
                >https://github.com/Piazza-tech/Piazza-Updater</a
              >
              <p>We used Verba, Weaviate and Docker for deployment</p>
              <p>
                We'd like to have some feedback on how to continue the project,
                which data sources would be interesting to vectorize. You can
                give feedback on our landing page
                <a href="http://piazza.tech">http://piazza.tech</a> Please leave
                a star !
              </p>
            </div>
          </section>
        </section>
        <section id="42324533">
          <h3>
            <a
              class="item"
              href="https://slate.com/news-and-politics/2024/12/united-healthcare-ceo-brian-thompson-shot-suspect.html"
              >Hit men aren't what you think</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-05 @ 03:19:09</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42324533"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42306868">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/sciadv.ade2537"
              >The dogs of Chernobyl: Insights into populations in the nuclear
              exclusion zone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-03 @ 15:07:31</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42306868"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42294716">
          <h3>
            <a class="item" href="https://github.com/entropia/tip-toi-reveng"
              >Reverse engineering the Ravensburger TipToi pen</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-02 @ 10:06:36</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42294716"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42294376">
          <h3>
            <a
              class="item"
              href="https://www.thedial.world/articles/news/issue-22/forensic-linguists-solve-crimes"
              >Forensic linguists use grammar, syntax and vocabulary to help
              crack cold cases</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-02 @ 08:53:54</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42294376"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42288906">
          <h3>
            <a class="item" href="https://github.com/elricmann/vlibc"
              >Wrote a custom libc for POSIX and x86-64</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-01 @ 15:34:42</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42288906"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42284211">
          <h3>
            <a
              class="item"
              href="https://medium.com/@shacker/photography-contradictions-0566b7fce9fc"
              >Contradictions in photography advice</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-30 @ 21:36:53</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42284211"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42275249">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-11-rna-crispr-reveals-hundreds-noncoding.html"
              >RNA-targeting CRISPR reveals that noncoding RNAs are not
              'junk'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-29 @ 17:10:20</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42275249"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42253697">
          <h3>
            <a
              class="item"
              href="https://lucumr.pocoo.org/2024/11/26/python-packaging-metadata/"
              >Constraints Are Good: Python's Metadata Dilemma</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 07:09:53</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42253697"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
