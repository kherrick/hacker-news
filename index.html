<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44885991">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/news/758218/perplexity-google-chrome-bid-unsolicited-offer"
              >Perplexity offers to buy Google Chrome for $34.5B</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-13 @ 08:38:18</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44885991"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44885761">
          <h3>
            <a
              class="item"
              href="https://data.iana.org/time-zones/tzdb-2025a/factory"
              >The Factory Timezone</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-13 @ 08:03:14</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44885761"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44885295">
          <h3>
            <a class="item" href="https://www.blocked.org.uk/osa-blocks"
              >Online Safety Act – shutdowns and site blocks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-13 @ 06:40:38</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44885295"
                  >Comments</a
                ><span class="descendants">: 191</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44884709">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44884709"
              >F-Droid build servers can't build modern Android apps due to
              outdated CPUs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-13 @ 04:43:39</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44884709"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
            <div class="text">
              <p>
                The root cause: Google’s new aapt2 binary in AGP 8.12.0 started
                requiring CPU instructions (SSE4.1, SSSE3) that F-Droid’s build
                farm hardware doesn’t support. This is similar to a 2021 AGP
                4.1.0 issue, but it has returned, and now affects hundreds of
                apps.
              </p>
              <p>
                As an example, my open-source app MBCompass hit this issue. I
                downgraded to AGP 8.11.1 with Gradle 8.13 to make it build, but
                even then, F-Droid failed due to a baseline profile
                reproducibility bug in AGP. The only workaround was disabling
                baseline profiles and pushing yet another release.
              </p>
              <p>
                This has led to multiple “maintenance” versions in a short time,
                confusing users and wasting developer time, just to work around
                infrastructure issues outside the developer’s control.
              </p>
              <p>References:</p>
              <p>
                - F-Droid admin issue:
                <a href="https://gitlab.com/fdroid/admin/-/issues/593"
                  >https://gitlab.com/fdroid/admin/-/issues/593</a
                >
                - Catima example:
                <a href="https://github.com/CatimaLoyalty/Android/issues/2608"
                  >https://github.com/CatimaLoyalty/Android/issues/2608</a
                >
                - MBCompass case:
                <a href="https://github.com/CompassMB/MBCompass/issues/88"
                  >https://github.com/CompassMB/MBCompass/issues/88</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44884546">
          <h3>
            <a
              class="item"
              href="https://andreyor.st/posts/2023-08-27-fennel-libraries-as-single-files/"
              >Fennel libraries as single files (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-13 @ 04:03:18</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44884546"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44884393">
          <h3>
            <a
              class="item"
              href="https://historyofinformation.com/detail.php?entryid=856"
              >1948: Catholic Church publishes final edition of “Index Librorum
              Prohibitorum”</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-13 @ 03:26:53</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44884393"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44884091">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2508.07407"
              >A Comprehensive Survey of Self-Evolving AI Agents [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-13 @ 02:26:32</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44884091"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44883304">
          <h3>
            <a class="item" href="https://www.alltext.nyc/"
              >Search all text in New York City</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-13 @ 00:17:33</span
              ><span class="points-container"
                >Points: <span class="points">326</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44883304"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
            <div class="text">
              <a href="https://pudding.cool/2025/07/street-view/"
                >https://pudding.cool/2025/07/street-view/</a
              >
            </div>
          </section>
        </section>
        <section id="44882441">
          <h3>
            <a class="item" href="https://github.com/AndreRenaud/gore"
              >Show HN: Doom port to pure Go – Gore</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 22:19:08</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44882441"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                In the examples is a terminal-based renderer, which is
                entertaining, even though it's very hard to play with
                terminal-style input/output.
              </p>
              <p>
                The goal is a clean, cross-platform, Go-native take on the Doom
                engine – fun to hack on, easy to read, and portable.
              </p>
              <p>
                Code and instructions are at
                <a href="https://github.com/AndreRenaud/Gore"
                  >https://github.com/AndreRenaud/Gore</a
                >
              </p>
              <p>Would love feedback or thoughts.</p>
            </div>
          </section>
        </section>
        <section id="44882438">
          <h3>
            <a
              class="item"
              href="https://webkit.org/blog/17240/a-gentle-introduction-to-anchor-positioning/"
              >A gentle introduction to anchor positioning</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 22:18:55</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44882438"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44881287">
          <h3>
            <a
              class="item"
              href="https://deanebarker.net/tech/blog/let-me-know/"
              >The Missing Protocol: Let Me Know</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 20:15:17</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44881287"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44880401">
          <h3>
            <a class="item" href="https://ashet.computer/"
              >Ashet Home Computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 18:56:38</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44880401"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44878916">
          <h3>
            <a
              class="item"
              href="https://media.ccc.de/v/why2025-9-how-to-become-your-own-isp"
              >WHY2025: How to become your own ISP [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 16:53:37</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44878916"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44878650">
          <h3>
            <a class="item" href="https://github.com/omnara-ai/omnara"
              >Show HN: Omnara – Run Claude Code from anywhere</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 16:33:38</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44878650"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
            <div class="text">
              <a href="https://omnara.com/">https://omnara.com/</a>), an “agent
              command center” that lets you launch and control Claude Code from
              anywhere: terminal, web, or mobile — and easily switch between
              them.
              <p>
                Run 'pip install omnara &amp;&amp; omnara', and you'll have a
                regular Claude Code session. But you can continue that same
                session from our web dashboard (<a href="https://omnara.com/"
                  >https://omnara.com/</a
                >) or mobile app (<a
                  href="https://apps.apple.com/us/app/omnara-ai-command-center/id6748426727"
                  >https://apps.apple.com/us/app/omnara-ai-command-center/id674...</a
                >).
              </p>
              <p>
                Check out a demo here:
                <a
                  href="https://www.loom.com/share/03d30efcf8e44035af03cbfebf840c73"
                  >https://www.loom.com/share/03d30efcf8e44035af03cbfebf840c73</a
                >.
              </p>
              <p>
                Before Omnara, we felt stuck watching Claude Code think and
                write code, waiting 5-10 minutes just to provide input when
                needed. Now with Omnara, I can start a Claude Code session and
                if I need to leave my laptop, I can respond from my phone
                anywhere. Some places I've coded from include my bed, on a walk,
                in an Uber, while doing laundry, and even on the toilet.
              </p>
              <p>
                There are many new Claude Code wrappers (e.g., Crystal,
                Conductor), but none keep the native Claude Code terminal
                experience while allowing interaction outside the terminal,
                especially on mobile. On the other hand, tools like Vibetunnel
                or Termius replicate the terminal experience but lack push
                notifications, clean UIs for answering questions or viewing git
                diffs, and easy setup.
              </p>
              <p>
                We wanted our integration to fully mirror the native Claude Code
                experience, including terminal output, permissions,
                notifications, and mode switching. The Claude Code SDK and hooks
                don't support all of this, so we made a CLI wrapper that parses
                the session file at ~/.claude/projects and the terminal output
                to capture user and agent messages. We send these messages to
                our platform, where they're displayed in the web and mobile apps
                in real time via SSE. Our CLI wrapper monitors for input from
                both the Omnara platform and the Claude Code CLI, continuing
                execution when the user responds from either location. Our
                entire backend is open source:
                <a href="https://github.com/omnara-ai/omnara"
                  >https://github.com/omnara-ai/omnara</a
                >.
              </p>
              <p>
                Omnara isn't just for Claude Code. It's a general framework for
                any AI agent to send messages and push notifications to humans
                when they need input. For example, I've been using it as a
                human-in-the-loop node in n8n workflows for replying to emails.
                But every Claude Code user we show it to gets excited about that
                application specifically so that’s why we’re launching that
                first :)
              </p>
              <p>
                Omnara is free for up to 10 agent sessions per month, then
                $9/month for unlimited sessions. Looking forward to your
                feedback and hearing your thoughts and comments!
              </p>
            </div>
          </section>
        </section>
        <section id="44878151">
          <h3>
            <a class="item" href="https://blog.wilsonl.in/search-engine/"
              >Show HN: Building a web search engine from scratch with 3B neural
              embeddings</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 16:02:40</span
              ><span class="points-container"
                >Points: <span class="points">500</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44878151"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44878147">
          <h3>
            <a class="item" href="https://www.anthropic.com/news/1m-context"
              >Claude Sonnet 4 now supports 1M tokens of context</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 16:02:23</span
              ><span class="points-container"
                >Points: <span class="points">1132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44878147"
                  >Comments</a
                ><span class="descendants">: 593</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44876356">
          <h3>
            <a class="item" href="https://tangled.sh/@oppi.li/journal"
              >Journaling using Nix, Vim and coreutils</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 14:04:40</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44876356"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44875992">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2507.21919"
              >Training language models to be warm and empathetic makes them
              less reliable</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 13:32:16</span
              ><span class="points-container"
                >Points: <span class="points">283</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44875992"
                  >Comments</a
                ><span class="descendants">: 296</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44872114">
          <h3>
            <a class="item" href="https://www.dirtyfeed.org/2025/07/from-here/"
              >From Here?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-12 @ 03:35:52</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44872114"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44857100">
          <h3>
            <a
              class="item"
              href="https://www.psu.edu/news/engineering/story/conversations-remotely-detected-cell-phone-vibrations-researchers-report"
              >Conversations remotely detected from cell phone vibrations,
              researchers report</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-10 @ 18:14:38</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44857100"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44856161">
          <h3>
            <a class="item" href="https://hakon.gylterud.net/antipattern/"
              >The Anti-Pattern Game</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-10 @ 16:14:40</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44856161"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44856046">
          <h3>
            <a
              class="item"
              href="https://archive.org/details/QNX_incredible_1.44m_demo_v4.0"
              >QNX: The Incredible 1.44M Demo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-10 @ 15:55:54</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44856046"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44854518">
          <h3>
            <a
              class="item"
              href="https://yosefk.com/blog/llms-arent-world-models.html"
              >LLMs aren't world models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-10 @ 11:40:14</span
              ><span class="points-container"
                >Points: <span class="points">330</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44854518"
                  >Comments</a
                ><span class="descendants">: 189</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44850843">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/L%C3%B6rdagsgodis"
              >Lördagsgodis (Saturday Sweets)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-09 @ 22:18:21</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44850843"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44847903">
          <h3>
            <a class="item" href="https://fingerjigger.com/play"
              >Fingerjigger</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-09 @ 16:36:29</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44847903"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44846781">
          <h3>
            <a class="item" href="https://graphite.rs/libraries/bezier-rs/"
              >Bezier-rs – algorithms for Bézier segments and shapes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-09 @ 14:33:12</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44846781"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44845787">
          <h3>
            <a class="item" href="https://www.sdo.group/study"
              >Multimodal WFH setup: flight SIM, EE lab, and music studio in
              60sqft/5.5M²</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-09 @ 11:48:24</span
              ><span class="points-container"
                >Points: <span class="points">234</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44845787"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44844903">
          <h3>
            <a class="item" href="https://eater.net/quaternions"
              >Visualizing quaternions: An explorable video series (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-09 @ 08:20:00</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44844903"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44843586">
          <h3>
            <a
              class="item"
              href="https://www.thurrott.com/music-videos/324346/blender-is-native-on-windows-11-on-arm"
              >Blender is Native on Windows 11 on Arm</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-09 @ 02:26:48</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44843586"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44843223">
          <h3>
            <a class="item" href="https://prog21.dadgum.com/29.html"
              >A spellchecker used to be a major feat of software engineering
              (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-09 @ 01:07:48</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44843223"
                  >Comments</a
                ><span class="descendants">: 174</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
