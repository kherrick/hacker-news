<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42912515">
          <h3>
            <a class="item" href="https://github.com/tcgoetz/GarminDB"
              >GarminDB</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 22:27:54</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42912515"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42912412">
          <h3>
            <a
              class="item"
              href="https://journals.aps.org/prxquantum/abstract/10.1103/PRXQuantum.6.010309"
              >Emergence of a Second Law of Thermodynamics in Isolated Quantum
              Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 22:15:30</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42912412"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42912133">
          <h3>
            <a
              class="item"
              href="https://onehundredpages.wordpress.com/2013/06/12/dont-make-fun-of-renowned-dan-brown/"
              >Don't make fun of renowned author Dan Brown (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 21:42:02</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42912133"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42911842">
          <h3>
            <a
              class="item"
              href="https://ticotimes.net/2025/01/30/david-vs-goliath-costa-rican-super-mario-defeats-nintendo-in-court"
              >Costa Rican Supermarket Wins Trademark Battle Against Nintendo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 21:07:48</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42911842"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42911511">
          <h3>
            <a
              class="item"
              href="https://www.businessinsider.com/shein-temu-de-minimis-tax-loophole-scrutiny-2024-1"
              >A loophole used by Shein/Temu to ship packages to US tax-free
              (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 20:31:53</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42911511"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42911162">
          <h3>
            <a
              class="item"
              href="https://cloud.google.com/blog/topics/threat-intelligence/scatterbrain-unmasking-poisonplug-obfuscator"
              >ScatterBrain: Unmasking the shadow of PoisonPlug's obfuscator</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 19:46:12</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42911162"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42911042">
          <h3>
            <a class="item" href="https://waydro.id/"
              >Waydroid – Android in a Linux container</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 19:29:45</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42911042"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42910983">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/society/2025/feb/01/i-lost-10-years-of-my-life-how-uk-betting-giants-unlawful-marketing-kept-suicidal-gambler-hooked"
              >UK betting giant's unlawful marketing kept suicidal gambler
              hooked</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 19:21:55</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42910983"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42910829">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/01/24/opinion/alzheimers-fraud-cure.html"
              >The Legacy of Lies in Alzheimer's Science</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 19:00:10</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42910829"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42910105">
          <h3>
            <a class="item" href="https://groundhog-day.com/api"
              >Show HN: Groundhog AI Spring API</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 17:29:24</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42910105"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              <p>
                My Groundhog API is trained on 130 years of data and makes use
                of 82 separate data sources. Similar to DeepSeek, it is
                completely open source and free to use.
              </p>
              <p>
                The primary use case is to make inferences about whether spring
                will come early or not, using a Mixture of Exports (MoE)
                approach, but surely others can be found if you are creative.
              </p>
              <p>
                Other use cases: - All predicting groundhogs - Where they all
                live - Whether they are “real” groundhogs or imposters
              </p>
              <p>Excited to see what people do with it!</p>
            </div>
          </section>
        </section>
        <section id="42909921">
          <h3>
            <a
              class="item"
              href="https://timsh.org/tracking-myself-down-through-in-app-ads/"
              >Everyone knows your location: tracking myself down through in-app
              ads</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 17:07:31</span
              ><span class="points-container"
                >Points: <span class="points">758</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42909921"
                  >Comments</a
                ><span class="descendants">: 252</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42909530">
          <h3>
            <a class="item" href="https://github.com/GyulyVGC/sniffnet"
              >Sniffnet – monitor your Internet traffic</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 16:14:49</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42909530"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42909166">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42909166"
              >Ask HN: What is interviewing like now with everyone using AI?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 15:19:32</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42909166"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
            <div class="text">
              Have you gone back to in-person whiteboards? More focus on
              practical problems? I really have no idea how the traditional tech
              interview is supposed to work now when problems are trivially
              solvable by GPT.
            </div>
          </section>
        </section>
        <section id="42908061">
          <h3>
            <a class="item" href="https://github.com/trycua/lume"
              >Show HN: Lume – OS lightweight CLI for MacOS and Linux VMs on
              Apple Silicon</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 11:46:22</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42908061"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
            <div class="text">
              <p>
                Why we built Lume: - Run native macOS VMs in 1 command, using
                Apple Virtualization.Framework: `lume run
                macos-sequoia-vanilla:latest`
              </p>
              <p>
                - Prebuilt images on
                <a href="https://ghcr.io/trycua">https://ghcr.io/trycua</a>
                (macOS, Ubuntu on ARM)
              </p>
              <p>
                - API server to manage VMs programmatically `POST /lume/vms`
              </p>
              <p>- A python SDK on github.com/trycua/pylume</p>
              <p>
                Run prebuilt macOS images in just 1 step: lume run
                macos-sequoia-vanilla:latest
              </p>
              <p>How to Install:</p>
              <p>brew tap trycua/lume</p>
              <p>brew install lume</p>
              <p>
                You can also download the `lume.pkg.tar.gz` archive from the
                latest release
                <a href="https://github.com/trycua/lume/releases"
                  >https://github.com/trycua/lume/releases</a
                >, extract it, and install the package manually.
              </p>
              <p>
                Local API Server: `lume` exposes a local HTTP API server that
                listens on `<a href="http://localhost:3000/lume"
                  >http://localhost:3000/lume</a
                >`, enabling automated management of VMs.
              </p>
              <p>lume serve</p>
              <p>
                For detailed API documentation, please refer to API Reference(<a
                  href="https://github.com/trycua/lume/blob/main/docs/API-Reference.md"
                  >https://github.com/trycua/lume/blob/main/docs/API-Reference....</a
                >).
              </p>
              <p>
                HN devs - would love raw feedback on the API design and whether
                this solves your Apple Silicon VM pain points. What would make
                you replace UTM/Multipass/Docker Desktop with this?
              </p>
              <p>
                Repo:
                <a href="https://github.com/trycua/lume"
                  >https://github.com/trycua/lume</a
                >
                Python SDK: github.com/trycua/pylume Discord for direct
                feedback:
                <a href="https://discord.gg/8p56E2KJ"
                  >https://discord.gg/8p56E2KJ</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42908041">
          <h3>
            <a class="item" href="https://www.efavdb.com/memory%20recall"
              >Spaced repetition can allow for infinite recall (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 11:42:06</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42908041"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42907766">
          <h3>
            <a
              class="item"
              href="https://ripitapart.com/2020/07/16/reverse-engineering-and-analysis-of-sandisk-high-endurance-microsdxc-card/"
              >Reverse-engineering and analysis of SanDisk High Endurance
              microSDXC card (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 10:32:40</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42907766"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42907765">
          <h3>
            <a class="item" href="https://github.com/esbudylin/modest"
              >Show HN: Modest – musical harmony library for Lua</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 10:32:30</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42907765"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <p>
                I started this project with the idea of using formal grammar to
                parse chord symbols. I wanted to use it instead of a
                hand-written parser, which is the common approach among similar
                libraries. Lua caught my attention because of Lpeg, a Parsing
                Expression Grammar library that is both fast and easy to use. An
                additional motivation for using Lua was the lack of comparable
                libraries for it, even though the language is commonly used in
                audio programming.
              </p>
              <p>
                However, despite being a Lua library, the project itself is
                written in Fennel — a "lispy" language that transpiles to Lua.
                Fennel has features that make writing code for the Lua platform
                much more pleasant: a concise syntax, macros, and destructuring
                — a feature Lua sorely lacks!
              </p>
              <p>
                In the process, I definitely learned a lot about music theory,
                although my new knowledge is quite one-sided. By working on this
                library, I know a thing or two about types and structure of
                chords, but I learned almost nothing about their composition and
                transformation. Perhaps these will be the directions I explore
                next in the project.
              </p>
            </div>
          </section>
        </section>
        <section id="42907488">
          <h3>
            <a
              class="item"
              href="https://adriacabeza.github.io/2024/07/12/caffeine-cache.html"
              >Analyzing the codebase of Caffeine, a high performance caching
              library</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 09:37:05</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42907488"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42907268">
          <h3>
            <a
              class="item"
              href="https://lareviewofbooks.org/article/life-is-more-than-an-engineering-problem/"
              >Life is more than an engineering problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 08:53:58</span
              ><span class="points-container"
                >Points: <span class="points">297</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42907268"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42907139">
          <h3>
            <a
              class="item"
              href="https://brightprogrammer.in/posts/fixing-recursions-in-grammar/"
              >Fixing left and mutual recursions in grammars</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 08:31:12</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42907139"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42905453">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/chatbot-software-begins-to-face-fundamental-limitations-20250131/"
              >Recent results show that LLMs struggle with compositional
              tasks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-02 @ 03:21:07</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42905453"
                  >Comments</a
                ><span class="descendants">: 247</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42902936">
          <h3><a class="item" href="https://rlhfbook.com/">RLHF Book</a></h3>
          <section>
            <h4>
              <span>2025-02-01 @ 22:11:45</span
              ><span class="points-container"
                >Points: <span class="points">393</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42902936"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42902691">
          <h3>
            <a class="item" href="https://lumon-industries.com/"
              >Macrodata Refinement</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-01 @ 21:46:16</span
              ><span class="points-container"
                >Points: <span class="points">577</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42902691"
                  >Comments</a
                ><span class="descendants">: 302</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42901007">
          <h3>
            <a class="item" href="https://github.com/mattsroufe/esp32_rc_cars"
              >Show HN: ESP32 RC Cars</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-01 @ 18:51:31</span
              ><span class="points-container"
                >Points: <span class="points">253</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42901007"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
            <div class="text">
              <p>
                The cars can also be controlled via bluetooth gamepads and is
                meant to be easily hackable.
              </p>
            </div>
          </section>
        </section>
        <section id="42895265">
          <h3>
            <a class="item" href="https://www.hytradboi.com/2025/"
              >Hytradboi 2025 Program</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-01 @ 03:07:35</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42895265"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42893089">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=R7LMApkXJD8"
              >Why do War Thunder players leak classified information?
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-31 @ 22:32:36</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42893089"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42883178">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=tyo8vLorpZo"
              >The PETG adhesive test [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 23:12:08</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42883178"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42879323">
          <h3>
            <a class="item" href="https://block.github.io/goose/"
              >An open-source, extensible AI agent that goes beyond code
              suggestions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 16:27:15</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42879323"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42872882">
          <h3>
            <a class="item" href="https://geyer.dev/blog/windows-flag-emojis/"
              >The dumb reason why flag emojis aren't working on your site in
              Chrome on Windows</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 23:44:35</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42872882"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42869730">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/space/2025/01/astroforge-selects-target-for-high-risk-seat-of-the-pants-asteroid-mission/"
              >AstroForge selects target for "high risk, seat of the pants"
              asteroid mission</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 19:16:42</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42869730"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
