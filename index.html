<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36283317">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/BuyItForLife/comments/146lls7/reddit_has_a_partnership_with_a_san_francisco/"
              >Reddit pays an SF startup millions to analyse all
              shopping-related Reddit data</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 17:18:05</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36283317"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36283249">
          <h3>
            <a class="item" href="https://reddark.untone.uk/"
              >Reddit Strike Has Started</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 17:10:10</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36283249"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36283140">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/writesonic/jobs/PL99uk8-digital-marketing-manager"
              >Writesonic (YC S21) Is Hiring a Digital Marketing Manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 17:01:05</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36283090">
          <h3>
            <a
              class="item"
              href="https://tech.michaelaltfield.net/2023/06/11/lemmy-migration-find-subreddits-communities/"
              >Guide to Finding Lemmy Communities (Subreddits)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 16:55:57</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36283090"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36283003">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gaming/2023/06/one-mans-40-year-8-bit-quest-to-finish-the-c64-rpg-he-started-in-1984/"
              >One man’s nearly 40-year, 8-bit quest to finish his teenage
              Commodore 64 RPG</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 16:48:50</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36283003"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36282526">
          <h3>
            <a
              class="item"
              href="https://www.insidehook.com/daily_brief/health-and-fitness/blue-mind-theory-water-relaxation"
              >“Blue Mind Theory”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 15:53:42</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36282526"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36282294">
          <h3>
            <a
              class="item"
              href="https://hackaday.com/2021/07/24/esp8266-adds-wifi-logging-to-ikeas-air-quality-sensor/"
              >Add $4 WiFi Logging to IKEA’s $12 Air Quality Sensor (Wemos and
              Vindriktning)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 15:29:44</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36282294"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36282076">
          <h3>
            <a
              class="item"
              href="https://vived.io/a-compact-overview-of-jdk-21s-frozen-feature-list-jvm-weekly-vol-138/"
              >A compact overview of JDK 21’s “frozen” feature list</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 15:07:18</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36282076"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36281945">
          <h3>
            <a
              class="item"
              href="https://www.cia.gov/resources/csi/books-monographs/a-tradecraft-primer/"
              >A Tradecraft Primer (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 14:51:31</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36281945"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36281543">
          <h3>
            <a
              class="item"
              href="https://berthub.eu/articles/posts/dutch-intel-law-about-intel/"
              >The Dutch government wants automatic permission to target victims
              of hackers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 14:10:36</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36281543"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36281001">
          <h3>
            <a class="item" href="https://alexsci.com/blog/hsts-adoption/"
              >HSTS preload adoption and challenges</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 13:04:34</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36281001"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36280980">
          <h3>
            <a
              class="item"
              href="https://one-from-nippon.ghost.io/combini-part-2/"
              >A peek into Japan's convenience stores (Part 2)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 13:01:39</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36280980"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36280772">
          <h3>
            <a class="item" href="https://collabfund.com/blog/mental-liquidity/"
              >Mental Liquidity</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 12:31:34</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36280772"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36280393">
          <h3>
            <a
              class="item"
              href="https://www.planetjones.net/blog/10-06-2023/a-trip-to-the-internet-in-1996-with-the-rough-guide-2.0.html"
              >A trip to the internet in 1996 with The Rough Guide 2.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 11:35:40</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36280393"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36280214">
          <h3>
            <a
              class="item"
              href="https://www.bitecode.dev/p/this-is-valid-python-syntax"
              >This is valid Python syntax</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 11:10:14</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36280214"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36280091">
          <h3>
            <a
              class="item"
              href="https://www.afar.com/magazine/how-black-boxes-changed-air-travel"
              >Why aren't black box flight recorders better?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 10:45:11</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36280091"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36280055">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2023/06/03/matrix-powers/"
              >Powers of a 2×2 matrix in closed form</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 10:39:20</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36280055"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36280028">
          <h3>
            <a class="item" href="https://github.com/openobserve/openobserve"
              >Show HN: OpenObserve – Elasticsearch/Datadog alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 10:35:30</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36280028"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <p>
                We are launching OpenObserve. An open source
                Elasticsearch/Splunk/Datadog alternative written in rust and vue
                that is super easy to get started with and has 140x lower
                storage cost compared to elasticsearch. It offers logs, metrics,
                traces, dashboards, alerts, functions (run aws lambda like
                functions during ingestion and query to enrich, redact,
                transform, normalize and whatever else you want to do. Think
                redacting email IDs from logs, adding geolocation based on IP
                address, etc). You can do all of this from the UI, no messing up
                with configuration files.
              </p>
              <p>
                OpenObserve can use local disk for storage in single node mode
                or s3/gcs/minio/azure blob or any s3 compatible store in HA
                mode.
              </p>
              <p>
                We found that setting up observability often involved setting up
                4 different tools (grafana for dashboarding,
                elasticsearch/loki/etc for logs, jaeger for tracing, thanos,
                cortex etc for metrics) and its not simple to do these things.
              </p>
              <p>
                Here is a blog on why we built OpenObserve -
                <a href="https://openobserve.ai/blog/launching-openobserve"
                  >https://openobserve.ai/blog/launching-openobserve</a
                >.
              </p>
              <p>
                We are in early days and would love to get feedback and
                suggestions.
              </p>
            </div>
          </section>
        </section>
        <section id="36279639">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/history/2023/06/11/unabomber-ted-kaczynski-harvard-experiment/"
              >Before he was the Unabomber, Ted Kaczynski was a mind-control
              test subject</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 09:22:09</span
              ><span class="points-container"
                >Points: <span class="points">330</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36279639"
                  >Comments</a
                ><span class="descendants">: 256</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36279403">
          <h3>
            <a
              class="item"
              href="https://matt.life/writing/the-asymmetry-of-open-source"
              >The Asymmetry of Open Source</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 08:28:53</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36279403"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36279341">
          <h3>
            <a class="item" href="http://www.spore.com/rest/stats"
              >Spore Stats</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 08:17:03</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36279341"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36279323">
          <h3>
            <a
              class="item"
              href="https://newsletter.eng-leadership.com/p/growing-from-engineer-to-manager"
              >Growing from engineer to manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 08:13:20</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36279323"
                  >Comments</a
                ><span class="descendants">: 135</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36279129">
          <h3>
            <a
              class="item"
              href="https://neodyme.io/blog/csgo_from_zero_to_0day/"
              >CS:GO: From Zero to 0-Day</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 07:36:14</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36279129"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36277706">
          <h3>
            <a class="item" href="https://jobsort.com/h1b"
              >Searchable and sortable H1B salary database</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 03:27:52</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36277706"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36277696">
          <h3>
            <a
              class="item"
              href="https://blog.nuclearsecrecy.com/2015/12/11/the-curious-death-of-oppenheimers-mistress/"
              >The curious death of Oppenheimer’s mistress (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-11 @ 03:25:56</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36277696"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36274647">
          <h3>
            <a
              class="item"
              href="https://developer.apple.com/library/archive/documentation/LegacyTechnologies/WebObjects/WebObjects_5/WebObjectsOverview/WebObjectsOverview.pdf"
              >WebObjects Overview (2001) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-10 @ 20:18:05</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36274647"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36270802">
          <h3>
            <a
              class="item"
              href="https://www.sfgate.com/tech/article/bay-area-german-bar-iphone-security-breach-18130468.php"
              >The Bay Area German bar that brought down Apple’s famed iPhone
              security</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-10 @ 14:32:54</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36270802"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36267362">
          <h3>
            <a class="item" href="https://tinyawards.net/"
              >Tiny Awards for Small Websites</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-10 @ 03:39:19</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36267362"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36257935">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=3kcQzCzSDvc"
              >I created Clippy [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 14:01:32</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36257935"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36254073">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2023/06/09/cold_boot_ram_theft/"
              >Robot can rip the data out of RAM chips</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-09 @ 06:30:00</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36254073"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
