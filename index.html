<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42258103">
          <h3>
            <a class="item" href="https://bernsteinbear.com/blog/creduce/"
              >You can use C-Reduce for any language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 17:56:24</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42258103"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42257519">
          <h3>
            <a
              class="item"
              href="https://www.archives.gov/publications/prologue/2006/fall/agloso.html"
              >Prelude to McCarthyism: The Making of a Blacklist (2006)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 16:52:38</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42257519"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42257060">
          <h3>
            <a class="item" href="https://github.com/keephq/keep"
              >Launch HN: Keep (YC W23) – Open-source AIOps and alert
              management</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 15:58:42</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42257060"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>
                Simply check it out yourself at
                <a href="https://playground.keephq.dev"
                  >https://playground.keephq.dev</a
                >
                or just have a look at our repo
                <a href="https://github.com/keephq/keep"
                  >https://github.com/keephq/keep</a
                >
              </p>
              <p>
                We always had trouble with anything monitoring, observability
                and alerting, with and without OpenTelemtry. While trying almost
                every tool out there, we always lacked something and eventually
                found ourselves building complementary tools that fit our needs.
              </p>
              <p>
                Keep is like a swiss army knife for alerts - anything from
                collecting, enriching, correlating, and automating. We have over
                90 integrations: anything from alerts, topology (CMDB),
                ticketing, databases, etc., a GitHub-Action-like interface for
                your monitoring stack (we did a Show HN for it here:
                <a href="https://news.ycombinator.com/item?id=37381268"
                  >https://news.ycombinator.com/item?id=37381268</a
                >) triggers manually, cron, alert or incident-based, a smart
                correlation layer, where we use LLMs or pre-configured rules to
                correlate alerts into incidents (imagine “DB is down” and plenty
                of 5XX from other services), opinionated or customized
                deduplication rules to view only the alerts that matter,
                extraction and mapping capabilities to extract/add missing bits
                of information to alerts, a single pane of glass to see and
                manage everything in one place and batteries-included LLM: chat
                with your observability data
              </p>
              <p>
                Tools like BigPanda, Moogsoft, Splunk ITSI, or Datadog Event
                Management treat AIOps as a side quest – trying to vendor-lock
                or deploy AIOps for huge enterprises only while we build a tool
                that can serve organizations of any size.
              </p>
              <p>
                We are completely open-source (MIT license), and we monetize on
                a SaaS-managed version and enterprise features: SSO, RBAC,
                Auditing, 24/7 support, longer retention, and private
                deployments.
              </p>
              <p>
                We are excited to share what we’ve been working on for the last
                year and would love to hear your feedback and opinions!
              </p>
              <p>
                Hosted Demo:
                <a href="https://playground.keephq.dev"
                  >https://playground.keephq.dev</a
                >
              </p>
              <p>
                Open Source:
                <a href="https://github.com/keephq/keep"
                  >https://github.com/keephq/keep</a
                >
              </p>
              <p>
                Landing Page:
                <a href="https://keephq.dev">https://keephq.dev</a>
              </p>
            </div>
          </section>
        </section>
        <section id="42256771">
          <h3>
            <a
              class="item"
              href="https://kerkour.com/aws-s3-vs-cloudflare-r2-price-performance-user-experience"
              >Comparing AWS S3 with Cloudflare R2: Price, Performance and User
              Experience</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 15:26:52</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42256771"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42256594">
          <h3>
            <a
              class="item"
              href="https://devclass.com/2024/11/27/redis-inc-seeks-control-over-future-of-rust-redis-rs-client-library-amid-talk-of-trademark-threat/"
              >Redis Inc seeks control over future of Rust redis-rs client
              library</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 14:58:58</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42256594"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42256589">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2203.10955"
              >Chebyshev Polynomials in the 16th Century (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 14:58:25</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42256589"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42256409">
          <h3>
            <a
              class="item"
              href="https://eshelyaron.com/posts/2024-11-27-emacs-aritrary-code-execution-and-how-to-avoid-it.html"
              >Emacs arbitrary code execution and how to avoid it</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 14:36:06</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42256409"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42256394">
          <h3>
            <a class="item" href="https://www.oranlooney.com/post/genji-ko/"
              >The Art and Mathematics of Genji-Ko</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 14:33:31</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42256394"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42256093">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42256093"
              >Ask HN: Recommendation for a SWE looking to get up to speed with
              latest on AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 13:55:20</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42256093"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
            <div class="text">
              I am looking to get up to speed with the latest things happening
              in AI, I use ChatGPT almost everyday and i last used the open AI
              api for 3.5 last year. I am looking for a tech blogs like HN to
              keep updated on things AI, I came across
              https://simonwillison.net/ but it appears fragmented
            </div>
          </section>
        </section>
        <section id="42255829">
          <h3>
            <a
              class="item"
              href="https://lithub.com/how-the-ancient-sumerians-created-the-worlds-first-writing-system/"
              >Ancient Sumerians created the first writing system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 13:15:57</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42255829"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42254870">
          <h3>
            <a class="item" href="https://github.com/vordenken/AutoPiP"
              >Show HN: AutoPiP – Safari extension for automatic
              Picture-in-Picture mode</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 10:36:00</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42254870"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>
                Key features: • Automatic PiP activation when switching tabs •
                Smart detection for active videos only • Seamless disable on tab
                return • Zero configuration needed
              </p>
              <p>
                GitHub:
                <a href="https://github.com/vordenken/AutoPiP"
                  >https://github.com/vordenken/AutoPiP</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42254434">
          <h3>
            <a class="item" href="https://www.coloringsai.com/en"
              >Show HN: ColoringsAI – Custom Coloring Pages from Ideas (My
              Daughter's Idea)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 09:23:46</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42254434"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              <p>
                With this app, you can type in any idea—like “a unicorn in a
                magical forest” or “a rocket flying through space”—and instantly
                turn it into a printable coloring page. It’s been a hit in our
                house, and now I’m sharing it with everyone!
              </p>
              <p>
                Check it out at ColoringsAI and let me know what you think. I’d
                love to hear your feedback or any fun ideas you come up with!
              </p>
            </div>
          </section>
        </section>
        <section id="42254156">
          <h3>
            <a
              class="item"
              href="https://play.google.com/store/apps/details?id=com.actureunlock&amp;hl=en_US"
              >Show HN: App that asks ‘why?’ every time you unlock your phone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 08:34:35</span
              ><span class="points-container"
                >Points: <span class="points">520</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42254156"
                  >Comments</a
                ><span class="descendants">: 275</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42253654">
          <h3>
            <a class="item" href="https://www.blackjackincolor.com/"
              >How Blackjack Works (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 07:01:10</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42253654"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42253241">
          <h3>
            <a
              class="item"
              href="https://ianthehenry.com/posts/janet-for-mortals/"
              >Janet for Mortals (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 05:34:31</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42253241"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42253211">
          <h3>
            <a
              class="item"
              href="https://archaeology.org/issues/january-february-2019/features/a-dark-age-beacon/"
              >A Dark Age Beacon (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 05:27:21</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42253211"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42253119">
          <h3>
            <a
              class="item"
              href="https://www.downtowndougbrown.com/2024/11/the-capacitor-that-apple-soldered-incorrectly-at-the-factory/"
              >The capacitor that Apple soldered incorrectly at the factory</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 05:10:08</span
              ><span class="points-container"
                >Points: <span class="points">388</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42253119"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42251958">
          <h3>
            <a class="item" href="https://github.com/villasv/ssh-artwork"
              >SSH Artwork</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 01:16:55</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42251958"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42251919">
          <h3>
            <a class="item" href="https://volfpeter.github.io/htmy/"
              >Htmy – Async, pure-Python rendering engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 01:10:53</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42251919"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42251799">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2024/11/hacker-in-snowflake-extortions-may-be-a-u-s-soldier/"
              >Hacker in Snowflake extortions may be a U.S. soldier</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-27 @ 00:53:16</span
              ><span class="points-container"
                >Points: <span class="points">312</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42251799"
                  >Comments</a
                ><span class="descendants">: 170</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42249746">
          <h3>
            <a class="item" href="https://zetaoffice.net/"
              >ZetaOffice: LibreOffice in the Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-26 @ 20:32:24</span
              ><span class="points-container"
                >Points: <span class="points">264</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42249746"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42248584">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/teen-mathematicians-tie-knots-through-a-mind-blowing-fractal-20241126/"
              >Teen mathematicians tie knots through a mind-blowing fractal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-26 @ 18:43:26</span
              ><span class="points-container"
                >Points: <span class="points">300</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42248584"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42245544">
          <h3>
            <a class="item" href="https://mementomovi.wackyneighbor.com/"
              >Memento Movi</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-26 @ 13:31:17</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42245544"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42245105">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2410.13262"
              >Regular Expressions which query an Oracle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-26 @ 12:28:34</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42245105"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42237832">
          <h3>
            <a
              class="item"
              href="http://jpkoning.blogspot.com/2024/11/pricing-anonymity-of-banknotes.html"
              >Pricing the anonymity of banknotes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-25 @ 16:57:09</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42237832"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42233953">
          <h3>
            <a class="item" href="https://jumpingjuliamaze.onrender.com"
              >Show HN: Jumping Julia Maze</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-25 @ 07:14:35</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42233953"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <a href="https://jrmf.org/">https://jrmf.org/</a>
            </div>
          </section>
        </section>
        <section id="42230469">
          <h3>
            <a class="item" href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB491/"
              >Project Sapphire 20th Anniversary (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-24 @ 20:52:05</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42230469"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42229531">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-03817-0"
              >Malaria vaccine delivered by a mosquito bite</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-24 @ 18:40:00</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42229531"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42222990">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41598-024-79546-1"
              >Mummy of juvenile sabre-toothed cat Homotherium latidens from
              Upper Pleistocene</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-23 @ 19:05:00</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42222990"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42219501">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/the-hidden-history-of-marthas-vineyard-sign-language"
              >Martha's Vineyard Sign Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-23 @ 06:29:46</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42219501"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
