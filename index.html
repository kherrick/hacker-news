<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38516965">
          <h3>
            <a
              class="item"
              href="https://www.schneier.com/blog/archives/2023/12/ai-and-trust.html"
              >AI and Trust</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 13:32:36</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38516965"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38516943">
          <h3>
            <a
              class="item"
              href="https://hivekit.io/blog/building-ai-without-a-neural-network/"
              >Building AI without a neural network</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 13:30:45</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38516943"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38516795">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38516795"
              >Launch HN: Slauth (YC S22) – auto-generate secure IAM policies
              for AWS and GCP</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 13:10:30</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38516795"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
            <div class="text">
              <a href="https://slauth.io/">https://slauth.io/</a>. Slauth.io is
              a CLI to auto-generate secure IAM policies for AWS, and GCP (Azure
              in the next few days!). We enable development teams to speed up
              creating secure policies and reduce over-permissive policies being
              deployed to the cloud.
              <p>
                Check out the video or give our open-source CLI a try with one
                of the sample repo's on
                <a href="https://github.com/slauth-io/slauth-cli"
                  >https://github.com/slauth-io/slauth-cli</a
                >
                <a
                  href="https://www.loom.com/share/bd02211659eb4c7f9b335e34094b57cb?sid=f5e84cb2-6939-4d7f-9ed8-90521c90f6de"
                  >https://www.loom.com/share/bd02211659eb4c7f9b335e34094b57cb?...</a
                >
              </p>
              <p>
                We got into the cloud access market by coincidence and were
                amazed by the amount of money spent on IAM. Current tooling such
                as <a href="http://Ermetic.com">http://Ermetic.com</a> and
                <a href="http://wiz.io/">http://wiz.io/</a> visualize IAM
                misconfigurations post deployment but don't actually change
                engineering behavior, leaving organizations in a constant loop
                of engineers deploying over-permissive policies ⇒ security
                engineers/CISO's getting alerts ⇒ Jira tickets created begging
                developers to remediate ⇒ New over-permissive policies being
                deployed again.
              </p>
              <p>
                We interviewed hundreds of developers and DevOps engineers and
                discovered two key pain points:
              </p>
              <p>
                1. *IAM is a Hassle:* Developers despise dealing with IAM
                intricacies. 2. *Speed vs. Security:* IAM was slowing them down
                in deploying quality code swiftly.
              </p>
              <p>
                So the objective is automate policy creation so that developers
                don't have to deal with it, and harden IAM security
                pre-deployment.
              </p>
              <p>
                We employ Large Language Models (currently OpenAI GPT-4) to scan
                code in any language. Through a series of prompts, we identify
                service calls and the actions required. The resource name
                receives a placeholder unless its embedded in the code. We aim
                in the future to create a static code analyzer in order to not
                send any source code to LLM's but for now using LLM's is the
                fastest way to market and somewhat accepted by the industry
                through the use of Github Copilot etc.
              </p>
              <p>
                You can use the CLI in the terminal or actually integrate it in
                your CI/CD and have it become a part of your development team
                workflow.
              </p>
              <p>Three main questions we receive</p>
              <p>
                1. *Security Concerns:* How can I trust [Slauth.io](<a
                  href="http://slauth.io/"
                  >http://slauth.io/</a
                >) to access my source code? 2. *Policy Accuracy:* How can I
                trust [Slauth.io](<a href="http://slauth.io/"
                  >http://slauth.io/</a
                >) creates the right policies? 3. *Differentiation:* How are you
                different from IAMLive, IAMBic AccessAnalyzer or Policy Sentry?
              </p>
              <p>
                To address the first concern, we don't access your code
                directly. Instead, we offer a CLI that integrates into your
                CI/CD pipeline, allowing local code scanning.
                <a href="http://slauth.io/">http://slauth.io/</a> uses your
                OpenAI key to convert the code into a secure policy, with the
                option to output results to *`stdout`* or a file for artifact
                upload and download. That does mean OpenAI has access to the
                source code located in the path you set to be scanned as we need
                to know which SDK calls are performed to generate the policies.
              </p>
              <p>
                We have extensively tested it on AWS , Typescript and GPT 4 with
                very good results (&gt;95% accuracy). We do know these
                accuracies drop when using GPT 3.5 so if possible, use GPT 4 as
                we are improving the prompts. GCP and Azure have been tested
                less but the results when using GPT 4 seem equally high. We also
                have experienced some hallucinations but they have not effected
                the outcome of a secure policy but merely the structure of how
                the policy is generated. That is not to say that it is 100%
                reliable hence we aim to provide toolings to double check
                policies through policy simulators and other means.
              </p>
              <p>
                Compared to competitors, we focus mainly on generating secure
                policies pre-deployment and automating as much as possible. We
                were inspired by IAMLive but it wasn't as scalable to use across
                development teams. Policy Sentry is great for templates but with
                <a href="http://Slauth.io">http://Slauth.io</a> you actually get
                a granular least privilege policy. Lastly, access analyzer is
                used to harden security policies which have already been
                deployed which is similar to other cloud scanning tools and
                creates a strange reactive process to security. The new
                access-analyzer feature checks policy diffs in your CDK but
                again doesn't actually generate the policy pre-deployment.
              </p>
              <p>
                We recognise some engineers are very capable of creating secure
                policies but similar to using Checkov and TFscan in the context
                of IaC deployment, we believe using Slauth.io will become a
                necessity in your CI/CD when deploying service permissions to
                make sure no IAM misconfiguration appear in the cloud.
              </p>
              <p>
                Would love to get your feedback and feel free to interact on our
                Github repo and join our Slack community.
              </p>
            </div>
          </section>
        </section>
        <section id="38516331">
          <h3>
            <a class="item" href="https://go.dev/blog/gob"
              >Gobs of data (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 12:15:12</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38516331"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38516123">
          <h3>
            <a
              class="item"
              href="https://thechipletter.substack.com/p/the-virtues-of-the-8-bit-era-eight"
              >The 8-bit era: Eight iconic processor designs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 11:47:08</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38516123"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38515779">
          <h3>
            <a
              class="item"
              href="https://www.htmhell.dev/adventcalendar/2023/4/"
              >HTML attributes for improved accessibility and user experience</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 10:47:02</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38515779"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38515082">
          <h3>
            <a
              class="item"
              href="https://celso.io/posts/2023/12/03/inercia-2023/"
              >Inércia 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 08:51:42</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38515082"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38514595">
          <h3>
            <a class="item" href="https://github.com/postmodern/kramdown-man"
              >Kramdown-man: A Kramdown convert for converting Markdown files
              into man pages</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 07:32:55</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38514595"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38514537">
          <h3>
            <a
              class="item"
              href="https://newsroom.spotify.com/2023-12-04/an-update-on-december-2023-organizational-changes/"
              >Spotify will reduce total headcount by approximately 17%</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 07:23:29</span
              ><span class="points-container"
                >Points: <span class="points">251</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38514537"
                  >Comments</a
                ><span class="descendants">: 329</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513978">
          <h3>
            <a
              class="item"
              href="https://patmaddox.com/doc/trunk/www/2023-12-sh-relative-shell-script-includes-with-realpath-on-freebsd/"
              >Relative shell script includes with realpath on FreeBSD</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 05:21:09</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513978"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513975">
          <h3>
            <a
              class="item"
              href="https://www.frontiersin.org/articles/10.3389/fcosc.2023.1250996/full"
              >Capturing DNA in snow tracks of polar bear, Eurasian lynx and
              snow leopard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 05:19:25</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513975"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513953">
          <h3>
            <a class="item" href="https://github.com/sunxfancy/vscode-llvm"
              >VSCode LLVM Compiler Explorer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 05:13:18</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513953"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513752">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=HPT7Wtp3yoo"
              >1962 Military Innstructional Video on Magnetic Cores</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 04:27:48</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513752"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513643">
          <h3>
            <a
              class="item"
              href="https://techxplore.com/news/2023-11-experts-revive-ancient-techniques-concrete.html"
              >Experts revive ancient techniques to make concrete more
              sustainable</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 04:08:22</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513643"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513617">
          <h3>
            <a
              class="item"
              href="https://www.frontiersin.org/articles/10.3389/fnbeh.2021.634158/full"
              >Paper vs. devices: Brain activation differences during memory
              retrieval</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 04:04:16</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513617"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513347">
          <h3>
            <a class="item" href="https://dlang.org">D Programming Language</a>
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 03:18:13</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513347"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513225">
          <h3>
            <a
              class="item"
              href="https://web.archive.org/web/20200926103540/https://massimmersionapproach.com/table-of-contents/anki/low-key-anki/the-ease-factor-problem/"
              >The Ease Factor Problem (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 02:55:28</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513225"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513091">
          <h3>
            <a
              class="item"
              href="https://blog.computationalcomplexity.org/2023/12/where-do-non-primitive-recursive.html"
              >Where do non-primitive recursive functions come up naturally?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 02:31:27</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513091"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38513073">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20231122-tyrian-purple-the-lost-ancient-pigment-that-was-more-valuable-than-gold"
              >Tyrian purple: Ancient pigment that was more valuable than
              gold</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 02:28:15</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38513073"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38512793">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2306.03675"
              >Potential of the Julia programming language for high energy
              physics computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 01:42:06</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38512793"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38512656">
          <h3>
            <a
              class="item"
              href="https://blog.golivecosmos.com/embrace-independence-the-case-for-moving-away-from-the-cloud/"
              >A case for moving away from the cloud and embracing local storage
              solutions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 01:23:16</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38512656"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38511697">
          <h3>
            <a
              class="item"
              href="https://www.sensible.so/history-of-the-pdf-pdf"
              >History of the PDF [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-03 @ 23:04:20</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38511697"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38511563">
          <h3>
            <a class="item" href="https://github.com/research-virus/stuxnet"
              >Stuxnet Source Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-03 @ 22:48:06</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38511563"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38510209">
          <h3>
            <a
              class="item"
              href="https://nolanlawson.com/2023/12/02/lets-learn-how-modern-javascript-frameworks-work-by-building-one/"
              >Learn how modern JavaScript frameworks work by building one</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-03 @ 20:00:49</span
              ><span class="points-container"
                >Points: <span class="points">462</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38510209"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38508532">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/motion/4f5f6a29-3af0-4d79-99a4-988ff7c5ba05?utm_source=hn"
              >Motion (YC W20) Is Hiring Front End Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-03 @ 17:00:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38507843">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=s7nx-pMQ6tM"
              >A Vacuum Tube Single Board 1-Bit Computer [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-03 @ 15:40:56</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38507843"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38507446">
          <h3>
            <a class="item" href="https://reportphonespam.org/"
              >Report Phone Spam – Shut down robocallers and text spammers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-03 @ 14:49:51</span
              ><span class="points-container"
                >Points: <span class="points">341</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38507446"
                  >Comments</a
                ><span class="descendants">: 256</span></span
              >
            </h4>
            <div class="text">
              <p>It works, and it feels like magic.</p>
              <p>
                Background: Earlier this year, I wrote an HN comment[1]
                explaining how to find the telecom carrier responsible for a
                robocall or SMS spam campaign. Those steps aren't documented
                anywhere else, even though they're actually pretty easy.
              </p>
              <p>
                This info deserved to be much more visible, so now it is:
                <a href="https://reportphonespam.org/"
                  >https://reportphonespam.org/</a
                >
              </p>
              <p>
                As my site says, most reputable telecom carriers don't want
                unsolicited messages on their network or phone numbers. In order
                to disconnect their abusive customers, they need to hear about
                the abuse. That's where you come in. In a few minutes, you can
                report abuse to the responsible carrier, who will investigate
                and often shut off the spammer's phone number(s).
              </p>
              <p>
                [1]:
                <a href="https://news.ycombinator.com/item?id=34570065#34570835"
                  >https://news.ycombinator.com/item?id=34570065#34570835</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="38506460">
          <h3>
            <a
              class="item"
              href="https://blog.forret.com/2023/12/01/printthatvideo/"
              >Now I can just print that video</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-03 @ 12:02:14</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38506460"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38506166">
          <h3>
            <a class="item" href="https://plant.max-richter.dev"
              >Show HN: Simulate 3D plants in the browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-03 @ 10:55:35</span
              ><span class="points-container"
                >Points: <span class="points">404</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38506166"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38505211">
          <h3>
            <a class="item" href="https://bbycroft.net/llm"
              >LLM Visualization</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-03 @ 06:08:29</span
              ><span class="points-container"
                >Points: <span class="points">1211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38505211"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
