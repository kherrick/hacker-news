<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39778590">
          <h3>
            <a class="item" href="https://www.ycombinator.com/blog/the-reddits"
              >The Reddits</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 14:00:04</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39778590"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39778570">
          <h3>
            <a class="item" href="https://github.com/chearon/dropflow"
              >Show HN: Dropflow, a CSS layout engine for node or
            </a>
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 13:58:31</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39778570"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <p>
                Live demo:
                <a href="https://chearon.github.io/dropflow/"
                  >https://chearon.github.io/dropflow/</a
                >
              </p>
              <p>
                It matches browsers in all cases I can find where they agree,
                and it's fast. It supports `position`, `inline-block`,
                `z-index`, and complex properties like `float` and
                `vertical-align`. It doesn't support high-level layout like
                flexbox or grid yet, but you can get intrinsics to easily divide
                space yourself and paint multiple layout trees. It has a great
                text layout implementation, and supporting non-Latin scripts is
                a top priority.
              </p>
              <p>
                I've wanted this to exist as far back as 2013, and the desire
                kept coming up: for a way to get detailed intrinsics, for high
                quality rich text layout to canvas and SVG, and for server-side
                rich text. We currently use it in CellEngine for our new
                canvas-based spreadsheet library to layout text in hundreds of
                thousands of cells, and will be using it soon to render PDFs
                with thousands of pages in a few seconds.
              </p>
            </div>
          </section>
        </section>
        <section id="39778415">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/03/21/health/pig-kidney-organ-transplant.html"
              >Surgeons Transplant Pig Kidney into a Patient</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 13:42:55</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39778415"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39778412">
          <h3>
            <a class="item" href="https://difftastic.wilfred.me.uk/"
              >Difftastic, a structural diff tool that understands syntax</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 13:42:46</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39778412"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39778372">
          <h3>
            <a
              class="item"
              href="https://www.aol.com/news/unitedhealth-group-paid-more-2-125226015.html"
              >UnitedHealth Group has paid more than $2B to providers following
              cyberattack</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 13:37:45</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39778372"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39777898">
          <h3>
            <a
              class="item"
              href="https://today.ucsd.edu/story/biodegradable-microplastics"
              >Research shows plant-based polymers can disappear within seven
              months</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 12:50:58</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39777898"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39777896">
          <h3>
            <a class="item" href="https://nesslabs.com/ikigai"
              >Ikigai: What We Got Wrong and How to Find Meaning in Life</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 12:50:52</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39777896"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39777712">
          <h3>
            <a
              class="item"
              href="https://www.eurekalert.org/news-releases/1037372"
              >CDC sharply overestimates maternal death rate, new study finds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 12:31:43</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39777712"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39777666">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/Linux-6.9-Faster-exFAT-dirsync"
              >ExFAT Driver Boasts Much Faster "Dirsync" Performance with Linux
              6.9</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 12:28:04</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39777666"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39777528">
          <h3>
            <a
              class="item"
              href="https://themeisle.com/blog/we-are-open-sourcing-our-ai-site-builder/"
              >Show HN: An AI-Powered WordPress Site Builder That We Are
              Open-Sourcing Today</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 12:11:43</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39777528"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39777449">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/trayd/jobs/diovYI2-solutions-engineer"
              >Trayd (YC S23) Is Growing Hiring Solutions Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 12:00:20</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39777229">
          <h3>
            <a class="item" href="https://jsomers.net/e-coli-chemotaxis/"
              >The baffling intelligence of a single cell: The story of E. coli
              chemotaxis</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 11:29:37</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39777229"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39777223">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39777223"
              >Ask HN: How to onboard yourself to a new product/industry in a
              new job?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 11:28:45</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39777223"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
            <div class="text">
              <p>
                We do have a set of required reading material that I've gone
                through, along with product demos, and even 2 VC books that have
                been recommended on the subject. But unfortunately, I still feel
                left behind. I need repetition to understand something deeply.
                Kind of like rote.
              </p>
              <p>
                The lack of knowledge is obviously going to affect my growth
                somewhere down the line as well as in identifying opportunities
                for the company's growth.
              </p>
              <p>
                I'm looking for advice on what can I do more from folks who
                joined a company/product/industry that they knew nothing about
                and how long it took you to get comfortable with it?
              </p>
            </div>
          </section>
        </section>
        <section id="39777007">
          <h3>
            <a class="item" href="https://github.com/mercari/tortoise"
              >Tortoise: Shell-Shockingly-Good Kubernetes Autoscaling</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 10:56:08</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39777007"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39776745">
          <h3>
            <a class="item" href="https://github.com/aforensics/HiddenVM"
              >HiddenVM – Use any desktop OS without leaving a trace</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 10:16:01</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39776745"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39776199">
          <h3>
            <a class="item" href="https://github.com/paveldedik/ludic"
              >Ludic: New framework for Python with seamless Htmx support</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 08:57:17</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39776199"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39775304">
          <h3>
            <a class="item" href="https://file770.com/vernor-vinge-1944-2024/"
              >Vernor Vinge (1944-2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 06:08:40</span
              ><span class="points-container"
                >Points: <span class="points">433</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39775304"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39774253">
          <h3>
            <a
              class="item"
              href="https://rootsofprogress.org/why-did-we-wait-so-long-for-the-bicycle"
              >Why did we wait so long for the bicycle? (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 02:10:23</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39774253"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39773641">
          <h3>
            <a
              class="item"
              href="https://github.com/00-Evan/shattered-pixel-dungeon"
              >Shattered Pixel Dungeon is an open-source traditional roguelike
              dungeon crawler</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-21 @ 00:21:49</span
              ><span class="points-container"
                >Points: <span class="points">621</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39773641"
                  >Comments</a
                ><span class="descendants">: 186</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39772533">
          <h3>
            <a class="item" href="https://github.com/Nukesor/pueue"
              >Sequential and parallel execution of long-running shell
              commands</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 22:02:43</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39772533"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39771983">
          <h3>
            <a class="item" href="https://www.jitx.com"
              >JITX – The Fastest Way to Design Circuit Boards</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 21:01:11</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39771983"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39771925">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Crookes_radiometer"
              >Crookes Radiometer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 20:56:41</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39771925"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39771754">
          <h3>
            <a
              class="item"
              href="https://www.gamedeveloper.com/business/obituary-jim-ward-dungeons-dragons-designer-died-at-age-72"
              >Jim Ward has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 20:40:11</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39771754"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39769412">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39769412"
              >Launch HN: CamelQA (YC W24) – AI that tests mobile apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 17:13:07</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39769412"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
            <div class="text">
              <a href="https://camelqa.com/">https://camelqa.com/</a>). We’re
              building an AI agent that can automate mobile devices using
              computer vision. Our first use case is for mobile app QA. We
              convert natural language test cases into tests that run on real
              iOS and Android devices in our device farm.
              <p>
                Flaky UI tests suck. We want to create a solution where
                engineers don’t waste time maintaining fragile scripts.
              </p>
              <p>
                camelQA uses a combination of accessibility element data along
                with an in-house custom vision-only RCNN object detection model
                paired with Google Siglip for UI element classification (see a
                sample output here -
                <a href="https://camelqa.com/blog/sole-ui-element-detector.png"
                  >https://camelqa.com/blog/sole-ui-element-detector.png</a
                >). This way we’re able to detect elements even if they do not
                have accessibility elements associated with them.
              </p>
              <p>
                Under the hood the agent is using Appium to interface with the
                device. We use GPT-4V to reason at a high level and GPT-3.5 to
                execute the high-level actions. Check out a gif of our
                playground here (<a
                  href="https://camelqa.com/blog/sole-signup.gif"
                  >https://camelqa.com/blog/sole-signup.gif</a
                >)
              </p>
              <p>
                Since we’re vision based, we don’t need access to your source
                code and we work across all app types - SwiftUI and UIKit, React
                Native, Flutter.
              </p>
              <p>
                We built a demo for HN where you can use our model to control
                Wikipedia on a simulated iPhone. Check that out here (<a
                  href="https://demo.camelqa.com/"
                  >https://demo.camelqa.com/</a
                >). Try giving it a task like “Bookmark the wiki page for Ilya
                Sutskever“ or “Find San Francisco in the Places tab”. We only
                have 5 simulators running so there may be a wait. You get 5
                minutes once you enter your first command.
              </p>
              <p>
                If you want to see what our front end looks like, we made an
                account with some test runs. Use this login (Username:
                hackerNews Password: 1337hackerNews!) to view our sandboxed HN
                account (<a href="https://dash.camelqa.com/login"
                  >https://dash.camelqa.com/login</a
                >).
              </p>
              <p>
                Last year we left our corporate jobs to build in the AI space.
                It felt like we were endlessly testing our apps, even for minor
                updates, and we still shipped a bug that caused one of our apps
                to crash on subscribe (the app in question -
                <a
                  href="https://apps.apple.com/us/app/tldr-ai-summarizer/id6449304716"
                  >https://apps.apple.com/us/app/tldr-ai-summarizer/id644930471...</a
                >). That was the catalyst for camelQA.
              </p>
              <p>We’re excited to hear what you all think!</p>
            </div>
          </section>
        </section>
        <section id="39768860">
          <h3>
            <a class="item" href="https://danluu.com/discontinuities/"
              >Suspicious discontinuities (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 16:31:14</span
              ><span class="points-container"
                >Points: <span class="points">451</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39768860"
                  >Comments</a
                ><span class="descendants">: 224</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39768604">
          <h3>
            <a
              class="item"
              href="https://news.northeastern.edu/2024/03/20/parrots-playing-tablet-games/"
              >Parrots love playing tablet games. That's helping researchers
              understand them</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 16:15:03</span
              ><span class="points-container"
                >Points: <span class="points">287</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39768604"
                  >Comments</a
                ><span class="descendants">: 143</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39768438">
          <h3>
            <a
              class="item"
              href="https://scholar.googleblog.com/2024/03/supercharge-your-pdf-reading-follow.html"
              >Google Scholar PDF Reader</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 16:03:59</span
              ><span class="points-container"
                >Points: <span class="points">353</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39768438"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39768434">
          <h3>
            <a
              class="item"
              href="https://www.flightradar24.com/blog/gps-jamming-map/"
              >Flightradar24's new GPS jamming map</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 16:03:21</span
              ><span class="points-container"
                >Points: <span class="points">868</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39768434"
                  >Comments</a
                ><span class="descendants">: 230</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39766893">
          <h3>
            <a
              class="item"
              href="https://rive.app/blog/rive-renderer-now-open-source-and-available-on-all-platforms"
              >Rive Renderer for real-time vector graphics is now open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 14:16:52</span
              ><span class="points-container"
                >Points: <span class="points">374</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39766893"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39765718">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/03/20/us/politics/chips-act-grant-intel.html"
              >Intel to Receive $8.5B in Grants to Build Chip Plants</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-20 @ 12:51:35</span
              ><span class="points-container"
                >Points: <span class="points">305</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39765718"
                  >Comments</a
                ><span class="descendants">: 541</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
