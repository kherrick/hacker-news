<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42985427">
          <h3>
            <a class="item" href="https://johnkerl.org/doc/ortho/ortho.html"
              >Tips for Mathematical Handwriting (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 19:20:10</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42985427"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42984962">
          <h3>
            <a class="item" href="https://git.sr.ht/~egtann/txtar/"
              >Show HN: Chez Scheme txtar port from Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 18:24:39</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42984962"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <a href="https://golang.org/x/tools/txtar"
                >https://golang.org/x/tools/txtar</a
              >, which concatenates files together and allows for a top-level
              comment.
              <p>
                The txtar format is specifically designed to be easy for humans
                to read and write by hand. It's perfect for test data.
              </p>
              <p>
                The library itself tries to follow scheme standards by depending
                on only SRFIs (and if you're new to scheme like me, SRFI stands
                for "Scheme Requests For Implementation," and it's like a
                standard library). I hope this is a helpful showcase of a scheme
                library!
              </p>
              <p>
                I'm also new to writing scheme, and if any experienced
                scheme/lisp devs are out there with feedback, that would be much
                appreciated.
              </p>
            </div>
          </section>
        </section>
        <section id="42984813">
          <h3>
            <a
              class="item"
              href="https://www.afi.com/news/the-daughter-of-dawn-1920-afi-catalog-spotlight/"
              >The Daughter of Dawn [1920] (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 18:08:15</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42984813"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42984791">
          <h3>
            <a
              class="item"
              href="https://fortune.com/2024/06/12/amazon-insiders-why-new-alexa-llm-generative-ai-conversational-chatbot-missing-in-action/"
              >Amazon blew Alexa's shot to dominate AI, according to employees
              (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 18:06:38</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42984791"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42984457">
          <h3>
            <a
              class="item"
              href="https://scorpiosoftware.net/2025/02/08/writing-a-simple-driver-in-rust/"
              >Writing a Simple Windows Driver in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 17:25:03</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42984457"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42984420">
          <h3>
            <a class="item" href="https://github.com/wojciech-kulik/FlashSpace"
              >Show HN: FlashSpace – fast, open-source, macOS Spaces
              replacement</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 17:19:23</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42984420"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              I've recently launched a new open-source project aimed at
              enhancing the experience of switching between Spaces/workspaces on
              macOS. The built-in Spaces feature is often slow and unfriendly.
              This project is designed to boost your productivity :). Enjoy!
            </div>
          </section>
        </section>
        <section id="42983835">
          <h3>
            <a class="item" href="https://literaryreview.co.uk/no-way-home"
              >No Way Home</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 16:04:06</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42983835"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42983733">
          <h3>
            <a
              class="item"
              href="https://herecomesthemoon.net/2025/02/carbon-is-not-a-language/"
              >Carbon is not a programming language (sort of)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 15:51:06</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42983733"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42983699">
          <h3>
            <a class="item" href="https://github.com/xajik/thedeck"
              >The Deck: An open-source cross-platform multiplayer card game
              engine in Flutter</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 15:47:36</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42983699"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42983571">
          <h3>
            <a
              class="item"
              href="https://softwarecrisis.dev/letters/llmentalist/"
              >The LLMentalist Effect</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 15:30:44</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42983571"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42983275">
          <h3>
            <a class="item" href="https://antirez.com/news/145"
              >We are destroying software</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 14:48:25</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42983275"
                  >Comments</a
                ><span class="descendants">: 151</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42982270">
          <h3>
            <a
              class="item"
              href="https://video.fosdem.org/2025/h1302/fosdem-2025-6479-a-tale-of-several-distros-joining-forces-for-a-common-goal-reproducible-builds.av1.webm"
              >A tale of several distros joining forces for a common goal:
              reproducible builds</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 11:38:33</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42982270"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42982015">
          <h3>
            <a
              class="item"
              href="https://redpenguin101.github.io/html/posts/2025_01_21_voronoi.html"
              >Generating Voronoi Diagrams Using Fortune's Algorithm (With
              Odin)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 10:41:17</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42982015"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42979467">
          <h3>
            <a class="item" href="https://fly.io/blog/vscode-ssh-wtf/"
              >VSCode’s SSH agent is bananas</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 01:25:32</span
              ><span class="points-container"
                >Points: <span class="points">592</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42979467"
                  >Comments</a
                ><span class="descendants">: 410</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42978199">
          <h3>
            <a class="item" href="https://amanvir.com/obscure-islands"
              >Obscure islands I find interesting</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 22:23:31</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42978199"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42976698">
          <h3>
            <a
              class="item"
              href="https://blog.danslimmon.com/2019/07/15/do-nothing-scripting-the-key-to-gradual-automation/"
              >Do-nothing scripting: the key to gradual automation (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 19:48:16</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42976698"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42975492">
          <h3>
            <a
              class="item"
              href="https://kevin.burke.dev/kevin/norcal-cities-new-utility/"
              >Cities can cost effectively start their own utilities</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 17:55:40</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42975492"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42969322">
          <h3>
            <a
              class="item"
              href="https://www.muppetlabs.com/~breadbox/software/tiny/teensy.html"
              >A whirlwind tutorial on creating teensy ELF executables for Linux
              (1999)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 04:16:49</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42969322"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42960684">
          <h3>
            <a class="item" href="https://origamee.net/"
              >Origami by Meenakshi</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 09:34:18</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42960684"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42959841">
          <h3>
            <a class="item" href="https://github.com/mierau/hotline"
              >Hotline for modern Apple systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 07:01:26</span
              ><span class="points-container"
                >Points: <span class="points">438</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42959841"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42958542">
          <h3>
            <a
              class="item"
              href="https://brooker.co.za/blog/2025/02/04/versioning.html"
              >Versioning versus Coordination</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 03:10:56</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42958542"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42957799">
          <h3>
            <a class="item" href="https://fullystacked.net/how-to-gif-2025/"
              >How to GIF (2025 Edition)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 01:23:48</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42957799"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42957395">
          <h3>
            <a class="item" href="https://blog.danielh.cc/blog/puzzle"
              >From hours to 360ms: over-engineering a puzzle solution</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 00:26:32</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42957395"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42956697">
          <h3>
            <a class="item" href="https://lucumr.pocoo.org/2025/2/4/fat-rand/"
              >Fat Rand: How many lines do you need to generate a random
              number?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 23:10:47</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42956697"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42954058">
          <h3>
            <a class="item" href="https://globalcapslock.com"
              >Global Caps Lock Key</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 19:46:30</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42954058"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42950976">
          <h3>
            <a class="item" href="https://chiraaggohel.com/posts/llms-eda/"
              >Are LLMs able to notice the “gorilla in the data”?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 16:33:55</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42950976"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42950156">
          <h3>
            <a
              class="item"
              href="https://surfingcomplexity.blog/2025/02/01/youre-missing-your-near-misses/"
              >You're missing your near misses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 15:45:30</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42950156"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42946095">
          <h3>
            <a
              class="item"
              href="https://untested.sonnet.io/notes/insomnia-control/"
              >Insomnia, Control</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 09:27:30</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42946095"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42945980">
          <h3>
            <a
              class="item"
              href="https://soranews24.com/2024/12/21/station-of-despair-what-to-do-if-you-get-stuck-at-the-end-of-tokyos-chuo-rapid-line/"
              >Station of despair: What to do if you get stuck at end of Tokyo
              Chuo Rapid Line</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 09:12:41</span
              ><span class="points-container"
                >Points: <span class="points">477</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42945980"
                  >Comments</a
                ><span class="descendants">: 289</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42936650">
          <h3>
            <a class="item" href="https://usetapestry.com/"
              >Tapestry by Iconfactory</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-04 @ 18:34:47</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42936650"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
