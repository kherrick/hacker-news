<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37935550">
          <h3>
            <a
              class="item"
              href="https://twitter.com/1517fund/status/1714766669149532351"
              >Richard Feynman explains neutron stars</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 22:18:22</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37935550"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37935333">
          <h3>
            <a
              class="item"
              href="https://www.hypebot.com/hypebot/2023/10/every-member-of-bandcamp-united-union-bargaining-team-was-laid-off.html"
              >Every member of Bandcamp United Union bargaining team was laid
              off – Hypebot</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 21:58:29</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37935333"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37935232">
          <h3>
            <a class="item" href="https://enhanced.org/"
              >The Enhanced Game – Sports, without drug testing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 21:49:14</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37935232"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37935053">
          <h3>
            <a class="item" href="https://a16z.com/how-to-scale-nuclear-power/"
              >How to Scale Nuclear Power</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 21:31:00</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37935053"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37934705">
          <h3>
            <a class="item" href="https://akuity.io/argocon/"
              >ArgoCon – Vendor-neutral Argo-focused Event</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 21:01:28</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37934705"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37934688">
          <h3>
            <a
              class="item"
              href="https://prequelco.notion.site/Founding-Marketer-Prequel-prequel-co-1d7c0fe411fa4989a50729c014611f1c"
              >Prequel.co (Enterprise Data Sharing) Is Hiring a Founding
              Marketer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 21:00:19</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37934439">
          <h3>
            <a
              class="item"
              href="https://github.com/konigsoftware/konig-kontext"
              >gRPC request context which caries values across microservice
              boundaries</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 20:36:19</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37934439"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37934034">
          <h3>
            <a class="item" href="https://www.awk.dev/"
              >The Awk Programming Language, Second Edition</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 20:02:47</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37934034"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37933633">
          <h3>
            <a
              class="item"
              href="https://newsletter.thejorgemedina.com/p/youre-not-lacking-creativity-youre"
              >You're not lacking creativity, you're overwhelmed</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 19:33:46</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37933633"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37932971">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/10/18/whisper-aero-unveils-ultra-quiet-electric-leaf-blower-powered-by-aerospace-tech/"
              >An ultra-quiet electric leaf blower</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 18:48:03</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37932971"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37931424">
          <h3>
            <a
              class="item"
              href="https://www.kcl.ac.uk/news/links-between-alzheimers-and-gut-microbiota"
              >Scientists discover links between Alzheimer's disease and gut
              microbiota</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 16:56:05</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37931424"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37931383">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/10/18/hacker-leaks-millions-more-23andme-user-records-on-cybercrime-forum/"
              >Hacker leaks millions more 23andMe user records on cybercrime
              forum</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 16:52:58</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37931383"
                  >Comments</a
                ><span class="descendants">: 209</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37931373">
          <h3>
            <a class="item" href="https://rocicorp.dev/blog/ready-player-two"
              >Reflect – Multiplayer web app framework with game-style
              synchronization</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 16:51:53</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37931373"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37931294">
          <h3>
            <a class="item" href="https://www.adept.ai/blog/fuyu-8b"
              >Fuyu-8B: A multimodal architecture for AI agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 16:46:44</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37931294"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37930663">
          <h3>
            <a
              class="item"
              href="https://www.opencompute.org/blog/amd-arm-intel-meta-microsoft-nvidia-and-qualcomm-standardize-next-generation-narrow-precision-data-formats-for-ai"
              >Standardizing next-generation narrow precision data formats for
              AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 16:04:18</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37930663"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37930634">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2023/10/the-fake-browser-update-scam-gets-a-makeover/"
              >The fake browser update scam gets a makeover</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 16:02:41</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37930634"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37930441">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37930441"
              >Launch HN: Pier (YC W23) – Stripe for Credit</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 15:50:30</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37930441"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.pier-finance.com"
                >https://www.pier-finance.com</a
              >). Pier is an API for launching credit products. We enable any
              company to offer credit by handling origination, underwriting,
              compliance and servicing with just a few lines of code.
              <p>
                There’s no ‘try it out’ link, primarily because (as most fintech
                devs know) there are compliance and regulatory thresholds that
                make it hard for us to give out sandbox keys freely. However,
                we’ve put together this video to show you the basics of how Pier
                works:
                <a
                  href="https://www.loom.com/share/04883eb17f394b46a67cce919cb77356"
                  >https://www.loom.com/share/04883eb17f394b46a67cce919cb77356</a
                >.
              </p>
              <p>
                Alex &amp; I worked together at our last company, a credit tech
                startup, where we saw how businesses struggle to launch credit
                products quickly &amp; compliantly, due to fragmented solutions
                and high compliance hurdles. We’ve talked to many companies
                looking to launch their own product, and are taking our
                learnings from before to build a modular, flexible credit stack.
              </p>
              <p>
                Credit is highly complex and requires a dedicated team -—and few
                people specialize in this. Unlike social apps where you can
                launch with a 70% product and iterate over time, credit is
                heavily regulated and needs to be done 100% right from the
                beginning. When you factor this in with federal and state
                regulations across 50 states, the tech stack and compliance
                hurdles become too time-consuming and expensive for companies to
                build in-house, especially for fast-moving teams trying to build
                innovative products. We’re talking 9-12 months of buildout and
                millions of dollars. This is what most companies struggle with
                and it’s why we’re valuable to them.
              </p>
              <p>
                Our credit infrastructure gives developers the freedom of not
                having to worry about the details of managing a credit program.
                Using Pier, they can offer credit to their users without ever
                directing them outside their app. Our API powers it all under
                the hood (see API docs:
                <a href="https://pier-dev.readme.io"
                  >https://pier-dev.readme.io</a
                >)
              </p>
              <p>
                For example, a business (say "ACME") has a user who comes to
                their platform &amp; applies for a loan. That user stays on
                ACME’s platform and is never redirected to a 3rd party. ACME
                owns the entire UX from presenting loan offer, to signing loan
                docs, to disbursing funds, sending statements and collecting
                payments. What ACME doesn’t have to deal with is any of the back
                end. Each part of this flow is powered by Pier API.
              </p>
              <p>
                We support the full credit lifecycle from loan origination to
                loan servicing. Want to generate a loan doc for a specific
                credit offer &amp; user? We've an endpoint that creates a pdf to
                present to the user, and ensures it doesn’t violate any laws for
                the state the user is in. Want to retrieve loan balance,
                generate loan statement or process loan payment? We've API
                endpoints for that too.
              </p>
              <p>
                There're existing products that solve parts of the credit stack,
                such as KYC &amp; underwriting, but nothing that solves the
                credit stack end-to-end. Credit is different from payments and
                banking-—those are 1x activities, while loan terms are for 12
                months or more. We see “credit” as a living-and-breathing
                creature that evolves throughout each loan’s life cycle due to a
                variety of behaviors, hence requires an end-to-end solution to
                properly address.
              </p>
              <p>
                Since launching a few months ago, we’ve onboarded several
                customers and have live loan traffic on our platform. Our
                existing customers use Pier to provide a wide variety of credit
                products to their users, including BNPL for wedding, credit
                builder, BNPL for clean energy, salary advance loans, portfolio
                line of credit, etc.
              </p>
              <p>
                Pricing - Monthly min Saas fee ($7-20k/mth), and a usage fee of
                0.2-1.0% of loan volume for origination and servicing. This
                largely depends on the credit program and loan volume.
              </p>
              <p>
                We’re building devtools to enable the next-gen of credit
                products, with our goal to make credit more accessible to
                everyone! We’re super eager to get your feedback — What’s your
                experience building in fintech/credit? What can we do to make
                this better? Anything else that comes to mind? Thank you!
              </p>
            </div>
          </section>
        </section>
        <section id="37930266">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-03244-7"
              >New pill helps Covid smell and taste loss fade quickly</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 15:40:06</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37930266"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37929711">
          <h3>
            <a
              class="item"
              href="https://www.breck-mckye.com/blog/2023/05/Microfrontends-should-be-your-last-resort/"
              >Microfrontends should be a last resort</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 15:03:01</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37929711"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37929338">
          <h3>
            <a
              class="item"
              href="https://www.lumafield.com/article/usb-c-cable-charger-head-to-head-comparison-apple-thunderbolt-amazon-basics"
              >USB-C head-to-head comparison</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 14:38:23</span
              ><span class="points-container"
                >Points: <span class="points">299</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37929338"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37927734">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-03230-z"
              >A 1990 experiment to test whether we could discern life on Earth
              remotely</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 12:37:29</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37927734"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37927344">
          <h3>
            <a class="item" href="https://onthearts.com/p/what-is-the-demoscene"
              >What is the Demoscene? An interview</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 11:48:56</span
              ><span class="points-container"
                >Points: <span class="points">468</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37927344"
                  >Comments</a
                ><span class="descendants">: 191</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37926849">
          <h3>
            <a
              class="item"
              href="https://www.ex-astris-scientia.org/database/chairs-trek.htm"
              >Commercially available chairs in Star Trek</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 10:28:11</span
              ><span class="points-container"
                >Points: <span class="points">562</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37926849"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37926741">
          <h3>
            <a class="item" href="https://github.com/microsoft/autogen"
              >Autogen: Enable next-gen large language model applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 10:07:17</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37926741"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37926005">
          <h3>
            <a
              class="item"
              href="https://www.corsix.org/content/higher-quality-random-floats"
              >Higher quality random floats</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 08:01:18</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37926005"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37925538">
          <h3>
            <a class="item" href="http://theurquanmasters.com/"
              >The Ur-Quan Masters: Open-source remake of Star Control II</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 06:51:06</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37925538"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37925411">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/essay/agrippa-occult-philosophy"
              >Marked by Stars – Agrippa's Occult Philosophy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-18 @ 06:25:59</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37925411"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37922748">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Winsorized_mean"
              >Winsorized mean</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 23:04:51</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37922748"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37913709">
          <h3>
            <a
              class="item"
              href="https://themillions.com/2023/10/how-to-exclaim.html"
              >How to Exclaim!</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 12:08:23</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37913709"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37911900">
          <h3>
            <a
              class="item"
              href="https://ntietz.com/blog/write-more-useless-software/"
              >Write More "Useless" Software</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-17 @ 08:05:16</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37911900"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
