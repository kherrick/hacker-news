<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37770008">
          <h3>
            <a class="item" href="https://github.com/sebosp/s2protocol-rs"
              >Show HN: Rust nom parsing Starcraft2 Replays into Arrow for
              Polars data analysis</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 19:03:36</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37770008"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              Been having a lot of fun reading an SC2Replay collection through
              nom parsers, serializing into Arrow files so that pola.rs can read
              them and perform data analysis with jupyter lab, plotly or
              interact with SQL operations, etc. Looking for feedback and ideas
              on what to progress on. For example, "through history, are my
              timings getting better?". etc. Also would love to have ideas on
              what libraries to use to perform forecasting.
            </div>
          </section>
        </section>
        <section id="37769595">
          <h3>
            <a class="item" href="https://console.algora.io/hacktoberfest"
              >Show HN: Algora – Open source coding bounties</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 18:34:11</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37769595"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              <p>
                1 min demo:
                <a
                  href="https://twitter.com/algoraio/status/1641560954746839042"
                  >https://twitter.com/algoraio/status/1641560954746839042</a
                >
              </p>
              <p>
                The context: contributing to open source helps developers gain
                experience, grow their networks &amp; land jobs while helping
                maintainers ship product updates and push their projects forward
                for the whole community
              </p>
              <p>
                The problem: there's too much work to be done in open source and
                not enough people contributing. Introducing payments can make
                contributing more accessible &amp; benefit both sides, however
                today paid open source is scarce, low trust &amp; high friction
              </p>
              <p>
                Our solution: we built an app that streamlines open source
                bounties on Github
              </p>
              <p>
                To date, OSS projects on the plaftorm have awarded $65,785 (600
                bounties) to 188 contributors from 48 countries
              </p>
              <p>
                Right now, 43 OSS projects (mainly Typescript, Rust &amp; Scala)
                have made 242 bounties ($46,899) available to solve
              </p>
              <p>
                To create bounties in your project, simply register, install our
                app in your repo(s) and use the /bounty command on issues
              </p>
              <p>
                To solve bounties, submit a PR including the /claim command
                &amp; connect with Stripe/Alipay to receive payouts
              </p>
              <p>
                We also started a COSS founder podcast to share lessons &amp;
                advice for building open source companies:
                <a href="https://youtube.com/@algora-io"
                  >https://youtube.com/@algora-io</a
                >
              </p>
              <p>
                We think it's now a great time to welcome new contributors &amp;
                maintainers on the Algora platform - happy Hacktoberfest!
              </p>
              <p>
                We are really excited to hear your feedback/questions and
                connect further: our emails are ioannis@algora.io &amp;
                zafer@algora.io
              </p>
              <p>Thank you!</p>
            </div>
          </section>
        </section>
        <section id="37769546">
          <h3>
            <a class="item" href="https://minios.dev"
              >MiniOS – a lightweight Linux distribution designed for USB
              drive</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 18:30:05</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37769546"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37769139">
          <h3>
            <a
              class="item"
              href="https://oh8hub.substack.com/p/eliminating-radio-interference-from"
              >Eliminating Radio Interference from Apple Charger</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 18:01:14</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37769139"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37768979">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/information-technology/2023/10/facebooks-new-ai-stickers-can-generate-mickey-mouse-holding-a-machine-gun/"
              >Facebook’s new AI stickers can generate Mickey Mouse holding a
              machine gun</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 17:50:22</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37768979"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37768884">
          <h3>
            <a class="item" href="https://www.openssh.com/txt/release-9.5"
              >OpenSSH 9.5</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 17:44:11</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37768884"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37768586">
          <h3>
            <a
              class="item"
              href="https://vsquare.org/tales-from-the-crypto-money-laundering-fraud-sanctions-estonia-lithuania-russia/"
              >How the Baltic states became the hub of crypto money laundering
              and fraud</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 17:26:35</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37768586"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37768551">
          <h3>
            <a
              class="item"
              href="https://www.evidentlyai.com/ml-observability-course"
              >Free Open-source ML observability course</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 17:24:58</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37768551"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37768145">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/stellar-sleep/jobs/Ubd4rCS-senior-software-engineer-flutter-django"
              >Stellar Sleep (YC S23) Is Hiring a Senior SWE in San Francisco</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 17:00:43</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37768018">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/meta-starts-rolling-out-generative-ai-tools-all-advertisers-2023-10-04/"
              >Meta starts rolling out generative AI tools for all
              advertisers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 16:53:15</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37768018"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37767335">
          <h3>
            <a
              class="item"
              href="https://brettscott.substack.com/p/tech-doesnt-make-our-lives-easier"
              >Tech doesn’t make our lives easier. It makes them faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 16:15:42</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37767335"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37766711">
          <h3>
            <a
              class="item"
              href="https://lithub.com/how-us-intelligence-agencies-hid-their-most-shameful-experiments/"
              >How US intelligence agencies hid their most shameful
              experiments</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 15:36:19</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37766711"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37765313">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/10/4/23902615/wii-u-nintendo-3ds-online-shut-down"
              >Nintendo’s Wii U and 3DS online services will shut down in
              April</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 14:01:21</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37765313"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37765158">
          <h3>
            <a class="item" href="https://lwn.net/Articles/946497/"
              >OpenSSH 9.5 released with keystroke timing obfuscation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 13:50:09</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37765158"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37764581">
          <h3>
            <a
              class="item"
              href="https://jakelazaroff.com/words/an-interactive-intro-to-crdts/"
              >An interactive intro to CRDTs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 13:12:45</span
              ><span class="points-container"
                >Points: <span class="points">471</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37764581"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37764489">
          <h3>
            <a
              class="item"
              href="https://benchmark.vectorview.ai/vectordbs.html"
              >Choosing vector database: a side-by-side comparison</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 13:04:52</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37764489"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37764382">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2310.02226"
              >Training language models with pause tokens</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 12:54:33</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37764382"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37764088">
          <h3>
            <a class="item" href="https://annas-blog.org/worldcat-scrape.html"
              >1.3B Worldcat scrape and data science mini-competition</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 12:22:58</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37764088"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37763822">
          <h3>
            <a class="item" href="https://github.com/shuttle-hq/shuttle"
              >Show HN: Shuttle – Build and ship backends without writing
              infrastructure files</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 11:51:17</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37763822"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37763424">
          <h3>
            <a
              class="item"
              href="https://www.thebignewsletter.com/p/the-ftc-sues-to-break-up-amazon-over"
              >The FTC sues to break up Amazon over an economy-wide “hidden
              tax”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 11:03:22</span
              ><span class="points-container"
                >Points: <span class="points">433</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37763424"
                  >Comments</a
                ><span class="descendants">: 444</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37763098">
          <h3>
            <a class="item" href="https://lfgslots.com/classicvideopoker/"
              >Show HN: Classic Video Poker</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 10:18:04</span
              ><span class="points-container"
                >Points: <span class="points">474</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37763098"
                  >Comments</a
                ><span class="descendants">: 180</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been lucky enough to make a good living out of Unity with
                my own consultancy over the years making data visualisation
                applications (Wind Energy) and innovation projects (Visualising
                accounting data for Wolters Kluwer etc.).
              </p>
              <p>
                Godot is pretty amazing in my opinion. Wrote this game over a
                few days and was productive in Godot basically instantly. I
                couldn't get up and running in Unreal despite trying a few
                times.
              </p>
              <p>
                It's my ambition to start a niche agency developing 80's style
                games of skill and chance for the corporate world.
              </p>
              <p>
                So... If anyone has any leads for making Space Invaders for Nike
                - please help! Happy to pay 5% on whatever work I get.
              </p>
            </div>
          </section>
        </section>
        <section id="37762968">
          <h3>
            <a
              class="item"
              href="https://www.nobelprize.org/prizes/chemistry/2023/press-release/"
              >Nobel Prize Chemistry 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 09:55:15</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37762968"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37761350">
          <h3>
            <a
              class="item"
              href="https://blog.apnic.net/2023/06/21/enabling-ipv6-support-for-ipv4-only-apps-on-linux/"
              >Enabling IPv6 support for IPv4-only apps on Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 05:59:47</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37761350"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37761273">
          <h3>
            <a
              class="item"
              href="https://blog.reyem.dev/post/extracting_hn_book_recommendations_with_chatgpt_api/"
              >Extracting Hacker News book recommendations with the ChatGPT
              API</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 05:48:00</span
              ><span class="points-container"
                >Points: <span class="points">344</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37761273"
                  >Comments</a
                ><span class="descendants">: 177</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37759002">
          <h3>
            <a
              class="item"
              href="https://www.leadedsolder.com/2023/10/03/creativision-clone-v1.html"
              >Dick Smith’s Wizzard-ry 8 (Bit)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-03 @ 23:36:15</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37759002"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37751270">
          <h3>
            <a class="item" href="https://dylibso.com/blog/why-extism/"
              >Extism Makes WebAssembly Easy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-03 @ 13:01:33</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37751270"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37749623">
          <h3>
            <a
              class="item"
              href="https://mostlynerdless.de/blog/2023/10/03/level-up-your-java-debugging-skills-with-on-demand-debugging/"
              >Level-up your Java Debugging Skills with on-demand Debugging</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-03 @ 09:27:16</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37749623"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37734941">
          <h3>
            <a
              class="item"
              href="https://ferdychristant.com/color-for-the-color-challenged-884c7aa04a56?gi=67a96925e6bd"
              >Color for the Color-Challenged</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-02 @ 07:26:01</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37734941"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37734593">
          <h3>
            <a
              class="item"
              href="https://szymonkaliski.com/writing/2023-10-02-building-a-diy-pen-plotter/"
              >Building a DIY Pen Plotter</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-02 @ 06:23:17</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37734593"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37734531">
          <h3>
            <a
              class="item"
              href="https://randomascii.wordpress.com/2023/10/01/32-mib-working-sets-on-a-64-gib-machine/#more-4032"
              >32 MiB Working Sets on a 64 GiB machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-02 @ 06:09:48</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37734531"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
