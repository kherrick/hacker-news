<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37242043">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/8/23/23843161/tornado-cash-indictment-conspiracy-north-korea-money-laundering"
              >Tornado Cash devs charged with laundering more than $1B</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 21:24:39</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37242043"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37241601">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/uk/2012/aug/21/life-on-board-nuclear-submarine"
              >Life on board a British nuclear submarine (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 20:35:33</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37241601"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37241487">
          <h3>
            <a
              class="item"
              href="https://nvidianews.nvidia.com/news/nvidia-announces-financial-results-for-second-quarter-fiscal-2024"
              >Nvidia Announces Financial Results for Second Quarter Fiscal
              2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 20:24:40</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37241487"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37240681">
          <h3>
            <a
              class="item"
              href="https://www.laphamsquarterly.org/roundtable/early-history-counting"
              >The Early History of Counting</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 19:02:55</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37240681"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37240363">
          <h3>
            <a class="item" href="https://github.com/Dataherald/dataherald"
              >Show HN: Dataherald AI – Natural Language to SQL Engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 18:38:56</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37240363"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/Dataherald/dataherald"
                >https://github.com/Dataherald/dataherald</a
              >). This engine allows you to set up an API from your structured
              database that can answer questions in plain English.
              <p>
                GPT-4 class LLMs have gotten remarkably good at writing SQL.
                However, out-of-the-box LLMs and existing frameworks would not
                work with our own structured data at a necessary quality level.
                For example, given the question “what was the average rent in
                Los Angeles in May 2023?” a reasonable human would either assume
                the question is about Los Angeles, CA or would confirm the state
                with the question asker in a follow up. However, an LLM
                translates this to:
              </p>
              <p>
                select price from rent_prices where city=”Los Angeles” AND
                month=”05” AND year=”2023”
              </p>
              <p>
                This pulls data for Los Angeles, CA and Los Angeles, TX without
                getting columns to differentiate between the two. You can read
                more about the challenges of enterprise-level text-to-SQL in
                this blog post I wrote on the topic:
                <a
                  href="https://medium.com/dataherald/why-enterprise-natural-language-to-sql-is-hard-8849414f41c"
                  >https://medium.com/dataherald/why-enterprise-natural-languag...</a
                >
              </p>
              <p>
                Dataherald comes with “batteries-included.” It has best-in-class
                implementations of core components, including, but not limited
                to: a state of the art NL-to-SQL agent, an LLM-based
                SQL-accuracy evaluator. The architecture is modular, allowing
                these components to be easily replaced. It’s easy to set up and
                use with major data warehouses.
              </p>
              <p>
                There is a “Context Store” where information (NL2SQL examples,
                schemas and table descriptions) is used for the LLM prompts to
                make the engine get better with usage. And we even made it fast!
              </p>
              <p>
                This version allows you to easily connect to PG, Databricks,
                BigQuery or Snowflake and set up an API for semantic
                interactions with your structured data. You can then add
                business and data context that are used for few-shot prompting
                by the engine.
              </p>
              <p>
                The NL-to-SQL agent in this open source release was developed by
                our own Mohammadreza Pourreza, whose DIN-SQL algorithm is
                currently top of the Spider (<a
                  href="https://yale-lily.github.io/spider"
                  >https://yale-lily.github.io/spider</a
                >) and Bird (<a href="https://bird-bench.github.io/"
                  >https://bird-bench.github.io/</a
                >) NL 2 SQL benchmarks. This agent has outperformed the
                Langchain SQLAgent anywhere from 12%-250%.5x (depending on the
                provided context) in our own internal benchmarking while being
                only ~15s slower on average.
              </p>
              <p>
                Needless to say, this is an early release and the codebase is
                under swift development. We would love for you to try it out and
                give us your feedback! And if you are interested in
                contributing, we’d love to hear from you!
              </p>
            </div>
          </section>
        </section>
        <section id="37240187">
          <h3>
            <a class="item" href="https://grahamhelton.com/blog/ssh-cheatsheet/"
              >An excruciatingly detailed guide to SSH (but only the things I
              find useful)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 18:27:15</span
              ><span class="points-container"
                >Points: <span class="points">268</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37240187"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37239979">
          <h3>
            <a
              class="item"
              href="https://opencoreventures.com/blog/2023-08-23-hashicorp-switching-bsl-shows-need-for-open-charter-companies/"
              >HashiCorp switching to BSL shows a need for open charter
              companies</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 18:12:25</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37239979"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37239747">
          <h3>
            <a
              class="item"
              href="https://interviewing.io/blog/sabotage-salary-negotiation-before-even-start"
              >Common mistakes in salary negotiation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 17:56:15</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37239747"
                  >Comments</a
                ><span class="descendants">: 185</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37238976">
          <h3>
            <a class="item" href="https://www.aptible.com/culture-hub/careers"
              >Aptible (YC S14) Is Hiring: Security Compliance Manager,
              Product-Led Sales Lead</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 17:02:18</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37238648">
          <h3>
            <a class="item" href="https://gentrace.ai"
              >Show HN: Gentrace – evaluation and observability for generative
              AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 16:38:13</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37238648"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                Gentrace is our new evaluation and observability tool for
                generative AI (open beta).
              </p>
              <p>
                Generative pipelines are hard to evaluate because outputs are
                subjective. Lots of developers end up just doing “gut checks” on
                a few inputs before shipping changes, or they build up a
                spreadsheet of test cases that they manually run through the
                pipeline. Some companies outsource filling out the spreadsheet.
                However, in any of these cases, you end up with a very slow and
                expensive process for evaluation.
              </p>
              <p>
                At one point, we did this too. Gentrace is the result of a
                pivot; it was an internal tool we used to automatically grade
                new PRs as developers shipped changes to generative pipelines
                that other people thought might be useful.
              </p>
              <p>
                Gentrace makes pre-production testing of generative pipelines
                continuous and nearly instantaneous. In Gentrace, you:
              </p>
              <p>
                - Import and/or construct suites of test data - Use a
                combination of AI and heuristic evaluators to grade for quality,
                hallucination, safety, etc - Use our interface to correct
                automated grades or add your own (yourself or a member of your
                team)
              </p>
              <p>
                Gentrace integrates at a code level for evaluation, meaning we
                test your generative AI pipeline the way you would test normal
                code. This allows you to test more than just prompt changes; for
                example, you can compare models (eg Claude 2 vs GPT-4 vs GPT 3.5
                vs Llama 2) or see the effects of additional chained steps
                (”Rewrite the previous answer in the following tone:”).
              </p>
              <p>
                Here’s a video overview that goes into a bit more detail:
                <a href="https://youtu.be/XxgDPSrTWIw"
                  >https://youtu.be/XxgDPSrTWIw</a
                >
              </p>
              <p>
                In production, Gentrace observes for speed, cost, and data flow.
                It also shows real user feedback as well. We do this by
                integrating via our SDK at a code level; Gentrace does not proxy
                requests.
              </p>
              <p>
                Soon, we’ll allow you to convert production data into test
                cases, allowing customer support to turn bad production
                generations into “failing tests” for AI teams to make pass.
              </p>
              <p>
                We process interim steps and multiple outputs as well, helping
                evaluate agent flows / chains where the “last output” isn’t
                always the only thing that matters.
              </p>
              <p>
                There’s been a lot of observability tools published recently. We
                differ from those by focusing more strongly on blending
                observability with strong evaluation and by using an SDK rather
                than a “man-in-the-middle” approach to capturing data (ie
                Gentrace can be down and your request to OpenAI will still
                succeed).
              </p>
              <p>
                Within the evaluation landscape, we differentiate by integrating
                with code (see above for benefits) for capturing generative
                outputs and by providing a customizable UI workflow for building
                evaluators. In Gentrace, you start with off-the-shelf automated
                evaluators and then customize them to your specific task. You
                also build and run new evaluators on old generative outputs.
                Finally, you easily override automated evaluators and/or blend
                automated evaluation with evaluation by humans on your team.
              </p>
              <p>
                We also focus on being suitable for business use. We are SOC 2
                Type 1 compliant (Type 2 coming shortly), have robust legal
                documentation around data processing, security, and privacy, and
                have already passed several vendor legal and security reviews at
                large technology companies.
              </p>
              <p>
                Our standard usage-based pricing is available on the website:
                <a href="https://gentrace.ai/pricing"
                  >https://gentrace.ai/pricing</a
                >
              </p>
              <p>
                If you are building features with generative AI, we would love
                to get your feedback. You can self-serve sign up (without a
                credit card) for a 14 day trial here:
                <a href="https://gentrace.ai/">https://gentrace.ai/</a>
              </p>
              <p>
                We’re available right here for feedback and questions. We’re
                also available at support@gentrace.ai.
              </p>
              <p>Best, Doug, Vivek, and Daniel</p>
            </div>
          </section>
        </section>
        <section id="37238306">
          <h3>
            <a
              class="item"
              href="https://milen.me/writings/exploring-windows-xp-on-macos-arm64/"
              >Exploring Windows XP on macOS ARM64</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 16:15:48</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37238306"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37238254">
          <h3>
            <a class="item" href="https://seaglass.cs.washington.edu/"
              >SeaGlass: City-Wide IMSI-Catcher Detection (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 16:12:27</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37238254"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37237583">
          <h3>
            <a class="item" href="https://generated.photos/human-generator/"
              >AI real-time human full-body photo generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 15:28:45</span
              ><span class="points-container"
                >Points: <span class="points">288</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37237583"
                  >Comments</a
                ><span class="descendants">: 188</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37236099">
          <h3>
            <a
              class="item"
              href="https://eli.thegreenplace.net/2023/my-favorite-prime-number-generator/"
              >My favorite prime number generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 14:05:14</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37236099"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37234887">
          <h3>
            <a
              class="item"
              href="https://github.com/Dicklesworthstone/fast_vector_similarity"
              >Show HN: Fast vector similarity using Rust and Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 12:34:37</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37234887"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
            <div class="text">
              <p>
                There are many other more involved measures that can detect more
                subtle relationships, but the problem is that some of them are
                quite slow to compute, especially if you're trying to do it in
                Python. For my favorite measure of statistical dependency,
                Hoeffding's D, that's true even if you use Numpy. Since I
                recently learned Rust and wanted to learn how to make Python
                packages using Rust, I put together this new library that I call
                Fast Vector Similarity.
              </p>
              <p>
                I was blown away by the performance of Rust and the quality of
                the tooling while making this. And even though it required a lot
                of fussing with Github Actions, I was also really impressed with
                just how easy it was to make a Python library using Rust that
                could be automatically compiled into wheels for every
                combination of platform (Linux, Windows, Mac) and Python Version
                (3.8 through 3.11) and uploaded to PyPi, all triggered by a
                commit to the repo and handled by Github's servers-- and all for
                free if you're working on a public repo!
              </p>
              <p>
                Anyway, this library can easily be installed to try out using
                `pip install fast_vector_similarity`, and you can see some
                simple demo Python code in the readme to show how to use it.
              </p>
              <p>
                Aside from exposing some very high performance implementations
                of some very nice similarity measures, I also included the
                ability to get robust estimates of these measures using the
                Bootstrap method. Basically, if you have two very high
                dimensional vectors, instead of using the entire vector to
                measure similarity, you can take the same random subset of
                indices from both vectors and compute the similarity of just
                those elements. Then you repeat the process hundreds or
                thousands of times and look at the robust average (i.e., throw
                away the results outside the 25th percentile to 75th percentile
                and average the remaining ones, to reduce the impact of
                outliers) and standard deviation of the results. Obviously this
                is very demanding of performance, but it's still reasonable if
                you're not trying to compute it for too many vectors.
              </p>
              <p>
                Everything is designed to fully saturate the performance of
                multi-core machines by extensive use of
                broadcasting/vectorization and the use of paralell processing
                via the Rayon library. I was really impressed with how easy and
                low-overhead it is to make highly parallelized code in Rust,
                especially compared to coming from Python, where you have to
                jump through a lot of hoops to use multiprocessing and there is
                a ton of overhead.
              </p>
              <p>
                Anyway, please let me know what you think. I'm looking to add
                more measures of similarity if I can find ones that can be
                efficiently computed (I already gave up on including HSIC
                because I couldn't get it to go fast enough, even using
                BLAS/LAPACK).
              </p>
            </div>
          </section>
        </section>
        <section id="37234111">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37234111"
              >Ask HN: Where to find open-source house plans?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 11:02:57</span
              ><span class="points-container"
                >Points: <span class="points">404</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37234111"
                  >Comments</a
                ><span class="descendants">: 199</span></span
              >
            </h4>
            <div class="text">
              Wanting to build a house, and looking for a DB of open source
              plans if such thing even exist.
            </div>
          </section>
        </section>
        <section id="37233977">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/society/2023/aug/23/the-key-to-depression-obesity-alcoholism-and-more-why-the-vagus-nerve-is-so-exciting-to-scientists"
              >Growing scientific interest in vagus nerve stimulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 10:37:38</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37233977"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37233936">
          <h3>
            <a
              class="item"
              href="https://www.isro.gov.in/LIVE_telecast_of_Soft_landing.html"
              >Chandrayaan-3 Soft-landing [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 10:30:23</span
              ><span class="points-container"
                >Points: <span class="points">1490</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37233936"
                  >Comments</a
                ><span class="descendants">: 427</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37233902">
          <h3>
            <a
              class="item"
              href="https://mough.xyz/312/psa-add-dir-auto-to-your-inputs-and-textareas"
              >Add dir=“auto” to your inputs and textareas</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 10:26:19</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37233902"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37232074">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/travel/the-sticky-history-of-baklava-180982771/"
              >The sticky history of baklava</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 05:05:05</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37232074"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37232066">
          <h3>
            <a
              class="item"
              href="https://astralcodexten.substack.com/p/critical-periods-for-language-much"
              >Critical periods for language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 05:02:32</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37232066"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37231347">
          <h3>
            <a class="item" href="https://github.com/h313/spet"
              >An interpreter for a programming language based on Spotify
              playlists</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 02:54:33</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37231347"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37231148">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-08-visualizing-mysterious-quantum-entanglement-photons.amp"
              >Image constructed using quantum entanglement of photons</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 02:20:07</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37231148"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37231025">
          <h3>
            <a class="item" href="https://pretextbook.org/"
              >PreTeXt: Write Once Read Anywhere Authoring and Publishing
              System</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 02:04:16</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37231025"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37229686">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2023/08/genetics-makes-some-people-more-likely-to-participate-in-genetic-studies/"
              >People in a genetic database have segments of DNA in common
              unexpectedly often</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 22:58:31</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37229686"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37228821">
          <h3>
            <a class="item" href="https://goodsnooze.gumroad.com/l/macwhisper"
              >MacWhisper: Transcribe audio files on your Mac</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 21:34:48</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37228821"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37227606">
          <h3>
            <a
              class="item"
              href="https://attainablefelicity.mattkirkland.com/20230822/Sketchbooks.html"
              >On keeping sketchbooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 19:42:08</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37227606"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37226879">
          <h3>
            <a
              class="item"
              href="https://carcinisation.com/2023/08/22/against-automaticity/"
              >Against Automaticity</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 18:39:30</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37226879"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37224936">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2023/08/28/is-beekeeping-wrong"
              >Natural beekeepers are the radical dissenters of apiculture</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 16:21:01</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37224936"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37220604">
          <h3>
            <a
              class="item"
              href="https://www.crackedthecode.co/a-complete-guide-to-building-a-hand-wired-keyboard/"
              >A complete guide to building a hand-wired keyboard (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 09:59:03</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37220604"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
