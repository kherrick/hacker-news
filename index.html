<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36494776">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/news/world-europe-66031341"
              >Pompeii archaeologists discover 'pizza' painting</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 16:07:05</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36494776"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36494639">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36494639"
              >Launch HN: Fuse (YC W19) – Unified API for financial data
              aggregators</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 15:56:41</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36494639"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.letsfuse.com/">https://www.letsfuse.com/</a
              >). We offer a single integration to multiple financial data
              aggregators and automatically select the most reliable one for
              each institution. Here’s a quick demo:
              <a href="https://youtu.be/w7sNHGav0Fg"
                >https://youtu.be/w7sNHGav0Fg</a
              >
              <p>
                If you're building a product that requires customers to link
                their financial accounts, you might integrate a financial data
                aggregator (such as Plaid, Truelayer, or Finicity) to connect
                with your user's bank account. You’ll probably then experience
                the following issues: customers unable to use your product
                because their financial institution is not supported (e.g.,
                credit unions, local or community banks); frequent
                disconnections; API errors; and high drop-offs during the bank
                linking flow.
              </p>
              <p>
                We spent 2.5 years developing YSplit, a fintech app providing
                joint spending cards for couples. Users linked their bank
                accounts for spend limits but faced issues with unsupported
                banks and frequent disconnections. We looked at other apps and
                saw that the ideal solution was to rely on multiple aggregators,
                but it wasn’t the right use of engineering resources for that
                startup. Upon pivoting from YSplit, though, we decided to go
                back to that problem and address it.
              </p>
              <p>
                We provide a UI component for React, React Native, Flutter, iOS
                &amp; Android native to facilitate bank account linkage within
                your app. When a user taps on an institution, we use a time
                series model to identify the most optimal aggregator to show
                based on historical success rates and disconnection as well as
                downtime. After linkage, we provide a Fuse access token for
                querying balance, transactions, and more via our unified API,
                offering a consistent model irrespective of the aggregator.
              </p>
              <p>
                We also provide other products to translate historical bank data
                into consumer/business credit risk to help you answer questions
                like: How much credit can I feel comfortable offering this user
                or company? Is a user likely to pay me on time? Can I offer
                instant ACH to this customer?
              </p>
              <p>
                By combining aggregators, you gain from their diverse connection
                methods, favoring APIs over screen scraping. Our customers have
                cut disconnections by 16%, increased coverage by 5k institutions
                in the US, and boosted conversions by 20% with Fuse. Moreover,
                we support aggregators in Africa, Europe, South America,
                Australia, and Asia, enabling global product expansion with a
                single API.
              </p>
              <p>
                We don't store personal info and only act as a pass-through. We
                are currently undergoing SOC 2 II audit and can provide
                engagement letters for anyone looking to go to production.
              </p>
              <p>
                We have a self-serve onboarding
                <a href="https://dashboard.letsfuse.com"
                  >https://dashboard.letsfuse.com</a
                >
                to get sandbox keys. Our docs are available here
                <a href="https://docs.letsfuse.com">https://docs.letsfuse.com</a
                >. We’d love for you to try it and give us feedback on
                improvements to the product and docs. If you have any feature
                requests or any aggregators you’d like us to support, let us
                know.
              </p>
            </div>
          </section>
        </section>
        <section id="36494308">
          <h3>
            <a
              class="item"
              href="https://www.blender.org/download/releases/3-6/"
              >Blender 3.6 LTS Released</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 15:30:47</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36494308"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36493821">
          <h3>
            <a
              class="item"
              href="https://ir.amd.com/news-events/press-releases/detail/1141/amd-introduces-worlds-largest-fpga-based-adaptive-soc"
              >AMD Introduces World’s Largest FPGA-Based Adaptive SoC for
              Emulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 14:57:20</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36493821"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36493715">
          <h3>
            <a class="item" href="https://neal.fun/password-game/"
              >The Password Game</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 14:51:22</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36493715"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36493422">
          <h3>
            <a class="item" href="https://thesloth.me/posts/5/"
              >I Built Linux from Scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 14:33:25</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36493422"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36492975">
          <h3>
            <a
              class="item"
              href="https://changelog.com/posts/still-no-silver-bullet"
              >There's still no silver bullet</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 14:06:24</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36492975"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36492972">
          <h3>
            <a
              class="item"
              href="https://omnipaxos.com/blog/building-distributed-rocksdb-with-omnipaxos-in-8-minutes/"
              >Build distributed RocksDB with OmniPaxos in 8 minutes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 14:06:15</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36492972"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36492384">
          <h3>
            <a class="item" href="http://book.mixu.net/distsys/single-page.html"
              >Distributed Systems for Fun and Profit</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 13:25:59</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36492384"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36492329">
          <h3>
            <a
              class="item"
              href="https://support.microsoft.com/en-us/topic/outlook-emails-open-next-to-web-links-in-microsoft-edge-b0e1a1c1-bd62-462c-9ed5-5938b9c649f0"
              >Outlook now ignores Windows' Default Browser and opens links in
              Edge by default</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 13:21:30</span
              ><span class="points-container"
                >Points: <span class="points">377</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36492329"
                  >Comments</a
                ><span class="descendants">: 252</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36492321">
          <h3>
            <a
              class="item"
              href="https://gizmodo.com/iphones-false-911-calls-bonnaroo-android-uk-999-1850576151"
              >False 911 Calls Increase During Festival as iOS Mistakes Dancing
              for Car Crashes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 13:20:53</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36492321"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36492291">
          <h3>
            <a
              class="item"
              href="https://quoteinvestigator.com/2011/07/22/keynes-change-mind/"
              >When the facts change, I change my mind. What do you do?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 13:18:42</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36492291"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36492033">
          <h3>
            <a
              class="item"
              href="https://www.gibney.org/a_syntax_for_self-tracking"
              >A Syntax for Self-Tracking (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 12:51:12</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36492033"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36492010">
          <h3>
            <a
              class="item"
              href="https://www.thedrive.com/news/fedex-accused-of-largest-odometer-rollback-fraud-in-history-with-used-vans"
              >FedEx Accused of Largest Odometer Rollback Fraud in History with
              Used Vans</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 12:49:17</span
              ><span class="points-container"
                >Points: <span class="points">280</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36492010"
                  >Comments</a
                ><span class="descendants">: 172</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36491975">
          <h3>
            <a class="item" href="https://github.com/billabear/billabear"
              >Show HN: BillaBear – Self-Hosted SaaS Subscription Management and
              Billing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 12:46:01</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36491975"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36491704">
          <h3>
            <a class="item" href="https://saurabhs.org/advanced-macos-commands"
              >macOS command-line tools you might not know about</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 12:08:38</span
              ><span class="points-container"
                >Points: <span class="points">780</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36491704"
                  >Comments</a
                ><span class="descendants">: 228</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36491647">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36491647"
              >Text Blaze (YC W21) is hiring a growth engineer to pioneer LLM
              driven strategies</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 12:01:08</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                We're excited to announce that Text Blaze (YC W21) is currently
                seeking a Growth Engineer who is passionate about leveraging
                large language models (LLMs) to transform the world of growth
                marketing. In this role, you'll have the unique opportunity to
                drive our user acquisition and activation journey end-to-end,
                exploring and experimenting with innovative ways to use LLMs to
                promote Text Blaze’s capabilities and grow existing users' usage
                of Text Blaze by generating personalized content tailored to
                each user.
              </p>
              <p>About Text Blaze</p>
              <p>
                At Text Blaze, we're dedicated to freeing users from tedious
                work by providing them with simple yet powerful solutions. We're
                fast-paced, data-driven, and constantly iterating based on the
                needs of our users.
              </p>
              <p>
                Joining us means being part of a profitable, fast-growing
                company that already has an excellent product-market fit and a
                deeply loyal user base of over 300,000 users. As a member of our
                founding team, you'll have a substantial impact on our product,
                strategy, and culture.
              </p>
              <p>
                We're fully remote. You'll be part of a team that embraces
                ownership and impact, all while working comfortably from your
                own home.
              </p>
              <p>Skills and Qualifications</p>
              <p>
                - A passion for talking to users and understanding their
                problems. - A knack for identifying business needs and
                developing technical solutions to address them. - An eye for
                design and comfort with designing your own UI's and solutions. -
                Experience or strong interest working with large language
                models, prompt engineering and post-processing - Proficiency in
                SQL, Python and JavaScript
              </p>
              <p>
                This is an opportunity to be at the forefront of the LLM-driven
                growth revolution. If you're eager to rethink growth and
                transform how we interact with potential users, we'd love to
                hear from you.
              </p>
              <p>To apply please email us at hiring@blaze.today</p>
              <p>
                Feel free to reach out to us directly if you have any questions!
              </p>
              <p>The Text Blaze Team</p>
            </div>
          </section>
        </section>
        <section id="36491514">
          <h3>
            <a class="item" href="https://neal.fun/deep-sea/"
              >The Deep Sea (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 11:39:56</span
              ><span class="points-container"
                >Points: <span class="points">275</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36491514"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36491338">
          <h3>
            <a class="item" href="https://www.tinc-vpn.org/"
              >Tinc, a GPLv2 mesh routing VPN</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 11:15:28</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36491338"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36489847">
          <h3>
            <a class="item" href="https://github.com/wolfi-dev"
              >Wolfi: A community Linux OS designed for the container and
              cloud-native era</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 07:19:37</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36489847"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36489288">
          <h3>
            <a class="item" href="https://rigtorp.se/ringbuffer/"
              >Optimizing a ring buffer for throughput (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 05:42:05</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36489288"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36489249">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/science-nature/medieval-manuscripts-reveal-hidden-history-whales-180982348/"
              >What Medieval Manuscripts Reveal About the Hidden History of
              Whales</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 05:33:34</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36489249"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36488735">
          <h3>
            <a class="item" href="https://x0axz.com/blog/autograd.html"
              >Show HN: An Interactive Guide to Teach Derivatives and
              Backpropagation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 04:01:10</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36488735"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36488356">
          <h3>
            <a
              class="item"
              href="https://akashrajpurohit.com/blog/build-your-own-docker-with-linux-namespaces-cgroups-and-chroot-handson-guide/"
              >Build your own Docker with Linux namespaces, cgroups, and
              chroot</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 02:50:55</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36488356"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36486109">
          <h3>
            <a
              class="item"
              href="https://cohost.org/mcc/post/325362-a-one-person-oral-hi"
              >A one-person oral history of Geocities HTML Chat (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 21:28:44</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36486109"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36480687">
          <h3>
            <a class="item" href="https://mofi.loud.red/"
              >Show HN: Mofi – Content-aware fill for audio to change a song to
              any duration</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:12:53</span
              ><span class="points-container"
                >Points: <span class="points">618</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36480687"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://mofi.loud.red/edit/8bd3fdf780f8c3927e41029f3b957f8a7ed96863"
                >https://mofi.loud.red/edit/8bd3fdf780f8c3927e41029f3b957f8a7...</a
              >
              <p>
                The cool thing is that after the song is analyzed on the server,
                the client can recompute and preview the results completely
                client-side through an implementation that uses Web Workers and
                WebAssembly. The audio previewing uses Tone.js. I am thinking of
                writing up some more details about the implementation in the
                future.
              </p>
              <p>
                I'm still working on a way to explain this easily, but I like
                the idea of carrying over the concept of content-aware fill from
                images to audio.
              </p>
              <p>Please let me know if you have any comments or questions!</p>
            </div>
          </section>
        </section>
        <section id="36480470">
          <h3>
            <a
              class="item"
              href="https://www.visuality.pl/posts/a-simple-guide-to-pessimistic-locking-in-rails"
              >A simple guide to pessimistic locking in Rails</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:00:55</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36480470"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36478772">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/06/20/magazine/hotel-bars.html"
              >The best place to drink is the emptiest bar in the city</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 12:21:23</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36478772"
                  >Comments</a
                ><span class="descendants">: 412</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36475846">
          <h3>
            <a
              class="item"
              href="https://blogs.loc.gov/loc/2023/06/bloomsday-the-librarys-one-of-a-kind-copy-of-ulysses/"
              >Bloomsday: The library’s one-of-a-kind copy of “Ulysses”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 04:51:43</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36475846"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36469147">
          <h3>
            <a
              class="item"
              href="https://matduggan.com/were-all-doing-metrics-wrong/"
              >Monitoring Is a Pain</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-25 @ 15:20:13</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36469147"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
