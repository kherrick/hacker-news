<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37633230">
          <h3>
            <a
              class="item"
              href="https://www.righto.com/2020/11/reverse-engineering-classic-mk4116-16.html"
              >Reverse-engineering the classic MK4116 16-kilobit DRAM chip</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 14:04:13</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37633230"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37633028">
          <h3>
            <a
              class="item"
              href="http://aurelm.com/portfolio/aurel-manea-photo-archive/"
              >Aurel Manea: I decided to make my photos available in full
              resolution for free</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 13:41:48</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37633028"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37632905">
          <h3>
            <a
              class="item"
              href="https://alicegg.tech//2020/01/03/solitaire.html"
              >Low Tech Crypto: Solitaire (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 13:24:43</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37632905"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37632729">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=Kdwyqctp908"
              >Osiris-Rex Asteroid Sample Return (Official 4K NASA Broadcast)
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 12:59:35</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37632729"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37632670">
          <h3>
            <a
              class="item"
              href="https://www.pbs.org/wgbh/nova/article/how-a-worm-gave-the-south-a-bad-name/"
              >How A Worm Gave the South a Bad Name</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 12:51:00</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37632670"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37632653">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/valley-fever-is-a-growing-fungal-threat-to-outdoor-workers/"
              >Valley Fever Is a Growing Fungal Threat to Outdoor Workers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 12:49:23</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37632653"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37632639">
          <h3>
            <a class="item" href="https://github.com/Vonng/pigsty"
              >Show HN: OSS PostgreSQL RDS with
              Supabase,PGML,Vector,HA,PITR,Monitor,&amp;amp;100+ Exts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 12:48:12</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37632639"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37632232">
          <h3>
            <a
              class="item"
              href="https://mastodon.gamedev.place/@AshleyGullen/111109299141510319"
              >What it takes to pass a file path to a Windows API in C++</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 11:45:32</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37632232"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37632174">
          <h3>
            <a
              class="item"
              href="https://nedbatchelder.com/blog/202309/the_myth_of_the_myth_of_learning_styles.html"
              >The myth of the myth of learning styles</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 11:35:20</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37632174"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37632122">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2023/sep/24/texas-death-row-robert-roberson-supreme-court-shaken-baby-syndrome"
              >Texas death row inmate at mercy of Supreme Court – and junk
              science</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 11:27:13</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37632122"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37632061">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/news/world-europe-66877718"
              >AI-generated naked child images shock Spanish town of
              Almendralejo</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 11:15:00</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37632061"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37631308">
          <h3>
            <a class="item" href="https://firmware.buspirate.com/"
              >Bus Pirate 5 Firmware</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 08:59:09</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37631308"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37631283">
          <h3>
            <a class="item" href="https://arxiv.org/abs/1705.06668"
              >Geometric Algebra to Geometric Computing Software Developers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 08:52:02</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37631283"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37631089">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=jkrNMKz9pWU"
              >A Hackers' Guide to Language Models [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 08:10:52</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37631089"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37631043">
          <h3>
            <a
              class="item"
              href="https://torrentfreak.com/the-worlds-oldest-active-torrent-turns-20-years-old-230924/"
              >The World’s Oldest Active Torrent Turns 20 Years Old</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 08:00:38</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37631043"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37630804">
          <h3>
            <a class="item" href="https://jenson.org/text/"
              >Text editing on mobile isn’t ok</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 07:03:51</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37630804"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37630628">
          <h3>
            <a
              class="item"
              href="https://blog.liblab.com/typescript-npm-packages-done-right/"
              >TypeScript NPM Packages Done Right</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 06:28:30</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37630628"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37630208">
          <h3>
            <a
              class="item"
              href="https://agraphicsguynotes.com/posts/fiber_in_cpp_understanding_the_basics/"
              >Fiber in C++: Understanding the Basics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 04:46:32</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37630208"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37629874">
          <h3>
            <a
              class="item"
              href="https://github.com/microsoft/windows-drivers-rs"
              >Platform that enables Windows driver development in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 03:19:30</span
              ><span class="points-container"
                >Points: <span class="points">246</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37629874"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37629719">
          <h3><a class="item" href="https://ash-hq.org/">Ash Framework</a></h3>
          <section>
            <h4>
              <span>2023-09-24 @ 02:48:19</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37629719"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37629119">
          <h3>
            <a class="item" href="https://karektar.newtrino.ink/"
              >Show HN: Karektar – Bitmap Font Designer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 00:55:38</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37629119"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <p>
                You can submit your own input string, and the app will generate
                the gallery of unique glyphs. Build your own designs using the
                various tools available, then export it to an OTF format when
                you're done.
              </p>
              <p>
                This is my first front-end project, and one I picked up to learn
                React. I'd love to hear any feedback, especially on usability
                and additional features you'd like to see. Cheers!
              </p>
            </div>
          </section>
        </section>
        <section id="37626888">
          <h3>
            <a
              class="item"
              href="https://kylehovey.github.io/blog/mutually-assured-recursion"
              >Mutually Assured Recursion</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-23 @ 19:58:52</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37626888"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37626731">
          <h3>
            <a class="item" href="https://bottlerocket.dev"
              >Bottlerocket – Minimal, immutable Linux OS with verified boot</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-23 @ 19:44:56</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37626731"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37622974">
          <h3>
            <a
              class="item"
              href="https://rugu.dev/en/blog/computer-science-reflections/"
              >Reflections on my journey into computer science</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-23 @ 13:17:45</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37622974"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37622753">
          <h3>
            <a
              class="item"
              href="https://blog.karthikkumar.org/usability-of-old-computers-f06a7f00f72e?gi=ce330599bc0f"
              >Usability of Old Computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-23 @ 12:44:27</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37622753"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37613769">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/30-years-of-the-web-down-under-how-australians-made-the-early-internet-their-own-212542"
              >How Australians made the early internet their own</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-22 @ 16:04:48</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37613769"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37612750">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/09/22/magazine/hank-asher-data.html"
              >A man who figured out how to turn Americans’ private information
              into a business</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-22 @ 14:46:34</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37612750"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37612154">
          <h3>
            <a
              class="item"
              href="https://www.womenshistory.org/education-resources/biographies/hedy-lamarr"
              >An Austrian-American actress/inventor pioneered basis for WiFi,
              GPS, &amp;amp; Bluetooth</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-22 @ 13:59:00</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37612154"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37612067">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-09-electrons-earth-moon.html"
              >Electrons from Earth may be forming water on the moon</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-22 @ 13:52:15</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37612067"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37611774">
          <h3>
            <a
              class="item"
              href="https://news.northwestern.edu/stories/2023/09/black-holes-eat-faster-than-previously-expected/"
              >Black holes eat faster than previously expected</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-22 @ 13:28:21</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37611774"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
