<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42087346">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2024/11/tsmc-will-stop-making-7-nm-chips-for-chinese-customers/"
              >TSMC will stop making 7 nm chips for Chinese customers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 15:02:23</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42087346"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42087182">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/Fedora-KDE-Desktop-Promoted"
              >Fedora KDE Desktop Spin Promoted to Same Tier as Gnome-Based
              Fedora Workstation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 14:40:27</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42087182"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42087147">
          <h3>
            <a
              class="item"
              href="https://ronakgothi.com/p/ease-of-maintenance-is-a-feature/"
              >Ease of maintenance is a feature</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 14:37:10</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42087147"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42087087">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/11/07/technology/elwood-edwards-aol-dead.html"
              >Elwood Edwards, Voice of AOL's 'You've Got Mail ' Alert, Dies at
              74</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 14:29:09</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42087087"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42086615">
          <h3>
            <a
              class="item"
              href="https://www.ifixit.com/Answers/View/875970/How+is+the+SSD+installed"
              >How is the SSD installed – M4 Mac Mini (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 13:15:39</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42086615"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42085665">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2410.21228"
              >LoRA vs. Full Fine-Tuning: An Illusion of Equivalence</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 09:58:24</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42085665"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42085273">
          <h3>
            <a
              class="item"
              href="https://www.media.mit.edu/projects/2d-an-exploration-of-drawing-as-programming-language-featuring-ideas-from-lambda-calculus/overview/"
              >Λ-2D: An Exploration of Drawing as Programming Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 08:30:54</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42085273"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42085036">
          <h3>
            <a class="item" href="https://asterogue.com"
              >Show HN: Asterogue, my sci-fi roguelike, is now playable on the
              web</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 07:43:02</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42085036"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42084977">
          <h3>
            <a
              class="item"
              href="https://mlumiste.com/technical/liveportrait-compression/"
              >Perceptually lossless (talking head) video compression at
              22kbit/s</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 07:30:31</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42084977"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42084779">
          <h3>
            <a class="item" href="https://dfir.ch/posts/slash-proc/"
              >The 'Invisibility Cloak' – Slash-Proc Magic</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 06:54:22</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42084779"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42084588">
          <h3>
            <a
              class="item"
              href="https://jhftss.github.io/A-New-Era-of-macOS-Sandbox-Escapes/"
              >Multiple new macOS sandbox escape vulnerabilities</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 06:10:14</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42084588"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42084344">
          <h3>
            <a class="item" href="https://github.com/sectordistrict/intentrace"
              >Intentrace: Strace for Everyone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 05:09:25</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42084344"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42084080">
          <h3>
            <a
              class="item"
              href="https://forums.tigsource.com/index.php?topic=40832.msg1363742#msg1363742"
              >Stabilizing the Obra Dinn 1-bit dithering process (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 04:15:59</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42084080"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42083547">
          <h3>
            <a class="item" href="https://xnacly.me/posts/2024/rust-pldev/"
              >Why I love Rust for tokenising and parsing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-08 @ 02:35:26</span
              ><span class="points-container"
                >Points: <span class="points">233</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42083547"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42081309">
          <h3>
            <a
              class="item"
              href="https://www.nybooks.com/articles/1978/06/15/the-charms-of-catastrophe/"
              >The Charms of Catastrophe (1978)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 21:33:42</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42081309"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42080377">
          <h3>
            <a class="item" href="https://draw.audio"
              >Show HN: Draw.Audio – A musical sketchpad using the Web Audio
              API</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 20:06:39</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42080377"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42079758">
          <h3>
            <a
              class="item"
              href="https://www.w3.org/blog/2024/sustainable-web-interest-group-is-formed/"
              >Sustainable Web Interest Group Is Formed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 19:05:11</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42079758"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42079460">
          <h3>
            <a
              class="item"
              href="https://blackberry.qnx.com/en/products/qnx-everywhere"
              >QNX is now free for anything non-commercial, plus there's an RPi
              image</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 18:35:22</span
              ><span class="points-container"
                >Points: <span class="points">629</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42079460"
                  >Comments</a
                ><span class="descendants">: 298</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm John from the Developer Relations team at QNX. I'm a loooong
                time lurker of this forum and excited to make my first post.
              </p>
              <p>
                I just wanted to let you know that we've kicked off a new
                program to start opening the doors to QNX like things used to
                be. Many of you probably used or tinkered with (the very open)
                QNX back in the day. You can now easily get a free
                non-commercial license to use the newest QNX. We've also just
                released some sample apps and a ready-to-go QNX 8.0 quick start
                target image for Raspberry Pi. So you can get QNX and the
                development tools for free now to learn, experiment, and build.
              </p>
              <p>
                It's been a long time in the making, so I'm really excited to
                get to post about this first phase of the QNX Everywhere
                initiative. My team and management have open ears, so please
                share feedback about what more we can do to open things up, be
                more transparent, and get you what you need to create an awesome
                embedded QNX project.
              </p>
              <p>Cheers!</p>
            </div>
          </section>
        </section>
        <section id="42078581">
          <h3>
            <a class="item" href="https://www.mushroomcoloratlas.com/"
              >Mushroom Color Atlas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 17:12:39</span
              ><span class="points-container"
                >Points: <span class="points">278</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42078581"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42078536">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42078536"
              >Launch HN: Codebuff (YC F24) – CLI tool that writes code for
              you</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 17:06:28</span
              ><span class="points-container"
                >Points: <span class="points">264</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42078536"
                  >Comments</a
                ><span class="descendants">: 218</span></span
              >
            </h4>
            <div class="text">
              <a href="https://codebuff.com">https://codebuff.com</a>). Codebuff
              is like Cursor Composer, but in your terminal: it modifies files
              based on your natural language requests. You can try it with `npm
              i -g codebuff` and start using it immediately for free. We have no
              login gate, and we give all accounts up to $20 worth of credits.
              <p>
                Codebuff is different because we simplified the input to one
                step: you type what you want done in your terminal and hit
                enter. Then Codebuff looks through your whole codebase and makes
                the edits it wants, to existing source files or new ones. It
                also can run your tests, the type checker, or install packages
                to fulfill your request.
              </p>
              <p>
                Demo video:
                <a href="https://www.youtube.com/watch?v=dQ0NOMsu0dA"
                  >https://www.youtube.com/watch?v=dQ0NOMsu0dA</a
                >
              </p>
              <p>
                It all started at a hackathon. I was trying out Sonnet 3.5 which
                had recently come out and seeing if I could use it to write
                code. The script I cobbled together that day pulled codebase
                context in one step and used it to rewrite files with changes in
                the second step. This two step process still exists today.
                Incidentally, my hackathon script worked rather poorly and my
                demo failed to produce any useful code.
              </p>
              <p>
                But that weekend I thought about the kind of errors it made, and
                realized that with more context on our codebase, it might have
                been able to get the change right. For example, it tried to
                create an endpoint on our server (at my previous startup), but
                it didn't know that you needed to edit 3 specific files to do
                this (yeah... our backend was not that clean). So I hand-wrote a
                guide to our codebase, like I was instructing a new hire. I put
                it in a markdown file and passed it into Sonnet 3.5's system
                prompt. And the crazy thing is that it started producing wayyy
                better code. So, I started getting excited. In fact, this code
                guide idea still exists in Codebuff today as knowledge.md files
                which are automatically read on every request.
              </p>
              <p>
                I didn't think of this project as a startup idea at first. I
                thought it was just a simple script anyone could write. But
                after another week, I could see there were more problems to
                solve and it should be a product.
              </p>
              <p>
                In the week between applying to YC and the interview, I could
                not get Codebuff to edit files consistently. I tried many
                prompting strategies to get it to replace strings in the
                original file, but nothing worked reliably. How could I face my
                interviewer if I could not get something basic like this to
                work? On the day before my interview, in a Hail Mary attempt, I
                fine-tuned GPT-4o to turn Claude's sketch of changes into a git
                patch, which would add and remove lines to make the edits. I
                only finished generating the training data late at night, and
                the fine-tuning job ran as I slept.
              </p>
              <p>
                And, holy hell, the next morning it worked! I pushed it to
                production just in time for my YC interview with Dalton. Soon
                after, Brandon joined and we were off to the races.
              </p>
              <p>
                So, how does Codebuff work exactly? You invoke it in your
                terminal, and it starts by running through the source files in
                that directory and subdirectories and parsing out all the
                function and class names (or equivalents in 11 languages). We
                use the tree-sitter library to do this. It builds out a codebase
                map that includes these symbols and the file tree.
              </p>
              <p>
                Then, it fires off a request to Claude Haiku 3.5 to cache this
                codebase context so user inputs can be responded to with lower
                latency. (Prompt caching is OP!). We have a stateless server
                that passes messages along to Anthropic or OpenAI. We use
                websockets to ferry data back and forth to clients. We didn't
                have authentication or even a database for the first three
                months. Codebuff was free to install and used our API keys for
                all requests. Luckily, no one exploited us for too much free
                Claude usage haha. Major thanks to Brandon for saving this
                situation by building out our database (Postgres + Drizzle),
                server (Bun, hosted on Render, auth (using the free Auth.js),
                website (NextJS also hosted on Render), billing (Stripe),
                logging (BetterStack), and dashboard (Retool). This is the best
                tech stack I’ve ever had.
              </p>
              <p>
                When the user sends an input message, we prompt Claude to pick
                files that would be relevant (step 1). After picking files, we
                load them into context and the agent responds. It invokes tools
                using xml tags that we parse. It literally writes out
                &lt;edit_file path="src/app.ts"&gt;…&lt;/edit_file&gt; to edit a
                particular file, and has other tags to run terminal commands, or
                to ask to read more files. This is all we really need, since
                Anthropic has already trained Claude with very similar tools
                reach state of the art on the SWE benchmark.
              </p>
              <p>
                Codebuff has limited free usage, but if you like it you can pay
                $99/mo to get more credits. We realize this is a lot more than
                competitors, but that’s because we do more expensive LLM calls
                with more context.
              </p>
              <p>
                We’re already seeing Codebuff used in surprising ways. One user
                racked up a $500 bill by building out two Flutter apps in
                parallel. He never even looked at the code it generated.
                Instead, he had long conversations with Codebuff to make
                progress and fix errors, until the apps were built to his
                satisfaction. Many users built real apps over a weekend for
                their teams and personal use.
              </p>
              <p>
                Of course, those aren't the typical use cases. Users also
                frequently use Codebuff to write unit tests. They would build a
                feature in parallel with unit tests and have Codebuff do loops
                to fix up the code until the tests pass. They would also ask it
                to do drudge work like set up Oauth flows or API scaffolding.
              </p>
              <p>
                What's really exciting with all of these examples is that we're
                seeing people's creativity becoming unbridled. They're spending
                more of their time thinking about architecture and design,
                instead of implementation details. It's so cool that we're just
                at the beginning, and the technology is only going to improve
                from here.
              </p>
              <p>
                If you would want to use Codebuff inside your own systems, we
                have an alpha SDK that exposes the same natural language
                interface for your apps to call and receive code edits! You can
                sign up here for early access:
                <a
                  href="https://codebuff.retool.com/form/c8b15919-52d0-4572-aca5-533317403dde"
                  >https://codebuff.retool.com/form/c8b15919-52d0-4572-aca5-533...</a
                >.
              </p>
              <p>
                Thank you for reading! We’re excited for you to try out Codebuff
                and let us know what you think!
              </p>
            </div>
          </section>
        </section>
        <section id="42077319">
          <h3>
            <a
              class="item"
              href="https://control.princeton.edu/machine-learning-for-rt-profile-control-in-tokamaks/"
              >AI for real-time fusion plasma behavior prediction and
              manipulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 15:12:10</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42077319"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42076884">
          <h3>
            <a
              class="item"
              href="https://32bits.substack.com/p/under-the-microscope-ecco-the-dolphin"
              >Using Ghidra and Python to reverse engineer Ecco the Dolphin</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 14:25:30</span
              ><span class="points-container"
                >Points: <span class="points">425</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42076884"
                  >Comments</a
                ><span class="descendants">: 118</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42073001">
          <h3>
            <a
              class="item"
              href="https://blog.dnmfarrell.com/post/incomplete-data-structures/"
              >I'm not mutable, I'm partially instantiated</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-07 @ 03:17:45</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42073001"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42050010">
          <h3>
            <a
              class="item"
              href="https://marcusolsson.dev/k-anonymity-and-l-diversity/"
              >Understanding privacy risk with k-anonymity and l-diversity</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-05 @ 09:30:53</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42050010"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42044781">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2024/11/4/24287857/netflix-removing-interactive-titles-games"
              >Netflix is removing nearly all of its interactive titles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-04 @ 18:47:14</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42044781"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42034305">
          <h3>
            <a
              class="item"
              href="https://www.juggle.org/claude-shannon-mathematician-engineer-genius-juggler/"
              >Claude Shannon: Mathematician, Engineer, Genius and Juggler?
              (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-03 @ 17:09:42</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42034305"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42024680">
          <h3>
            <a
              class="item"
              href="https://www.fracassi.net/iw2ntf/manuali/practical-radio-circuits-raymond-haigh.pdf"
              >Practical Radio Circuits (2003) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-02 @ 07:34:28</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42024680"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42021450">
          <h3>
            <a class="item" href="https://brainhack.vercel.app/fus"
              >Functional ultrasound through the skull</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-01 @ 20:52:45</span
              ><span class="points-container"
                >Points: <span class="points">225</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42021450"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42020345">
          <h3>
            <a class="item" href="https://arxiv.org/abs/1603.06549"
              >Consistently faster and smaller compressed bitmaps with Roaring
              (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-01 @ 18:57:07</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42020345"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42017730">
          <h3>
            <a
              class="item"
              href="https://link.springer.com/article/10.1007/s10887-024-09244-0#auth-David_de_la-Croix-Aff1"
              >The evolution of nepotism in academia, 1088-1800</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-01 @ 15:16:57</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42017730"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
