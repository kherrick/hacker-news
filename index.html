<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42573214">
          <h3>
            <a class="item" href="https://dragonnamegenerator.net"
              >Show HN: A tool to generate dragon names</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 10:10:19</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42573214"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42572770">
          <h3>
            <a
              class="item"
              href="https://drilian.com/posts/2025.01.01-emulating-the-fmadd-instruction-part-1-32-bit-floats/"
              >Emulating the FMAdd Instruction, Part 1: 32-bit Floats</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 08:37:43</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42572770"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42572662">
          <h3>
            <a class="item" href="https://github.com/alufers/mitmproxy2swagger"
              >MitmProxy2Swagger: Automagically reverse-engineer REST APIs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 08:08:15</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42572662"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42572602">
          <h3>
            <a
              class="item"
              href="https://raytracing.github.io/books/RayTracingInOneWeekend.html"
              >Ray Tracing in One Weekend</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 07:54:28</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42572602"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42572573">
          <h3>
            <a
              class="item"
              href="https://standardebooks.org/blog/public-domain-day-2025"
              >Standard Ebooks Public Domain Day 2025 in Literature</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 07:46:52</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42572573"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42572515">
          <h3>
            <a
              class="item"
              href="https://dropbox.github.io/dbx-career-framework/"
              >Dropbox Engineering Career Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 07:33:39</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42572515"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42572498">
          <h3>
            <a
              class="item"
              href="https://netflixtechblog.com/cloud-efficiency-at-netflix-f2a142955f83"
              >Cloud Efficiency at Netflix</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 07:28:53</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42572498"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42572057">
          <h3>
            <a class="item" href="https://github.com/zasper-io/zasper"
              >Zasper: A Modern and Efficient Alternative to JupyterLab, Built
              in Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 05:55:20</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42572057"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42571651">
          <h3>
            <a class="item" href="https://github.com/dunglas/mercure"
              >Mercure: A WebSocket alternative for server-sent events</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 04:33:12</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42571651"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42571541">
          <h3>
            <a
              class="item"
              href="https://minesweepergame.com/history/bogus-software.php"
              >Bogus Software</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 04:08:45</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42571541"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42571367">
          <h3>
            <a
              class="item"
              href="https://j3s.sh/thought/blogs-rot-wikis-wait.html"
              >Blogs rot. Wikis wait</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 03:32:57</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42571367"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42571272">
          <h3>
            <a class="item" href="https://github.com/Cinnamon/kotaemon"
              >Kotaemon: An open-source RAG-based tool for chatting with your
              documents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-02 @ 03:13:32</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42571272"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42570138">
          <h3>
            <a
              class="item"
              href="https://www.snopes.com/fact-check/trees-stars-milky-way/"
              >Are there more trees on Earth than stars in the Milky Way?
              (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-01 @ 23:20:53</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42570138"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42569913">
          <h3>
            <a
              class="item"
              href="https://austinhenley.com/blog/25yearsofai.html"
              >My 25-year adventure in AI and ML</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-01 @ 22:41:16</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42569913"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42569728">
          <h3>
            <a
              class="item"
              href="https://arosnews.github.io/aros-x86-summary-2024/"
              >(Amiga) AROS Research Operating System: Summary of 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-01 @ 22:08:21</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42569728"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42569109">
          <h3>
            <a class="item" href="https://blog.jacobvosmaer.nl/0036-beeper/"
              >My favourite computer ergonomics hack</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-01 @ 20:39:53</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42569109"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42568399">
          <h3>
            <a
              class="item"
              href="https://mathstodon.xyz/@tao/113721192051328193"
              >One of my papers got declined today</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-01 @ 19:12:57</span
              ><span class="points-container"
                >Points: <span class="points">648</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42568399"
                  >Comments</a
                ><span class="descendants">: 215</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42566192">
          <h3>
            <a
              class="item"
              href="https://www.cs.cmu.edu/~pavlo/blog/2025/01/2024-databases-retrospective.html"
              >Databases in 2024: A Year in Review</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-01 @ 14:27:39</span
              ><span class="points-container"
                >Points: <span class="points">530</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42566192"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42566112">
          <h3>
            <a class="item" href="https://doom-captcha.vercel.app/"
              >DOOM CAPTCHA</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-01 @ 14:12:15</span
              ><span class="points-container"
                >Points: <span class="points">921</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42566112"
                  >Comments</a
                ><span class="descendants">: 219</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42565821">
          <h3>
            <a class="item" href="https://apiparrot.com/"
              >Show HN: API Parrot – Automatically Reverse Engineer HTTP APIs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-01 @ 13:15:03</span
              ><span class="points-container"
                >Points: <span class="points">366</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42565821"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
            <div class="text">
              <p>
                Often, the issue is that it can be hard to resolve all the
                cookies, access tokens, and other elements required to
                successfully execute the requests. Manually trying to resolve
                these dependencies using developer tools is especially
                challenging with multiple requests where data is stored in
                JavaScript objects or HTML elements.
              </p>
              <p>
                To try to solve this issue, I built a tool called API Parrot
                that automatically identifies the data correlations between
                requests and builds a graphical representation of the flow to
                give users a better understanding. To streamline the process, I
                also included functionality to record requests, define your own
                inputs and outputs, and export the entire flow—or parts of it—as
                JavaScript code.
              </p>
              <p>
                The application is Electron-based and currently compiled for
                Windows and Linux. Please try it out and give feedback!
              </p>
              <p>
                Online Tutorial: A simple example of reverse engineering the
                USPS API is available at
                <a
                  href="https://docs.apiparrot.com/docs/category/tutorial---reverse-engineering-the-usps-api"
                  >https://docs.apiparrot.com/docs/category/tutorial---reverse-...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42557255">
          <h3>
            <a
              class="item"
              href="https://olano.dev/blog/software-design-is-knowledge-building/"
              >Software Design Is Knowledge Building</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-31 @ 07:59:54</span
              ><span class="points-container"
                >Points: <span class="points">297</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42557255"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42554161">
          <h3>
            <a class="item" href="https://www.rwkv.com/">RWKV Language Model</a>
          </h3>
          <section>
            <h4>
              <span>2024-12-30 @ 22:19:05</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42554161"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42549147">
          <h3>
            <a
              class="item"
              href="https://www.inf.ed.ac.uk/teaching/courses/pi/2016_2017/phil/tufte-powerpoint.pdf"
              >The Cognitive Style of PowerPoint [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-30 @ 13:38:02</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42549147"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42549123">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-04161-z"
              >How AI is unlocking ancient texts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-30 @ 13:35:46</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42549123"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42548540">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42548540"
              >Replicate Old Website</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-30 @ 11:59:27</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42548540"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                I was such a big fan that I created a QR code for my Teams
                profile picture, linking to that website. Can you imagine how
                disappointed I was when the website SSL certificate expired?
              </p>
              <p>
                I waited, hoping the certificate might get renewed at some
                point. But it never happened.
              </p>
              <p>
                Now to my point/question: How do you feel re-creating a website,
                with almost the same URL? I just want my QR code working, and I
                don't want my users to be irritated, when they scan the code and
                get an error in the browser.
              </p>
              <p>
                To be honest, I already did it, but now my conscience bugs me.
              </p>
            </div>
          </section>
        </section>
        <section id="42541508">
          <h3>
            <a
              class="item"
              href="https://blog.disintegrator.dev/posts/dev-virtual-machine/"
              >Developing inside a virtual machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-29 @ 17:51:01</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42541508"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42540397">
          <h3>
            <a class="item" href="https://adi.earth/apps/duplex/"
              >A web app to read Latin texts with inline translations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-29 @ 15:12:20</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42540397"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42540304">
          <h3>
            <a
              class="item"
              href="https://www.ccc.de/de/updates/2024/wir-wissen-wo-dein-auto-steht"
              >We know where your car is</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-29 @ 14:54:30</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42540304"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42540005">
          <h3>
            <a
              class="item"
              href="https://www.mattmillman.com/info/crimpconnectors/dupont-and-dupont-connectors/"
              >DuPont and "DuPont" connectors, and how to crimp them properly</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-29 @ 14:03:31</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42540005"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42539385">
          <h3>
            <a
              class="item"
              href="https://www.vice.com/en/article/ascii-pr0n-porn-predates-the-internet-but-its-still-everywhere-rule-34/"
              >ASCII porn predates the Internet but it's still everywhere
              (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-12-29 @ 11:49:21</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42539385"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
