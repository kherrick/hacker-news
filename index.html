<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43596570">
          <h3>
            <a
              class="item"
              href="https://ultrasciencelabs.com/lab-notes/why-we-are-still-using-88x31-buttons"
              >We are still using 88x31 buttons</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 20:26:36</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43596570"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43596546">
          <h3>
            <a
              class="item"
              href="https://www.jsg.utexas.edu/news/2025/04/north-america-is-dripping-from-below-geoscientists-discover/"
              >North America Is Dripping from Below, Geoscientists Discover</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 20:24:09</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43596546"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43596543">
          <h3>
            <a class="item" href="https://pypi.org/project/model-signing/"
              >Open Source Coalition Announces 'Model-Signing' to Strengthen ML
              Supply Chain</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 20:24:03</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43596543"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43595585">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/blog/llama-4-multimodal-intelligence/"
              >The Llama 4 herd</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 18:33:56</span
              ><span class="points-container"
                >Points: <span class="points">681</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43595585"
                  >Comments</a
                ><span class="descendants">: 325</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43595442">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43595442"
              >Show HN: iPhone 2005 weird "Blob Keyboard" simulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 18:20:49</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43595442"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
            <div class="text">
              <p>
                I teach tech design history, and one of the key stories I cover
                is the development of the original iPhone keyboard by Ken
                Kocienda. Reading about it in his book "Creative Selection" is
                great, but I wanted my students (and now you!) to actually
                <i>feel</i> this step in the process.
              </p>
              <p>
                So, I built a web simulator of the "Blob Keyboard", Kocienda's
                very first attempt at a touchscreen keyboard that actually
                works, from September 2005:
              </p>
              <p>
                Try the Blob Keyboard:
                <a
                  href="https://juliendorra.github.io/blob-keyboard-simulator/blob-keyboard-simulator.html"
                  >https://juliendorra.github.io/blob-keyboard-simulator/blob-k...</a
                >
              </p>
              <p>- Tap for the middle letter</p>
              <p>- Swipe left or right for the side letters</p>
              <p>
                More on the github repo:
                <a href="https://github.com/juliendorra/blob-keyboard-simulator"
                  >https://github.com/juliendorra/blob-keyboard-simulator</a
                >
              </p>
              <p>
                The Blob Keyboard prototype emerged during a UX crisis for
                iPhone team (their software keyboard just didn't work at all,
                fingers being too big, and the Newton failure loomed over them),
                highlighting how innovation is rarely a straight path. It was
                developed on a tethered touchscreen display codenamed "Wallaby".
              </p>
              <p>
                To make this simulator as authentic as possible, I referenced
                images from Kocienda's book and even got direct feedback and
                guidance from Ken Kocienda himself on Bluesky.
              </p>
              <p>What to expect (orâ€¦ what not to expect):</p>
              <p>
                This is a reconstruction of a very early prototype with
                limitations reflecting that specific moment. The goal was to
                test first if typing with accuracy was even possible, as all the
                rest was moot if it failed!
              </p>
              <p>
                It's NOT QWERTY: They were still hoping to get us out of QWERTY,
                but then familiarity won.
              </p>
              <p>No Backspace: You can't delete.</p>
              <p>
                No Cursor Movement: The text field is just a simple display.
              </p>
              <p>No Caps or Numbers: Only lowercase letters.</p>
              <p>
                No Smooth Animations: Keys just "pop" instantly when pressed.
                Kocienda noted that your eye fills in the gaps, giving a sense
                of movement.
              </p>
              <p>Best Experience:</p>
              <p>
                While it works with a mouse/trackpad on desktop, it's designed
                for touchscreens to better replicate the original Wallaby
                hardware interaction. Use it on your phone!
              </p>
              <p>
                This project aims to provide a tangible glimpse into a turning
                point moment in iPhone development and the iterative nature of
                design. It's like stepping back in time and trying out that
                early demo on Kocienda's desk.
              </p>
              <p>
                I would love to hear your reactions and thoughts on experiencing
                this piece of UI history! What other significant prototype do
                you wish you could experience?
              </p>
            </div>
          </section>
        </section>
        <section id="43595293">
          <h3>
            <a
              class="item"
              href="https://gizmodo.com/keeping-voyager-alive-nasas-project-scientist-faces-painful-choices-as-the-iconic-mission-nears-its-end-2000580634"
              >NASA's Project Scientist Faces Painful Choices as Voyager Mission
              Nears Its End</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 18:01:46</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43595293"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43595283">
          <h3>
            <a
              class="item"
              href="https://planetscale.com/blog/faster-interpreters-in-go-catching-up-with-cpp"
              >Faster interpreters in Go: Catching up with C++</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 17:59:55</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43595283"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43595269">
          <h3>
            <a class="item" href="https://simone.org/advertising/"
              >What If We Made Advertising Illegal?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 17:57:46</span
              ><span class="points-container"
                >Points: <span class="points">551</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43595269"
                  >Comments</a
                ><span class="descendants">: 441</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43595223">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/p/dynamic-register-allocation-on-amds"
              >Dynamic Register Allocation on AMD's RDNA 4 GPU Architecture</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 17:51:49</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43595223"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43594871">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/great-question/jobs/AtPa8pe-ai-engineer"
              >Great Question (YC W21) Is Hiring Applied AI Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 17:00:21</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43594554">
          <h3>
            <a
              class="item"
              href="https://googology.fandom.com/wiki/Loader%27s_number"
              >Loader's Number</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 16:18:12</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43594554"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43594396">
          <h3>
            <a
              class="item"
              href="https://www.devonlive.com/whats-on/whats-on-news/exeters-unassuming-co-op-worker-10039941"
              >Exeter's unassuming co-op worker leads double life as 'Lord of
              the Logos'</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 15:54:01</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43594396"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43593956">
          <h3>
            <a
              class="item"
              href="https://faridrener.com/2025/04/04/tracking-iss.html"
              >Tracking the international space station with an Arduino</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 14:54:17</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43593956"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43593789">
          <h3>
            <a class="item" href="https://www.whatsit.today/"
              >Show HN: I built a word game. My mom thinks it's great. What do
              you think?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 14:26:02</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43593789"
                  >Comments</a
                ><span class="descendants">: 140</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43593596">
          <h3>
            <a
              class="item"
              href="https://forums.swift.org/t/pitch-a-vision-for-webassembly-support-in-swift/79060"
              >A Vision for WebAssembly Support in Swift</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 13:58:18</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43593596"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43593547">
          <h3>
            <a
              class="item"
              href="https://byroot.github.io/performance/2025/03/21/database-protocols.html"
              >Database Protocols Are Underwhelming</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 13:51:57</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43593547"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43593088">
          <h3>
            <a
              class="item"
              href="https://okmij.org/ftp/tagless-final/Compiler/index.html"
              >Compilers: Incrementally and Extensibly (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 12:55:00</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43593088"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43592409">
          <h3>
            <a
              class="item"
              href="https://eshard.com/posts/emulating-ios-14-with-qemu"
              >Emulating an iPhone in QEMU</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 10:57:00</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43592409"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43591050">
          <h3>
            <a
              class="item"
              href="https://thoughts-and-things.ghost.io/recreating-daft-punks-something-about-us/"
              >Recreating Daft Punk's Something About Us</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 05:31:45</span
              ><span class="points-container"
                >Points: <span class="points">230</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43591050"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43590998">
          <h3>
            <a
              class="item"
              href="https://github.com/ses4255/Versatile-OCR-Program"
              >Show HN: OCR pipeline for ML training (tables, diagrams, math,
              multilingual)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 05:22:33</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43590998"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <p>
                Iâ€™ve been working on an OCR pipeline specifically optimized for
                machine learning dataset preparation. Itâ€™s designed to process
                complex academic materials â€” including math formulas, tables,
                figures, and multilingual text â€” and output clean, structured
                formats like JSON and Markdown.
              </p>
              <p>
                Some features: â€¢ Multi-stage OCR combining DocLayout-YOLO,
                Google Vision, MathPix, and Gemini Pro Vision â€¢ Extracts and
                understands diagrams, tables, LaTeX-style math, and multilingual
                text (Japanese/Korean/English) â€¢ Highly tuned for ML training
                pipelines, including dataset generation and preprocessing for
                RAG or fine-tuning tasks
              </p>
              <p>
                Sample outputs and real exam-based examples are included (EJU
                Biology, UTokyo Math, etc.) Would love to hear any feedback or
                ideas for improvement.
              </p>
              <p>
                GitHub:
                <a href="https://github.com/ses4255/Versatile-OCR-Program"
                  >https://github.com/ses4255/Versatile-OCR-Program</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43589989">
          <h3>
            <a
              class="item"
              href="https://www.openculture.com/2024/03/openvertebrate-presents-a-massive-database-of-13000-3d-scans-of-vertebrate-specimens.html"
              >OpenVertebrate Presents a Database of 13,000 3D Scans of
              Specimens</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-05 @ 02:15:35</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43589989"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43587380">
          <h3>
            <a
              class="item"
              href="https://joshcollinsworth.com/blog/the-blissful-zen-of-a-good-side-project"
              >The blissful Zen of a good side project</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-04 @ 20:37:35</span
              ><span class="points-container"
                >Points: <span class="points">489</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43587380"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43586654">
          <h3>
            <a
              class="item"
              href="https://dmitry.gr/?r=05.Projects&amp;proj=36.%208pinLinux"
              >An interactive-speed Linux computer made of only 3 8-pin chips</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-04 @ 19:22:37</span
              ><span class="points-container"
                >Points: <span class="points">401</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43586654"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43586073">
          <h3>
            <a
              class="item"
              href="https://www.cs.huji.ac.il/~shais/UnderstandingMachineLearning/copy.html"
              >Understanding Machine Learning: From Theory to Algorithms</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-04 @ 18:25:23</span
              ><span class="points-container"
                >Points: <span class="points">407</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43586073"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43562894">
          <h3>
            <a class="item" href="https://laemeur.sdf.org/words/D29.html"
              >Rich Text, Poor Text (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-02 @ 23:15:25</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43562894"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43556029">
          <h3>
            <a class="item" href="https://practicalbinaryanalysis.com"
              >Practical Binary Analysis</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-02 @ 12:45:04</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43556029"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43555996">
          <h3>
            <a class="item" href="https://coolify.io/"
              >Coolify: Open-source and self-hostable Heroku / Netlify / Vercel
              alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-02 @ 12:41:59</span
              ><span class="points-container"
                >Points: <span class="points">339</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43555996"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43554789">
          <h3>
            <a
              class="item"
              href="https://blog.piernov.org/identifying-defective-ram-ic/"
              >Identifying a defective RAM IC on laptops with soldered memory</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-02 @ 08:49:44</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43554789"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43549893">
          <h3>
            <a
              class="item"
              href="https://lithub.com/on-the-episode-that-changed-ira-glasss-this-american-life-forever/"
              >The Importance of Fact-Checking</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-01 @ 18:20:56</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43549893"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43549469">
          <h3>
            <a
              class="item"
              href="https://digital.tnconservationist.org/publication/?i=663361&amp;article_id=3697028&amp;view=articleBrowser"
              >Jumping Spiders</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-01 @ 17:33:13</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43549469"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
