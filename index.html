<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35966890">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35966890"
              >What's special about Erlang and Elixir?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 19:53:34</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35966890"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                "Elixir is a dynamic, functional language for building scalable
                and maintainable applications."
              </p>
              <p>
                OK, there are lots of languages that are either or both dynamic
                and functional, and they can all used to build scalable and
                maintainable transactions.
              </p>
              <p>
                "Elixir runs on the Erlang VM, known for creating low-latency,
                distributed, and fault-tolerant systems."
              </p>
              <p>
                Let's skip over "low-latency", because virtually all programming
                languages and VMs are "low-latency".
              </p>
              <p>
                "distributed" and "fault-tolerant" are what's most often touted
                as "special".
              </p>
              <p>
                I'm not sure what "distributed" means here? Any app in most
                languages can be coded to be "distributed" both on the scale of
                within a single machine and at the scale of deploying multiple
                small instances of it. (eg Kubernetes, running it on multiple
                EC2s etc etc)
              </p>
              <p>
                As for "fault tolerant": "The unavoidable truth about software
                in production is that things will go wrong. Even more when we
                take network, file systems, and other third-party resources into
                account. To react to failures, Elixir supervisors describe how
                to restart parts of your system when things go awry, going back
                to a known initial state that is guaranteed to work"
              </p>
              <p>
                Don't entirely understand this either. In a run of the mill
                corporate Java app, if you experience an exception eg calling
                another service, unless you're doing something very strange,
                your app will not stop running, it will just keep error logging
                those exceptions until the problem is resolved. (whether by the
                target service coming back online or you send out a fix for the
                call or whatever) Really the only time an app will outright
                crash and completely stop is if it experiences errors attempting
                to boot in the first place, and the correct solution there is to
                not allow instances that don't respond 200 OK on /health to take
                traffic. You certainly don't want to attempt restart the system
                as it won't do any good.
              </p>
              <p>
                So I'm left wondering, am I missing something or is there really
                not much to the claims about Erlang and Elixir? Don't get me
                wrong, this is not me criticizing Erlang or Elixir or the hype
                machine around them, every language has to have marketing and
                that's fine. It's also not me advocating corporate Java
                (shudder) - I'm just using it as an example of a common
                technology that also seems to tick all the same boxes as Erlang
                and Elixir as far as these claims go.
              </p>
            </div>
          </section>
        </section>
        <section id="35966537">
          <h3>
            <a class="item" href="http://raganwald.com/2020/05/03/fractran.html"
              >John Conway's FRACTRAN, a ridiculous, yet surprisingly deep
              language (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 19:27:18</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35966537"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35966318">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/safety-security/updating-our-inactive-account-policies/"
              >Updating our inactive account policies</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 19:13:32</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35966318"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35966210">
          <h3>
            <a
              class="item"
              href="https://social.treehouse.systems/@marcan/110366434912340959"
              >Why KDE Plasma was chosen as the default desktop environment for
              Asahi Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 19:05:34</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35966210"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35966001">
          <h3>
            <a
              class="item"
              href="https://www.euractiv.com/section/law-enforcement/news/majority-of-eu-countries-support-scanning-of-audio-communications/"
              >Majority of EU countries support scanning of audio
              communications</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 18:49:38</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35966001"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35965541">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-01610-z"
              >One man's rare Alzheimer’s mutation delayed its onset</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 18:09:04</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35965541"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35965496">
          <h3>
            <a
              class="item"
              href="https://blogs.nvidia.com/blog/2023/05/16/colossal-biosciences-de-extinct-woolly-mammoth-parabricks/"
              >Colossal Biosciences Aims to ‘De-Extinct’ the Woolly Mammoth</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 18:05:52</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35965496"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35965483">
          <h3>
            <a class="item" href="https://bun.sh/blog/bun-v0.6.0"
              >Bun v0.6.0 – Bun's new JavaScript bundler and minifier</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 18:04:20</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35965483"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35965186">
          <h3>
            <a
              class="item"
              href="https://electrek.co/2023/05/15/renewables-us-utility-scale-generating-capacity-q1-2023/"
              >Renewables supplied 65% of new US utility-scale generating
              capacity in Q1 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 17:39:53</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35965186"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35964640">
          <h3>
            <a class="item" href="https://www.neucards.com"
              >Show HN: Neucards – Privacy based digital contact card</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 17:00:55</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35964640"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                There are two major problems that neucards addresses. First,
                most people end up with contact lists that are hopelessly out of
                date. Over time, people move, change jobs, or add social
                profiles and unless they tell you, chances are you could lose
                touch. Second, your contact information ends up in the wrong
                hands. There has been a huge increase in robocalls, unsolicited
                emails, data breaches, and online scams that is driven by
                accessing a person's contact info. Even worse, with AI now being
                able to imitate a person's voice or other mannerisms, knowledge
                about the connections you have with others can be used against
                you.
              </p>
              <p>
                Neucards automatically updates your contact information for
                anyone who has your digital contact card. You control your
                contact information and who has access. This is possible because
                of end-to-end encryption. Neucards brings the same level of
                protection for your contact information as Signal or WhatsApp
                does for your chats. Privacy is built it.
              </p>
              <p>
                But, even with these protections, you can share your contact
                info with anyone. As an example, here is a link to my Social
                card:
              </p>
              <p>
                <a
                  href="https://www.neucards.com/of/braddominy?id=M6TC5PLngD&amp;k=4R98iwnoRi"
                  >https://www.neucards.com/of/braddominy?id=M6TC5PLngD&amp;k=4R98i...</a
                >
              </p>
              <p>
                I'm excited about how much neucards has grown and what I have
                planned for the future to do even more to protect people's
                privacy. If you have any comments, please let me know.
              </p>
              <p>
                Brad
                <a href="https://www.neucards.com">https://www.neucards.com</a>
              </p>
            </div>
          </section>
        </section>
        <section id="35964335">
          <h3>
            <a
              class="item"
              href="https://lgug2z.com/articles/the-bookmarking-data-model-is-wrong-for-highlighting/"
              >The Bookmarking Data Model Is Wrong for Highlighting</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 16:40:54</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35964335"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35963936">
          <h3>
            <a class="item" href="https://github.com/microsoft/guidance"
              >A guidance language for controlling LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 16:14:11</span
              ><span class="points-container"
                >Points: <span class="points">241</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35963936"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35961817">
          <h3>
            <a
              class="item"
              href="https://www.thenewatlantis.com/publications/rational-magic"
              >Rational Magic</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 13:44:55</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35961817"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35961700">
          <h3>
            <a
              class="item"
              href="https://www.erlang.org/blog/otp-26-highlights/"
              >Erlang/OTP 26 Highlights</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 13:36:44</span
              ><span class="points-container"
                >Points: <span class="points">214</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35961700"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35961590">
          <h3>
            <a
              class="item"
              href="https://github.com/hendricius/the-sourdough-framework"
              >The Sourdough Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 13:27:56</span
              ><span class="points-container"
                >Points: <span class="points">328</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35961590"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35961309">
          <h3>
            <a
              class="item"
              href="https://www.alcademics.com/index-of-ice-experiments-on-alcademics.html"
              >Experiments in Making Cocktail Ice</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 13:04:34</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35961309"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35961032">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2023/05/re-victimization-from-police-auctioned-cell-phones/"
              >Re-Victimization from Police-Auctioned Cell Phones</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 12:39:47</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35961032"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35960663">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2023/05/apple-previews-live-speech-personal-voice-and-more-new-accessibility-features/"
              >Apple previews Live Speech, Personal Voice, and more new
              accessibility features</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 12:07:00</span
              ><span class="points-container"
                >Points: <span class="points">512</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35960663"
                  >Comments</a
                ><span class="descendants">: 252</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35960662">
          <h3>
            <a class="item" href="https://death.andgravity.com/output"
              >Why you should still read the docs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 12:06:56</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35960662"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35960606">
          <h3>
            <a class="item" href="https://jobs.lever.co/buildzoom"
              >BuildZoom (better way to build custom homes) Is hiring a Growth
              Associate</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 12:00:46</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35960125">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/openai-chief-goes-before-us-congress-propose-licenses-building-ai-2023-05-16/"
              >Sam Altman goes before US Congress to propose licenses for
              building AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 11:06:54</span
              ><span class="points-container"
                >Points: <span class="points">464</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35960125"
                  >Comments</a
                ><span class="descendants">: 658</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35960018">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/widely-used-chemical-strongly-linked-parkinson-s-disease"
              >Widely used chemical strongly linked to Parkinson’s disease</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 10:52:47</span
              ><span class="points-container"
                >Points: <span class="points">616</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35960018"
                  >Comments</a
                ><span class="descendants">: 300</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35959991">
          <h3>
            <a
              class="item"
              href="https://fortran-lang.discourse.group/t/optimization-without-using-derivatives-the-prima-package-its-fortran-implementation-and-its-inclusion-in-scipy/5798"
              >Optimization Without Derivatives: Prima Fortran Version and
              Inclusion in SciPy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-16 @ 10:49:29</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35959991"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35950921">
          <h3>
            <a
              class="item"
              href="https://heatmap.news/technology/so-how-do-you-actually-refill-an-aquifer"
              >So, how do you refill an aquifer?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-15 @ 16:37:24</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35950921"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35949995">
          <h3>
            <a
              class="item"
              href="https://venafi.com/blog/how-does-a-tls-handshake-work/"
              >How Does a TLS Handshake Work?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-15 @ 15:38:26</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35949995"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35946279">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/united-states/2023/05/14/pinball-is-booming-in-america-thanks-to-nostalgia-and-canny-marketing"
              >Pinball is booming in America</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-15 @ 10:59:42</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35946279"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35946181">
          <h3>
            <a
              class="item"
              href="https://orbitalhq.com/blog/2023-05-12-why-we-created-taxi"
              >Why we created Taxi, and why we felt the need for another schema
              language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-15 @ 10:48:57</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35946181"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35945006">
          <h3>
            <a class="item" href="https://www.playhextraction.com/how-to-play"
              >How to Play Hextraction</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-15 @ 07:54:47</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35945006"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35941369">
          <h3>
            <a
              class="item"
              href="https://blog.plover.com/notes/game-mechanics.html"
              >Notes on rarely-seen game mechanics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-14 @ 21:09:50</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35941369"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35936828">
          <h3>
            <a
              class="item"
              href="https://austinkleon.com/2023/05/07/artists-must-be-allowed-to-make-bad-work/"
              >Artists must be allowed to make bad work</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-14 @ 10:03:59</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35936828"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
