<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37255079">
          <h3>
            <a
              class="item"
              href="https://blog.torproject.org/introducing-proof-of-work-defense-for-onion-services/"
              >Proof-of-Work Defense for Onion Services</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 21:57:25</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37255079"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37255022">
          <h3>
            <a class="item" href="https://sqlite.org/releaselog/3_43_0.html"
              >SQLite 3.43.0 Released</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 21:51:28</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37255022"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37254823">
          <h3>
            <a class="item" href="https://runme.dev/"
              >Runme – Interactive Runbooks Built with Markdown</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 21:32:46</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37254823"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37254772">
          <h3>
            <a
              class="item"
              href="https://rubenerd.com/the-longest-word-you-can-type-on-the-first-row/"
              >The longest word you can type on the first row of a QWERTY
              keyboard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 21:29:01</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37254772"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37254510">
          <h3>
            <a class="item" href="https://github.com/bsilverthorn/maccarone"
              >Maccarone: AI-managed code blocks in Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 21:02:21</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37254510"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37254198">
          <h3>
            <a
              class="item"
              href="https://honeycodecommunity.aws/c/announcements/7"
              >Amazon Honeycode Shutting Down</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 20:34:32</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37254198"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37253035">
          <h3>
            <a
              class="item"
              href="https://www.usenix.org/publications/loginonline/freebsd-firecracker"
              >FreeBSD on Firecracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 18:52:46</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37253035"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37252472">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/a-new-thermodynamics-theory-of-the-origin-of-life-20140122/"
              >A New Physics Theory of Life (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 18:07:16</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37252472"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37252384">
          <h3>
            <a
              class="item"
              href="https://bigthink.com/starts-with-a-bang/5th-fundamental-force/"
              >Is there a fifth fundamental force of nature?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 17:59:31</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37252384"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37252334">
          <h3>
            <a
              class="item"
              href="https://thenewstack.io/vim-creator-bram-moolenaars-forgotten-programming-language-zimbu/"
              >Bram Moolenaar's programming language, Zimbu</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 17:56:10</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37252334"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37252231">
          <h3>
            <a
              class="item"
              href="https://www.shimmer.care/blog/web-launch-adhd-coaching"
              >Show HN: Shimmer – ADHD coaching for adults, now on web</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 17:49:04</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37252231"
                  >Comments</a
                ><span class="descendants">: 137</span></span
              >
            </h4>
            <div class="text">
              <a href="https://shimmer.care">https://shimmer.care</a>),
              one-to-one ADHD Coaching for adults. Our HN launch was here:
              <a href="https://news.ycombinator.com/item?id=33468611"
                >https://news.ycombinator.com/item?id=33468611</a
              >.
              <p>
                A quick recap before I dive into our new launch: Shimmer is an
                ADHD coaching service for adults. We took apart the
                traditionally expensive, inaccessible ADHD coaching offering
                ($300-600+/session) and redesigned it from first principles. You
                get matched with one of our expert ADHD coaches, meet weekly
                over video, and get supported throughout the week via text and
                with learning tools. This solution is special to me personally
                (and our community) because it doesn’t just give you “knowledge”
                or offer another “tool”—our coaches help you set realistic
                goals, take personalized steps towards it, and keep you
                accountable.
              </p>
              <p>
                Today we’re excited to launch our most-request feature: Web.
              </p>
              <p>
                Over the past 9 months, we learned (and iterated) a lot with our
                members and coaches. A few key challenges pointed to the need
                for a web version: (1) ADHD “object permanence” challenges (e.g.
                out of sight out of mind), we needed to be multi-platform so
                when you finish a task or goal or encounter a challenge,
                regardless of if you’re near your laptop or phone, you can check
                it off &amp; ping your coach right away, (2) members used
                reflection modules (e.g. after each task, you’re prompted to
                reflect on what worked and didn’t work, and it informs your
                coach) more thoroughly than we originally anticipated, and web
                allows for deeper reflection and typing, (3) overarching
                coaching goals were often forgotten during the day-to-day, and
                the web makes it easier to use visual cues to keep goals top of
                mind for motivation, (4) many of our members struggle with phone
                addiction and driving members to the mobile app ended them up in
                Tiktok/IG, whereas the web app offers a focused environment to
                get in their “coaching zone”.
              </p>
              <p>
                Our new web app was designed alongside over 1,200 members, 22
                coaches, countless hours of testing and iterating. We’re excited
                (but nervous!) to unveil this new version. If you have ADHD (or
                think you do), we’d love for you to check out our platform and
                give us critical feedback (or positive reinforcement!). It’s a
                super streamlined and ADHD-friendly signup process and in honor
                of our web launch and back to school/work, the first month is
                30% off.
              </p>
              <p>
                Our pricing: $115/mo. for Essentials plan (15-min weekly
                sessions), $230/mo. for Standard plan (30-min weekly sessions),
                $345/mo. for Immersive plan (45-min weekly sessions); all plans
                additional 30% off first month, HSA/FSA-eligible.
              </p>
              <p>
                We know these prices are expensive for many people with ADHD and
                we’re committed to bringing costs down over time. It’s more
                affordable than what many people are paying for coaches, but the
                fact that we’re relying on humans, and not going the “we can
                automate all this with AI” route, puts a floor on how low the
                costs can drop. That said, here are some actions we’re taking to
                drive down costs for those who need it: (1) we offer needs-based
                scholarships and aim to have 5% of members on them at any time,
                (2) we often run fully sponsored scholarships with our
                partners—over 40 full ride scholarships and 100 group coaching
                spots have been disbursed alongside Asian Mental Health Project,
                government of Canada, and more, and (3) we have aligned our
                coaching model alongside Health &amp; Wellness Coaching, which
                is expected to be reimbursed in 2024. If you have ideas or
                expertise here, please reach out to me directly at
                chris@shimmer.care.
              </p>
              <p>
                On behalf of our small but mighty &amp; passionate Shimmer team,
                I’m excited for the Hacker News community to share your
                thoughts, feedback, and ideas. If you feel comfortable, I’d also
                love to hear your personal ADHD story and what has worked /
                hasn’t worked for you.
              </p>
              <p>Co-founders Christal &amp; Vikram</p>
            </div>
          </section>
        </section>
        <section id="37252025">
          <h3>
            <a
              class="item"
              href="https://www.ucsf.edu/news/2023/08/425986/how-artificial-intelligence-gave-paralyzed-woman-her-voice-back"
              >Artificial intelligence gave a paralyzed woman her voice back</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 17:36:22</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37252025"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37251964">
          <h3>
            <a class="item" href="https://www.barbara.graphics/"
              >Barbara: Live coding languages for quilters</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 17:32:59</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37251964"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37251411">
          <h3>
            <a class="item" href="https://landrop.app/"
              >LANDrop – Drop any files to any devices on your LAN</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 16:58:57</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37251411"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37250834">
          <h3>
            <a
              class="item"
              href="https://news.ycombinator.com/newsguidelines.html"
              >Hacker News Guidelines</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 16:25:48</span
              ><span class="points-container"
                >Points: <span class="points">278</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37250834"
                  >Comments</a
                ><span class="descendants">: 268</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37249623">
          <h3>
            <a class="item" href="https://www.errno.fr/BypassingBitlocker.html"
              >Bypassing Bitlocker using a cheap logic analyzer on a Lenovo
              laptop</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 15:02:56</span
              ><span class="points-container"
                >Points: <span class="points">285</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37249623"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37248882">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20230823-the-curious-ways-your-skin-shapes-your-health"
              >Skin health can be used to predict a number of seemingly
              unconnected factors</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 14:01:02</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37248882"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37248694">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2308.09687"
              >Graph of Thoughts: Solving Elaborate Problems with Large Language
              Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 13:44:48</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37248694"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37248494">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/blog/code-llama-large-language-model-coding/"
              >Code Llama, a state-of-the-art large language model for coding</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 13:26:45</span
              ><span class="points-container"
                >Points: <span class="points">426</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37248494"
                  >Comments</a
                ><span class="descendants">: 368</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37248411">
          <h3>
            <a
              class="item"
              href="https://faculty.weber.edu/apainter1/Readings/Hacking%20a%20Crime.pdf"
              >Is Computer Hacking a Crime? (1989) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 13:19:30</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37248411"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37248020">
          <h3>
            <a
              class="item"
              href="https://photonlines.substack.com/p/grokking-hash-array-mapped-tries"
              >Grokking Hash Array Mapped Tries (HAMTs)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 12:30:28</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37248020"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37247879">
          <h3>
            <a class="item" href="http://www.technoblogy.com/show?4FFY"
              >Logic Lab</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 12:10:41</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37247879"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37247767">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37247767"
              >Show HN: Open-source obsidian.md sync server</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 11:55:04</span
              ><span class="points-container"
                >Points: <span class="points">199</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37247767"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/acheong08/obsidian-sync"
                >https://github.com/acheong08/obsidian-sync</a
              >
              <p>Hello HN,</p>
              <p>
                I'm a recent high school graduate and can't afford $8 per month
                for the official sync service, so I tried my hand at replicating
                the server.
              </p>
              <p>
                It's still missing a few features, such as file recovery and
                history, but the basic sync is working.
              </p>
              <p>
                To the creators of Obsidian.md: I'm probably violating the TOS,
                and I'm sorry. I'll take down the repository if asked. It's not
                ready for production and is highly inefficient; Not competition,
                so I hope you'll be lenient.
              </p>
            </div>
          </section>
        </section>
        <section id="37247405">
          <h3>
            <a class="item" href="https://www.nippon.com/en/features/h00124/"
              >Japan’s 72 Microseasons (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 11:01:07</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37247405"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37247394">
          <h3>
            <a class="item" href="https://jacobin.org/"
              >Jacobin: A more than minimal JVM written in Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 10:59:20</span
              ><span class="points-container"
                >Points: <span class="points">257</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37247394"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37246932">
          <h3>
            <a
              class="item"
              href="https://journal.infinitenegativeutility.com/leaving-haskell-behind"
              >Leaving Haskell behind</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 09:51:17</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37246932"
                  >Comments</a
                ><span class="descendants">: 264</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37245530">
          <h3>
            <a
              class="item"
              href="https://fairpixelsco.medium.com/icons-a-dilemma-of-design-and-meaning-1bf40eba1079"
              >The Dilemma of Icons</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 06:04:03</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37245530"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37245383">
          <h3>
            <a
              class="item"
              href="https://iquilezles.org/articles/sdfrepetition/"
              >Domain Repetition</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 05:35:46</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37245383"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37245109">
          <h3>
            <a class="item" href="https://shachaf.net/w/consensus"
              >Distributed Consensus</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 04:46:23</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37245109"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37235242">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-08-spanish-astronomer-galaxy.html"
              >Spanish astronomer discovers new active galaxy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-23 @ 13:06:31</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37235242"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
