<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35647124">
          <h3>
            <a
              class="item"
              href="https://github.com/orsifrancesco/sniffagrammers"
              >Saving Instagram images automatically every hour with Node.js or
              PHP</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 22:07:19</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35647124"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35646436">
          <h3>
            <a
              class="item"
              href="https://blog.pypi.org/posts/2023-04-20-introducing-trusted-publishers/"
              >PyPI Introduces “Trusted Publishers”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 21:14:42</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35646436"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35646315">
          <h3>
            <a class="item" href="https://hllmn.net/blog/2023-04-20_rsqrt/"
              >Revisiting the Fast Inverse Square Root – Is It Still Useful?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 21:05:17</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35646315"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35646253">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35646253"
              >Retool (YC W17) is hiring hackers to combine visual programming
              with AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 21:00:30</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                We’re Retool (<a href="https://retool.com">https://retool.com</a
                >), a visual programming environment for building internal
                tools. Here’s a 3 minute demo video:
                <a
                  href="https://d3399nw8s4ngfo.cloudfront.net/videos/intro-to-retool.mp4"
                  >https://d3399nw8s4ngfo.cloudfront.net/videos/intro-to-retool...</a
                >.
              </p>
              <p>
                You can think of Retool as something like Visual Basic, but in
                the cloud. The idea is that there are lots of internal
                applications that businesses need, and today, build from scratch
                (probably via React). But while React is great for many things
                (our landing page is built in React, our product is built in
                React, etc.), it’s possible that it might be overkill for
                building a simple form that POSTs data back to your API. (Who
                _wants_ to worry about debouncing the submit button, handling
                errors from the backend, and authenticating and authorizing the
                users?)
              </p>
              <p>
                We launched on HN around five years ago (<a
                  href="https://news.ycombinator.com/item?id=17725966"
                  >https://news.ycombinator.com/item?id=17725966</a
                >). Since then, we’ve launched three new products – a native
                mobile product (<a href="https://retool.com/products/mobile"
                  >https://retool.com/products/mobile</a
                >), an automation product for developers (<a
                  href="https://retool.com/products/workflows/"
                  >https://retool.com/products/workflows/</a
                >), and a database product (<a
                  href="https://retool.com/products/database/"
                  >https://retool.com/products/database/</a
                >). We’ve hired and grown the team to over 350, and are proud to
                have businesses like Doordash, NBC Universal, Mercedes Benz, and
                the NFL using Retool.
              </p>
              <p>
                The network at Retool is also fairly strong — our lead investors
                in the Series B and C were Sequoia, along with Elad Gil, Nat
                Friedman, as well as John and Patrick Collison. Other investors
                include the founders of Github, Gusto, Segment, PagerDuty,
                Plaid, etc.
              </p>
              <p>
                This year, while other companies are downsizing, we’re doubling
                down. (Literally.) We’re attempting to double our engineering,
                product, and design orgs this year. We think the opportunity to
                invent the future of programming is enormous, and we’re looking
                for more hackers to join our team.
              </p>
              <p>
                We think that AI is going to change the way people build
                software. We think that there is tremendous potential in
                building interfaces that help humans and AI collaborate together
                to build software. We want to build a world where humans can
                quickly assemble full applications by just providing high level
                directions to AI.
              </p>
              <p>
                We believe we’re set up especially well to do just that – we
                have all the building blocks for creating software (frontends,
                backend compute, data storage) as well as a live interactive
                builder environment. Why entangle yourself with messy things
                like Webpack, Docker, and Kubernetes when you can directly
                manipulate a live app, running right in front of you?
              </p>
              <p>
                We also think that the world, as a whole, is under-utilizing AI.
                Businesses are broadly interested in generative AI and LLMs, but
                don’t know how yet to leverage and use them. It should be simple
                for businesses to quickly set up flows to have AI automatically
                triage bug reports, summarize customer feedback, and enrich
                datasets.
              </p>
              <p>
                We’ve shared a sneak peak of what we think some of this could
                look like (<a href="https://retool.com/blog/gpt4-in-retool/"
                  >https://retool.com/blog/gpt4-in-retool/</a
                >), and there’s a bunch more coming up that we’re really excited
                to talk about soon.
              </p>
              <p>
                If you’re interested in working with AIs and LLMs to change the
                way companies build software, we’d love to hear from you. We've
                made multiple hires from HN in the past, so we’re posting here.
                But if you know any friends who are interested, feel free to
                tell them to reach out as well.
              </p>
              <p>
                Please email us at snir AT retool with “HN” in the subject line.
              </p>
              <p>Thanks!</p>
            </div>
          </section>
        </section>
        <section id="35646199">
          <h3>
            <a class="item" href="https://x.st/spinning-diagrams-with-css/"
              >Spinning Diagrams with CSS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 20:57:54</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35646199"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35646093">
          <h3>
            <a class="item" href="https://github.com/jostmey/msm"
              >Diagnosing cancer by profiling the immune system</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 20:50:48</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35646093"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35646047">
          <h3>
            <a class="item" href="https://cthiriet.com/articles/scaling-laws"
              >Large language models: Scaling laws and emergent properties</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 20:46:52</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35646047"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35645857">
          <h3>
            <a class="item" href="https://www.babylonjs.com/">Babylon.js 6.0</a>
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 20:31:50</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35645857"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35645624">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/united-states/2023/04/20/rural-americans-are-importing-tiny-japanese-pickup-trucks"
              >Rural Americans are importing tiny Japanese pickup trucks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 20:10:50</span
              ><span class="points-container"
                >Points: <span class="points">214</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35645624"
                  >Comments</a
                ><span class="descendants">: 229</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35645464">
          <h3>
            <a class="item" href="https://evidence.dev"
              >Evidence.dev – Business Intelligence as Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 20:01:27</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35645464"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35645047">
          <h3>
            <a
              class="item"
              href="https://news.stanford.edu/2023/04/20/study-finds-new-pathway-clearing-misfolded-proteins/"
              >Study finds new pathway for clearing misfolded proteins</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 19:31:50</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35645047"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35644635">
          <h3>
            <a
              class="item"
              href="https://lemire.me/blog/2023/04/20/defining-interfaces-in-c-concepts-versus-inheritance/"
              >Defining interfaces in C++: concepts versus inheritance</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 19:03:01</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35644635"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35644504">
          <h3>
            <a class="item" href="https://infinityarcade.com/news"
              >Show HN: Play the front page of Hacker News as interactive text
              games</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 18:54:03</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35644504"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35644282">
          <h3>
            <a
              class="item"
              href="https://tderflinger.com/en/companies-producing-biopolymers-for-packaging/"
              >Companies Producing Biopolymers for Packaging</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 18:38:16</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35644282"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35643705">
          <h3>
            <a
              class="item"
              href="https://www.smh.com.au/national/farmers-crippled-by-satellite-failure-as-gps-guided-tractors-grind-to-a-halt-20230418-p5d1de.html"
              >Farmers ‘crippled’ by satellite failure as GPS-guided tractors
              grind to a halt</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 17:56:49</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35643705"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35643219">
          <h3>
            <a class="item" href="https://github.com/suno-ai/bark"
              >Bark – Text-prompted generative audio model</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 17:23:35</span
              ><span class="points-container"
                >Points: <span class="points">288</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35643219"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35643049">
          <h3>
            <a
              class="item"
              href="https://www.deepmind.com/blog/announcing-google-deepmind"
              >Google DeepMind</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 17:11:36</span
              ><span class="points-container"
                >Points: <span class="points">501</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35643049"
                  >Comments</a
                ><span class="descendants">: 444</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35642712">
          <h3>
            <a
              class="item"
              href="https://oldbytes.space/@kenshirriff/110231910098167742"
              >In 1981, Intel released the iAPX 432</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 16:47:30</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35642712"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35641448">
          <h3>
            <a
              class="item"
              href="https://www.thedailybeast.com/buzzfeed-news-is-shutting-down"
              >BuzzFeed News is shutting down</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 15:18:25</span
              ><span class="points-container"
                >Points: <span class="points">374</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35641448"
                  >Comments</a
                ><span class="descendants">: 220</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35640427">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Smuggling_of_silkworm_eggs_into_the_Byzantine_Empire"
              >Smuggling of silkworm eggs into the Byzantine Empire</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 14:21:13</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35640427"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35640325">
          <h3>
            <a
              class="item"
              href="https://www.thedrive.com/news/rear-wheel-drive-cars-are-back-baby-and-we-have-evs-to-thank"
              >Rear-wheel-drive cars are back and we have EVs to thank</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 14:16:22</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35640325"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35640002">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/spacex-starship-launch-elon-musk-d9989401e2e07cdfc9753f352e44f6e2"
              >SpaceX Starship rocket explodes minutes after launch from
              Texas</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 13:58:04</span
              ><span class="points-container"
                >Points: <span class="points">795</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35640002"
                  >Comments</a
                ><span class="descendants">: 1103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35639810">
          <h3>
            <a class="item" href="https://stretch15.com"
              >Show HN: A 15 min daily stretch routine for desk workers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 13:46:07</span
              ><span class="points-container"
                >Points: <span class="points">375</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35639810"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35639370">
          <h3>
            <a class="item" href="https://www.legittorrents.info/"
              >Shutting down my legal torrent site after 17 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 13:09:13</span
              ><span class="points-container"
                >Points: <span class="points">603</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35639370"
                  >Comments</a
                ><span class="descendants">: 298</span></span
              >
            </h4>
            <div class="text">
              I ran Legit Torrents for ~17 years and shut it down recently. The
              homepage is now a nostalgic look back at that time.
            </div>
          </section>
        </section>
        <section id="35638362">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-01296-3"
              >US could soon approve MDMA therapy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-20 @ 11:03:09</span
              ><span class="points-container"
                >Points: <span class="points">358</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35638362"
                  >Comments</a
                ><span class="descendants">: 330</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35633138">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2020/06/08/untangling-andy-warhol"
              >Untangling Andy Warhol (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-19 @ 20:47:49</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35633138"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35627102">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/technology/interactive/2023/ai-chatbot-learning/"
              >Analyzing the websites that are used to train AI chatbots</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-19 @ 12:05:12</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35627102"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35626736">
          <h3>
            <a
              class="item"
              href="https://copy.sh/life/?gist=f3413564b1fa9c69f2bad4b0400b8090&amp;step=512"
              >Conway's Game of Life digital clock</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-19 @ 11:08:43</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35626736"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35626698">
          <h3>
            <a
              class="item"
              href="https://alanstorm.com/review-of-james-coglands-building-git/"
              >Review of James Coglan’s Building Git</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-19 @ 11:03:05</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35626698"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35625877">
          <h3>
            <a
              class="item"
              href="http://informatimago.free.fr/i/linux/emacs-on-user-mode-linux.html"
              >Emacs standing alone on a Linux Kernel</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-19 @ 08:45:24</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35625877"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
