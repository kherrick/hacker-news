<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37521375">
          <h3>
            <a class="item" href="https://gumtrends.com"
              >Show HN: I built a dataset of 25k+ Gumroad products to spot
              market opportunities</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 11:24:31</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37521375"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37521167">
          <h3>
            <a
              class="item"
              href="https://www.ifw-kiel.de/publications/news/ukraine-support-tracker-europe-clearly-overtakes-us-with-total-commitments-now-twice-as-large/"
              >Ukraine: Europe clearly overtakes US, with total commitments now
              twice as large</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 10:59:15</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37521167"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520536">
          <h3>
            <a
              class="item"
              href="https://www.twipla.com/en/blog/norway-fining-meta-98500-per-day-for-user-privacy-breach"
              >Norway Fining Meta $98,500 per Day for User Privacy Breach</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 09:38:03</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520536"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520528">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2023/sep/13/libya-flood-death-toll"
              >‘Sea is constantly dumping bodies’: fears Libya flood death toll
              may hit 20k</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 09:37:04</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520528"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520509">
          <h3>
            <a
              class="item"
              href="https://www.embarcadero.com/products/cbuilder/starter"
              >C++Builder 11 Community Edition</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 09:34:40</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520509"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520441">
          <h3>
            <a class="item" href="https://incolumitas.com/pages/BotOrNot/"
              >BotOrNot (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 09:23:50</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520441"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520374">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37520374"
              >Ask HN: How do you manage your “family data warehouse”?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 09:15:23</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520374"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
            <div class="text">
              <p>Some common categories:</p>
              <p>
                (1) Financial: account statements (pdf, paper, etc), transaction
                CSV/ofx/etc, insurance policies, financial institution
                correspondence (confirmations, T&amp;Cs, etc), tax forms,
                deeds/titles, loans, debts, contemporaneous records, paystubs,
                employment letters, receipts, etc
              </p>
              <p>
                (2) Health: test results, diagnoses, medications used, doctor
                info/correspondence, vaccinations, hospital interactions,
                statements, bills, etc
              </p>
              <p>
                (3) Product and services info: products purchased, maintenance
                info, warranties, replacement parts, recall notices, class
                action events, professional used (CPAs, lawyers, contractors,
                plumbers, etc), etc
              </p>
              <p>
                (4) Personal legal and other documents: wills, trusts, health
                directives, pre-nups, legal settlements, personal contracts,
                rental agreements, government IDs, immigration/naturalization
                docs, law enforcement interactions, etc
              </p>
              <p>
                (5) Memories and other info of sentimental or other value:
                pictures, videos, cards, recordings, music, diaries, clippings,
                personal notes, etc
              </p>
              <p>For many of these one might ask the usual questions:</p>
              <p>
                A. do I have a reason/obligation to retain it? for example, tax
                authorities often require certain classes of record keeping.
                sometimes commercial entities make false claims in retrospect
                that you can only rebut with evidence (even major banks!). some
                documents can end up only being used by heirs at end-of-life
                (ex: basis information for assets like a home, which can require
                proof of improvements over the years, depreciation claimed if
                the home was ever rented, etc)
              </p>
              <p>
                B. is there a downside to retaining it? clutter, hard/costly to
                move, identity/other theft risk, physical decay over time (ex:
                obsolete storage formats (VHS, mini-DV, blueray)), etc
              </p>
              <p>
                C. will I (or the appropriate person) be able to find it when I
                need it? physical paper vs electronic mgmt, indexing, filing,
                passwords, legacy services for transferring access.
              </p>
              <p>
                D. can I actually retain it? backups, water damage, fire, theft,
                physical safe management, etc some online services don't provide
                any/easy export of data, many have inconsistent retention
                policies (ex utility companies)
              </p>
              <p>
                Some of the categories above have specialized software and
                services dedicated to them (ex: photos services, quickbooks,
                etc) while some are more ad hoc (goog drive, dropbox, local
                HDD); even specialized services often fall short on key matters
                (quickbooks doesn't track statements afaik); many specialized
                systems have various platform limitations (no turbotax on linux,
                say); many vendors try to play various lock-in tricks; some
                vendors go out of business or discontinue products over the
                years; some institutions are very paper oriented so one perhaps
                scans or tries to limit paper delivery; some services place data
                in the cloud creating security exposure; etc etc
              </p>
            </div>
          </section>
        </section>
        <section id="37520079">
          <h3>
            <a
              class="item"
              href="https://ramatak.com/2023/09/15/unitys-new-pricing-a-wake-up-call-on-the-importance-of-open-source-in-gaming/"
              >Unity’s New Pricing: A Wake-Up Call on the Importance of Open
              Source in Gaming</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:24:59</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520079"
                  >Comments</a
                ><span class="descendants">: 143</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520065">
          <h3>
            <a
              class="item"
              href="https://www.metzdowd.com/pipermail/cryptography/2016-March/028824.html"
              >On the Impending Crypto Monoculture (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:23:23</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520065"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520039">
          <h3>
            <a class="item" href="https://www.findmycat.io/"
              >Find my cat: open-source Cat Tracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:18:19</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520039"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519982">
          <h3>
            <a class="item" href="https://www.marginalia.nu/log/88-futo-grant/"
              >Marginalia Search Receives FUTO Grant</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:08:00</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519982"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519928">
          <h3>
            <a class="item" href="https://github.com/mackieks/MaplePad"
              >MaplePad – RP2040 Dreamcast controller, VMU, and Purupuru (rumble
              pack) emulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:00:15</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519928"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519487">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/eqtble/jobs/bOX2JJp-junior-data-scientist"
              >Eqtble (YC W21) Is Hiring a Data Analyst</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 07:00:24</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519418">
          <h3>
            <a
              class="item"
              href="https://billwillingham.substack.com/p/willingham-sends-fables-into-the"
              >Willingham sends Fables into the public domain</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 06:51:54</span
              ><span class="points-container"
                >Points: <span class="points">246</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519418"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519066">
          <h3>
            <a class="item" href="https://github.com/jedisct1/libsodium"
              >Libsodium: A modern, portable, easy to use crypto library</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 06:01:45</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519066"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519053">
          <h3>
            <a
              class="item"
              href="https://status.cloud.google.com/incidents/EBxyHQgEPnbM3Syag5yL"
              >Global Google Kubernetes Engine Outage</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 06:00:26</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519053"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37517567">
          <h3>
            <a class="item" href="https://b612-font.com/">B612 Font Family</a>
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 02:33:03</span
              ><span class="points-container"
                >Points: <span class="points">245</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37517567"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37517118">
          <h3>
            <a
              class="item"
              href="https://terrytao.wordpress.com/2012/12/29/a-mathematical-formalisation-of-dimensional-analysis/"
              >A mathematical formalization of dimensional analysis</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 01:34:36</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37517118"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37515996">
          <h3>
            <a
              class="item"
              href="https://baynature.org/2023/09/12/inaturalist-strikes-out-on-its-own/"
              >iNaturalist strikes out on its own</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 23:07:16</span
              ><span class="points-container"
                >Points: <span class="points">352</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37515996"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37515645">
          <h3>
            <a class="item" href="https://vole.wtf/coder-serial-killer-quiz/"
              >Programming Language Inventor or Serial Killer? (2003)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 22:28:08</span
              ><span class="points-container"
                >Points: <span class="points">266</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37515645"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37514601">
          <h3><a class="item" href="https://menuetos.net">MenuetOS</a></h3>
          <section>
            <h4>
              <span>2023-09-14 @ 20:45:06</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37514601"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37510865">
          <h3>
            <a
              class="item"
              href="https://blog.google/outreach-initiatives/education/automatic-update-extension-chromebook/"
              >Chromebooks will get 10 years of automatic updates</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 16:14:17</span
              ><span class="points-container"
                >Points: <span class="points">600</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37510865"
                  >Comments</a
                ><span class="descendants">: 337</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37509507">
          <h3>
            <a
              class="item"
              href="https://nothinghuman.substack.com/p/the-tyranny-of-the-marginal-user"
              >The Tyranny of the Marginal User</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 14:28:06</span
              ><span class="points-container"
                >Points: <span class="points">1196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37509507"
                  >Comments</a
                ><span class="descendants">: 655</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37507419">
          <h3>
            <a class="item" href="https://nuejs.org"
              >Show HN: Nue – A React/Vue/Vite/Astro Alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 11:11:17</span
              ><span class="points-container"
                >Points: <span class="points">252</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37507419"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
            <div class="text">
              <p>I'm releasing two things today:</p>
              <p>
                1. Nue JS:
                <a href="https://nuejs.org/docs/nuejs/"
                  >https://nuejs.org/docs/nuejs/</a
                >
                — A tiny (2.3kb minzipped) JavaScript library for building user
                interfaces. It's like React/Vue core, but there are no hooks,
                effects, props, or other unusual abstractions on your way. Know
                the basics of HTML, CSS, and JavaScript and you are good to go.
                Nue JS supports server-side rendering (SSR), reactive
                components, and "isomorphic" combinations. It takes inspiration
                from Vue 2.0 and Riot.js. (I'm actually the original author of
                Riot).
              </p>
              <p>
                2. Nue ecosystem:
                <a href="https://nuejs.org/ecosystem/"
                  >https://nuejs.org/ecosystem/</a
                >
                — This is the ultimate goal and once all the sub-projects are
                finished, Nue will be a serious alternative to things like Vite,
                Next.js, and Astro.
              </p>
              <p>
                The thing is that I'm not happy with the current state of web
                development, so I want to write a completely new ecosystem from
                scratch. I'm taking advantage of the "old" innovations like
                progressive enhancement, separation of concerns, and semantic
                web design. Benefits highlighted here:
                <a href="https://nuejs.org/why/">https://nuejs.org/why/</a>
              </p>
              <p>All projects will be released under the MIT license.</p>
              <p>Happy to answer any questions.</p>
            </div>
          </section>
        </section>
        <section id="37506248">
          <h3>
            <a class="item" href="https://github.com/barracuda-fsh/pyobd"
              >Pyobd - a free and open source program for car diagnostics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 08:05:19</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37506248"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37503037">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/essay/liquid-bewitchment/"
              >Liquid Bewitchment: Gin Drinking in England, 1700–1850</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-13 @ 23:31:18</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37503037"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37495166">
          <h3><a class="item" href="https://www.endbasic.dev/">EndBASIC</a></h3>
          <section>
            <h4>
              <span>2023-09-13 @ 11:12:02</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37495166"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37494001">
          <h3>
            <a class="item" href="http://jakobgreenfeld.com/agency-model"
              >Why agencies get stuck at $50k MRR</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-13 @ 08:49:11</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37494001"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37493955">
          <h3>
            <a
              class="item"
              href="https://cgad.ski/blog/what-is-dimensional-analysis.html"
              >What Is Dimensional Analysis?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-13 @ 08:44:19</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37493955"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37493792">
          <h3>
            <a
              class="item"
              href="https://blog.klungo.no/2023/09/12/the-washing-machine-in-my-ear-and-an-empty-boat/"
              >The washing machine in my ear, and an empty boat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-13 @ 08:25:42</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37493792"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
