<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36764004">
          <h3>
            <a class="item" href="https://etleap.com/careers/software-engineer/"
              >Etleap (YC W13) Is Hiring a Software Engineer (London)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 21:00:24</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36763758">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/electronics/computer-memory-resistive-switching-denser-data-storage/"
              >Computer memory prototype ditches 1s and 0s for denser data
              storage</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 20:41:39</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36763758"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36763493">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/07/17/books/harry-g-frankfurt-dead.html"
              >Harry G. Frankfurt, Philosopher with a Surprise Best Seller, Dies
              at 94</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 20:20:15</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36763493"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36763357">
          <h3>
            <a
              class="item"
              href="https://wikimedia.social/@wikimediafoundation/110708950540815886"
              >The Wikimedia Foundation joins Mastodon and the Fediverse</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 20:08:30</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36763357"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36762942">
          <h3>
            <a
              class="item"
              href="https://www.politico.eu/article/facebook-instagram-norway-ban-track-users-ads/"
              >Facebook, Instagram face Norwegian ban from tracking users for
              ads</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 19:38:01</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36762942"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36762879">
          <h3>
            <a
              class="item"
              href="https://twitter.com/JakeMooreUK/status/1680962682726363136"
              >You can deactivate anyone's WhatsApp account by simply sending an
              email</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 19:33:30</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36762879"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36762682">
          <h3>
            <a class="item" href="https://research.swtch.com/coro"
              >Coroutines for Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 19:16:31</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36762682"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36762465">
          <h3>
            <a class="item" href="https://www.uyuni-project.org/"
              >uyuni – open-source configuration and infrastructure
              management</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 18:58:37</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36762465"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36762284">
          <h3>
            <a
              class="item"
              href="https://crystal-lang.org/2023/07/17/1.9.1-released/"
              >Crystal 1.9.1</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 18:43:44</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36762284"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36761988">
          <h3>
            <a
              class="item"
              href="https://twitter.com/tri_dao/status/1680987580228308992"
              >FlashAttention-2, 2x faster than FlashAttention</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 18:21:45</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36761988"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36761655">
          <h3>
            <a
              class="item"
              href="https://www.deepakg.com/bringing-19th-century-ornamental-tile-illustrations-into-a-21st-century-web-app"
              >Bringing 19th century ornamental tile illustrations into a 21st
              century web app</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 17:59:22</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36761655"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36761623">
          <h3>
            <a
              class="item"
              href="https://znano.eu.org/blog/posts/a-very-technical-look-at-zeronet"
              >A technical look at ZeroNet</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 17:56:57</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36761623"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36761290">
          <h3>
            <a class="item" href="https://unix.foo/posts/enterprise-linux/"
              >What's wrong with enterprise Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 17:34:20</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36761290"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36759882">
          <h3>
            <a
              class="item"
              href="https://news.umich.edu/a-surprisingly-simple-way-to-foil-car-thieves/"
              >A surprisingly simple way to foil car thieves</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 16:04:24</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36759882"
                  >Comments</a
                ><span class="descendants">: 475</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36758433">
          <h3>
            <a class="item" href="https://kenschutte.com/gzip-knn-paper/"
              >Bad numbers in the “gzip beats BERT” paper?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 14:08:28</span
              ><span class="points-container"
                >Points: <span class="points">317</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36758433"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36758355">
          <h3>
            <a
              class="item"
              href="https://www.vox.com/23712664/parking-lots-urban-planning-cities-housing"
              >The force that shapes everything around us: Parking</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 14:01:13</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36758355"
                  >Comments</a
                ><span class="descendants">: 277</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36758292">
          <h3>
            <a class="item" href="https://www.peeng.sh"
              >Show HN: Peeng – like Pingdom, but the other way around and
              simpler</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 13:56:23</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36758292"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.keephq.dev">https://www.keephq.dev</a>) here!
              <p>
                For the last few weeks we’ve been building Peeng and can now
                share our beta with you:
                <a href="https://www.peeng.sh">https://www.peeng.sh</a>. Peeng
                is the easiest and quickest “heartbeat” architecture we could
                think of. Just pick a subdomain (e.g. x.peeng.sh), configure an
                interval, an endpoint, and a payload, and hit that subdomain
                every &lt;X (interval) seconds — If you won’t, Peeng will send
                an HTTP POST request to your configured endpoint.
              </p>
              <p>
                It’s Pingdom/Cronitor/heartbeat.sh free alternative (but the
                other way around and A LOT simpler, with a lot more
                capabilities), suitable for developers, system administrators,
                DevOps, and individuals with complex networking situations
                (think “onprem” or K8s clusters with no inbound). Instead of
                inbound heartbeat checks — Peeng presents outbound heartbeat
                checks!
              </p>
              <p>
                Quick demo:
                <a href="https://youtu.be/ZX5mrnMRCwU"
                  >https://youtu.be/ZX5mrnMRCwU</a
                >
              </p>
              <p>Why we built this:</p>
              <p>
                - We needed an easy way to let Keep (<a
                  href="https://github.com/keephq/keep"
                  >https://github.com/keephq/keep</a
                >) customers behind closed networks monitor their Keep instance
                - We needed an easy &amp; quick way to setup monitoring for our
                cronjobs - We wanted to give people with complex networking
                situations (e.g. behind a firewall) an easy way to monitor their
                services/processes
              </p>
              <p>The beta version lets you:</p>
              <p>
                - Create 5 endpoints for free - Configure the endpoint and the
                payload to be sent when the subdomain is not hit - See the
                visits (every HTTP GET request to your subdomain) and requests
                (every HTTP POST sent to your configured endpoint) - Secret
                header (x-peeng-secret) that confirms requests are made by you
              </p>
              <p>What’s next:</p>
              <p>
                - A status page that displays your subdomains and their health
                together with embeddable status blocks that allow you to display
                the status of an endpoint in your web page (you can also send
                query params when sending the GET requests that will be
                included) - Rest API (for subdomain creation, beats retrieval,
                etc., imagine curl -X POST peeng.sh/subdomain -H API_KEY —json
                {”subdomain”: “hn”, “endpoint”: “<a href="https://..”"
                  >https://xn--ivg</a
                >, “payload”: {…}}) - Hierarchy-based subdomains that allow you
                to create a nested heartbeat solution (i.e. dynamically create a
                heartbeat subdomain under x.peeng.sh → y.x.peeng.sh,
                z.x.peeng.sh)
              </p>
              <p>
                This is still very early, so we’d love to hear your feedback and
                opinions. We’re open to any feature request, so just reach out
                via Intercom :)
              </p>
            </div>
          </section>
        </section>
        <section id="36758267">
          <h3>
            <a
              class="item"
              href="https://www.indiehackers.com/post/the-power-technique-a-strategic-approach-to-self-discipline-11bc6724d6"
              >The PoWeR technique: a strategic approach to self-discipline</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 13:54:07</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36758267"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36758122">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36758122"
              >Launch HN: Grai (YC S22) – Open-Source Data Observability
              Platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 13:40:22</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36758122"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
            <div class="text">
              <a href="https://grai.io">https://grai.io</a>), an open-source
              data observability platform. It helps prevent production data
              outages by evaluating changes to your data pipelines in CI, rather
              than at runtime.
              <p>
                Ever experienced a production outage due to changes in upstream
                data sources? That's a problem we regularly encountered whether
                deploying machine learning or keeping a datawarehouse
                operational and it led us to create Grai.
              </p>
              <p>
                Systematically testing the impact of data changes on the rest of
                your stack turns out to be quite difficult when the same data is
                copied and used across many different services and applications.
                Simple changes like renaming a column in a database can result
                in broken BI dashboards, incorrect training data for ML models,
                and data pipeline failure. For example, business users regularly
                deal with questions like "why does revenue look different in
                different dashboards".
              </p>
              <p>
                These sort of problems are commonly dealt with by passively
                monitoring application execution logs for anomalies that might
                indicate an outage. Our goal was to move that task out of
                runtime where an outage has already occurred back into testing.
              </p>
              <p>
                At its core, Grai is a graph of the relationships between the
                data in your organization, from columns in a database to JSON
                fields in an API. This graph allows Grai to analyze the
                downstream impact of proposed changes during CI and before they
                go live.
              </p>
              <p>
                It includes a variety of pre-built integrations with common data
                tools such as PostgreSQL, Snowflake, dbt, and Fivetran, which
                automatically extract metadata and synchronize the state of your
                graph. It's built on a flexible data model backed by REST and
                GraphQL APIs and a Python client library. This way, users can
                directly build on top of Grai as they see fit. For example,
                because every object in Grai serializes to a yaml definition
                file, sort of like a CRD in Kubernetes, even if a pre-built
                integration doesn't exist it's fairly easy to manually create or
                script a custom solution.
              </p>
              <p>
                We made the decision to build open-source from the beginning in
                part because we believe lineage is underutilized both
                organizationally and technologically. We hope to provide a
                foundation for the community to build cool concepts on top and
                have already had companies come to us with amazing ideas, like
                optimizing their real-time query pipelines to take advantage of
                spot price arbitrage between cloud and on-prem.
              </p>
              <p>
                We try not to be overly opinionated about how organizations
                work, so whether you maintain a development database or run
                service containers in GitHub Actions it doesn't really matter.
                When your tests are triggered we evaluate the new state of the
                environment and check for any impacts, before reporting back as
                a comment in the pull request.
              </p>
              <p>
                Data observability can have unexpected benefits. One of our
                customers uses us because we make on-boarding new engineers
                easier. Because we render an infinitely zoomable Figma-like
                graph of the entire data stack it's possible for them to
                visually explore end-to-end data flows and application
                dependencies.
              </p>
              <p>
                You can find a quick demo here:
                <a href="https://vimeo.com/824026569"
                  >https://vimeo.com/824026569</a
                >, we've also put together an example getting started guide if
                you want to try things out yourself:
                <a href="https://docs.grai.io/examples/enhanced-dbt"
                  >https://docs.grai.io/examples/enhanced-dbt</a
                >. Since everything is open source, you can always explore the
                code (<a href="https://github.com/grai-io/grai-core"
                  >https://github.com/grai-io/grai-core</a
                >) and docs (<a href="https://docs.grai.io"
                  >https://docs.grai.io</a
                >), where we have example deployment configurations for
                docker-compose and Kubernetes.
              </p>
              <p>
                We would love to hear your feedback. If there's a feature we're
                missing, we'll build it. If you have a UX or developer
                experience suggestion, we'll fix it. If it's something else, we
                want to hear about it. We can't wait to hear your feedback and
                thank you in advance!
              </p>
            </div>
          </section>
        </section>
        <section id="36757798">
          <h3>
            <a class="item" href="https://www.lelanthran.com/chap9/content.html"
              >The C Programming Language: Myths and Reality</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 13:05:48</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36757798"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36757688">
          <h3>
            <a class="item" href="https://katacontainers.io/"
              >Kata Containers: Virtual Machines that feel and perform like
              containers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 12:55:36</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36757688"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36757542">
          <h3>
            <a
              class="item"
              href="https://www.stefanjudis.com/a-firefox-only-minimap/"
              >A Firefox-only minimap (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 12:44:09</span
              ><span class="points-container"
                >Points: <span class="points">599</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36757542"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36757492">
          <h3>
            <a
              class="item"
              href="https://nabeelqu.substack.com/p/notes-on-puzzles"
              >Notes on Puzzles</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 12:38:39</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36757492"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36757213">
          <h3>
            <a class="item" href="https://ntietz.com/blog/writing-hurl-grammar/"
              >Writing Hurl's Grammar, Twice</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 12:09:49</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36757213"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36756606">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/the-man-who-organized-nature-review-linnaeus-the-namer-673a3305"
              >‘The Man Who Organized Nature’: Linnaeus</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 11:19:05</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36756606"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36755509">
          <h3>
            <a
              class="item"
              href="https://nerology.substack.com/p/my-broken-thinkpad-plays-music-upon"
              >My broken ThinkPad plays music upon booting</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 08:24:33</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36755509"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36744002">
          <h3>
            <a
              class="item"
              href="https://blog.brossia.com/posts/the_perfect_laptop/"
              >The Perfect Laptop</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 05:35:41</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36744002"
                  >Comments</a
                ><span class="descendants">: 236</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36743623">
          <h3>
            <a
              class="item"
              href="https://www.nybooks.com/online/2023/07/13/loves-work-hayao-miyazaki/"
              >Miyazaki has used the art of animation to study the major problem
              of adult life</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 04:24:20</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36743623"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36743286">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/07/13/science/magpies-birds-nests.html"
              >Birds Build Nests from Anti-Bird Spikes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 03:29:33</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36743286"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36742457">
          <h3>
            <a class="item" href="http://compucolor.org/"
              >A Tribute to the Compucolor II (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 01:04:53</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36742457"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
