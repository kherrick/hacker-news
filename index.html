<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37797164">
          <h3>
            <a
              class="item"
              href="https://web3isgoinggreat.com/single/bored-apes-yuga-labs-lays-off-employees"
              >Bored Apes' Yuga Labs lays off employees</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 22:27:35</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37797164"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37797012">
          <h3>
            <a class="item" href="https://whattoreadafter.xyz/ai-librarian"
              >Show HN: What to read after? Personalised AI book
              recommendations</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 22:09:24</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37797012"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              Personalised AI book recommendations with WOW effect! Greetings!
              I'm Robo Ratel, your personal AI librarian, and I'm thrilled to
              help you find your next amazing literary adventure! Just specify
              genres and/or storyline characteristic and see the exciting
              recommendations I've curated just for you!
            </div>
          </section>
        </section>
        <section id="37796913">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-03135-x"
              >US science agencies on track to hit 25-year funding low</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 21:53:05</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37796913"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37796863">
          <h3>
            <a class="item" href="https://github.com/okuvshynov/slowllama"
              >SlowLlama: Finetune llama2-70B and codellama on MacBook Air
              without quantization</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 21:46:50</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37796863"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37796428">
          <h3>
            <a
              class="item"
              href="https://www.desy.de/news/news_search/index_eng.html?openDirectAnchor=2951&amp;two_columns=0"
              >Lasers Deflected Using Air</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 21:06:59</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37796428"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37796292">
          <h3>
            <a
              class="item"
              href="https://retrocomputing.stackexchange.com/questions/27722/why-did-the-motorola-68000-processor-family-fall-out-of-use-in-personal-computer"
              >Why did the Motorola 68000 processor family fall out of use in
              PCs?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 20:54:21</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37796292"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37796195">
          <h3>
            <a
              class="item"
              href="https://loup-vaillant.fr/articles/source-of-readability"
              >The Source of Readability</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 20:47:07</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37796195"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37795652">
          <h3>
            <a
              class="item"
              href="https://therecord.media/scraping-incident-genetic-testing-site"
              >23andMe scraping incident leaked data on 1.3M users</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 20:08:52</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37795652"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37795278">
          <h3>
            <a
              class="item"
              href="https://petapixel.com/2023/10/06/a-20mp-sensor-in-a-film-canister-reinvigorates-vintage-analog-cameras/"
              >A 20MP Sensor in a Film Canister Reinvigorates Vintage Analog
              Cameras</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 19:40:41</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37795278"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37795100">
          <h3>
            <a class="item" href="https://github.com/fail2ban/fail2ban"
              >Fail2Ban</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 19:26:55</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37795100"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37794960">
          <h3>
            <a class="item" href="https://github.com/JLCarveth/nutty"
              >Show HN: A simple Pastebin Clone using Deno</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 19:14:55</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37794960"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <p>
                I created a simple templating system, and implemented
                server-side rendering for the UI.
              </p>
              <p>
                Demo:
                <a href="https://paste.jlcarveth.dev/"
                  >https://paste.jlcarveth.dev/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="37794904">
          <h3>
            <a
              class="item"
              href="https://github.com/ekmas/neobrutalism-components"
              >Show HN: Neobrutalism components – A collection of react-tailwind
              components</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 19:11:00</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37794904"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
            <div class="text">
              Hi, can you give me your opinion about this project? What else I
              should add?
            </div>
          </section>
        </section>
        <section id="37793635">
          <h3>
            <a
              class="item"
              href="https://www.hpcwire.com/2023/10/05/how-amd-may-get-across-the-cuda-moat/"
              >AMD may get across the CUDA moat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 17:35:36</span
              ><span class="points-container"
                >Points: <span class="points">244</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37793635"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37792996">
          <h3>
            <a class="item" href="https://github.com/open-ribbon/open-ribbon"
              >Open-ribbon – A Project to reverse engineer the PS1 music game
              Vib-Ribbon</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 16:39:16</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37792996"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37792916">
          <h3>
            <a class="item" href="https://awk.dev/eda.html"
              >Exploratory data analysis for humanities data</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 16:31:36</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37792916"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37792507">
          <h3>
            <a class="item" href="https://rolepad.com"
              >Show HN: A job application tracker with company reviews,
              recruiter autoresponder</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 16:01:12</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37792507"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>
                These days it is common to apply to dozens of positions (some
                users track over a hundred opportunities). Without a
                record-keeping system, it can quickly become an unmanageable
                mess. Even the better-organized among us often end up juggling
                spreadsheets, emails, and various notes. Rolepad was built to
                keep this data (company facts, role details, interview stages,
                contact info, freeform notes, follow-up actions, and more) in
                one place. Some of the other neat additions:
              </p>
              <p>
                - Forward emails to save@rolepad.com to save them as notes
                connected to specific opportunities. Forward recruiter messages
                to no@rolepad.com to have the system automatically reply with a
                decline response.
              </p>
              <p>
                - Generate shareable Sankey charts of your progress like this:
                <a href="https://app.rolepad.com/metrics/6QEbaktB7bqR8glhuYR32"
                  >https://app.rolepad.com/metrics/6QEbaktB7bqR8glhuYR32</a
                >
              </p>
              <p>
                - Submit anonymous reviews and insights about
                application/interview/offer processes at a company . This is new
                and there aren’t great examples to share yet (<a
                  href="https://rolepad.com/companies/brilliant.org"
                  >https://rolepad.com/companies/brilliant.org</a
                >
                is an early glimpse), and I didn’t want to create fake data as a
                matter of principle.
              </p>
              <p>
                Oh yeah, and it’s totally free :) Creating an account is
                passwordless and takes seconds, but if you want to kick the
                tires even faster, I created test credentials for this occasion:
              </p>
              <p></p>
              <pre><code>  username: test@rolepad.com
  password: hntest
</code></pre>
              With this release, I am also starting conversations with employers
              (<a href="https://rolepad.com/employers"
                >https://rolepad.com/employers</a
              >). A unified platform for candidates and employers can
              significantly reduce frustration for both in ways that email
              cannot. I should note that any solutions here have privacy
              implications and will require an exceedingly thoughtful execution.
              <p>
                And now for the tech stack. The main application uses React with
                Tailwind on the frontend, C# on the backend, hosted in AWS (App
                Runner, Lambda, RDS Postgres, SES), with auth provided by Google
                Firebase, and CI/CD via GitHub Actions. The home page is
                actually an SSR (server-side rendered) application built with
                vite-plugin-ssr (now vike) and hosted in a Cloudflare Worker
                that hits the AWS-hosted API. This is basically a
                best-of-all-worlds SSR configuration - very fast, zero cold
                start (!), and essentially free.
              </p>
              <p>Any and all feedback is sincerely appreciated!</p>
            </div>
          </section>
        </section>
        <section id="37792444">
          <h3>
            <a class="item" href="https://shortbread.ai/"
              >Show HN: Shortbread – Create AI comics in minutes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 15:56:22</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37792444"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built shortbread to help anyone to create comics / manga
                series. The onboarding process helps you kick start a page from
                60%, then you can use your creativity to bring it to 1000% in a
                fully-controllable editor.
              </p>
              <p>Tech stack:</p>
              <p>
                GPT 3.5 Turbo - the comic script generation. It handled
                everything from layout, character, scene, SD prompts, to
                dialogue.
              </p>
              <p>
                SD 1.5 - We put up SD servers on GCP. For every comic we
                generate one large image and crop it into panels. Per the
                experiments of u/Deathmarkedadc on Reddit, this massively helps
                with consistency. The models are trained on anime scenes tho,
                and might not be so great with animals.
              </p>
              <p>
                Frontend: Next.js 13 on Vercel, React + Typescript. We built the
                entire editor from scratch to compose the comic (images, panels,
                speech bubbles, text) like a webpage. This allows you to edit
                and republish your comics like a website. You can dynamically
                generate panels as well. Try resizing a panel into a long narrow
                box and generate.
              </p>
              <p>Backend: Firebase.</p>
              <p>Sample comics:</p>
              <p>
                a japanese couple sits at dinner table. The husband told the
                wife a secret (link
                <a
                  href="https://create.shortbread.ai/viewer/debdf25c-3f95-492a-952a-3098e0044bf5_2"
                  >https://create.shortbread.ai/viewer/debdf25c-3f95-492a-952a-...</a
                >)
              </p>
              <p>
                An army of male soldiers fighting against an army of female
                soldiers in ancient china (<a
                  href="https://create.shortbread.ai/viewer/4566613c-7146-4ed7-9b8d-85bcd2e58785_2"
                  >https://create.shortbread.ai/viewer/4566613c-7146-4ed7-9b8d-...</a
                >)
              </p>
              <p>
                a team of girls play volleyball against a team of boys (<a
                  href="https://create.shortbread.ai/viewer/aafc2f61-d008-4f3f-aa8f-62d87080d66b_2"
                  >https://create.shortbread.ai/viewer/aafc2f61-d008-4f3f-aa8f-...</a
                >
                )
              </p>
              <p>Next steps:</p>
              <p>- More pages</p>
              <p>- Fine panel-level control. Poses, control net, etc.</p>
              <p>- Multi-character.</p>
              <p>- Different styles.</p>
              <p>- Allows you to control character design.</p>
              <p>
                I’m Fengjiao Peng, founder and chief engineer at Shortbread. I
                was previously a webtoon artist. We want to build this into
                something you can create entire comics series / manga / webtoons
                with. Criticism and suggestions welcome!
              </p>
            </div>
          </section>
        </section>
        <section id="37792294">
          <h3>
            <a class="item" href="https://clojure.org/news/2023/10/06/deref"
              >Java 21 VirtualThreads vs. Clojure Lazy Seqs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 15:44:13</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37792294"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37792129">
          <h3>
            <a
              class="item"
              href="https://jimbo.itch.io/petscii-side-scrolling-platformer"
              >Petscii Side-Scrolling Platformer by Jimbo</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 15:31:41</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37792129"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37791897">
          <h3>
            <a
              class="item"
              href="https://www.algolia.com/blog/engineering/when-allocators-are-hoarding-your-precious-memory/"
              >When allocators are hoarding your precious memory</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 15:15:30</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37791897"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37791116">
          <h3>
            <a
              class="item"
              href="https://www.hpcwire.com/2023/10/04/eu-grabs-arm-for-first-exaflop-supercomputer-x86-misses-out/"
              >EU Grabs ARM for First ExaFLOP Supercomputer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 14:18:59</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37791116"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37791060">
          <h3>
            <a
              class="item"
              href="https://github.com/paralleldrive/sudolang-llm-support"
              >SudoLang: a programming language designed to collaborate with AI
              language models</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 14:14:09</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37791060"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37791002">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2023/10/06/new-talk--making-hard-things-easy/"
              >Making Hard Things Easy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 14:09:41</span
              ><span class="points-container"
                >Points: <span class="points">650</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37791002"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37789617">
          <h3>
            <a
              class="item"
              href="https://turbot.com/blog/2023/10/repo-management"
              >How we manage 200 open-source repos</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 12:07:37</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37789617"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37789554">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37789554"
              >Treble.ai (YC S19) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 12:00:12</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              Treble.ai (YC S19) Is Hiring Spanish Speaking Engineers in NYC!
            </div>
          </section>
        </section>
        <section id="37789371">
          <h3>
            <a class="item" href="https://github.com/alex028502/extra-screen"
              >Show HN: Use an old tablet as an extra monitor</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 11:36:41</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37789371"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
            <div class="text">but only for terminal and curses apps</div>
          </section>
        </section>
        <section id="37788875">
          <h3>
            <a
              class="item"
              href="https://daily.jstor.org/walkers-in-the-city-and-everywhere/"
              >Walkers in the City and Everywhere: on Psychogeography</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 10:12:22</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37788875"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37788747">
          <h3>
            <a
              class="item"
              href="https://www.intego.com/mac-security-blog/when-does-an-old-iphone-become-unsafe-to-use/"
              >When does an old iPhone become unsafe to use?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-06 @ 09:45:00</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37788747"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37776079">
          <h3>
            <a
              class="item"
              href="https://blog.bittacklr.be/the-workflow-pattern.html"
              >The Workflow Pattern</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-05 @ 08:17:21</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37776079"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37767633">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/artificial-intelligence-watermarking-issues/"
              >Researchers tested AI watermarks and broke all of them</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-04 @ 16:32:49</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37767633"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
