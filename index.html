<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42195994">
          <h3>
            <a class="item" href="https://www.philipzucker.com/sql_graph_csp/"
              >SQL, Homomorphisms and Constraint Satisfaction Problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 17:07:18</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42195994"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42195908">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42195908"
              >Converge (YC S23) is hiring senior product engineers (NYC,
              in-person)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 17:00:36</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                We graduated from the YC S23 cohort last year. Since then, we
                scaled to 7-figures in ARR, now serving 180+ customers
                (including publicly listed companies). All the while, we kept
                our team very small with just 2 engineers, making this a great
                opportunity to join an early-stage startup with strong traction.
              </p>
              <p>
                We are well-funded and backed by the founders of PostHog,
                Algolia, Postscript, Shipbob, Showpad, etc.
              </p>
              <p>---</p>
              <p>## Role</p>
              <p>
                We're looking for senior full-stack engineers who can ship
                product end-to-end. You will have ownership over solving
                specific customer problems, designing, building, and iterating
                on solutions.
              </p>
              <p>## Product</p>
              <p>
                We vertically integrate the modern data stack for B2C marketing
                teams by consolidating customer data collection, consent
                management, identity resolution, transformations, attribution,
                data forwarding, and analytics into a single platform.
              </p>
              <p>
                On top of our shared data infrastructure, we have 2
                customer-facing products
              </p>
              <p>
                - Connections: a CDP for marketing integrations — ‘Segment for
                e-commerce’
              </p>
              <p>
                - Analytics: custom attribution reporting — ‘Amplitude for
                e-commerce’
              </p>
              <p>
                These help VPs of Marketing &amp; Growth (1) understand how they
                acquire customers and (2) optimize their spend allocation for
                more profitable growth.
              </p>
              <p>---</p>
              <p>
                Apply here:
                <a
                  href="https://www.ycombinator.com/companies/converge/jobs/GQWZ40Z-senior-product-engineer"
                  >https://www.ycombinator.com/companies/converge/jobs/GQWZ40Z-...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42195587">
          <h3>
            <a class="item" href="https://lira.study"
              >Show HN: I'm 17 and made a tool to help students study smarter</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 16:33:51</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42195587"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>
                Over the past few weeks, I've been developing LIRA, a free
                Chrome extension that helps you take notes &amp; get instant
                answers on any site.
              </p>
              <p>
                Instead of switching tabs or copying/pasting to ChatGPT, just
                select and right-click text, images, or links to save a note or
                ask LIRA anything.
              </p>
              <p>
                LIRA can instantly find accurate answers, summaries, and
                explanations, and automatically highlights correct answers.
              </p>
              <p>
                I made LIRA to help busy students like myself study smarter, not
                longer!
              </p>
              <p>
                That being said, LIRA is still a work in progress. There may be
                a few bugs &amp; unfinished features, so feedback would be
                greatly appreciated. Thanks!
              </p>
            </div>
          </section>
        </section>
        <section id="42194587">
          <h3>
            <a class="item" href="https://unlocked.microsoft.com/vatican/"
              >La Basilica Di San Pietro</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 15:15:16</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42194587"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42194355">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/11/15/dining/malort.html"
              >The Rise of Malört, an Unexpected Midwest princess</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 14:48:13</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42194355"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42194327">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/how-good-are-american-roads"
              >How good are American roads?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 14:45:23</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42194327"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42194315">
          <h3>
            <a class="item" href="https://artanis.dev/blog/1.0.0-release.html"
              >GNU Artanis 1.0.0 Released</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 14:44:41</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42194315"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42193921">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/travel/hs2-britain-expensive-high-speed-railway/index.html"
              >Britain is building one of the world’s most expensive railways</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 13:51:12</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42193921"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42193885">
          <h3>
            <a
              class="item"
              href="https://untested.sonnet.io/notes/enso-design-constraints/"
              >Ensō: design constraints of a focussed writing tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 13:45:13</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42193885"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42193859">
          <h3>
            <a
              class="item"
              href="https://www.mpi-hd.mpg.de/personalhomes/fwerner/research/2021/09/grpc-for-ipc/"
              >Using gRPC for (local) inter-process communication – F. Werner's
              Research Page</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 13:42:11</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42193859"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42193793">
          <h3>
            <a class="item" href="https://github.com/greymattergames/unbug"
              >Show HN: Unbug – Rust macros for programmatically invoking
              breakpoints</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 13:33:15</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42193793"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
            <div class="text">
              <p>
                Due to reliance on core_intrinsics it is necessary to develop
                using nightly Rust, but there are stubs in place so a production
                build will not require nightly.
              </p>
              <p>
                I recently released version 0.2 which includes no_std support
                and adds optional log message arguments to the ensure macro.
              </p>
            </div>
          </section>
        </section>
        <section id="42193771">
          <h3>
            <a
              class="item"
              href="https://history.stackexchange.com/questions/57033/what-is-the-origin-of-the-lake-tank-image-that-has-become-a-meme"
              >What is the origin of the lake tank image that has become a meme?
              (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 13:30:03</span
              ><span class="points-container"
                >Points: <span class="points">250</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42193771"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42193663">
          <h3>
            <a
              class="item"
              href="https://web.cs.toronto.edu/news-events/news/flying-with-photons"
              >U of T computational imaging researchers harness AI to fly with
              light in motion</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 13:14:48</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42193663"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42193530">
          <h3>
            <a class="item" href="https://cardo-podcast.github.io/"
              >Show HN: Cardo ‒ Open Source desktop podcast client</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 12:56:15</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42193530"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                Hi, I'm an amateur developer from Spain. I have released this
                desktop podcast client that works on Windows, Mac and Linux.
              </p>
              <p>
                It's a modest project, but it might be useful for you, it has
                syncing capabilities with Antennapod, Kasts, Repod or other
                clients. You can manage your subscriptions, queue episodes and
                even download them to listen to later.
              </p>
              <p>I look forward to hearing your thoughts.</p>
            </div>
          </section>
        </section>
        <section id="42192336">
          <h3>
            <a
              class="item"
              href="https://www.abebooks.com/books/ex-library-books"
              >Discarded delights: The joy of ex-library books (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 09:58:39</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42192336"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42191709">
          <h3>
            <a
              class="item"
              href="https://blog.frost.kiwi/analytical-anti-aliasing/"
              >AAA – Analytical Anti-Aliasing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 08:03:20</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42191709"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42191394">
          <h3>
            <a
              class="item"
              href="https://bsky.app/profile/auonsson.bsky.social/post/3lbc5va7f722p"
              >Yi Peng 3 crossed both cables C-Lion 1 and BSC at times matching
              when they broke</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 06:56:47</span
              ><span class="points-container"
                >Points: <span class="points">240</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42191394"
                  >Comments</a
                ><span class="descendants">: 294</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42191354">
          <h3>
            <a
              class="item"
              href="https://scottlocklin.wordpress.com/2024/11/19/lush-my-favorite-small-programming-language/"
              >Lush: My favorite small programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 06:47:02</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42191354"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42190650">
          <h3>
            <a
              class="item"
              href="https://emschwartz.me/understanding-the-bm25-full-text-search-algorithm/"
              >Understanding the BM25 full text search algorithm</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-20 @ 03:43:10</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42190650"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42188816">
          <h3>
            <a
              class="item"
              href="https://www.newstatesman.com/culture/books/book-of-the-day/2024/11/political-afterlife-paradise-lost-milton-orlando-reade-review"
              >The Political Afterlife of Paradise Lost</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-19 @ 22:35:21</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42188816"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42187766">
          <h3>
            <a class="item" href="https://github.com/OpenRiak"
              >Open Riak – open, modern Riak fork</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-19 @ 20:29:30</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42187766"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42185842">
          <h3>
            <a
              class="item"
              href="https://chernando.com/blog/2023/07/23/hand-tracking-for-mouse-input.html"
              >Hand Tracking for Mouse Input (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-19 @ 17:18:14</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42185842"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42178916">
          <h3>
            <a
              class="item"
              href="https://pmc.ncbi.nlm.nih.gov/articles/PMC2997957/"
              >Why I hate the index finger (1980)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-19 @ 00:35:15</span
              ><span class="points-container"
                >Points: <span class="points">233</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42178916"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42162271">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2409.11582"
              >Tiling with Three Polygons Is Undecidable</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-17 @ 05:51:44</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42162271"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42147860">
          <h3>
            <a class="item" href="https://sandimetz.com/99bottles"
              >Bottles of OOP now available in Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 15:39:16</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42147860"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42147252">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2410.16144"
              >1-Bit AI Infrastructure</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 14:28:23</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42147252"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42146144">
          <h3>
            <a
              class="item"
              href="https://m65digest.substack.com/p/disassembling-crossroads-part-1"
              >Disassembling Crossroads, Part 1</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 12:04:03</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42146144"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42144816">
          <h3>
            <a class="item" href="https://github.com/dbohdan/recur"
              >Show HN: Retry a command with exponential backoff and jitter (+
              Starlark exprs)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 08:04:36</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42144816"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42144369">
          <h3>
            <a class="item" href="https://github.com/mkalioby/leopards"
              >Query Your Python Lists</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-15 @ 06:18:48</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42144369"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42135303">
          <h3>
            <a
              class="item"
              href="https://hwisnu.bearblog.dev/fireducks-pandas-but-100x-faster/"
              >FireDucks: Pandas but Faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-11-14 @ 11:48:30</span
              ><span class="points-container"
                >Points: <span class="points">276</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42135303"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
