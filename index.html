<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43847432">
          <h3>
            <a
              class="item"
              href="https://github.com/deepseek-ai/DeepSeek-Prover-V2"
              >DeepSeek-Prover-V2</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 16:23:28</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43847432"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43847368">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/04/30/well/mind/happiness-flourishing-young-adult-study.html"
              >Young people aren't as happy as they used to be [Global
              Flourishing Study]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 16:19:50</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43847368"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43846487">
          <h3>
            <a
              class="item"
              href="https://jayd.ml/2025/04/30/someone-at-youtube-needs-glasses.html"
              >Someone at YouTube Needs Glasses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 15:18:47</span
              ><span class="points-container"
                >Points: <span class="points">370</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43846487"
                  >Comments</a
                ><span class="descendants">: 238</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43846187">
          <h3>
            <a class="item" href="https://akapugs.blog/2022/05/03/674/"
              >Joining Sun Microsystems – 40 years ago (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 14:57:31</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43846187"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43846052">
          <h3>
            <a
              class="item"
              href="https://wikimediafoundation.org/news/2025/04/30/our-new-ai-strategy-puts-wikipedias-humans-first/"
              >Wikipedia says it will use AI, but not to replace human
              volunteers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 14:49:45</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43846052"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43845089">
          <h3>
            <a
              class="item"
              href="https://www.anildash.com//2025/04/19/ai-first-is-the-new-return-to-office/"
              >"AI-first" is the new Return To Office</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 13:38:57</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43845089"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43844708">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2025/04/29/port-of-los-angeles-sees-shipping-volume-down-35percent-next-week-as-tariffs-bite.html"
              >Port of Los Angeles says shipping volume will plummet 35% next
              week</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 13:07:45</span
              ><span class="points-container"
                >Points: <span class="points">378</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43844708"
                  >Comments</a
                ><span class="descendants">: 320</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43844665">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43844665"
              >Show HN: Kexa.io – Open-Source IT Security and Compliance
              Verification</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 13:04:04</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43844665"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                We're building Kexa.io (<a
                  href="https://github.com/kexa-io/Kexa"
                  >https://github.com/kexa-io/Kexa</a
                >), an open-source tool developed in France (incubated at
                Euratech Cyber Campus) to help teams automate the often tedious
                process of verifying IT security and compliance. Keeping track
                of configurations across diverse assets (servers, K8s, cloud
                resources) and ensuring they meet security baselines (like CIS
                benchmarks, etc.) manually is challenging and error-prone.
              </p>
              <p>
                Our goal with the open-source core is to provide a
                straightforward way to define checks, scan your assets, and get
                clear reports on your security posture. You can define your own
                rules or use common standards.
              </p>
              <p>
                We are now actively developing our SaaS offering, planned for a
                beta release around June 2025. The key feature will be an
                AI-powered security administration agent specifically designed
                for cloud environments (initially targeting AWS, GCP, Azure).
                Instead of just reporting issues, this agent will aim to provide
                proactive, actionable recommendations and potentially automate
                certain remediation tasks to simplify cloud security management
                and hardening.
              </p>
              <p>
                We'd love for the HN community to check out the open-source
                project on GitHub. Feedback on the concept or the current tool
                is highly welcome, and a star if you find it interesting helps
                others discover the project! If the upcoming AI-powered cloud
                security agent sounds interesting, we'd be particularly keen to
                hear your thoughts or if you might be interested in joining the
                beta (~June 2025).
              </p>
              <p>thank you !!</p>
            </div>
          </section>
        </section>
        <section id="43844342">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/economy/us-gdp-q1-2025-1f82f689"
              >U.S. Economy Contracts at 0.3% Rate in First Quarter</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 12:38:41</span
              ><span class="points-container"
                >Points: <span class="points">388</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43844342"
                  >Comments</a
                ><span class="descendants">: 390</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43844279">
          <h3>
            <a class="item" href="https://github.com/raven-ml/raven"
              >OCaml's Wings for Machine Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 12:31:47</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43844279"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43843821">
          <h3>
            <a
              class="item"
              href="https://fortune.com/article/retailers-weeks-of-inventory-left-trump-china-trade-war/"
              >Retailers will soon have only about 7 weeks of full inventories
              left</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 11:42:06</span
              ><span class="points-container"
                >Points: <span class="points">213</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43843821"
                  >Comments</a
                ><span class="descendants">: 272</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43843808">
          <h3>
            <a class="item" href="https://kasurian.com/p/lebanese-space-program"
              >Lessons from the Lebanese Space Program – Kasurian</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 11:41:17</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43843808"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43842856">
          <h3>
            <a class="item" href="https://yle.fi/a/74-20158886"
              >Finland Bans Smartphones in Schools</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 09:17:30</span
              ><span class="points-container"
                >Points: <span class="points">591</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43842856"
                  >Comments</a
                ><span class="descendants">: 383</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43842683">
          <h3>
            <a class="item" href="https://github.com/XiaomiMiMo/MiMo"
              >Xiaomi MiMo Reasoning Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 08:48:20</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43842683"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43842380">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2504.20879"
              >The Leaderboard Illusion</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 07:58:24</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43842380"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43842306">
          <h3>
            <a class="item" href="https://habr.com/en/articles/905812/"
              >I created Perfect Wiki and reached $250k in annual revenue
              without investors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 07:45:51</span
              ><span class="points-container"
                >Points: <span class="points">384</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43842306"
                  >Comments</a
                ><span class="descendants">: 201</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43840861">
          <h3>
            <a class="item" href="https://github.com/NSG650/LinuxInExcel"
              >Linux in Excel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 03:08:46</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43840861"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43840763">
          <h3>
            <a
              class="item"
              href="https://www.sentinelone.com/labs/top-tier-target-what-it-takes-to-defend-a-cybersecurity-company-from-todays-adversaries/"
              >What It Takes to Defend a Cybersecurity Company from Today's
              Adversaries</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 02:53:02</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43840763"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43840193">
          <h3>
            <a class="item" href="https://www.jasonthorsness.com/25"
              >You Wouldn't Download a Hacker News</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 01:26:31</span
              ><span class="points-container"
                >Points: <span class="points">287</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43840193"
                  >Comments</a
                ><span class="descendants">: 151</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43837171">
          <h3>
            <a
              class="item"
              href="https://undark.org/2025/04/28/keep-wild-places-wild/"
              >Researchers are studying how to minimize human impact on public
              lands</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-29 @ 19:45:48</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43837171"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43835584">
          <h3>
            <a class="item" href="https://github.com/freeman-jiang/beatsync"
              >Show HN: Beatsync – perfect audio sync across multiple devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-29 @ 17:32:25</span
              ><span class="points-container"
                >Points: <span class="points">375</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43835584"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
            <div class="text">
              <p>
                Try it live right now:
                <a href="https://www.beatsync.gg/">https://www.beatsync.gg/</a>
              </p>
              <p>
                The idea is that with no additional hardware, you can turn any
                group of devices into a full surround sound system. MacBook
                speakers are particularly good.
              </p>
              <p>
                Inspired by Network Time Protocol (NTP), I do clock
                synchronization over websockets and use the Web Audio API to
                keep audio latency under a few ms.
              </p>
              <p>
                You can also drag devices around a virtual grid to simulate
                spatial audio — it changes the volume of each device depending
                on its distance to a virtual listening source!
              </p>
              <p>
                I've been working on this project for the past couple of weeks.
                Would love to hear your thoughts and ideas!
              </p>
            </div>
          </section>
        </section>
        <section id="43835495">
          <h3>
            <a
              class="item"
              href="https://research.ibm.com/blog/bamba-ssm-transformer-model"
              >Bamba: An open-source LLM that crosses a transformer with an
              SSM</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-29 @ 17:24:29</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43835495"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43835445">
          <h3>
            <a
              class="item"
              href="https://github.com/PhialsBasement/Chain-of-Recursive-Thoughts"
              >Chain of Recursive Thoughts: Make AI think harder by making it
              argue with itself</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-29 @ 17:19:04</span
              ><span class="points-container"
                >Points: <span class="points">514</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43835445"
                  >Comments</a
                ><span class="descendants">: 225</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43833195">
          <h3>
            <a
              class="item"
              href="https://jepsen.io/analyses/amazon-rds-for-postgresql-17.4"
              >Jepsen: Amazon RDS for PostgreSQL 17.4</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-29 @ 14:30:11</span
              ><span class="points-container"
                >Points: <span class="points">524</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43833195"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43831792">
          <h3>
            <a
              class="item"
              href="https://www.nist.gov/news-events/news/2025/04/new-atomic-fountain-clock-joins-elite-group-keeps-world-time"
              >New atomic fountain clock joins group that keeps the world on
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-29 @ 12:39:31</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43831792"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43829935">
          <h3>
            <a
              class="item"
              href="https://brainbaking.com/post/2025/04/my-sourdough-starter-has-twins/"
              >My sourdough starter has twins</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-29 @ 08:20:04</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43829935"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43828423">
          <h3>
            <a
              class="item"
              href="https://iclr-blogposts.github.io/2025/blog/sparse-autodiff/"
              >An illustrated guide to automatic sparse differentiation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-29 @ 03:18:52</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43828423"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43826798">
          <h3>
            <a class="item" href="https://idiallo.com/blog/zipbomb-protection"
              >I use zip bombs to protect my server</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-28 @ 22:28:56</span
              ><span class="points-container"
                >Points: <span class="points">899</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43826798"
                  >Comments</a
                ><span class="descendants">: 397</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43817000">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/04/27/business/dc-plane-crash-reagan-airport.html"
              >The missteps that led to a fatal plane crash at Reagan National
              Airport</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-28 @ 02:33:53</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43817000"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43804561">
          <h3>
            <a class="item" href="https://thetruesize.com/">The True Size Of</a>
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 15:41:44</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43804561"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
