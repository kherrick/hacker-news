<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42878780">
          <h3>
            <a
              class="item"
              href="https://blog.pypi.org/posts/2025-01-30-archival/"
              >PyPI Now Supports Project Archival</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 15:42:56</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42878780"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42878598">
          <h3>
            <a
              class="item"
              href="https://lareviewofbooks.org/article/the-case-for-kicking-the-stone/"
              >Review: Superbloom: How Technologies of Connection Tear Us
              Apart</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 15:24:53</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42878598"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42877860">
          <h3>
            <a class="item" href="https://mistral.ai/news/mistral-small-3/"
              >Mistral Small 3</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 14:16:57</span
              ><span class="points-container"
                >Points: <span class="points">252</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42877860"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42877709">
          <h3>
            <a
              class="item"
              href="https://www.vatican.va/roman_curia/congregations/cfaith/documents/rc_ddf_doc_20250128_antiqua-et-nova_en.html"
              >Note on the Relationship Between Artificial Intelligence and
              Human Intelligence</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 14:01:27</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42877709"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42877430">
          <h3>
            <a class="item" href="https://dl.acm.org/doi/10.1145/130647.130656"
              >History of APL in the USSR (1991)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 13:18:49</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42877430"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42877399">
          <h3>
            <a class="item" href="https://www.audiocube.app"
              >Audiocube – A 3D DAW for Spatial Audio (Audio Software)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 13:12:34</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42877399"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42877004">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42877004"
              >Codes Health (YC S24) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 12:00:46</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                we’re tackling one of the most frustrating and overlooked pain
                points in healthcare: the hassle of gathering, reviewing, and
                summarizing medical records.
              </p>
              <p>
                As our first engineering hire, you’ll have the opportunity to
                work directly with me and our customers to build out our
                platform from the ground up. This is the kind of role where
                you’ll own entire projects, work closely with customers, and see
                the impact of your work in real time.
              </p>
              <p>
                We are working fully in-person out of our offices in Soho, NY.
              </p>
              <p>If that energizes you, reach out!</p>
            </div>
          </section>
        </section>
        <section id="42876840">
          <h3>
            <a
              class="item"
              href="https://developer.mozilla.org/en-US/blog/javascript-temporal-is-coming/"
              >JavaScript Temporal is coming</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 11:28:31</span
              ><span class="points-container"
                >Points: <span class="points">537</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42876840"
                  >Comments</a
                ><span class="descendants">: 188</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42875888">
          <h3>
            <a
              class="item"
              href="https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1006616"
              >Investigating the case of human nose shape and climate adaptation
              (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 08:04:53</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42875888"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42874885">
          <h3>
            <a
              class="item"
              href="https://lcamtuf.substack.com/p/pcbs-ground-planes-and-you"
              >PCBs, copper pours, ground planes, and you</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 04:33:25</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42874885"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42874301">
          <h3>
            <a
              class="item"
              href="https://www.mediaite.com/news/breaking-commercial-jet-collides-with-police-chopper-near-reagan-airport/"
              >Commercial jet collides with Black Hawk helicopter near Reagan
              airport</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 02:56:45</span
              ><span class="points-container"
                >Points: <span class="points">517</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42874301"
                  >Comments</a
                ><span class="descendants">: 423</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42873825">
          <h3>
            <a class="item" href="https://mahaloz.re/dec-progress-2024"
              >Decompiling 2024: A Year of Resurgance in Decompilation
              Research</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 01:48:17</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42873825"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42873312">
          <h3>
            <a
              class="item"
              href="https://github.com/mathesar-foundation/mathesar"
              >Mathesar – an intutive spreadsheet-like interface to Postgres
              data</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-30 @ 00:31:53</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42873312"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42872276">
          <h3>
            <a class="item" href="https://www.henrikkarlsson.xyz/p/start-a-blog"
              >Advice for a friend who wants to start a blog</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 22:45:14</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42872276"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42871743">
          <h3>
            <a
              class="item"
              href="https://thenewstack.io/from-c-to-clojure-new-language-promises-best-of-both/"
              >From C++ to Clojure: Jank language promises best of both</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 21:56:11</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42871743"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42868770">
          <h3>
            <a class="item" href="https://github.com/Om-Alve/smolGPT"
              >SmolGPT: A minimal PyTorch implementation for training a small
              LLM from scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 18:09:19</span
              ><span class="points-container"
                >Points: <span class="points">346</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868770"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42868390">
          <h3>
            <a
              class="item"
              href="https://arcprize.org/blog/r1-zero-r1-results-analysis"
              >An analysis of DeepSeek's R1-Zero and R1</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 17:44:45</span
              ><span class="points-container"
                >Points: <span class="points">618</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42868390"
                  >Comments</a
                ><span class="descendants">: 226</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42864272">
          <h3>
            <a
              class="item"
              href="https://cneos.jpl.nasa.gov/sentry/details.html#?des=2024%20YR4"
              >Asteroid Impact on Earth 2032 with Probability 1% and 8Mt
              Energy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-29 @ 12:47:17</span
              ><span class="points-container"
                >Points: <span class="points">433</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42864272"
                  >Comments</a
                ><span class="descendants">: 310</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42854291">
          <h3>
            <a
              class="item"
              href="https://andrewchilds.com/posts/building-a-t1d-smartwatch-from-scratch"
              >Building a T1D smartwatch for my son from scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-28 @ 16:33:32</span
              ><span class="points-container"
                >Points: <span class="points">443</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42854291"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42836370">
          <h3>
            <a class="item" href="https://mina86.com/2025/rusts-worst-feature/"
              >Rust’s worst feature</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-27 @ 01:34:09</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42836370"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42836306">
          <h3>
            <a
              class="item"
              href="http://muratbuffalo.blogspot.com/2024/01/scalable-oltp-in-cloud-whats-big-deal.html"
              >Scalable OLTP in the Cloud: What's the Big Deal?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-27 @ 01:24:10</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42836306"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42835808">
          <h3>
            <a class="item" href="https://github.com/willswire/teemoji"
              >Teemoji: Like Tee but with Emojis</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-27 @ 00:15:29</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42835808"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42835424">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-01-edges-images.html"
              >Detecting edges of images at the speed of light</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-26 @ 23:28:13</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42835424"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42835054">
          <h3>
            <a
              class="item"
              href="https://qckfx.com/blog/automating-git-bisect-with-ephemeral-environments"
              >Automating Git Bisect with Ephemeral Environments</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-26 @ 22:50:39</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42835054"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42832114">
          <h3>
            <a
              class="item"
              href="https://blogs.bl.uk/digitisedmanuscripts/2025/01/permission-to-practise-medicine.html"
              >Permission to Practise Medicine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-26 @ 17:57:50</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42832114"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42832021">
          <h3>
            <a
              class="item"
              href="https://wilderutopia.com/performance/literary/goethes-sorcerers-apprentice-power-over-wisdom/"
              >Goethe's "Sorcerer's Apprentice" – power over wisdom</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-26 @ 17:49:13</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42832021"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42831969">
          <h3>
            <a
              class="item"
              href="https://www.sentex.ca/~mwandel/organ/organ.html"
              >My home built pipe organ</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-26 @ 17:44:54</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42831969"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42831935">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/collection/dutch-banquet-scenes/"
              >Piled High: 17th-Century Dutch Banquet Scenes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-26 @ 17:41:09</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42831935"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42830948">
          <h3>
            <a
              class="item"
              href="https://codeinsecurity.wordpress.com/2025/01/25/proper-decoupling-practices-and-why-you-should-leave-100nf-behind/"
              >Proper decoupling capacitor practices, and why you should leave
              100nF behind</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-26 @ 16:00:50</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42830948"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42830478">
          <h3>
            <a
              class="item"
              href="https://components.one/posts/gamer-and-nihilist-product-hunt"
              >Analysis of 76,882 Product Hunt Products, from 2014 – 2021</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-26 @ 14:59:26</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42830478"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
