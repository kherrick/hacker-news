<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37106833">
          <h3>
            <a
              class="item"
              href="https://www.inverse.com/science/weeds-and-pollination"
              >Weeds May Be a Better Friend to Pollinating Insects Than We
              Assume</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 04:57:15</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37106833"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37106789">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2308.05660"
              >Thermodynamic Linear Algebra</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 04:48:20</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37106789"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37106560">
          <h3>
            <a class="item" href="https://wsdookadr.github.io/posts/p9/"
              >Solving a simple puzzle using SymPy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 03:59:50</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37106560"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37106550">
          <h3>
            <a
              class="item"
              href="https://www.bryanbraun.com/after-dark-css/all/flying-toasters.html"
              >Flying Toasters Screensaver After Dark in CSS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 03:58:11</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37106550"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37106408">
          <h3>
            <a
              class="item"
              href="https://www.dignitymemorial.com/obituaries/bellevue-wa/stan-lippman-10887984"
              >Stan Lippman, early contributor to C++, died (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 03:27:52</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37106408"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37106369">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37106369"
              >Infiuss Health (YC S21) Is Hiring a Project Manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 03:19:03</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Project Leadership: Provide visionary leadership to the project
                team, fostering a collaborative and results-oriented work
                environment. Set clear expectations, communicate project goals,
                and motivate the team to meet milestones and deliverables.
                Project Planning: Develop a comprehensive project plan that
                includes a detailed work breakdown structure, schedule, resource
                allocation, risk assessment, and mitigation strategies. Ensure
                alignment with the CDC's objectives and the organization's
                strategic goals. Stakeholder Management: Establish and maintain
                strong relationships with the CDC and other key stakeholders.
                Facilitate regular communication, provide project updates, and
                address concerns or changes in project requirements. Risk
                Management: Proactively identify potential risks, issues, and
                challenges that could impact the project's success. Develop risk
                mitigation strategies and contingency plans to minimize
                disruptions.
              </p>
              <p>
                Budget Oversight: Monitor project expenditures, track budget
                allocation, and ensure efficient resource utilization. Identify
                areas for cost optimization while maintaining high-quality
                project deliverables. Quality Control: Implement rigorous
                quality control processes to ensure that project deliverables
                meet the highest standards. Conduct regular reviews,
                assessments, and quality checks to ensure alignment with project
                objectives. Change Management: Handle changes to project scope,
                schedule, or resources, ensuring that any deviations are
                properly evaluated, communicated, and approved by relevant
                stakeholders. Reporting and Documentation: Generate
                comprehensive project reports, status updates, and documentation
                for internal and external audiences. Present findings, progress,
                and challenges in a clear and concise manner. Issue Resolution:
                Address project-related issues promptly and effectively.
                Facilitate problem-solving, decision-making, and conflict
                resolution within the team and with stakeholders to maintain
                project momentum. Continuous Improvement: Identify opportunities
                for process improvements and lessons learned. Capture best
                practices and implement them to enhance project efficiency and
                effectiveness. Adherence to Regulations: Ensure that the project
                adheres to data privacy regulations, ethical guidelines, and
                industry standards, especially as they relate to handling
                sensitive healthcare data.
              </p>
              <p>
                Qualifications: Bachelor's degree in a relevant field (e.g.,
                Project Management, Public Health, Business Administration) or
                equivalent experience. Master's degree is a plus. Proven track
                record of successfully managing complex projects, preferably in
                public health, healthcare, or data-driven initiatives. Project
                Management Professional (PMP) certification or equivalent is
                highly desirable. Strong leadership skills, with the ability to
                inspire and motivate cross-functional teams. Exceptional
                communication and interpersonal skills, capable of engaging with
                diverse stakeholders. Proficiency in project management tools,
                techniques, and software. Thorough understanding of project
                management principles, including scope, schedule, budget, risk,
                and quality management. Experience in risk assessment,
                mitigation, and contingency planning. Demonstrated ability to
                adapt to changing requirements, priorities, and deadlines.
              </p>
              <p>
                Ethical and trustworthy, with a commitment to maintaining the
                highest level of integrity and professionalism. Strong
                problem-solving skills, able to navigate complex challenges
                while keeping the project on track.
              </p>
              <p>Salary range</p>
              <p>$250,000-$350,000</p>
              <p>
                Role Operations Job type Full-time Experience 6+ years Location
                San Francisco, CA, US / Remote (US) Remote Yes US visas No
                sponsorship Salary $250K - $350K Equity missing Hiring manager
                Melissa Bime Last updated 08/13/2023 Public URL
                <a
                  href="https://www.ycombinator.com/companies/infiuss-health/jobs/XUYJ7IB-the-project-manager"
                  >https://www.ycombinator.com/companies/infiuss-health/jobs/XU...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="37106296">
          <h3><a class="item" href="https://codelite.org/">Codelite</a></h3>
          <section>
            <h4>
              <span>2023-08-13 @ 03:05:50</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37106296"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37106044">
          <h3>
            <a
              class="item"
              href="https://www.sfchronicle.com/bayarea/article/robotaxi-backup-18293208.php"
              >Cruise blames Outside Lands for driverless car traffic fiasco in
              San Francisco</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 02:19:05</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37106044"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37105653">
          <h3>
            <a class="item" href="https://docs.mesa3d.org/drivers/virgl"
              >VirGL – A virtual 3D GPU for use inside QEMU virtual machines</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 01:06:48</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37105653"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37105651">
          <h3>
            <a class="item" href="http://www.boat-links.com/"
              >John's Nautical and Boatbuilding Page</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 01:06:36</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37105651"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37105610">
          <h3>
            <a class="item" href="https://fabiensanglard.net/m1/index.html"
              >Ode to the M1</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 00:59:24</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37105610"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37105524">
          <h3>
            <a class="item" href="https://github.com/NixOS/rfcs/pull/136"
              >NixOS RFC 136 approved: A plan to stabilize the new CLI and
              Flakes incrementally</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 00:44:44</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37105524"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37105477">
          <h3>
            <a class="item" href="https://simplex.chat/"
              >The first messenger without user IDs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-13 @ 00:35:27</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37105477"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37105214">
          <h3>
            <a
              class="item"
              href="http://oldvcr.blogspot.com/2023/08/cracking-designwares-grammar-examiner.html"
              >Cracking DesignWare's the Grammar Examiner on the C64</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 23:42:16</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37105214"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37105054">
          <h3>
            <a
              class="item"
              href="https://github.com/continuousml/Awesome-Out-Of-Distribution-Detection"
              >Out-of-Distribution</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 23:11:39</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37105054"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37104817">
          <h3>
            <a
              class="item"
              href="https://blog.podman.io/2023/08/podman-v4-6-introduces-podmansh-a-revolutionary-login-shell/"
              >Podman v4.6 Introduces Podmansh: A Revolutionary Login Shell</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 22:33:06</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37104817"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37104742">
          <h3>
            <a
              class="item"
              href="https://www.patrickweaver.net/blog/a-blog-post-with-every-html-element/"
              >A Blog Post with Every HTML Element</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 22:19:37</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37104742"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37104264">
          <h3>
            <a
              class="item"
              href="https://twitter.com/naderi_yeganeh/status/1690296100496838656"
              >OP drew these corals with mathematical equations</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 21:11:35</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37104264"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37103802">
          <h3>
            <a
              class="item"
              href="https://www.ugu.rs/blog/auditory-illusions-with-samples-from-daft-punk/"
              >Auditory illusions with examples from Daft Punk</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 20:10:51</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37103802"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37102482">
          <h3>
            <a
              class="item"
              href="https://www.righto.com/2023/08/datapoint-to-8086.html"
              >Tracing the roots of the 8086 instruction set to the Datapoint
              2200 minicomputer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 17:41:10</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37102482"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37101588">
          <h3>
            <a class="item" href="https://seiya.me/blog/reading-linux-v0.01"
              >Exploring the Internals of Linux v0.01</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 16:06:00</span
              ><span class="points-container"
                >Points: <span class="points">400</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37101588"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37101563">
          <h3>
            <a class="item" href="https://dreamsongs.com/Files/clos-cacm.pdf"
              >CLOS: Integrating Object-Oriented and Functional Programming
              (2004) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 16:03:33</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37101563"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37101515">
          <h3>
            <a class="item" href="https://dlsyscourse.org/lectures/"
              >Deep Learning Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 15:59:41</span
              ><span class="points-container"
                >Points: <span class="points">212</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37101515"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37101026">
          <h3>
            <a class="item" href="https://www.farmanager.com/"
              >Far Manager: files and archives in Windows</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 15:15:58</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37101026"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37100344">
          <h3>
            <a
              class="item"
              href="https://www.anyscale.com/blog/num-every-llm-developer-should-know"
              >Numbers every LLM Developer should know</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 14:08:46</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37100344"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37100283">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/risky-giant-steps-can-solve-optimization-problems-faster-20230811/"
              >Risky Giant Steps Can Solve Optimization Problems Faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 14:02:57</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37100283"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37100226">
          <h3>
            <a class="item" href="https://www.atvbt.com/the-carrot-problem/"
              >The Carrot Problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-12 @ 13:57:18</span
              ><span class="points-container"
                >Points: <span class="points">405</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37100226"
                  >Comments</a
                ><span class="descendants">: 191</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37091253">
          <h3>
            <a
              class="item"
              href="https://caseyhandmer.wordpress.com/2023/08/05/reading-ancient-scrolls/"
              >Reading Ancient Scrolls</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-11 @ 17:23:25</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37091253"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37089573">
          <h3>
            <a
              class="item"
              href="https://www.aisnakeoil.com/p/machine-learning-is-useful-for-many"
              >ML is useful for many things, but not for predicting scientific
              replicability</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-11 @ 15:11:08</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37089573"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37085618">
          <h3>
            <a
              class="item"
              href="https://reductor.dev/cpp/2023/08/10/the-downsides-of-coroutines.html"
              >The Downsides of C++ Coroutines</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-11 @ 06:09:20</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37085618"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
