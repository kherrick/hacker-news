<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41852009">
          <h3>
            <a
              class="item"
              href="https://www.the-fence.com/plots-major-authors/"
              >All Possible Plots by Major Authors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 19:06:43</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41852009"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41851607">
          <h3>
            <a
              class="item"
              href="https://tobikodata.com/dbt-incremental-but-incomplete.html"
              >Dbt – Incremental but Incomplete</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 18:31:08</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41851607"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41851569">
          <h3>
            <a
              class="item"
              href="https://www.amusingplanet.com/2017/02/the-sundial-cannon-of-atvidaberg.html"
              >The Sundial Cannon of Åtvidaberg (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 18:28:09</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41851569"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41851467">
          <h3>
            <a
              class="item"
              href="https://security.googleblog.com/2024/10/safer-with-google-advancing-memory.html"
              >Safer with Google: Advancing Memory Safety</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 18:19:32</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41851467"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41851434">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/zep-ai/jobs"
              >Zep AI (YC W24) Is Hiring AI Engineers and Dev Advocates</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 18:16:52</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41851304">
          <h3>
            <a
              class="item"
              href="https://engineering.fb.com/2024/10/15/data-infrastructure/metas-open-ai-hardware-vision/"
              >Meta's open AI hardware vision</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 18:08:15</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41851304"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41851274">
          <h3>
            <a
              class="item"
              href="https://www.lakeplacidnews.com/opinion/editorials/2019/02/01/meteorologists-please-stop-the-fearmongering/"
              >Meteorologists, please stop the fearmongering (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 18:05:10</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41851274"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41851104">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/10/15/intel_amd_x86_future/"
              >Intel and AMD form advisory group to reshape x86 ISA</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 17:50:52</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41851104"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41851051">
          <h3>
            <a class="item" href="https://sqlite.org/wasm/doc/trunk/index.md"
              >Sqlite3 WebAssembly</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 17:45:27</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41851051"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41850573">
          <h3>
            <a
              class="item"
              href="https://www.fable.app/blog/fable-is-winding-down"
              >Fable is winding down</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 16:57:47</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41850573"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41850017">
          <h3>
            <a
              class="item"
              href="https://gustedt.wordpress.com/2024/10/15/the-c23-edition-of-modern-c/"
              >The C23 edition of Modern C</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 16:06:29</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41850017"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41849907">
          <h3>
            <a
              class="item"
              href="https://www.command.ai/blog/command-ai-is-now-part-of-amplitude/"
              >Command AI Bought by Amplitude</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 15:57:49</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41849907"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41849058">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2024/10/apple-introduces-powerful-new-ipad-mini-built-for-apple-intelligence/"
              >Apple introduces iPad mini built for Apple Intelligence</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 14:35:29</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41849058"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41848816">
          <h3>
            <a
              class="item"
              href="https://wistia.com/learn/marketing/video-infrastructure-services"
              >We discovered the woes of video hosting and built a better
              system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 14:11:57</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41848816"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41848804">
          <h3>
            <a
              class="item"
              href="https://digital-naturalism-laboratories.github.io/Mothbox/"
              >Mothbox 4.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 14:10:58</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41848804"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41848209">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/big-advance-on-simple-sounding-math-problem-was-a-century-in-the-making-20241014/"
              >Big advance on simple-sounding math problem was a century in the
              making</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 13:10:49</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41848209"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41848150">
          <h3>
            <a class="item" href="https://emoji.build/deal-with-it-generator/"
              >Show HN: I built the most over-engineered Deal With It emoji
              generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 13:05:05</span
              ><span class="points-container"
                >Points: <span class="points">448</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41848150"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
            <div class="text">
              <p>
                - All operations done fully client-side - no backend, no private
                data leaves your browser. - Uses machine learning models
                (MediaPipe Face Detector task) to automatically scale and
                position glasses on the detected faces. - Extensive
                customization options for glasses: - Placement of glasses
                anywhere on the input image (including slightly going outside
                it). - Change the size of glasses. - No limit on the number of
                glasses. - Flip the glasses vertically or horizontally. -
                Customize the direction from which the glasses appear on the
                image. - Different types of glasses. - GIF output options: -
                Looping mode. - Number of frames. - Frame delay. - Separate
                delay setting for last frame. - Output size. - Celebration
                confetti - Easter eggs.
              </p>
              <p>
                I've been working remotely for the last &gt;9 years. When using
                non-verbal communication, it's important that your tone and
                intent comes across accurately.. Custom emojis became for me
                part of expressing yourself, creating bonds and camaraderie.
                I've originally created an MVP of this tool while applying for a
                exciting new job opportunity. As a showcase of my passion for
                programming, building teams and creating delightful user
                experiences. Unfortunately, they were not impressed and
                ultimately did not offer me the job :( But I wanted to polish it
                and release it for everyone to use for free, so that you can too
                "Deal With It"!
              </p>
              <p>
                I have more ideas for even more features (check GitHub[1]), but
                wanted to launch it and see what's the feedback and ideas from
                the community! And if you're looking for a Fullstack Developer
                with &gt;14 years of experience, with passion for great customer
                experience (remote work or locally in Iceland), let's chat!
              </p>
              <p>
                [1] -
                <a href="https://github.com/klimeryk/dealwithit"
                  >https://github.com/klimeryk/dealwithit</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41848099">
          <h3>
            <a
              class="item"
              href="https://mused.com/guided/158/temple-26-and-excavation-tunnels-copan-ruinas/"
              >Show HN: I 3D scanned the tunnels inside the Maya Pyramid Temples
              at Copan</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 12:57:54</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41848099"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
            <div class="text">
              <p>
                Unlike Egyptian pyramids, the Maya built their temples layer by
                layer outward, so to understand them, researchers tunneled into
                the structures to understand the earlier phases of construction.
                I arranged the guided versions of the virtual tours in a rough
                chronology, moving from the highest to the lowest and oldest
                areas: the hieroglyphic stairway composing the largest Maya
                inscription anywhere, the Rosalila temple that was buried fully
                intact, and finally the tomb of the Founder of the city, Yax
                Kʼukʼ Moʼ.
              </p>
              <p>
                I've been working to build on top of the Matterport SDK with
                Three.js--and then reusing the data in Unreal for a desktop
                experience or rendering for film (coming soon to PBS).
              </p>
              <p>
                Blog about process:
                <a
                  href="https://blog.mused.com/what-lies-beneath-digitally-recording-over-4km-of-tunnels-inside-the-maya-temples-at-copan/"
                  >https://blog.mused.com/what-lies-beneath-digitally-recording...</a
                >
              </p>
              <p>
                Major thanks to the Matterport team for providing support with
                data alignment and merging tunnels while I was living in the
                village near site.
              </p>
            </div>
          </section>
        </section>
        <section id="41847948">
          <h3>
            <a class="item" href="https://github.com/hunterirving/macproxy_plus"
              >Show HN: MacProxy Plus – Surf the Modern Web on Vintage
              Computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 12:39:42</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41847948"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              I created an enhanced fork of the popular MacProxy project called
              MacProxy Plus, which makes it possible to browse the modern web on
              vintage hardware. You run MPP on a machine on your local network
              and configure the Mac (or other vintage computer) to use it as a
              proxy server. MPP converts HTTPS to HTTP, strips out CSS,
              JavaScript, and other tags the Mac's browser doesn't recognize,
              then serves super-simplified HTML that actually loads pretty fast
              on the nearly 40 year old machine. Custom handling is enabled by
              "extensions" (individual python scripts) which intercept requests
              for given domains (like chatgpt.com) and return simple HTML
              interfaces. Current extensions include Weather, ChatGPT, Anthropic
              Claude, Wikipedia, Reddit, Hackaday, WayBack Machine, Web
              Simulator, and (not) YouTube. Though this solution was developed
              with early Macs in mind, it should also work to get many other
              vintage computers online.
            </div>
          </section>
        </section>
        <section id="41847640">
          <h3>
            <a class="item" href="https://github.com/asterinas/asterinas"
              >Asterinas: OS kernel written in Rust and providing
              Linux-compatible ABI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 12:01:59</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41847640"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41847407">
          <h3>
            <a class="item" href="https://mermaid-ascii.art/"
              >Show HN: Mermaid ASCII Diagrams</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 11:30:14</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41847407"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41847239">
          <h3>
            <a class="item" href="http://lillian.com/films/"
              >Short films by Lillian F. Schwartz (1927-2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 10:58:52</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41847239"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41846986">
          <h3>
            <a class="item" href="https://github.com/JohnDTill/Forscape"
              >Forscape – A Language and Editor for Scientific Computation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 10:14:41</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41846986"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41846780">
          <h3>
            <a class="item" href="https://browser.engineering/index.html"
              >Web Browser Engineering</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 09:42:29</span
              ><span class="points-container"
                >Points: <span class="points">575</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41846780"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41846636">
          <h3>
            <a class="item" href="https://github.com/Snowiiii/Pumpkin"
              >Show HN: Pumpkin – A Modern Minecraft server written in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 09:18:16</span
              ><span class="points-container"
                >Points: <span class="points">214</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41846636"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41846592">
          <h3>
            <a
              class="item"
              href="https://morethanmoore.substack.com/p/the-future-of-big-iron-telum-ii-and"
              >The Future of Big Iron: An Interview with IBM’s Christian
              Jacobi</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 09:13:07</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41846592"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41842339">
          <h3>
            <a
              class="item"
              href="https://joseprupi.github.io/misc/2024/07/08/cosine-similarity-simd-implementation.html"
              >A not so fast implementation of cosine similarity in C++ and
              SIMD</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 21:43:40</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41842339"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840956">
          <h3>
            <a class="item" href="https://peps.python.org/pep-0762/"
              >PEP 762 – REPL-acing the default REPL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 19:25:39</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840956"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840562">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/10/14/world/petra-tomb-discovered-jordan.html"
              >In Jordan, a ‘stunning’ discovery under Petra’s ancient stone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 18:46:29</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840562"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41810786">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/c8el64yyppro"
              >A team paid to break into top-secret bases</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-11 @ 16:13:16</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41810786"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
