<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41354101">
          <h3>
            <a
              class="item"
              href="https://www.techradar.com/pro/software-erosion-is-happening-all-around-us"
              >A Jenga tower about to collapse: Software erosion is happening
              all around us</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 04:48:05</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41354101"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41353979">
          <h3>
            <a class="item" href="https://github.com/oeo/ward"
              >Show HN: Ward – a file vault written in bash</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 04:18:07</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41353979"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>
                you don't have to store it that way, it's just why i created it.
              </p>
              <p>what ward does:</p>
              <p>
                encrypts the files in ./vault/ into a single .gpg file, checks
                to see if your files have been tampered with, generates totp
                codes if you need them to recover critical accounts.
              </p>
              <p>how to use it:</p>
              <p>
                clone the repo, toss your files into the vault directory, and
                run yarn encrypt. now commit your new [private] repository or
                save it somewhere.
              </p>
              <p>
                that's it. repo link:
                <a href="https://github.com/oeo/ward"
                  >https://github.com/oeo/ward</a
                >
              </p>
              <p>
                feedback welcome, or just let me know if you find it useful.
              </p>
            </div>
          </section>
        </section>
        <section id="41353835">
          <h3>
            <a class="item" href="https://github.com/yetone/avante.nvim"
              >Avante.nvim: Use Your Neovim Like Using Cursor AI IDE</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 03:44:48</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41353835"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41353328">
          <h3>
            <a class="item" href="https://www.gkogan.co/removing-stuff/"
              >Removing stuff is never obvious yet often better</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 01:59:13</span
              ><span class="points-container"
                >Points: <span class="points">252</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41353328"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41352681">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/world/asia-pacific/australian-employees-now-have-right-ignore-work-emails-calls-after-hours-2024-08-25/"
              >Australian employees now have the right to ignore work emails,
              calls after hours</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 00:08:07</span
              ><span class="points-container"
                >Points: <span class="points">232</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41352681"
                  >Comments</a
                ><span class="descendants">: 181</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41351662">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/rollstack-2/jobs/QPqpb1n-middle-senior-software-engineer-typescript-us-canada-east-coast-only"
              >Rollstack (YC W23) Is Hiring TypeScript Engineers – US/Canada
              (East Coast Only)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 21:34:44</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41351446">
          <h3>
            <a class="item" href="https://notgull.net/announcing-dozer/"
              >Writing a Rust compiler in C</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 21:08:06</span
              ><span class="points-container"
                >Points: <span class="points">306</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41351446"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41351380">
          <h3>
            <a
              class="item"
              href="http://electronupdate.blogspot.com/2024/08/pi-pico-2-extreme-teardown.html"
              >Pi Pico 2 Extreme Teardown</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 21:01:04</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41351380"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41351219">
          <h3>
            <a
              class="item"
              href="https://www.raphkoster.com/2009/01/08/database-sharding-came-from-uo/"
              >Database "sharding" came from Ultima Online? (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 20:42:02</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41351219"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41351009">
          <h3>
            <a
              class="item"
              href="https://www.inexhibit.com/case-studies/olivetti-programma-101-at-the-origins-of-the-personal-computer/"
              >Olivetti Programma 101: At the Origins of the Personal
              Computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 20:20:56</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41351009"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41350468">
          <h3>
            <a
              class="item"
              href="https://github.com/getlago/lago/wiki/Stripe-Data-vs-Open%E2%80%90Source-Alternatives:-a-MRR-example"
              >Stripe Data vs. Open‐Source Alternatives: A MRR Example</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 19:28:26</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41350468"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41350151">
          <h3>
            <a class="item" href="https://ramimac.me/aws-iam-tools-2024"
              >An AWS IAM Security Tooling Reference</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 18:58:19</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41350151"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41348844">
          <h3>
            <a
              class="item"
              href="https://qsantos.fr/2024/08/25/linux-pipes-are-slow/"
              >Linux Pipes Are Slow</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 16:52:14</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41348844"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41348659">
          <h3>
            <a
              class="item"
              href="https://horovits.medium.com/lidl-is-taking-on-aws-the-age-of-eurocloud-b237258e3311"
              >Lidl's Cloud Gambit: Europe's Shift to Sovereign Computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 16:35:52</span
              ><span class="points-container"
                >Points: <span class="points">348</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41348659"
                  >Comments</a
                ><span class="descendants">: 297</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41348631">
          <h3>
            <a class="item" href="https://github.com/buffdb/buffdb"
              >BuffDB is a Rust library to simplify multi-plexing on edge
              devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 16:34:05</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41348631"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41348338">
          <h3>
            <a class="item" href="https://thomasw.dev/post/mac-floppy-emu/"
              >Emulating the Early Macintosh Floppy Drive</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 16:04:21</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41348338"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41348204">
          <h3>
            <a class="item" href="https://github.com/flxzt/rnote"
              >Rnote – Sketch and take handwritten notes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 15:51:11</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41348204"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41348000">
          <h3>
            <a
              class="item"
              href="https://www.shamusyoung.com/twentysidedtale/?p=141"
              >Programming terrain from scratch using C++ and OpenGL by Shamus
              Young (2006)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 15:32:00</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41348000"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41347697">
          <h3>
            <a
              class="item"
              href="https://www.emacswiki.org/emacs/WhyDoesElispSuck"
              >Why Does Elisp Suck</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 14:50:09</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41347697"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41347290">
          <h3>
            <a
              class="item"
              href="https://pillser.com/engineering/2024-08-25-speeding-up-your-website-using-cloudflare-cache"
              >Speeding Up Your Website Using Cloudflare Cache</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 13:48:08</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41347290"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41347016">
          <h3>
            <a class="item" href="https://www.strandbeest.com/">Strandbeest</a>
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 13:06:08</span
              ><span class="points-container"
                >Points: <span class="points">358</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41347016"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41346258">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/ev-battery-fires-explained/"
              >Electric vehicle battery fires–what to know and how to react</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 10:40:44</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41346258"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41338159">
          <h3>
            <a
              class="item"
              href="https://www.ijassjournal.com/2020/V3I6/4146575149.pdf"
              >The Calendar of Sound of Hermeto Pascoal (2020) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 13:29:32</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41338159"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41337301">
          <h3>
            <a
              class="item"
              href="https://moxie.org/2011/12/13/the-cryptographic-doom-principle.html"
              >The Cryptographic Doom Principle (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 11:16:57</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41337301"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41332011">
          <h3>
            <a class="item" href="https://github.com/nicolasgere/monogo"
              >Show HN: Monogo – Evolve your go workspace to a real monorepo</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 19:02:08</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41332011"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been working sporadically over the last six months on a go
                monorepo tool (0 config it just use go workspace and go
                convention). It’s basically like TurboRepo but without the task
                runner. The tool builds a dependency graph between packages,
                allowing you to do things similar to what you can do in
                TurboRepo, like "only test the packages and the packages that
                depend on them, compared to the main branch," or "only install
                dependencies for Package A and its dependencies," etc. I use
                native go tool to get dependencies and create dependency graph
                between the package.Nothing crazy but I feel it could be useful.
              </p>
            </div>
          </section>
        </section>
        <section id="41327566">
          <h3>
            <a
              class="item"
              href="https://news.ubisoft.com/en-us/article/62HpoWQkAIVogVkoVk8JuJ/heroes-of-might-and-magic-olden-era-unveiled-at-gamescom"
              >Heroes of Might and Magic: Olden Era Announced for 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 09:43:31</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41327566"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41326169">
          <h3>
            <a
              class="item"
              href="https://simonroses.com/2023/12/modern-wardriving/"
              >Modern Wardriving (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-23 @ 04:27:54</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41326169"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41314166">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2024/apr/05/ww2-hidden-bombs-clearing-disposal-pacific-marshall-islands-unexploded-ordnance-uxo"
              >How WW2 bombs across the Pacific are found and destroyed, decades
              after war</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 21:01:59</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41314166"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41310508">
          <h3>
            <a class="item" href="https://github.com/makeecat/Peng"
              >Peng – a minimal Rust-based quadrotor simulation pipeline</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 14:13:33</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41310508"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41310311">
          <h3>
            <a class="item" href="https://initialneil.github.io/DEGAS"
              >Degas: Detailed Expressions on Full-Body Gaussian Avatars</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 13:52:40</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41310311"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
