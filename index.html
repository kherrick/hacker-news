<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45366566">
          <h3>
            <a
              class="item"
              href="https://bitbytebit.substack.com/p/everything-thats-wrong-with-google"
              >Everything that's wrong with Google Search in one image</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 22:11:48</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45366566"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45366474">
          <h3>
            <a
              class="item"
              href="https://www.qualcomm.com/products/mobile/snapdragon/laptops-and-tablets/snapdragon-x2-elite"
              >Snapdragon X2 Elite ARM Laptop CPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 22:01:06</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45366474"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45365878">
          <h3>
            <a class="item" href="https://github.com/goudvuur/sonyshell"
              >SonyShell – an effort to "SSH into my Sony DSLR"</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 21:00:00</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45365878"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45365107">
          <h3>
            <a class="item" href="https://vassi.life/projects/diffinetune"
              >Diffusion Finetuning Myself</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 19:44:29</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45365107"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45364450">
          <h3>
            <a
              class="item"
              href="https://dgerrells.com/blog/how-fast-is-go-simulating-millions-of-particles-on-a-smart-tv"
              >How fast is Go? simulating particles on a smart TV</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 18:48:39</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45364450"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45362914">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45362914"
              >Launch HN: Flywheel (YC S25) – Waymo for Excavators</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 16:48:27</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362914"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
            <div class="text">
              <a href="https://useflywheel.ai">https://useflywheel.ai</a>).
              We’re building a remote teleop and autonomous stack for
              excavators.
              <p>
                Here's a video:
                <a href="https://www.youtube.com/watch?v=zCNmNm3lQGk"
                  >https://www.youtube.com/watch?v=zCNmNm3lQGk</a
                >.
              </p>
              <p>
                Interfacing with existing excavators for enabling remote teleop
                (or autonomy) is hard. Unlike cars which use drive-by-wire
                technology, most of the millions of excavators are fully
                hydraulic machines. The joysticks are connected to a pilot
                hydraulic circuit, which proportionally moves the cylinders in
                the main hydraulic circuit which ultimately moves the excavator
                joints. This means excavators mostly do not have an electronic
                component to control the joints. We solve this by mechanically
                actuating the joysticks and pedals inside the excavators.
              </p>
              <p>
                We do this with retrofits which work on any excavator
                model/make, enabling us to augment existing machines. By
                enabling remote teleoperation, we are able to increase site
                safety, productivity and also cost efficiency.
              </p>
              <p>
                Teleoperation by the operators enables us to prepare training
                data for autonomy. In robotics, training data comprises
                observation and action. While images and videos are abundant on
                the internet, egocentric (PoV) observation and action data is
                extremely scarce, and it is this scarcity that is holding back
                scaling robot learning policies.
              </p>
              <p>
                Flywheel solves this by preparing the training data coming from
                our remote teleop-enabled excavators which we have already
                deployed. And we do this with very minimal hardware setup and
                resources.
              </p>
              <p>
                During our time in YC, we did 25-30 iterations of sensor stack
                and placement permutations/combinations, and model hyperparams
                variations. We called this “evolution of the physical form of
                our retrofit”. Eventually, we landed on our current evolution
                and have successfully been able to train some levels of autonomy
                with only a few hours of training data.
              </p>
              <p>
                The big takeaway was how much more important data is than
                optimizing hyperparams of the model. So today, we’re open
                sourcing 100hrs of excavator dataset that we collected using
                Flywheel systems on real construction sites. This is in
                partnership with Frodobots.ai.
              </p>
              <p>
                Dataset:
                <a
                  href="https://huggingface.co/datasets/FlywheelAI/excavator-dataset"
                  >https://huggingface.co/datasets/FlywheelAI/excavator-dataset</a
                >
              </p>
              <p>Machine/retrofit details:</p>
              <p></p>
              <pre><code>  Volvo EC380 (38 ton excavator)
  4xcamera (25fps)
  25 hz expert operator’s action data
</code></pre>
              The dataset contains observation data from 4 cameras and
              operator's expert action data which can be used to train imitation
              learning models to run an excavator autonomously for the workflows
              in those demonstrations, like digging and dumping. We were able to
              train a small autonomy model for bucket pick and place on Kubota
              U17 from just 6-7 hours of data collected during YC.
              <p>
                We’re just getting started. We have good amounts of variations
                in daylight, weather, tasks, and would be adding more hours of
                data and also converting to lerobot format soon. We’re doing
                this so people like you and me can try out training models on
                real world data which is very, very hard to get.
              </p>
              <p>
                So please checkout the dataset here and feel free to download
                and use however you like. We would love for people to do things
                with it! I’ll be around in the thread and look forward to
                comments and feedback from the community!
              </p>
            </div>
          </section>
        </section>
        <section id="45362813">
          <h3>
            <a class="item" href="https://vb.lk/">Show HN: Vibe Linking</a>
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 16:40:11</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362813"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45362697">
          <h3>
            <a
              class="item"
              href="https://mathstodon.xyz/@tao/115259943398316677"
              >Terence Tao: The role of small organizations in society has
              shrunk significantly</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 16:32:24</span
              ><span class="points-container"
                >Points: <span class="points">612</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362697"
                  >Comments</a
                ><span class="descendants">: 348</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45362569">
          <h3>
            <a
              class="item"
              href="https://sedimental.org/product_hunt_is_dead.html"
              >Product Hunt is dead</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 16:23:33</span
              ><span class="points-container"
                >Points: <span class="points">240</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362569"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45362486">
          <h3>
            <a
              class="item"
              href="https://github.com/DeprecatedLuar/better-curl-saul"
              >Better Curl Saul: a lightweight API testing CLI focused on UX and
              simplicity</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 16:17:34</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362486"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45362425">
          <h3>
            <a
              class="item"
              href="https://zed.dev/blog/pricing-change-llm-usage-is-now-token-based"
              >Zed's Pricing Has Changed: LLM Usage Is Now Token-Based</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 16:13:49</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362425"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45362254">
          <h3>
            <a
              class="item"
              href="https://www.rockefeller.edu/news/38239-hundreds-of-new-bacteria-and-two-potential-antibiotics-found-in-soil/"
              >New bacteria, and two potential antibiotics, discovered in
              soil</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 16:03:42</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362254"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45362206">
          <h3>
            <a
              class="item"
              href="https://sedona.apache.org/latest/blog/2025/09/24/introducing-sedonadb-a-single-node-analytical-database-engine-with-geospatial-as-a-first-class-citizen/"
              >SedonaDB: A new geospatial DataFrame library written in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 16:00:45</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362206"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45362023">
          <h3>
            <a
              class="item"
              href="https://wasmer.io/posts/python-on-the-edge-powered-by-webassembly"
              >Python on the Edge: Fast, sandboxed, and powered by
              WebAssembly</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 15:48:36</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362023"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45361578">
          <h3>
            <a
              class="item"
              href="https://lukefleed.xyz/posts/compressed-fixedvec/"
              >Engineering a fixed-width bit-packed integer vector in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 15:17:08</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45361578"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45361344">
          <h3>
            <a
              class="item"
              href="https://plato.stanford.edu/entries/lambda-calculus/"
              >The Lambda Calculus (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 15:00:15</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45361344"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45360475">
          <h3>
            <a class="item" href="https://aartaka.me/select-text.html"
              >Just let me select text</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 13:56:37</span
              ><span class="points-container"
                >Points: <span class="points">685</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45360475"
                  >Comments</a
                ><span class="descendants">: 476</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45359604">
          <h3>
            <a
              class="item"
              href="https://idiallo.com/blog/how-to-lead-in-a-room-full-of-experts"
              >How to Lead in a Room Full of Experts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 12:52:52</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45359604"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45359524">
          <h3>
            <a
              class="item"
              href="https://cjauvin.github.io/posts/learning-persian/"
              >Learning Persian with Anki, ChatGPT and YouTube</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 12:45:07</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45359524"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45359074">
          <h3>
            <a
              class="item"
              href="https://github.com/eu-digital-identity-wallet/av-doc-technical-specification/issues/22"
              >EU age verification app not planning desktop support</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 11:52:50</span
              ><span class="points-container"
                >Points: <span class="points">428</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45359074"
                  >Comments</a
                ><span class="descendants">: 314</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45358980">
          <h3>
            <a class="item" href="https://github.com/yt-dlp/yt-dlp/issues/14404"
              >Yt-dlp: Upcoming new requirements for YouTube downloads</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 11:41:54</span
              ><span class="points-container"
                >Points: <span class="points">897</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45358980"
                  >Comments</a
                ><span class="descendants">: 443</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45358940">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cevz13xkxpro"
              >Huntington's disease treated for first time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 11:37:30</span
              ><span class="points-container"
                >Points: <span class="points">395</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45358940"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45358280">
          <h3>
            <a
              class="item"
              href="https://bigdata.2minutestreaming.com/p/how-aws-s3-scales-with-tens-of-millions-of-hard-drives"
              >How AWS S3 serves 1 petabyte per second on top of slow HDDs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 10:05:29</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45358280"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45357693">
          <h3>
            <a
              class="item"
              href="https://cybersect.substack.com/p/that-secret-service-sim-farm-story"
              >That Secret Service SIM farm story is bogus</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 08:24:20</span
              ><span class="points-container"
                >Points: <span class="points">971</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45357693"
                  >Comments</a
                ><span class="descendants">: 546</span></span
              >
            </h4>
            <div class="text">
              <i
                >Cache of devices capable of crashing cell network is found in
                NYC</i
              >
              - https://news.ycombinator.com/item?id=45345514 - Sept 2025 (283
              comments)
            </div>
          </section>
        </section>
        <section id="45338680">
          <h3>
            <a
              class="item"
              href="https://thecreativeindependent.com/people/bjork-on-nature-and-technology/"
              >Björk on nature and technology (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-22 @ 19:58:33</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45338680"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45325035">
          <h3>
            <a
              class="item"
              href="https://garrettdbates.com/driving-complex-decisions"
              >Driving Complex Decisions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-21 @ 17:51:34</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45325035"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45324324">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45324324"
              >Ask HN: Local hostnames without root/admin</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-21 @ 16:41:45</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45324324"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text"><p>Thankful for any suggestions.</p></div>
          </section>
        </section>
        <section id="45321893">
          <h3>
            <a
              class="item"
              href="https://andregarzia.com/2025/09/linkgraphs-are-fun.html"
              >Linkgraphs are fun</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-21 @ 11:45:39</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45321893"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45321849">
          <h3>
            <a class="item" href="https://idea-instructions.com/quick-sort/"
              >Quicksort explained IKEA-style</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-21 @ 11:35:21</span
              ><span class="points-container"
                >Points: <span class="points">270</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45321849"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45318604">
          <h3>
            <a class="item" href="https://underpassapp.com/news/2025/9/8.html"
              >macOS becomes iOS: Safari video controls</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-20 @ 23:38:02</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45318604"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
