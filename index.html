<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41745277">
          <h3>
            <a class="item" href="http://www.edm2.com/index.php/Microsoft_LISP"
              >Microsoft Lisp</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 20:28:50</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41745277"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41745032">
          <h3>
            <a
              class="item"
              href="https://retrocomputing.stackexchange.com/questions/30698/how-were-the-70s-versions-of-pong-and-similar-games-implemented-without-a-progra"
              >How were 70s versions of games like Pong built without a
              programmable computer?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 19:57:38</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41745032"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41744915">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/video-games/pc-gaming/civilization-vii-recommends-16-cores-and-32gb-ram-for-4k-gameplay-rtx-4070-or-rx-7800xt-is-the-minimum"
              >Civilization VII recommends 16 cores and 32GB RAM for 4K
              gameplay</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 19:43:13</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41744915"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41744774">
          <h3>
            <a class="item" href="https://againstdata.com"
              >Show HN: The Gmail unsubscribe tool with bulk deletion and
              personal data removal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 19:25:22</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41744774"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41743780">
          <h3>
            <a class="item" href="https://github.com/steelbrain/ffmpeg-over-ip"
              >Show HN: FFmpeg-over-IP – Connect to remote FFmpeg servers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 17:49:01</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41743780"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <p>
                I’m excited to show case a personal project. It has helped me
                quite a bit with my home lab, I hope it can help you with yours
                too! ffmpeg-over-ip has two components, a server and a client.
                You can run the server in an environment with access to a GPU
                and a locally installed version of ffmpeg, the client only needs
                network access to the server and no GPU or ffmpeg locally.
              </p>
              <p>
                Both and client and the server need a shared filesystem for this
                to work (so the server can write output to it, and client can
                read from it). In my usecase, smb works well if your (GPU)
                server is a windows machine, nfs works really well for linux
                setups.
              </p>
              <p>This utility can be useful in a number of scenarios:</p>
              <p>
                - You find passing through a (v)GPU to your virtual machines
                complicated
              </p>
              <p>
                - You want to use the same GPU for ffmpeg in multiple virtual
                machines
              </p>
              <p>
                - Your server has a weak GPU so you want to use the GPU from
                your gaming machine
              </p>
              <p>
                - Your GPU drivers in one OS are not as good as another (AMD
                RX6400 never worked for me in linux, but did so in windows)
              </p>
              <p>
                I’ve posted some instructions in the Github package README,
                please let me know if they are unclear in any way and I’ll try
                to help!
              </p>
              <p>
                Here's the link:
                <a href="https://github.com/steelbrain/ffmpeg-over-ip"
                  >https://github.com/steelbrain/ffmpeg-over-ip</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41743325">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/gym-class-by-irl-studios/jobs/BigNKT1-mobile-game-engineer-senior-staff-principal"
              >Gym Class (YC W22) – Hiring First Mobile Game Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 17:01:01</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41742432">
          <h3>
            <a class="item" href="https://isaak.net/mandarin/"
              >12 Months of Mandarin</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 15:28:51</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41742432"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41742278">
          <h3>
            <a class="item" href="https://onestack.dev"
              >Show HN: One – A new React framework unifying web, native and
              local-first</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 15:15:24</span
              ><span class="points-container"
                >Points: <span class="points">267</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41742278"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
            <div class="text">
              <p>
                One is a React framework that does two things differently in
                hopes of simplifying how we build websites and apps:
              </p>
              <p>
                1. It unifies React Native and React web with typed file system
                routing by making Vite able to serve RN. This lets you share (or
                diverge) your code in a simpler way for cross-platform apps.
              </p>
              <p>
                2. We've partnered with Zero (<a href="https://zerosync.dev"
                  >https://zerosync.dev</a
                >) to make local-first work well. We've been building a solution
                in One that makes Zero supporting server rendering, without
                waterfalls, and with seamless server/client handoff.
              </p>
              <p>---</p>
              <p>Honestly - I'm a bit hesitant to post One here.</p>
              <p>
                HN has really soured on frontend/frameworks. And I get it. We've
                collectively complicated the hell out of things.
              </p>
              <p>
                That's why I decided to build One. I loved Rails, it made me as
                a young developer able to finally realize way more ambitious
                projects than I'd ever done before. I also liked the promise
                (not implementation) of Meteor - it felt like the clear future,
                I guess just a bit too early (and a bit too scope-creeped).
              </p>
              <p>
                I worked at Uniswap and built Tamagui and so spent a lot of time
                building cross-platform apps that share code. Uniswap is built
                on Tamagui and I think proves you <i>can</i> make really high
                quality UX while sharing a lot of code - but it's insanely hard
                and requires a huge team. My goal with One is to make what is
                now possible but hard dramatically easier.
              </p>
              <p>
                And I think the path to there goes through local-first, because
                it makes building super responsive apps much, much simpler, and
                Zero is the first library to actually pull it off in a way that
                doesn't bloat your bundle or have very limiting constraints.
              </p>
              <p>
                I happened to live down the street from Aaron, one of the
                founders of Zero, in our tiny town in Hawaii. We talked a lot
                about Zero over the last couple years, and I found it really
                admirable how he consistently chose the "harder but better" path
                in building it. It really shaped into something incredible, and
                that convinced me to actually launch One, which at the time was
                more of an experiment.
              </p>
              <p>
                I can see a lot of potential criticism - do we need yet another
                framework, this is too shiny and vaporware-y, this is just more
                complexity and abstraction, etc. Happy to respond to those
                comments if they come.
              </p>
              <p>
                I'm just building out something that I've been wanting for a
                long time. Opinionated enough to let me move fast like Rails,
                but leaning on the great work of team Zero so that we don't end
                up with the scope creep of Meteor. And honestly, it's just
                really fun to hack on.
              </p>
            </div>
          </section>
        </section>
        <section id="41742210">
          <h3>
            <a
              class="item"
              href="https://aschmelyun.com/blog/getting-my-daily-news-from-a-dot-matrix-printer/"
              >Getting my daily news from a dot matrix printer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 15:08:42</span
              ><span class="points-container"
                >Points: <span class="points">413</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41742210"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41741848">
          <h3>
            <a
              class="item"
              href="https://www.pnas.org/doi/10.1073/pnas.2409062121"
              >Self-locking and stiffening deployable tubular structures</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 14:33:29</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41741848"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41741614">
          <h3>
            <a class="item" href="https://theor.xyz/esp32-love-notes-demoscene/"
              >ESP32: leaving love notes and entering demoscene territory
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 14:10:57</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41741614"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41741358">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/computer-scientists-combine-two-beautiful-proof-methods-20241004/"
              >Computer scientists combine two 'beautiful' proof methods</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 13:48:13</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41741358"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41741333">
          <h3>
            <a
              class="item"
              href="https://profmattstrassler.com/2024/10/01/why-is-the-speed-of-light-so-fast-part-1/"
              >Why Is Light So Fast?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 13:46:28</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41741333"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41741293">
          <h3>
            <a
              class="item"
              href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4960603"
              >Knowledge Growth and Specialization: Evidence from Oncologists</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 13:41:30</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41741293"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41740978">
          <h3>
            <a class="item" href="https://github.com/cnlohr/channel3"
              >ESP8266 Analog Broadcast Television Interface</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 13:04:45</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41740978"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41740965">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/research/movie-gen/?_fb_noscript=1"
              >Meta Movie Gen</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 13:03:00</span
              ><span class="points-container"
                >Points: <span class="points">650</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41740965"
                  >Comments</a
                ><span class="descendants">: 580</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41740915">
          <h3>
            <a class="item" href="https://github.com/ravachol/kew"
              >Show HN: kew – A Terminal Music Player for Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 12:56:54</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41740915"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
            <div class="text">
              <p>I created kew, a music player for the Linux terminal.</p>
              <p>
                This started when I asked myself: what if I could just type
                something like "play nirvana" in the terminal and have the rest
                taken care of automatically? That got the ball rolling and I
                kept adding stuff: covers in ascii and then as sixel images, a
                playlist view, a visualizer, a library view and finally search.
              </p>
              <p>
                While kew can be used as a commandline tool, it has evolved into
                a TUI app.
              </p>
              <p>Here are some example commands:</p>
              <p>kew nirvana # Plays all of your Nirvana songs, shuffled</p>
              <p>kew nevermind # Plays the "Nevermind" album in order</p>
              <p>kew spirit # Plays "Smells Like Teen Spirit"</p>
              <p>kew all # Plays all your music, shuffled</p>
              <p>
                kew albums # Plays one album after the other in random order
              </p>
              <p>
                It works best when your music library is organized like this:
                Artist/Album(s)/Track(s)
              </p>
              <p>kew is written in C and licensed under GPLv2.</p>
              <p>
                Source and screenshot:
                <a href="https://github.com/ravachol/kew"
                  >https://github.com/ravachol/kew</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41740568">
          <h3>
            <a class="item" href="https://stuffmatic.com/chebyshev/"
              >Show HN: Chebyshev approximation calculator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 12:09:18</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41740568"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <p>
                here's a web app I made that generates code for efficiently
                approximating mathematical functions. This is useful when
                performance matters more than perfect accuracy, for example in
                embedded systems.
              </p>
              <p>
                The app uses Chebyshev expansions, which despite their
                theoretical depth result in suprisingly compact and readable
                code in practice. This code is generated for you and using it
                does not require any knowledge of the underlying theory.
              </p>
              <p>
                Source code and more info:
                <a href="https://github.com/stuffmatic/chebyshev-calculator"
                  >https://github.com/stuffmatic/chebyshev-calculator</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41740134">
          <h3>
            <a class="item" href="https://tiniuc.com/chord-chart-memo/"
              >Show HN: A tool for creating chord charts on the go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 11:00:33</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41740134"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
            <div class="text">
              <p>
                Feel free to ask me anything about Chord Chart Memo, or my
                experience with Godot.
              </p>
            </div>
          </section>
        </section>
        <section id="41738552">
          <h3>
            <a class="item" href="https://nv1t.github.io/blog/kekz-headphones/"
              >Reverse engineering and dismantling Kekz headphones</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 06:55:58</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41738552"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41738502">
          <h3>
            <a
              class="item"
              href="https://szymonkaliski.com/projects/cartographist/"
              >Experimental web browser optimized for rabbit-holing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 06:47:57</span
              ><span class="points-container"
                >Points: <span class="points">483</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41738502"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41738434">
          <h3>
            <a
              class="item"
              href="https://www.independent.co.uk/life-style/blue-zones-netflix-ignobel-prize-b2622952.html"
              >New research says "blue zones" can be explained by flawed data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 06:32:44</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41738434"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41738022">
          <h3>
            <a class="item" href="https://github.com/apple/ml-depth-pro"
              >Depth Pro: Sharp monocular metric depth in less than a second</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 05:09:35</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41738022"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41736903">
          <h3>
            <a
              class="item"
              href="https://unix.stackexchange.com/questions/405783/why-does-man-print-gimme-gimme-gimme-at-0030"
              >Why does man print "gimme gimme gimme" at 00:30? (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 01:25:51</span
              ><span class="points-container"
                >Points: <span class="points">836</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41736903"
                  >Comments</a
                ><span class="descendants">: 355</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41735544">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/in-memoriam-oct-2024"
              >Robert Dennard, DRAM Pioneer, has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-03 @ 22:03:27</span
              ><span class="points-container"
                >Points: <span class="points">324</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41735544"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41732853">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2410.01201"
              >Were RNNs all we needed?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-03 @ 17:31:59</span
              ><span class="points-container"
                >Points: <span class="points">465</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41732853"
                  >Comments</a
                ><span class="descendants">: 243</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41730415">
          <h3>
            <a
              class="item"
              href="https://blog.cloudflare.com/patent-troll-sable-pays-up/"
              >Patent troll Sable pays up, dedicates all its patents to the
              public</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-03 @ 13:05:16</span
              ><span class="points-container"
                >Points: <span class="points">1274</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41730415"
                  >Comments</a
                ><span class="descendants">: 364</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41724158">
          <h3>
            <a class="item" href="https://czep.net/weblog/52cards.html"
              >52 Factorial</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-02 @ 19:22:10</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41724158"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41701864">
          <h3>
            <a
              class="item"
              href="https://www.historytoday.com/archive/feature/secrets-silk-road"
              >Manuscripts reveal the details of everyday life on the Silk
              Road</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 20:43:04</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41701864"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41697443">
          <h3>
            <a
              class="item"
              href="https://jack.wrenn.fyi/blog/safety-goggles-for-alchemists/"
              >Safety Goggles for Alchemists</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 14:25:03</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41697443"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
