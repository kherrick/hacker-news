<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41248208">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/cointracker/83a181d0-f08c-44ff-8b8c-e0ad3b7a89a1?utm_source=hackernews"
              >CoinTracker (YC W18) Is Hiring a Consumer Product Lead</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 17:00:54</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41248112">
          <h3>
            <a
              class="item"
              href="https://apnews.com/video/social-media-national-national-2a82183dc6804624bb49de45ed710a9d"
              >Mark Zuckerberg unveils giant Roman sculpture of his wife – AP
              News</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 16:51:00</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41248112"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41247806">
          <h3>
            <a class="item" href="https://github.com/Victor-Sava/LuminaPay"
              >An innovative cryptocurrency payment platform to provide payment
              solutions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 16:20:10</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41247806"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41247275">
          <h3>
            <a
              class="item"
              href="https://photonlines.substack.com/p/visual-data-structures-cheat-sheet"
              >Visual Data Structures Cheat-Sheet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 15:34:04</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41247275"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41247238">
          <h3>
            <a class="item" href="https://ianthehenry.com/posts/peggi/"
              >A Different Kind of Keyboard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 15:30:46</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41247238"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41247211">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41247211"
              >Launch HN: Promi (YC S24) – AI-powered ecommerce discounts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 15:28:43</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41247211"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.usepromi.com">https://www.usepromi.com</a>).
              Promi uses AI to optimize retail ecommerce discounts across
              products and customers (think new customer discounts, clearance
              sales, holiday sales, etc.).
              <p>
                Here’s a quick video overview:
                <a href="https://www.youtube.com/watch?v=SHTw9VH8bCw"
                  >https://www.youtube.com/watch?v=SHTw9VH8bCw</a
                >
              </p>
              <p>
                Discounts have traditionally been a bit of the ‘wild west’ of
                pricing. Optimization techniques at even the largest merchants
                are heavily manual. Product level discounting decisions are
                distributed among operations or category managers, and
                store-wide discounts are often set by marketers. Typically they
                rely on order history, look at competitor discounts, or find
                prior discount performance to inform their decision. But there’s
                not a lot of science behind choosing the discount, and teams
                don’t have the time or means to optimize it at a granular level
                - i.e. by product or customer groups.
              </p>
              <p>
                We believe AI can better solve this problem by setting the most
                appropriate discount value, varying that discount across
                products, and personalizing that discount across users in order
                to achieve various goals. AI models can leverage more data (e.g.
                item conversion rate, profit margin, customer referral URL,
                device type) and update more frequently than is realistically
                possible to do manually.
              </p>
              <p>
                Our approach will also allow us to generate discounts for
                relatively small merchants. We use models (layering traditional
                NLP models and custom LLMs) to build a large-scale knowledge
                graph to gather similar products across merchants in order to
                build profiles around different clusters of products. Those
                profiles help us build solutions catering towards subscale shops
                which traditionally do not have an optimal pricing strategy.
              </p>
              <p>
                Our first AI product focuses on liquidating inventory, and uses
                a store’s historic transaction and sales data to jump start
                training our model and generating discounts. Our model predicts
                the discount required to increase conversion rate by the proper
                amount to liquidate the inventory by the desired timeframe. We
                then monitor the conversion rate and (if we have statistical
                significance) make frequent adjustments as needed.
              </p>
              <p>
                We’ve got a full roadmap of new model approaches, including
                personalization and new objective functions (e.g. profit instead
                of liquidation) to fit more discount use cases.
              </p>
              <p>
                How we got here: Jiaxin and I are coming from Uber, where I led
                product for the discount team across Eats and Rides. We launched
                several analogous AI features at Uber and saw just how impactful
                they can be for structuring discounts. For example, we had
                issues with deploying our ML models for automated discounts in
                smaller markets because of the quantity of data required to
                train those models. We pivoted to a 'global model' that used
                data across countries to significantly reduce the amount of data
                required in any one country. That model performed even better
                than country-specific models, showing us that there were very
                reproduce-able trends in improving discount performance.
              </p>
              <p>
                If you run or know someone who runs a Shopify store, you can
                download and play around with our app here:
                <a href="https://apps.shopify.com/promi-discounts"
                  >https://apps.shopify.com/promi-discounts</a
                >
              </p>
              <p>
                We’d love feedback, thoughts on other use cases for discounts +
                AI, questions, etc. Looking forward to hearing from the
                community!
              </p>
            </div>
          </section>
        </section>
        <section id="41247193">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/OpenSSHPerSourcePenaltiesThings"
              >Some thoughts on OpenSSH 9.8's PerSourcePenalties feature</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 15:27:01</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41247193"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41247083">
          <h3>
            <a class="item" href="https://github.com/microsoft/kiota"
              >Kiota: OpenAPI-Based HTTP Client Code Generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 15:16:38</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41247083"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41247023">
          <h3>
            <a class="item" href="https://ytch.xyz"
              >Show HN: If YouTube had actual channels</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 15:10:06</span
              ><span class="points-container"
                >Points: <span class="points">504</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41247023"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41246211">
          <h3>
            <a class="item" href="https://github.com/sdushantha/tmpmail"
              >Tmpmail: Temporary email right from your terminal written in
              POSIX sh</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 14:03:42</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41246211"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41246204">
          <h3>
            <a
              class="item"
              href="https://stratechery.com/2024/integration-and-android/"
              >Integration and Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 14:02:44</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41246204"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41246181">
          <h3>
            <a class="item" href="https://github.com/project-oak/oak"
              >Project Oak by Google</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 14:00:55</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41246181"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41245901">
          <h3>
            <a
              class="item"
              href="https://medium.com/@polyglot_factotum/re-fixing-servos-event-loop-e00bdf267385"
              >Re-fixing Servo's event-loop</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 13:36:40</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41245901"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41244847">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/of-modes-and-men"
              >Larry Tesler pioneered cut-and-paste, the one-button mouse,
              WYSIWIG (2005)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 11:22:29</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41244847"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41244468">
          <h3>
            <a class="item" href="https://syndicate-lang.org/about/"
              >The Syndicated Actor Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 10:12:04</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41244468"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41244423">
          <h3>
            <a class="item" href="https://github.com/zuplo/rate-my-openapi"
              >Show HN: We made a tool to help developers improve OpenAPI
              specs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 10:03:32</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41244423"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                So we built a suite of tools to help with this called Rate My
                OpenAPI. It will score your OpenAPI document out of 100, as well
                as giving you individual scores in 4 key areas; completeness,
                SDK generation, security and documentation.
              </p>
              <p>
                Along with the score, you also get details of what the issues,
                or errors are, as well as guidance on what they actually mean
                and why they're important.
              </p>
              <p>
                We exposed the API for it using Zuplo, and then built a CLI, and
                a GitHub Action on top of that so that you can add Rate My
                OpenAPI into your workflow however you like.
              </p>
              <p>
                You can check it out and use all of this right now, for free.
                I've already found it extremely useful and I hope you do to.
              </p>
              <p>Feedback is absolutely welcome!</p>
            </div>
          </section>
        </section>
        <section id="41241942">
          <h3>
            <a class="item" href="https://leanrada.com/notes/sweep-and-prune/"
              >Sort, sweep, and prune: Collision detection algorithms</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-14 @ 02:19:17</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41241942"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41239800">
          <h3>
            <a
              class="item"
              href="https://arpa-h.gov/news-and-events/arpa-h-announces-awards-develop-novel-technologies-precise-tumor-removal"
              >ARPA-H announces awards to develop novel technologies for precise
              tumor removal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 21:00:10</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41239800"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41238102">
          <h3>
            <a
              class="item"
              href="https://www.usgs.gov/media/images/all-earths-water-a-single-sphere"
              >All of Earth's water in a single sphere (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 18:32:52</span
              ><span class="points-container"
                >Points: <span class="points">711</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41238102"
                  >Comments</a
                ><span class="descendants">: 264</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41236718">
          <h3>
            <a
              class="item"
              href="https://newscenter.lbl.gov/2024/08/12/dune-scientists-observe-first-neutrinos-with-prototype-detector-at-fermilab/"
              >Dune Scientists Observe First Neutrinos with Prototype Detector
              at Fermilab</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 16:02:57</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41236718"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41236273">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41236273"
              >Launch HN: Trellis (YC W24) – AI-powered workflows for
              unstructured data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 15:14:47</span
              ><span class="points-container"
                >Points: <span class="points">225</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41236273"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
            <div class="text">
              <a href="https://runtrellis.com/">https://runtrellis.com/</a>).
              We’re building AI-powered ETL for unstructured data. Trellis
              transforms phone calls, PDFs, and chats into structured SQL format
              based on any schema you define in natural language. This helps
              data and ops teams automate manual data entry and run SQL queries
              on messy data.
              <p>
                There’s a demo video at
                <a href="https://www.youtube.com/watch?v=ib3mRh2tnSo"
                  >https://www.youtube.com/watch?v=ib3mRh2tnSo</a
                >
                and a sandbox to try out (no sign-in required!) at
                <a href="https://demo.runtrellis.com/"
                  >https://demo.runtrellis.com/</a
                >. An interesting historical archive of unstructured data we
                thought it would be interesting to run Trellis on top of are old
                Enron emails which famously took months to review. We’ve created
                a showcase demo here:
                <a
                  href="https://demo.runtrellis.com/showcase/enron-email-analysis"
                  >https://demo.runtrellis.com/showcase/enron-email-analysis</a
                >, with some documentation here:
                <a
                  href="https://docs.runtrellis.com/docs/example-email-analytics"
                  >https://docs.runtrellis.com/docs/example-email-analytics</a
                >.
              </p>
              <p>
                Why we built this: At the Stanford AI lab where we met, we
                collaborated with many F500 data teams (including Amazon, Meta,
                and Standard Chartered), and repeatedly saw the same problem:
                80% of enterprise data is unstructured, and traditional
                platforms can’t handle it. For example, a major commercial bank
                I work with couldn’t improve credit risk models because critical
                data was stuck in PDFs and emails.
              </p>
              <p>
                We realized that our research from the AI lab could be turned
                into a solution with an abstraction layer that works as well for
                financial underwriting as it does for analysis of call center
                transcripts: an AI-powered ETL that takes in any unstructured
                data source and turns it into a schematically correct table.
              </p>
              <p>
                Some interesting technical challenges we had to tackle along the
                way: (1) Supporting complex documents out of the box: We use
                LLM-based map-reduce to handle long documents and vision models
                for table and layout extraction. (2) Model Routing: We select
                the best model for each transformation to optimize cost and
                speed. For instance, in data extraction tasks, we could leverage
                simpler fine-tuned models that are specialized in returning
                structured JSONs of financial tables. (3) Data Validation and
                Schema Guarantees: We ensure accuracy with reference links and
                anomaly detection.
              </p>
              <p>
                After launching Trellis, we’ve seen diverse use cases,
                especially in legacy industries where PDFs are treated as APIs.
                For example, financial services companies need to process
                complex documents like bonds and credit ratings into a
                structured format, and need to speed up underwriting and enable
                pass-through loan processing. Customer support and back-office
                operations need to accelerate onboarding by mapping documents
                across different schema and ERP systems, and ensure support
                agents follow SOPs (security questions, compliance disclosures,
                etc.). And many companies today want data preprocessing in ETL
                pipelines and data ingestion for RAG.
              </p>
              <p>
                We’d love your feedback! Try it out at
                <a href="https://demo.runtrellis.com/"
                  >https://demo.runtrellis.com/</a
                >. To save and track your large data transformations, you can
                visit our dashboard and create an account at
                <a href="https://dashboard.runtrellis.com/"
                  >https://dashboard.runtrellis.com/</a
                >. If you’re interested in integrating with our APIs, our quick
                start docs are here:
                <a href="https://docs.runtrellis.com/docs/getting-started"
                  >https://docs.runtrellis.com/docs/getting-started</a
                >. If you have any specific use cases in mind, we’d be happy to
                do a custom integration and onboarding—anything for HN. :)
              </p>
              <p>
                Excited to hear about your experience wrangling with
                unstructured data in the past, workflows you want to automate,
                and what data integration you would like to see.
              </p>
            </div>
          </section>
        </section>
        <section id="41234964">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-webb-telescope-further-deepens-the-biggest-controversy-in-cosmology-20240813/"
              >The Webb Telescope further deepens the Hubble tension controversy
              in cosmology</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 12:50:54</span
              ><span class="points-container"
                >Points: <span class="points">327</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41234964"
                  >Comments</a
                ><span class="descendants">: 321</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41227011">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/08/10/world/asia/worlds-oldest-calendar-gobekli-tepe.html"
              >Ancient calendar, recently discovered, may document a long-ago
              disaster</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 17:24:40</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41227011"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41226548">
          <h3>
            <a
              class="item"
              href="https://www.edgedb.com/blog/an-approach-to-optimizing-typescript-type-checking-performance#how-do-we-quantify-the-type-checker-s-workload"
              >An approach to optimizing TypeScript type checking performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 16:48:14</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41226548"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41224128">
          <h3>
            <a
              class="item"
              href="https://blog.yossarian.net/2024/08/12/Approximating-sum-types-in-Python-with-Pydantic"
              >Approximating sum types in Python with Pydantic</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 13:27:39</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41224128"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41222655">
          <h3>
            <a class="item" href="https://donydchen.github.io/mvsplat/"
              >MVSplat: Efficient 3D Gaussian Splatting from Sparse Multi-View
              Images</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 09:23:29</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41222655"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41222528">
          <h3>
            <a
              class="item"
              href="https://abuseofnotation.github.io/category-theory-illustrated/02_category/"
              >From Sets to Categories</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 09:01:28</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41222528"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41220549">
          <h3>
            <a class="item" href="https://eprint.iacr.org/2024/1265.pdf"
              >Safe curves for Elliptic Curve Cryptography [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 01:48:51</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41220549"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41217058">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=KgY6LQ46F5M"
              >Don't make your own game engine [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-11 @ 15:53:38</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41217058"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41207987">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2024/07/effs-concerns-about-un-draft-cybercrime-convention"
              >EFF’s concerns about the UN Cybercrime Convention</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 07:46:45</span
              ><span class="points-container"
                >Points: <span class="points">343</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41207987"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
