<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37594525">
          <h3>
            <a
              class="item"
              href="https://erlangforums.com/t/erlang-otp-26-1-released/2886"
              >Erlang/OTP 26.1 Released</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 07:56:14</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37594525"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37594461">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37594461"
              >Ask HN: I'm a SWE without a CS degree. Will online certs help me
              get into FAANG?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 07:48:23</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37594461"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <p>
                But I still don't think this is enough for me to make the move
                to FAANG or other tech companies unless I stay here for a long
                time to rack up experience (I only have 2 years SWE experience
                at this point). Also, as the org I work for is not a tech
                company, I'm not sure how seriously recruiters will take my time
                here.
              </p>
              <p>
                I've studied data structures and algorithms, and I think I am a
                decent programmer. I could probably progress quite quickly
                through CS50 or some other online course. I just don't know if
                it's beneficial.
              </p>
              <p>
                This topic online is full of misinformation and people just
                trying to sell you a course. So this seemed a good place to ask.
              </p>
              <p>I'm UK-based by the way.</p>
              <p>Thanks.</p>
            </div>
          </section>
        </section>
        <section id="37594377">
          <h3>
            <a
              class="item"
              href="https://defcon.social/@mysk/111097362983335713"
              >Philips Hue will soon force users to create an account</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 07:38:19</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37594377"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37594365">
          <h3>
            <a
              class="item"
              href="https://www.undeadly.org/cgi?action=article;sid=20230921073556"
              >OpenBSD/ARM64 on Hetzner Cloud</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 07:36:31</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37594365"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37593497">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41598-018-38461-y"
              >Total cholesterol and mortality by sex and age:study of 12.8M
              adults</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 05:23:42</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37593497"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37593459">
          <h3>
            <a
              class="item"
              href="https://christitus.com/install-windows-the-arch-linux-way/"
              >Install Windows the Arch Linux Way</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 05:15:25</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37593459"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37592934">
          <h3>
            <a
              class="item"
              href="https://blog.0x7d0.dev/history/how-equifax-was-breached-in-2017/"
              >How Equifax Was Breached in 2017</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 03:35:43</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37592934"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37592801">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/lattice-confinement-fusion"
              >NASAâ€™s New Shortcut to Fusion Power (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 03:09:57</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37592801"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37592712">
          <h3>
            <a class="item" href="https://hardfault.life/p/organic-maps-review"
              >Organic Maps: An open-source maps app that doesn't suck</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 02:54:09</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37592712"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37592699">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2023/09/today-uk-parliament-undermined-privacy-security-and-freedom-all-internet-users"
              >UK Parliament undermined the privacy, security, freedom of all
              internet users</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 02:51:08</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37592699"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37591652">
          <h3>
            <a
              class="item"
              href="https://web.math.princeton.edu/generals/tao_terence"
              >Terry Tao's generals (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-21 @ 00:00:28</span
              ><span class="points-container"
                >Points: <span class="points">214</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37591652"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37591050">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2023/09/linux-gives-up-on-6-year-lts-thats-fine-for-pcs-bad-for-android/"
              >Linux gives up on 6-year LTS kernels, says theyâ€™re too much
              work</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 22:36:20</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37591050"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37590881">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2309.06565"
              >Meticulous: An FPGA-Based Main Memory Emulator for System
              Software Studies</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 22:14:37</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37590881"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37588526">
          <h3>
            <a class="item" href="https://harlequin.sh/"
              >Harlequin: DuckDB IDE for the terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 19:02:43</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37588526"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37588286">
          <h3>
            <a
              class="item"
              href="https://github.com/Airsequel/Airsequel-Sheet-Music"
              >Show HN: Sheet Music Management App</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 18:47:36</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37588286"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37587791">
          <h3>
            <a
              class="item"
              href="https://news.liverpool.ac.uk/2023/09/20/archaeologists-discover-worlds-oldest-wooden-structure/"
              >Archaeologists discover oldest wooden structure</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 18:18:14</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37587791"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37587506">
          <h3>
            <a class="item" href="https://strada.hotwired.dev/"
              >Strada â€“ Create fully native controls, driven by your web app</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 18:00:26</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37587506"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37587233">
          <h3>
            <a
              class="item"
              href="https://jensrantil.github.io/posts/fast-aggregate-queries-on-dynamic-data/"
              >Fine-grained caching strategies of dynamic queries</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 17:42:24</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37587233"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37586681">
          <h3>
            <a class="item" href="https://manapool.com/"
              >Show HN: Mana Pool â€“ Market for Magic Cards</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 17:01:14</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37586681"
                  >Comments</a
                ><span class="descendants">: 136</span></span
              >
            </h4>
            <div class="text">
              <p>
                Like my last one, this project comes from one of my life's
                passions. I have played Magic: The Gathering for 30 years.
              </p>
              <p>
                My co-founders and I think Magic deserves its own market, and
                this thinking will lead to dozens of ways to make a great app.
                We consider what we have an MVP, and we are all going to
                MagicCon this weekend in Las Vegas to walk around in our Mana
                Pool shirts and talk to people about the future.
              </p>
              <p>
                If HN likes the site, I would appreciate you crashing it before
                we head out tomorrow night!
              </p>
              <p><a href="https://manapool.com/">https://manapool.com/</a></p>
            </div>
          </section>
        </section>
        <section id="37586518">
          <h3>
            <a class="item" href="https://github.com/goldsborough/clang-expand"
              >Clang-expand: Expand function invocations into current scope</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 16:48:01</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37586518"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37586264">
          <h3>
            <a
              class="item"
              href="https://www.tri.global/news/toyota-research-institute-unveils-breakthrough-teaching-robots-new-behaviors"
              >Toyota Research claims breakthrough in teaching robots new
              behaviors</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 16:30:14</span
              ><span class="points-container"
                >Points: <span class="points">343</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37586264"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37584399">
          <h3>
            <a
              class="item"
              href="http://www.cs.cmu.edu/~wkw/humour/carproblems.txt"
              >Car allergic to vanilla ice cream (2000)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 14:14:12</span
              ><span class="points-container"
                >Points: <span class="points">1393</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37584399"
                  >Comments</a
                ><span class="descendants">: 420</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37584049">
          <h3>
            <a class="item" href="https://electric-sql.com/"
              >Show HN: ElectricSQL, Postgres to SQLite active-active sync for
              local-first apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 13:46:55</span
              ><span class="points-container"
                >Points: <span class="points">544</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37584049"
                  >Comments</a
                ><span class="descendants">: 154</span></span
              >
            </h4>
            <div class="text">
              <p>
                We're really excited to be sharing ElectricSQL with you today.
                It's an open source, local-first sync layer that can be used to
                build reactive, realtime, offline-capable apps directly on
                Postgres with two way active-active sync to SQLite (including
                with WASM in the browser).
              </p>
              <p>
                Electric comprises a sync layer (built with Elixir) placed in
                front of your Postgres database and a type safe client that
                allows you to bidirectionally sync data from your Postgres to
                local SQLite databases. This sync is CRDT-based, resilient to
                conflicting edits from multiple nodes at the same time, and
                works after being offline for extended periods.
              </p>
              <p>Some good links to get started:</p>
              <p>
                - website:
                <a href="https://electric-sql.com">https://electric-sql.com</a>
              </p>
              <p>
                - docs:
                <a href="https://electric-sql.com/docs"
                  >https://electric-sql.com/docs</a
                >
              </p>
              <p>
                - code:
                <a href="https://github.com/electric-sql/electric"
                  >https://github.com/electric-sql/electric</a
                >
              </p>
              <p>
                - introducing post:
                <a
                  href="https://electric-sql.com/blog/2023/09/20/introducing-electricsql-v0.6"
                  >https://electric-sql.com/blog/2023/09/20/introducing-electri...</a
                >
              </p>
              <p>You can also see some demo applications:</p>
              <p>
                - Linear clone:
                <a href="https://linear-lite.electric-sql.com"
                  >https://linear-lite.electric-sql.com</a
                >
              </p>
              <p>
                - Realtime demo:
                <a href="https://electric-sql.com/docs/intro/multi-user"
                  >https://electric-sql.com/docs/intro/multi-user</a
                >
              </p>
              <p>
                - Conflict-free offline:
                <a href="https://electric-sql.com/docs/intro/offline"
                  >https://electric-sql.com/docs/intro/offline</a
                >
              </p>
              <p>
                The Electric team actually includes two of the inventors of
                CRDTs, Marc Shapiro and Nuno PreguiÃ§a, and a number of their
                collaborators who've pioneered a lot of tech underpinning
                local-first software. We are privileged to be building on their
                research and delighted to be surfacing so much work in a product
                you can now try out.
              </p>
            </div>
          </section>
        </section>
        <section id="37582632">
          <h3>
            <a
              class="item"
              href="https://developers.redhat.com/blog/2018/10/22/introduction-to-linux-interfaces-for-virtual-networking"
              >Introduction to Linux interfaces for virtual networking (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 10:48:36</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37582632"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37582599">
          <h3>
            <a
              class="item"
              href="https://iximiuz.com/en/posts/container-networking-is-simple/"
              >How Container Networking Works: Practical Explanation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 10:42:46</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37582599"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37581646">
          <h3>
            <a
              class="item"
              href="https://www.macarthur.me/posts/more-aggressive-cache-headers"
              >Cache headers could probably be more aggressive</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 08:01:44</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37581646"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37580981">
          <h3>
            <a
              class="item"
              href="http://peter.eisentraut.org/blog/2023/09/20/grouping-digits-in-sql"
              >Grouping digits in SQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 06:20:11</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37580981"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37580599">
          <h3>
            <a
              class="item"
              href="https://www.si.com/betting/2023/09/15/fake-indian-cricket-league-daily-cover"
              >Creating a fake Indian cricket league</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 05:15:42</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37580599"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37580498">
          <h3>
            <a
              class="item"
              href="https://dralun.wordpress.com/2023/02/17/the-health-risks-of-travel-in-early-modern-britain/"
              >Health risks of travel in early-modern Britain</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-20 @ 04:53:20</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37580498"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37576079">
          <h3>
            <a
              class="item"
              href="https://stephen.fm/how-to-evaluate-a-product-roadmap/"
              >How to evaluate a product roadmap, for engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-19 @ 20:30:16</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37576079"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
