<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40900648">
          <h3>
            <a
              class="item"
              href="http://jackkelly.name/blog/archives/2024/07/06/im_funding_ladybird_because_i_cant_fund_firefox/"
              >I'm Funding Ladybird Because I Can't Fund Firefox</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 21:38:52</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40900648"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40900417">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/continue/jobs/smcxRnM-full-stack-engineer"
              >Continue (YC S23) Is Hiring a Full-Stack Engineer in San
              Francisco</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 21:01:44</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899761">
          <h3>
            <a
              class="item"
              href="https://samkriss.substack.com/p/the-internet-is-already-over"
              >The internet is already over (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 19:17:56</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899761"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899673">
          <h3>
            <a class="item" href="https://imageprompt.io/"
              >Show HN: Imageprompt.io – AI-powered and human-curated artworks,
              logos, photos</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 19:03:30</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899673"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              ImagePrompt.io is a constantly growing collection of AI-generated
              content for artists, designers and everyone in need of great
              images. Includes stock photos for presentations and website,
              artworks for prints and wallpapers and logos for your next
              business.
            </div>
          </section>
        </section>
        <section id="40899507">
          <h3>
            <a class="item" href="https://github.com/szimek/sharedrop"
              >Sharedrop: Easy P2P file transfer powered by WebRTC – inspired by
              Apple AirDrop</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:35:46</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899507"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899487">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/technology-quarterly/2024/07/01/sometimes-the-old-ways-of-espionage-are-the-best"
              >Modern-day spying: sometimes old technology is more secure</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:32:57</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899487"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899411">
          <h3>
            <a
              class="item"
              href="https://royalsocietypublishing.org/doi/10.1098/rstb.2018.0372"
              >A brief history of liquid computers (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:21:11</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899411"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899393">
          <h3>
            <a
              class="item"
              href="http://www.righto.com/2024/07/pentium-standard-cells.html"
              >Standard cells: Looking at individual gates in the Pentium
              processor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:19:49</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899393"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899371">
          <h3>
            <a class="item" href="https://github.com/virtualsquare/vde-2"
              >VDEv2: Virtual Distributed Ethernet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:16:51</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899371"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899309">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2407.02678"
              >Reasoning in Large Language Models: A Geometric Perspective</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:09:25</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899309"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899281">
          <h3>
            <a class="item" href="https://hbr.org/2005/01/managing-oneself"
              >Managing Oneself (2005)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 18:04:38</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899281"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40899242">
          <h3>
            <a class="item" href="https://satyrn.app/"
              >Show HN: A modern Jupyter client for macOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 17:59:31</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40899242"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
            <div class="text">
              <p>
                It starts up really fast (faster time-to-execution than VS Code
                or JupyterLab), you can launch notebooks right from the Finder,
                and the design is super minimalist. It's got an OpenAI
                integration (use your own API key) for multi-cell generation
                with your notebook as context (I'll add other LLMs soon). And
                many more useful features like a virtual environment management
                UI, Black code formatting, and easy image/table copy buttons.
              </p>
              <p>
                Full disclosure: it's built with Electron. I originally wrote it
                in Swift but couldn't get the editor experience to where I
                wanted it. Now it supports autocomplete, multi-cursor editing,
                and moving the cursor between cells just like you'd expect from
                JupyterLab or VS Code.
              </p>
              <p>
                Satyrn sits on top of the jupyter-server, so it works with all
                your existing python kernels, Jupyter configuration, and ipynb
                files. It only works with local files at the moment, but I'm
                planning to extend it to support remote servers as well.
              </p>
              <p>
                I'm an indie developer, and I will try to monetize at some
                point, but it's free while in alpha. If you're interested,
                please try it out!
              </p>
              <p>
                I'd love your feedback in the comments, or you can contact me at
                jack-at-satyrn-dot-app.
              </p>
            </div>
          </section>
        </section>
        <section id="40898989">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-07-copper-methane-game-changer-mitigating.html"
              >Using copper to convert CO₂ to methane</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 17:22:12</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40898989"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40898844">
          <h3>
            <a
              class="item"
              href="https://wippler.dev/posts/synchronization-is-bad-for-scale"
              >Synchronization Is Bad for Scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 17:03:16</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40898844"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40898313">
          <h3>
            <a
              class="item"
              href="https://github.com/ElliotKillick/rss2newsletter"
              >Show HN: I made an open source Mailchimp RSS-to-Email
              alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 15:26:07</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40898313"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>
                The idea for this project came out of necessity, as I wanted to
                share my articles via email newsletter. I was looking for a
                super minimal, lightweight, and open source solution, and when
                none existed, I decided to create one.
              </p>
              <p>
                For any sizable number of email recipients, a popular platform
                like Mailchimp will easily cost you hundreds or even thousands
                per month in per-contact fees. rss2newsletter, on the other
                hand, allows you to use Amazon SES, so you can reach your
                audience at pennies on the dollar.
              </p>
              <p>
                Beyond these factors, I also wanted something that could run on
                an internet-connected potato it's so easy on your system and
                fully automated so you can set it and forget it.
              </p>
              <p>So, I created (and put under a free software license):</p>
              <p>
                <a href="https://github.com/ElliotKillick/rss2newsletter"
                  >https://github.com/ElliotKillick/rss2newsletter</a
                >
              </p>
              <p>
                rss2newsletter (integrating with Listmonk and Amazon SES for
                ultra-low-cost emails) is a drop-in solution that requires
                almost no setup besides connecting with SES and styling your
                emails. It's also competitive at what it does with proprietary
                self-hosted solutions like Sendy, which requires your system/VPS
                to have some rather beefy specs to run well.
              </p>
              <p>
                Let me know if there are any other features you would like to
                see. I hope you can find my project helpful to you!
              </p>
            </div>
          </section>
        </section>
        <section id="40898121">
          <h3>
            <a
              class="item"
              href="https://community.ams.org/journals/notices/201909/rnoti-p1471.pdf"
              >Talent Search versus Talent Development (2019) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 14:53:26</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40898121"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40897518">
          <h3>
            <a class="item" href="https://github.com/event-driven-io/Pongo"
              >Mongo but on Postgres and with strong consistency benefits</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 13:22:12</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40897518"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40897506">
          <h3>
            <a
              class="item"
              href="https://notes.eatonphil.com/2024-07-07-systems-meetups.html"
              >A reawakening of systems programming meetups</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 13:20:37</span
              ><span class="points-container"
                >Points: <span class="points">206</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40897506"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40897205">
          <h3>
            <a
              class="item"
              href="https://frontendmasters.com/blog/youtube-embeds-are-bananas-heavy-and-its-fixable/"
              >YouTube embeds are heavy and it’s fixable</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 12:37:55</span
              ><span class="points-container"
                >Points: <span class="points">264</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40897205"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40896873">
          <h3>
            <a class="item" href="https://github.com/sebastianwessel/quickjs"
              >Show HN: Execute JavaScript in a WebAssembly QuickJS sandbox</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 11:37:25</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40896873"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
            <div class="text">
              <p>Features</p>
              <p>
                - *Security*: Run untrusted JavaScript code in a safe, isolated
                environment.
              </p>
              <p>- *File System*: Can mount a virtual file system</p>
              <p>- *Custom Node Modules*: Custom node modules are mountable</p>
              <p>
                - *Fetch Client*: Can provide a fetch client to make http(s)
                calls
              </p>
              <p>
                - *Test-Runner*: Includes a test runner and chai based `expect`
              </p>
              <p>
                - *Performance*: Benefit from the lightweight and efficient
                QuickJS engine.
              </p>
              <p>
                - *Versatility*: Easily integrate with existing TypeScript
                projects.
              </p>
              <p>
                - *Simplicity*: User-friendly API for executing and managing
                JavaScript code in the sandbox.
              </p>
            </div>
          </section>
        </section>
        <section id="40895672">
          <h3>
            <a class="item" href="https://beacondb.net/"
              >Show HN: BeaconDB – An Alternative to Mozilla Location
              Services</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-07 @ 06:25:50</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40895672"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40892636">
          <h3>
            <a
              class="item"
              href="https://leancrew.com/all-this/2024/07/numeronymize/"
              >Numeronymize</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-06 @ 19:31:49</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40892636"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40892298">
          <h3>
            <a
              class="item"
              href="https://www.henrikkarlsson.xyz/p/writing-to-think"
              >How to think in writing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-06 @ 18:44:46</span
              ><span class="points-container"
                >Points: <span class="points">346</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40892298"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40890315">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2024/07/amazon-is-bricking-2350-astro-robots-10-months-after-release/"
              >Amazon is bricking $2,350 Astro robots 10 months after release</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-06 @ 13:23:13</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40890315"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40883466">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/climate-environment/interactive/2024/louisiana-sea-wall-gas-facility-flooding/"
              >A Louisiana gas plant sea wall shows challenges of flooding,
              energy demand</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-05 @ 15:13:10</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40883466"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40876840">
          <h3>
            <a class="item" href="https://github.com/KwaiVGI/LivePortrait"
              >LivePortrait: A fast, controllable portrait animation model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-04 @ 18:02:50</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40876840"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
            <div class="text">
              <p>
                Related Resources: - Homepage:
                <a href="https://liveportrait.github.io"
                  >https://liveportrait.github.io</a
                >
              </p>
              <p>
                - Paper:
                <a href="https://arxiv.org/abs/2407.03168"
                  >https://arxiv.org/abs/2407.03168</a
                >
              </p>
              <p>
                - Code:
                <a href="https://github.com/KwaiVGI/LivePortrait"
                  >https://github.com/KwaiVGI/LivePortrait</a
                >
              </p>
              <p>
                - Jupyter:
                <a href="https://github.com/camenduru/LivePortrait-jupyter"
                  >https://github.com/camenduru/LivePortrait-jupyter</a
                >
              </p>
              <p>
                - ComfyUI:
                <a href="https://github.com/kijai/ComfyUI-LivePortraitKJ"
                  >https://github.com/kijai/ComfyUI-LivePortraitKJ</a
                >
                and
                <a href="https://github.com/shadowcz007/comfyui-liveportrait"
                  >https://github.com/shadowcz007/comfyui-liveportrait</a
                >
              </p>
              <p>We hope you give it a try and enjoy!</p>
            </div>
          </section>
        </section>
        <section id="40870972">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/essay/wordsworth-donisthorpe-blackmail-and-the-first-motion-pictures/"
              >Wordsworth Donisthorpe, Blackmail, and the First Motion
              Pictures</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-03 @ 23:17:20</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40870972"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40867652">
          <h3>
            <a
              class="item"
              href="https://www.openculture.com/2024/06/how-the-18th-century-french-media-stoked-a-werewolf-panic.html"
              >The 18th-century French media stoked a werewolf panic</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-03 @ 16:39:34</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40867652"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40867585">
          <h3>
            <a class="item" href="https://alien-project.gitbook.io/docs"
              >Artificial LIfe ENvironment (ALIEN) is an artificial life
              simulation tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-03 @ 16:33:39</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40867585"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40866069">
          <h3>
            <a class="item" href="https://github.com/mathialo/bython"
              >Python with Braces</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-03 @ 14:05:30</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40866069"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
