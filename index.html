<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35562821">
          <h3>
            <a
              class="item"
              href="https://jina.ai/news/auto-gpt-unmasked-hype-hard-truths-production-pitfalls"
              >Auto-GPT Unmasked: The Hype and Hard Truths of Its Production
              Pitfalls</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 22:11:43</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35562821"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35562441">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2023/04/13/asia/japan-population-decline-record-drop-intl-hnk/index.html"
              >Japan’s population drops by half a million in 2022</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 21:38:44</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35562441"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35562353">
          <h3>
            <a class="item" href="https://pudding.cool/2023/03/same-name/"
              >A Map of Places in the US with the Same Name</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 21:31:47</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35562353"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35562230">
          <h3>
            <a class="item" href="https://consentomatic.au.dk/"
              >Consent-O-Matic: Automatic cookie management</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 21:22:40</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35562230"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561948">
          <h3>
            <a
              class="item"
              href="https://www.theparisreview.org/blog/2023/03/14/camuss-new-york-diary-1946/"
              >Camus's New York Diary (1946)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 20:56:02</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561948"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561824">
          <h3>
            <a
              class="item"
              href="https://www.commonwealmagazine.org/end-life-dreams"
              >End-of-Life Dreams</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 20:46:06</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561824"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561747">
          <h3>
            <a
              class="item"
              href="https://adamkdean.co.uk/posts/gpt-unicorn-a-daily-exploration-of-gpt-4s-image-generation-capabilities"
              >GPT Unicorn: A Daily Exploration of GPT-4's Image Generation
              Capabilities</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 20:40:25</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561747"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561485">
          <h3>
            <a
              class="item"
              href="https://ai.googleblog.com/2023/04/robotic-deep-rl-at-scale-sorting-waste.html"
              >Sorting waste and recyclables with a fleet of robots</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 20:15:48</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561485"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561203">
          <h3>
            <a class="item" href="https://fairanimateddrawings.com/site/home"
              >Animated Drawings</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 19:51:37</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561203"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35560577">
          <h3>
            <a
              class="item"
              href="https://www.ctrl.blog/entry/append-only-social.html"
              >Don’t record your social life on an append-only social network
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 19:10:18</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35560577"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35559925">
          <h3>
            <a
              class="item"
              href="https://fly.io/phoenix-files/elixir-and-rust-is-a-good-mix/"
              >Elixir and Rust is a good mix</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 18:29:04</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35559925"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35559646">
          <h3>
            <a class="item" href="https://tailscale.com/blog/more-throughput/"
              >Surpassing 10Gb/S over Tailscale</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 18:11:30</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35559646"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35559634">
          <h3>
            <a class="item" href="https://wevpn.com/">WeVPN Is Shutting Down</a>
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 18:10:50</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35559634"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35559145">
          <h3>
            <a
              class="item"
              href="https://www.washington.edu/news/2023/04/10/warm-liquid-spewing-from-oregon-seafloor-comes-from-cascadia-fault-could-offer-clues-to-earthquake-hazards/"
              >Warm liquid from Oregon seafloor comes from Cascadia fault</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 17:38:22</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35559145"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35559124">
          <h3>
            <a class="item" href="https://tailscale.dev/blog/darwin-spelunking"
              >Improving Tailscale via Apple’s open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 17:36:39</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35559124"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35559076">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/04/13/hackers-claim-vast-access-to-western-digital-systems/"
              >Hackers claim vast access to Western Digital systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 17:33:46</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35559076"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35558539">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/kraftful/jobs/"
              >Kraftful (YC S19) Hiring Back End Eng to Build an AI Co-Pilot for
              Product Folks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 17:02:14</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35558522">
          <h3>
            <a
              class="item"
              href="https://www.latent.space/p/segment-anything-roboflow#details"
              >Segment Anything Model and the hard problems of computer
              vision</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 17:01:24</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35558522"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35557630">
          <h3>
            <a
              class="item"
              href="https://nypost.com/2023/04/13/mary-quant-designer-who-invented-the-miniskirt-dead-at-93/"
              >Mary Quant, ’60s designer who invented the miniskirt, has died at
              93</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 16:07:45</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35557630"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35555481">
          <h3>
            <a
              class="item"
              href="https://sqrtminusone.xyz/posts/2023-04-13-emacs/"
              >916 Days of Emacs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 13:53:20</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35555481"
                  >Comments</a
                ><span class="descendants">: 195</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35555475">
          <h3>
            <a
              class="item"
              href="https://amitp.blogspot.com/2023/04/mac-keyboard-with-hidutil.html"
              >Mac Keyboard with Hidutil</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 13:53:11</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35555475"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35552804">
          <h3>
            <a
              class="item"
              href="http://seanolive.blogspot.com/2009/10/audios-circle-of-confusion.html"
              >Audio's Circle of Confusion (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 09:01:10</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35552804"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35552378">
          <h3>
            <a
              class="item"
              href="https://www.nvidia.com/en-us/geforce/news/rtx-remix-runtime-open-source-download/"
              >Nvidia RTX Remix Runtime Open Source Available Now</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 08:00:13</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35552378"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35550339">
          <h3>
            <a
              class="item"
              href="https://www.telesens.co/2017/07/17/calculating-position-from-raw-gps-data/"
              >Calculating Position from Raw GPS Data (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 02:58:59</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35550339"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35539476">
          <h3>
            <a class="item" href="https://beamanalytics.io/"
              >Show HN: Google Analytics alternative with the most generous free
              tier</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-12 @ 13:40:12</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35539476"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                As an indie hacker, the new Google Analytics (GA4) coming
                motivated me to look for a straightforward alternative that
                would also be affordable. I had a few basic product requirements
                and didn’t want to spend too much to replace a free product.
                There are a lot of great Google Analytics alternatives out
                there, but the pricing didn’t seem right. As someone who likes
                to just build things, many of which aren’t businesses yet, it
                didn’t make sense to pay for options like Plausible and Fathom
                out of the gate.
              </p>
              <p>
                So I joined with a friend to build Beam Analytics. Beam gives
                you all the standard web analytics. It also comes with easy to
                create funnels so you can see how users move through your site.
                And we have a great proxy for cohort retention that doesn’t need
                you to log any data with us. It’s cookie-less and GDPR
                compliant.
              </p>
              <p>
                The free tier is 100k page views per month so hopefully you’ll
                give it a try. There’s also a Wordpress integration to make
                integrating with WordPress sites as easy as a single click -
                <a href="https://wordpress.org/plugins/beam-analytics/"
                  >https://wordpress.org/plugins/beam-analytics/</a
                >.
              </p>
              <p>
                Appreciate your feedback. You can also email us at hi (at)
                beamanalytics.io or DM me on twitter @TheBuilderJR.
              </p>
            </div>
          </section>
        </section>
        <section id="35539348">
          <h3>
            <a
              class="item"
              href="https://www.laphamsquarterly.org/roundtable/rules-games-tudor-england"
              >How to play mumble-the-peg, mumchance, and hurling to the
              country</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-12 @ 13:31:03</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35539348"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35535081">
          <h3>
            <a
              class="item"
              href="https://www.nationalgeographic.com/travel/article/author-paul-theroux-rail-travel"
              >Paul Theroux reflects on the evolving nature of rail travel</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-12 @ 04:40:49</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35535081"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35527646">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41586-023-05751-z"
              >Lunar eclipses illuminate timing and climate impact of medieval
              volcanism</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-11 @ 16:42:39</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35527646"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35525877">
          <h3>
            <a
              class="item"
              href="https://psyche.co/ideas/a-life-of-splendid-uselessness-is-a-life-well-lived"
              >A life of splendid uselessness is a life well lived</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-11 @ 14:43:10</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35525877"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35510985">
          <h3>
            <a
              class="item"
              href="https://alwaysprocessing.blog/2022/02/20/size-matters"
              >Size Matters: An Exploration of Virtual Memory on iOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-10 @ 10:59:28</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35510985"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
