<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37650040">
          <h3>
            <a
              class="item"
              href="https://eclecticlight.co/2023/09/25/postscripts-sudden-death-in-sonoma/"
              >PostScriptâ€™s sudden death in Sonoma</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 20:20:55</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37650040"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37650021">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/07/13/climate/natural-gas-leaks-coal-climate-change.html"
              >Leaks Can Make Natural Gas as Bad for the Climate as Coal, a
              Study Says</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 20:19:32</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37650021"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37649841">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2023/09/pixel-8-leak-promises-7-years-of-os-updates-even-more-than-an-iphone/"
              >Pixel 8 leak promises 7 years of OS updates</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 20:07:43</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37649841"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37649811">
          <h3>
            <a class="item" href="https://github.com/bigcapitalhq/bigcapital"
              >Show HN: Bigcapital - A open-source alternative to QuickBooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 20:05:45</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37649811"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37649477">
          <h3>
            <a
              class="item"
              href="http://www.sweethome3d.com/blog/2018/12/10/customization_for_the_forensic_police.html"
              >Customization for the Forensic Police (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 19:42:53</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37649477"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37649448">
          <h3>
            <a class="item" href="https://www.dji.com/mini-4-pro"
              >DJI Mini 4 Pro</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 19:40:54</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37649448"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37649353">
          <h3>
            <a
              class="item"
              href="https://www.thedrive.com/the-war-zone/f-35a-has-flown-from-a-highway-for-the-first-time"
              >F-35A Has Flown from a Highway for the First Time</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 19:34:11</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37649353"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37649307">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2023/09/25/mixin_200m_heist/"
              >Mixin suspends deposits and withdrawals after $200M
              cryptocurrency heist</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 19:31:23</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37649307"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37648808">
          <h3>
            <a
              class="item"
              href="https://www.linuxfromscratch.org/lfs/view/stable/"
              >Linux from Scratch Version 12.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 18:56:58</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37648808"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37648560">
          <h3>
            <a class="item" href="https://openjdk.org/jeps/8314219"
              >JEP Draft: String Templates (Final)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 18:38:44</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37648560"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37648415">
          <h3>
            <a class="item" href="https://github.com/EscherMoore/DitchTheBell"
              >Show HN: DitchTheBell â€“Â Linux-based desktop notifier for RSS/Atom
              feeds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 18:28:13</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37648415"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>
                I developed this program because I wanted a single, centralized
                location to easily manage my desktop notifications for all of
                the various websites I want to get updates from. Before creating
                this application, I found existing solutions unsatisfactory due
                to the following reasons:
              </p>
              <p>
                - Built-In Notification Services: Some websites offer built-in
                desktop notification services, but these often require an
                account, staying signed in, and running a browser service worker
                continuously on your PC.
              </p>
              <p>
                - RSS Readers: While existing RSS readers with notification
                support provide a simple solution, these project balance
                numerous aspects of reader development. Notifications and their
                configurations are usually not the priority in these projects.
              </p>
              <p>
                - Custom Scripting: Implementing custom scripts using
                general-purpose notification tools like notify-send or
                GObject-Introspection is viable but becomes a maintenance
                headache as more granular control is introduced.
              </p>
              <p>
                These alternatives are sufficient for basic notifications but
                lack the lightweight nature and advanced configurability that
                power users desire. Ditch The Bell fills this gap, offering
                granular control over your RSS feed notifications without the
                limitations of the approaches mentioned above.
              </p>
              <p>
                Check it out!:
                <a href="https://github.com/EscherMoore/DitchTheBell"
                  >https://github.com/EscherMoore/DitchTheBell</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="37648098">
          <h3>
            <a class="item" href="https://github.com/byronka/minum"
              >Show HN: Minum â€“ A minimal Java web framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 18:07:24</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37648098"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
            <div class="text">
              <p>
                <a href="http://github.com/byronka/minum"
                  >http://github.com/byronka/minum</a
                >
              </p>
              <p>
                You will be hard-pressed to find another modern project as
                obsessively minimalistic. Other frameworks will claim simplicity
                and minimalism and then, casually, mention they are built on a
                multitude of libraries. This follows self-imposed constraints,
                predicated on a belief that smaller and lighter is long-term
                better.
              </p>
              <p>
                Caveat emptor: This is a project by and for developers who know
                and like programming (rather than, let us say, configuring). It
                is written in Java, and presumes familiarity with the HTTP/HTML
                paradigm.
              </p>
              <p>Driving paradigms of this project:</p>
              <p>
                * ease of use * maintainability / sustainability * simplicity *
                performance * good documentation * good testing
              </p>
              <p>It requires Java 21, for its virtual threads (Project Loom)</p>
            </div>
          </section>
        </section>
        <section id="37648068">
          <h3>
            <a class="item" href="http://farewell.bostonunitygroup.com/"
              >Unity's oldest community announces dissolution</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 18:05:07</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37648068"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37647053">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/dots-2/jobs"
              >Dots (YC S21) is hiring founding full-stack eningeers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 17:00:43</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37646964">
          <h3>
            <a class="item" href="https://www.fieggen.com/shoelace/"
              >Ian's Shoelace Site</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 16:55:54</span
              ><span class="points-container"
                >Points: <span class="points">294</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37646964"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37645945">
          <h3>
            <a
              class="item"
              href="http://sainthelenaisland.info/communications.htm"
              >Saint Helena Island Communications</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 15:55:44</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37645945"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37645160">
          <h3>
            <a
              class="item"
              href="https://rocket9labs.com/post/its-time-to-let-go-apache-software-foundation/"
              >Apache Open Office as an unmaintained project?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 15:12:26</span
              ><span class="points-container"
                >Points: <span class="points">257</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37645160"
                  >Comments</a
                ><span class="descendants">: 192</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37642671">
          <h3>
            <a
              class="item"
              href="https://github.com/davidhampgonsalves/life-dashboard"
              >Show HN: E-Ink Day Schedule</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 12:31:07</span
              ><span class="points-container"
                >Points: <span class="points">206</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37642671"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37642610">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Rhythm_0"
              >Rhythm 0</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 12:26:24</span
              ><span class="points-container"
                >Points: <span class="points">271</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37642610"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37642335">
          <h3>
            <a
              class="item"
              href="https://openai.com/blog/chatgpt-can-now-see-hear-and-speak"
              >We are beginning to roll out new voice and image capabilities in
              ChatGPT</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 11:57:28</span
              ><span class="points-container"
                >Points: <span class="points">909</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37642335"
                  >Comments</a
                ><span class="descendants">: 707</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37641628">
          <h3>
            <a class="item" href="https://antonz.org/sql-upsert/"
              >Upsert in SQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 10:29:35</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37641628"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37641393">
          <h3>
            <a
              class="item"
              href="https://www.thebignewsletter.com/p/how-to-hide-a-2-trillion-antitrust"
              >An analysis of the Google antitrust trial</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 09:44:19</span
              ><span class="points-container"
                >Points: <span class="points">285</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37641393"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37640643">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/2023/09/23/intels-ponte-vecchio-chiplets-gone-crazy/"
              >Intelâ€™s Ponte Vecchio: Chiplets Gone Crazy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 07:39:03</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37640643"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37640466">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/index/anthropic-amazon"
              >Amazon will invest up to $4B in Anthropic</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 07:07:44</span
              ><span class="points-container"
                >Points: <span class="points">469</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37640466"
                  >Comments</a
                ><span class="descendants">: 233</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37638328">
          <h3>
            <a
              class="item"
              href="https://blog.britishnewspaperarchive.co.uk/2023/09/21/understanding-the-open-air-schools-of-the-1900s/"
              >Open Air Schools of the 1900s</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 00:02:15</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37638328"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37630589">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/culture/2023/09/21/tiktok-is-changing-the-way-books-are-recommended-and-sold"
              >TikTok is changing the way books are recommended and sold</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 06:18:45</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37630589"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37630391">
          <h3>
            <a
              class="item"
              href="http://bitmath.blogspot.com/2023/09/permuting-bits-with-gf2p8affineqb.html"
              >Permuting Bits with GF2P8AFFINEQB</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-24 @ 05:35:02</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37630391"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37622512">
          <h3>
            <a class="item" href="https://csurgay.com/syggen/"
              >Show HN: Online oscilloscope with waveform generators</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-23 @ 12:03:52</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37622512"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37607597">
          <h3>
            <a
              class="item"
              href="https://ancientrecipes.wordpress.com/2015/05/18/678/"
              >The curious incident of the dog and the palm tree (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-22 @ 03:46:14</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37607597"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37607552">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Hoxne_Hoard"
              >Hoxne Hoard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-22 @ 03:38:02</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37607552"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
