<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46733009">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/news/articles/c0r44zpprg7o"
              >Tesla fined for repeatedly failing to help UK police over driving
              offences</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 14:38:14</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46733009"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46732213">
          <h3>
            <a class="item" href="https://radicle.xyz"
              >Radicle: The Sovereign Forge</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 13:25:42</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46732213"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46731996">
          <h3>
            <a
              class="item"
              href="https://tinyapps.org/blog/microsoft-mishandling-example-com.html"
              >Microsoft mishandling example.com</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 13:04:09</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46731996"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46731976">
          <h3>
            <a class="item" href="https://european-alternatives.eu"
              >European Alternatives</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 13:01:51</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46731976"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46731748">
          <h3>
            <a
              class="item"
              href="https://tuananh.net/2026/01/20/what-has-docker-become/"
              >What has Docker become?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 12:36:17</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46731748"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46731612">
          <h3>
            <a class="item" href="https://rubinmuseum.org/presence-in-death/"
              >Presence in Death</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 12:16:54</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46731612"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46731432">
          <h3>
            <a class="item" href="https://github.com/ramonvermeulen/whosthere"
              >Show HN: Whosthere: A LAN discovery tool with a modern TUI,
              written in Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 11:54:53</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46731432"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46730885">
          <h3>
            <a class="item" href="https://boginjr.com/it/sw/dev/vinyl-boot/"
              >Booting from a vinyl record (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 10:39:09</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46730885"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46730504">
          <h3>
            <a
              class="item"
              href="https://github.com/ghostty-org/ghostty/blob/main/AI_POLICY.md"
              >AI Usage Policy</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 09:50:26</span
              ><span class="points-container"
                >Points: <span class="points">360</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46730504"
                  >Comments</a
                ><span class="descendants">: 172</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46730436">
          <h3>
            <a
              class="item"
              href="https://programmablesearchengine.googleblog.com/2026/01/updates-to-our-web-search-products.html"
              >Updates to our web search products and Programmable Search Engine
              capabilities</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 09:38:02</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46730436"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46730346">
          <h3>
            <a
              class="item"
              href="https://stuff.interfree.ca/2026/01/05/ai-tts-for-screenreaders.html"
              >The state of modern AI text to speech systems for screen reader
              users</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 09:24:27</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46730346"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46730214">
          <h3>
            <a
              class="item"
              href="https://pgdog.dev/blog/replace-protobuf-with-rust"
              >Replacing Protobuf with Rust to go 5 times faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 09:03:31</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46730214"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46729368">
          <h3>
            <a class="item" href="https://dbushell.com/2026/01/22/proton-spam/"
              >Proton Spam and the AI Consent Problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 07:01:29</span
              ><span class="points-container"
                >Points: <span class="points">315</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46729368"
                  >Comments</a
                ><span class="descendants">: 205</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46728808">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=moBCOEiqiPs"
              >I built a light that reacts to radio waves [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 05:34:35</span
              ><span class="points-container"
                >Points: <span class="points">321</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46728808"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
            <div class="text">
              <a href="https://rootkid.me/works/spectrum-slit"
                >https://rootkid.me/works/spectrum-slit</a
              >
            </div>
          </section>
        </section>
        <section id="46728157">
          <h3>
            <a
              class="item"
              href="https://marcosmagueta.com/blog/the-lost-art-of-xml/"
              >The lost art of XML</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 03:45:15</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46728157"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46726857">
          <h3>
            <a
              class="item"
              href="https://www.leidenmedievalistsblog.nl/articles/why-medieval-city-builder-video-games-are-historically-inaccurate"
              >Why medieval city-builder video games are historically inaccurate
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 00:22:58</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46726857"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46725288">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/legal/transactional/capital-one-buy-fintech-firm-brex-515-billion-deal-2026-01-22/"
              >Capital One to acquire Brex for $5.15B</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-22 @ 21:23:12</span
              ><span class="points-container"
                >Points: <span class="points">338</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46725288"
                  >Comments</a
                ><span class="descendants">: 284</span></span
              >
            </h4>
            <div class="text">
              <a href="https://archive.md/vk8ov">https://archive.md/vk8ov</a>
              <p>
                Capitol One statement:
                <a
                  href="https://investor.capitalone.com/news-releases/news-release-details/capital-one-acquire-brex"
                  >https://investor.capitalone.com/news-releases/news-release-d...</a
                >
              </p>
              <p>
                Brex statement:
                <a
                  href="https://www.brex.com/journal/brex-and-capital-one-join-forces"
                  >https://www.brex.com/journal/brex-and-capital-one-join-force...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46723990">
          <h3>
            <a
              class="item"
              href="https://eieio.games/blog/ssh-sends-100-packets-per-keystroke/"
              >Why does SSH send 100 packets per keystroke?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-22 @ 19:27:32</span
              ><span class="points-container"
                >Points: <span class="points">572</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46723990"
                  >Comments</a
                ><span class="descendants">: 302</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46723384">
          <h3>
            <a
              class="item"
              href="https://hugodaniel.com/posts/claude-code-banned-me/"
              >I was banned from Claude for scaffolding a Claude.md file?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-22 @ 18:38:27</span
              ><span class="points-container"
                >Points: <span class="points">631</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46723384"
                  >Comments</a
                ><span class="descendants">: 555</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46721802">
          <h3>
            <a class="item" href="https://cannoneyed.com/isometric-nyc/"
              >Show HN: isometric.nyc – giant isometric pixel art map of NYC</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-22 @ 16:52:35</span
              ><span class="points-container"
                >Points: <span class="points">1114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46721802"
                  >Comments</a
                ><span class="descendants">: 207</span></span
              >
            </h4>
            <div class="text">
              <p>I didn't write a single line of code.</p>
              <p>
                Of course no-code doesn't mean no-engineering. This project took
                a lot more manual labor than I'd hoped!
              </p>
              <p>
                I wrote a deep dive on the workflow and some thoughts about the
                future of AI coding and creativity:
              </p>
              <p>
                <a href="http://cannoneyed.com/projects/isometric-nyc"
                  >http://cannoneyed.com/projects/isometric-nyc</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46720395">
          <h3>
            <a class="item" href="https://gptzero.me/news/neurips/"
              >GPTZero finds 100 new hallucinations in NeurIPS 2025 accepted
              papers</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-22 @ 15:20:48</span
              ><span class="points-container"
                >Points: <span class="points">895</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46720395"
                  >Comments</a
                ><span class="descendants">: 474</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46719229">
          <h3>
            <a class="item" href="https://qwen.ai/blog?id=qwen3tts-0115"
              >Qwen3-TTS family is now open sourced: Voice design, clone, and
              generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-22 @ 13:51:25</span
              ><span class="points-container"
                >Points: <span class="points">662</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46719229"
                  >Comments</a
                ><span class="descendants">: 206</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46719222">
          <h3>
            <a
              class="item"
              href="https://shreevatsa.net/post/douglas-adams-cultural-divide/"
              >Douglas Adams on the English–American cultural divide over
              "heroes"</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-22 @ 13:50:48</span
              ><span class="points-container"
                >Points: <span class="points">498</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46719222"
                  >Comments</a
                ><span class="descendants">: 502</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46708055">
          <h3>
            <a class="item" href="https://github.com/s2-streamstore/s2"
              >Show HN: S2-lite, an open source Stream Store</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 16:40:02</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46708055"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <a href="https://news.ycombinator.com/item?id=42480105"
                >https://news.ycombinator.com/item?id=42480105</a
              >). S2 started out as a serverless API — think S3, but for
              streams.
              <p>
                The idea of streams as a cloud storage primitive resonated with
                a lot of folks, but not having an open source option was a
                sticking point for adoption – especially from projects that were
                themselves open source! So we decided to build it:
                <a href="https://github.com/s2-streamstore/s2"
                  >https://github.com/s2-streamstore/s2</a
                >
              </p>
              <p>
                s2-lite is MIT-licensed, written in Rust, and uses SlateDB (<a
                  href="https://slatedb.io"
                  >https://slatedb.io</a
                >) as its storage engine. SlateDB is an embedded LSM-style
                key-value database on top of object storage, which made it a
                great match for delivering the same durability guarantees as
                s2.dev.
              </p>
              <p>
                You can specify a bucket and path to run against an object store
                like AWS S3 — or skip to run entirely in-memory. (This also
                makes it a great emulator for dev/test environments).
              </p>
              <p>
                Why not just open up the backend of our cloud service? s2.dev
                has a decoupled architecture with multiple components running in
                Kubernetes, including our own K8S operator – we made tradeoffs
                that optimize for operation of a thoroughly multi-tenant cloud
                infra SaaS. With s2-lite, our goal was to ship something dead
                simple to operate. There is a lot of shared code between the two
                that now lives in the OSS repo.
              </p>
              <p>
                A few features remain (notably deletion of resources and
                records), but s2-lite is substantially ready. Try the Quickstart
                in the README to stream Star Wars using the s2 CLI!
              </p>
              <p>
                The key difference between S2 vs a Kafka or Redis Streams:
                supporting tons of durable streams. I have blogged about the
                landscape in the context of agent sessions (<a
                  href="https://s2.dev/blog/agent-sessions#landscape"
                  >https://s2.dev/blog/agent-sessions#landscape</a
                >). Kafka and NATS Jetstream treat streams as provisioned
                resources, and the protocols/implementations are oriented around
                such assumptions. Redis Streams and NATS allow for larger
                numbers of streams, but without proper durability.
              </p>
              <p>
                The cloud service is completely elastic, but you can also get
                pretty far with lite despite it being a single-node binary that
                needs to be scaled vertically. Streams in lite are "just keys"
                in SlateDB, and cloud object storage is bottomless – although of
                course there is metadata overhead.
              </p>
              <p>
                One thing I am excited to improve in s2-lite is pipelining of
                writes for performance (already supported behind a knob, but
                needs upstream interface changes for safety). It's a technique
                we use extensively in s2.dev. Essentially when you are dealing
                with high latencies like S3, you want to keep data flowing
                throughout the pipe between client and storage, rather than go
                lock-step where you first wait for an acknowledgment and then
                issue another write. This is why S2 has a session protocol over
                HTTP/2, in addition to stateless REST.
              </p>
              <p>
                You can test throughput/latency for lite yourself using the `s2
                bench` CLI command. The main factors are: your network quality
                to the storage bucket region, the latency characteristics of the
                remote store, SlateDB's flush interval
                (`SL8_FLUSH_INTERVAL=..ms`), and whether pipelining is enabled
                (`S2LITE_PIPELINE=true` to taste the future).
              </p>
              <p>
                I'll be here to get thoughts and feedback, and answer any
                questions!
              </p>
            </div>
          </section>
        </section>
        <section id="46687603">
          <h3>
            <a class="item" href="https://anaghmalik.com/FlyingWithPhotons/"
              >Flying with Photons: Rendering Novel Views of Propagating
              Light</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 03:28:01</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46687603"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46686402">
          <h3>
            <a
              class="item"
              href="https://kconner.com/2024/08/02/ai-is-a-horse.html"
              >AI is a horse (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 00:20:54</span
              ><span class="points-container"
                >Points: <span class="points">228</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46686402"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46676629">
          <h3>
            <a
              class="item"
              href="https://www.toolofthought.com/posts/variation-on-iota"
              >Variation on Iota</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-19 @ 09:09:40</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46676629"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46673216">
          <h3>
            <a
              class="item"
              href="https://bumbershootsoft.wordpress.com/2026/01/17/ti-99-4a-leaning-more-heavily-on-the-firmware/"
              >TI-99/4A: Leaning More on the Firmware</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-18 @ 23:19:19</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46673216"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46672713">
          <h3>
            <a
              class="item"
              href="https://rselbach.com/your-sub-is-now-my-weekend-project"
              >Your app subscription is now my weekend project</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-18 @ 22:16:43</span
              ><span class="points-container"
                >Points: <span class="points">467</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46672713"
                  >Comments</a
                ><span class="descendants">: 324</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46668247">
          <h3>
            <a
              class="item"
              href="https://www.aljazeera.com/features/2026/1/18/the-cleaner-one-womans-mission-to-help-britains-hoarders"
              >The cleaner: One woman’s mission to help Britain’s hoarders</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-18 @ 14:55:12</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46668247"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
