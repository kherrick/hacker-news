<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42998370">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/2025/feb/10/euclid-telescope-captures-einstein-ring-revealing-warping-of-space"
              >Euclid telescope captures Einstein ring revealing warping of
              space</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-10 @ 09:14:38</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42998370"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42998061">
          <h3>
            <a
              class="item"
              href="https://fosdem.org/2025/schedule/event/fosdem-2025-5356-the-state-of-rust-trying-to-catch-up-with-ada/"
              >FOSDEM 2025: The state of Rust trying to catch up with Ada
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-10 @ 08:30:54</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42998061"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42998024">
          <h3>
            <a
              class="item"
              href="https://www.myteslaexperience.com/2025-02-01/to-buy-a-tesla-mode-3-only-to-end-up-in-hell"
              >To buy a Tesla Model 3, only to end up in hell</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-10 @ 08:25:13</span
              ><span class="points-container"
                >Points: <span class="points">294</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42998024"
                  >Comments</a
                ><span class="descendants">: 329</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42997647">
          <h3>
            <a
              class="item"
              href="https://www.mnot.net/blog/2025/02/09/decentralize-icloud"
              >Apple's Best Option: Decentralize iCloud</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-10 @ 07:03:57</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42997647"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42997340">
          <h3>
            <a
              class="item"
              href="https://anfalmushtaq.com/articles/deep-dive-into-llms-like-chatgpt-tldr"
              >TL;DR of Deep Dive into LLMs Like ChatGPT by Andrej Karpathy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-10 @ 05:56:05</span
              ><span class="points-container"
                >Points: <span class="points">225</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42997340"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42996831">
          <h3>
            <a
              class="item"
              href="https://ajxs.me/blog/How_Does_Adas_Memory_Safety_Compare_Against_Rust.html"
              >How does Ada's memory safety compare against Rust?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-10 @ 04:07:32</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42996831"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42996796">
          <h3>
            <a class="item" href="https://selix.net/notes/dont-be-frupid"
              >Don't Be Frupid</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-10 @ 04:01:36</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42996796"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42996671">
          <h3>
            <a
              class="item"
              href="https://www.ncregister.com/blog/face-of-aquinas-revealed-after-750-years"
              >Thomas Aquinas' skull reveals appearance and cause of death</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-10 @ 03:38:29</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42996671"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42994440">
          <h3>
            <a class="item" href="https://booksearch.party/"
              >Show HN: Searchable library of free audiobooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 21:52:33</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42994440"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              <p>
                At the moment, I've included audiobooks from popular sources
                like Librivox, Project Gutenberg, and Lit2Go.
              </p>
              <p>
                I'm open to suggestions on additional free audiobook sources I
                could integrate into the site to expand the collection!
              </p>
            </div>
          </section>
        </section>
        <section id="42993755">
          <h3>
            <a
              class="item"
              href="https://onmilwaukee.com/articles/recombobulationsigns"
              >The Recombobulation Area (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 20:44:09</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42993755"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42993490">
          <h3>
            <a
              class="item"
              href="https://blog.rybarix.com/2025/02/09/noaidecember.html"
              >No AI December Reflections</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 20:17:41</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42993490"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42993044">
          <h3>
            <a class="item" href="https://osmcal.org/"
              >OpenStreetMap Calendar</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 19:32:57</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42993044"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42992336">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2502.01584"
              >PhD Knowledge Not Required: A Reasoning Challenge for Large
              Language Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 18:14:01</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42992336"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42992159">
          <h3>
            <a
              class="item"
              href="https://andysblog.uk/why-blog-if-nobody-reads-it/"
              >Why blog if nobody reads it?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 17:50:10</span
              ><span class="points-container"
                >Points: <span class="points">610</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42992159"
                  >Comments</a
                ><span class="descendants">: 279</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42991676">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2502.03387"
              >LIMO: Less Is More for Reasoning</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 16:33:28</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42991676"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42991558">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/advanced-magnet-manufacturing-in-us"
              >Advanced Magnet Manufacturing Begins in the United States</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 16:17:01</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42991558"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42990546">
          <h3>
            <a
              class="item"
              href="https://www.ilograph.com/blog/posts/diagram-mistakes/"
              >Common mistakes in architecture diagrams (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 13:29:01</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42990546"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42990324">
          <h3>
            <a
              class="item"
              href="https://iquilezles.org/articles/gpuconditionals/"
              >Don't "optimize" conditional moves in shaders with
              mix()+step()</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 12:42:54</span
              ><span class="points-container"
                >Points: <span class="points">350</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42990324"
                  >Comments</a
                ><span class="descendants">: 174</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42989609">
          <h3>
            <a
              class="item"
              href="https://asteriskmag.com/issues/08/chimes-at-midnight"
              >Chimes at Midnight (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 09:45:57</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42989609"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42989320">
          <h3>
            <a class="item" href="https://thebullshitmachines.com"
              >Modern-Day Oracles or Bullshit Machines? How to thrive in a
              ChatGPT world</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-09 @ 08:24:17</span
              ><span class="points-container"
                >Points: <span class="points">689</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42989320"
                  >Comments</a
                ><span class="descendants">: 391</span></span
              >
            </h4>
            <div class="text">
              <p>
                <a href="https://thebullshitmachines.com"
                  >https://thebullshitmachines.com</a
                >
              </p>
              <p>
                This is not a computer science course; it’s a humanities course
                about how to learn and work and thrive in an AI world. Neither
                instructor nor students need a technical background. Our
                instructor guide provides a choice of activities for each lesson
                that will easily fill an hour-long class.
              </p>
              <p>
                The entire course is available freely online. Our 18 online
                lessons each take 5-10 minutes; each illuminates one core
                principle. They are suitable for self-study, but have been
                tailored for teaching in a flipped classroom.
              </p>
              <p>
                The course is a sequel of sorts to our course (and book) Calling
                Bullshit. We hope that like its predecessor, it will be widely
                adopted worldwide.
              </p>
              <p>
                Large language models are both powerful tools, and mindless—even
                dangerous—bullshit machines. We want students to explore how to
                resolve this dialectic. Our viewpoint is cautious, but not
                deflationary. We marvel at what LLMs can do and how amazing they
                can seem at times—but we also recognize the huge potential for
                abuse, we chafe at the excessive hype around their capabilities,
                and we worry about how they will change society. We don't think
                lecturing at students about right and wrong works nearly as well
                as letting students explore these issues for themselves, and the
                design of our course reflects this.
              </p>
            </div>
          </section>
        </section>
        <section id="42985342">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-01-rwandan-scientists-local-yeast-banana.html"
              >Rwandan scientists develop local yeast for banana wine-makers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 19:09:21</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42985342"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42981756">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2025/02/teen-on-musks-doge-team-graduated-from-the-com/"
              >Teen on Musk's DOGE team graduated from 'The Com'</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 09:34:24</span
              ><span class="points-container"
                >Points: <span class="points">1254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42981756"
                  >Comments</a
                ><span class="descendants">: 1258</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42974278">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2025/02/05/science/lunar-grand-canyons-far-side-moon/index.html"
              >Two Grand Canyon-size valleys on far side of the moon formed
              within 10 minutes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 16:10:46</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42974278"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42973049">
          <h3>
            <a
              class="item"
              href="https://www.unsw.edu.au/newsroom/news/2025/01/mapping-antarcticas-hidden-ice-free-lands-a-blueprint-for-conservation"
              >Mapping Antarctica’s hidden ice-free lands: a blueprint for
              conservation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 14:37:46</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42973049"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42971442">
          <h3>
            <a
              class="item"
              href="https://andrewchen.substack.com/p/revenge-of-the-gpt-wrappers-defensibility"
              >Revenge of the GPT Wrappers: Defensibility in a world of
              commoditized AI models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 11:25:19</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42971442"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42969154">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-02-invisible-electric-wire-electricity.html"
              >Guiding Electricity with Sound</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 03:49:32</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42969154"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42967633">
          <h3>
            <a class="item" href="https://github.com/microsoft/verona-sandbox"
              >Library Sandboxing for Verona</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 23:40:13</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42967633"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42962394">
          <h3>
            <a
              class="item"
              href="https://twitter.com/abhi9u/status/1887010136155414602"
              >Douglas McIlroy responds to Unix spell article with new
              implementation details</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 14:03:39</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42962394"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://blog.codingconfessions.com/p/how-unix-spell-ran-in-64kb-ram"
                >https://blog.codingconfessions.com/p/how-unix-spell-ran-in-6...</a
              >.
              <p>
                This reached Doug, who then responded to it with the follow up
                work he did which wasn't published anywhere.
              </p>
            </div>
          </section>
        </section>
        <section id="42961684">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-025-00282-1"
              >Out of Africa: celebrating 100 years of human-origins research</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 12:23:10</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42961684"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42959824">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2025/02/05/some-terminal-frustrations/"
              >Some terminal frustrations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 06:59:20</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42959824"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
