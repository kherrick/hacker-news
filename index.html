<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45827661">
          <h3>
            <a
              class="item"
              href="https://int10h.org/blog/2025/11/lost-ibm-at-model-bios-analysis/"
              >A Lost IBM PC/at Model? Analyzing a Newfound Old Bios</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 20:40:39</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45827661"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45827190">
          <h3>
            <a
              class="item"
              href="https://climatedrift.substack.com/p/why-solarpunk-is-already-happening"
              >Solarpunk is already happening in Africa</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 20:00:40</span
              ><span class="points-container"
                >Points: <span class="points">228</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45827190"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45826995">
          <h3>
            <a
              class="item"
              href="https://www.nottingham.ac.uk/news/new-gel-restores-dental-enamel-and-could-revolutionise-tooth-repair"
              >New gel restores dental enamel and could revolutionise tooth
              repair</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 19:44:49</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45826995"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45826500">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2025/11/the-internet-archive-survived-major-copyright-losses-whats-next/"
              >Internet Archive's legal fights are over, but its founder mourns
              what was lost</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 18:59:39</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45826500"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45826348">
          <h3>
            <a
              class="item"
              href="https://shnatsel.medium.com/the-state-of-simd-in-rust-in-2025-32c263e5f53d"
              >The state of SIMD in Rust in 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 18:45:57</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45826348"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45826266">
          <h3>
            <a class="item" href="https://github.com/dillo-browser/dillo"
              >Dillo, a multi-platform graphical web browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 18:40:32</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45826266"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45825965">
          <h3>
            <a
              class="item"
              href="https://www.ctvnews.ca/sci-tech/article/openai-updates-policies-so-chatgpt-wont-provide-medical-or-legal-advice/"
              >ChatGPT terms disallow its use in providing legal and medical
              advice to others</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 18:11:16</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45825965"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45824864">
          <h3>
            <a
              class="item"
              href="https://www.theseedsofscience.pub/p/why-arent-smart-people-happier"
              >Why aren't smart people happier?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 16:32:43</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45824864"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45824658">
          <h3>
            <a
              class="item"
              href="https://scandasia.com/norway-reviews-cybersecurity-after-hidden-remote-access-feature-found-in-chinese-buses/"
              >Norway reviews cybersecurity after remote-access feature found in
              Chinese buses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 16:18:01</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45824658"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45823831">
          <h3>
            <a
              class="item"
              href="https://noelrappin.com/blog/2025/11/ruby-and-its-neighbors-smalltalk/"
              >Ruby and Its Neighbors: Smalltalk</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 15:24:35</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45823831"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45823234">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45823234"
              >Ask HN: My family business runs on a 1993-era text-based-UI
              (TUI). Anybody else?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 14:29:49</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45823234"
                  >Comments</a
                ><span class="descendants">: 228</span></span
              >
            </h4>
            <div class="text">
              <p>
                My family company is a wholesale distribution firm (with
                lightweight manufacturing) and has been using the same TUI
                application (on prem unix box) since 1993. We use it for
                customer management, ordering, invoicing, kit management/build
                tickets, financials - everything. We've transitioned from green
                screen terminals to modern emulators, but the core system
                remains. I spent many summers running serial and ethernet
                cables.
              </p>
              <p>
                I left the business years ago to become a full time software
                engineer, but I got my start as a script kiddie writing
                automations for this system with Microsoft Access, VBA, and
                SendKeys to automate data entry. Amazingly, they still have a
                Windows XP machine running many of those tasks I wrote back in
                2004! It's brittle, but cumulatively has probably saved years of
                time. That XP machine could survive a nuclear winter lol.
              </p>
              <p>
                I recently stepped back in to help my parents and spent a day
                converting many of those old scripts to a more modern system
                (with actual error-handling instead of strategic sleep()s and
                prayers) using Python and telnetlib3. I had a blast and still
                love this application. I can fly around in it. Training new
                people was always a pain, but for those that got it—they had
                super powers.
              </p>
              <p>
                This got me thinking: Are other companies still using this type
                of interface to drive their core operations? I’m reflecting on
                whether the only reason my family's business still uses this
                system is because of the efficiency hacks I put in place 20+
                years ago. Without them, would they have been forced to switch
                to a modern cloud/GUI system? I’m not sure if I’m blinded by
                nostalgia or if this application is truly as wonderful as I
                remember it.
              </p>
              <p>
                I’d love to hear if and how these are still being utilized in
                the real world.
              </p>
              <p>
                P.S. The system we use was originally sold by ADP and has had
                different names (D2K, Prophet21). I believe Epicor owns it now
                (Activant before).
              </p>
              <p>
                P.P.S. Is anybody migrating their old TUI automation scripts to
                a more modern framework or creating new ones? I’m super curious
                to compare notes and see what other people are doing.
              </p>
            </div>
          </section>
        </section>
        <section id="45823186">
          <h3>
            <a class="item" href="https://www.caricecars.com/"
              >Carice TC2 – A non-digital electric car</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 14:25:36</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45823186"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45823141">
          <h3>
            <a
              class="item"
              href="https://gods.art/articles/equation_shadows.html"
              >The shadows lurking in the equations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 14:21:13</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45823141"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45823059">
          <h3>
            <a
              class="item"
              href="https://developer.chrome.com/docs/web-platform/deprecating-xslt"
              >Removing XSLT for a more secure browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 14:14:23</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45823059"
                  >Comments</a
                ><span class="descendants">: 225</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45822982">
          <h3>
            <a
              class="item"
              href="https://seemann.io/posts/2024-10-26---p2p-quic/"
              >A P2P Vision for QUIC (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 14:06:22</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45822982"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45822539">
          <h3>
            <a
              class="item"
              href="https://gothamist.com/news/ny-smartphone-ban-has-made-lunch-loud-again"
              >NY smartphone ban has made lunch loud again</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 13:20:16</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45822539"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45822513">
          <h3>
            <a
              class="item"
              href="https://www.pnas.org/doi/10.1073/pnas.1900712116"
              >Optimism associated with exceptional longevity (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 13:16:58</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45822513"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45822302">
          <h3>
            <a
              class="item"
              href="https://www.macrumors.com/2025/11/05/ios-26-2-third-party-app-stores-japan/"
              >iOS 26.2 to allow third-party app stores in Japan ahead of
              regulatory deadline</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 12:51:44</span
              ><span class="points-container"
                >Points: <span class="points">294</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45822302"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45822071">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/travel/article/20200902-the-grim-truth-behind-the-pied-piper"
              >The grim truth behind the Pied Piper (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 12:21:39</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45822071"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45821921">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45821921"
              >Founder in Residence at Woz (San Francisco)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 12:00:17</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                We’re opening one of the coolest jobs ever (only slightly
                biased).
              </p>
              <p>
                At Woz, we’ve built the world's first AI App Factory, capable of
                building business quality mobile apps in just hours.
              </p>
              <p>
                Now we’re handing over the keys to aspiring founders and
                challenging them to build real, revenue generating app
                businesses. Founders get full internal access to our platform, a
                salary, a dedicated marketing budget, and meaningful upside in
                any revenue they generate. This is a rare chance to operate like
                a founder inside a YC startup that recently raised a $6M seed
                round, surrounded by experienced engineers and builders in the
                heart of San Francisco.
              </p>
              <p>
                Who we’re looking for: - A technical builder who can ship,
                iterate and problem solve independently (experience with React
                Native and TypeScript is a plus) - Someone who has launched
                products, apps, or businesses before, or has a strong track
                record of building things on their own - Someone who understands
                go-to-market and growth, especially creative or viral marketing
                - Someone eager to learn, experiment, and build alongside our
                team in San Francisco (able to work in-person for at least the
                first three months)
              </p>
              <p>
                Interested? Submit your info here. We’ll be in touch
                <a href="https://forms.gle/h8ZWjgRfQUpaTQf8A"
                  >https://forms.gle/h8ZWjgRfQUpaTQf8A</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="45815419">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=DAX2_mPr9W8"
              >I was right about dishwasher pods and now I can prove it
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 20:16:45</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45815419"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45812756">
          <h3>
            <a
              class="item"
              href="https://loopholelabs.io/blog/xdp-for-egress-traffic"
              >An eBPF Loophole: Using XDP for Egress Traffic</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 16:26:09</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45812756"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45807993">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=0-eViUyPwso"
              >I want a good parallel language [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 06:35:27</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45807993"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45804664">
          <h3>
            <a class="item" href="https://github.com/rxliuli/apps.apple.com"
              >Apple App Store frontend source code archive</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-03 @ 21:27:56</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45804664"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45783467">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/tech-industry/big-tech/manufacturer-issues-remote-kill-command-to-nuke-smart-vacuum-after-engineer-blocks-it-from-collecting-data-user-revives-it-with-custom-hardware-and-python-scripts-to-run-offline"
              >Vacuum bricked after user blocks data collection – user mods it
              to run anyway</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-01 @ 17:25:00</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45783467"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45763262">
          <h3>
            <a
              class="item"
              href="https://blog.ml.cmu.edu/2025/10/27/learning-from-failure-to-tackle-extremely-hard-problems/"
              >Learning from failure to tackle hard problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-30 @ 18:18:40</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45763262"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45761594">
          <h3>
            <a
              class="item"
              href="https://antocuni.eu/2025/10/29/inside-spy-part-1-motivations-and-goals/"
              >SPy: An interpreter and compiler for a fast statically typed
              variant of Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-30 @ 16:08:25</span
              ><span class="points-container"
                >Points: <span class="points">210</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45761594"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45744683">
          <h3>
            <a
              class="item"
              href="https://blog.phnx.im/making-mls-more-decentralized/"
              >Making MLS More Decentralized</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-29 @ 09:54:05</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45744683"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45744038">
          <h3>
            <a
              class="item"
              href="https://blog.mozilla.org/en/firefox/profile-management/"
              >Firefox profiles: Private, focused spaces for all the ways you
              browse</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-29 @ 08:10:58</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45744038"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45701484">
          <h3>
            <a
              class="item"
              href="https://www.sigops.org/2025/wafer-scale-ai-compute-a-system-software-perspective/"
              >Wafer-Scale AI Compute: A System Software Perspective</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 05:08:30</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45701484"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
