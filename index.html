<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36484308">
          <h3>
            <a class="item" href="https://github.com/eyurtsev/kor"
              >Kor: Extract structured data using LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 19:05:41</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36484308"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36483445">
          <h3>
            <a
              class="item"
              href="https://enigma.hoerenberg.com/index.php?cat=Unbroken&amp;page=P1030680"
              >P1030680: Unbroken Enigma message (U534, 01 May 1945)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 18:10:23</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36483445"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36483276">
          <h3>
            <a
              class="item"
              href="https://www.imf.org/en/Blogs/Articles/2023/06/26/europes-inflation-outlook-depends-on-how-corporate-profits-absorb-wage-gains"
              >Corporate profits account for almost half the increase in
              Europe’s inflation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 17:55:06</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36483276"
                  >Comments</a
                ><span class="descendants">: 176</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36483251">
          <h3>
            <a
              class="item"
              href="https://www.captainsjournal.com/2023/06/25/engineering-assessment-of-the-oceangate-titan-failure/"
              >Engineering Assessment of the OceanGate Titan Failure</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 17:53:30</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36483251"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36482961">
          <h3>
            <a class="item" href="https://emacsconf.org/2023/cfp/"
              >EmacsConf 2023 Call for Participation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 17:33:58</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36482961"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36482486">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/two-dots/jobs/jjpjJeY-software-engineer"
              >Two Dots (YC S22) Is Hiring a Senior Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 17:00:47</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36482126">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2212.05598"
              >Recurrent Vision Transformers for Object Detection with Event
              Cameras</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 16:40:02</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36482126"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36481693">
          <h3>
            <a
              class="item"
              href="https://stanmed.stanford.edu/turmeric-lead-risk-detect/"
              >Turmeric’s unexpected link to lead poisoning in Bangladesh</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 16:12:22</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36481693"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36481627">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/this-ancient-maya-city-was-hidden-in-the-jungle-for-over-1000-years-180982427/"
              >Ancient Maya City Was Hidden in the Jungle for More Than 1k
              Years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 16:07:39</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36481627"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36481470">
          <h3>
            <a
              class="item"
              href="https://security.stackexchange.com/questions/37818/why-use-openid-connect-instead-of-plain-oauth2/260519#260519"
              >Why use OpenID Connect instead of plain OAuth2?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:57:13</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36481470"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36481404">
          <h3>
            <a
              class="item"
              href="https://leadership.garden/demystifying-burnout/"
              >Demystifying Burnout – A Deep Dive into Its Symptoms and
              Remedies</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:53:15</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36481404"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36481279">
          <h3>
            <a
              class="item"
              href="https://www.nationalparkstraveler.org/2023/02/update-lawsuit-alleges-recreationgov-cluttered-junk-fees-seeks-refunds"
              >Suit Alleges Recreation.Gov Cluttered with Junk Fees, Seeks
              Millions in Refunds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:45:11</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36481279"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36481263">
          <h3>
            <a class="item" href="https://store.arduino.cc/products/uno-r4-wifi"
              >Arduino Uno R4 WiFi</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:43:54</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36481263"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36481186">
          <h3>
            <a
              class="item"
              href="https://www.linen.dev/s/linen/t/8008310/building-a-chat-app-with-nextjs-and-elixir-table-of-content-"
              >Linen.dev – Adding Elixir to our Nextjs app</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:39:29</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36481186"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36480779">
          <h3>
            <a class="item" href="https://github.com/bkryza/clang-uml"
              >Show HN: Clang-uml – C++ to UML diagram generator based on
              Clang</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:17:39</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36480779"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                clang-uml is an open-source C++ to UML diagram generator, driven
                by YAML configuration files.
              </p>
              <p>
                The main idea behind the project is to easily maintain
                up-to-date diagrams within a code-base or document legacy code.
              </p>
              <p>
                The configuration file for clang-uml defines the types and
                contents of each generated diagram.
              </p>
              <p>
                The diagrams can be currently generated in PlantUML and JSON
                formats.
              </p>
              <p>
                Main features: - class, sequence, package and include diagrams -
                up to C++17 with support for C++20 concepts - visualization of
                template specialization relationships - declarative diagram
                content filtering based on namespaces, elements and
                relationships - relationship inference from C++ containers,
                smart pointers and custom templates - customizable interactive
                links in diagrams (SVG output only) - generation of UML packages
                from namespaces or directories - JSON output containing
                intermediate diagram model representation for custom processing
              </p>
              <p>
                More features, usage information and examples are in README at
                <a href="https://github.com/bkryza/clang-uml"
                  >https://github.com/bkryza/clang-uml</a
                >
                and online docs at
                <a href="https://clang-uml.github.io"
                  >https://clang-uml.github.io</a
                >
              </p>
              <p>
                In particular, checkout diagrams generated from test cases here:
                <a href="https://clang-uml.github.io/md_docs_2test__cases.html"
                  >https://clang-uml.github.io/md_docs_2test__cases.html</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36480687">
          <h3>
            <a class="item" href="https://mofi.loud.red/"
              >Show HN: Content-aware fill for audio to change a song to any
              duration</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:12:53</span
              ><span class="points-container"
                >Points: <span class="points">255</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36480687"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://mofi.loud.red/edit/8bd3fdf780f8c3927e41029f3b957f8a7ed96863"
                >https://mofi.loud.red/edit/8bd3fdf780f8c3927e41029f3b957f8a7...</a
              >
              <p>
                The cool thing is that after the song is analyzed on the server,
                the client can recompute and preview the results completely
                client-side through an implementation that uses Web Workers and
                WebAssembly. The audio previewing uses Tone.js. I am thinking of
                writing up some more details about the implementation in the
                future.
              </p>
              <p>
                I'm still working on a way to explain this easily, but I like
                the idea of carrying over the concept of content-aware fill from
                images to audio.
              </p>
              <p>Please let me know if you have any comments or questions!</p>
            </div>
          </section>
        </section>
        <section id="36480570">
          <h3>
            <a class="item" href="https://github.com/steven-tey/chathn"
              >ChatHN: Chat with Hacker News using OpenAI function calling</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 15:06:26</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36480570"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36480230">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36480230"
              >Launch HN: Argonaut (YC S21) – Easily Deploy Apps and Infra to
              AWS and GCP</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 14:41:47</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36480230"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.argonaut.dev/">https://www.argonaut.dev/</a
              >), a unified platform that tries to make software ops painless,
              so teams can focus on building features instead of building and
              managing infrastructure. Argonaut combines Kubernetes PaaS, a CI
              pipeline builder, and a Terraform state manager with prebuilt AWS
              and GCP modules. Here’s a demo:
              <a href="https://www.youtube.com/watch?v=8DZsYXxA2tQ"
                >https://www.youtube.com/watch?v=8DZsYXxA2tQ</a
              >.
              <p>
                I’ve helped build infrastructure tooling from scratch at
                multiple companies and realized two things: that the shape of
                the solution with the advent of containerization, Kubernetes,
                and hyperscalers is quite similar across orgs, and that highly
                knowledgeable engineers are needed to build and manage this
                system.
              </p>
              <p>
                Internal infrastructure teams juggle a multitude of
                tasks—provisioning cloud infrastructure, configuring runtimes,
                building code, securing artifacts, running tests, and deploying
                at scale. Post-deployment, they're also tasked with monitoring
                app performance, errors, uptime, and cost visibility. It's a lot
                of work, and having to build this tooling in-house is a deep
                inefficiency in engineering teams. The root of the problem is
                that AWS and GCP provide a lower level of abstraction than the
                entities, such as environments and applications, that developers
                have to deal with, and a ton of work is getting duplicated,
                often by underfunded teams, across many orgs. Argonaut’s
                objective is to be the developer platform and control center
                that you would otherwise have to build internally.
              </p>
              <p>
                Argonaut provides an intuitive developer experience that
                simplifies working with Kubernetes and enables developer
                self-service, reducing the burden on devops and platform teams.
                We've productized this workflow orchestration, incorporating
                best practices to provide a push-to-deploy experience with
                flexible pipelines and scalable infrastructure, all within
                minutes.
              </p>
              <p>
                Our users are startups across various domains like healthcare,
                IoT, fintech, AI, and SaaS products. Over the last two years,
                we’ve enabled customers to scale their engineering teams 10x and
                manage 10+ environments in parallel without needing a dedicated
                infra/DevOps team, saving them precious time and resources.
              </p>
              <p>
                Argonaut lets you set up production-ready infrastructure and
                customize as you scale. We then let you set up automated
                deployments of your application in minutes. We offer
                configurable build-and-deploy pipelines, powered by Dagger and
                ArgoCD, and deep integration with GitHub Actions and GitLab CI.
                In addition, we support container registries, multiple cloud
                accounts, observability stacks, cost visibility providers, CDNs,
                and the entire helm chart ecosystem of Kubernetes, with more
                integrations on the way.
              </p>
              <p>
                Key features include: (1) easily create environments
                encapsulating cloud infrastructure, applications, and deployment
                pipelines (2) autoscaling deployments for apps and cronjobs to
                GCP and AWS with a progression across environments (3) compose
                deployments across multiple environments with our visual
                pipeline builder (4) get cost estimates before making infra
                changes, giving you a clear understanding of your expenses; (5)
                managed Terraform state and pre-built modules that just work,
                fostering team collaboration on infrastructure.
              </p>
              <p>
                Argonaut is self-serve, so you can sign up and start using the
                product right away:
                <a href="https://ship.argonaut.dev">https://ship.argonaut.dev</a
                >. There is a free tier that doesn't require a credit card to
                get started. We'd be delighted to have you try it, and are happy
                to help with onboarding.
              </p>
              <p>
                If your teams work with AWS, GCP, or Kubernetes, I’d love to
                hear about your experiences, pain points, and what you think a
                product like Argonaut should be able to do. Looking forward to
                your comments!
              </p>
            </div>
          </section>
        </section>
        <section id="36479976">
          <h3>
            <a class="item" href="https://docs.authlib.org/en/latest/index.html"
              >Authlib: Python Authentication</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 14:21:42</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36479976"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36479882">
          <h3>
            <a
              class="item"
              href="https://www.jeffgeerling.com/blog/2023/im-done-red-hat-enterprise-linux"
              >I'm Done with Red Hat (Enterprise Linux)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 14:12:27</span
              ><span class="points-container"
                >Points: <span class="points">382</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36479882"
                  >Comments</a
                ><span class="descendants">: 266</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36479776">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-06-physicists-superconductivity.html"
              >Physicists discover a new switch for superconductivity</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 14:02:57</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36479776"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36479387">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2023/06/23/every-factorial-is-a-power/"
              >Every factorial is a power</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 13:24:53</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36479387"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36478892">
          <h3>
            <a class="item" href="https://faultlore.com/blah/text-hates-you/"
              >Text Rendering Hates You (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 12:32:55</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36478892"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36478528">
          <h3>
            <a class="item" href="https://eruda.liriliri.io/"
              >Devtools for Mobile Browsers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 11:54:08</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36478528"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36478206">
          <h3>
            <a
              class="item"
              href="https://matan-h.com/google-has-a-secret-browser-hidden-inside-the-settings/"
              >Google has a secret browser hidden inside the settings</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 11:13:03</span
              ><span class="points-container"
                >Points: <span class="points">674</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36478206"
                  >Comments</a
                ><span class="descendants">: 237</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36477233">
          <h3>
            <a class="item" href="https://bitsavers.org/"
              >Bitsavers Software Archive (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 08:37:55</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36477233"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36475887">
          <h3>
            <a
              class="item"
              href="https://blogs.bl.uk/digitisedmanuscripts/2023/05/the-last-day-of-constantinople.html"
              >The Last Day of Constantinople</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 04:58:09</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36475887"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36471999">
          <h3>
            <a
              class="item"
              href="http://james-iry.blogspot.com/2009/05/brief-incomplete-and-mostly-wrong.html"
              >A Brief, Incomplete, and Mostly Wrong History of Programming
              Languages (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-25 @ 20:00:21</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36471999"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36465528">
          <h3>
            <a
              class="item"
              href="https://ravenmagazine.org/magazine/the-paradoxes-of-nostalgia/"
              >The Paradoxes of Nostalgia</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-25 @ 06:19:43</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36465528"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36465493">
          <h3>
            <a
              class="item"
              href="https://wearethemutants.com/2017/08/01/argos-catalogue-kettle-pages-19761985/"
              >Argos Catalogue Kettle Pages, 1976/1985</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-25 @ 06:10:35</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36465493"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
