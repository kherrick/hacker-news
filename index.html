<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45846769">
          <h3>
            <a
              class="item"
              href="https://status.claude.com/incidents/tgtw1sqs9ths"
              >Claude Is Down</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 14:31:07</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45846769"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45846517">
          <h3>
            <a
              class="item"
              href="https://mccd.space/posts/ocaml-the-worlds-best/"
              >I Love OCaml</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 14:05:49</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45846517"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45846360">
          <h3>
            <a
              class="item"
              href="https://jslegenddev.substack.com/p/im-making-a-small-rpg-and-i-need"
              >I'm Making a Small RPG and I Need Feeback Regarding
              Performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 13:52:39</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45846360"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45846090">
          <h3>
            <a
              class="item"
              href="https://openmw.org/2025/openmw-0-50-0-released/"
              >OpenMW 0.50.0 Released – open-source Morrowind
              reimplementation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 13:25:27</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45846090"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45845958">
          <h3>
            <a
              class="item"
              href="https://stategraph.dev/blog/why-we-chose-ocaml"
              >We chose OCaml to write Stategraph</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 13:10:49</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45845958"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45845948">
          <h3>
            <a
              class="item"
              href="https://codemanship.wordpress.com/2025/11/07/is-software-the-ufology-of-engineering-disciplines/"
              >Is Software the UFOlogy of Engineering Disciplines?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 13:09:07</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45845948"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45845800">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2510.24256"
              >From Memorization to Reasoning in the Spectrum of Loss
              Curvature</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 12:43:49</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45845800"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45845772">
          <h3>
            <a
              class="item"
              href="https://sherwood.news/tech/meta-projected-10-of-2024-revenue-came-from-scams-and-banned-goods-reuters/"
              >Meta projected 10% of 2024 revenue came from scams</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 12:39:54</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45845772"
                  >Comments</a
                ><span class="descendants">: 240</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45845568">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/sweep/jobs/8dUn406-founding-engineer-intern"
              >Sweep (YC S23) is hiring to build autocomplete for JetBrains</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 12:00:40</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45844197">
          <h3>
            <a class="item" href="https://prison.josh.mn/lessons"
              >Lessons from Growing a Piracy Streaming Site</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 07:09:30</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45844197"
                  >Comments</a
                ><span class="descendants">: 140</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45843948">
          <h3>
            <a
              class="item"
              href="https://soumith.ch/blog/2025-11-06-leaving-meta-and-pytorch.md.html"
              >Leaving Meta and PyTorch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 06:14:50</span
              ><span class="points-container"
                >Points: <span class="points">533</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45843948"
                  >Comments</a
                ><span class="descendants">: 118</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45843603">
          <h3>
            <a class="item" href="https://github.com/jeremyaboyd/jerm-cad"
              >JermCAD: Browser-Based CAD Software</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 04:38:40</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45843603"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45843146">
          <h3>
            <a
              class="item"
              href="https://www.farmersalmanac.com/fond-farewell-from-farmers-almanac"
              >A Fond Farewell</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-07 @ 03:01:32</span
              ><span class="points-container"
                >Points: <span class="points">420</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45843146"
                  >Comments</a
                ><span class="descendants">: 137</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45841262">
          <h3>
            <a
              class="item"
              href="https://www.raphkoster.com/2025/11/03/game-design-is-simple-actually/"
              >Game design is simple</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-06 @ 22:24:23</span
              ><span class="points-container"
                >Points: <span class="points">414</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45841262"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45840200">
          <h3>
            <a
              class="item"
              href="https://ras.ac.uk/news-and-press/research-highlights/universes-expansion-now-slowing-not-speeding"
              >Analysis indicates that the universe’s expansion is not
              accelerating</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-06 @ 20:45:39</span
              ><span class="points-container"
                >Points: <span class="points">217</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45840200"
                  >Comments</a
                ><span class="descendants">: 175</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45840088">
          <h3>
            <a class="item" href="https://fly.io/blog/everyone-write-an-agent/"
              >You should write an agent</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-06 @ 20:37:06</span
              ><span class="points-container"
                >Points: <span class="points">867</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45840088"
                  >Comments</a
                ><span class="descendants">: 343</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45839901">
          <h3>
            <a
              class="item"
              href="https://www.troyhunt.com/2-billion-email-addresses-were-exposed-and-we-indexed-them-all-in-have-i-been-pwned/"
              >Two billion email addresses were exposed</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-06 @ 20:20:23</span
              ><span class="points-container"
                >Points: <span class="points">548</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45839901"
                  >Comments</a
                ><span class="descendants">: 383</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45836070">
          <h3>
            <a
              class="item"
              href="https://moonshotai.github.io/Kimi-K2/thinking.html"
              >Kimi K2 Thinking, a SOTA open-source trillion-parameter reasoning
              model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-06 @ 15:06:06</span
              ><span class="points-container"
                >Points: <span class="points">832</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45836070"
                  >Comments</a
                ><span class="descendants">: 373</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45825733">
          <h3>
            <a class="item" href="https://book.sv"
              >Show HN: I scraped 3B Goodreads reviews to train a better
              recommendation model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 17:50:45</span
              ><span class="points-container"
                >Points: <span class="points">499</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45825733"
                  >Comments</a
                ><span class="descendants">: 201</span></span
              >
            </h4>
            <div class="text">
              <p>
                For the past couple months I've been working on a website with
                two main features:
              </p>
              <p>
                - <a href="https://book.sv">https://book.sv</a> - put in a list
                of books and get recommendations on what to read next from a
                model trained on over a billion reviews
              </p>
              <p>
                -
                <a href="https://book.sv/intersect"
                  >https://book.sv/intersect</a
                >
                - put in a list of books and find the users on Goodreads who
                have read them all (if you don't want to be included in these
                results, you can opt-out here:
                <a href="https://book.sv/remove-my-data"
                  >https://book.sv/remove-my-data</a
                >)
              </p>
              <p>
                Technical info available here:
                <a href="https://book.sv/how-it-works"
                  >https://book.sv/how-it-works</a
                >
              </p>
              <p>
                Note 1: If you only provide one or two books, the model doesn't
                have a lot to work with and may include a handful of somewhat
                unrelated popular books in the results. If you want
                recommendations based on just one book, click the "Similar"
                button next to the book after adding it to the input book list
                on the recommendations page.
              </p>
              <p>
                Note 2: This is uncommon, but if you get an unexpected
                non-English titled book in the results, it is probably not a
                mistake and it very likely has an English edition. The
                "canonical" edition of a book I use for display is whatever one
                is the most popular, which is usually the English version, but
                this is not the case for all books, especially those by famous
                French or Russian authors.
              </p>
            </div>
          </section>
        </section>
        <section id="45809835">
          <h3>
            <a
              class="item"
              href="https://oneuptime.com/blog/post/2025-11-03-opentelemetry-escape-from-observability-cartel/view"
              >OpenTelemetry: Escape Hatch from the Observability Cartel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 11:42:10</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45809835"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45808863">
          <h3>
            <a
              class="item"
              href="https://notes.eatonphil.com/2025-02-15-from-web-developer-to-database-developer-in-10-years.html"
              >From web developer to database developer in 10 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 09:02:49</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45808863"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45799109">
          <h3>
            <a class="item" href="https://cryptography101.ca"
              >Cryptography 101 with Alfred Menezes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-03 @ 14:12:06</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45799109"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45794824">
          <h3>
            <a class="item" href="https://modal.com/blog/notebooks-internals"
              >We built a cloud GPU notebook that boots in seconds</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-03 @ 00:50:41</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45794824"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45789218">
          <h3>
            <a class="item" href="https://rednafi.com/go/interface-segregation/"
              >Revisiting Interface Segregation in Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-02 @ 10:17:22</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45789218"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45789143">
          <h3>
            <a
              class="item"
              href="https://itsfoxstudio.substack.com/p/comparison-traits-understanding-equality"
              >Comparison Traits – Understanding Equality and Ordering in
              Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-02 @ 10:00:07</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45789143"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45788194">
          <h3>
            <a class="item" href="https://pytorch.org/blog/helion/"
              >PyTorch Helion</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-02 @ 06:21:37</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45788194"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45788167">
          <h3>
            <a class="item" href="https://myhsu.xyz/llvm-machine-scheduler-2/"
              >Machine Scheduler in LLVM – Part II</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-02 @ 06:13:07</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45788167"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45786490">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2025/10/31/smaller-qr-codes/"
              >Text case changes the size of QR codes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-01 @ 23:34:51</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45786490"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45781965">
          <h3>
            <a
              class="item"
              href="https://cacm.acm.org/opinion/the-silent-scientist-when-software-research-fails-to-reach-its-audience/"
              >The Silent Scientist: When Software Research Fails to Reach Its
              Audience</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-01 @ 14:40:09</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45781965"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45778653">
          <h3>
            <a
              class="item"
              href="https://troypress.com/1973-implementation-of-wordle-was-published-by-dec/"
              >1973 Implementation of Wordle was Published by DEC (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-01 @ 01:56:57</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45778653"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
