<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44605873">
          <h3>
            <a
              class="item"
              href="https://josephg.com/blog/in-the-long-run-gpl-code-becomes-irrelevant/"
              >In the long run, GPL code becomes irrelevant (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 15:34:36</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44605873"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44605618">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/ice-access-medicaid-data/"
              >ICE Is Getting Unprecedented Access to Medicaid Data</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 15:15:58</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44605618"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44605312">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44605312"
              >Ask HN: Where do you guys find audiobooks?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 14:53:00</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44605312"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
            <div class="text"><p>TA.</p></div>
          </section>
        </section>
        <section id="44605213">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44605213"
              >I'm Peter Roberts, immigration attorney who does work for YC and
              startups. AMA</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 14:44:57</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44605213"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
            <div class="text">
              I'll be here for the rest of the day. As usual, there are
              countless immigration-related topics to discuss and I'll be guided
              by whatever you're concerned with. Please remember that I can't
              provide legal advice on specific cases because I won't have access
              to all the facts. Please stick to a factual discussion in your
              questions and comments and I'll try to do the same in my answers.
            </div>
          </section>
        </section>
        <section id="44605171">
          <h3>
            <a
              class="item"
              href="https://www.bitecode.dev/p/the-eu-can-be-shut-down-with-a-few"
              >The EU can be shut down with a few keystrokes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 14:41:19</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44605171"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44604827">
          <h3>
            <a
              class="item"
              href="https://www.lemonde.fr/en/environment/article/2025/07/18/these-french-villages-have-no-more-drinking-water-the-reason-pfas-pollution_6743479_114.html"
              >French villages have no more drinking water. The reason? PFAS
              pollution</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 14:10:21</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44604827"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44604690">
          <h3>
            <a
              class="item"
              href="https://www.sfchronicle.com/health/aging-longevity/article/human-longevity-health-clinic-20277643.php"
              >What’s on offer at a luxury Bay Area longevity clinic</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 13:56:02</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44604690"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44604453">
          <h3>
            <a
              class="item"
              href="https://www.knostic.ai/blog/mapping-mcp-servers-study"
              >Exposing the Unseen: Mapping MCP Servers Across the Internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 13:29:50</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44604453"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44604328">
          <h3>
            <a
              class="item"
              href="https://www.thecity.nyc/2025/07/18/nypd-fdny-clearview-ai-ban-columbia-palestinian-protest/"
              >NYPD Bypassed Facial Recognition Ban to ID Pro-Palestinian
              Student Protester</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 13:15:50</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44604328"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44604257">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44604257"
              >Ask HN: Any active COBOL devs here? What are you working on?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 13:05:55</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44604257"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
            <div class="text">
              COBOL legacy systems in finance and government are somewhat of a
              meme. However, I've never actually met a single person who's day
              job is to maintain one. I'd be curious to learn what systems are
              you working on?
            </div>
          </section>
        </section>
        <section id="44604050">
          <h3>
            <a class="item" href="https://tangled.sh/@rockorager.dev/lsr"
              >lsr: ls with io_uring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 12:40:41</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44604050"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44603739">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44603739"
              >Resolve (YC W15) Is Hiring an Operations and Billing Lead for
              Construction VR</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 12:00:47</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>Type: Full-time</p>
              <p>About Us</p>
              <p>
                Resolve is an 11-person SaaS startup helping construction
                companies and builders review faster. Our clients include
                general contractors, specialty subcontractors, owner operators
                and engineering companies—companies that build the world around
                us. We’re growing fast and looking for a detail-oriented,
                proactive Billing and Operations Lead to take charge of key
                administrative processes that keep our business humming.
              </p>
              <p>What You’ll Do</p>
              <p>
                You’ll own and improve the day-to-day administrative workflows
                around our billing, collections and procurement process that
                support our sales team and customers. You will be interfacing
                with our sales team to track and understand deals and
                interfacing directly with customers’ procurement teams to manage
                billing and vendor onboarding. This role has the opportunity to
                grow into a broader internal operations role that could oversee
                broad areas such as Revops, HR, Accounting, Investor Relations,
                and Banking. This is a high-impact role that will touch:
              </p>
              <p>Invoicing &amp; Collections</p>
              <p>- Collect, track and process POs from our customers</p>
              <p>
                - Send recurring and one-off invoices to customers (primarily
                construction companies)
              </p>
              <p>
                - Track outstanding accounts receivable and follow up
                persistently with customers to ensure timely payments
              </p>
              <p>
                - Reconcile payments received with invoice records (via Stripe,
                ACH, check, etc.) on a frequent basis
              </p>
              <p>
                - Maintain clean records in our billing and CRM systems (bonus
                for prior experience in Hubspot or Salesforce)
              </p>
              <p>
                - Become comfortable with multiple procurement systems like
                Oracle, SAP, etc.
              </p>
              <p>Vendor &amp; Back-Office Coordination</p>
              <p>
                - Manage the vendor onboarding process for our sales team:
                onboarding forms, W-9s, NDAs, and verify payment info with our
                customer’s procurement team.
              </p>
              <p>
                - Track and process Resolve vendor invoices, coordinate approval
                workflows
              </p>
              <p>
                - Assist with internal reporting as it relates to accounts
                receivable and customer tracking Identify and propose process
                improvements as we scale
              </p>
              <p>Internal Growth Paths Available</p>
              <p>
                - HR: Support HR operations like employee onboarding, payroll,
                benefits management
              </p>
              <p>
                - Finance: Help with banking, credit card administration,
                monthly accounting, taxes and financial reporting
              </p>
              <p>
                - Security and Compliance: Become familiar with answering
                security questionnaires, our trust center and security systems
                (Vanta).
              </p>
              <p>
                - Investor Relations: Dive into investor relations and learn
                about cap table management, 409a valuations, employee option
                grants, and more.
              </p>
              <p>
                - Revops: Create processes and automated workflows to speed up
                our sales’ team velocity. Learn to use AI to write scripts in
                Hubspot and our other tools.
              </p>
              <p>What We’re Looking For</p>
              <p>
                - 1–3 years of experience in finance / billing operations,
                accounting support, procurement or admin roles (bonus if at a
                startup or in construction/real estate/contractor-facing
                business)
              </p>
              <p>
                - Meticulous attention to detail and strong organizational
                skills
              </p>
              <p>
                - Comfortable nudging customers to pay on time—you’re polite but
                persistent
              </p>
              <p>
                - Familiarity with tools like Hubspot, SAP, Oracle, QuickBooks,
                Stripe, Gusto, or similar a plus
              </p>
              <p>
                - Eager to learn and grow into broader operations or finance
                responsibilities
              </p>
              <p>Why Join Us</p>
              <p>
                - Get in early at a growing SaaS startup in an industry ripe for
                disruption
              </p>
              <p>- Work directly with the founders and leadership team</p>
              <p>- Help build the internal engine that powers our company</p>
              <p>
                - Health/dental/vision benefits, competitive salary, basic life
                insurance, and equity options
              </p>
              <p>- Home office budget</p>
              <p>- Salary Range: $65 - $95k</p>
            </div>
          </section>
        </section>
        <section id="44603267">
          <h3>
            <a
              class="item"
              href="https://pmc.ncbi.nlm.nih.gov/articles/PMC5367557/"
              >Psilocybin decreases depression and anxiety in cancer patients
              (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 10:57:08</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44603267"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44603066">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/cpm-creator-gary-kildalls-memoirs-released-as-free-download"
              >CP/M Creator Gary Kildall's Memoirs Released as Free Download</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 10:22:15</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44603066"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44602532">
          <h3>
            <a
              class="item"
              href="https://rsadowski.de/posts/2025/openbsd-immutable-system-logs/"
              >When Root Meets Immutable: OpenBSD Chflags vs. Log Tampering</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 08:36:47</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44602532"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44601023">
          <h3>
            <a class="item" href="https://bozmen.io/fhe"
              >Fully homomorphic encryption and the dawn of a private
              internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 03:49:50</span
              ><span class="points-container"
                >Points: <span class="points">343</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44601023"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44600594">
          <h3>
            <a class="item" href="https://lewiscampbell.tech/blog/250718.html"
              >NIH is cheaper than the wrong dependency</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 02:27:43</span
              ><span class="points-container"
                >Points: <span class="points">266</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44600594"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44596472">
          <h3>
            <a
              class="item"
              href="https://sankalp.bearblog.dev/my-claude-code-experience-after-2-weeks-of-usage/"
              >My experience with Claude Code after two weeks of adventures</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-17 @ 18:27:24</span
              ><span class="points-container"
                >Points: <span class="points">341</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44596472"
                  >Comments</a
                ><span class="descendants">: 301</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44595811">
          <h3>
            <a
              class="item"
              href="https://blog.jxmo.io/p/there-is-only-one-model"
              >All AI models might be the same</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-17 @ 17:28:49</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44595811"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44595492">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/introducing-chatgpt-agent/"
              >ChatGPT agent: bridging research and action</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-17 @ 17:01:47</span
              ><span class="points-container"
                >Points: <span class="points">650</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44595492"
                  >Comments</a
                ><span class="descendants">: 442</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44594156">
          <h3>
            <a class="item" href="https://mistral.ai/news/le-chat-dives-deep"
              >Mistral Releases Deep Research, Voice, Projects in Le Chat</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-17 @ 15:00:18</span
              ><span class="points-container"
                >Points: <span class="points">614</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44594156"
                  >Comments</a
                ><span class="descendants">: 139</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44593972">
          <h3>
            <a
              class="item"
              href="https://michaelbastos.com/blog/why-self-taught-engineers-often-outperform"
              >Self-taught engineers often outperform (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-17 @ 14:43:00</span
              ><span class="points-container"
                >Points: <span class="points">387</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44593972"
                  >Comments</a
                ><span class="descendants">: 297</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44592413">
          <h3>
            <a
              class="item"
              href="https://github.com/pollen-robotics/AmazingHand"
              >Hand: open-source Robot Hand</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-17 @ 12:08:38</span
              ><span class="points-container"
                >Points: <span class="points">414</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44592413"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44588319">
          <h3>
            <a class="item" href="https://gwern.net/blog/2025/perfume"
              >Perfume reviews</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-17 @ 00:16:17</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44588319"
                  >Comments</a
                ><span class="descendants">: 150</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44571549">
          <h3>
            <a class="item" href="https://www.hathitrust.org/"
              >HathiTrust Digital Library – books online</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 14:32:21</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44571549"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44569019">
          <h3>
            <a class="item" href="https://ansi.tools"
              >Inspect ANSI control codes and escape sequences</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 08:07:52</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44569019"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44568761">
          <h3>
            <a class="item" href="https://www.jefit.com/our-story"
              >15 Years of Building Jefit</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-15 @ 07:18:32</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44568761"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44566510">
          <h3>
            <a class="item" href="https://www.garros.gallery/"
              >The Art of Roland-Garros</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 23:40:17</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44566510"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44563867">
          <h3>
            <a
              class="item"
              href="https://www.stranger.systems/posts/by-slug/row-polymorphic-programming.html"
              >Row Polymorphic Programming</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 18:50:31</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44563867"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44561516">
          <h3>
            <a class="item" href="https://100r.co/site/home.html"
              >Hundred Rabbits – Low-tech living while sailing the world</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-14 @ 15:45:28</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44561516"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
