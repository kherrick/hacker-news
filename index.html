<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46097773">
          <h3>
            <a class="item" href="https://thinkinggamefilm.com"
              >The Thinking Game Film – Google DeepMind Documentary</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 16:07:11</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46097773"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46097624">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/auto-car-privacy-3674ce59c9b30f2861d29178a31e6ab7"
              >Modern cars are spying on you. Here's what you can do about it</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 15:52:41</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46097624"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46097609">
          <h3>
            <a
              class="item"
              href="https://david-jasso.com/2024/04/11/atlas-shrugged/"
              >Atlas Shrugged</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 15:51:03</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46097609"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46096921">
          <h3>
            <a
              class="item"
              href="https://www.powermag.com/geothermal-breakthrough-in-south-texas-signals-new-era-for-ercot/"
              >Geothermal Breakthrough in South Texas Signals New Era for
              Ercot</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 14:29:26</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46096921"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46096800">
          <h3>
            <a
              class="item"
              href="https://dillo-browser.org/news/migration-from-github/"
              >Migrating Dillo from GitHub</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 14:11:40</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46096800"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46096781">
          <h3>
            <a
              class="item"
              href="https://www.howtogeek.com/turned-old-windows-pc-into-inexpensive-nas/"
              >Don't throw away your old PC–it makes a better NAS than anything
              you can buy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 14:09:01</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46096781"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46096556">
          <h3>
            <a
              class="item"
              href="https://www.ryanliptak.com/blog/windows-drive-letters-are-not-limited-to-a-z/"
              >Windows drive letters are not limited to A-Z</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 13:40:17</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46096556"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46096555">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2025/11/30/norway-wealth-fund-to-vote-for-human-rights-report-at-microsoft-agm-against-management.html"
              >Norway wealth fund to vote for human rights report at Microsoft,
              against Nadella</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 13:40:09</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46096555"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46096552">
          <h3>
            <a
              class="item"
              href="https://www.lopaciuk.eu/2021/03/26/apple-adb-protocol.html"
              >Apple Desktop Bus Protocol (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 13:39:52</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46096552"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46096337">
          <h3>
            <a class="item" href="https://adventofcode.com/2025/about"
              >Advent of Code 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 13:07:15</span
              ><span class="points-container"
                >Points: <span class="points">299</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46096337"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46095585">
          <h3>
            <a class="item" href="https://cachyos.org/"
              >CachyOS: Fast and Customizable Linux Distribution</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 10:47:27</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46095585"
                  >Comments</a
                ><span class="descendants">: 170</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46095250">
          <h3>
            <a
              class="item"
              href="https://karpathy.bearblog.dev/the-space-of-minds/"
              >The space of minds</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 09:44:15</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46095250"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46094478">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/jiga/jobs/Cco7vyK-product-designer-remote-europe"
              >Jiga (YC W21) Is Hiring Product Designer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 07:00:40</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46093518">
          <h3>
            <a
              class="item"
              href="https://zigtools.org/blog/zigbook-plagiarizing-playground/"
              >Zigbook Is Plagiarizing the Zigtools Playground</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 03:54:51</span
              ><span class="points-container"
                >Points: <span class="points">397</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46093518"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46093473">
          <h3>
            <a class="item" href="https://boing.greg.technology/"
              >Show HN: Boing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 03:46:35</span
              ><span class="points-container"
                >Points: <span class="points">575</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46093473"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46092558">
          <h3><a class="item" href="https://meshtastic.org/">Meshtastic</a></h3>
          <section>
            <h4>
              <span>2025-11-30 @ 01:15:59</span
              ><span class="points-container"
                >Points: <span class="points">243</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46092558"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46092478">
          <h3>
            <a
              class="item"
              href="https://www.lepetitprince.com/en/events-around-the-world/a-new-little-prince-museum-has-opened-its-doors-in-switzerland/"
              >A new Little Prince museum has opened its doors in Switzerland</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-30 @ 01:03:44</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46092478"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46091591">
          <h3>
            <a
              class="item"
              href="https://www.nbcnews.com/politics/politics-news/poll-dramatic-shift-americans-no-longer-see-four-year-college-degrees-rcna243672"
              >Americans no longer see four-year college degrees as worth the
              cost</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 22:56:14</span
              ><span class="points-container"
                >Points: <span class="points">388</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46091591"
                  >Comments</a
                ><span class="descendants">: 624</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46090969">
          <h3>
            <a class="item" href="https://blog.prizrak.me/post/landlock/"
              >Landlock-Ing Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 21:30:53</span
              ><span class="points-container"
                >Points: <span class="points">251</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46090969"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46090433">
          <h3>
            <a
              class="item"
              href="https://alearningaday.blog/2025/11/28/all-it-takes-is-for-one-to-work-out-2/"
              >All it takes is for one to work out</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 20:22:44</span
              ><span class="points-container"
                >Points: <span class="points">663</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46090433"
                  >Comments</a
                ><span class="descendants">: 306</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46090269">
          <h3>
            <a class="item" href="https://zackyzz.github.io/feynman.html"
              >Learning Feynman's Trick for Integrals</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 19:55:17</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46090269"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46087616">
          <h3>
            <a
              class="item"
              href="https://taranis.ie/datacenters-in-space-are-a-terrible-horrible-no-good-idea/"
              >Datacenters in space aren't going to work</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 14:05:53</span
              ><span class="points-container"
                >Points: <span class="points">404</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46087616"
                  >Comments</a
                ><span class="descendants">: 349</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46086771">
          <h3>
            <a
              class="item"
              href="https://www.bleepingcomputer.com/news/artificial-intelligence/leak-confirms-openai-is-preparing-ads-on-chatgpt-for-public-roll-out/"
              >Leak confirms OpenAI is preparing ads on ChatGPT for public roll
              out</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 11:31:58</span
              ><span class="points-container"
                >Points: <span class="points">770</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46086771"
                  >Comments</a
                ><span class="descendants">: 680</span></span
              >
            </h4>
            <div class="text">
              <a href="https://x.com/btibor91/status/1994714152636690834"
                >https://x.com/btibor91/status/1994714152636690834</a
              >
              <p>
                <a
                  href="https://xcancel.com/btibor91/status/1994714152636690834"
                  >https://xcancel.com/btibor91/status/1994714152636690834</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46071317">
          <h3>
            <a
              class="item"
              href="https://www.lumafield.com/first-article/posts/whats-hiding-inside-haribos-power-bank-and-headphones"
              >What's Hiding Inside Haribo's Power Bank and Headphones?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-27 @ 17:23:06</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46071317"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46070537">
          <h3>
            <a
              class="item"
              href="https://jimmyhmiller.com/easiest-way-to-build-type-checker"
              >The Easiest Way to Build a Type Checker</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-27 @ 16:07:24</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46070537"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46067011">
          <h3>
            <a class="item" href="https://www.dwarkesh.com/p/bits-per-sample"
              >RL is more information inefficient than you thought</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-27 @ 08:23:03</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46067011"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46056954">
          <h3>
            <a
              class="item"
              href="https://www.ietf.org/archive/id/draft-ietf-httpbis-safe-method-w-body-14.html"
              >The HTTP Query Method</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-26 @ 12:57:35</span
              ><span class="points-container"
                >Points: <span class="points">229</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46056954"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46054142">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46054142"
              >Show HN: I engineered a 2mm micro-bearing D20 ring that free-spin
              for 20 seconds</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-26 @ 04:15:57</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46054142"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>
                Most “spinner rings” you see online cheat by simulating rotation
                — there’s no real bearing, just loose tolerance metal sliding on
                metal. True micro-bearing rotation needs precision, tight
                tolerances, and high surface finish, which is difficult when
                everything needs to be wearable on a finger.
              </p>
              <p>
                So I tried to push it in the opposite direction and ended up
                making this:
              </p>
              <p>
                A 2mm-thick stainless steel ring with an internal micro-bearing
                track and 20 steel balls that free-spin for 20+ seconds with a
                single flick.
              </p>
              <p>
                Mechanical details: • CNC machined inner race with ~0.01mm
                tolerance • 20 micro steel balls loaded through a lateral
                channel • Outer ring pressed onto the bearing shell • No
                plastic, no bushings, no lubricant • Built to withstand everyday
                wearing forces (compression, torsion, micro-impacts) • PVD
                variant for color durability • Outer surface can be marked 1–20,
                turning it into a tiny randomizer
              </p>
              <p>
                Originally the goal was purely mechanical — to see if a bearing
                this thin could be made. But it ended up being surprisingly
                functional for solo tabletop RPG use: when you need a quick
                random result but don’t have table space, or when dice are too
                loud (playing in bed, on a commute, etc.). The ring spins
                silently and lands pointing at a single number.
              </p>
              <p>
                This wasn’t meant to replace dice; it just became a neat side
                effect of the engineering challenge.
              </p>
              <p>Why I’m posting here</p>
              <p>
                HN tends to appreciate: • micro-manufacturing • tolerances •
                machining challenges • precision mechanical design • unusual
                “why does this work?” projects
              </p>
              <p>
                I’d love to hear feedback on: • improving durability •
                minimizing friction losses • alternative ball materials •
                raceway finishing • any tricks for increasing spin time without
                adding thickness
              </p>
              <p>
                If anyone has experience with miniature bearings or wearable
                mechanical assemblies, I’d appreciate insights. Happy to answer
                questions about the build process, the tolerances, or the
                failures along the way.
              </p>
            </div>
          </section>
        </section>
        <section id="46053076">
          <h3>
            <a class="item" href="https://yandori.io/news-flow/"
              >Show HN: Real-time system that tracks how news spreads across
              200k websites</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-26 @ 01:27:16</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46053076"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
            <div class="text">
              <p>
                It uses Snowflake’s Arctic model for embeddings and HNSW for
                fast similarity search. Each “story cluster” shows who published
                first, how fast it propagated, and how the narrative evolved as
                more outlets picked it up.
              </p>
              <p>
                Would love feedback on the architecture, scaling approach, and
                any ways to make the clusters more accurate or useful.
              </p>
              <p>
                Live demo:
                <a href="https://yandori.io/news-flow/"
                  >https://yandori.io/news-flow/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46051422">
          <h3>
            <a class="item" href="https://cs193p.stanford.edu/"
              >Paul Hegarty's updated CS193p SwiftUI course released by
              Stanford</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-25 @ 22:11:50</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46051422"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
