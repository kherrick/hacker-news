<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36946553">
          <h3>
            <a
              class="item"
              href="https://www.uvm.edu/news/story/plans-plant-billions-trees-threatened-massive-undersupply-seedlings"
              >Plans to plant billions of trees threatened by undersupply of
              seedlings</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 18:10:18</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36946553"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36946104">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/health/2023/07/31/marijuana-addiction-legal-recreational-sales/"
              >Marijuana Addiction Is Real. Those Struggling Often Face
              Skepticism</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 17:36:55</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36946104"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36946022">
          <h3>
            <a class="item" href="https://michaelnotebook.com/qtr/index.html"
              >Michael Nielsen: Quick thoughts on research</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 17:30:29</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36946022"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36945979">
          <h3>
            <a
              class="item"
              href="https://www.streamtvinsider.com/video/amazon-modifies-ad-revenue-impressions-share-policy-international-fire-tv-apps"
              >Amazon requires services on Fire TV to give it 30% of ad
              impressions or revenue</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 17:27:14</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36945979"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36945559">
          <h3>
            <a class="item" href="https://www.easypost.com/careers"
              >EasyPost (YC S13) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 17:00:28</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36945206">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=Tuzh9mHvzkk"
              >Building Nikola Tesla's Bladeless Turbine [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 16:37:34</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36945206"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36945177">
          <h3>
            <a
              class="item"
              href="https://eighty-twenty.org/2023/07/31/dns-as-a-cdn"
              >Show HN: File distribution over DNS: (ab)using DNS as a CDN</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 16:35:54</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36945177"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36945046">
          <h3>
            <a
              class="item"
              href="https://github.com/coding-horror/basic-computer-games"
              >A repository of “BASIC Computer Games” code in modern
              languages</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 16:26:50</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36945046"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36944978">
          <h3>
            <a
              class="item"
              href="https://news.ku.dk/all_news/2023/07/pay-dirt-for-ice-core-scientists-in-east-greenland-as-they-reach-bedrock/"
              >Researchers reached the bottom of ice sheet at -2670m after 7
              years of drilling</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 16:22:28</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36944978"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36944947">
          <h3>
            <a
              class="item"
              href="https://www.vulture.com/2017/10/why-is-blade-runner-the-title-of-blade-runner.html"
              >Digging into the Odd History of Blade Runner’s Title (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 16:20:46</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36944947"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36944545">
          <h3>
            <a class="item" href="https://www.spicyweb.dev/farewell-jamstack/"
              >My Journey Away from the JAMstack</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 15:55:03</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36944545"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36944388">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36944388"
              >Ask HN: How do you monitor your systemd services?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 15:45:31</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36944388"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
            <div class="text">
              <p>Send a notifcation via notify-send</p>
              <p>Add `systemctl --failed` to my shell startup script</p>
              <p>Send myself emails</p>
              <p>
                None of these are quite ideal. Notifications are disruptive of
                the current workflow and ephemeral, meaning I might forget about
                it if I don't deal with it immediately. Similarly, reading
                `systemctl --failed` on every new terminal is also disruptive
                but at least it makes me not forget about it. Both of these are
                also not really applicable to server systems. Sending myself
                emails feels a bit wrong but has so far been the best solution.
              </p>
              <p>
                How are other people solving this? I did some research and I am
                surprised that there isn't a more rounded solution. I'd expect
                that pretty much every Linux user must run into this problem.
              </p>
            </div>
          </section>
        </section>
        <section id="36944223">
          <h3>
            <a
              class="item"
              href="https://www.baldurbjarnason.com/2023/the-floss-transition/"
              >Free and open source software projects are in transition</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 15:36:04</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36944223"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36944077">
          <h3>
            <a
              class="item"
              href="https://abroaden.substack.com/p/the-strange-way-airlines-are-actually"
              >The strange way airlines are actually central banks (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 15:27:13</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36944077"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36943874">
          <h3>
            <a class="item" href="https://github.com/r4d10n/retrogram-rtlsdr"
              >Retrogram rtl-SDR – a radio spectrum analyzer for your
              terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 15:15:56</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36943874"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36943866">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/rd/blog/2023-07-mastodon-distributed-decentralised-fediverse-activitypub"
              >BBC on Mastodon: experimenting with distributed and decentralised
              social media</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 15:15:06</span
              ><span class="points-container"
                >Points: <span class="points">245</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36943866"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36943495">
          <h3>
            <a
              class="item"
              href="https://www.sec.gov/news/press-release/2023-143"
              >SEC Charges Hex Founder Richard Heart with Misappropriating
              Millions of Dollars</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 14:53:17</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36943495"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36943318">
          <h3>
            <a
              class="item"
              href="https://navidre.medium.com/which-vector-database-should-i-use-a-comparison-cheatsheet-cb330e55fca"
              >Comparison of vector databases</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 14:42:41</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36943318"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36942967">
          <h3>
            <a class="item" href="https://www.alanshawn.com/latex3-tutorial/"
              >LaTeX3: Programming in LaTeX with Ease (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 14:23:59</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36942967"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36942651">
          <h3>
            <a
              class="item"
              href="https://engineering.mercari.com/en/blog/entry/20230731-x86-is-dead-long-live-x86/"
              >x86 is dead, long live x86</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 14:05:25</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36942651"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36942308">
          <h3>
            <a class="item" href="https://linkwarden.app"
              >Show HN: Linkwarden – An open source collaborative bookmark
              manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 13:41:21</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36942308"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
            <div class="text">
              <p>Please also visit/star our GitHub repo [1].</p>
              <p>
                Linkwarden was built using TypeScript and NextJS, backed by a
                PostgreSQL database for the lighter-weight data. The rest of the
                data can be chosen either to be stored on the filesystem, or
                stored on the cloud on Digital Ocean Space/AWS S3, the reason
                for the cloud storage solution was for the Cloud offering [2],
                we realized that the preserved webpages (archives) take up space
                pretty quickly and S3 was much more efficient for this task. On
                the front-end we used TailwindCSS for styling and Zustand for
                state management.
              </p>
              <p>
                You could either use our Cloud offering (with 14-day free trial)
                to directly support this project and experience Linkwarden, or
                you could self-host it on your own machine and have maximum
                flexibility.
              </p>
              <p>
                Feel free if you had any questions, we'll do our best to answer
                it.
              </p>
              <p>
                [1]:
                <a href="https://github.com/linkwarden/linkwarden"
                  >https://github.com/linkwarden/linkwarden</a
                >
              </p>
              <p>
                [2]:
                <a href="https://cloud.linkwarden.app/register"
                  >https://cloud.linkwarden.app/register</a
                >
                - Hosted in Digital Ocean's datacenter located here in Toronto,
                ON.
              </p>
            </div>
          </section>
        </section>
        <section id="36942166">
          <h3>
            <a
              class="item"
              href="https://archive.org/details/Cards_as_Weapons_-_Ricky_Jay_1977"
              >Cards as Weapons (1977)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 13:28:35</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36942166"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36942033">
          <h3>
            <a class="item" href="https://ianthehenry.com/posts/fibonacci/"
              >The Fibonacci Matrix</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 13:14:32</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36942033"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36941942">
          <h3>
            <a
              class="item"
              href="https://www.indiegogo.com/projects/paperlike-color-world-first-color-e-ink-monitor/coming_soon"
              >Paperlike Color: Color E-Ink Monitor</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 13:04:15</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36941942"
                  >Comments</a
                ><span class="descendants">: 151</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36941299">
          <h3>
            <a class="item" href="https://zknill.io/posts/edge-database/"
              >So, you want to deploy on the edge?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 11:54:00</span
              ><span class="points-container"
                >Points: <span class="points">202</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36941299"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36940916">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/Alpine-Linux-Prolific-Packager"
              >The Most Prolific Packager for Alpine Linux Is Stepping Away</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 11:01:45</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36940916"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36940626">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2023/07/31/nasa_mistakenly_disconnects_voyager_2/"
              >NASA mistakenly severs communication to Voyager 2</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-31 @ 10:15:50</span
              ><span class="points-container"
                >Points: <span class="points">272</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36940626"
                  >Comments</a
                ><span class="descendants">: 278</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36933512">
          <h3>
            <a class="item" href="https://explained.ai/matrix-calculus/"
              >The Matrix Calculus You Need for Deep Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-30 @ 17:18:12</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36933512"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36930322">
          <h3>
            <a
              class="item"
              href="https://medium.com/@Fcmam5/trying-to-become-a-better-developer-by-learning-more-about-aviation-5241e7092f7e"
              >Trying to become a better developer by learning more about
              aviation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-30 @ 12:03:49</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36930322"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36928605">
          <h3>
            <a
              class="item"
              href="https://www.imperialviolet.org/2023/07/29/voice-recognition.html"
              >Voice Recognition</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-30 @ 07:03:47</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36928605"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
