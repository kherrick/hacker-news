<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38877423">
          <h3>
            <a
              class="item"
              href="https://www.robinsloan.com/notes/home-cooked-app/"
              >An app can be a home-cooked meal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 10:03:27</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38877423"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38877399">
          <h3>
            <a class="item" href="https://github.com/GuntherRademacher/rr"
              >RR – Railroad Diagram Generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 09:59:37</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38877399"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38877321">
          <h3>
            <a
              class="item"
              href="https://mashable.com/article/youtube-demontizes-public-domain-steamboat-willie-disney-copyright-claim"
              >YouTube demonetizes public domain 'Steamboat Willie' video after
              copyright claim</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 09:43:35</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38877321"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38877204">
          <h3>
            <a class="item" href="https://github.com/Maratyszcza/PeachPy"
              >Portable Efficient Assembly Code-Generator in Higher-Level Python
              (PeachPy)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 09:20:40</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38877204"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38877115">
          <h3>
            <a
              class="item"
              href="https://matuzo.at/blog/2024/automated-testing-tools-and-web-components"
              >Not all automated testing tools support Shadow DOM in web
              components</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 09:02:25</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38877115"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38876863">
          <h3>
            <a class="item" href="https://belkadan.com/blog/2023/12/CellLVM/"
              >CellLVM: A proof-of-concept LLVM to Excel spreadsheet compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 08:10:50</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38876863"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38876617">
          <h3>
            <a
              class="item"
              href="https://www.brandons.me/blog/thoughts-on-testing"
              >Thoughts on Testing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 07:21:44</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38876617"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38875551">
          <h3>
            <a
              class="item"
              href="http://www.danamania.com/print/Apple%20Pascal%20Poster/PascalPosterV3%20A1.pdf"
              >Apple's classic Pascal poster, remade as a vector image [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 03:59:47</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38875551"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38875542">
          <h3>
            <a class="item" href="https://webrtcforthecurious.com/"
              >WebRTC for the Curious (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 03:58:24</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38875542"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38875452">
          <h3>
            <a class="item" href="https://mobile-aloha.github.io"
              >Learning bimanual mobile manipulation with low-cost whole-body
              teleoperation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 03:42:01</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38875452"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38875422">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/FeepingCreature/5dff669aad380a123b15659e195fb96c"
              >Don't pass structs bigger than 16 bytes on AMD64</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 03:36:13</span
              ><span class="points-container"
                >Points: <span class="points">235</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38875422"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38875318">
          <h3>
            <a
              class="item"
              href="https://github.com/binkley/modern-java-practices"
              >Modern Java/JVM Build Practices</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 03:18:55</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38875318"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38874885">
          <h3>
            <a
              class="item"
              href="https://www.da.vidbuchanan.co.uk/blog/python-swar.html"
              >SIMD in Pure Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-05 @ 02:09:58</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38874885"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38873810">
          <h3>
            <a
              class="item"
              href="https://smallstep.com/blog/home-network-eap-tls-wifi/"
              >WPA3 Enterprise 192-bit mode at home</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 23:44:02</span
              ><span class="points-container"
                >Points: <span class="points">272</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38873810"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38871987">
          <h3>
            <a class="item" href="https://www.clicks.tech/"
              >Clicks – Physical keyboard for iPhone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 20:43:20</span
              ><span class="points-container"
                >Points: <span class="points">771</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38871987"
                  >Comments</a
                ><span class="descendants">: 449</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38869366">
          <h3>
            <a
              class="item"
              href="https://people.inf.ethz.ch/wirth/ProjectOberon/PO.System.pdf"
              >Project Oberon: Design of an operating system, a compiler, and a
              computer [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 16:59:45</span
              ><span class="points-container"
                >Points: <span class="points">298</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38869366"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38868185">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38868185"
              >Launch HN: Rosebud (YC S19) – Turn game descriptions into browser
              games</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 15:33:50</span
              ><span class="points-container"
                >Points: <span class="points">257</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38868185"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.rosebud.ai/">https://www.rosebud.ai/</a>).
              We're building a platform to help users go from description to
              code to game. We aim to make game creation accessible to
              non-technical creators, so our UI provides explanations alongside
              the generated code.
              <p>
                Users have created a diverse range of games on Rosebud,
                including top-down RPGs, AI companions, and 3D obstacle courses,
                all within a few hours and sometimes minutes. Here are some
                examples you can play and clone (to start your own project).
              </p>
              <p>
                * Anime Jester Companion:
                <a
                  href="https://play.rosebud.ai/games/ba438cc4-246e-432e-b170-4e16948cd571"
                  >https://play.rosebud.ai/games/ba438cc4-246e-432e-b170-4e1694...</a
                >
                * Chat and Care for your Digital Puppy:
                <a
                  href="https://play.rosebud.ai/games/f32a8159-7acf-4db6-a82c-70296f90bbf1"
                  >https://play.rosebud.ai/games/f32a8159-7acf-4db6-a82c-70296f...</a
                >
                * Sphere Sync (3D game: align the sphere with the right color):
                <a
                  href="https://play.rosebud.ai/games/96dfd5e1-62d4-47d8-a3e9-11038c8bb5cf"
                  >https://play.rosebud.ai/games/96dfd5e1-62d4-47d8-a3e9-11038c...</a
                >
                * Basketball:
                <a
                  href="https://play.rosebud.ai/games/a0e70622-e923-4517-8c1f-728dcf0db486"
                  >https://play.rosebud.ai/games/a0e70622-e923-4517-8c1f-728dcf...</a
                >
                * Neon Waltz Generative Art:
                <a
                  href="https://play.rosebud.ai/games/e32bd12b-7cc9-4f9a-b385-42ae0b096466"
                  >https://play.rosebud.ai/games/e32bd12b-7cc9-4f9a-b385-42ae0b...</a
                >
                * Chat with Deku from My Hero Academia:
                <a
                  href="https://play.rosebud.ai/games/716fd998-aab6-4185-8375-85d9eeb2adca"
                  >https://play.rosebud.ai/games/716fd998-aab6-4185-8375-85d9ee...</a
                >
              </p>
              <p>
                A simple way to think about Rosebud is ChatGPT + Midjourney +
                Replit. ChatGPT, because we give users a chat interface for this
                code editor so they can describe the game they want to make and
                generate game code; Midjourney, because we let users generate
                assets inside Rosebud, 2D and 3D, to be used in their games; And
                Replit, because Rosebud includes a browser based code editor
                that lets you deploy your game instantly.
              </p>
              <p>
                Sometimes, users generate a code base from scratch via prompts.
                Often a simpler place to start is to modify (“clone”) an
                existing project on Rosebud. In both cases, we need to
                eventually convert user descriptions and modifications of the
                game into edits and changes to the codebase. To solve this
                problem, we had to experiment heavily with using LLM agents in
                production. Our agent framework tries to follow the instructions
                of user prompts by deciding when and whether to call upon a
                number of generative models (some for code generation, some for
                asset generation, some for character dialogue, and some for game
                ideas). It also must decide where to insert code snippets when
                it generates them. Often, a user is asking for ideas or
                something too vague, and our agent has to decide when to ask for
                feedback and clarifications.
              </p>
              <p>
                Not surprisingly, if we impose more constraints, on both the
                programming framework and game genres supported, our agent will
                perform better. However, the constraints on the types of games
                users can make and frameworks we want to support also constrains
                how flexible our platform is. Balancing these two factors, we
                decided to only support browser-based, JavaScript frameworks and
                focus on supporting AI NPCs that use LLMs themselves for
                dialogue and actions. This allows us to create abstractions that
                enable the agent to alter the codebase more successfully and
                guide the creator towards a more successful experience.
                Furthermore, we found that our beta testers are very creative
                with making AI character based games, and the resulting game is
                usually fun for players.
              </p>
              <p>
                How does Rosebud differ from Roblox, Unreal, or Unity simply
                adding a co-pilot? Incumbent game engines optimized their
                user-flow and tech stack before the advent of generative AI, and
                many of their user-flows are well established. We have the
                advantage of designing this game creation flow from the ground
                up. It's not just about adding code completion to an existing
                code editing app and including asset plugins. Such an approach
                wouldn't fully harness the power of LLMs. We have a chat-first
                interface, and having identified the limitations of agents, we
                can create more safeguards for users where failure is likely.
                Our approach will make it possible for non technical creators to
                also contribute to making games. Check it out for yourself!
              </p>
              <p>
                To try Rosebud: (1) head over to
                <a href="https://www.rosebud.ai/hn"
                  >https://www.rosebud.ai/hn</a
                >
                for access to our Discord beta tester channel and a special
                role. (2) then go to
                <a href="https://play.rosebud.ai">https://play.rosebud.ai</a>
                and use the code HelloHN to get immediate access. We have an
                array of trending projects that users can clone and mod to get
                started, including various character chat based games.
              </p>
              <p>
                Here’s a video onboarding of Rosebud in action:
                <a
                  href="https://www.youtube.com/watch?v=h99H3FefxU0&amp;ab_channel=RosebudAI"
                  >https://www.youtube.com/watch?v=h99H3FefxU0&amp;ab_channel=Roseb...</a
                >
              </p>
              <p>
                Re business model, we plan on following in Roblox’s footsteps,
                i.e. keep it free for developers and take a cut of what they can
                charge users. Since AI tools cost more from usage than just
                hosting, we may have to evolve that model and see what the unit
                economics are (and separate a premium versus free tier for
                devs).
              </p>
              <p>
                (Oh and in case you’re wondering why a YC S19 startup is
                launching now: we basically pivoted. We were always in consumer
                generative AI, but focused on images until this spring, but
                always wanted to focus on games–Rosebud is in fact a reference
                to the cheat code in The Sims. When code gen got good enough
                this year to work for UGC in gaming, we decided the time had
                finally come and switched.)
              </p>
              <p>
                Some encouraging user feedback from our beta: “I have done some
                modding before, and I must say, this is much easier. Even when I
                occasionally need to code, the AI can answer all my questions
                and tell me how to achieve what I want. Normally, I would have
                to conduct numerous Google searches. What you guys have created
                is truly amazing.” “I’ve used Chat GPT to help me code simple
                games in Unity. This seems more connected and easier to work
                through.” “This is fascinating. This is ** amazing. Yeah, I know
                it's obviously early on, but already works for rad generative
                art. I'll say that much.” “Can finally call myself a game
                developer lol. Damn that sounds so good.”
              </p>
              <p>
                We’re a small team working on this for the last few months, so a
                lot of things are far from perfect. Constructive feedback is
                very welcome!
              </p>
            </div>
          </section>
        </section>
        <section id="38867421">
          <h3>
            <a class="item" href="https://github.com/spotify/sparkey"
              >Sparkey: A simple constant key/value storage library</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 14:31:51</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38867421"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38866348">
          <h3>
            <a
              class="item"
              href="https://www.nms.ac.uk/explore-our-collections/stories/global-arts-cultures-and-design/grammar-of-ornament/"
              >Grammar of Ornament</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 12:48:56</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38866348"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38865131">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=17NrtKHdPDw"
              >Making Real-World Reinforcement Learning Practical [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 09:51:40</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38865131"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38864791">
          <h3>
            <a
              class="item"
              href="https://github.com/astoilkov/main-thread-scheduling"
              >Main-Thread-Scheduling</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 09:06:59</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38864791"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38864774">
          <h3>
            <a
              class="item"
              href="https://joisig.com/2023-holiday-side-project-turtles"
              >Turtles, a Shelly/Zigbee home automation tool in Elixir</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 09:05:31</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38864774"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38863817">
          <h3>
            <a class="item" href="https://andykong.org/blog/icloudconfusion"
              >Cleaning up my 200GB iCloud with some JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-04 @ 06:36:42</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38863817"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38860842">
          <h3>
            <a
              class="item"
              href="https://johnhawks.net/weblog/museo-nacional-de-antropologia-visit/"
              >A Visit to the Museo Nacional de Antropología, Mexico City
              (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-03 @ 22:42:46</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38860842"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38859396">
          <h3>
            <a class="item" href="https://timkellogg.me/blog/2024/01/03/birb"
              >Birb and Fossil: An RSS Revival?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-03 @ 20:28:53</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38859396"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38852316">
          <h3>
            <a
              class="item"
              href="https://arogozhnikov.github.io/2023/12/28/fastest-autograd.html"
              >Fastest autograd in the West</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-03 @ 09:49:32</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38852316"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38851025">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/science/archive/2022/10/pawpaw-fruit-taste-history/671646/"
              >Why don't grocery stores stock pawpaw fruit?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-03 @ 05:20:11</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38851025"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38850849">
          <h3>
            <a
              class="item"
              href="https://stories.miln.eu/graham/2016-08-29-shingle-spit-whitstable/"
              >The Shingle Spit in Whitstable</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-03 @ 04:44:52</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38850849"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38847581">
          <h3>
            <a
              class="item"
              href="https://edwarddonner.com/2024/01/02/fine-tuning-an-llm-on-240k-text-messages/"
              >A simulation of me: fine-tuning an LLM on 240k text messages</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-02 @ 21:50:54</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38847581"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38844332">
          <h3>
            <a
              class="item"
              href="https://bgammon.org/blog/20240101-hello-world/"
              >The free software powering bgammon.org</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-02 @ 17:34:49</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38844332"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
