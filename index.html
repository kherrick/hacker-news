<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39495919">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39495919"
              >Ask HN: How to survive as a homeless programmer in the winter
              (AB, Canada)?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 22:59:23</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39495919"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been trying to get "social support" through Alberta's
                online social services for over a month now and I even went so
                far as to walk 5 hours (round-trip, I have no car/license) to a
                physical Alberta Works center but I have not received any reason
                as to why I haven't had any response, email, or really any
                followup in any form from them despite trying to reach out to
                them through every means they provide. I also brought up the
                fact I had security concerns in regards to their systems when I
                went in person but that was brushed aside/ignored (to be fair,
                perhaps there's an official way to submit concerns? idk, I've
                just been very stressed and frustrated as of late). Funnily
                enough, a few days before I got evicted I received a letter
                telling me their systems were hacked a month ago and my SIN,
                DOB, all my personal info was stolen from their systems so now
                also worrying about my identity being stolen.
              </p>
              <p>
                <i>CW: trauma dumping, sorry..</i>
                I grew up alone for the first 8 years of life with an addict
                father. I've been diagnosed with PTSD. My mother left me to
                escape the abuse herself. When she regained custody it was
                better but she was a foster kid herself. She won't provide me a
                couch to sleep on + she kicked me out after my episode of
                psychosis years ago. I've been on my own since. I don't have
                friends/family I can turn to, some of that is partly my bad
                choices but I also got a crappy hand in life. I really hope a VC
                opportunity/job application will work out soon. I wasted lots of
                $ on a psychologist for 6 years to try to "heal" (now I think
                80%? of that "industry" is BS.), was told not to worry about
                being homeless + turned out that they're into astrology.. +
                recommended against my decision to stop seeing them after I saw
                red flags, I made the mistake of listening and wasted more
                time/money due to loneliness :/
                <i>End CW</i>
              </p>
              <p>
                I'm kind of at my wits end now. I was able to social engineer
                myself into being a 'visitor' at a hospital for the past week
                but security got suspicious + said I have to spend more time
                visiting and less time lounging. I don't know where I'm going to
                sleep tonight + I'm scared of having my laptop stolen. I'm
                looking for work in anything now. I know how to program, how to
                learn/adapt "quickly" (so can most people in this industry I'd
                guess lol), write ETL pipelines, develop websites from
                front-to-back, reverse engineer at a 'basic' level, deploy to
                Linode/AWS/DO/Azure, basic DevOps, Bash scripting, Go, Python,
                TS/JS, etc. But I have no official degree/certs. I tend to get
                along with people I talk to IRL but I'm not great at forming
                long-term IRL relationships except online.Not sure why I'm
                sharing this with HN, doesnt seem fitting but this is one of the
                few places I've been able to find like-minded people who
                think/share cool things on topics I like, I've always struggled
                to find that IRL :/ Anyways, I'm going to go and try to
                find/steal some food now, I'll likely not be back online to
                reply to comments anytime soon. I hope I'll be able to survive
                tonight/the next few weeks until it warms up :/ I hope none of
                you screw up/have to go through something like this
              </p>
              <p>
                Take care, - Krowfooten (a non-public pseudonym - can also email
                me at -&gt; simplelogin.nxw38@aleeas.com - love to talk tech/can
                share more about my project in a 'private' place :)
              </p>
            </div>
          </section>
        </section>
        <section id="39495837">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/hard-science-fiction-computer"
              >Science Fiction Short: Hijack</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 22:47:29</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39495837"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39495654">
          <h3>
            <a class="item" href="http://programming-motherfucker.com/"
              >Programming, Motherfucker Do you speak it?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 22:20:52</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39495654"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39495476">
          <h3>
            <a
              class="item"
              href="https://minimaxir.com/2024/02/chatgpt-tips-analysis/"
              >Does offering ChatGPT a tip cause it to generate better text?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 21:57:33</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39495476"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39495466">
          <h3>
            <a
              class="item"
              href="http://www.righto.com/2024/02/the-first-microcomputer-transfluxor.html"
              >The first microcomputer: The transfluxor-powered Arma Micro
              Computer from 1962</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 21:56:22</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39495466"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39495355">
          <h3>
            <a
              class="item"
              href="https://steveklabnik.com/writing/how-does-bluesky-work"
              >How Does Bluesky Work?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 21:38:04</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39495355"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39495125">
          <h3>
            <a
              class="item"
              href="https://www.emergetools.com/careers/jobs/growth-engineer"
              >Emerge (YC W21) is hiring a growth engineer (remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 21:01:59</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39494925">
          <h3>
            <a
              class="item"
              href="https://matklad.github.io/2021/02/06/ARCHITECTURE.md.html"
              >Architecture.md (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 20:33:47</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39494925"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39494796">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20240222-depaving-the-cities-replacing-concrete-with-earth-and-plants"
              >Cities stripping out concrete for earth and plants</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 20:16:37</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39494796"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39494760">
          <h3>
            <a
              class="item"
              href="https://www.commerce.gov/news/press-releases/2024/02/ntia-solicits-comments-open-weight-ai-models"
              >NTIA Solicits Comments on Open-Weight AI Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 20:11:56</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39494760"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39494735">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/sciadv.adk3198"
              >Plasticity through patterned ultrasound-induced brainwave
              entrainment in mice</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 20:07:25</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39494735"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39494728">
          <h3>
            <a class="item" href="https://allthatsinteresting.com/david-hahn"
              >David Hahn, the 'radioactive boy scout' who tried to build a
              nuclear reactor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 20:06:39</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39494728"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39494227">
          <h3>
            <a
              class="item"
              href="https://dansalva.to/coding-the-anime-woosh-screen-on-amiga/"
              >Coding the anime "woosh" screen on Amiga</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 19:05:13</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39494227"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39493989">
          <h3>
            <a class="item" href="https://github.com/Frimkron/mud-pi"
              >A simple MUD server in Python which can be run on a Raspberry
              Pi</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 18:40:36</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39493989"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39493770">
          <h3>
            <a
              class="item"
              href="https://openrss.org/blog/how-google-helped-destroy-adoption-of-rss-feeds"
              >Google helped destroy adoption of RSS feeds (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 18:16:19</span
              ><span class="points-container"
                >Points: <span class="points">720</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39493770"
                  >Comments</a
                ><span class="descendants">: 250</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39493237">
          <h3>
            <a class="item" href="https://pudding.cool/2024/02/anthems/"
              >Quantifying the diva-ness of national anthem performances</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 17:19:31</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39493237"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39493219">
          <h3>
            <a class="item" href="https://github.com/candy-lang/candy"
              >Candy – a minimalistic functional programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 17:17:41</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39493219"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39493179">
          <h3>
            <a class="item" href="https://alexharri.com/blog/bit-set-iteration"
              >Iterating over bit sets quickly</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 17:11:42</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39493179"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39492924">
          <h3>
            <a class="item" href="https://lock.cmpxchg8b.com/ledger.html"
              >Ledger</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 16:46:35</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39492924"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39492556">
          <h3>
            <a
              class="item"
              href="https://deepcuts.blog/2024/02/24/deeper-cut-lovecraftian-movie-posters-from-ghana/"
              >Lovecraftian movie posters from Ghana</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 16:02:43</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39492556"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39492323">
          <h3>
            <a
              class="item"
              href="https://www.africanhistoryextra.com/p/the-complete-history-of-gondar-africas"
              >The complete history of Gondar: Africa's city of castles
              (1636-1900)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 15:41:51</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39492323"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39491863">
          <h3>
            <a class="item" href="https://effectiviology.com/shirky-principle/"
              >Institutions try to preserve the problem to which they are the
              solution</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 14:53:08</span
              ><span class="points-container"
                >Points: <span class="points">860</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39491863"
                  >Comments</a
                ><span class="descendants">: 562</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39491851">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2024/02/a-meteorite-has-been-lost-in-the-sahara-since-1916-heres-how-we-might-find-it/"
              >A giant meteorite has been lost in the desert since 1916</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 14:52:10</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39491851"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39491040">
          <h3>
            <a
              class="item"
              href="https://destevez.net/2024/01/trying-to-decode-lev-1/"
              >Trying to Decode Lev-1</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 12:33:37</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39491040"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39490543">
          <h3>
            <a
              class="item"
              href="https://www.evalapply.org/posts/how-to-not-die-by-a-thousand-cuts/index.html"
              >How to think about software quality (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 10:25:13</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39490543"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39490264">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/962787/35f1ff3af9031437/"
              >A modest update to Qubes OS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 09:13:42</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39490264"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39489431">
          <h3>
            <a
              class="item"
              href="https://www.vox.com/down-to-earth/2024/2/7/24057308/earth-global-greening-climate-change-carbon"
              >The Earth is getting greener</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 05:48:55</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39489431"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39489427">
          <h3>
            <a class="item" href="https://queue.acm.org/detail.cfm?id=1647302"
              >What DNS Is Not (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 05:47:34</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39489427"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39489395">
          <h3>
            <a
              class="item"
              href="http://theor.jinr.ru/~vnaumov/Eng/JINR_Lectures/books/Close2010.pdf"
              >Neutrino (2010) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 05:36:11</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39489395"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39488668">
          <h3>
            <a
              class="item"
              href="https://explainextended.com/2023/12/31/happy-new-year-15/"
              >GPT in 500 Lines of SQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-24 @ 02:45:31</span
              ><span class="points-container"
                >Points: <span class="points">919</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39488668"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
