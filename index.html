<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42704795">
          <h3>
            <a class="item" href="https://chatgpt.com/?model=gpt-4o-jawbone"
              >GPT-4o with scheduled tasks (jawbone) is available in beta</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 22:25:54</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42704795"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42703464">
          <h3>
            <a
              class="item"
              href="https://usa.streetsblog.org/2025/01/10/alarming-report-shows-that-two-auto-braking-systems-cant-see-people-in-reflective-garb"
              >Two auto-braking systems can't see people in reflective garb:
              report</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 20:35:17</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42703464"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42703422">
          <h3>
            <a
              class="item"
              href="https://ip-vote.com/geolocation_via_latency.html"
              >Proof of location for online polls</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 20:31:19</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42703422"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42703282">
          <h3>
            <a
              class="item"
              href="https://philipotoole.com/how-is-rqlite-tested/"
              >How rqlite is tested</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 20:21:47</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42703282"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42700997">
          <h3>
            <a
              class="item"
              href="https://docs.google.com/spreadsheets/d/1TPeJzW5pa-BiJZjuEa1yGSFs7ZJetbnxf2gjMvv4tkc/htmlview#gid=1160377357"
              >Home Loss File System</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 17:54:51</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42700997"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42700852">
          <h3>
            <a
              class="item"
              href="https://docs.marimo.io/guides/publishing/playground/#open-notebooks-hosted-on-github"
              >Show HN: WASM-powered codespaces for Python notebooks on
              GitHub</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 17:46:41</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42700852"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              <p>
                Last year, we shared marimo [1], an open-source reactive
                notebook for Python with support for execution through
                WebAssembly [2].
              </p>
              <p>
                We wanted to share something new: you can now run marimo and
                Jupyter notebooks directly from GitHub in a Wasm-powered,
                codespace-like environment. What makes this powerful is that we
                mount the GitHub repository's contents as a filesystem in the
                notebook, making it really easy to share notebooks with data.
              </p>
              <p>
                All you need to do is prepend 'marimo.app' to any Python
                notebook on GitHub. Some examples:
              </p>
              <p>
                - Jupyter Notebook:
                <a
                  href="https://marimo.app/github.com/jakevdp/PythonDataScienceHandbook/blob/master/notebooks/02.08-Sorting.ipynb"
                  >https://marimo.app/github.com/jakevdp/PythonDataScienceHandb...</a
                >
              </p>
              <p>
                - marimo notebook:
                <a
                  href="https://marimo.app/github.com/marimo-team/marimo/blob/07e8d14109f7312f19916fd13e4046a561a740f8/examples/third_party/polars/polars_example.py"
                  >https://marimo.app/github.com/marimo-team/marimo/blob/07e8d1...</a
                >
              </p>
              <p>
                Jupyter notebooks are automatically converted into marimo
                notebooks using basic static analysis and source code
                transformations. Our conversion logic assumes the notebook was
                meant to be run top-down, which is usually but not always true
                [3]. It can convert many notebooks, but there are still some
                edge cases.
              </p>
              <p>
                We implemented the filesystem mount using our own FUSE-like
                adapter that links the GitHub repository’s contents to the
                Python filesystem, leveraging Emscripten’s filesystem API. The
                file tree is loaded on startup to avoid waterfall requests when
                reading many directories deep, but loading the file contents is
                lazy. For example, when you write Python that looks like
              </p>
              <p>```python</p>
              <p>with open("./data/cars.csv") as f: print(f.read())</p>
              <p># or</p>
              <p>import pandas as pd pd.read_csv("./data/cars.csv")</p>
              <p>```</p>
              <p>
                behind the scenes, you make a request [4] to
                <a
                  href="https://raw.githubusercontent.com/&lt;org&gt;/&lt;repo&gt;/main/data/cars.csv"
                  >https://raw.githubusercontent.com/&lt;org&gt;/&lt;repo&gt;/main/data/car...</a
                >.
              </p>
              <p>
                Docs:
                <a
                  href="https://docs.marimo.io/guides/publishing/playground/#open-notebooks-hosted-on-github"
                  >https://docs.marimo.io/guides/publishing/playground/#open-no...</a
                >
              </p>
              <p>
                [1]
                <a href="https://github.com/marimo-team/marimo"
                  >https://github.com/marimo-team/marimo</a
                >
              </p>
              <p>
                [2]
                <a href="https://news.ycombinator.com/item?id=39552882"
                  >https://news.ycombinator.com/item?id=39552882</a
                >
              </p>
              <p>
                [3]
                <a
                  href="https://blog.jetbrains.com/datalore/2020/12/17/we-downloaded-10-000-000-jupyter-notebooks-from-github-this-is-what-we-learned/"
                  >https://blog.jetbrains.com/datalore/2020/12/17/we-downloaded...</a
                >
              </p>
              <p>
                [4] We technically proxy it through the playground
                <a href="https://marimo.app">https://marimo.app</a> to fix CORS
                issues and GitHub rate-limiting.
              </p>
            </div>
          </section>
        </section>
        <section id="42700755">
          <h3>
            <a
              class="item"
              href="https://www.whitehouse.gov/briefing-room/presidential-actions/2025/01/14/executive-order-on-advancing-united-states-leadership-in-artificial-intelligence-infrastructure/"
              >Executive order on advancing United States leadership in AI
              infrastructure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 17:40:27</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42700755"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42699977">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/tech-industry/apple-will-soon-receive-made-in-america-chips-from-tsmcs-arizona-fab-company-in-final-stages-of-quality-verification"
              >Apple will soon receive 'made in America' chips from TSMC's
              Arizona fab</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 16:56:47</span
              ><span class="points-container"
                >Points: <span class="points">387</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42699977"
                  >Comments</a
                ><span class="descendants">: 341</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42699099">
          <h3>
            <a
              class="item"
              href="https://trufflesecurity.com/blog/millions-at-risk-due-to-google-s-oauth-flaw"
              >Google’s OAuth login doesn’t protect against purchasing a failed
              startup domain</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 16:14:01</span
              ><span class="points-container"
                >Points: <span class="points">374</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42699099"
                  >Comments</a
                ><span class="descendants">: 202</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42698981">
          <h3>
            <a
              class="item"
              href="https://guix.gnu.org/en/blog/2024/the-shepherd-1.0.0-released/"
              >The Shepherd 1.0.0 released</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 16:07:23</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42698981"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42698753">
          <h3>
            <a
              class="item"
              href="https://arena-ai.github.io/structured-logprobs/"
              >Show HN: Value likelihoods for OpenAI structured output</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 15:52:43</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42698753"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42697767">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/craniometrix/jobs/5Ucqf0Q-founding-full-stack-engineer-cto-track"
              >Craniometrix (YC W22) is hiring a founding engineer on CTO
              track</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 14:43:04</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42697764">
          <h3>
            <a
              class="item"
              href="https://www.getdbt.com/blog/dbt-labs-acquires-sdf-labs"
              >Dbt Labs acquires SDF Labs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 14:42:54</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42697764"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42697335">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=H-nO1F-AO9I"
              >Servo vs. steppers: Speed, Torque and Accuracy [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 14:05:40</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42697335"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42695580">
          <h3>
            <a
              class="item"
              href="https://nautil.us/the-rise-and-fall-of-the-english-sentence-236880/"
              >The rise and fall of the English sentence (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 10:02:56</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42695580"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42695547">
          <h3>
            <a class="item" href="https://ffmpegbyexample.com/"
              >FFmpeg by Example</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 09:58:15</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42695547"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42695232">
          <h3>
            <a
              class="item"
              href="https://dashbit.co/blog/data-evolution-with-set-theoretic-types"
              >Data evolution with set-theoretic types</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-14 @ 09:08:13</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42695232"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42686144">
          <h3>
            <a class="item" href="https://ryanis.cool/cosmos/"
              >Cosmos Keyboard: Scan your hand, build a keyboard</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-13 @ 17:42:00</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42686144"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42683635">
          <h3>
            <a
              class="item"
              href="https://www.sfgate.com/travel/article/hotel-booking-sites-overcharge-bay-area-travelers-20025145.php"
              >Hotel booking sites overcharge Bay Area customers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-13 @ 14:18:48</span
              ><span class="points-container"
                >Points: <span class="points">173</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42683635"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42683494">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42683494"
              >Ask HN: How do you prevent the impact of social media on your
              children?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-13 @ 14:02:39</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42683494"
                  >Comments</a
                ><span class="descendants">: 172</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm curious to know what kinds of methods you have implemented
                to manage this or whether you feel the same as me
              </p>
            </div>
          </section>
        </section>
        <section id="42682660">
          <h3>
            <a class="item" href="https://octopus.com/devops/"
              >The DevOps Engineer's Handbook</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-13 @ 12:17:43</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42682660"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42681976">
          <h3>
            <a
              class="item"
              href="https://blog.joinmastodon.org/2025/01/the-people-should-own-the-town-square/"
              >Mastodon announces new European non-profit, change of CEO</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-13 @ 10:23:50</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42681976"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42679998">
          <h3>
            <a
              class="item"
              href="https://www.abc.net.au/news/2024-12-03/carnarvon-nasa-dish-receives-signal-repairs/104672866"
              >Carnarvon's NASA satellite dish receives first signal in almost
              40 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-13 @ 04:09:24</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42679998"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42675529">
          <h3>
            <a class="item" href="https://modal.com/gpu-glossary/readme"
              >The Missing Nvidia GPU Glossary</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 18:22:07</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42675529"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42673815">
          <h3>
            <a
              class="item"
              href="https://dbrgn.ch/stories-from-the-internet.html"
              >Stories from the Internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 14:36:00</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42673815"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42672015">
          <h3>
            <a
              class="item"
              href="https://www.instructables.com/Virtual-Vette-Racing-Simulator-Built-From-Wrecked-/"
              >Virtual Vette – Racing Simulator Built from Wrecked Corvette</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 08:04:57</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42672015"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42666851">
          <h3>
            <a
              class="item"
              href="https://www.dgt.is/blog/2025-01-10-nix-death-by-a-thousand-cuts/"
              >Nix – Death by a Thousand Cuts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-11 @ 16:19:56</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42666851"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42662265">
          <h3>
            <a class="item" href="https://cassidoo.co/post/css-for-dialogs/"
              >A couple CSS tricks for HTML Dialog elements</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-11 @ 00:59:13</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42662265"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42660619">
          <h3>
            <a class="item" href="https://glicol.org/"
              >Glicol: Next-generation computer music language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-10 @ 21:44:24</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42660619"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42660606">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/reversible-computing"
              >Reversible computing escapes the lab</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-10 @ 21:42:54</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42660606"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
