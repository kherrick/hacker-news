<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39367540">
          <h3>
            <a
              class="item"
              href="https://www.hezmatt.org/~mpalmer/blog/2024/02/13/not-all-tlds-are-created-equal.html"
              >Not all TLDs are Created Equal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 07:51:07</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39367540"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39367264">
          <h3>
            <a
              class="item"
              href="https://implementing.substack.com/p/how-to-summarize-youtube-video-using"
              >How to summarize YouTube videos using artificial intelligence</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 07:01:25</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39367264"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39367141">
          <h3>
            <a class="item" href="https://largeworldmodel.github.io/"
              >UC Berkley: World Model on Million-Length Video and Language with
              RingAttention</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 06:34:59</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39367141"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39367103">
          <h3><a class="item" href="https://quarto.org/">Quarto</a></h3>
          <section>
            <h4>
              <span>2024-02-14 @ 06:27:39</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39367103"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39365935">
          <h3>
            <a
              class="item"
              href="https://twitter.com/karpathy/status/1757600075281547344"
              >Hi everyone yes, I left OpenAI yesterday</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 03:08:18</span
              ><span class="points-container"
                >Points: <span class="points">432</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39365935"
                  >Comments</a
                ><span class="descendants">: 220</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39365187">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/ibm-history"
              >100 Years Ago, IBM Was Born</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 01:20:42</span
              ><span class="points-container"
                >Points: <span class="points">202</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39365187"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39365142">
          <h3>
            <a
              class="item"
              href="https://lgrmag.com/news/light-bio-to-introduce-bioluminescent-petunias-into-u-s-market/"
              >Bioluminescent petunias now available for U.S. market</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 01:14:34</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39365142"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39365135">
          <h3>
            <a class="item" href="https://athenacrisis.com"
              >Show HN: Play the game I'm developing directly on its website</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 01:13:56</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39365135"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
            <div class="text">
              <p>
                Previously the landing page had a video of the game but my goal
                was to always just put the actual game on the website. I merged
                the landing page into the game's monorepo, added the game's
                React components, and boom – the video was replaced with a
                playable version of Athena Crisis.
              </p>
              <p>
                Of course, the real game has tons more features, but the landing
                page now always runs the exact same code as the actual game –
                including assets, the AI, and the UI/UX – and it is pushed
                within 5 minutes as the actual game is being updated live.
              </p>
              <p>
                I frequently talk about the tech behind this game (see this
                React Summit talk about "How Not to Build a Video Game":
                <a href="https://www.youtube.com/watch?v=m8SmXOTM8Ec"
                  >https://www.youtube.com/watch?v=m8SmXOTM8Ec</a
                >
                ) and I'm planning on open sourcing as much as possible in the
                future.
              </p>
            </div>
          </section>
        </section>
        <section id="39365104">
          <h3>
            <a
              class="item"
              href="https://warwick.ac.uk/newsandevents/pressreleases/?newsItem=8a17841a8d79730b018d9e2bbb0e054b"
              >Protein biomarkers predict dementia 15 years before diagnosis in
              new study</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 01:09:36</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39365104"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39364576">
          <h3>
            <a
              class="item"
              href="https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2023.1219945/full"
              >Handwriting but not typewriting leads to widespread brain
              connectivity</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 00:00:15</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39364576"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39364537">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39364537"
              >Ask HN: Anyone left software to study non-STEM subjects?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 23:55:11</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39364537"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              Has anyone left software engineering to study something not in the
              sciences? How did that go?
            </div>
          </section>
        </section>
        <section id="39363675">
          <h3>
            <a class="item" href="https://pola.rs/posts/polars_birds_eye_view/"
              >A bird's eye view of Polars</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 22:25:14</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39363675"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39363499">
          <h3>
            <a class="item" href="https://fly.io/blog/fly-io-has-gpus-now/"
              >Fly.io has GPUs now</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 22:06:51</span
              ><span class="points-container"
                >Points: <span class="points">459</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39363499"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39363479">
          <h3>
            <a
              class="item"
              href="https://tedium.co/2024/02/09/intel-pci-standardization-history/"
              >The Sneaky Standard – Intel PCI Standardization History</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 22:04:31</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39363479"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39362777">
          <h3>
            <a
              class="item"
              href="https://www.deusinmachina.net/p/compiling-history-a-brief-tour-of"
              >Compiling History: A brief tour of C compilers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 21:01:29</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39362777"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39362774">
          <h3>
            <a class="item" href="https://www.tesorio.com/careers#job-openings"
              >Tesorio (YC S15) Is Hiring a Head of Infrastructure (100%
              Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 21:01:15</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39360106">
          <h3>
            <a class="item" href="https://github.com/Stability-AI/StableCascade"
              >Stable Cascade</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 17:23:22</span
              ><span class="points-container"
                >Points: <span class="points">624</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39360106"
                  >Comments</a
                ><span class="descendants">: 136</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39359545">
          <h3>
            <a
              class="item"
              href="https://www.npr.org/sections/health-shots/2020/03/23/820274501/her-incredible-sense-of-smell-is-helping-scientists-find-new-ways-to-diagnose-di"
              >A woman who can smell Parkinson's is inspiring research into
              diagnosis (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 16:42:32</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39359545"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39358884">
          <h3>
            <a class="item" href="https://github.com/jcarlosroldan/oink"
              >Oink: An API for PHP in a single file</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 16:00:44</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39358884"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39357928">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39357928"
              >Show HN: Linen.team – A lightweight, thread-first Slack
              alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 14:31:56</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39357928"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
            <div class="text">
              <a href="https://linen.team/">https://linen.team/</a>), a
              lightweight threaded messaging app for your team.
              <p>
                Modern workplace messaging apps (like Slack) are based on IRC,
                which is great for small groups, but as it scales, breaks down
                quickly: you either get overwhelmed by notifications or you have
                to turn them all off. Most chat apps have threads tacked on but
                aren't built from the ground up with this design in mind. We
                wanted to create a thread-first experience where you can
                organize and prioritize conversations so that you are not
                reliant on notifications to make sure you don’t miss anything.
              </p>
              <p>
                In apps like Slack, you have to check activities, channels,
                threads, and replies just to make sure you aren't missing
                anything important. We designed every message in Linen to belong
                to a thread, so it makes it easy to centralize everything in a
                single location. We let you select which channels you subscribe
                to from your inbox. This way, your inbox only has the important
                channels. This makes it easy to keep track of conversations
                without having to rely on notifications to make sure you don’t
                miss anything.
              </p>
              <p>
                We also wanted a better way to separate urgent vs. non-urgent
                communication. In Linen, we have introduced the concept of a
                !mention that is designed for urgent/time-sensitive messages. A
                !mention will send a push notification, whereas an @mention will
                show up in the person’s inbox. This allows us to encourage more
                async conversations and reduce the need for the number of push
                notifications. We also designed the mention system closely with
                the inbox so that even if you aren’t subscribed to channels,
                mentions will still appear in your inbox. This is great for
                joining partner teams where you don’t need to view every
                conversation but do need to respond when you are mentioned.
              </p>
              <p>
                We believe that most messaging apps are secretly to-do lists in
                disguise; you have to read, respond, or do some task when you
                receive a thread. We wanted to give you the ability to manage
                threads individually. We let you mark each thread as done, which
                hides them from your inbox and is useful to keep track of tasks.
                You also can set reminders and mute threads with one click/key.
                With these features, we make it easy to get to a zero inbox
                state. This combined with the inbox makes it easy for you to
                keep track of conversations and make sure you don’t miss
                anything.
              </p>
              <p>
                Linen is designed for power users. We love keyboard shortcuts
                and want an experience that is keyboard-first. For many, the
                messaging app is the app that is used the most. We believe that
                you should be able to use Linen for an entire day without
                touching the mouse. We’ve added modern features like CMD+K for
                navigation. We’ve designed Linen to be fast and lightweight. Our
                gzipped bundle size is 400KB, so it's fast on first load, and
                we’ve introduced multiple layers of caching to make sure things
                are fast on subsequent loads.
              </p>
              <p>
                We’ve been working hard on this app for the past 6 months, so
                there are still gaps in the platform. But we’re also very
                excited about the direction we can take. Our focus is on what a
                modern message platform built in 2024 should look like and what
                lessons we can take from the previous decades of IRC and
                messaging apps. If our message resonates with you, we would love
                for you to give us a try at
                <a href="https://www.linen.team/signup?callbackUrl=%2Flinen"
                  >https://www.linen.team/signup?callbackUrl=%2Flinen</a
                >, where you can join our public community and come say hi!
              </p>
            </div>
          </section>
        </section>
        <section id="39357709">
          <h3>
            <a
              class="item"
              href="https://blog.jgc.org/2024/02/the-original-www-proposal-is-word-for.html"
              >Original WWW proposal is a Word for Macintosh 4 file from 1990,
              can we open it?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 14:06:00</span
              ><span class="points-container"
                >Points: <span class="points">436</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39357709"
                  >Comments</a
                ><span class="descendants">: 185</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39357436">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2401.08710"
              >Dynamic Voltage and Frequency Scaling for Intermittent
              Computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 13:35:14</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39357436"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39357293">
          <h3>
            <a
              class="item"
              href="http://www.righto.com/2019/11/ibm-sonic-delay-lines-and-history-of.html"
              >IBM, sonic delay lines, and the history of the 80×24 display</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 13:15:28</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39357293"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39357155">
          <h3>
            <a
              class="item"
              href="https://adam.nels.onl//blog/maybe-everything-is-a-coroutine/"
              >Maybe Everything Is a Coroutine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 12:54:47</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39357155"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39357015">
          <h3>
            <a class="item" href="https://github.com/sidju/hired"
              >Hired: A Modern Take on 'Ed'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 12:31:55</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39357015"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39356920">
          <h3>
            <a
              class="item"
              href="https://antithesis.com/blog/is_something_bugging_you/"
              >Is something bugging you?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 12:13:12</span
              ><span class="points-container"
                >Points: <span class="points">1016</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39356920"
                  >Comments</a
                ><span class="descendants">: 368</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39356530">
          <h3>
            <a
              class="item"
              href="https://kernel-recipes.org/en/2023/schedule/getting-the-rk3588-soc-supported-upstream/"
              >Getting the RK3588 SoC supported in upstream Linux (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 10:56:04</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39356530"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39356259">
          <h3>
            <a
              class="item"
              href="https://www.koaa.com/news/news5-originals/the-last-linotype-newspaper-operating-the-saguache-crescent"
              >The Last Linotype Newspaper (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 10:17:32</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39356259"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39355744">
          <h3>
            <a
              class="item"
              href="https://textquery.app/2024/02/06/nokia-made-too-many-phones/"
              >Nokia made too many phones</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-13 @ 08:35:01</span
              ><span class="points-container"
                >Points: <span class="points">225</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39355744"
                  >Comments</a
                ><span class="descendants">: 280</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39343777">
          <h3>
            <a
              class="item"
              href="https://interrupt.memfault.com/blog/measuring-stack-usage"
              >Measuring Stack Usage the Hard Way</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-12 @ 11:40:20</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39343777"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
