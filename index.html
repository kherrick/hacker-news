<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40618079">
          <h3>
            <a
              class="item"
              href="https://blog.archive.org/2024/06/01/the-backrooms-of-the-internet-archive/"
              >The Backrooms of the Internet Archive</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 15:17:53</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40618079"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40617877">
          <h3>
            <a class="item" href="https://github.com/sushrut141/pg_analytica"
              >Show HN: Pg_analytica â€“ Speed up queries by exporting tables to
              columnar format</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 14:46:53</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40617877"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40617786">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40617786"
              >Ask HN: How to handle a senior hire turning out to be junior?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 14:34:22</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40617786"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
            <div class="text">
              <p>
                Essentially we had deficiencies in our technical interview that
                allowed for custom-fit preparation, the candidate excelled at
                selling themselves and negotiating, and there was a breakdown in
                internal communication where HR was under the impression we
                wanted to hire at any cost despite us giving the candidate a
                mediocre rating.
              </p>
              <p>
                Now we've found they're struggling to do even basic stuff
                without help and are far from helping others or even taking
                ownership of minor areas.
              </p>
              <p>
                They suffer from imposter syndrome (appropriately for once),
                which further hampers their productivity, communication, and
                growth as they're reluctant to ask for help with tasks they know
                should be easy, and equally reluctant to join the efforts of
                others who might notice their deficiencies.
              </p>
              <p>
                The result is net-negative productivity. It would probably take
                another 6-12 months of intense training to get them somewhat
                productive, and several years to get them closer to the level we
                hired them at, assuming we can accelerate their learning.
              </p>
              <p>
                This would require addressing the elephant in the room that
                they're not at the level we assumed, so that they will
                understand why we're changing the work mode, accept that
                learning should be a high priority, and feel permitted to seek
                more help when they need it. We probably can't reduce the
                salary, so more productive devs might also be offended if they
                become aware of it.
              </p>
              <p>
                Even if we were to successfully address this elephant in the
                room, they might at some point realize they can't catch up to
                the level they were hired at without years of dedicated effort
                and thus quit or "quit internally", making our investment
                pointless.
              </p>
              <p>
                I guess in most companies this would be a no-brainer, but we're
                a small outfit with a focus on personal development, intrinsic
                motivation, good climate, and low turnover.
              </p>
              <p>
                Do you think there is any way to rescue this situation? Or
                should we make this (perhaps justifiably, after their misleading
                self-presentation) the first time we let someone go for
                performance reasons?
              </p>
            </div>
          </section>
        </section>
        <section id="40617160">
          <h3>
            <a
              class="item"
              href="https://spj.science.org/doi/10.34133/cbsystems.0092"
              >Finite-Time Topology Identification of Delayed Complex Dynamical
              Networks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 12:39:56</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40617160"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40617096">
          <h3>
            <a
              class="item"
              href="https://www.hcn.org/articles/the-wests-wetlands-are-struggling-some-have-been-overlooked-altogether/"
              >Forested wetlands are missing from maps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 12:27:14</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40617096"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40617082">
          <h3>
            <a class="item" href="https://github.com/SilasMarvin/lsp-ai"
              >LSP-AI: open-source language server serving as back end for AI
              code assistance</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 12:24:58</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40617082"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40616881">
          <h3>
            <a
              class="item"
              href="https://spritely.institute/static/papers/scheme-primer.html"
              >A Scheme Primer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 11:28:41</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40616881"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40616856">
          <h3>
            <a
              class="item"
              href="https://storymaps.arcgis.com/stories/cf05c50f058a40e99e2da54ec098a40a"
              >June 7, 2023 Wildfire Smoke Event</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 11:23:05</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40616856"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40615530">
          <h3>
            <a
              class="item"
              href="https://brr.fyi/posts/south-pole-water-infrastructure"
              >South Pole Water Infrastructure</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 05:41:43</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40615530"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40614338">
          <h3>
            <a
              class="item"
              href="https://www.EmbeddedRelated.com/showarticle/152.php"
              >Chebyshev approximation and how it can help (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 00:37:57</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40614338"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40614227">
          <h3>
            <a
              class="item"
              href="https://www.fox13seattle.com/news/william-anders-wa-plane-crash"
              >Apollo 8 astronaut William Anders ID'd in WA plane crash</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-08 @ 00:16:35</span
              ><span class="points-container"
                >Points: <span class="points">374</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40614227"
                  >Comments</a
                ><span class="descendants">: 190</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40613854">
          <h3>
            <a class="item" href="https://www.vogons.org/viewtopic.php?t=100871"
              >3dfx Voodoo 4 video card in MXM format (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 23:11:01</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40613854"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40613312">
          <h3>
            <a
              class="item"
              href="https://www.sydney.edu.au/news-opinion/news/2024/06/05/slow-spinning-radio-neutron-star-breaks-all-the-rules.html"
              >Slow-spinning radio neutron star breaks all the rules</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 21:46:30</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40613312"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40613287">
          <h3>
            <a class="item" href="https://blog.dave.tf/post/linux-pid0/"
              >What Is PID 0?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 21:42:58</span
              ><span class="points-container"
                >Points: <span class="points">329</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40613287"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40613126">
          <h3>
            <a
              class="item"
              href="https://pdos.csail.mit.edu/6.828/2023/xv6.html"
              >Xv6, a simple Unix-like teaching operating system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 21:22:05</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40613126"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40612387">
          <h3>
            <a
              class="item"
              href="https://nicole.express/2024/no-screen-no-cpu-one-problem.html"
              >Yes, you can play Duck Hunt without a television (but I can't)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 20:02:27</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40612387"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40612321">
          <h3>
            <a
              class="item"
              href="https://www.esquire.com/entertainment/books/a60924704/debut-fiction-challenges/"
              >Why are debut novels failing to launch?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 19:57:03</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40612321"
                  >Comments</a
                ><span class="descendants">: 180</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40612285">
          <h3>
            <a
              class="item"
              href="https://defenderofthebasic.substack.com/p/feynmans-razor"
              >Feynmanâ€™s Razor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 19:53:38</span
              ><span class="points-container"
                >Points: <span class="points">319</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40612285"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40610909">
          <h3>
            <a
              class="item"
              href="https://etodd.io/2017/11/28/poor-mans-3d-camera/"
              >The Poor Man's 3D Camera (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 17:37:52</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40610909"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40610794">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40610794"
              >Ask HN: Machine learning engineers, what do you do at work?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 17:26:34</span
              ><span class="points-container"
                >Points: <span class="points">248</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40610794"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
            <div class="text">
              I'm curious about the day-to-day of a Machine Learning engineer.
              If you work in this field, could you share what your typical tasks
              and projects look like? What are you working on?
            </div>
          </section>
        </section>
        <section id="40610641">
          <h3>
            <a class="item" href="https://meatfighter.com/ascii-silhouettify/"
              >ASCII Silhouettify</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 17:10:00</span
              ><span class="points-container"
                >Points: <span class="points">473</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40610641"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40609326">
          <h3>
            <a
              class="item"
              href="https://www.uber.com/blog/how-ledgerstore-supports-trillions-of-indexes/?uclick_id=67d612cb-12f8-470a-98fd-e9f7144dfafb"
              >LedgerStore Supports Trillions of Indexes at Uber</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 14:55:48</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40609326"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40609087">
          <h3>
            <a
              class="item"
              href="http://www.os2museum.com/wp/learn-something-old-every-day-part-xii-strange-file-resizing-on-dos/"
              >Strange File Resizing on DOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 14:27:26</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40609087"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40608941">
          <h3>
            <a
              class="item"
              href="https://www.scipress.io/post/kehluzWG8Iq9y1Nu7IMP/docs"
              >Show HN: Scipress.io â€“ a Markdown writing platform like Notion
              Medium MkDocs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 14:12:42</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40608941"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              <p>
                Scipress supports code blocks with syntax highlighting, Katex,
                Tailwind CSS, images &amp; videos, admonitions, popovers, blur
                screens, private posts, and a bunch of other cool stuff. You can
                also monetize via paywalls, if you want.
              </p>
              <p>
                I started this project almost a year ago to the date. This is my
                first time posting about it on HN. And if you're curious, I have
                made $0 from this project (but not for lack of trying).
              </p>
            </div>
          </section>
        </section>
        <section id="40606924">
          <h3>
            <a
              class="item"
              href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7233791/"
              >Secret Hand Gestures in Paintings (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 09:36:48</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40606924"
                  >Comments</a
                ><span class="descendants">: 143</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40605922">
          <h3>
            <a
              class="item"
              href="https://cedardb.com/blog/simple_efficient_hash_tables/"
              >Simple, Efficient, and Robust Hash Tables for Join Processing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-07 @ 06:42:52</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40605922"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40596130">
          <h3>
            <a
              class="item"
              href="https://www.smoliva.blog/post/computer-chronicles-revisited-070-101-macros-lotus-123-unnamed-lotus-symphony-adventure-game/"
              >101 Macros for Lotus 1-2-3 and Unnamed Lotus Symphony Adventure
              Game (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-06 @ 11:26:29</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40596130"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40594743">
          <h3>
            <a class="item" href="https://github.com/idoh/mamba.np"
              >A pure NumPy implementation of Mamba</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-06 @ 07:55:49</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40594743"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40589172">
          <h3>
            <a class="item" href="https://www.weather.gov/iln/cwop"
              >Own a weather station? We want your data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-05 @ 19:18:44</span
              ><span class="points-container"
                >Points: <span class="points">344</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40589172"
                  >Comments</a
                ><span class="descendants">: 151</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40587934">
          <h3>
            <a
              class="item"
              href="https://github.com/latex3/tagging-project/discussions/72"
              >LaTeX is the first PDF/UA-2 compliance accessible PDF producer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-05 @ 17:39:39</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40587934"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
