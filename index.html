<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38337568">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2023-11-19/openai-negotiations-to-reinstate-altman-hit-snag-over-board-role"
              >OpenAI Negotiations to Reinstate Altman Hit Snag over Board
              Role</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 20:35:09</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38337568"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38337292">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/20030728-00/?p=43043"
              >Why doesn't Windows have an "expert mode"? (2003)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 20:10:43</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38337292"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38337001">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/culture/cultural-comment/the-cassette-tape-revolution"
              >The Cassette-Tape Revolution</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 19:44:13</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38337001"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38336736">
          <h3>
            <a
              class="item"
              href="https://github.com/matrix-org/matrix-spec/issues/571"
              >Non-profit Matrix.org Foundation seems to be moving funds to
              for-profit Element</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 19:26:35</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38336736"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38336688">
          <h3>
            <a
              class="item"
              href="https://github.com/arcataroger/awesome-engineering-games"
              >Show HN: "Awesome" Engineering Games (List)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 19:22:22</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38336688"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>
                These games are both fun and often quite educational, presenting
                gamified versions of real-world challenges and professions.
              </p>
              <p>
                There's a lot of different sub-genres of "engineering game",
                such as:
              </p>
              <p>* Factory automation (Factorio, Dyson Sphere Program)</p>
              <p>* City builders (Cities: Skylines, Anno series)</p>
              <p>* Route-builders (Mini Motorways, Railway Empire)</p>
              <p>* Comp sci (TIS-100, Bitburner)</p>
              <p>
                All games on the list are very highly reviewed. I've played most
                (but not all) of them, and provided personal recommendations
                alongside the reviews. Many of them are also playable on GeForce
                Now (if you don't have a gaming PC).
              </p>
              <p>
                Please contribute if you know of more, or have any
                comments/suggestions!
              </p>
            </div>
          </section>
        </section>
        <section id="38336432">
          <h3>
            <a
              class="item"
              href="https://statmodeling.stat.columbia.edu/2023/11/19/dorothy-bishop-on-the-prevalence-of-scientific-fraud/"
              >Dorothy Bishop on the prevalence of scientific fraud</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 19:02:18</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38336432"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38336260">
          <h3>
            <a
              class="item"
              href="https://www.hollywoodreporter.com/news/general-news/steven-spielberg-predicts-implosion-film-567604/"
              >Steven Spielberg Predicts 'Implosion' of Film Industry (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 18:50:29</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38336260"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38335864">
          <h3>
            <a
              class="item"
              href="https://twitter.com/faborio/status/1725631676309463137"
              >A map of ATMs designed to scam tourists in Europe</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 18:23:43</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38335864"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38335850">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/artificial-intelligence-data-labeling-children/"
              >Underage Workers Are Training AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 18:22:39</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38335850"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38335276">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2023/11/19/ibm_sales_veteran_healthcare_lawsuit/"
              >Ex-IBM sales veteran sues for access to health benefits</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 17:41:40</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38335276"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38335255">
          <h3>
            <a class="item" href="https://github.com/yl4579/StyleTTS2"
              >StyleTTS2 – open-source Eleven Labs quality Text To Speech</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 17:40:33</span
              ><span class="points-container"
                >Points: <span class="points">208</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38335255"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38334647">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38334647"
              >GoGoGrandparent (YC S16) is hiring a senior/staff back
              end/full-stack engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 17:02:09</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                The position: FULLY REMOTE | Full-time | US, UK, or able to work
                4+ hours overlap with mainland US (UK time working hours also
                OK) | $100k to $120k
              </p>
              <p>
                Build high-quality, robust engineering at the rarest of things -
                a Silicon Valley startup that is both wholesome AND profitable.
                We have 8-figure revenue, are YC-backed, and growing fast.
              </p>
              <p>
                Tech stack (<i>required): Back-end heavy (Node</i>, Typescript<i
                  >, MySQL</i
                >, REST*+GraphQL), front-end (Vue), deploy (AWS, Docker/K8s)
              </p>
              <p>
                Minimum 6 years experience (mostly Node). If full-stack, you
                must be strongest on the backend.
              </p>
              <p>2-stage interview process.</p>
              <p>
                If you want to help older adults and people with disabilities,
                send your LinkedIn/CV to william@gogograndparent.com (keep it
                brief) or apply at
                <a
                  href="https://www.ycombinator.com/companies/gogograndparent/jobs"
                  >https://www.ycombinator.com/companies/gogograndparent/jobs</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="38333790">
          <h3>
            <a
              class="item"
              href="https://www.pbsnc.org/blogs/science/us-agency-declares-21-species-now-extinct/"
              >U.S. Agency Declares 21 Species Now Extinct L</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 15:56:41</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38333790"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38332655">
          <h3>
            <a
              class="item"
              href="https://weberdominik.com/blog/vscode-vertical-tabs/"
              >Vertical Tabs in Visual Studio Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 13:56:21</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38332655"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38332364">
          <h3>
            <a
              class="item"
              href="https://solvingprocrastination.com/revenge-bedtime-procrastination/"
              >Revenge bedtime procrastination</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 13:16:03</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38332364"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38332137">
          <h3>
            <a
              class="item"
              href="https://github.blog/2023-10-30-the-architecture-of-todays-llm-applications/"
              >The architecture of today's LLM applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 12:41:37</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38332137"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38331751">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/11/17/kyutai-is-an-french-ai-research-lab-with-a-330-million-budget-that-will-make-everything-open-source/"
              >Kyutai AI research lab with a $330M budget that will make
              everything open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 11:48:18</span
              ><span class="points-container"
                >Points: <span class="points">231</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38331751"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38331750">
          <h3>
            <a
              class="item"
              href="https://vsekar.me/blog/log_coffee/chapter_0.html"
              >Lindenmayer Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 11:47:55</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38331750"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38331669">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2311.09247"
              >Comparing Humans, GPT-4, and GPT-4V on Abstraction and Reasoning
              Tasks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 11:36:34</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38331669"
                  >Comments</a
                ><span class="descendants">: 141</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38331501">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38331501"
              >Ask HN: Any comprehensive courses on Auth?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 11:06:21</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38331501"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
            <div class="text">
              I would like cover basic username/password auth, OAuth and Active
              Directory, security keys and everything in between. Would like to
              do this in a linear fashion, ie like a coursera course with
              practice problems.
            </div>
          </section>
        </section>
        <section id="38331368">
          <h3>
            <a
              class="item"
              href="https://www.ian-leslie.com/p/the-ruffian-special-edition-book"
              >Rational Ritual: Why everyone needs to know what everyone knows
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 10:46:25</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38331368"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38331349">
          <h3>
            <a class="item" href="https://zero-k.info/"
              >Zero-k: A libre sci-fi RTS game, with an economy based on metal
              and energy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 10:43:09</span
              ><span class="points-container"
                >Points: <span class="points">244</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38331349"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38331200">
          <h3>
            <a class="item" href="https://fleuret.org/dlc/"
              >Deep Learning Course</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 10:19:21</span
              ><span class="points-container"
                >Points: <span class="points">353</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38331200"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38329969">
          <h3>
            <a
              class="item"
              href="https://forum.handbrake.fr/viewtopic.php?t=43311"
              >HandBrake 1.7.0 – The open source video transcoder</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 07:03:26</span
              ><span class="points-container"
                >Points: <span class="points">357</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38329969"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38326834">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/tech/openai-trying-to-get-sam-altman-back-4b728049"
              >OpenAI investors try to get Sam Altman back as CEO after sudden
              firing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-19 @ 00:36:00</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38326834"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38317509">
          <h3>
            <a class="item" href="https://www.volunteer.gov/s/"
              >Volunteer.gov: Discover volunteer opportunities around the
              country</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-18 @ 09:50:52</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38317509"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38316069">
          <h3>
            <a
              class="item"
              href="https://futureoflife.org/open-letter/ai-principles/"
              >Asilomar Principles (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-18 @ 06:13:44</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38316069"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38315575">
          <h3>
            <a
              class="item"
              href="https://brooker.co.za/blog/2023/10/18/optimism.html"
              >Optimism vs. Pessimism in Distributed Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-18 @ 05:12:35</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38315575"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38303306">
          <h3>
            <a class="item" href="https://www.sheepit-renderfarm.com/home"
              >SheepIt Render Farm</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 13:35:42</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38303306"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38300189">
          <h3>
            <a class="item" href="https://animatearchive.neocities.org/?home"
              >AnimateArchive (old versions of Adobe Flash)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 06:18:19</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38300189"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
