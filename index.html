<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45517134">
          <h3>
            <a
              class="item"
              href="https://lighthouseapp.io/blog/feed-reader-deep-dive"
              >A deep dive into the RSS feed reader landscape</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 15:17:36</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45517134"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45516968">
          <h3>
            <a
              class="item"
              href="https://www.readonlymemo.com/mame-hyper-neo-geo-support-sound-emulation/"
              >After 2 decades of tinkering, MAME cracks the Hyper Neo Geo 64</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 15:01:38</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45516968"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45516584">
          <h3>
            <a
              class="item"
              href="https://www.npmjs.com/package/@joseairosa/recall"
              >Show HN: Recall: Give Claude perfect memory with Redis-backed
              persistent context</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 14:28:06</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45516584"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
            <div class="text">
              <p>
                The Problem: I use Claude for coding daily, but every
                conversation starts from scratch. I'd explain my architecture,
                coding standards, past decisions... then hit the context limit
                and lose everything. Next session? Start over.
              </p>
              <p>
                The Solution: Recall is an MCP (Model Context Protocol) server
                that gives Claude persistent memory using Redis + semantic
                search. Think of it as long-term memory that survives context
                limits and session restarts.
              </p>
              <p>
                How it works: - Claude stores important context as "memories"
                during conversations - Memories are embedded (OpenAI) and stored
                in Redis with metadata - Semantic search retrieves relevant
                memories automatically - Works across sessions, projects, even
                machines (if you use cloud Redis)
              </p>
              <p>
                Key Features: - Global memories: Share context across all
                projects - Relationships: Link related memories into knowledge
                graphs - Versioning: Track how memories evolve over time -
                Templates: Reusable patterns for common workflows - Workspace
                isolation: Project A memories don't pollute Project B
              </p>
              <p>
                Tech Stack: - TypeScript + MCP SDK - Redis for storage - OpenAI
                embeddings (text-embedding-3-small) - ~189KB bundle, runs
                locally
              </p>
              <p>
                Current Stats: - 27 tools exposed to Claude - 10 context types
                (directives, decisions, patterns, etc.) - Sub-second semantic
                search on 10k+ memories - Works with Claude Desktop, Claude
                Code, any MCP client
              </p>
              <p>
                Example Use Case: I'm building an e-commerce platform. I told
                Claude once: "We use Tailwind, prefer composition API, API rate
                limit is 1000/min." Now every conversation, Claude remembers and
                applies these preferences automatically.
              </p>
              <p>
                What's Next (v1.6.0 in progress): - CI/CD pipeline with GitHub
                Actions - Docker support for easy deployment - Proper test suite
                with Vitest - Better error messages and logging
              </p>
              <p>Try it:</p>
              <p>
                npm install -g @joseairosa/recall # Add to
                claude_desktop_config.json # Start using persistent memory
              </p>
            </div>
          </section>
        </section>
        <section id="45516556">
          <h3>
            <a
              class="item"
              href="https://ozguralp.medium.com/how-to-start-bug-bounties-101-how-to-make-a-million-in-4-years-e15ee62d6f4"
              >How To Start Bug Bounties (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 14:25:19</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45516556"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45516402">
          <h3>
            <a class="item" href="https://github.com/furudo-erika/codingfox"
              >Show HN: CodingFox â€“ Open-Source AI Code Review Tool That Works
              Like Magic</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 14:11:30</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45516402"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45516134">
          <h3>
            <a
              class="item"
              href="https://wasp.sh/blog/2025/10/07/how-we-test-a-web-framework"
              >Testing a compiler-driven full-stack web framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 13:45:30</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45516134"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45516000">
          <h3>
            <a
              class="item"
              href="https://blog.cloudflare.com/how-we-found-a-bug-in-gos-arm64-compiler/"
              >We found a bug in Go's ARM64 compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 13:33:15</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45516000"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45515783">
          <h3>
            <a
              class="item"
              href="https://papersplease.org/wp/2025/10/06/the-weaponization-of-travel-blacklists/"
              >The weaponization of travel blacklists</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 13:10:19</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45515783"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45515657">
          <h3>
            <a
              class="item"
              href="https://it-notes.dragas.net/2025/10/08/the-email-they-shouldnt-have-read/"
              >The email they shouldn't have read</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 12:56:54</span
              ><span class="points-container"
                >Points: <span class="points">212</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45515657"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45515640">
          <h3>
            <a
              class="item"
              href="https://paid.ai/blog/ai-agents/paid-gitlaw-introducing-legal-contracts-built-for-ai-agents"
              >Legal Contracts Built for AI Agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 12:55:01</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45515640"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45514164">
          <h3>
            <a
              class="item"
              href="https://www.nobelprize.org/prizes/chemistry/2025/popular-information/"
              >Nobel Prize in Chemistry 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 09:49:36</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45514164"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45513485">
          <h3>
            <a
              class="item"
              href="https://www.guru3d.com/story/synology-reverses-policy-banning-thirdparty-hdds-after-nas-sales-plummet/"
              >Synology reverses policy banning third-party HDDs after sales
              allegedly plummet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 08:19:36</span
              ><span class="points-container"
                >Points: <span class="points">784</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45513485"
                  >Comments</a
                ><span class="descendants">: 502</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45513459">
          <h3>
            <a class="item" href="https://ohyahapp.com"
              >Show HN: Oh Yah â€“ Routine management app I built for my sons</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 08:15:49</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45513459"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
            <div class="text">
              <p>
                Built with React Native/Expo and Firebase. The trickiest part
                was designing the UX to be simple enough for kids with minimal
                distractions while giving parents enough control â€“ ended up with
                a task-definition system that lets parents create weekly
                schedules with daily toggles instead of duplicating tasks across
                days
              </p>
              <p>
                It's on the App Store now after a few months of dogfooding with
                my family. There's a 1-month free trial, then it's
                subscription-based. Would love feedback from other parents
                dealing with similar challenges
              </p>
            </div>
          </section>
        </section>
        <section id="45507936">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/google-deepmind/gemini-computer-use-model/"
              >Gemini 2.5 Computer Use model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 19:49:11</span
              ><span class="points-container"
                >Points: <span class="points">575</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45507936"
                  >Comments</a
                ><span class="descendants">: 290</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45505539">
          <h3>
            <a
              class="item"
              href="https://www.seangoedecke.com/seeing-like-a-software-company/"
              >Seeing like a software company</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 16:49:09</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45505539"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45504973">
          <h3>
            <a class="item" href="https://timelinize.com"
              >Show HN: Timelinize â€“ Privately organize your own data from
              everywhere, locally</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 16:10:22</span
              ><span class="points-container"
                >Points: <span class="points">537</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45504973"
                  >Comments</a
                ><span class="descendants">: 137</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been working on this for about 10+ years, nights and
                weekends. It's been really slow going since I only have my own
                personal data to test it with.
              </p>
              <p>
                I just don't love that my data is primarily stored on someone
                else's computer up in the cloud. I want my own local copy at
                least. And while I can download exports from my various
                accounts, I don't want them to just gather dust and rot on my
                hard drive.
              </p>
              <p>
                So, Timelinize helps keep that data alive and relevant and in my
                control. I don't have as much worry if my cloud accounts go
                away. Hopefully you'll find it useful, and I hope we can
                collaborate.
              </p>
              <p>
                (PS. I'm open to changing the name. Never really liked this
                one...)
              </p>
            </div>
          </section>
        </section>
        <section id="45504470">
          <h3>
            <a
              class="item"
              href="https://ikeamuseum.com/en/explore/ikea-catalogue/"
              >IKEA Catalogs 1951-2021</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 15:35:48</span
              ><span class="points-container"
                >Points: <span class="points">460</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45504470"
                  >Comments</a
                ><span class="descendants">: 118</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45503867">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/Oct/7/vibe-engineering/"
              >Vibe engineering</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 14:55:14</span
              ><span class="points-container"
                >Points: <span class="points">484</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45503867"
                  >Comments</a
                ><span class="descendants">: 536</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45502541">
          <h3>
            <a
              class="item"
              href="https://www.qualcomm.com/news/releases/2025/10/qualcomm-to-acquire-arduino-accelerating-developers--access-to-i"
              >Qualcomm to acquire Arduino</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 13:00:08</span
              ><span class="points-container"
                >Points: <span class="points">1253</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45502541"
                  >Comments</a
                ><span class="descendants">: 511</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://arstechnica.com/gadgets/2025/10/arduino-retains-its-brand-and-mission-following-acquisition-by-qualcomm/"
                >https://arstechnica.com/gadgets/2025/10/arduino-retains-its-...</a
              >
              <p>
                <a
                  href="https://www.electronicdesign.com/technologies/embedded/article/55321526/electronic-design-qualcomms-acquires-arduino-arduino-uno-q-runs-ai-llm-code-from-inexperienced-programmer-prompts-performs-signal-processing-and-runs-linux-and-zephyr-os"
                  >https://www.electronicdesign.com/technologies/embedded/artic...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="45501189">
          <h3>
            <a
              class="item"
              href="https://www.nobelprize.org/prizes/physics/2025/popular-information/"
              >Nobel Prize in Physics 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 09:50:49</span
              ><span class="points-container"
                >Points: <span class="points">447</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45501189"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.bbc.com/news/articles/c98d00nq47jo"
                >https://www.bbc.com/news/articles/c98d00nq47jo</a
              >
            </div>
          </section>
        </section>
        <section id="45492489">
          <h3>
            <a class="item" href="https://nullpt.rs/reverse-engineering-browser"
              >Show HN: I'm building a browser for reverse engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 15:32:32</span
              ><span class="points-container"
                >Points: <span class="points">318</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45492489"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45490713">
          <h3>
            <a
              class="item"
              href="https://www.ducktyped.org/p/an-illustrated-introduction-to-linear"
              >An illustrated introduction to linear algebra</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 12:38:40</span
              ><span class="points-container"
                >Points: <span class="points">407</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45490713"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45490434">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/mathematicians-discover-prime-number-pattern-in-fractal-chaos/"
              >Mathematicians discover prime number pattern in fractal chaos</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 12:02:25</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45490434"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45489065">
          <h3>
            <a class="item" href="https://www.opensourceecology.org/gvcs/"
              >Global Village Construction Set</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 08:36:26</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45489065"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45485227">
          <h3>
            <a
              class="item"
              href="https://tombh.co.uk/packing-world-lines-of-sight"
              >Packing the world for longest lines of sight</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 21:02:03</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45485227"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45476371">
          <h3>
            <a
              class="item"
              href="https://www.mooreds.com/wordpress/archives/3717"
              >Say Goodbye</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-04 @ 20:21:20</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45476371"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45475556">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/news/784966/lumafield-x-ray-ct-scan-lithium-ion-battery-risks-manufacturing-defect"
              >X-ray scans reveal the hidden risks of cheap batteries</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-04 @ 18:37:31</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45475556"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45474988">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41467-025-63417-y"
              >Monumental rock art: humans thrived in Arab. Desert during
              Pleistocene-Holocene</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-04 @ 17:25:40</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45474988"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45474301">
          <h3>
            <a
              class="item"
              href="https://www.cbsnews.com/texas/news/sec-approves-texas-stock-exchange-txse/"
              >SEC approves Texas Stock Exchange, first new US integrated
              exchange in decades</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-04 @ 16:04:24</span
              ><span class="points-container"
                >Points: <span class="points">281</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45474301"
                  >Comments</a
                ><span class="descendants">: 188</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45472119">
          <h3>
            <a class="item" href="https://github.com/irony/aspipes"
              >Working pipe operator today in pure JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-04 @ 09:54:01</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45472119"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
