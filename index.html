<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41502986">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2024/9/10/24240920/state-ags-back-surgeon-general-social-media-warning-labels"
              >Nearly 40 states back surgeon general's social media warning
              labels</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 17:01:24</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41502986"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41502822">
          <h3>
            <a
              class="item"
              href="https://www.politico.eu/article/google-loses-court-battle-over-first-eu-antitrust-fine/"
              >Google loses EU court battle over €2.4B antitrust fine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 16:46:08</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41502822"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41502721">
          <h3>
            <a
              class="item"
              href="https://sinja.io/blog/get-maximum-out-of-your-font"
              >What you can get out of a high-quality font</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 16:38:50</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41502721"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41502625">
          <h3>
            <a
              class="item"
              href="https://cra.mr/open-source-is-not-a-business-model/"
              >Open Source is not a Business Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 16:31:26</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41502625"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41502510">
          <h3>
            <a class="item" href="https://illuminate.google.com/home"
              >Google Illuminate: Books and Papers turned into audio content</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 16:22:13</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41502510"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41502462">
          <h3>
            <a
              class="item"
              href="https://blog.cloudflare.com/when-bloom-filters-dont-bloom/"
              >When Bloom filters don't bloom (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 16:18:55</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41502462"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41502453">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41502453"
              >Show HN: Glasskube's Argo CD GitOps Template for Kubernetes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 16:18:36</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41502453"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/glasskube/glasskube"
                >https://github.com/glasskube/glasskube</a
              >). We are working on a package manager for Kubernetes to simplify
              the packaging of complex applications with multiple dependencies,
              ensuring they are installed and kept up-to-date across multiple
              Kubernetes clusters.
              <p>
                Nowadays, it is best practice to use Git as a revision control
                system for your Kubernetes configurations. Update automation
                workflows like Renovate or Dependabot can create pull requests
                for new versions of Docker images and Helm charts, but ensuring
                these new package versions work is still a manual task. By using
                the central (or a private) Glasskube repository (<a
                  href="https://github.com/glasskube/packages"
                  >https://github.com/glasskube/packages</a
                >) together with our Renovate integration (<a
                  href="https://docs.renovatebot.com/modules/manager/glasskube/"
                  >https://docs.renovatebot.com/modules/manager/glasskube/</a
                >), you can ensure that new package versions will run through
                our Minikube-based CI workflows before they get
                published—similar to how the Homebrew core tap works. We’ve just
                introduced readiness checks for manifest-based deployments and
                utilize the flux-helm-controller to wait for a Helm release to
                succeed.
              </p>
              <p>
                Dependencies are resolved by our package controller. These
                dependencies can either be cluster-scoped (installed in the
                recommended namespace, e.g., operators wird CRDs) or
                namespace-scoped components of a package (e.g., a database or
                Redis cache). In such cases, we will prefix resources with the
                dependent package name to ensure multiple packages can use the
                same dependencies without naming conflicts (we use Kustomize on
                a virtual filesystem for this).
              </p>
              <p>
                Glasskube packages can currently be Helm charts (from an OCI or
                Helm repository) or manifests, which are mostly built using
                Kustomize’s overlay approach.
              </p>
              <p>
                Since neither the overlay approach (using Kustomize) nor Helm’s
                limited templating functionality will help us and other
                Kubernetes users scale to more complex packages, we are
                considering creating a more programmatic approach to package
                creation, similar to Timoni. Currently, KCL is our frontrunner
                (<a
                  href="https://github.com/glasskube/glasskube/discussions/1018"
                  >https://github.com/glasskube/glasskube/discussions/1018</a
                >), as it already integrates well with the Kubernetes ecosystem.
              </p>
              <p>
                We would appreciate if you give our GitOps template a try. It
                also works work existing Kubernetes clusters if just want to use
                GitOps for some applications. Just make sure that the argocd and
                glasskube-system namespaces are not yet in use. See:
                <a href="https://github.com/glasskube/gitops-template/"
                  >https://github.com/glasskube/gitops-template/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41501818">
          <h3>
            <a class="item" href="https://queue.acm.org/detail.cfm?id=3688007"
              >GPTs and Hallucination</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 15:33:56</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41501818"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41501496">
          <h3>
            <a
              class="item"
              href="https://blog.cloudflare.com/pingora-saving-compute-1-percent-at-a-time/"
              >A good day to trie-hard: saving compute 1% at a time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 15:03:31</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41501496"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41501215">
          <h3>
            <a
              class="item"
              href="https://engineering.fb.com/2022/11/15/open-source/sapling-source-control-scalable/"
              >Sapling: Source control that's user-friendly and scalable
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 14:34:58</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41501215"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41500938">
          <h3>
            <a
              class="item"
              href="https://github.com/yournextstore/yournextstore"
              >Show HN: YourNextStore – an open-source Shopify with Stripe as
              the back end</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 14:08:37</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41500938"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                Selling online is often more complex than it needs to be.
                Setting up a storefront with great performance can feel daunting
                and time-consuming. There are many plugins, libraries, etc - the
                choice can be overwhelming.
              </p>
              <p>
                Plus, in e-commerce, the backend and frontend are often written
                in different languages (e.g., PHP, Python, or Ruby for the
                backend). This increases the complexity and makes code
                management more challenging, especially for teams.
              </p>
              <p>
                After working in e-commerce for several years, Michał and I set
                out to build the fastest and most compelling storefront for
                small to medium-sized merchants. Fast e-commerce sites are
                crucial because slow pages hurt sales [1]. Unfortunately,
                performance issues are still very common. The beauty of Your
                Next Store is its simplicity. No additional tools and no
                databases - just Next.js and Stripe.
              </p>
              <p>
                On the technical side, we use App Router, React Server
                Component, Partial Pre-Rendering, Optimistic Updates, and
                Streaming with Suspense to make the store faster and leaner so
                it feels almost like a static website.
              </p>
              <p>In summary:</p>
              <p>
                Modern &amp; Popular Stack: Built with Next.js, React.js, and
                TypeScript, making development faster and hiring easier compared
                to platforms that use less common frameworks like Shopify’s
                Liquid.
              </p>
              <p>
                No Database Needed: Stripe handles the backend, reducing the
                need for complex infrastructure and simplifying the setup
                process.
              </p>
              <p>
                Open Source: Free and open (AGPL), with the option for a
                commercial license if needed.
              </p>
              <p>
                This is just the beginning. We want to make YNS even better and
                easier to use and eventually provide a good, open-source
                alternative to Shopify.
              </p>
              <p>
                Check our code at
                <a href="https://github.com/yournextstore/yournextstore"
                  >https://github.com/yournextstore/yournextstore</a
                >
              </p>
              <p>
                We’d love to hear your thoughts and feedback! What features
                would you like to see next?
              </p>
              <p>
                [1]:
                <a
                  href="https://www.deloitte.com/ie/en/services/consulting/research/milliseconds-make-millions.html"
                  >https://www.deloitte.com/ie/en/services/consulting/research/...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41500840">
          <h3>
            <a
              class="item"
              href="https://chromewebstore.google.com/detail/pr-agent-ai-powered-code/ephlnjeghhogofkifjloamocljapahnl"
              >PR-Agent — extension that adds AI chat to code reviews on
              GitHub</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 14:00:23</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41500840"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41500522">
          <h3>
            <a
              class="item"
              href="https://www.singlestore.com/blog/how-we-made-notebooks-load-10-times-faster/"
              >How We Made Jupyter Notebooks Load 10 Times Faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 13:19:29</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41500522"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41500506">
          <h3>
            <a
              class="item"
              href="https://briefer.cloud/blog/posts/open-source-strategy/"
              >Going open-source as a VC-Backed company</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 13:16:28</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41500506"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41500406">
          <h3>
            <a
              class="item"
              href="https://manuscriptroadtrip.wordpress.com/2024/09/08/multispectral-imaging-and-the-voynich-manuscript/"
              >Multispectral Imaging and the Voynich Manuscript</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 13:05:43</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41500406"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41500405">
          <h3>
            <a
              class="item"
              href="https://antithesis.com/blog/multiverse_debugging/"
              >Debugging in the Multiverse</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 13:05:42</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41500405"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41500268">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/09/10/brute_force_ai_era_gartner/"
              >We're in the brute force phase of AI – once it ends, demand for
              GPUs will too</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 12:52:23</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41500268"
                  >Comments</a
                ><span class="descendants">: 141</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41499905">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41499905"
              >Show HN: Free tool to find RSS feeds, even if not linked on the
              page</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 12:05:01</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41499905"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
            <div class="text">
              <a href="https://lighthouseapp.io/tools/feed-finder"
                >https://lighthouseapp.io/tools/feed-finder</a
              >
              <p>
                In &gt;90% of cases the standard way of checking meta tags is
                enough to find the feeds. But my goal for this tool is that it
                finds feeds regardless if they're linked somewhere or not. That
                if this feed finder doesn't find a feed, no feed exists.
              </p>
              <p>
                It's a big goal and admittedly not there yet, but it does a few
                things that are a step in that direction.
              </p>
              <p>
                * Checks meta tags of parent pages (sometimes the article itself
                doesn't have the meta tag, but the main blog page does)
              </p>
              <p>
                * Checks common suffixes like /rss, /index.xml and many others
                (sometimes the feed exists but isn't linked)
              </p>
              <p>* Checks the sitemap</p>
              <p>* Checks all links on the page</p>
              <p>
                * Checks 3rd party feeds (OpenRSS for now, when I find more such
                repositories I'll add them too)
              </p>
              <p>
                There are a couple of additional ideas I have, like checking
                search engines and crawling the entire domain (highly
                inefficient, but possible).
              </p>
              <p>
                Would love if you could try it, and even more if you post sites
                where it doesn't work.
              </p>
            </div>
          </section>
        </section>
        <section id="41499883">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/roame/jobs/dd4pOgQ-chief-of-staff"
              >Roame (YC S23) Is Hiring a Chief of Staff</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 12:00:23</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41498264">
          <h3>
            <a class="item" href="https://tmendez.dev/posts/rng-git-hash-bug/"
              >Our RNG Git Hash Bug</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 07:51:35</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41498264"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41496699">
          <h3>
            <a class="item" href="https://harrison.ai/harrison-rad-1/"
              >Radiology-specific foundation model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-10 @ 02:46:13</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41496699"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41494786">
          <h3>
            <a class="item" href="https://sigrok.org/wiki/Main_Page"
              >Sigrok – a portable, cross-platform, FOSS signal analysis
              software suite</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-09 @ 22:22:15</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41494786"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41491016">
          <h3>
            <a class="item" href="https://www.decarpentier.nl/carpentopod"
              >Carpentopod: A Walking Table Project</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-09 @ 17:28:45</span
              ><span class="points-container"
                >Points: <span class="points">337</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41491016"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41490290">
          <h3>
            <a
              class="item"
              href="https://blogsystem5.substack.com/p/windows-nt-vs-unix-design"
              >Windows NT vs. Unix: A design comparison</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-09 @ 16:37:29</span
              ><span class="points-container"
                >Points: <span class="points">549</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41490290"
                  >Comments</a
                ><span class="descendants">: 478</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41487496">
          <h3>
            <a
              class="item"
              href="https://www.andreinc.net/2024/07/25/how-to-compose-math-problems"
              >How to Compose Math Problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-09 @ 11:31:39</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41487496"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41479283">
          <h3>
            <a
              class="item"
              href="https://www.joeshaw.org/dont-defer-close-on-writable-files/"
              >Don't defer Close() on writable files (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-08 @ 09:36:41</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41479283"
                  >Comments</a
                ><span class="descendants">: 220</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41479141">
          <h3>
            <a
              class="item"
              href="https://simplyexplained.com/blog/how-i-built-an-nfc-movie-library-for-my-kids/"
              >An NFC movie library for my kids</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-08 @ 09:06:31</span
              ><span class="points-container"
                >Points: <span class="points">1168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41479141"
                  >Comments</a
                ><span class="descendants">: 277</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41478771">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/opinions/interactive/2024/michael-lewis-chris-marks-the-canary-who-is-government/"
              >The Canary</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-08 @ 07:22:39</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41478771"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41470440">
          <h3>
            <a
              class="item"
              href="https://dzhu.page/mathematics/memorizing-100-perfect-squares/"
              >Memorizing the first 100 perfect squares (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-06 @ 23:27:21</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41470440"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41467420">
          <h3>
            <a class="item" href="https://tomato64.org/"
              >Tomato64: A port of Tomato Firmware to x86_64</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-06 @ 16:12:40</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41467420"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
