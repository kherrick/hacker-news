<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43067585">
          <h3>
            <a class="item" href="https://leerob.com/n/rust"
              >Rust Is Eating JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 12:46:55</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43067585"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43067378">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/artanddesign/gallery/2025/jan/29/japan-brutalist-buildings-in-pictures"
              >Statement or eyesore? Japan's divisive brutalist buildings – in
              pictures</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 12:00:22</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43067378"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43067303">
          <h3>
            <a class="item" href="https://www.ssp.sh/blog/finding-flow/"
              >Finding Flow: Escaping digital distractions through deep work and
              slow living</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 11:40:24</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43067303"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43066953">
          <h3>
            <a
              class="item"
              href="https://chadnauseam.com/coding/random/calculator-app"
              >“A calculator app? Anyone could make that”</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 10:16:49</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43066953"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43066842">
          <h3>
            <a class="item" href="https://langfuse.com/careers"
              >Langfuse (YC W23) Is Hiring Product Engineers in Berlin</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 09:55:58</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43066720">
          <h3>
            <a
              class="item"
              href="https://kk.org/thetechnium/50-years-of-travel-tips/"
              >50 Years of Travel Tips</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 09:31:02</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43066720"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43066182">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/c4g3nrx1dq5o"
              >US government struggles to rehire nuclear safety staff it laid
              off days ago</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 07:45:49</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43066182"
                  >Comments</a
                ><span class="descendants">: 322</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43065217">
          <h3>
            <a class="item" href="https://github.com/dvershinin/gixy"
              >Gixy: Nginx Configuration Static Analyzer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 04:06:04</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43065217"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43064273">
          <h3>
            <a
              class="item"
              href="https://donhopkins.com/home/TheSimsDesignDocuments/"
              >The Sims Game Design Documents (1997)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 01:06:11</span
              ><span class="points-container"
                >Points: <span class="points">298</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43064273"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43063970">
          <h3>
            <a class="item" href="https://blunderchess.net"
              >Show HN: Blunderchess.net – blunder for your opponent every five
              moves</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 00:22:01</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43063970"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              blunderchess.net is an open source, peer-to-peer chess app where
              every five moves, players each get to make one blunder-move for
              their opponent
            </div>
          </section>
        </section>
        <section id="43063239">
          <h3>
            <a
              class="item"
              href="https://forum.qubes-os.org/t/create-a-gaming-hvm/19000"
              >Create a QubesOS Gaming HVM with GPU PCI passthrough (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 22:48:56</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43063239"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43062546">
          <h3>
            <a class="item" href="https://h.43z.one/blog/2025-02-12/"
              >Watt The Fox?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 21:32:13</span
              ><span class="points-container"
                >Points: <span class="points">265</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43062546"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43061977">
          <h3>
            <a
              class="item"
              href="https://www.cs.otago.ac.nz/cosc345/resources/nasa-10-rules.htm"
              >NASA has a list of 10 rules for software development</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 20:24:13</span
              ><span class="points-container"
                >Points: <span class="points">294</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43061977"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43061827">
          <h3>
            <a
              class="item"
              href="https://www.perplexity.ai/hub/blog/introducing-perplexity-deep-research"
              >Perplexity Deep Research</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 20:07:39</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43061827"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43061803">
          <h3>
            <a
              class="item"
              href="https://blog.sffc.xyz/post/190943794505/why-you-should-not-parse-localized-strings"
              >Reasons to Not Parse Localized Strings</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 20:04:30</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43061803"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43061498">
          <h3>
            <a class="item" href="https://weeks.ginatrapani.org/"
              >My Life in Weeks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 19:34:29</span
              ><span class="points-container"
                >Points: <span class="points">821</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43061498"
                  >Comments</a
                ><span class="descendants">: 226</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43061183">
          <h3>
            <a class="item" href="https://github.com/cosmos72/schemesh"
              >Schemesh: Fusion between Unix shell and Lisp REPL</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 19:00:38</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43061183"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43060818">
          <h3>
            <a class="item" href="https://source-robotics.github.io/PAROL-docs/"
              >PAROL6: 3D-printed desktop robotic arm</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 18:26:49</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43060818"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43060603">
          <h3>
            <a class="item" href="https://github.com/mpatajac/jillc"
              >Jill – a functional programming language for the Nand2Tetris
              platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 18:04:12</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43060603"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43057375">
          <h3>
            <a class="item" href="https://github.com/Goldziher/kreuzberg"
              >Show HN: Kreuzberg – Modern async Python library for document
              text extraction</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 10:07:23</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43057375"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
            <div class="text">
              <p>
                Kreuzberg is a modern Python library built from the ground up
                with async/await, type hints, and optimized I/O handling.
              </p>
              <p>
                It provides a unified interface for extracting text from
                documents (PDFs, images, office files) without external API
                dependencies.
              </p>
              <p>
                Key technical features: - Built with modern Python best
                practices (async/await, type hints, functional-first) -
                Optimized async I/O with anyio for multi-loop compatibility -
                Smart worker process pool for CPU-bound tasks (OCR, doc
                conversion) - Efficient batch processing with concurrent
                extractions - Clean error handling with context-rich exceptions
              </p>
              <p>
                I built this after struggling with existing solutions that were
                either synchronous-only, required complex deployments, or had
                poor async support. The goal was to create something that works
                well in modern async Python applications, can be easily
                dockerized or used in serverless contexts, and relies only on
                permissive OSS.
              </p>
              <p>
                Key advantages over alternatives: - True async support with
                optimized I/O - Minimal dependencies (much smaller than
                alternatives) - Perfect for serverless and async web apps -
                Local processing without API calls - Built for modern Python
                codebases with rigorous typing and testing
              </p>
              <p>I Would love feedback!</p>
              <p>The library is MIT licensed and open to contributions.</p>
              <p>
                Here is the repo:
                <a href="https://github.com/Goldziher/kreuzberg"
                  >https://github.com/Goldziher/kreuzberg</a
                >
              </p>
              <p>Staring is caring</p>
            </div>
          </section>
        </section>
        <section id="43057344">
          <h3>
            <a class="item" href="https://www.figgie.com/"
              >Jane Street's Figgie card game</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-15 @ 09:59:20</span
              ><span class="points-container"
                >Points: <span class="points">434</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43057344"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43041477">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/can-ai-read-pain-and-other-emotions-your-dog-s-face"
              >AI can interpret animal emotions better than humans</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-13 @ 21:16:36</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43041477"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43038794">
          <h3>
            <a
              class="item"
              href="https://www.departmentofproduct.com/blog/product-development-processes-you-might-not-have-heard-of/"
              >Product Development Processes You Might Not Have Heard of
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-13 @ 17:40:29</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43038794"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43037606">
          <h3>
            <a
              class="item"
              href="https://www.heritagedaily.com/2025/02/traces-of-londons-first-roman-basilica-found-beneath-office-basement/154534"
              >Traces of London's first Roman basilica found beneath office
              basement</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-13 @ 16:23:04</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43037606"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43035760">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/world/asia-pacific/sri-lanka-scrambles-restore-power-after-monkey-causes-islandwide-outage-2025-02-13/"
              >Sri Lanka scrambles to restore power after monkey causes
              islandwide outage</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-13 @ 13:47:25</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43035760"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43032759">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cx2jdnv0ywyo"
              >Beginnings of Roman London discovered in office basement</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-13 @ 04:46:26</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43032759"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43026882">
          <h3>
            <a
              class="item"
              href="https://www.resourcely.io/post/10-terraform-config-root-setups"
              >Terraform Config Root Setups</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-12 @ 16:26:02</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43026882"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43026234">
          <h3>
            <a
              class="item"
              href="https://www.technologyreview.com/2025/02/11/1111467/the-dream-of-offshore-rocket-launches-is-finally-blasting-off/"
              >The dream of offshore rocket launches is finally blasting off</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-12 @ 15:21:42</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43026234"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43026001">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-02-spanish-bulls-festival-reveals-crowd.html"
              >Spanish 'running of the bulls' festival reveals crowd movements
              can be predicted</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-12 @ 14:58:52</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43026001"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43025176">
          <h3>
            <a
              class="item"
              href="https://schoenitzer.de/blog/2025/Gimp%203.0%20Plugin%20Ressources.html"
              >Writing a Gimp 3.0 Plugin</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-12 @ 13:26:12</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43025176"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
