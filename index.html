<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41310384">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/how-to-build-a-50000-ton-forging"
              >How to Build a 50K Ton Forging Press</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 14:00:47</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41310384"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41309401">
          <h3>
            <a class="item" href="https://www.sievedata.com/"
              >Sieve (YC W22) Is hiring engineers to build AI [video] developer
              tools</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 12:01:07</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41309292">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/electrostatic-motor"
              >Electrostatic motors reach the macro scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 11:43:19</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41309292"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41308712">
          <h3>
            <a
              class="item"
              href="https://www.esa.int/Science_Exploration/Space_Science/Juice/Juice_rerouted_to_Venus_in_world_s_first_lunar-Earth_flyby"
              >Juice rerouted to Venus in first lunar-Earth flyby</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 10:15:09</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41308712"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41308599">
          <h3>
            <a
              class="item"
              href="https://switowski.com/blog/i-have-built-my-first-successful-side-project-and-i-hate-it/"
              >I've built my first successful side project, and I hate it</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 09:59:41</span
              ><span class="points-container"
                >Points: <span class="points">371</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41308599"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41308114">
          <h3>
            <a
              class="item"
              href="https://webspace.science.uu.nl/~gent0113/idl/idl_discovery.htm"
              >The Discovery of the Celendrical Date Line</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 08:32:48</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41308114"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41308038">
          <h3>
            <a class="item" href="https://screen-play.app/"
              >ScreenPlay Is an Open Source Live-Wallpaper App for Windows and
              OS X</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 08:22:09</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41308038"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41307815">
          <h3>
            <a class="item" href="https://github.com/hsfzxjy/handwriter.ttf"
              >Show HN: Handwriter.ttf – Handwriting Synthesis with Harfbuzz
              WASM</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 07:47:05</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41307815"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
            <div class="text">
              During the hype of llama.ttf months ago, I was speculating the
              potential of WASM shaper for even crazier purpose, one that fitter
              to a font shaper's duty -- to synthesize font at runtime. This
              project as proof-of-concept implements a synthesizer that
              generates and rasterizes handwriting-style font, backed by a
              super-lightweight RNN model (~14MiB).
            </div>
          </section>
        </section>
        <section id="41307195">
          <h3>
            <a class="item" href="https://github.com/shadps4-emu/shadPS4"
              >ShadPS4 – PlayStation 4 emulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 05:58:12</span
              ><span class="points-container"
                >Points: <span class="points">310</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41307195"
                  >Comments</a
                ><span class="descendants">: 140</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41307166">
          <h3>
            <a
              class="item"
              href="https://www.pv-tech.org/australian-government-approves-aapowerlink-project-to-export-solar-to-singapore/"
              >Australian government approves AAPowerLink project to export
              solar to Singapore</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 05:52:31</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41307166"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41307011">
          <h3>
            <a class="item" href="https://csvbase.com/blog/13"
              >The semantic web is now widely adopted</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 05:22:27</span
              ><span class="points-container"
                >Points: <span class="points">337</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41307011"
                  >Comments</a
                ><span class="descendants">: 205</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41306128">
          <h3>
            <a class="item" href="https://phrack.org/issues/71/17.html#article"
              >Calling All Hackers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-21 @ 02:08:56</span
              ><span class="points-container"
                >Points: <span class="points">316</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41306128"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41304508">
          <h3>
            <a class="item" href="https://github.com/PlasmoHQ/plasmo"
              >Plasmo – A framework for building modern Chrome extensions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 21:56:05</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41304508"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41303974">
          <h3>
            <a class="item" href="https://www.zen-browser.app/"
              >Zen, a Arc-like open-source browser based on the Firefox
              engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 20:57:04</span
              ><span class="points-container"
                >Points: <span class="points">539</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41303974"
                  >Comments</a
                ><span class="descendants">: 258</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41302597">
          <h3>
            <a
              class="item"
              href="https://promptarmor.substack.com/p/data-exfiltration-from-slack-ai-via"
              >Data Exfiltration from Slack AI via indirect prompt injection</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 18:27:45</span
              ><span class="points-container"
                >Points: <span class="points">559</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41302597"
                  >Comments</a
                ><span class="descendants">: 164</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41301448">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41301448"
              >Launch HN: MinusX (YC S24) – AI assistant for data tools like
              Jupyter/Metabase</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 16:24:02</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41301448"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              <a href="https://minusx.ai">https://minusx.ai</a>), a data science
              assistant for Jupyter and Metabase. MinusX is a Chrome extension
              (<a href="https://minusx.ai/chrome-extension"
                >https://minusx.ai/chrome-extension</a
              >) that adds an AI sidechat to your analytics apps. Given an
              instruction, our agent operates your app (by clicking and typing,
              just like you would) to analyze data and answer queries. Broadly,
              you can do 3 types of things: ask for hypotheses and explore data,
              extend existing notebooks/dashboards, or select a region and ask
              questions. There's a simple video walkthrough here:
              <a href="https://www.youtube.com/watch?v=BbHPyX2lJGI"
                >https://www.youtube.com/watch?v=BbHPyX2lJGI</a
              >. The core idea is to "upgrade" existing tools, where people
              already do most of their data work, rather than building a new
              platform.
              <p>
                I (Vivek) spent 6 years working in various parts of the data
                stack, from data analysis at a 1000+ person ride hailing company
                to research at comma.ai, where I also handled most of the
                metrics and dashboarding infrastructure. The problems with data,
                surprisingly, were pretty much the same. Developers and product
                managers just want answers, or want to set up a quick view of
                some metric they care about. They often don't know which table
                contains what information, or what specific secret filters need
                to be kept in mind to get clean data. At large companies,
                analysts/scientists take care of most of these requests over a
                thousand back-and-forths. In small companies, most data projects
                end up being one-off efforts, and many die midway.
              </p>
              <p>
                I've tried every new shiny analytics app out there and none of
                them fully solve this core issue. New tools also come with a
                massive cost: you have to convince everyone around you to move,
                change all your workflows and hope the new tool has all features
                your trusty old one did. Most people currently go to ChatGPT
                with barely any real background context, and admonish the model
                till it sputters some useful code, SQL or hypothesis.This is the
                kind of user we're trying to help.
              </p>
              <p>
                The philosophy of MinusX mirrors that of comma. Just as comma is
                working on "an AI upgrade for your car", we want to retrofit
                analytics software with abilities that LLMs have begun to
                unlock. We also get a kick out of the fact that we use the same
                APIs humans use (clicking and typing), so we don't really need
                "permission" from any analytics app (just like comma.ai does not
                need permission from Mr Toyota Corolla) :)
              </p>
              <p>
                How it works: Given an instruction, the MinusX chrome extension
                first constructs a simplified representation of the host
                application's state using the DOM, and a bunch of application
                specific cues. We also have a set of (currently) predefined
                actions (eg: clicking and typing) that the agent can use to
                interact with the host application. Any "complex action" can be
                described as a combination of these action-primitives. We send
                this entire context, the instruction and the actions to an LLM.
                The LLM responds with a sequence of actions which are executed
                and the revised state is computed and sent back to the LLM. This
                loop terminates when the LLM evaluates that the desired goals
                are met. Our architecture allows users to extend the
                capabilities of the agent by specifying new actions as
                combinations of the action-primitives. We're working on enabling
                users to do this through the extension itself.
              </p>
              <p>
                "Retrofitting" is a weird concept for software, and we've found
                that it takes a while for people to grasp what this actually
                implies. We think, with AI, it will be more of a thing. Most
                software we use will be "upgraded" and not always by the people
                making the original software.
              </p>
              <p>
                We ourselves are focused on data analytics because we've worked
                in and around data science / data analysis / data engineering
                all our careers - working at startups, Google, Meta, etc - and
                understand it decently well. But since "retrofitting" can be
                just as useful for a bunch of other field-specific software,
                we're going to open-source the entire extension and associated
                plumbing in the near future.
              </p>
              <p>
                Also, let's be real - a sequence of function calls rammed
                through a decision tree does not make any for-loop "agentic".
                The reality is that a large amount of in-the-loop data needed
                for tasks such as ours does not exist yet! Getting this data
                flywheel running is a very exciting axis as well.
              </p>
              <p>
                The product is currently free to use. In the future, we'll
                probably charge a monthly subscription fee, and support local
                models / bring-your-own-keys. But we're still working that out.
              </p>
              <p>
                We'd be super stoked for you to try out MinusX! You can find the
                extension here:
                <a href="https://minusx.ai/chrome-extension"
                  >https://minusx.ai/chrome-extension</a
                >. We've also created a playground with data, for both Jupyter
                and Metabase, so once the extension is installed you can take it
                for a spin:
                <a href="https://minusx.ai/playground"
                  >https://minusx.ai/playground</a
                >
              </p>
              <p>
                We'd love to hear what you think about the idea, and anything
                else you'd like to share! Suggestions on which tools to support
                next are most welcome :)
              </p>
            </div>
          </section>
        </section>
        <section id="41300071">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/compression-algorithms"
              >Nasir Ahmed's digital-compression breakthrough helped make
              JPEGs/MPEGs possible</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 13:52:21</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41300071"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41299211">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=gwf5mAlI7Ug"
              >Basic Mechanisms In Fire Control Computers (1953) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 12:02:00</span
              ><span class="points-container"
                >Points: <span class="points">335</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41299211"
                  >Comments</a
                ><span class="descendants">: 113</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41299148">
          <h3>
            <a class="item" href="https://github.com/ankane/transformers-ruby"
              >Transformers for Ruby</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 11:54:07</span
              ><span class="points-container"
                >Points: <span class="points">343</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41299148"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41298794">
          <h3>
            <a class="item" href="https://maxschmitt.me/posts/toasts-bad-ux"
              >Toasts are bad UX</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 10:57:27</span
              ><span class="points-container"
                >Points: <span class="points">644</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41298794"
                  >Comments</a
                ><span class="descendants">: 365</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41297563">
          <h3>
            <a
              class="item"
              href="https://adrian3.com/blog/2019/2019-09-28-The-US-Navys-100-million-dollar-checkbox.php"
              >The U.S. Navy's $100M checkbox (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-20 @ 07:09:36</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41297563"
                  >Comments</a
                ><span class="descendants">: 205</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41293219">
          <h3>
            <a class="item" href="https://www.alexreichert.com/blog/finishing"
              >On finishing projects</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 18:03:21</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41293219"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41288579">
          <h3>
            <a
              class="item"
              href="https://kaeruct.github.io/posts/2024/08/18/migrating-from-dokuwiki-to-obsidian/"
              >Migrating from DokuWiki to Obsidian</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 07:16:28</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41288579"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41284189">
          <h3>
            <a class="item" href="https://github.com/baalimago/wd-40"
              >Show HN: Wd-40, a static webserver with automatic hot-reloads</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-18 @ 18:24:15</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41284189"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
            <div class="text">
              <p>
                I basically got bored with alt-tabbing and refresing when
                developing 'vanilla-js'. The hot-reload in the modern frameworks
                are very nice, so figured I'd recreate it.
              </p>
            </div>
          </section>
        </section>
        <section id="41282948">
          <h3>
            <a
              class="item"
              href="https://www.engadget.com/transportation/the-us-lays-out-a-road-safety-plan-that-will-see-cars-talk-to-each-other-170043265.html"
              >A road safety plan that will lead to cars communicating with each
              other</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-18 @ 15:29:33</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41282948"
                  >Comments</a
                ><span class="descendants">: 329</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41282033">
          <h3>
            <a
              class="item"
              href="https://www.kitchensoap.com/2012/10/25/on-being-a-senior-engineer/"
              >On Being a Senior Engineer (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-18 @ 12:42:11</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41282033"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41272893">
          <h3>
            <a
              class="item"
              href="https://elastio.github.io/bon/blog/the-weird-of-function-local-types-in-rust"
              >The weird of function-local types in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-17 @ 08:54:44</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41272893"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41272125">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=D7vfI-WSP8Q"
              >David Mackenzie – A Personal History with Linux and BSD Unix
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-17 @ 04:04:26</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41272125"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41271453">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41467-024-49917-3"
              >Evolution of adhesive systems in amphibians by shifts in gene
              expression</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-17 @ 00:13:19</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41271453"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41267894">
          <h3>
            <a
              class="item"
              href="https://tomeraberba.ch/the-1-hour-per-year-bug"
              >The 1 Hour per Year Bug, but only in Pacific time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-16 @ 16:34:56</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41267894"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
