<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45430498">
          <h3>
            <a
              class="item"
              href="https://www.empirical.health/blog/inflammation-and-heart-health/"
              >Inflammation now predicts heart disease more strongly than
              cholesterol</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 20:00:21</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45430498"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45430048">
          <h3>
            <a
              class="item"
              href="https://diff.wikimedia.org/2025/09/30/making-sure-ai-serves-people-and-knowledge-stays-human-wikimedia-foundation-publishes-a-human-rights-impact-assessment-on-the-interaction-of-ai-and-machine-learning-with-wikimedia-projects/"
              >Making sure AI serves people and knowledge stays human</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 19:23:34</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45430048"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45428482">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/business/airlines/boeing-has-started-working-on-a-737-max-replacement-40a110df"
              >Boeing has started working on a 737 MAX replacement</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 17:31:34</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45428482"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://finance.yahoo.com/news/boeing-reportedly-working-737-max-150822530.html"
                >https://finance.yahoo.com/news/boeing-reportedly-working-737...</a
              >,
              <a
                href="https://www.foxbusiness.com/markets/boeing-developing-new-single-aisle-plane-replace-737-max-aircraft"
                >https://www.foxbusiness.com/markets/boeing-developing-new-si...</a
              >
            </div>
          </section>
        </section>
        <section id="45428081">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/bild-ai/jobs/m2ilR5L-founding-engineer-applied-ai"
              >Bild AI (YC W25) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 17:01:27</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45428020">
          <h3>
            <a
              class="item"
              href="https://www.cell.com/current-biology/fulltext/S0960-9822(23)00181-1"
              >Genomic analyses of hair from Ludwig van Beethoven (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 16:57:07</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45428020"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45427982">
          <h3>
            <a class="item" href="https://openai.com/index/sora-2/">Sora 2</a>
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 16:55:01</span
              ><span class="points-container"
                >Points: <span class="points">243</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45427982"
                  >Comments</a
                ><span class="descendants">: 350</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.youtube.com/watch?v=gzneGhpXwjU"
                >https://www.youtube.com/watch?v=gzneGhpXwjU</a
              >
              <p>
                System card:
                <a href="https://openai.com/index/sora-2-system-card/"
                  >https://openai.com/index/sora-2-system-card/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="45427482">
          <h3>
            <a class="item" href="https://github.com/airweave-ai/airweave"
              >Launch HN: Airweave (YC X25) – Let agents search any app</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 16:21:09</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45427482"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <a href="https://airweave.ai/">https://airweave.ai/</a>), an
              open-source tool that lets AI agents search and retrieve context
              from your existing apps and databases through a single
              LLM-friendly API (or an MCP server, if that’s your thing). Our
              Github is at
              <a href="https://github.com/airweave-ai/airweave"
                >https://github.com/airweave-ai/airweave</a
              >. We previously did a Show HN
              <a href="https://news.ycombinator.com/item?id=43964201"
                >https://news.ycombinator.com/item?id=43964201</a
              >
              and since then we’ve recently launched the managed service and new
              search functionality.
              <p>
                Here’s an example of Cursor using Airweave
                <a href="https://www.youtube.com/watch?v=IvxidK9Ciy4"
                  >https://www.youtube.com/watch?v=IvxidK9Ciy4</a
                >. And here’s a general example of our new search functionality:
                <a href="https://www.youtube.com/watch?v=iqEqc_iGUO8"
                  >https://www.youtube.com/watch?v=iqEqc_iGUO8</a
                >
              </p>
              <p>
                We came to this problem while building agentic applications for
                webshop owners and customer service, and noticing most failure
                modes weren’t about tool execution, but finding the right
                internal context to enable the right actions.
              </p>
              <p>
                We started solving, what seemed at the time, a problem for our
                own use case, and quickly fell into a rabbithole of issues.
                Company and user data lives across SaaS and databases; it’s
                sparse, messy, and constantly changing. Agents need a data
                orchestration and retrieval layer that accepts free-form natural
                language queries and returns actionable results quickly.
              </p>
              <p>
                Simply pointing an agent at an MCP server does not equate to
                fine-grained search functionality or deep understanding of the
                underlying resource. Most MCP servers are thin wrappers that
                expose an existing API in a more LLM-friendly way, but this
                doesn’t actually give the agent any new capabilities beyond what
                the resource or app already offered. Specifically, it doesn’t
                give the agent a way to thoroughly search and understand the
                contents of the resource.
              </p>
              <p>
                Airweave connects to sources via their APIs, crawls and
                normalizes content, chunks it, extracts entity relationships,
                and indexes the chunks in a vector store alongside keyword
                fields and lightweight graph metadata in Postgres. Data sync is
                orchestrated with Temporal (handles pagination/rate limits,
                schedules, and change detection via timestamps and content
                hashes) so collections stay close to real-time with their
                sources.
              </p>
              <p>
                On retrieval, Airweave can run semantic and BM25 keyword search
                in parallel, fuse results (RRF), apply recency bias, and
                re-rank. Agents can fetch ranked chunks with citations or ask
                for a synthesized answer. The same interface is exposed via
                REST, Python/TS SDKs, and MCP so agents can discover it like any
                other tool.
              </p>
              <p>
                It’s been fun to see what users have built with Airweave; from
                legal AI assistants to research discovery agents and context
                augmentation for coding agents. We’re currently experimenting
                with agentic search patterns, layering different types of
                enrichment and indexing, RBAC on indexed data, and streaming
                architectures.
              </p>
              <p>
                If this is interesting to you, feel free to take it for a spin.
                Curious to hear your thoughts and feedback on the problem and
                our solution!
              </p>
            </div>
          </section>
        </section>
        <section id="45427111">
          <h3>
            <a
              class="item"
              href="https://www.cerebras.ai/press-release/series-g"
              >Cerebras systems raises $1.1B Series G</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 15:54:14</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45427111"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45427061">
          <h3>
            <a
              class="item"
              href="https://hyprmcp.com/blog/mcp-server-prompt-analytics/"
              >Prompt analytics for MCP servers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 15:50:22</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45427061"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45427059">
          <h3>
            <a class="item" href="https://paulbourke.net/fractals/lyapunov/"
              >Visualizations of Random Attractors Found Using Lyapunov
              Exponents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 15:50:14</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45427059"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45426680">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/Sep/30/designing-agentic-loops/"
              >Designing agentic loops</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 15:21:23</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45426680"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45426490">
          <h3>
            <a class="item" href="https://blog.kagi.com/kagi-news">Kagi News</a>
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 15:09:00</span
              ><span class="points-container"
                >Points: <span class="points">623</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45426490"
                  >Comments</a
                ><span class="descendants">: 283</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45425714">
          <h3>
            <a class="item" href="https://github.com/Mcmartelle/deml"
              >Deml: Directed Acyclic Graph Elevation Markup Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 14:12:37</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45425714"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45425298">
          <h3>
            <a class="item" href="https://www2.dmst.aueb.gr/dds/sw/dgsh/"
              >dgsh – Directed Graph Shell</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 13:39:22</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45425298"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45425061">
          <h3>
            <a class="item" href="https://isomorphism.xyz/blog/2025/duolingo/"
              >An opinionated critique of Duolingo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 13:19:53</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45425061"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45424888">
          <h3>
            <a
              class="item"
              href="https://www.express.co.uk/news/uk/2115228/image-site-imgur-pulls-out"
              >Imgur pulls out of UK as data watchdog threatens fine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 13:01:05</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45424888"
                  >Comments</a
                ><span class="descendants">: 187</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45424827">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2025/09/30/business/charlie-javice-frank-sentenced-jpmorgan-intl"
              >Founder sentenced to seven years in prison for fraudulent sale to
              JPMorgan</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 12:53:49</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45424827"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45424704">
          <h3>
            <a class="item" href="https://www.jefftk.com/p/pasta-cooking-time"
              >Pasta Cooking Time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 12:40:17</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45424704"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45424648">
          <h3>
            <a
              class="item"
              href="https://lcamtuf.substack.com/p/how-has-mathematics-gotten-so-abstract"
              >How has mathematics gotten so abstract?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 12:33:43</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45424648"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45424223">
          <h3>
            <a
              class="item"
              href="https://observablehq.com/@yurivish/orbiting-the-henon-attractor"
              >Orbiting the Hénon Attractor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 11:31:04</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45424223"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45423994">
          <h3>
            <a
              class="item"
              href="https://weliveindetail.github.io/blog/post/2025/09/30/tpde-in-llvm-orc.html"
              >Using the TPDE codegen back end in LLVM ORC</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 10:51:45</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45423994"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45423363">
          <h3>
            <a
              class="item"
              href="https://shkspr.mobi/blog/2025/09/can-you-use-gdpr-to-circumvent-blueskys-adult-content-blocks/"
              >Can you use GDPR to circumvent BlueSky's adult content blocks?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 08:50:11</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45423363"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45422653">
          <h3>
            <a
              class="item"
              href="https://velog.io/@0range1337/CTF-Google-CTF-2025-webz-Exploiting-zlibs-Huffman-Code-Table-English"
              >Google CTF 2025 – webz : Exploiting zlib's Huffman Code Table</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-30 @ 06:50:11</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45422653"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45417616">
          <h3>
            <a
              class="item"
              href="https://vnmakarov.github.io/2024/09/24/register-allocation-in-the-go-compiler.html"
              >Register allocation in the Go compiler (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-29 @ 19:14:57</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45417616"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45398760">
          <h3>
            <a
              class="item"
              href="https://www.openculture.com/2025/09/explore-a-new-digital-edition-of-printing-types-the-authoritative-history-of-printing-typography-from-1922.html"
              >Explore a new digital edition of "Printing Types" from 1922</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-27 @ 19:42:24</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45398760"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45395495">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2025/09/25/conways-pinwheel-tiling/"
              >Conway's pinwheel tiling</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-27 @ 13:19:25</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45395495"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45395156">
          <h3>
            <a
              class="item"
              href="https://philipfabianek.com/posts/cuda-ptx-introduction/"
              >A Gentle Introduction to CUDA PTX</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-27 @ 12:30:41</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45395156"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45395132">
          <h3>
            <a class="item" href="https://szeliski.org/Book/"
              >Computer Vision: Algorithms and Applications, 2nd ed</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-27 @ 12:27:29</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45395132"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45389716">
          <h3>
            <a
              class="item"
              href="https://capnfabs.net/posts/fuji-raf-compression-algorithm/"
              >How does lossless compression in Fuji RAF files work? (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-26 @ 18:43:58</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45389716"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45385354">
          <h3>
            <a class="item" href="https://dl.acm.org/doi/10.1145/359024.359031"
              >Design of the SCHEME-78 Lisp-based microprocessor (1980)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-26 @ 11:42:04</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45385354"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
