<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43233505">
          <h3>
            <a
              class="item"
              href="https://www.pcgamer.com/gaming-industry/mozilla-is-already-trying-to-backtrack-on-firefoxs-controversial-data-privacy-update-but-it-might-be-too-little-too-late/"
              >Mozilla is trying to backtrack on Firefox's controversial data
              privacy update</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 18:38:42</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43233505"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43233305">
          <h3><a class="item" href="https://olduse.net/">olduse.net</a></h3>
          <section>
            <h4>
              <span>2025-03-02 @ 18:21:04</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43233305"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43233273">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/opinions/2025/02/26/shower-pressure-save-water/"
              >'Your showerhead is lying to you'</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 18:17:48</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43233273"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43232999">
          <h3>
            <a
              class="item"
              href="https://manidoraisamy.com/developer-forever/post/the-era-of-solopreneurs-is-here.anc-52867368-2029-4dc5-a7da-ece853a648b5.html"
              >The Era of Solopreneurs Is Here</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 17:52:48</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43232999"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43232880">
          <h3>
            <a
              class="item"
              href="https://zetier.com/speedrunners-are-vulnerability-researchers/"
              >Speedrunners are vulnerability researchers, they just don't know
              it yet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 17:40:36</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43232880"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43232841">
          <h3>
            <a
              class="item"
              href="https://www.lexiconista.com/falsehoods-about-languages/"
              >Falsehoods programmers believe about languages (localization)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 17:36:20</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43232841"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43232730">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/distro/jobs/splSeS5-marketing-lead"
              >Distro (YC S24) Is Hiring a Marketing Lead in Palo Alto</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 17:26:44</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43232724">
          <h3>
            <a
              class="item"
              href="https://news.nus.edu.sg/nus-researchers-develop-new-battery-free-technology/"
              >New battery-free technology can power devices using ambient RF
              signals</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 17:25:49</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43232724"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43232690">
          <h3>
            <a
              class="item"
              href="https://blog.disintegrator.dev/posts/ode-to-typescript-enums/"
              >An Ode to TypeScript Enums</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 17:23:12</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43232690"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43232410">
          <h3>
            <a class="item" href="https://www.definite.app/blog/smallpond"
              >DeepSeek releases distributed DuckDB</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 17:00:30</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43232410"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43232255">
          <h3>
            <a
              class="item"
              href="https://twitter.com/EthanEvansVP/status/1895845734177452369"
              >Executive wealth as a factor in return-to-office</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 16:47:30</span
              ><span class="points-container"
                >Points: <span class="points">423</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43232255"
                  >Comments</a
                ><span class="descendants">: 240</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43231964">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43231964"
              >Ask HN: Where are the good Markdown to PDF tools (that meet these
              requirements)?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 16:18:44</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43231964"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                It contains lots of code in code blocks and has a table of
                contents at the start with internal links to later pages.
              </p>
              <p>
                I've tried lots of different Markdown-PDF converters like md2pdf
                and Pandoc, even trying converting it through LaTeX first,
                however none of them produce working internal PDF links, have
                effective syntax highlighting for HTML, CSS, JavaScript and
                Python, and wrap code to fit it on the page.
              </p>
              <p>
                I have a very long regular expression (email validation of
                course) that doesn't fit on one line but no solutions I have
                found properly break the lines on page overflow.
              </p>
              <p>What tools does everyone recommend?</p>
            </div>
          </section>
        </section>
        <section id="43231411">
          <h3>
            <a class="item" href="https://smagin.fyi/posts/cross-site-requests/"
              >Why do we have both CSRF protection and CORS?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 15:32:46</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43231411"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43230994">
          <h3>
            <a class="item" href="https://kaguya.io/"
              >Show HN: I built a modern Goodreads alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 14:50:20</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43230994"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
            <div class="text">
              <p></p>
              <pre><code>    Still no half-star ratings.
    No proper DNF (Did Not Finish) option.
    UI still looks like it's from 2005.
    Amazon owns it and doesn't care.
</code></pre>
              So I built Kaguya, a modern alternative, over the past 9 months.
              <p>What’s live:</p>
              <p></p>
              <pre><code>    Custom shelves (Organize however you want)
    Rich-text reviews (format your thoughts properly)
    10-star rating system (More nuance than 5 stars)
    DNF, On-Hold, and other reading statuses
    Likes, shares, comments on reviews
    Import your library from Goodreads/StoryGraph
    A beautiful design that doesn’t make you feel like you’re using an ancient website

 Coming next:

    Deep tagging system (Genres, moods, character traits, tropes)
    Beautiful stats &amp; insights (Visualize your reading habits)
    Discussion forums for every book (Think subreddit-style discussions)
</code></pre>
              Would love feedback. What do you think?
            </div>
          </section>
        </section>
        <section id="43230965">
          <h3>
            <a
              class="item"
              href="https://www.interconnects.ai/p/gpt-45-not-a-frontier-model"
              >GPT-4.5: "Not a frontier model"?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 14:47:56</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43230965"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43230922">
          <h3>
            <a
              class="item"
              href="https://shkspr.mobi/blog/2025/03/towards-a-test-suite-for-totp-codes/"
              >Towards a test-suite for TOTP codes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 14:41:59</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43230922"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43230920">
          <h3>
            <a class="item" href="https://ladybird.org/newsletter/2025-02-28/"
              >This Month in Ladybird February 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 14:41:46</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43230920"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43230821">
          <h3>
            <a
              class="item"
              href="http://lucstechblog.blogspot.com/2025/02/raspberry-pi-pico-audio-player.html"
              >Raspberry Pi Pico audio player</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 14:29:13</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43230821"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43230790">
          <h3>
            <a class="item" href="https://github.com/fingerthief/recommendarr"
              >Show HN: Recommendarr – AI Driven Recommendations Based on
              Sonarr/Radarr Media</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 14:25:21</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43230790"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've built a web app that helps you discover new shows and
                movies you'll actually enjoy by:
              </p>
              <p>
                - Connecting to your Sonarr/Radarr/Plex instances to understand
                your media library
              </p>
              <p>
                - Leveraging your Plex watch history for personalized
                recommendations
              </p>
              <p>
                - Using the LLM of your choice to generate intelligent
                suggestions
              </p>
              <p>
                - Simple setup: Easy integration with your existing media stack
              </p>
              <p>
                - Flexible AI options: Works with OpenAI-compatible APIs like
                OpenRouter, or run locally via LM Studio, Ollama, etc.
              </p>
              <p>
                - Personalized recommendations: Based on what you actually
                watch.
              </p>
              <p>
                While it's still a work in progress, it's already quite
                functional and I'd love your feedback!
              </p>
            </div>
          </section>
        </section>
        <section id="43229569">
          <h3>
            <a class="item" href="https://github.com/kwakubiney/safehaven"
              >Show HN: SafeHaven – A Minimal VPN Implementation in Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 12:00:27</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43229569"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <p>
                For the past few months, I've been exploring tools that
                integrate with the Linux networking stack. This led me to build
                SafeHaven, a lightweight and configurable VPN implementation
                written in Go. The goal was to better understand how virtual
                private networks work at a fundamental level.
              </p>
              <p>
                Would love feedback from the community! Repo link:
                <a href="https://github.com/kwakubiney/safehaven"
                  >https://github.com/kwakubiney/safehaven</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43228231">
          <h3>
            <a class="item" href="https://www.ferronweb.org/"
              >Show HN: I built a memory-safe web server in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 07:35:13</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43228231"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
            <div class="text">
              The web server that I am building is currently in beta, so any
              feedback is welcome.
            </div>
          </section>
        </section>
        <section id="43227303">
          <h3>
            <a
              class="item"
              href="https://helloanselm.com/writings/knowing-css-is-mastery-to-frontend-development"
              >Knowing CSS is mastery to Front end Development</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 04:32:06</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43227303"
                  >Comments</a
                ><span class="descendants">: 137</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43225686">
          <h3>
            <a class="item" href="https://lwn.net/Articles/928581/"
              >The early days of Linux (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 00:18:21</span
              ><span class="points-container"
                >Points: <span class="points">418</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43225686"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43225560">
          <h3>
            <a class="item" href="https://www.flashgamehistory.com/"
              >How Flash games shaped the video game industry (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-02 @ 00:05:30</span
              ><span class="points-container"
                >Points: <span class="points">214</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43225560"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43221697">
          <h3>
            <a class="item" href="https://varun.ch/posts/videowall/"
              >The most unhinged video wall, made out of Chromebooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 17:54:55</span
              ><span class="points-container"
                >Points: <span class="points">537</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43221697"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43217451">
          <h3>
            <a
              class="item"
              href="https://www.lurklurk.org/effective-rust/title-page.html"
              >Effective Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 08:59:25</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43217451"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43217309">
          <h3>
            <a
              class="item"
              href="https://www.mattcutts.com/blog/google-chrome-license-agreement/"
              >Google does not want rights to things you do using Chrome
              (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 08:38:12</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43217309"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43203180">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-025-00554-w"
              >‘Slime’ keeps the brain safe ― and could guard against ageing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 08:31:27</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43203180"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43201251">
          <h3>
            <a
              class="item"
              href="https://blog.charliemonroe.net/a-few-words-about-indie-app-business/"
              >A few words about indie app business</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 02:59:24</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43201251"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43186717">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/02/26/us/stanford-professor-cancer-bryant-lin.html"
              >When This Professor Got Cancer, He Didn't Quit. He Taught a Class
              About It</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-26 @ 18:44:50</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43186717"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
