<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39699996">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Nicolas_Bourbaki"
              >Nicolas Bourbaki</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-14 @ 02:22:48</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39699996"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39699725">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/personal-finance/passive-income-money-vending-machines-41800d11"
              >Chasing Passive Income, Americans Turn to Vending Machines</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-14 @ 01:34:01</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39699725"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39699333">
          <h3>
            <a class="item" href="https://johan.hal.se/wrote/2024/02/28/care/"
              >Care</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-14 @ 00:41:35</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39699333"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39698950">
          <h3>
            <a class="item" href="https://nanos.org">Nanos â€“ A Unikernel</a>
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 23:43:32</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39698950"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39698546">
          <h3>
            <a class="item" href="https://github.com/lavague-ai/LaVague"
              >LaVague: Open-source Large Action Model to automate Selenium
              browsing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 22:51:10</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39698546"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39698398">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/energy/sand-battery-finland/"
              >Giant 'sand battery' holds a week's heat for a whole town</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 22:32:12</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39698398"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39697935">
          <h3>
            <a
              class="item"
              href="https://www.fermyon.com/blog/introducing-spinkube-fermyon-platform-for-k8s"
              >Spinkube: Running WASM in Kubernetes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 21:45:38</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39697935"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39697520">
          <h3>
            <a
              class="item"
              href="https://blog.jcoglan.com/2017/02/12/the-myers-diff-algorithm-part-1/"
              >The Myers diff algorithm: part 1</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 21:07:19</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39697520"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39697483">
          <h3>
            <a
              class="item"
              href="https://platform.openai.com/docs/assistants/overview/step-4-create-a-run?context=with-streaming"
              >OpenAI: Streaming is now available in the Assistants API</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 21:03:29</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39697483"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696856">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2024/03/18/how-arnold-schoenberg-changed-hollywood"
              >How Arnold Schoenberg changed Hollywood</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 20:15:35</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696856"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696583">
          <h3>
            <a
              class="item"
              href="https://research.ibm.com/blog/science-expert-LLM"
              >IBM and NASA build language models to make scientific knowledge
              more accessible</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 19:54:30</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696583"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696482">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2024/03/eff-ninth-circuit-theres-no-software-exception-traditional-copyright-limits"
              >EFF to Ninth Circuit: No Software Exception to Traditional
              Copyright Limits</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 19:47:53</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696482"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696152">
          <h3>
            <a
              class="item"
              href="https://eieio.games/nonsense/game-13-breaktime/"
              >BreakTime: Running Breakout inside Google Calendar</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 19:21:53</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696152"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696139">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=8p02DtmyQhU"
              >A world from a sheet of paper (2023) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 19:21:10</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696139"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39695685">
          <h3>
            <a
              class="item"
              href="https://careers.snapmagic.com/o/senior-full-stack-engineer-snapmagic-copilot-2"
              >SnapMagic (YC S15) the AI Copilot for electronics is hiring
              full-stack engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 18:46:35</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39694505">
          <h3>
            <a
              class="item"
              href="https://loomcom.com/blog/emulating-the-dmd-5620-terminal/"
              >Emulating the DMD 5620 Terminal (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 17:27:27</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39694505"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39694353">
          <h3>
            <a
              class="item"
              href="https://possiblywrong.wordpress.com/2024/03/12/lemonade-stand/"
              >Lemonade Stand</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 17:17:36</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39694353"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39693221">
          <h3>
            <a class="item" href="https://ar5iv.labs.arxiv.org/html/1312.4068"
              >Marcel Grossmann and his contribution to the general theory of
              relativity</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 16:05:29</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39693221"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39692801">
          <h3>
            <a class="item" href="https://github.com/flox/flox"
              >Show HN: Flox 1.0 â€“ Open-source dev env as code with Nix</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 15:44:29</span
              ><span class="points-container"
                >Points: <span class="points">317</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39692801"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm Ron Efroni, CEO at Flox, and today we are releasing version
                1.0 of our open source CLI, helping folks manage development
                environments everywhere.My own experience with development
                environments began with air-gapped systems, having to actually
                burn software to a CD to iterate over a very slow and expensive
                development cycle, sometimes reaching the server rack and
                realizing I have the wrong disk.... Fast forward to today and
                there are countless alternatives available backed by incredible
                compute resources, yet we somehow still find ourselves paying
                the price of long development cycles. That's why I've been
                working for over a decade to simplify the development stack so
                we can spend more time on making 1's and 0's do magical things,
                and why my co-founder Michael and I started Flox to bring you
                the solution based on Nix. Today is just the first step on that
                journey. We hope you'll take a peek at our new release, and very
                much look forward to continuing the journey with you from here
                together!
              </p>
              <p>Introducing Flox 1.0</p>
              <p>
                Flox is a platform that lets developers and operators focus on
                building fast with reproducible environments that span the
                enterprise SDLC. Using a declarative framework based on Nix, a
                package management and configuration tool, Flox allows
                developers to create environments that contain everything they
                need to build software.
              </p>
              <p>Why Flox?</p>
              <p>
                Flox behaves a lot like your favorite and familiar package
                manager, but it allows you to create as many environments as you
                want on your machine. Each one can contain a different
                combination of packages.
              </p>
              <p>
                Environments are portable by default. If you install a package
                inside one that isn't cross-platform, it's easy to carve out
                exceptions. It's also easy to write hooks and populate your
                environment with variables - we designed it to be hackable.
              </p>
              <p>
                Flox environments run in user-space, like, where you are. When
                you type `ls` after activating a Flox environment you will see
                the same stuff because you're in the same place - even with all
                those new packages available. No mounting volumes, no proxying
                ports. No breaking into the toolset you just conjured.
              </p>
              <p>
                Getting Started: No sign-ups, just one install away. Dive into
                our GitHub repository (<a href="https://github.com/flox/flox"
                  >https://github.com/flox/flox</a
                >) and start exploring
              </p>
              <p>
                Iâ€™m around all day to answer questions, talk Nix, or just
                reminisce about simpler times ;).
              </p>
              <p>Lots of open source love, Ron</p>
            </div>
          </section>
        </section>
        <section id="39692387">
          <h3>
            <a
              class="item"
              href="https://deepmind.google/discover/blog/sima-generalist-ai-agent-for-3d-virtual-environments/"
              >A generalist AI agent for 3D virtual environments</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 15:22:56</span
              ><span class="points-container"
                >Points: <span class="points">402</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39692387"
                  >Comments</a
                ><span class="descendants">: 242</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39691735">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/world-us-canada-68555051"
              >Paul Alexander, â€˜the man in the iron lungâ€™, has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 14:38:11</span
              ><span class="points-container"
                >Points: <span class="points">288</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39691735"
                  >Comments</a
                ><span class="descendants">: 176</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39691119">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/mass-timber-is-great-but-it-will"
              >Mass timber is great, but it will not solve the housing
              shortage</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 13:41:59</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39691119"
                  >Comments</a
                ><span class="descendants">: 641</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39691108">
          <h3>
            <a
              class="item"
              href="https://voidcomputing.hu/blog/worse-better-prettier/"
              >More AR Glasses USB Protocols: The Worse, the Better and the
              Prettier</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 13:40:17</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39691108"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39690363">
          <h3>
            <a
              class="item"
              href="https://kottke.org/24/03/how-photos-were-transmitted-by-wire-in-the-1930s"
              >How photos were transmitted by wire in the 1930s</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 11:53:09</span
              ><span class="points-container"
                >Points: <span class="points">307</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39690363"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39688545">
          <h3>
            <a class="item" href="https://fly.io/blog/jit-wireguard-peers/"
              >JIT WireGuard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 06:13:09</span
              ><span class="points-container"
                >Points: <span class="points">430</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39688545"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39684845">
          <h3>
            <a
              class="item"
              href="https://tedium.co/2024/03/02/why-physical-objects-decay/"
              >Luster Lost: Pondering the way that physical objects degrade over
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-12 @ 20:55:59</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39684845"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39678745">
          <h3>
            <a class="item" href="https://www.sicpers.info/2024/03/yx-problem/"
              >YX Problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-12 @ 12:36:44</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39678745"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39678374">
          <h3>
            <a class="item" href="https://github.com/veryl-lang/veryl"
              >Veryl: A Modern Hardware Description Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-12 @ 11:44:01</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39678374"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39677152">
          <h3>
            <a
              class="item"
              href="https://www.hemmings.com/stories/article/steaming-sensation-1925-doble"
              >Howard Hughes modified a 1925 Doble steam car to reach 133 MPH
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-12 @ 07:57:42</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39677152"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39676636">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/machiavelli-on-the-problem-of-our-impure-beginnings"
              >The Battles over Beginnings</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-12 @ 06:06:06</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39676636"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
