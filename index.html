<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44102201">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/opinion/can-ebay-bargains-keep-new-york-citys-subways-running-mta-infrastructure-substations-3859fb5b"
              >NYC MTA scavenges for parts on eBay to maintain subway system</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 22:19:58</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44102201"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44102034">
          <h3>
            <a
              class="item"
              href="https://www.gwintrob.com/power-failure-review/"
              >My review of Power Failure: the downfall of America's greatest
              company</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 21:54:01</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44102034"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44101875">
          <h3>
            <a
              class="item"
              href="https://www.su.edu/blog/2025/05/21/shenandoah-students-creating-vr-experience-that-follows-the-lewis-and-clark-trail/"
              >Shenandoah Students Creating VR Experience Following the Lewis
              and Clark Trail</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 21:31:07</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44101875"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44101833">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/May/25/claude-4-system-prompt/"
              >Highlights from the Claude 4 system prompt</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 21:25:56</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44101833"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44101828">
          <h3>
            <a class="item" href="https://github.com/FlyGoat/csmwrap"
              >Get PC BIOS back on UEFI only system</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 21:25:09</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44101828"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44101787">
          <h3>
            <a class="item" href="http://www.iron-spring.com/"
              >Iron Spring PL/I Compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 21:19:18</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44101787"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44101724">
          <h3>
            <a class="item" href="https://github.com/jgarzik/sqawk"
              >Sqawk: A fusion of SQL and Awk: Applying SQL to text-based data
              files</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 21:11:58</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44101724"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44101691">
          <h3>
            <a
              class="item"
              href="https://journal.stuffwithstuff.com/2025/05/26/access-control-syntax/"
              >Access Control Syntax</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 21:07:31</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44101691"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44101619">
          <h3>
            <a
              class="item"
              href="https://developer.mozilla.org/en-US/docs/Web/API/CSS_Painting_API"
              >CSS Painting API</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 20:59:06</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44101619"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44101349">
          <h3>
            <a class="item" href="https://owlsintowels.org/">Owls in Towels</a>
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 20:27:59</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44101349"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44101072">
          <h3>
            <a
              class="item"
              href="https://danq.me/2025/05/26/downloading-vs-streaming/"
              >The Difference Between Downloading and Streaming</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 19:56:02</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44101072"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44100179">
          <h3>
            <a
              class="item"
              href="https://github.com/ross39/new_bloom_filter_repo/blob/main/README.md"
              >Lossless video compression using Bloom filters</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 18:32:02</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44100179"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44100148">
          <h3>
            <a class="item" href="https://benjaminaster.com/css-minecraft/"
              >CSS Minecraft</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 18:28:43</span
              ><span class="points-container"
                >Points: <span class="points">202</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44100148"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44100082">
          <h3>
            <a
              class="item"
              href="https://twitter.com/lbeurerkellner/status/1926991491735429514"
              >Claude 4 and GitHub MCP will leak your private GitHub
              repositories</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 18:20:18</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44100082"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44100035">
          <h3>
            <a
              class="item"
              href="https://htxt.co.za/2025/05/duolingo-ceo-tries-to-walk-back-ai-first-comments-fails/"
              >Duolingo CEO tries to walk back AI-first comments, fails</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 18:14:09</span
              ><span class="points-container"
                >Points: <span class="points">335</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44100035"
                  >Comments</a
                ><span class="descendants">: 239</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44099407">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/microled-optical-chiplet"
              >TSMC bets on unorthodox optical tech</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 17:15:19</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44099407"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44099187">
          <h3>
            <a class="item" href="https://github.com/pgdogdev/pgdog"
              >Show HN: PgDog – Shard Postgres without extensions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 16:55:49</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44099187"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/pgdogdev/pgdog"
                >https://github.com/pgdogdev/pgdog</a
              >). I’m scaling our favorite database, PostgreSQL. PgDog is a new
              open source proxy, written in Rust, with first-class support for
              sharding — without changes to your app or needing database
              extensions.
              <p>
                Here’s a walkthrough of how it works:
                <a href="https://www.youtube.com/watch?v=y6sebczWZ-c"
                  >https://www.youtube.com/watch?v=y6sebczWZ-c</a
                >
              </p>
              <p>
                Running Postgres at scale is hard. Eventually, one primary isn’t
                enough at which point you need to split it up. Since there is
                currently no good tooling out there to do this, teams end up
                breaking their apps apart instead.
              </p>
              <p>
                If you’re familiar with PgCat, my previous project, PgDog is its
                spiritual successor but with a fresh codebase and new goals. If
                not, PgCat is a pooler for Postgres also written in Rust.
              </p>
              <p>
                So, what’s changed and why a new project? Cross-shard queries
                are supported out of the box. The new architecture is more
                flexible, completely asynchronous and supports manipulating the
                Postgres protocol at any stage of query execution. (Oh, and you
                guessed it — I adopted a dog. Still a cat person though!)
              </p>
              <p>
                Not everything is working yet, but simple aggregates like max(),
                min(), count(*) and sum() are in. More complex functions like
                percentiles and average will require a bit more work. Sorting
                (i.e. ORDER BY) works, as long as the values are part of the
                result set, e.g.:
              </p>
              <p></p>
              <pre><code>     SELECT id, email FROM users
     WHERE admin = true
     ORDER BY 1 DESC;
</code></pre>
              PgDog buffers and sorts the rows in memory, before sending them to
              the client. Most of the time, the working set is small, so this is
              fine. For larger results, we need to build swap to disk, just like
              Postgres does, but for OLTP workloads, which PgDog is targeting,
              we want to keep things fast. Sorting currently works for bigint,
              integer, and text/varchar. It’s pretty straightforward to add all
              the other data types, I just need to find the time and make sure
              to handle binary encoding correctly.
              <p>
                All standard Postgres features work as normal for unsharded and
                direct-to-shard queries. As long as you include the sharding key
                (a column like customer_id, for example) in your query, you
                won’t notice a difference.
              </p>
              <p>
                How does this compare to Citus? In case you’re not familiar,
                Citus is an open source extension for sharding Postgres. It runs
                inside a single Postgres node (a coordinator) and distributes
                queries between worker databases.
              </p>
              <p>
                PgDog’s architecture is fundamentally different. It runs outside
                the DB: it’s a proxy, so you can deploy it anywhere, including
                managed Postgres like RDS, Cloud SQL and others where Citus
                isn’t available. It’s multi-threaded and asynchronous, so it can
                handle thousands, if not millions, of concurrent connections.
                Its focus is OLTP, not OLAP. Meanwhile, Citus is more mature and
                has good support for cross-shard queries and aggregates. It will
                take PgDog a while to catch up.
              </p>
              <p>
                My Rust has improved since my last attempt at this and I learned
                how to use the bytes crate correctly. PgDog does almost zero
                memory allocations per request. That results in a 3-5%
                performance increase over PgCat and a much more consistent p95.
                If you’re obsessed with performance like me, you know that small
                percentage is nothing to sneeze at. Like before, multi-threaded
                Tokio-powered PgDog leaves the single-threaded PgBouncer in the
                dust (<a href="https://pgdog.dev/blog/pgbouncer-vs-pgdog"
                  >https://pgdog.dev/blog/pgbouncer-vs-pgdog</a
                >).
              </p>
              <p>
                Since we’re using pg_query (which itself bundles the Postgres
                parser), PgDog can understand all Postgres queries. This is
                important because we can not only correctly extract the WHERE
                clause and INSERT parameters for automatic routing, but also
                rewrite queries. This will be pretty useful when we’ll add
                support for more complex aggregates, like avg(), and cross-shard
                joins!
              </p>
              <p>
                Read/write traffic split is supported out of the box, so you can
                put PgDog in front of the whole cluster and ditch the code
                annotations. It’s also a load balancer, so you can deploy it in
                front of multiple replicas to get 4 9’s of uptime.
              </p>
              <p>
                One of the coolest features so far, in my opinion, is
                distributed COPY. This works by hacking the Postgres network
                protocol and sending individual rows to different shards (<a
                  href="https://pgdog.dev/blog/hacking-postgres-wire-protocol"
                  >https://pgdog.dev/blog/hacking-postgres-wire-protocol</a
                >). You can just use it without thinking about cluster topology,
                e.g.:
              </p>
              <p></p>
              <pre><code>    COPY temperature_records (sensor_uuid, created_at, value)
    FROM STDIN CSV;
</code></pre>
              The sharding function is straight out of Postgres partitions and
              supports uuid v4 and bigint. Technically, it works with any data
              type, but I just haven’t added all the wrappers yet. Let me know
              if you need one.
              <p>
                What else? Since we have the Postgres parser handy, we can
                inspect, block and rewrite queries. One feature I was playing
                with is ensuring that the app is passing in the customer_id in
                all queries, to avoid data leaks between tenants. Brain dump of
                that in my blog here:
                <a href="https://pgdog.dev/blog/multi-tenant-pg-can-be-easy"
                  >https://pgdog.dev/blog/multi-tenant-pg-can-be-easy</a
                >.
              </p>
              <p>
                What’s on the roadmap: (re)sharding Postgres using logical
                replication, so we can scale DBs without taking downtime. There
                is a neat trick on how to quickly do this on copy-on-write
                filesystems (like EBS used by RDS, Google Cloud volumes, ZFS,
                etc.). I’ll publish a blog post on this soon. More at-scale
                features like blocking bad queries and just general “I wish my
                Postgres proxy could do this” stuff. Speaking of which, if you
                can think of any more features you’d want, get in touch. Your
                wishlist can become my roadmap.
              </p>
              <p>
                PgDog is being built in the open. If you have thoughts or
                suggestions about this topic, I would love to hear them. Happy
                to listen to your battle stories with Postgres as well.
              </p>
              <p>Happy hacking!</p>
              <p>Lev</p>
            </div>
          </section>
        </section>
        <section id="44099006">
          <h3>
            <a
              class="item"
              href="https://lisp-journey.gitlab.io/blog/hacker-news-now-runs-on-top-of-common-lisp/"
              >Hacker News now runs on top of Common Lisp</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 16:37:02</span
              ><span class="points-container"
                >Points: <span class="points">383</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44099006"
                  >Comments</a
                ><span class="descendants">: 203</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44098706">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44098706"
              >Launch HN: Nomi (YC X25) – Copilot for Sales</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 16:05:21</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44098706"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
            <div class="text">
              <a href="https://heynomi.com">https://heynomi.com</a>, a real-time
              AI that helps you sell better while you're actually in the call.
              Demo:
              <a href="https://youtu.be/XFxDCP8jdY8?si=CGnPM1zT4wxAvadJ"
                >https://youtu.be/XFxDCP8jdY8?si=CGnPM1zT4wxAvadJ</a
              >
              <p>
                Most of us aren’t trained in sales. We weren’t either. But in
                the early days, it’s the founders who have to sell, and learning
                that on live calls is brutal. After one particularly painful
                deal we lost, we joked that we needed an AI cofounder who could
                talk in our ear and save us from ourselves. That joke turned
                into a prototype, then a product.
              </p>
              <p>
                Nomi joins your video calls and gives you phrase suggestions
                when it matters most: – when someone pushes back, – when there’s
                a hidden signal worth digging into, – when it’s time to close
                (and how to do it without sounding pushy).
              </p>
              <p>
                Then after the call, it auto-generates clean CRM notes, action
                items, and sends you a short email breaking down what went well,
                what didn’t, and how to improve next time—based on your actual
                conversation.
              </p>
              <p>
                We’re also rolling out some features to make every call a
                learning opportunity and unlock revenue potential: – A/B testing
                different sets of objections during calls and comparing results
                in real time – Auto-update of your company’s sales playbook
                based on what’s actually working – Upsell opportunity spotting
                and predictive revenue estimates driven by what people say on
                calls
              </p>
              <p>
                The real-time part was the hardest. If advice shows up 2 seconds
                late, or it's off-topic, it's worse than useless. So we built a
                system with: - a Thinking Model to track the call’s momentum; -
                a tactic selector trained with reinforcement learning; - a
                lightweight LLM (boosted with RAG) that delivers custom phrase
                suggestions under 500 ms.
              </p>
              <p>
                Each user gets a private copilot trained on their own calls
                (with permission), plus simulated data and sales best practices.
                It gets sharper with every interaction, no manual tuning needed.
              </p>
              <p>
                Right now, we’re live with 30 teams. One company went from $200K
                to $360K in just a few weeks. Another brought on a new rep who
                closed their first deal with Nomi on week one.
              </p>
              <p>
                We also offer a free AI note-taker and free sales-coaching
                post-call emails. Just shoot us an email if you want to try it:
                founders@heynomi.com
              </p>
              <p>
                We’re launching on HN to meet other folks who’ve felt this pain,
                founders doing sales, builders figuring things out on the fly.
                If that’s you, we’d love your feedback. Or if you just want to
                geek out about fast-inference LLMs, streaming RAG, or real-time
                UX, happy to go deep.
              </p>
              <p>Let us know what you think!</p>
            </div>
          </section>
        </section>
        <section id="44098705">
          <h3>
            <a
              class="item"
              href="https://optimizedbyotto.com/post/debian-packaging-from-git/"
              >Creating Debian packages from upstream Git</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 16:05:18</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44098705"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44098579">
          <h3>
            <a
              class="item"
              href="https://panadestein.github.io/blog/posts/si.html#fnr.2"
              >Scheming a mise-en-abîme in BQN</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 15:53:30</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44098579"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44098442">
          <h3>
            <a class="item" href="https://github.com/loopj/wavephoenix"
              >WavePhoenix – open-source implementation of the Nintendo WaveBird
              protocol</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 15:37:12</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44098442"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44097986">
          <h3>
            <a
              class="item"
              href="https://micahflee.com/telemessage-explorer-a-new-open-source-research-tool/"
              >TeleMessage Explorer: a new open source research tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 14:50:48</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44097986"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://micahflee.com/telemessage-customers-include-dc-police-andreesen-horowitz-jp-morgan-and-hundreds-more/"
                >https://micahflee.com/telemessage-customers-include-dc-polic...</a
              >
            </div>
          </section>
        </section>
        <section id="44097144">
          <h3>
            <a
              class="item"
              href="https://blog.seas.upenn.edu/penn-engineers-discover-a-new-class-of-materials-that-passively-harvest-water-from-air/"
              >A new class of materials that can passively harvest water from
              air</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 13:14:29</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44097144"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44096808">
          <h3>
            <a
              class="item"
              href="https://lisyarus.github.io/blog/posts/particle-life-simulation-in-browser-using-webgpu.html"
              >Particle Life simulation in browser using WebGPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 12:28:12</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44096808"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44096395">
          <h3>
            <a class="item" href="https://heitorpb.github.io/bla/timeout/"
              >TIL: timeout in Bash scripts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-26 @ 11:34:28</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44096395"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44086830">
          <h3>
            <a class="item" href="https://github.com/Summa-Cogni/Mathpad"
              >Mathpad: A mathematical keypad for students and professionals</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 10:24:35</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44086830"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44086803">
          <h3>
            <a
              class="item"
              href="https://determinate.systems/posts/changelog-determinate-nix-352/"
              >Changelog: Lazy trees (faster Nix builds)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 10:14:30</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44086803"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44084383">
          <h3>
            <a
              class="item"
              href="https://code.videolan.org/videolan/dav1d/-/merge_requests/1788"
              >Improving performance of original dav1d video decoder</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-24 @ 23:24:56</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44084383"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44078080">
          <h3>
            <a class="item" href="https://www.gamestudies.org/0102/pearce/"
              >Sims, BattleBots, Cellular Automata God and Go (2001)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-24 @ 01:21:55</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44078080"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
