<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40016243">
          <h3>
            <a
              class="item"
              href="https://labornotes.org/2024/02/fords-battery-flagship-socked-mold-sickness-workers-say"
              >Ford's Battery Flagship Socked by Mold Sickness, Workers Say</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 18:38:40</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40016243"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40016090">
          <h3>
            <a
              class="item"
              href="https://www.politico.com/news/2024/04/12/google-california-news-journalism-00151873"
              >Google blocks some California news as fight over online
              journalism bill escalate</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 18:25:33</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40016090"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40015961">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40015961"
              >Bypass Paywalls repository is gone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 18:14:22</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40015961"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                https://gitlab.com/magnolia1234/bypass-paywalls-chrome-clean/
              </p>
              <p>Visiting the user profile says it has been blocked:</p>
              <p>https://gitlab.com/magnolia1234/</p>
            </div>
          </section>
        </section>
        <section id="40015851">
          <h3>
            <a
              class="item"
              href="https://www.dezeen.com/2024/04/11/tretten-bridge-collapse-norway-timber/"
              >"Strong focus on aesthetics" contributed to collapse of Norway
              timber bridge</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 18:06:14</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40015851"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40015113">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/artisan-ai/jobs/QNttgQ2-senior-backend-engineer"
              >Artisan AI (YC W24) Is Hiring a Senior Back End Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 17:00:17</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40014937">
          <h3>
            <a
              class="item"
              href="https://www.doscher.com/recovery-kit-version-2/"
              >Show HN: 5 Years Ago I made the Recovery Kit, I just made the
              RK2</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 16:45:09</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40014937"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              The Recovery Kit 2 is another cyberdeck that for me is part
              computer, part backup device, and part functional movie prop. It's
              been fun to build, and the HN community has been great with ideas-
              especially around hosting and getting me off Squarespace. I hope
              you all enjoy!
            </div>
          </section>
        </section>
        <section id="40014892">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2024/4/12/24128363/google-cjpa-news-removal-california"
              >Google threatens to cut off news after California proposes paying
              media outlets</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 16:41:46</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40014892"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40014730">
          <h3>
            <a class="item" href="https://www.zerosheets.com/"
              >Using Google Sheets as the back end/APIs of your app</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 16:29:01</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40014730"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40014087">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40014087"
              >I'm Peter Roberts, immigration attorney who does work for YC and
              startups. AMA</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 15:34:07</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40014087"
                  >Comments</a
                ><span class="descendants">: 170</span></span
              >
            </h4>
            <div class="text">
              <p>
                Previous threads we've done:
                <a href="https://news.ycombinator.com/submitted?id=proberts"
                  >https://news.ycombinator.com/submitted?id=proberts</a
                >.
              </p>
            </div>
          </section>
        </section>
        <section id="40011937">
          <h3>
            <a class="item" href="https://www.streamofconsciousness.net/"
              >Show HN: Stream of Consciousness – watch an artificial persona
              making art</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 12:43:21</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40011937"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>
                moved by curiosity about how to build an autonomous agent, and
                to explore the boundaries of machine creativity, I built a
                fictional entity (dubbed Livia) powered by LLMs, Multimodal
                models and text-to-image models to find some answers.
              </p>
              <p>
                What happened instead is that more questions have cropped up. An
                important hypothesis of this project is that, by observing the
                train of thought and witnessing the simulated state of mind and
                emotional emulation surrounding it, humans could empathize with
                a machine. What happens when that's the case? Would people enjoy
                companionship from a synthetic person? Would the Art
                establishment ever consider a non-human author (capable of
                making art and interacting with other humans) an Artist?
              </p>
              <p>
                Whatever the answers, I can't shake away the feeling that human
                uniqueness is being eroded and that we risk facing a crisis of
                meaning. Perhaps projects such as this help us demonize those
                fears, similarly to how sci-fi does, even though the boundary
                between fiction and reality is blurring.
              </p>
              <p>
                This was a collaboration with Tibor (hn user:
                <a href="https://news.ycombinator.com/user?id=tiborsaas"
                  >https://news.ycombinator.com/user?id=tiborsaas</a
                >). Read our release posts on:
                <a href="https://jamez.it/blog/b/14f"
                  >https://jamez.it/blog/b/14f</a
                >
                and
                <a href="https://tibor.szasz.hu/post/stream-of-consciousness"
                  >https://tibor.szasz.hu/post/stream-of-consciousness</a
                >
              </p>
              <p>Hope you enjoy it as much as we had fun building it.</p>
            </div>
          </section>
        </section>
        <section id="40011314">
          <h3>
            <a class="item" href="https://d-shoot.net/kagi.html"
              >I Lost Faith in Kagi</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 11:17:43</span
              ><span class="points-container"
                >Points: <span class="points">490</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40011314"
                  >Comments</a
                ><span class="descendants">: 435</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40011250">
          <h3>
            <a class="item" href="https://github.com/ad-si/tu"
              >Show HN: tu – Convert natural language date/time to UTC</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 11:04:04</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40011250"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40011111">
          <h3>
            <a
              class="item"
              href="https://www.jvt.me/posts/2024/04/12/use-renovate/"
              >Why I recommend Renovate over any other dependency update
              tools</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 10:35:48</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40011111"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40011100">
          <h3>
            <a class="item" href="https://github.com/FyshOS/fynedesk"
              >FyneDesk – Linux desktop environment in Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 10:33:48</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40011100"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40010819">
          <h3>
            <a
              class="item"
              href="https://github.com/tinygrad/open-gpu-kernel-modules"
              >Hacked Nvidia 4090 GPU driver to enable P2P</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 09:27:58</span
              ><span class="points-container"
                >Points: <span class="points">460</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40010819"
                  >Comments</a
                ><span class="descendants">: 215</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40010615">
          <h3>
            <a class="item" href="https://heatpumpmonitor.org/"
              >An open source initiative to share and compare heat pump
              performance data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 08:53:16</span
              ><span class="points-container"
                >Points: <span class="points">571</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40010615"
                  >Comments</a
                ><span class="descendants">: 271</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40010559">
          <h3>
            <a
              class="item"
              href="http://mathtourist.blogspot.com/2009/02/pondering-artists-perplexing-tribute-to.html"
              >An artist's perplexing tribute to the Pythagorean Theorem
              (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 08:44:22</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40010559"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40010221">
          <h3>
            <a
              class="item"
              href="https://spacetelescopelive.org/webb?obsId=01HTJT20C0STKNZ01KQYGEKBQ1"
              >What is Webb observing now?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 07:29:17</span
              ><span class="points-container"
                >Points: <span class="points">287</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40010221"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40010066">
          <h3>
            <a
              class="item"
              href="https://mathstodon.xyz/@two_star/112242224494626411"
              >Here's a puzzle game. I call it Reverse the List of Integers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 06:59:35</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40010066"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40010050">
          <h3>
            <a class="item" href="https://github.com/1fishe2fishe/EXODUS"
              >Show HN: Running TempleOS in user space without virtualization</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 06:57:50</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40010050"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>
                My project lets you run TempleOS as an app of some sort instead
                of using a virtual machine to run it - this brings a lot of
                benefits like speed, seamless filesystem integration (virtual
                machine development with stock TempleOS is really a pain.),
                command-line mode where you can code in HolyC on the command
                line instead of TempleOS' GUI.
              </p>
              <p>
                Its user-space nature lets it do networking quite easily with
                the FFI - it even features an IRC server, client and a wiki
                server!
              </p>
              <p>
                I've also added a bunch of third-party games and software
                written for TempleOS on the Community folder, I hope you people
                take a look and enjoy!
              </p>
            </div>
          </section>
        </section>
        <section id="40009997">
          <h3>
            <a
              class="item"
              href="https://contrapunctus.codeberg.page/blog/mapping-party-tips.html"
              >Organizing OpenStreetMap mapping parties</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 06:46:07</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40009997"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40009856">
          <h3>
            <a
              class="item"
              href="https://www.ianvisits.co.uk/articles/theres-a-dead-rabbit-in-seven-sisters-tube-station-71502/"
              >There’s a 30-year old dead Rabbit in Seven Sisters tube
              station</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 06:14:55</span
              ><span class="points-container"
                >Points: <span class="points">313</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40009856"
                  >Comments</a
                ><span class="descendants">: 172</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40009143">
          <h3>
            <a class="item" href="https://github.com/andrewcourtice/ripl"
              >Show HN: A JavaScript library for data visualization in both SVG
              and Canvas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 03:31:29</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40009143"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
            <div class="text">
              <p>
                I am aware there are already libraries that can draw to multiple
                contexts interchangeably, but I've added a few little niceties
                to Ripl that (as far as I know) some other libraries don't have
                such as CSS-like query selectors, DOM-like event bubbling, and
                keyframe animation support.
              </p>
              <p>
                The project is far from done and not published to NPM yet, but
                there are a few demos and source that you can look at in the
                repo.
              </p>
              <p>
                I'm happy with how it has come along and the things I've learnt
                along the way, especially the math. My dream would be to one day
                work on this full-time and build out a full data-viz library.
              </p>
            </div>
          </section>
        </section>
        <section id="39999530">
          <h3>
            <a
              class="item"
              href="https://www.labrujulaverde.com/en/2024/04/an-unusual-prehistoric-monument-made-up-of-three-interlocking-circles-a-typology-never-seen-before-discovered-in-france/"
              >An unusual prehistoric monument made up of three interlocking
              circles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 08:00:23</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39999530"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39999163">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39999163"
              >Show HN: Wunderbar – Learn language while working on your Mac</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 07:05:09</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39999163"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been living in Germany for a while now and struggling to
                pick up German. Even though I finished a B1 level language
                course, remembering all the common German words has been tough.
                I've tried a bunch of apps, but couldn't stick to any of them.
              </p>
              <p>
                Last month, I had an idea. I thought, what if I could see a
                German word and its meaning on the Menu Bar of my Mac? That way,
                I could learn new words while working without needing to set
                aside dedicated time.
              </p>
              <p>
                The app uses a spaced-repetition algorithm, so you'll see the
                same word multiple times until you've got it down. And even
                after you've learned it, you'll still see it again to make sure
                you don't forget.
              </p>
              <p>
                After making the app, lots of people asked me to include other
                languages, therefore I’ve added languages like Spanish, French,
                Dutch, Swedish, Japanese, and Italian.
              </p>
              <p>
                You can download the app here ($3.99):
                <a href="https://wunderbarapp.com">https://wunderbarapp.com</a>
              </p>
              <p>
                There's no subscription or anything like that. You pay once and
                it's yours forever.
              </p>
              <p>Let me know what you think!</p>
            </div>
          </section>
        </section>
        <section id="39998335">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39998335"
              >Ask HN: What resources to learn tech and software in
              manufacturing?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 04:18:20</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39998335"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've recently joined a company that do manufacturing, involving
                supply chain, shop floor management, material handling,
                inventory, production planning, quality control, tracability
                etc.
              </p>
              <p>
                I'm trying to learn as much as possible around today's
                innovation in these areas, what are the best technologies, best
                processes, what companies are in the forefront, which are up and
                coming, but find it a lot more difficult than for pure online
                software solutions.
              </p>
              <p>
                What approaches would you take to this, and is there any sources
                of information that you can recommend? Ways of extracting this
                knowledge?
              </p>
              <p>Obviously ChatGPT, perplexity and others have been asked.</p>
            </div>
          </section>
        </section>
        <section id="39989552">
          <h3>
            <a
              class="item"
              href="https://github.com/azerothcore/azerothcore-wotlk"
              >AzerothCore: Self-Hosted World of Warcraft 3.3.5a Server</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 11:39:24</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39989552"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39986883">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/magazine/archive/2024/05/george-orwell-1984-isle-of-jura/677843/"
              >What Orwell Feared</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 04:13:33</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39986883"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39984768">
          <h3>
            <a
              class="item"
              href="https://www.leadedsolder.com/2024/04/09/fujitsu-fm8-pickup-cpu-repair.html"
              >Pretty Eight Machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 22:00:38</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39984768"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39983091">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/science/archive/2024/04/beethoven-code-dynamics-manuscript/677964/"
              >A Secret Code May Have Been Hiding in Beethoven's Manuscripts for
              200 Years</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 19:15:58</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39983091"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
