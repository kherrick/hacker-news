<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37522106">
          <h3>
            <a
              class="item"
              href="https://www.ritsumei.ac.jp/~akitaoka/index-e.html"
              >Akiyoshi’s Illusion Pages</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 12:43:52</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37522106"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37521861">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/nasa-ufos-inidentified-flying-objects-8b477a5ed6a42f99bb13a4518368ce9a"
              >NASA says more science and less stigma are needed to understand
              UFOs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 12:20:31</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37521861"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37521804">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2023/09/the-pixel-tablet-is-actually-just-a-few-spare-parts-in-a-half-empty-body/"
              >The Pixel Tablet is just a few spare parts in a half-empty
              body</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 12:13:59</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37521804"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37521710">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/technology/2023/sep/15/tiktok-fined-345m-for-breaking-eu-data-law-on-childrens-accounts"
              >TikTok fined €345M for breaking EU data law on children’s
              accounts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 12:02:27</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37521710"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37521690">
          <h3>
            <a class="item" href="https://up.codes/careers"
              >UpCodes (YC S17) is hiring remote engineers across the
              Americas</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 12:00:44</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37521375">
          <h3>
            <a class="item" href="https://gumtrends.com"
              >Show HN: I built a dataset of 25k+ Gumroad products to spot
              market opportunities</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 11:24:31</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37521375"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37521240">
          <h3>
            <a
              class="item"
              href="https://iq.thc.org/how-does-linux-start-a-process"
              >How does Linux start a process</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 11:08:06</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37521240"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520528">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2023/sep/13/libya-flood-death-toll"
              >‘Sea is constantly dumping bodies’: fears Libya flood death toll
              may hit 20k</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 09:37:04</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520528"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520509">
          <h3>
            <a
              class="item"
              href="https://www.embarcadero.com/products/cbuilder/starter"
              >C++Builder 11 Community Edition</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 09:34:40</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520509"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520441">
          <h3>
            <a class="item" href="https://incolumitas.com/pages/BotOrNot/"
              >BotOrNot (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 09:23:50</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520441"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520079">
          <h3>
            <a
              class="item"
              href="https://ramatak.com/2023/09/15/unitys-new-pricing-a-wake-up-call-on-the-importance-of-open-source-in-gaming/"
              >Unity’s New Pricing: A Wake-Up Call on the Importance of Open
              Source in Gaming</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:24:59</span
              ><span class="points-container"
                >Points: <span class="points">246</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520079"
                  >Comments</a
                ><span class="descendants">: 226</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520065">
          <h3>
            <a
              class="item"
              href="https://www.metzdowd.com/pipermail/cryptography/2016-March/028824.html"
              >On the Impending Crypto Monoculture (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:23:23</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520065"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37520039">
          <h3>
            <a class="item" href="https://www.findmycat.io/"
              >Find my cat: open-source Cat Tracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:18:19</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37520039"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519982">
          <h3>
            <a class="item" href="https://www.marginalia.nu/log/88-futo-grant/"
              >Marginalia Search Receives FUTO Grant</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:08:00</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519982"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519928">
          <h3>
            <a class="item" href="https://github.com/mackieks/MaplePad"
              >MaplePad – RP2040 Dreamcast controller, VMU, and Purupuru (rumble
              pack) emulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 08:00:15</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519928"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519852">
          <h3>
            <a
              class="item"
              href="https://cerereanscratchpad.blogspot.com/2022/08/the-ashrae-ventilation-recommendations.html"
              >The Ashrae Ventilation Recommendations Are Too Low</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 07:49:22</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519852"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519418">
          <h3>
            <a
              class="item"
              href="https://billwillingham.substack.com/p/willingham-sends-fables-into-the"
              >Willingham sends Fables into the public domain</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 06:51:54</span
              ><span class="points-container"
                >Points: <span class="points">324</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519418"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37519053">
          <h3>
            <a
              class="item"
              href="https://status.cloud.google.com/incidents/EBxyHQgEPnbM3Syag5yL"
              >Global Google Kubernetes Engine Outage</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 06:00:26</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37519053"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37517567">
          <h3>
            <a class="item" href="https://b612-font.com/">B612 Font Family</a>
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 02:33:03</span
              ><span class="points-container"
                >Points: <span class="points">285</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37517567"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37517118">
          <h3>
            <a
              class="item"
              href="https://terrytao.wordpress.com/2012/12/29/a-mathematical-formalisation-of-dimensional-analysis/"
              >A mathematical formalization of dimensional analysis (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-15 @ 01:34:36</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37517118"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37515996">
          <h3>
            <a
              class="item"
              href="https://baynature.org/2023/09/12/inaturalist-strikes-out-on-its-own/"
              >iNaturalist strikes out on its own</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 23:07:16</span
              ><span class="points-container"
                >Points: <span class="points">362</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37515996"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37515645">
          <h3>
            <a class="item" href="https://vole.wtf/coder-serial-killer-quiz/"
              >Programming Language Inventor or Serial Killer? (2003)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 22:28:08</span
              ><span class="points-container"
                >Points: <span class="points">279</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37515645"
                  >Comments</a
                ><span class="descendants">: 128</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37514801">
          <h3>
            <a
              class="item"
              href="https://hermanradtke.com/webhook-failure-scenarios/"
              >Webhook Failure Scenarios</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 21:02:47</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37514801"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37514079">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/archaeologists-discover-more-than-100-ancient-drawings-in-spanish-cave-180982898/"
              >Archaeologists Discover More Than 100 Ancient Drawings in a
              Spanish Cave</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 20:01:47</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37514079"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37510865">
          <h3>
            <a
              class="item"
              href="https://blog.google/outreach-initiatives/education/automatic-update-extension-chromebook/"
              >Chromebooks will get 10 years of automatic updates</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 16:14:17</span
              ><span class="points-container"
                >Points: <span class="points">611</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37510865"
                  >Comments</a
                ><span class="descendants">: 347</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37509507">
          <h3>
            <a
              class="item"
              href="https://nothinghuman.substack.com/p/the-tyranny-of-the-marginal-user"
              >The Tyranny of the Marginal User</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 14:28:06</span
              ><span class="points-container"
                >Points: <span class="points">1234</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37509507"
                  >Comments</a
                ><span class="descendants">: 676</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37507419">
          <h3>
            <a class="item" href="https://nuejs.org"
              >Show HN: Nue – A React/Vue/Vite/Astro Alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 11:11:17</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37507419"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
            <div class="text">
              <p>I'm releasing two things today:</p>
              <p>
                1. Nue JS:
                <a href="https://nuejs.org/docs/nuejs/"
                  >https://nuejs.org/docs/nuejs/</a
                >
                — A tiny (2.3kb minzipped) JavaScript library for building user
                interfaces. It's like React/Vue core, but there are no hooks,
                effects, props, or other unusual abstractions on your way. Know
                the basics of HTML, CSS, and JavaScript and you are good to go.
                Nue JS supports server-side rendering (SSR), reactive
                components, and "isomorphic" combinations. It takes inspiration
                from Vue 2.0 and Riot.js. (I'm actually the original author of
                Riot).
              </p>
              <p>
                2. Nue ecosystem:
                <a href="https://nuejs.org/ecosystem/"
                  >https://nuejs.org/ecosystem/</a
                >
                — This is the ultimate goal and once all the sub-projects are
                finished, Nue will be a serious alternative to things like Vite,
                Next.js, and Astro.
              </p>
              <p>
                The thing is that I'm not happy with the current state of web
                development, so I want to write a completely new ecosystem from
                scratch. I'm taking advantage of the "old" innovations like
                progressive enhancement, separation of concerns, and semantic
                web design. Benefits highlighted here:
                <a href="https://nuejs.org/why/">https://nuejs.org/why/</a>
              </p>
              <p>All projects will be released under the MIT license.</p>
              <p>Happy to answer any questions.</p>
            </div>
          </section>
        </section>
        <section id="37506248">
          <h3>
            <a class="item" href="https://github.com/barracuda-fsh/pyobd"
              >Pyobd - a free and open source program for car diagnostics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-14 @ 08:05:19</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37506248"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37495166">
          <h3><a class="item" href="https://www.endbasic.dev/">EndBASIC</a></h3>
          <section>
            <h4>
              <span>2023-09-13 @ 11:12:02</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37495166"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37494001">
          <h3>
            <a class="item" href="http://jakobgreenfeld.com/agency-model"
              >Why agencies get stuck at $50k MRR</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-13 @ 08:49:11</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37494001"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
