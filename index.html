<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41049016">
          <h3>
            <a
              class="item"
              href="https://tedium.co/2024/07/23/linkedin-complex-linking-schemes/"
              >Why Is It So Hard to Share Links on LinkedIn?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 18:08:13</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41049016"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41048866">
          <h3>
            <a
              class="item"
              href="https://www.euronews.com/next/2024/07/22/microsoft-says-eu-to-blame-for-the-worlds-worst-it-outage"
              >Microsoft says EU to blame for the worst IT outage</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 17:52:32</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41048866"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41048777">
          <h3>
            <a
              class="item"
              href="https://divisbyzero.com/2010/05/27/turings-topological-proof-that-every-written-alphabet-is-finite/"
              >Turing's topological proof that every written alphabet is finite
              (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 17:43:41</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41048777"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41048747">
          <h3>
            <a
              class="item"
              href="https://www.chemistryworld.com/news/chinese-born-chemist-cleared-of-last-conviction-under-uss-espionage-probe/4019849.article"
              >Chinese-born chemist Feng Tao cleared of convictions under US
              espionage probe</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 17:41:27</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41048747"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41048677">
          <h3>
            <a
              class="item"
              href="https://culture.pl/en/article/how-warsaw-came-close-to-never-being-rebuilt"
              >How Warsaw Came Close to Never Being Rebuilt (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 17:33:28</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41048677"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41048325">
          <h3>
            <a
              class="item"
              href="https://www.emergetools.com/careers/jobs/product-engineer-ios-full-stack"
              >Emerge Tools (YC W21) Is Hiring a Product Engineer (iOS,
              Full-Stack)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 17:00:55</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41047110">
          <h3>
            <a class="item" href="https://punkx.org/unix-pipe-game/"
              >The Unix Pipe Card Game</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 15:35:10</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41047110"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41046956">
          <h3>
            <a
              class="item"
              href="https://letsencrypt.org/2024/07/23/replacing-ocsp-with-crls.html"
              >Intent to End OCSP Service</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 15:25:14</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41046956"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41046911">
          <h3>
            <a
              class="item"
              href="https://marketplace.visualstudio.com/items?itemName=HarveenAtwal.vscode-webtilities"
              >Show HN: VS Code Extension to skip the noisy web tools (JSON
              Prettify, and more)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 15:20:46</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41046911"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>
                Simple online tools on the web have become unnecessary greedy.
                For example,
              </p>
              <p>
                *
                <a href="https://jsonformatter.org/"
                  >https://jsonformatter.org/</a
                >
                displays 7 ads on page load
              </p>
              <p>
                *
                <a href="https://convertcase.net/">https://convertcase.net/</a>
                had 4 ads plus a Google Vignette.
              </p>
              <p>And many more sites do the same thing.</p>
              <p>
                It's just noisy, which is why I created this VS Code Extension
                where you don't need to even leave your editor for your small
                web operations. I also built a Desktop app and an online
                version, which can be reached or downloaded at
                smallonlinetools.net. Both of which will be ad-free forever.
              </p>
              <p>
                So far smallonlinetools.net has over 150 tools and I add more
                everyday! Give it a try and leave me a review is all I ask!
                Perhaps, share with your friends so we can rank better on
                Google!
              </p>
            </div>
          </section>
        </section>
        <section id="41046773">
          <h3>
            <a
              class="item"
              href="https://about.fb.com/news/2024/07/open-source-ai-is-the-path-forward/"
              >Open source AI is the path forward</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 15:08:41</span
              ><span class="points-container"
                >Points: <span class="points">695</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41046773"
                  >Comments</a
                ><span class="descendants">: 320</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41046397">
          <h3>
            <a
              class="item"
              href="https://fight-flash-fraud.readthedocs.io/en/latest/introduction.html#correcting-capacity-to-actual-size-with-f3fix"
              >A free tool to quickly detect counterfeit flash (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 14:34:50</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41046397"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41046226">
          <h3>
            <a class="item" href="https://trunkrs.dev/"
              >Trunk: Build, bundle and ship your Rust WASM application to the
              web</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 14:15:31</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41046226"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41046107">
          <h3>
            <a class="item" href="https://github.com/pygamelib/pygamelib"
              >A (not so) small library for terminal based game development</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 13:59:27</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41046107"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41045834">
          <h3>
            <a class="item" href="https://briefer.cloud/launches/notebooks/"
              >Show HN: Briefer – multiplayer notebooks with schedules, SQL, and
              built-in LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 13:30:32</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41045834"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>
                Our notebooks are kind of a mix between Notion and Jupyter with
                extra features, like the ability to schedule notebooks, turn
                them into dashboards and apps, and write SQL queries whose
                results turn into data frames automatically.
              </p>
              <p>
                We're building better notebooks because we think they're a great
                idea poorly executed - for three reasons.
              </p>
              <p>
                The first problem with notebooks is that they're difficult to
                share. Non-technical people don't want to download docker
                containers and install Python libraries to see what the data
                team is doing. Then, the data team takes screenshots of their
                work and pastes them somewhere else. The issue with this
                approach is that the data gets stale, and the output is not
                interactive, so it's difficult to get feedback and iterate.
              </p>
              <p>
                The second problem with notebooks is that they get too messy too
                quickly. One morning you have 10 blocks, and by the end of the
                day you have 192, but only six of them are meant to be seen by
                other people and the rest is just you jiu-jitsuing with the
                data. Consequently, even if non-technical people could see your
                work, they'd have a hard time figuring out what's happening.
              </p>
              <p>
                The third problem with notebooks is that it takes too much work
                to do simple things like when you want to query a database. In
                that case, you need to have the database credentials in your
                machine, and you have to write a bunch of wrapper code. Calling
                APIs, plotting simple graphs, and adding interactive components
                is equally as annoying.
              </p>
              <p>
                We're solving the sharing problem by bringing notebooks to the
                cloud (so you can schedule them) and using CRDTs to manage their
                state. Whenever you edit a Briefer notebook, we reconcile that
                using Yjs, and then propagate it to everyone else who's editing
                that notebook. Regarding compute instances, each workspace gets
                its own, and we provision them on demand.
              </p>
              <p>
                By the way, we manage the execution state of your blocks using
                Yjs too, which makes it much more stable and responsive across
                all clients. When you click "run", for example, we don't
                immediately send a request to run the block. Instead, we change
                the block's state to "execution-requested". Then, the observers
                in the back-end react to the change and update the block's state
                with the results. In other words, the front end and the server
                communicate with each other through the notebook's state. One
                side updates the state, and the other reacts.
              </p>
              <p>
                To solve the "messiness" issue, we've invested a lot of time in
                designing clean notebooks and allowing you to organize blocks in
                ways that make them more presentable. In Briefer, you can group
                multiple blocks into tabs and decide which blocks appear in the
                published version of your notebook. That way, you can hide all
                that data wrangling and focus on results. We also know that a
                vertical format is not always the best way to display results,
                so you can use your notebook's outputs to build dashboards too.
              </p>
              <p>
                Last but not least, we're reducing friction in simple tasks like
                plotting graphs and querying databases. In Briefer, you can plot
                graphs using a click-through interface, and if you need to plot
                something more intricate like a Sankey chart there's also a
                built-in AI assistant that you can prompt to generate code. When
                it comes to queries, we turn their results into dataframes
                automatically, and you can use SQL to query uploaded files too
                (we use DuckDB for that).
              </p>
              <p>
                We're really happy we get to show this to you all, thank you for
                reading about it! Please let us know your thoughts and questions
                in the comments.
              </p>
            </div>
          </section>
        </section>
        <section id="41045176">
          <h3>
            <a class="item" href="https://www.crisluengo.net/archives/1138/"
              >Median filtering (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 12:17:02</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41045176"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41043771">
          <h3>
            <a
              class="item"
              href="https://github.com/romansky/dom-to-semantic-markdown"
              >Show HN: Convert HTML DOM to semantic markdown for use in LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 08:13:31</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41043771"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41043568">
          <h3>
            <a class="item" href="https://two-wrongs.com/types-as-interfaces"
              >Types as Interfaces</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 07:34:09</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41043568"
                  >Comments</a
                ><span class="descendants">: 135</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41042846">
          <h3>
            <a class="item" href="https://github.com/asg017/sqlite-jiff"
              >SQLite-jiff: SQLite extension for timezones and complex
              durations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 05:36:54</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41042846"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41042294">
          <h3>
            <a
              class="item"
              href="https://anatolyzenkov.com/stolen-buttons/button-stealer"
              >Button Stealer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 03:37:53</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41042294"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41040543">
          <h3>
            <a class="item" href="https://danq.me/2024/07/21/ascii/"
              >The Elegance of the ASCII Table</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 22:31:17</span
              ><span class="points-container"
                >Points: <span class="points">248</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41040543"
                  >Comments</a
                ><span class="descendants">: 139</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41039967">
          <h3>
            <a class="item" href="https://github.com/linuxmint/timeshift"
              >Timeshift: System Restore Tool for Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 21:23:02</span
              ><span class="points-container"
                >Points: <span class="points">317</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41039967"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41039708">
          <h3>
            <a
              class="item"
              href="https://community.intel.com/t5/Processors/July-2024-Update-on-Instability-Reports-on-Intel-Core-13th-and/m-p/1617113#M74792"
              >July 2024 Update on Instability Reports on Intel Core 13th/14th
              Gen Desktop CPUs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 20:55:02</span
              ><span class="points-container"
                >Points: <span class="points">300</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41039708"
                  >Comments</a
                ><span class="descendants">: 180</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41038552">
          <h3>
            <a
              class="item"
              href="https://bitbuilt.net/forums/index.php?threads/kawaii.6474/"
              >Kawaii – A Keychain-Sized Nintendo Wii</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 19:12:22</span
              ><span class="points-container"
                >Points: <span class="points">693</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41038552"
                  >Comments</a
                ><span class="descendants">: 207</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41038372">
          <h3>
            <a class="item" href="https://matthewstrom.com/writing/copying/"
              >Copying is the way design works</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 18:59:38</span
              ><span class="points-container"
                >Points: <span class="points">636</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41038372"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41037981">
          <h3>
            <a
              class="item"
              href="https://johncarlosbaez.wordpress.com/2024/07/20/what-is-entropy/"
              >What Is Entropy?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 18:33:35</span
              ><span class="points-container"
                >Points: <span class="points">296</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41037981"
                  >Comments</a
                ><span class="descendants">: 167</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41037745">
          <h3>
            <a
              class="item"
              href="https://netflixtechblog.com/maestro-netflixs-workflow-orchestrator-ee13a06f9c78"
              >Maestro: Netflix's Workflow Orchestrator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 18:20:16</span
              ><span class="points-container"
                >Points: <span class="points">282</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41037745"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41037532">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41037532"
              >Ask HN: I built a Yubikey-based domain controller. Is it
              sellable?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 18:07:16</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41037532"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>
                In my own SMB, I still self-host git, CI, chat, etc. I love the
                privacy and control, but I also needed to open these services to
                remote workers without exposing them to the world. So I built an
                appliance to protect my internal web apps by requiring
                user/pass+yubikey at multiple layers of the stack: L3 (p2p vpn),
                L4 (mTLS), and L7 (OIDC). The appliance is self contained (VPN,
                LDAP, NTP, CA, OIDC), like a classic domain controller, and it
                keeps servers safe from any users without an authorized hardware
                key.
              </p>
              <p>
                I'd love to bundle this with an admin panel and sell it, but I
                forsee problems connecting with the right market:
              </p>
              <p>
                * Clients who have meaningful IT budgets will require
                inter-operation with their legacy domain controllers. This means
                I won't have an MVP without major changes and lots of testing.
                It also puts my own product at risk: if Microsoft doesn't want
                to support my integrations, they can disable my product with a
                software update.
              </p>
              <p>
                * Clients who are too small to have lots of legacy IT
                requirements will have small budgets and require lots of
                support. Some of these clients will grow larger, but this is a
                long game. I would love to support these clients but don't want
                to die for lack of revenue in the short term.
              </p>
              <p>How would you sell what I've built?</p>
            </div>
          </section>
        </section>
        <section id="41035183">
          <h3>
            <a
              class="item"
              href="https://www.ubicloud.com/blog/difference-between-running-postgres-for-yourself-and-for-others"
              >Difference between running Postgres for yourself and for
              others</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 14:56:53</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41035183"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41018635">
          <h3>
            <a class="item" href="https://shape-of-motion.github.io/"
              >Shape of Motion: 4D Reconstruction from a Single Video</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-20 @ 18:41:12</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41018635"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40995344">
          <h3>
            <a
              class="item"
              href="https://www.redthreatsec.com/blog/greenlightspart1"
              >Give Me the Green Light Part 1: Hacking Traffic Control
              Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 13:24:44</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40995344"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
