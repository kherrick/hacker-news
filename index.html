<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36976124">
          <h3>
            <a class="item" href="http://neil-clarke.com/busting-a-myth/"
              >Busting a Myth: “Only writers subscribe to genre magazines”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 19:41:40</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36976124"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36975974">
          <h3>
            <a class="item" href="https://www.hackerone.com/ceo/company-update"
              >HackerOne lays off 12% of its workforce</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 19:33:14</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36975974"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36975701">
          <h3>
            <a
              class="item"
              href="https://docs.fcc.gov/public/attachments/DA-23-652A1.txt"
              >FCC allows blocking traffic from robocall-friendly provider One
              Owl</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 19:17:07</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36975701"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36975245">
          <h3>
            <a
              class="item"
              href="https://blog.skypilot.co/finetuning-llama2-operational-guide/"
              >Cookbook: Finetuning Llama 2 in your own cloud environment,
              privately</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 18:50:15</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36975245"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36975143">
          <h3>
            <a
              class="item"
              href="https://thewhyaxis.substack.com/p/cops-still-take-more-stuff-from-people"
              >Cops still take more stuff from people than burglars do</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 18:43:52</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36975143"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36974681">
          <h3>
            <a
              class="item"
              href="https://twitter.com/lipez400/status/1686793608626663441"
              >LK99: Team of Southeast University observed zero resistance below
              110 K</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 18:14:04</span
              ><span class="points-container"
                >Points: <span class="points">210</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36974681"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36974358">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/applehelp/comments/15gechw/apple_just_stole_hundreds_of_dollars_from_me/"
              >Apple stole $100s from me, Customer Service says there's nothing
              they can do</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 17:51:53</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36974358"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36974096">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/world/asia-pacific/point-no-return-australians-fight-right-work-home-permanently-2023-08-01/"
              >Australians fight for the right to work from home permanently</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 17:35:00</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36974096"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36974082">
          <h3>
            <a
              class="item"
              href="https://boingboing.net/2023/08/02/cory-doctorows-new-book-on-beating-big-tech-at-its-own-game.html"
              >Cory Doctorow's new book on beating big tech at its own game</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 17:34:18</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36974082"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36973807">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/b9582d62-cc6f-4b76-b0f9-5b37cf15dce4"
              >Companies with good ESG scores pollute as much as low-rated
              rivals</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 17:16:31</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36973807"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36973584">
          <h3>
            <a
              class="item"
              href="https://ollama.ai/blog/run-llama2-uncensored-locally"
              >Run Llama 2 Uncensored Locally</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 17:00:49</span
              ><span class="points-container"
                >Points: <span class="points">377</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36973584"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36973498">
          <h3>
            <a
              class="item"
              href="https://www.aswf.io/blog/academy-software-foundation-announces-openpbr-a-new-subproject-of-materialx/"
              >Academy Software Foundation Announces OpenPBR, a New Subproject
              of MaterialX</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 16:54:59</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36973498"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36973400">
          <h3>
            <a class="item" href="https://www.prettypolly.app"
              >Show HN: Learn a language quickly by practising speaking with
              AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 16:47:37</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36973400"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
            <div class="text">
              <p>
                Hope everyone is well. This app was borne out of my own
                frustration. I thought that I was terrible at learning languages
                at school, since I didn't become conversational in French after
                5 years of study. However, I later traveled with some French
                friends and, in just under 3 weeks, I was able to hold a
                reasonable conversation. I realized that there's no substitute
                for speaking to native speakers.
              </p>
              <p>
                I tried to adopt this approach for other languages, but it's
                much harder to find people to practise with when you aren't
                travelling. I started using iTalki to meet people from different
                countries and chat to them. It quickly became very expensive and
                time-consuming to schedule the calls, so I gave up.
              </p>
              <p>
                I made PrettyPolly so that anyone can easily practice speaking
                26 languages orally. The app uses ChatGPT (amongst other tools)
                to allow you to practice speaking whenever you want. It also
                generates a fluency score for each conversation so that you have
                an objective way of tracking progress.
              </p>
              <p>
                It's free to use (up to 15 conversations per month). I've found
                that using it once or twice per day is plenty, and you'll be
                amazed at how much you will pick up in a week. I've added some
                FAQs here in case useful -
                <a href="https://www.prettypolly.app/learn"
                  >https://www.prettypolly.app/learn</a
                >
              </p>
              <p>
                Would really appreciate any feedback. Let me know if you have
                any questions, issues or suggestions.
              </p>
              <p>Thanks, Chris</p>
            </div>
          </section>
        </section>
        <section id="36973287">
          <h3>
            <a
              class="item"
              href="https://fedoramagazine.org/coming-soon-fedora-for-apple-silicon-macs/"
              >Coming Soon: Fedora for Apple Silicon Macs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 16:40:17</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36973287"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36972961">
          <h3>
            <a
              class="item"
              href="https://harpers.org/wp-content/uploads/2008/09/HarpersMagazine-1996-01-0007859.pdf"
              >On the (nearly lethal) comforts of a luxury cruise (1996)
              [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 16:18:00</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36972961"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36972398">
          <h3>
            <a class="item" href="https://github.com/reflex-dev/reflex"
              >Reflex – Web apps in pure Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:40:04</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36972398"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36972347">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/blog/audiocraft-musicgen-audiogen-encodec-generative-ai-audio/"
              >Meta Open Sources AudioCraft: Generative AI for Audio</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:36:31</span
              ><span class="points-container"
                >Points: <span class="points">591</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36972347"
                  >Comments</a
                ><span class="descendants">: 191</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36972227">
          <h3>
            <a
              class="item"
              href="https://www.decisionproblem.com/paperclips/index2.html"
              >Universal Paperclips</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:28:42</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36972227"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36972134">
          <h3>
            <a
              class="item"
              href="https://iapp.org/news/a/a-view-from-dc-adtech-is-built-on-a-privacy-fault-line/"
              >Adtech is built on a privacy fault line</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:21:57</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36972134"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36971975">
          <h3>
            <a
              class="item"
              href="https://praveshkoirala.com/2023/06/13/a-non-mathematical-introduction-to-kalman-filters-for-programmers/"
              >A Non-Mathematical Introduction to Kalman Filters for
              Programmers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:11:48</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36971975"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36971888">
          <h3>
            <a
              class="item"
              href="https://chargebackstop.com/blog/card-networks-exploitation/"
              >How I discovered the underground world of credit card network
              exploitation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 15:05:16</span
              ><span class="points-container"
                >Points: <span class="points">301</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36971888"
                  >Comments</a
                ><span class="descendants">: 181</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36970135">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36970135"
              >Launch HN: Certainly Health (YC S23) – Book doctors without
              surprise bills</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 12:45:59</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36970135"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
            <div class="text">
              <a href="https://certainlyhealth.com/"
                >https://certainlyhealth.com/</a
              >), a marketplace that lets you shop for doctors and compare your
              out-of-pocket costs upfront (currently only in NYC). Using each
              patient's insurance and machine learning, we predict and guarantee
              out-of-pocket costs to prevent surprise bills.
              <p>
                We grew up in immigrant families, and for both of us, our
                parents would honestly tell us to not trust doctors because of
                unexpected medical bills. They really believed that doctors were
                adding on unnecessary things that didn’t help in order to make
                more money. As adults, we’ve both had first-hand experiences
                receiving surprise bills even with good insurance while working
                at tech companies, so solving this problem is personal to us.
              </p>
              <p>
                It turns out 38% of Americans delay medical care for fear of the
                bill while prices vary 2-10x across health providers, even when
                using insurance. This led us to believe that creating a
                marketplace with transparent out-of-pocket costs could be a
                solution.
              </p>
              <p>
                However, it wasn’t until the July 2022 Transparency in Coverage
                Rule (<a
                  href="https://www.cms.gov/healthplan-price-transparency"
                  >https://www.cms.gov/healthplan-price-transparency</a
                >) that we had the payer pricing data (that’s actually high
                quality compared to hospital data) to create this marketplace.
                Certainly is the first company to use this data to predict and
                guarantee prices for consumers to book doctors.
              </p>
              <p>
                We know the HN community has been interested in applications of
                healthcare price transparency data (<a
                  href="https://news.ycombinator.com/item?id=32738783"
                  >https://news.ycombinator.com/item?id=32738783</a
                >), so we’re excited to share how we’re using this data to
                predict and guarantee prices for a consumer application.
              </p>
              <p>
                With Certainly, patients can enter their insurance, compare
                guaranteed out-of-pocket costs across doctors, and book an
                appointment with price transparency. For providers, we guarantee
                any patient we send them will always pay. Partner providers pay
                us any time we send them a new patient. Eventually, we’ll
                convert providers to using our SaaS platform to guarantee
                payments from existing patients.
              </p>
              <p>
                We are currently focused on shoppable services - anything that
                can be scheduled in advance. Our solution falls between two ends
                of the spectrum for consumer shopping experiences. At one end is
                healthcare, where the status quo is you go to a doctor and you
                have no idea what will happen and you have no idea how much it
                will cost. At the other end is going to a restaurant, having a
                menu of items with corresponding prices, and deciding which
                items you want to order.
              </p>
              <p>
                Certainly Health lets you see what services could happen during
                your visit and how much they will cost. We guarantee that if
                those services happen, you will not pay more than the
                out-of-pocket costs you saw upfront for each of those services.
                But it is ultimately the doctor who decides which services you
                end up getting (like a chef deciding which dishes you will be
                served). As a result, you can compare upfront out-of-pocket
                costs specific to your insurance and book a provider without
                worrying about surprise bills.
              </p>
              <p>
                A common misconception is that patient out-of-pocket costs are
                set by doctors. Prices of healthcare services are actually the
                result of negotiations between providers and insurance
                companies. Groups with more negotiating power, like large
                hospital systems, are able to command higher rates than private
                practice physicians. This variance in cost is enormous across
                almost all procedures we've looked at, even between providers a
                few blocks from each other. It might cost $105 to get an
                orthopedic consultation with one doctor, and $550 to get a
                consultation with another doctor across the street, for example.
                This price variance means the out-of-pocket cost also varies for
                patients with high deductible plans or plans where the copay
                does not cover all services (which we’ve encountered very
                often).
              </p>
              <p>
                We do not use hospital price data which is inconsistent and
                messy (<a
                  href="https://www.kff.org/health-costs/press-release/analysis-inconsistencies-within-hospital-price-transparency-data-make-cost-comparisons-difficult/"
                  >https://www.kff.org/health-costs/press-release/analysis-inco...</a
                >). Instead, our guaranteed prices are based on three things:
                (1) health insurance published rates for procedures, as required
                by regulation; (2) patient eligibility/benefits information
                (e.g. deductible, copay, coinsurance); and (3) an online
                learning model to account for variance across thousands of plans
                and patient conditions.
              </p>
              <p>
                As we process payments and claims, we create an accurate
                platform for predicting out-of-pocket costs by accounting for
                variations such as whether certain procedures are covered by an
                insurance plan/copay, and how the rate changes based on
                diagnosis code (we discovered V97.33XD is for "Sucked into jet
                engine, subsequent encounter”), number of units, medical coding
                modifiers, and other factors.
              </p>
              <p>
                Certainly is currently available in NYC where you can choose
                from over 5k doctors to book without surprise bills for free at
                <a href="https://certainlyhealth.com/"
                  >https://certainlyhealth.com/</a
                >. We plan to expand to other cities once we prove that we can
                establish a low CAC on both the supply and demand sides in NYC.
              </p>
              <p>
                Although we’re early, we’re starting to see intended results.
                One patient saved $850 on a podiatrist visit booked through us
                compared to a previous visit with a different doctor for the
                exact same services. Another was charged for an annual physical,
                but we identified the mistake and got a refund issued to him.
                Most of our customers have had surprise bills in the past and
                are happy to have peace of mind with our upfront, guaranteed
                prices.
              </p>
              <p>
                We’d love to hear your ideas, experiences, feedback and any
                feature requests!
              </p>
            </div>
          </section>
        </section>
        <section id="36969473">
          <h3>
            <a
              class="item"
              href="https://aaronhertzmann.com/2020/04/19/lines-as-edges.html"
              >Why edge detection doesn’t explain line drawing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 11:35:59</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36969473"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36967829">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/when-beetle-gets-eaten-frog-it-forces-its-way-out-back-door-180975484/"
              >A beetle that heads for the ‘back door’ when eaten by a frog
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 06:52:45</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36967829"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36967594">
          <h3>
            <a class="item" href="https://austinhenley.com/blog/90percent.html"
              >Stopping at 90%</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 06:16:57</span
              ><span class="points-container"
                >Points: <span class="points">272</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36967594"
                  >Comments</a
                ><span class="descendants">: 160</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36965144">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-08-intermediate-polars-astronomers.html"
              >Two intermediate polars investigated by astronomers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 00:14:15</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36965144"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36958529">
          <h3>
            <a
              class="item"
              href="https://www.sicotests.com/newpsyarticle/Life-history-theory"
              >Life History Theory</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 16:43:54</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36958529"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36958008">
          <h3>
            <a
              class="item"
              href="https://ghdi.ghi-dc.org/sub_document.cfm?document_id=2320"
              >Transcript of Taped Conversations Among German Nuclear Physicists
              (1945)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 16:12:44</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36958008"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36953195">
          <h3>
            <a class="item" href="https://oxocard.ch/en/"
              >Oxocards: Interactive Programmable Minicomputers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 07:01:17</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36953195"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36953141">
          <h3>
            <a
              class="item"
              href="https://openjdk.org/projects/leyden/notes/03-toward-condensers"
              >Toward Condensers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-01 @ 06:53:23</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36953141"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
