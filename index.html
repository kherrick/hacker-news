<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45932131">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/mentra/jobs/2YbQCRw-make-smart-glasses-mainstream-head-of-growth"
              >Mentra (YC W25) Is Hiring: Head of Growth to Make Smart Glasses
              Mainstream</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 21:00:25</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45932051">
          <h3>
            <a class="item" href="https://firstmicroprocessor.com/"
              >First Microprocessor – 50th Anniversary 2020</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 20:53:28</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45932051"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45931552">
          <h3>
            <a
              class="item"
              href="https://berryvilleiml.com/2025/11/14/houston-we-have-a-problem-anthropic-rides-an-artificial-wave/"
              >Houston, We Have a Problem: Anthropic Rides an Artificial Wave –
              BIML</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 20:06:31</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45931552"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45931403">
          <h3>
            <a
              class="item"
              href="https://bittersoutherner.com/issue-no-12/all-praise-to-the-lunch-ladies"
              >All Praise to the Lunch Ladies</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 19:54:58</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45931403"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45931331">
          <h3>
            <a class="item" href="https://searchepsteinfiles.com/"
              >Show HN: Epstein Files Organized and Searchable</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 19:50:16</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45931331"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>
                Throwaway in case this is assumed to be politcally motivated.
              </p>
              <p>
                I spent some time organizing the Eptstein files to make
                transparency a little clearer. I need to tighten the data for
                organizations and people a bit more, but hopeful this is helpful
                in research in the interim.
              </p>
            </div>
          </section>
        </section>
        <section id="45931224">
          <h3>
            <a
              class="item"
              href="https://www.satcom.digital/news/genergo-an-italian-company-builds-the-worlds-first-known-propellantless-space-propulsion-system-flight-tested-and-validated-on-orbit"
              >An Italian Company Builds the First Known Propellantless
              Space-Propulsion System</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 19:43:15</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45931224"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45930659">
          <h3>
            <a class="item" href="https://github.com/Whamp/chirp"
              >Show HN: Chirp – Local Windows dictation with ParakeetV3 no
              executable required</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 19:07:45</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45930659"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <p>
                To scratch that itch, I built Chirp, a Windows dictation app
                that runs fully locally, uses NVIDIA’s ParakeetV3 model, and is
                managed end‑to‑end with `uv`. If you can run Python on your
                machine, you should be able to run Chirp—no additional
                executables required.
              </p>
              <p>
                Under the hood, Chirp uses the Parakeet TDT 0.6B v3 ONNX bundle.
                ParakeetV3 has accuracy in the same ballpark as Whisper‑large‑v3
                (multilingual WER ~4.9 vs ~5.0 in the open ASR leaderboard), but
                it’s much faster and happy on CPU.
              </p>
              <p>
                The flow is: - One‑time setup that downloads and prepares the
                ONNX model: - `uv run python -m chirp.setup` - A long‑running
                CLI process: - `uv run python -m chirp.main` - A global hotkey
                that starts/stops recording and injects text into the active
                window.
              </p>
              <p>A few details that might be interesting technically:</p>
              <p>
                - <i>Local‑only STT:</i> Everything runs on your machine using
                ONNX Runtime; by default it uses CPU providers, with optional
                GPU providers if your environment allows.
              </p>
              <p>
                - <i>Config‑driven behavior:</i> A `config.toml` file controls
                the global hotkey, model choice, quantization (`int8` option),
                language, ONNX providers, and threading. There’s also a simple
                `[word_overrides]` map so you can fix tokens that the model
                consistently mishears.
              </p>
              <p>
                - <i>Post‑processing pipeline:</i> After recognition, there’s an
                optional “style guide” step where you can specify prompts like
                “sentence case” or “prepend: &gt;&gt;” for the final text.
              </p>
              <p>
                - <i>No clipboard gymnastics required on Windows:</i> The app
                types directly into the focused window; there are options for
                clipboard‑based pasting and cleanup behavior for platforms where
                that makes more sense.
              </p>
              <p>
                - <i>Audio feedback:</i> Start/stop sounds (configurable) let
                you know when the mic is actually recording.
              </p>
              <p>
                So far I’ve mainly tested this on my own Windows machines with
                English dictation and CPU‑only setups. There are probably plenty
                of rough edges (different keyboard layouts, language settings,
                corporate IT policies, etc.), and I’d love feedback from people
                who:
              </p>
              <p>
                - Work in restricted corporate environments and need local
                dictation. - Have experience with Parakeet/Whisper or ONNX
                Runtime and see obvious ways to improve performance or
                robustness. - Want specific features (e.g., better
                multi‑language support, more advanced post‑processing, or
                integrations with their editor/IDE).
              </p>
              <p>
                Repo is here: `<a href="https://github.com/Whamp/chirp"
                  >https://github.com/Whamp/chirp</a
                >`
              </p>
              <p>If you try it, I’d be very interested in:</p>
              <p>
                - CPU usage and latency on your hardware, - How well it behaves
                with your keyboard layout and applications, - Any weird failure
                cases or usability annoyances you run into.
              </p>
              <p>
                Happy to answer questions and dig into technical details in the
                comments.
              </p>
            </div>
          </section>
        </section>
        <section id="45930598">
          <h3>
            <a
              class="item"
              href="https://www.claude.com/blog/structured-outputs-on-the-claude-developer-platform"
              >Structured Outputs on the Claude Developer Platform (API)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 19:04:23</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45930598"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45930284">
          <h3>
            <a
              class="item"
              href="https://www.jeffgeerling.com/blog/2025/minisforum-stuffs-entire-arm-homelab-ms-r1"
              >Minisforum Stuffs Entire Arm Homelab in the MS-R1</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 18:42:55</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45930284"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45930151">
          <h3>
            <a class="item" href="https://clocks.brianmoore.com/"
              >AI World Clocks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 18:35:22</span
              ><span class="points-container"
                >Points: <span class="points">449</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45930151"
                  >Comments</a
                ><span class="descendants">: 196</span></span
              >
            </h4>
            <div class="text">
              "Every minute, a new clock is rendered by nine different AI
              models."
            </div>
          </section>
        </section>
        <section id="45929921">
          <h3>
            <a
              class="item"
              href="https://hightouch.com/blog/uncovering-a-race-condition-in-aurora-rds"
              >A race condition in Aurora RDS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 18:20:08</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45929921"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45929511">
          <h3>
            <a
              class="item"
              href="https://reclaimthenet.org/the-disguised-return-of-the-eus-private-message-scanning-plot"
              >The disguised return of EU Chat Control</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 17:54:07</span
              ><span class="points-container"
                >Points: <span class="points">395</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45929511"
                  >Comments</a
                ><span class="descendants">: 189</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://www.patrick-breyer.de/en/chat-control-2-0-through-the-back-door-breyer-warns-the-eu-is-playing-us-for-fools-now-theyre-scanning-our-texts-and-banning-teens/"
                >https://www.patrick-breyer.de/en/chat-control-2-0-through-th...</a
              >
            </div>
          </section>
        </section>
        <section id="45929358">
          <h3>
            <a
              class="item"
              href="https://updates.techforpalestine.org/bitchat-for-gaza-messaging-without-internet/"
              >Bitchat for Gaza – messaging without internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 17:43:40</span
              ><span class="points-container"
                >Points: <span class="points">278</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45929358"
                  >Comments</a
                ><span class="descendants">: 140</span></span
              >
            </h4>
            <div class="text">
              <a href="https://bitchat.free/">https://bitchat.free/</a>
            </div>
          </section>
        </section>
        <section id="45929247">
          <h3>
            <a
              class="item"
              href="https://codeberg.org/forgejo/sustainability/pulls/137/files"
              >Meeting notes between Forgejo and the Dutch government via Git
              commits</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 17:35:17</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45929247"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45929052">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2025-11-13/germany-to-ban-huawei-from-future-6g-network-in-sovereignty-push"
              >Germany to ban Huawei from future 6G network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 17:19:08</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45929052"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45928709">
          <h3>
            <a
              class="item"
              href="https://news.northwestern.edu/stories/2025/11/manganese-is-lyme-diseases-double-edge-sword"
              >Manganese is Lyme disease's double-edge sword</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 16:51:03</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45928709"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45928620">
          <h3>
            <a class="item" href="https://caplocus.com/"
              >US Tech Market Treemap</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 16:42:12</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45928620"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45926469">
          <h3>
            <a
              class="item"
              href="https://www.tomwphillips.co.uk/2025/11/agi-fantasy-is-a-blocker-to-actual-engineering/"
              >AGI fantasy is a blocker to actual engineering</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 13:21:24</span
              ><span class="points-container"
                >Points: <span class="points">506</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45926469"
                  >Comments</a
                ><span class="descendants">: 496</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45926263">
          <h3>
            <a class="item" href="https://edeproject.org/"
              >EDE: Small and Fast Desktop Environment (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 12:51:23</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45926263"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45926224">
          <h3>
            <a class="item" href="https://github.com/mgreenwood1001/winamp"
              >Winamp clone in Swift for macOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 12:44:07</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45926224"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45926037">
          <h3>
            <a class="item" href="https://github.com/magit/magit/issues/5472"
              >Magit manuals are available online again</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 12:09:59</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45926037"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45923188">
          <h3>
            <a
              class="item"
              href="https://hazyresearch.stanford.edu/blog/2025-11-09-hk"
              >HipKittens: Fast and furious AMD kernels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-14 @ 02:27:20</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45923188"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45887262">
          <h3>
            <a
              class="item"
              href="https://generativehistory.substack.com/p/has-google-quietly-solved-two-of"
              >Has Google solved two of AI's oldest problems?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-11 @ 13:52:15</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45887262"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45885677">
          <h3>
            <a class="item" href="https://zadean.github.io/xqerl/"
              >Xqerl – Erlang XQuery 3.1 Processor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-11 @ 09:48:05</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45885677"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45876742">
          <h3>
            <a
              class="item"
              href="https://github.com/nathan-barry/tiny-diffusion"
              >Show HN: Tiny Diffusion – A character-level text diffusion model
              from scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-10 @ 15:13:55</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45876742"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <p>
                The model is a modified version of Nanochat's GPT implementation
                and is trained on Tiny Shakespeare!
              </p>
              <p>
                It is only 10.7 million parameters, so you can try it out
                locally.
              </p>
            </div>
          </section>
        </section>
        <section id="45875618">
          <h3>
            <a
              class="item"
              href="https://www.levs.fyi/blog/2-years-of-ml-vs-1-month-of-prompting/"
              >Honda: 2 years of ml vs 1 month of prompting - heres what we
              learned</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-10 @ 13:11:49</span
              ><span class="points-container"
                >Points: <span class="points">266</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45875618"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45866366">
          <h3>
            <a class="item" href="https://fi-le.net/margin/"
              >Operating Margins</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-09 @ 15:46:29</span
              ><span class="points-container"
                >Points: <span class="points">248</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45866366"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45857425">
          <h3>
            <a class="item" href="https://blog.apify.com/apify-origin-story/"
              >The accidental click that changed everything: the Apify origin
              story</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-08 @ 15:40:11</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45857425"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45821154">
          <h3>
            <a class="item" href="https://linuxcontainers.org/incus-os/"
              >Incus-OS: Immutable Linux OS to run Incus as a hypervisor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 09:39:58</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45821154"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45797689">
          <h3>
            <a class="item" href="https://maximullaris.com/awk_tech_notes.html"
              >Awk Technical Notes (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-03 @ 10:40:11</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45797689"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
