<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39649230">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/real-estate/angela-chao-death-texas-tesla-safety-c435daa0"
              >The Death of Angela Chao</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-09 @ 03:45:14</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39649230"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39648902">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2024/03/08/politics/top-us-cybersecurity-agency-cisa-hacked/index.html"
              >Top US cybersecurity agency hacked and forced to take some
              systems offline</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-09 @ 02:24:51</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39648902"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39648689">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2403.00801"
              >Building an Information Retrieval System with One Large Language
              Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-09 @ 01:46:43</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39648689"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39648259">
          <h3>
            <a
              class="item"
              href="https://github.com/wkaisertexas/ScreenTimeLapse"
              >Open-Source Screen Recorder</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-09 @ 00:45:07</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39648259"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39647681">
          <h3>
            <a
              class="item"
              href="https://thereader.mitpress.mit.edu/how-fear-of-regret-influences-our-decisions/"
              >A simple dice game shines a bit of light on the psychology of
              regret</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 23:13:45</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39647681"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39647331">
          <h3>
            <a
              class="item"
              href="https://news.mit.edu/2024/tests-show-high-temperature-superconducting-magnets-fusion-ready-0304"
              >Tests show high-temperature superconducting magnets are ready for
              fusion</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 22:35:01</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39647331"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39647164">
          <h3>
            <a class="item" href="https://unscrambler.dpw.me/"
              >Show HN: My AI writing assistant for Chinese</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 22:15:10</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39647164"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <p>
                Really, the fundamental benefit of the tool is that it
                encourages me to exercise the writing muscle, rather than
                defaulting to translating from English.
              </p>
              <p>
                My goal was to build something that is fast, relatively
                inexpensive, and not prone to misleading people. After some
                experimentation, I found that pairing GPT-3.5 with Microsoft
                machine translation works great! I'm using GPT-3.5 to generate
                an English version of the input, then Microsoft machine
                translation to translate the English version into Chinese. I've
                written a blog post about how I arrived at this approach:
                <a
                  href="https://maybecoding.bearblog.dev/my-attempt-at-an-ai-writing-assistant-for-chinese/"
                  >https://maybecoding.bearblog.dev/my-attempt-at-an-ai-writing...</a
                >
              </p>
              <p>
                The tool is pretty basic from a technical standpoint. There's a
                PHP backend that handles the API calls to OpenAI and Microsoft.
                The frontend is plain HTML with a bit of JS for interactivity -
                but the whole thing works fine without JS.
              </p>
              <p>
                Hopefully other folks find this useful too. I'm interested to
                know whether I could have approached this problem in a
                different/better way. Thanks!
              </p>
            </div>
          </section>
        </section>
        <section id="39647105">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/sam-altman-return-openais-board-information-reports-2024-03-08/"
              >OpenAI board reappoints Altman and adds three other directors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 22:07:19</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39647105"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39646749">
          <h3>
            <a
              class="item"
              href="https://lorenzofox.dev/posts/component-as-infinite-loop/"
              >Coroutines in JavaScript for web components</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 21:32:30</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39646749"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39646431">
          <h3>
            <a class="item" href="https://www.finleycms.com/careers/"
              >Finley (YC W21) is hiring capital markets technologists</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 21:01:03</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39643981">
          <h3>
            <a
              class="item"
              href="https://9to5mac.com/2024/03/08/epic-says-apple-will-reinstate-developer-account-clearing-path-for-epic-games-store-on-iphone/"
              >Epic says Apple will reinstate developer account</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 18:12:25</span
              ><span class="points-container"
                >Points: <span class="points">403</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39643981"
                  >Comments</a
                ><span class="descendants">: 473</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39643958">
          <h3>
            <a class="item" href="https://github.com/Mayuresh1611/Paper-Piano"
              >Piano on Paper</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 18:10:35</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39643958"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39643833">
          <h3>
            <a
              class="item"
              href="https://github.com/bruhbruhroblox/wallstreetlocal"
              >Show HN: Wallstreetlocal – View investments from America's
              biggest companies</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 18:02:26</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39643833"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
            <div class="text">
              <p>Heres the short pitch.</p>
              <p>
                The Securities and Exchange Commission (SEC) keeps record of
                every company in the United States. Companies whose holdings
                surpass $100 million though, are required to file a special type
                of form: the 13F form. This form, filed quarterly, discloses the
                filer's holdings, providing transparency into their investment
                activities and allowing the public and other market participants
                to monitor them.
              </p>
              <p>
                The problem though, is that these holdings are often cumbersome
                to access, and valuable analysis is often hidden behind a
                paywall. Through wallstreetlocal, the SEC's 13F filers become
                more accessible and open.
              </p>
              <p>
                By exploring the website (and the code), you can see the
                resources I used, check out some notable money managers I
                listed, and download any data that suits you. All for free.
                (Note, the mobile site likely needs work.)
              </p>
              <p>
                I made this project to better democratize SEC filings, and also
                to get some experience on my hands. I love computers, and one
                day hope to get involved with startups. In the comments, I'd
                appreciate any and all advice, as well as feedback on how to
                improve the site.
              </p>
            </div>
          </section>
        </section>
        <section id="39643136">
          <h3>
            <a class="item" href="https://github.com/hatchet-dev/hatchet"
              >Show HN: Hatchet – Open-source distributed task queue</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 17:07:35</span
              ><span class="points-container"
                >Points: <span class="points">372</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39643136"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
            <div class="text">
              <a href="https://hatchet.run">https://hatchet.run</a>), we're
              working on an open-source, distributed task queue. It's an
              alternative to tools like Celery for Python and BullMQ for
              Node.js, primarily focused on reliability and observability. It
              uses Postgres for the underlying queue.
              <p>
                Why build another managed queue? We wanted to build something
                with the benefits of full transactional enqueueing -
                particularly for dependent, DAG-style execution - and felt
                strongly that Postgres solves for 99.9% of queueing use-cases
                better than most alternatives (Celery uses Redis or RabbitMQ as
                a broker, BullMQ uses Redis). Since the introduction of SKIP
                LOCKED and the milestones of recent PG releases (like
                active-active replication), it's becoming more feasible to
                horizontally scale Postgres across multiple regions and
                vertically scale to 10k TPS or more. Many queues (like BullMQ)
                are built on Redis and data loss can occur when suffering OOM if
                you're not careful, and using PG helps avoid an entire class of
                problems.
              </p>
              <p>
                We also wanted something that was significantly easier to use
                and debug for application developers. A lot of times the burden
                of building task observability falls on the infra/platform team
                (for example, asking the infra team to build a Grafana view for
                their tasks based on exported prom metrics). We're building this
                type of observability directly into Hatchet.
              </p>
              <p>
                What do we mean by "distributed"? You can run workers (the
                instances which run tasks) across multiple VMs, clusters and
                regions - they are remotely invoked via a long-lived gRPC
                connection with the Hatchet queue. We've attempted to optimize
                our latency to get our task start times down to 25-50ms and much
                more optimization is on the roadmap.
              </p>
              <p>
                We also support a number of extra features that you'd expect,
                like retries, timeouts, cron schedules, dependent tasks. A few
                things we're currently working on - we use RabbitMQ (confusing,
                yes) for pub/sub between engine components and would prefer to
                just use Postgres, but didn't want to spend additional time on
                the exchange logic until we built a stable underlying queue. We
                are also considering the use of NATS for engine-engine and
                engine-worker connections.
              </p>
              <p>
                We'd greatly appreciate any feedback you have and hope you get
                the chance to try out Hatchet.
              </p>
            </div>
          </section>
        </section>
        <section id="39642920">
          <h3>
            <a
              class="item"
              href="https://www.politico.com/news/magazine/2024/03/08/the-uk-college-student-explaining-congressional-procedure-to-washington-00145314"
              >A UK college student explaining congressional procedure to
              Washington</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 16:49:37</span
              ><span class="points-container"
                >Points: <span class="points">246</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39642920"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39642612">
          <h3>
            <a
              class="item"
              href="https://www.thenation.com/article/culture/marshall-sahlins-new-science-enchanted-universe/"
              >Metaperson: The enchanted worlds of Marshall Sahlins</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 16:24:18</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39642612"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39642390">
          <h3>
            <a
              class="item"
              href="https://s3-eu-west-1.amazonaws.com/makapufprojects/oie/doc.html"
              >Show HN: A talking board game in a 2k program and 128 bytes of
              RAM</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 16:07:29</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39642390"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39642135">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-00716-2"
              >Superconductivity scandal: the story of deception in a physics
              lab</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 15:46:34</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39642135"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39641105">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39641105"
              >Launch HN: Relari (YC W24) – Identify the root cause of problems
              in LLM apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 14:00:09</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39641105"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/relari-ai/continuous-eval"
                >https://github.com/relari-ai/continuous-eval</a
              >), an evaluation framework that lets you test your GenAI systems
              at the component level, pinpointing issues where they originate.
              <p>
                We experienced the need for this when we were building a copilot
                for bankers. Our RAG pipeline blew up in complexity as we added
                components: a query classifier (to triage user intent), multiple
                retrievers (to grab information from different sources),
                filtering LLM (to rerank / compress context), a calculator agent
                (to call financial functions) and finally the synthesizer LLM
                that gives the answer. Ensuring reliability became more
                difficult with each of these we added.
              </p>
              <p>
                When a bad response was detected by our answer evaluator, we had
                to backtrack multiple steps to understand which component(s)
                made a mistake. But this quickly became unscalable beyond a few
                samples.
              </p>
              <p>
                I did my Ph.D. in fault detection for autonomous vehicles, and I
                see a strong parallel between the complexity of autonomous
                driving software and today's LLM pipelines. In self-driving
                systems, sensors, perception, prediction, planning, and control
                modules are all chained together. To ensure system-level safety,
                we use granular metrics to measure the performance of each
                module individually. When the vehicle makes an unexpected
                decision, we use these metrics to pinpoint the problem to a
                specific component. Only then we can make targeted improvements,
                systematically.
              </p>
              <p>
                Based on this thinking, we developed the first version of
                continuous-eval for ourselves. Since then we’ve made it more
                flexible to fit various types of GenAI pipelines.
                Continuous-eval allows you to describe (programmatically) your
                pipeline and modules, and select metrics for each module. We
                developed 30+ metrics to cover retrieval, text generation, code
                generation, classification, agent tool use, etc. We now have a
                number of companies using us to test complex pipelines like
                finance copilots, enterprise search, coding agents, etc.
              </p>
              <p>
                As an example, one customer was trying to understand why their
                RAG system did poorly on trend analysis queries. Through
                continuous-eval, they realized that the “retriever” component
                was retrieving 80%+ of all relevant chunks, but the “reranker”
                component, that filters out “irrelevant” context, was dropping
                that to below 50%. This enabled them to fix the problem, in
                their case by skipping the reranker for certain queries.
              </p>
              <p>
                We’ve also built ensemble metrics that do a surprisingly good
                job of predicting user feedback. Users often rate LLM-generated
                answers by giving a thumbs up/down about how good the answer
                was. We train our custom metrics on this user data, and then use
                those metrics to generate thumbs up/down ratings on future LLM
                answers. The results turn out to be 90% aligned with what the
                users say. This gives developers a feedback loop from production
                data to offline testing and development. Some customers have
                found this to be our most unique advantage.
              </p>
              <p>
                Lastly, to make the most out of evaluation, you should use a
                diverse dataset—ideally with ground truth labels for
                comprehensive and consistent assessment. Because ground truth
                labels are costly and time-consuming to curate manually, we also
                have a synthetic data generation pipeline that allows you to get
                started quickly. Try it here (<a
                  href="https://www.relari.ai/#synthetic_data_demo"
                  >https://www.relari.ai/#synthetic_data_demo</a
                >)
              </p>
              <p>
                What’s been your experience testing and iterating LLM apps?
                Please let us know your thoughts and feedback on our approaches
                (modular framework, leveraging user feedback, testing with
                synthetic data).
              </p>
            </div>
          </section>
        </section>
        <section id="39640992">
          <h3>
            <a
              class="item"
              href="https://linuxblog.io/home-lab-beginners-guide-hardware/"
              >Home Lab Beginners guide</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 13:47:13</span
              ><span class="points-container"
                >Points: <span class="points">518</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39640992"
                  >Comments</a
                ><span class="descendants">: 334</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39639427">
          <h3>
            <a
              class="item"
              href="https://saagarjha.com/blog/2024/02/27/making-friends-with-attributegraph/"
              >Making Friends with AttributeGraph</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-08 @ 09:29:10</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39639427"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39635483">
          <h3>
            <a
              class="item"
              href="https://www.answer.ai/posts/2024-03-06-fsdp-qlora.html"
              >Fine tune a 70B language model at home</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-07 @ 22:38:49</span
              ><span class="points-container"
                >Points: <span class="points">730</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39635483"
                  >Comments</a
                ><span class="descendants">: 178</span></span
              >
            </h4>
            <div class="text">
              <p>
                It's the #1 most requested thing I've been hearing from open
                source model builders: the ability to use multiple GPUs with
                QLoRA training. So that's why we decided to make it our first
                project.
              </p>
              <p>
                Huge thanks to Tim Dettmers for helping us get started to this
                -- and of course for creating QLoRA in the first place!
              </p>
              <p>Let me know if you have any questions or thoughts.</p>
            </div>
          </section>
        </section>
        <section id="39626867">
          <h3>
            <a
              class="item"
              href="https://mattsills.github.io/2024/03/02/rabin-karp/"
              >Optimizating Rabin-Karp Hashing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-07 @ 09:12:26</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39626867"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39626798">
          <h3>
            <a
              class="item"
              href="https://stevana.github.io/towards_zero-downtime_upgrades_of_stateful_systems.html"
              >Towards zero-downtime upgrades of stateful systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-07 @ 09:03:01</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39626798"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39626657">
          <h3>
            <a class="item" href="https://v21.io/blog/downpour"
              >Downpour is the game creation tool I have been working on for the
              past few years</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-07 @ 08:43:06</span
              ><span class="points-container"
                >Points: <span class="points">236</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39626657"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39624813">
          <h3>
            <a
              class="item"
              href="https://phillipreeve.net/blog/working-with-tilt-shift-lenses/"
              >Working with Tilt/Shift Lenses (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-07 @ 03:37:33</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39624813"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39615643">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2021/06/21/the-deep-sea-is-filled-with-treasure-but-it-comes-at-a-price"
              >The Deep Sea Is Filled with Treasure, but It Comes at a Price</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-06 @ 13:18:50</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39615643"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39615228">
          <h3>
            <a
              class="item"
              href="https://github.com/mighty-gerbils/gerbil-persist/blob/master/persist.md"
              >Orthogonal Persistence</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-06 @ 12:33:28</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39615228"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39615068">
          <h3>
            <a class="item" href="http://antirez.com/news/143"
              >Playing audio files in a Pi Pico without a DAC</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-06 @ 12:12:50</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39615068"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39613767">
          <h3>
            <a
              class="item"
              href="https://www.dolthub.com/blog/2024-03-03-prolly-trees/"
              >Prolly Trees</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-06 @ 08:50:39</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39613767"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
