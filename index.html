<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43145982">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=bZxw-Ji7K94"
              >Stingray Fish Delousing Underwater Laser in Action (2018)
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 02:58:43</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43145982"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43145527">
          <h3>
            <a class="item" href="https://andykong.org/blog/cgmteardown1"
              >Electronics Teardown: Stelo 2-Week Continuous Glucose Monitor
              (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 01:58:18</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43145527"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43145483">
          <h3>
            <a
              class="item"
              href="https://www.wesa.fm/health-science-tech/2025-02-21/university-pittsburgh-phd-pause-research-funding-uncertainty"
              >U Pittsburgh pauses all PhD admissions amid DOGE funding cuts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 01:53:33</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43145483"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43145179">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/67a4c030-a7f6-47af-bab0-a998f0a09506"
              >Meta slashes staff stock awards as group embarks on AI spending
              drive</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 01:12:43</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43145179"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43145106">
          <h3>
            <a
              class="item"
              href="https://www.cambus.net/clang-static-analyzer-and-the-z3-constraint-solver/"
              >Clang Static Analyzer and the Z3 constraint solver</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 01:03:04</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43145106"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43145057">
          <h3>
            <a class="item" href="https://playbook.usds.gov/"
              >Digital Services Playbook</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 00:54:58</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43145057"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43144940">
          <h3>
            <a
              class="item"
              href="https://www.thedp.com/article/2025/02/penn-graduate-student-class-size-cut-trump-funding"
              >Penn to reduce graduate admissions, rescind acceptances amid
              research cuts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 00:37:57</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43144940"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43144895">
          <h3>
            <a
              class="item"
              href="https://seclists.org/fulldisclosure/2025/Feb/15"
              >Python's official documentation contains textbook example of
              insecure code (XSS)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 00:30:00</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43144895"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43144611">
          <h3>
            <a
              class="item"
              href="https://www.mooreds.com/wordpress/archives/3518"
              >Ask for no, don't ask for yes (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 23:55:57</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43144611"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43144040">
          <h3>
            <a class="item" href="https://vine.dev/"
              >Vine: A programming language based on Interaction Nets</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 22:43:36</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43144040"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43143777">
          <h3>
            <a class="item" href="https://www.openbsd.org/innovations.html"
              >OpenBSD Innovations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 22:08:42</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43143777"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43143097">
          <h3>
            <a class="item" href="https://kaneo.app/"
              >Kaneo – An open source project management platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 20:52:01</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43143097"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43142989">
          <h3>
            <a
              class="item"
              href="https://www.chrbutler.com/in-defense-of-text-labels"
              >In Defense of Text Labels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 20:40:26</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43142989"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43141993">
          <h3>
            <a
              class="item"
              href="https://www.abortretry.fail/p/the-birth-of-chipzilla"
              >The Birth of Chipzilla</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 19:04:01</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43141993"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43141966">
          <h3>
            <a
              class="item"
              href="https://www.google.com/maps/d/viewer?mid=1RNaaTlz7U2FgjlvFARZQWHsMeWsTc2S1&amp;hl=en"
              >A map of torii around the world</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 19:01:41</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43141966"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43141825">
          <h3>
            <a
              class="item"
              href="https://blog.the-ebook-reader.com/2025/02/22/amazon-now-openly-discloses-youre-buying-a-license-to-view-kindle-ebooks/"
              >Amazon now discloses you're buying a license to view Kindle
              eBooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 18:50:06</span
              ><span class="points-container"
                >Points: <span class="points">319</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43141825"
                  >Comments</a
                ><span class="descendants">: 202</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43140645">
          <h3>
            <a class="item" href="https://exult.sourceforge.io/index.php"
              >Exult: Recreating Ultima VII for modern operating systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 16:56:09</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43140645"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43140614">
          <h3>
            <a
              class="item"
              href="https://github.com/FFmpeg/asm-lessons/blob/main/lesson_01/index.md"
              >FFmpeg School of Assembly Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 16:52:49</span
              ><span class="points-container"
                >Points: <span class="points">572</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43140614"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43140547">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/how-were-recovering-priceless-audio-and-lost-languages-from-old-decaying-tapes-248116"
              >Recovering priceless audio and lost languages from old decaying
              tapes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 16:45:45</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43140547"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43139953">
          <h3>
            <a class="item" href="https://indieblog.page"
              >Discover the IndieWeb, one blog post at a time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 15:42:40</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43139953"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43138238">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/02/21/upshot/doge-musk-trump-errors.html"
              >DOGE's only public ledger is riddled with mistakes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 12:03:22</span
              ><span class="points-container"
                >Points: <span class="points">613</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43138238"
                  >Comments</a
                ><span class="descendants">: 807</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43137488">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/money/2025/feb/22/the-tyranny-of-apps-those-without-smartphones-are-unfairly-penalised-say-campaigners"
              >'The tyranny of apps': those without smartphones are unfairly
              penalised</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 09:18:47</span
              ><span class="points-container"
                >Points: <span class="points">584</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43137488"
                  >Comments</a
                ><span class="descendants">: 613</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43135934">
          <h3>
            <a
              class="item"
              href="https://www.digikey.com/en/resources/tariff-resources"
              >DigiKey's Tariff Resources</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 03:52:56</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43135934"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43111294">
          <h3>
            <a
              class="item"
              href="https://benjaminwootton.com/insights/clickhouse-peerdb-cdc/"
              >Reliably Replicating Data Between PostgreSQL and ClickHouse</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-20 @ 04:59:17</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43111294"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43106245">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/health/archive/2015/07/split-brain-research-sperry-gazzaniga/399290/"
              >One Head, Two Brains: The origins of split-brain research
              (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 19:22:01</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43106245"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43100260">
          <h3>
            <a class="item" href="https://0.space/about"
              >Show HN: AI-native browser game that users can craft unlimited 3D
              items</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 09:24:02</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43100260"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                That’s why we are building space zero—a browser based 3D world
                powered by AI. We plan to build players can freely mix items to
                generate unexpected creations with unique properties and sounds.
                Also the world itself is dynamically generated, evolving
                endlessly.
              </p>
              <p>
                I uploaded a demo version I’ve been working on for the past
                month! I hope to get any feedbacks or comments :)
              </p>
            </div>
          </section>
        </section>
        <section id="43099894">
          <h3>
            <a class="item" href="https://github.com/nst/PSTris"
              >Tetris in PostScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 08:27:50</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43099894"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43099233">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/df26fc4c-5488-4994-b2b8-be4bfbda2724"
              >Meta’s brave new horizons</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 06:34:35</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43099233"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43097799">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/1561_celestial_phenomenon_over_Nuremberg"
              >1561 Celestial Phenomenon over Nuremberg</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-19 @ 02:16:04</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43097799"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43089415">
          <h3>
            <a
              class="item"
              href="https://lisp-journey.gitlab.io/blog/these-years-in-common-lisp-2023-2024-in-review/"
              >These years in Common Lisp: 2023-2024 in review</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-18 @ 13:48:25</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43089415"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
