<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39913946">
          <h3>
            <a
              class="item"
              href="https://www.patrick-breyer.de/en/full-chat-control-proposal-leaked-attack-on-digital-privacy-of-correspondence-and-secure-encryption/"
              >Full EU chat control proposal attack on digital privacy and
              encryption</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-03 @ 05:35:47</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39913946"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39913807">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2404.01744"
              >Octopus v2: On-device language model for super agent</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-03 @ 05:12:12</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39913807"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39913505">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/3m-floppy"
              >The Rise and Fall of 3M's Floppy Disk</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-03 @ 04:05:10</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39913505"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39912854">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/intel-discloses-financials-foundry-business-2024-04-02/"
              >Intel discloses $7B operating loss for chip-making unit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-03 @ 01:56:34</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39912854"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39912771">
          <h3>
            <a class="item" href="https://almy.us/softwaredeath.html"
              >The Threat of Discontinued Software (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-03 @ 01:42:31</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39912771"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39912330">
          <h3>
            <a
              class="item"
              href="https://earthquake.usgs.gov/earthquakes/map/?extent=16.34123,-246.42334&amp;extent=28.51697,-223.43994"
              >7.4 earthquake in Taiwan, 34km depth</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-03 @ 00:24:56</span
              ><span class="points-container"
                >Points: <span class="points">379</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39912330"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39911961">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2403.20329"
              >ReALM: Reference Resolution as Language Modeling</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 23:26:37</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39911961"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39911155">
          <h3>
            <a
              class="item"
              href="https://www.typebarmagazine.com/2024/03/24/science-fiction-and-the-death-of-the-sun/"
              >Science fiction and the death of the sun</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 21:39:49</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39911155"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39910806">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/roe-ai/jobs/NZDmSo9-founding-engineer"
              >Roe AI (YC W24) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 21:00:55</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39910383">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2024/04/08/the-brazilian-special-forces-unit-fighting-to-save-the-amazon"
              >A Brazilian special-forces unit fighting to save the Amazon</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 20:14:14</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39910383"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39910119">
          <h3>
            <a class="item" href="https://afterthebeep.tel/"
              >Anonymous public voicemail inbox</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 19:49:14</span
              ><span class="points-container"
                >Points: <span class="points">272</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39910119"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39909123">
          <h3>
            <a class="item" href="https://github.com/achristmascarl/three_body"
              >A rudimentary simulation of the three-body problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 18:23:35</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39909123"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39908891">
          <h3>
            <a
              class="item"
              href="https://alt-romes.github.io/posts/2024-04-02-calling-haskell-from-swift.html"
              >Calling Haskell from Swift</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 18:05:41</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39908891"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39908798">
          <h3>
            <a
              class="item"
              href="https://news.utexas.edu/2024/04/01/move-more-sleep-better-ut-study-finds/"
              >Study uses wearables to show that physical activity lengthens REM
              latency</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 17:58:28</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39908798"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39908660">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Artificio_de_Juanelo"
              >Artificio de Juanelo</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 17:47:25</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39908660"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39908629">
          <h3>
            <a class="item" href="http://www.xn--plankalkl-x9a.de"
              >Konrad Zuse (1994)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 17:44:22</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39908629"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39908579">
          <h3>
            <a
              class="item"
              href="https://gizmodo.com/amazon-reportedly-ditches-just-walk-out-grocery-stores-1851381116"
              >Amazon ditches 'just walk out' checkouts at its grocery stores</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 17:39:36</span
              ><span class="points-container"
                >Points: <span class="points">387</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39908579"
                  >Comments</a
                ><span class="descendants">: 523</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39908561">
          <h3>
            <a
              class="item"
              href="https://grantland.com/features/bass-fishing-cheaters/"
              >Competitive Bass Fishing Cheaters (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 17:37:34</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39908561"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39908146">
          <h3>
            <a class="item" href="https://kcall.co.uk/ssd/index.html"
              >Everything I know about SSDs (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 17:06:25</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39908146"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39907876">
          <h3>
            <a class="item" href="https://dekuliutesla.github.io/citygs/"
              >CityGaussian: Real-time high-quality large-scale scene rendering
              with Gaussians</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 16:46:32</span
              ><span class="points-container"
                >Points: <span class="points">382</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39907876"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39907845">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39907845"
              >3D + 2D: Testing out my cross-platform WASM graphics engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 16:44:32</span
              ><span class="points-container"
                >Points: <span class="points">356</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39907845"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
            <div class="text">
              <p>
                The graphics stack continues to be one of the biggest
                bottlenecks in portability. One day I realized that WebAssembly
                (Wasm) actually held the solution to the madness. It’s runnable
                anywhere, embeddable into anything, and performant enough for
                real-time graphics. So I quit my job and dove into the adventure
                of creating a portable, embeddable WASM-based graphics framework
                from the ground up: high-level enough for app developers to
                easily make whatever graphics they want, and low-level enough to
                take full advantage of the GPU and everything else needed for a
                high-performance application.
              </p>
              <p>
                I call it Renderlet to emphasize the embeddable aspect — you can
                make self-contained graphics modules that do just what you want,
                connect them together, and make them run <i>on</i> anything or
                <i>in</i> anything with trivial interop.
              </p>
              <p>
                If you think of how Unity made it easy for devs to build
                cross-platform games, the idea is to do the same thing for all
                visual applications.
              </p>
              <p>
                Somewhere along the way I got into YC as a solo founder (!) but
                mostly I’ve been heads-down building this thing for the last 6
                months. It’s not <i>quite</i> ready for an open alpha release,
                but it’s close—close enough that I’m ready to write about it,
                show it off, and start getting feedback. This is the thing I
                dreamed of as an application developer, and I want to know what
                you think!
              </p>
              <p>
                When Rive open-sourced their 2D vector engine and made a splash
                on HN a couple weeks ago (<a
                  href="https://news.ycombinator.com/item?id=39766893"
                  >https://news.ycombinator.com/item?id=39766893</a
                >), I was intrigued. Rive’s renderer is built as a higher-level
                2D API similar to SVG, whereas the Wander renderer (the
                open-source runtime part of Renderlet) exposes a lower-level 3D
                API over the GPU. Could Renderlet use its GPU backend to run the
                Rive Renderer library, enabling any 3D app to have a 2D vector
                backend? Yes it can - I implemented it!
              </p>
              <p>
                You can see it working here:
                <a href="https://vimeo.com/929416955"
                  >https://vimeo.com/929416955</a
                >
                and there’s a deep technical dive here:
                <a
                  href="https://github.com/renderlet/wander/wiki/Using-renderlet-with-rive%E2%80%90renderer"
                  >https://github.com/renderlet/wander/wiki/Using-renderlet-wit...</a
                >. The code for my runtime Wasm Renderer (a.k.a. Wander) is
                here:
                <a href="https://github.com/renderlet/wander"
                  >https://github.com/renderlet/wander</a
                >.
              </p>
              <p>
                I’ll come back and do a proper Show HN or Launch HN when the
                compiler is ready for anyone to use and I have the integration
                working on all platforms, but I hope this is interesting enough
                to take a look at now. I want to hear what you think of this!
              </p>
            </div>
          </section>
        </section>
        <section id="39907468">
          <h3>
            <a class="item" href="https://github.com/princeton-nlp/SWE-agent"
              >Princeton group open sources "SWE-agent", with 12% fix rate for
              GitHub issues</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 16:16:07</span
              ><span class="points-container"
                >Points: <span class="points">253</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39907468"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39907073">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39907073"
              >Launch HN: Creo (YC W24) – Build internal tools with NextJS and
              AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 15:43:56</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39907073"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
            <div class="text">
              <a href="https://trycreo.com/">https://trycreo.com/</a>). Creo
              lets you make internal tools with NextJS. We’re code-first because
              we think engineers prefer being in their IDE (especially today,
              with all the advancements in dev-tools) when building out internal
              tooling for their company.
              <p>
                Here’s a demo of writing code and then deploying your tools:
                <a href="https://www.youtube.com/watch?v=GDTk1SmtpXw"
                  >https://www.youtube.com/watch?v=GDTk1SmtpXw</a
                >
                And here’s one on how to get started with the CLI:
                <a href="https://www.youtube.com/watch?v=JyyyRv2TJy0"
                  >https://www.youtube.com/watch?v=JyyyRv2TJy0</a
                >.
              </p>
              <p>
                A lot of internal tool builders (eg: Retool and Tooljet) are
                low-code, meaning you’re given a WYSIWYG drag-and-drop UI where
                you can drag components onto a canvas, and then wire them up to
                a data source or endpoint using a form/code-block. This has the
                advantage of being accessible to non-programmers, who are often
                the people needing and using the tools. What we’ve repeatedly
                seen, however, is that while these solutions <i>begin</i> with a
                PM (or similar) creating the initial tool, they soon bring in an
                engineer to e.g. wire it up to a data source or an endpoint. But
                engineers dislike dealing with this drag-and-drop stuff—it would
                be so much easier for them just to do it in code. So these
                products become stuck somewhere between code and no-code.
              </p>
              <p>
                We experienced many such problems building internal tools at
                companies we’ve worked at in the past. We tried the
                aforementioned low-code builders and found the tools hard to
                maintain as they became more complex. We wanted to write the
                JavaScript we’re comfortable with, but it was always hard
                picking the libraries/dependencies to get started. We never
                found a good, opinionated set of abstractions to build internal
                tools quickly.
              </p>
              <p>
                Our solution is simple: you use our CLI to clone our
                NextJS14-based starter and run it on port 8891, where you write
                the React/JS you’re comfortable with. All you have to do is
                worry about the app/tools folder, where you can create new
                directories for the tools you need to create. Everything else is
                configuration files. Once you push your project to a GitHub
                repo, you can connect that repo to our platform on our
                deployments page. We also have a component library (built on top
                of Shadcn), that will save you time, especially with things like
                data tables, forms and charts.
              </p>
              <p>
                The tools will then show up on your dashboard and be usable in
                about 1-2 minutes. The rest of the platform has all the other
                features you will need, such as being able to add team members
                to your organization, configuring permissions, keyboard
                shortcuts, authentication and more.
              </p>
              <p>
                The real value, in our opinion, is that you will never have to
                do authentication, manage team permissions, and worry about
                components. Because it’s code-first, it also becomes dead easy
                to coordinate with your team via source control, and take
                advantage of tools like GitHub Copilot to write repetitive code
                fast. Our current pricing is free to get started as an
                individual, and subscription based pricing for teams (Currently
                $30/mo up to 5 users, later seat-based subscriptions).
              </p>
              <p>
                You can try Creo today by heading to
                <a href="https://trycreo.com/">https://trycreo.com/</a>, or get
                started without signing up by looking at our docs (<a
                  href="https://docs.trycreo.com"
                  >https://docs.trycreo.com</a
                >).
              </p>
              <p>We’d love to hear your feedback.</p>
              <p>
                Edit: We also have an AI offering that is live today. You can
                grab an API key from our web app, add it to your .env locally
                and ask it to generate the tool you have in mind! (The YouTube
                video shows you how you can do this)
              </p>
            </div>
          </section>
        </section>
        <section id="39906887">
          <h3>
            <a class="item" href="https://abhipray.com/posts/flying_toasters/"
              >Recreating the Flying Toasters screen saver for the Vision Pro</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 15:31:08</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39906887"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39903738">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Los_Alamos_chess"
              >Los Alamos Chess</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 09:15:35</span
              ><span class="points-container"
                >Points: <span class="points">218</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39903738"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39903685">
          <h3>
            <a class="item" href="https://research.swtch.com/xz-script"
              >The xz attack shell script</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 09:05:04</span
              ><span class="points-container"
                >Points: <span class="points">350</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39903685"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39902854">
          <h3>
            <a
              class="item"
              href="https://longform.asmartbear.com/avoid-blundering/"
              >Avoid blundering: 80% of a winning strategy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 06:13:23</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39902854"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39902212">
          <h3>
            <a
              class="item"
              href="https://www.usatoday.com/story/news/nation/2024/03/25/bradford-pear-trees-smell-invasive-species-banned/73040722007/"
              >Bradford pear trees banned in few states – More are looking to
              eradicate them</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 03:51:51</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39902212"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39902207">
          <h3>
            <a
              class="item"
              href="https://shkspr.mobi/blog/2024/03/receive-push-notifications-from-your-rice-cooker/"
              >Receive push notifications from your rice cooker</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-02 @ 03:50:58</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39902207"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39889558">
          <h3>
            <a
              class="item"
              href="https://www.schneier.com/blog/archives/2024/03/ross-anderson.html"
              >Ross Anderson</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-01 @ 00:22:51</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39889558"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
