<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38591740">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/tyrannosaurs-stomach-contents-have-been-found-for-the-first-time/"
              >Tyrannosaur's Stomach Contents Have Been Found</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 14:33:08</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38591740"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38591726">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/12/07/is-the-texas-boom-town-of-austin-losing-its-luster/"
              >Is the Texas boom town of Austin losing its luster?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 14:31:28</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38591726"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38591677">
          <h3>
            <a
              class="item"
              href="https://www.fastcompany.com/90995354/croatia-could-be-europes-hidden-tech-haven-in-2024"
              >Croatia could be Europe's hidden tech haven in 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 14:21:44</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38591677"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38591662">
          <h3>
            <a class="item" href="http://t3x.org/t3x/0/book.html"
              >Write your own retro compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 14:18:25</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38591662"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38591584">
          <h3>
            <a
              class="item"
              href="https://eshelyaron.com/posts/2023-12-10-bad-news.html"
              >Bad news, Emacs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 14:07:13</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38591584"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38591437">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38591437"
              >Ask HN: Best UI design courses for hackers?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 13:37:43</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38591437"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>
                What have been some of the best UI design courses, in your
                experience?
              </p>
              <p>
                I'm aware of avant garde works such as Bret Victor's "Magic Ink"
                and love it.
              </p>
              <p>
                At the same time, I'd also love to learn more about more "down
                to earth" tutorials/examples/exercises/courses to build
                practical UI skills. Something above "react tutorials", but
                something below Victor's "Magic Ink"
              </p>
              <p>
                Big plus point if there is a coherent set of principles/system
                propounded, to make it easy to apply in our specific context.
              </p>
            </div>
          </section>
        </section>
        <section id="38591080">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38591080"
              >Ask HN: How to inform YouTube a video is no longer under
              copyright?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 12:27:42</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38591080"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.youtube.com/watch?v=IADZtE2-Aws"
                >https://www.youtube.com/watch?v=IADZtE2-Aws</a
              >
              into my youtube account, famous tracking shot from Wings 1927, and
              at the copyright determination step Youtube told me it was under
              copyright but the owner allows it to be shown on Youtube.
              <p>Which is incorrect - it entered public domain in 2023.</p>
              <p>
                Makes me wonder if there is some metadata in this file that is
                newer than the film and that is what is copyrighted, or is it
                that the copyright was claimed on years past and Youtube
                neglected to check when that claim was going to run out?
              </p>
              <p>How does one let them know that the copyright has run out?</p>
            </div>
          </section>
        </section>
        <section id="38590984">
          <h3>
            <a class="item" href="https://github.com/ast-grep/ast-grep"
              >AST-grep(sg) is a CLI tool for code structural search, lint, and
              rewriting</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 12:03:18</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38590984"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38590975">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/lago/jobs/RvvzKuM-sr-back-end-ruby-engineer"
              >Lago (Open-Source Stripe Billing) Is Hiring Back-End Ruby
              Engineers in EU</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 12:01:01</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38590827">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/security/2023/12/stealthy-linux-rootkit-found-in-the-wild-after-going-undetected-for-2-years/"
              >Stealthy Linux rootkit found in the wild after going undetected
              for 2 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 11:26:44</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38590827"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38590164">
          <h3>
            <a
              class="item"
              href="https://www.masteringemacs.org/article/fuzzy-finding-emacs-instead-of-fzf"
              >Fuzzy Finding with Emacs Instead of Fzf</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 08:47:56</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38590164"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38590144">
          <h3>
            <a class="item" href="https://cblgh.org/trustnet/"
              >Trust-Based Moderation Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 08:43:59</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38590144"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38590028">
          <h3>
            <a
              class="item"
              href="https://www.electrifying.com/blog/best-cars/innovation-of-the-year-byd-blade-battery"
              >Innovation of the Year: BYD Blade Battery</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 08:17:05</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38590028"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38589981">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2309.00381"
              >Is RISC-V ready for HPC? Evaluating the 64-core Sophon SG2042
              RISC-V CPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 08:06:22</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38589981"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38589389">
          <h3>
            <a
              class="item"
              href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1057843"
              >Linux: Ext4 data corruption in 6.1.64-1</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 05:33:19</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38589389"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38589144">
          <h3>
            <a
              class="item"
              href="https://msopenspecs.azureedge.net/files/MS-VBAL/%5bMS-VBAL%5d.pdf"
              >Visual Basic for Applications Language Specification [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 04:43:51</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38589144"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38588858">
          <h3>
            <a class="item" href="https://trippy.cli.rs/"
              >Trippy â€“ A Network Diagnostic Tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 03:46:43</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38588858"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38588790">
          <h3><a class="item" href="https://www.waveterm.dev/">Waveterm</a></h3>
          <section>
            <h4>
              <span>2023-12-10 @ 03:33:48</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38588790"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38588379">
          <h3>
            <a class="item" href="https://tmpout.sh/3/22.html"
              >Cramming a tiny program into a tiny ELF file</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-10 @ 02:12:27</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38588379"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38586773">
          <h3>
            <a
              class="item"
              href="https://admiralcloudberg.medium.com/a-matter-of-millimeters-the-story-of-qantas-flight-32-bdaa62dc98e7"
              >A Matter of Millimeters: The story of Qantas flight 32</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-09 @ 22:30:35</span
              ><span class="points-container"
                >Points: <span class="points">494</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38586773"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38586767">
          <h3>
            <a class="item" href="https://github.com/chriskiehl/Gooey"
              >Gooey: Turn almost any Python command line program into a full
              GUI application</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-09 @ 22:30:02</span
              ><span class="points-container"
                >Points: <span class="points">631</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38586767"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38580013">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/what-is-time-a-history-of-physics-biology-clocks-and-culture-20200504/"
              >Arrows of Time</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-09 @ 08:53:29</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38580013"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38576158">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/essay/anna-atkins-cyanotypes/"
              >Rhapsodies in Blue: Anna Atkins' Cyanotypes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-08 @ 23:22:33</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38576158"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38567107">
          <h3>
            <a
              class="item"
              href="https://www.opslevel.com/resources/optimizing-engineering-communication-for-better-developer-experience"
              >Optimizing engineering communication for better developer
              experience</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-08 @ 09:43:32</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38567107"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38565380">
          <h3>
            <a class="item" href="https://tomasp.net/blog/2023/pompidou/"
              >Routers at Centre Pompidou and software evolution</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-08 @ 04:16:30</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38565380"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38562858">
          <h3>
            <a
              class="item"
              href="https://mjtsai.com/blog/2023/12/07/fastspring-risk-screening/"
              >FastSpring Risk Screening</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-07 @ 22:47:45</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38562858"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38558564">
          <h3>
            <a
              class="item"
              href="https://claytonwramsey.github.io/blog/learned-from-teaching.html"
              >Things I learned from teaching</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-07 @ 16:45:38</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38558564"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38554691">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/blog/audiobox-generating-audio-voice-natural-language-prompts/"
              >Audiobox: Meta's new foundation research model for audio
              generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-07 @ 09:57:48</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38554691"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38553743">
          <h3>
            <a class="item" href="https://www.bbc.com/news/technology-67635851"
              >Sony debuts first PS5 controller for disabled gamers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-07 @ 07:16:05</span
              ><span class="points-container"
                >Points: <span class="points">278</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38553743"
                  >Comments</a
                ><span class="descendants">: 141</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38551512">
          <h3>
            <a
              class="item"
              href="https://rednafi.com/zephyr/diminishing_half_life_of_knowledge/"
              >The diminishing half-life of knowledge</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-07 @ 00:49:01</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38551512"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
