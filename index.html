<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41764670">
          <h3>
            <a
              class="item"
              href="https://fortune.com/2024/10/03/bytedance-tiktok-bytespider-scraper-bot/"
              >TikTok parent launched a scraper gobbling up world's data 25x
              faster than OpenAI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 10:43:14</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41764670"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41764635">
          <h3>
            <a
              class="item"
              href="https://chromewebstore.google.com/detail/aria-devtools/dneemiigcbbgbdjlcdjjnianlikimpck"
              >Show HN: Visualization of website accessibility tree</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 10:38:36</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41764635"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've spend two months delivering a tool that is easy to
                understand and helps catching accessibility issues on my apps. A
                few years later it's pretty popular despite being mostly
                abandoned.
              </p>
              <p>
                I will be happy to work on this further but honestly lost my
                enthusiasm some time ago. I'd love to get in touch with some
                company in the accessibility testing space and discuss how to
                improve it.
              </p>
            </div>
          </section>
        </section>
        <section id="41764283">
          <h3>
            <a
              class="item"
              href="https://www.nobelprize.org/prizes/medicine/2024/summary/"
              >The Nobel Prize in Physiology or Medicine 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 09:37:09</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41764283"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41763242">
          <h3>
            <a
              class="item"
              href="https://15721.courses.cs.cmu.edu/spring2019/papers/17-hashjoins/richter-vldb2015.pdf"
              >A Seven-Dimensional Analysis of Hashing Methods [pdf] (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 06:16:33</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41763242"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41762692">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/rmtbb/e42d870a59a7f98091e734674831072b"
              >Show HN: Instant HTML Preview Bookmarklet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 04:03:30</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41762692"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
            <div class="text">
              <p>
                I recently found myself needing a quick way to preview HTML and
                SVG code without having to copy it into an IDE, save it, and
                then open it in a browser. ChatGPT's new canvas feature is great
                for generating code, but it doesn't provide a way to preview
                HTML directly.
              </p>
              <p>
                To solve this, I made a small bookmarklet that allows you to
                instantly preview HTML from your clipboard in a new tab. Just
                copy your HTML, click the bookmarklet, and it will render
                immediately.
              </p>
              <p>
                It's a simple tool, but itâ€™s saved me a lot of repetitive steps,
                and I figured it might help others too.
              </p>
              <p>
                The bookmarklet code and instructions for saving it are included
                in the post.
              </p>
              <p>Happy to hear any thoughts or suggestions!</p>
              <p>Thanks, and I hope it saves you some time.</p>
            </div>
          </section>
        </section>
        <section id="41762468">
          <h3>
            <a class="item" href="https://aarol.dev/posts/go-contentlength/"
              >How do HTTP servers figure out Content-Length?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 03:18:04</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41762468"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41761986">
          <h3>
            <a
              class="item"
              href="https://www.scattered-thoughts.net/writing/smolderingly-fast-btrees/"
              >Fast B-Trees</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 01:42:57</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41761986"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41761699">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2409.15298"
              >Sorbet: A neuromorphic hardware-compatible transformer-based
              spiking model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 00:44:53</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41761699"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41760697">
          <h3>
            <a class="item" href="https://sq.io"
              >Sq.io: jq for databases and more</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 22:02:34</span
              ><span class="points-container"
                >Points: <span class="points">433</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41760697"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41760421">
          <h3>
            <a
              class="item"
              href="https://ntietz.com/blog/rust-needs-a-web-framework-for-lazy-developers/"
              >Rust needs a web framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 21:21:47</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41760421"
                  >Comments</a
                ><span class="descendants">: 273</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41760276">
          <h3>
            <a class="item" href="https://up.codes/careers?utm_source=HN"
              >UpCodes (YC S17) is hiring recruiters to build out remote team</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 21:01:09</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41759112">
          <h3>
            <a
              class="item"
              href="https://arnaud-carre.github.io/2024-10-06-vpternlogd/"
              >AVX Bitwise ternary logic instruction busted</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 18:38:26</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41759112"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41758915">
          <h3>
            <a
              class="item"
              href="https://blog.drewolson.org/gleam-is-pragmatic/"
              >Gleam Is Pragmatic</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 18:15:23</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41758915"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41758097">
          <h3>
            <a class="item" href="https://ziggy-lang.io"
              >Ziggy: Data serialization language for expressing API messages,
              config files</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 16:11:40</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41758097"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41757722">
          <h3>
            <a
              class="item"
              href="https://www.openculture.com/2024/09/the-medieval-masterpiece-the-book-of-kells-is-now-digitized-and-available-online.html"
              >The Book of Kells, now digitized and available online</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 15:19:15</span
              ><span class="points-container"
                >Points: <span class="points">355</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41757722"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41756484">
          <h3>
            <a
              class="item"
              href="https://pncnmnp.github.io/blogs/typewriter-uncle-sam.html"
              >We'll buy back your Typewriter for Uncle Sam</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 11:55:15</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41756484"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41756398">
          <h3>
            <a
              class="item"
              href="https://interconnected.org/home/2020/09/24/unoffice_hours"
              >Unoffice Hours (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 11:31:45</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41756398"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41755920">
          <h3>
            <a
              class="item"
              href="https://backreference.org/2010/02/10/idiomatic-awk/"
              >Idiomatic Awk (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 09:29:41</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41755920"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41755559">
          <h3>
            <a
              class="item"
              href="https://diamondgeezer.blogspot.com/2024/10/waverley.html"
              >Waverley, the last seagoing paddle steamer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 07:57:22</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41755559"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41754084">
          <h3>
            <a
              class="item"
              href="https://wsdotblog.blogspot.com/2024/10/in-case-you-cant-tell-were-really.html"
              >We're excited about our new roundabout</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 01:32:50</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41754084"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41752383">
          <h3>
            <a
              class="item"
              href="https://www.psytoolkit.org/experiment-library/experiment_multitasking.html"
              >Task-Switching Experiment (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 19:43:57</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41752383"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41749709">
          <h3>
            <a
              class="item"
              href="https://www.newscientist.com/article/mg26335104-500-the-brain-has-its-own-microbiome-heres-what-it-means-for-your-health/"
              >The brain has its own microbiome</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 13:33:22</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41749709"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41749296">
          <h3>
            <a class="item" href="https://sailfishos.org/"
              >Sailfish Mobile OS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 12:00:26</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41749296"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41749185">
          <h3>
            <a class="item" href="https://starbasedb.com/"
              >Starbase: SQLite on the Edge</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 11:35:19</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41749185"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41748738">
          <h3>
            <a
              class="item"
              href="https://www.niemanlab.org/2024/10/congress-fights-to-keep-am-radio-in-cars/"
              >Congress fights to keep AM radio in cars</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 09:47:02</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41748738"
                  >Comments</a
                ><span class="descendants">: 374</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41748664">
          <h3>
            <a class="item" href="https://rodarmor.com/blog/whence-newline/"
              >Whence '\n'?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 09:23:53</span
              ><span class="points-container"
                >Points: <span class="points">292</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41748664"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41748519">
          <h3>
            <a class="item" href="https://github.com/cepa/aegir-gps-tracker"
              >Show HN: I built a Iridium/LTE satellite GPS tracker and took it
              to the Arctic</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 08:36:31</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41748519"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41747952">
          <h3>
            <a
              class="item"
              href="https://www.cca.org/blog/20120222-Diode-Matrix.shtml"
              >Diode Matrix</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 05:39:42</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41747952"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41734672">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2024/10/ants-fungus-agriculture-traced-back-to-dinosaur-killing-impact/"
              >Ants learned to farm fungi during a mass extinction</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-03 @ 20:32:38</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41734672"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41724849">
          <h3>
            <a
              class="item"
              href="https://www.charlespetzold.com/essays/WilliamCowperAndTheAgeOfTheEarth.pdf"
              >William Cowper and the Age of the Earth [pdf] (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-02 @ 20:50:06</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41724849"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
