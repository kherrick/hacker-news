<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37663270">
          <h3>
            <a class="item" href="https://raverie-us.github.io/raverie-engine/"
              >Show HN: Unity like game editor running in pure WASM</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 17:58:47</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37663270"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <p>
                We’re building off a previous engine that we worked on for
                DigiPen Institute of Technology called the Zero Engine with a
                similar component based design architecture to Unity. Our engine
                had a unique feature called Spaces: separate worlds/levels that
                you can instantiate and run at the same time, which became super
                useful for creating UI overlays using only game objects, running
                multiple simulations, etc. The lighting and rendering engine is
                scriptable, and the default deferred rendering implementation is
                based on the Unreal physically based rendering (PBR) approach.
                The physics engine was built from the ground up to handle both
                2D and 3D physics together. The scripting language was also
                built in house to be a type safe language that binds to C++
                objects and facilitates auto-complete (try it in editor!)
              </p>
              <p>
                This particular fork by Raverie builds both the engine and
                editor to WebAssembly using only clang without Emscripten. We
                love Emscripten and in fact borrowed a tiny bit of exception
                code that we’d love to see up-streamed into LLVM, however we
                wanted to create a pure WASM binary without Emscripten bindings.
                We also love WASI too though we already had our own in memory
                virtual file system, hence we don’t use the WASI imports. All
                WASM imports and exports needed to run the engine are defined
                here:
                <a
                  href="https://github.com/raverie-us/raverie-engine/blob/main/Code/Foundation/Platform/PlatformCommunication.hpp"
                  >https://github.com/raverie-us/raverie-engine/blob/main/Code/...</a
                >
              </p>
              <p>
                The abstraction means that in the future, porting to other
                platforms that can support a WASM runtime should be trivial.
                It’s our dream to be able to export a build of your game to any
                platform, all from inside the browser. Our near term road-map
                includes getting the sound engine integrated with WebAudio,
                getting the script debugger working (currently freezes), porting
                our networking engine to WebRTC and WebSockets, and getting
                saving/loading from a database instead of browser local storage.
              </p>
              <p>
                Our end goal is to use this engine to create an online
                Flash-like hub for games that people can share and remix, akin
                to Scratch or Tinkercad.
              </p>
              <p>
                <a href="https://github.com/raverie-us/raverie-engine"
                  >https://github.com/raverie-us/raverie-engine</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="37663035">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/LocalLLaMA/comments/16au3ga/im_convinced_now_that_personal_llms_are_going_to/"
              >I'm convinced now that “personal LLMs” are going to be a huge
              thing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 17:46:05</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37663035"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37662937">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37662937"
              >Ask HN: Tips for Solopreneur?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 17:39:51</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37662937"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been to some conferences recently and talked to a lot of
                people who have these problems as well, and they're keen to try
                it out. I have collected some emails, been communicating with
                them a bit and even got beers with one of them recently!
              </p>
              <p>Here's my list of concerns:</p>
              <p>
                1. It is just me - is that a red flag? Some people have asked me
                about my team and I told them it was just me. I got the feeling
                that it may have turned them off because the conversation kind
                of ended right there. To be fair, after that I did say that it
                is just me right now BUTTTTTTTT why that is okay due to my
                experience and work history. However, yes it is my first time
                doing a business.
              </p>
              <p>
                2. How do I set appropriate milestones for me to reach? Do I
                think about reaching 100 customers before reaching 5 recurring
                customers for example?
              </p>
              <p>
                3. I'm in a small town in PNW. Does that matter if this will be
                an online thing anyway? Why or when do people move to big cities
                like Seattle/SF/NYC/Austin etc.
              </p>
              <p>
                4. What are some ways to do marketing? Should I even think about
                that before I have a few customers who are using my product
                consistently?
              </p>
              <p>
                5. I've been inspired by the Startup School videos. Honestly
                though I'm not sure about fundraising and all these things, it
                seems very intimidating to me. What's the difference between
                those things and starting a company and slowly building it up?
              </p>
            </div>
          </section>
        </section>
        <section id="37662561">
          <h3>
            <a class="item" href="https://github.com/mckinsey/vizro"
              >Vizro – toolkit for creating modular data visualization
              applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 17:15:33</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37662561"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37662510">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2023/09/macos-sonoma-is-available-today/"
              >macOS Sonoma is available today</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 17:12:17</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37662510"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37662297">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/byterat/jobs/UtaWWqL-founding-engineer"
              >Byterat (YC W23) Is Hiring a Founding Engineer (San Francisco)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 17:00:05</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37661767">
          <h3>
            <a class="item" href="https://github.com/jackmpcollins/magentic"
              >Show HN: Magentic – Use LLMs as simple Python functions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 16:31:16</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37661767"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built this to show that we can think about using LLMs more
                fluidly than just chains and chats, i.e. more interchangeably
                with regular code, and to make it easy to do that.
              </p>
              <p>Please let me know what you think! Contributions welcome.</p>
              <p>
                <a href="https://github.com/jackmpcollins/magentic"
                  >https://github.com/jackmpcollins/magentic</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="37661755">
          <h3>
            <a
              class="item"
              href="https://github.com/jmorganca/ollama/releases/tag/v0.1.0"
              >Show HN: Ollama for Linux – Run LLMs on Linux with GPU
              Acceleration</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 16:29:56</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37661755"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <p>
                Over the last few months I've been working with some folks on a
                tool named Ollama (<a href="https://github.com/jmorganca/ollama"
                  >https://github.com/jmorganca/ollama</a
                >) to run open-source LLMs like Llama 2, Code Llama and Falcon
                locally, starting with macOS.
              </p>
              <p>
                The biggest ask since then has been "how can I run Ollama on
                Linux?" with GPU support out of the box. Setting up and
                configuring CUDA and then compiling and running llama.cpp (which
                is a fantastic library and runs under the hood) can be quite
                painful on different combinations of linux distributions and
                Nvidia GPUs. The goal for Ollama's linux version was to automate
                this process to make it easy to get up and running.
              </p>
              <p>
                The is the first Linux release! There's still lots to do, but I
                wanted to share it here for to see what everyone thinks. Thanks
                for anyone who has given it a try and sent feedback!
              </p>
            </div>
          </section>
        </section>
        <section id="37661609">
          <h3>
            <a
              class="item"
              href="https://papersplease.org/wp/2023/06/26/9th-circuit-rejects-tsa-claim-of-impunity-for-checkpoint-staff-who-rape-travelers/"
              >9th Circuit rejects TSA claim of impunity for checkpoint staff
              who rape traveler</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 16:21:30</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37661609"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37661446">
          <h3>
            <a
              class="item"
              href="https://www.ftc.gov/news-events/news/press-releases/2023/09/ftc-sues-amazon-illegally-maintaining-monopoly-power"
              >FTC Sues Amazon for Illegally Maintaining Monopoly Power</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 16:10:40</span
              ><span class="points-container"
                >Points: <span class="points">329</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37661446"
                  >Comments</a
                ><span class="descendants">: 249</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37661387">
          <h3>
            <a class="item" href="https://harrystern.net/halldisplay.html"
              >Yet another E-Ink weather display – but with Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 16:06:21</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37661387"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37661034">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/science-and-technology/2023/09/20/how-common-infections-can-spark-psychiatric-illnesses-in-children"
              >Common infections can spark psychiatric illnesses in children</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 15:43:26</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37661034"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37660256">
          <h3>
            <a
              class="item"
              href="https://www.power-technology.com/news/report-majority-carbon-offsets-junk-or-useless/"
              >Investigation: 78% of carbon offset projects globally are “likely
              junk“</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 14:50:35</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37660256"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37660146">
          <h3>
            <a class="item" href="https://arcem.sourceforge.net/"
              >ArcEm – The Acorn Archimedes Emulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 14:42:46</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37660146"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37660120">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2023/09/26/apple-exec-eddy-cue-testify-google-trial-about-19-billion-search-deal.html"
              >Apple exec Eddy Cue set to testify in Google trial about $19B
              search deal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 14:41:30</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37660120"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37660025">
          <h3>
            <a class="item" href="https://github.com/ruricolist/spinneret"
              >Spinneret: A modern Common Lisp HTML generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 14:36:18</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37660025"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37659542">
          <h3>
            <a
              class="item"
              href="https://hbsp.harvard.edu/inspiring-minds/student-use-cases-for-ai"
              >Harvard: Student Use Cases for AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 14:07:19</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37659542"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37659327">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-09-newly-deep-sea-enzyme-pet-plastic.amp"
              >Newly discovered deep-sea enzyme breaks down PET plastic</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 13:52:58</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37659327"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37659153">
          <h3>
            <a class="item" href="https://openjdk.org/jeps/457"
              >JEP 457: Class-File API for Parsing, generating, transforming
              Java classfiles</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 13:40:41</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37659153"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37659110">
          <h3>
            <a
              class="item"
              href="https://leighmariebraswell.substack.com/p/how-to-make-history-with-llms-and"
              >How to make history with LLMs and other generative models</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 13:37:02</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37659110"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37658714">
          <h3>
            <a class="item" href="https://resobscura.substack.com/p/kikkuli"
              >Kikkuli: Why do some people from the distant past become
              memes?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 13:07:13</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37658714"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37657772">
          <h3>
            <a class="item" href="https://github.com/datalens-tech"
              >Yandex open sourced it's BI tool DataLens</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 11:36:21</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37657772"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37657736">
          <h3>
            <a
              class="item"
              href="https://duckdb.org/2023/09/26/announcing-duckdb-090.html"
              >DuckDB 0.9.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 11:32:24</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37657736"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37655477">
          <h3>
            <a class="item" href="https://macoscontainers.org/"
              >macOS Containers v0.0.1</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 07:01:45</span
              ><span class="points-container"
                >Points: <span class="points">460</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37655477"
                  >Comments</a
                ><span class="descendants">: 296</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37655094">
          <h3>
            <a class="item" href="https://pytorch.org/blog/inside-the-matrix/"
              >Inside the Matrix: Visualizing Matrix Multiplication, Attention
              and Beyond</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 06:11:40</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37655094"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37654891">
          <h3>
            <a
              class="item"
              href="https://major.io/p/quadlets-replace-docker-compose/"
              >Quadlets might make me finally stop using docker-compose</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-26 @ 05:39:19</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37654891"
                  >Comments</a
                ><span class="descendants">: 168</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37649250">
          <h3>
            <a
              class="item"
              href="https://www.theparisreview.org/blog/2023/09/22/j-g-ballards-brilliant-not-good-writing/"
              >J. G. Ballard’s Brilliant, “Not Good” Writing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 19:27:00</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37649250"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37646008">
          <h3>
            <a class="item" href="https://verilogtorouting.org/"
              >Verilog to Routing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 15:59:13</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37646008"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37644543">
          <h3>
            <a
              class="item"
              href="https://marc.info/?l=openbsd-tech&amp;m=169558749114476&amp;w=2"
              >Viable ROP-free roadmap for i386/armv8/riscv64/alpha/sparc64</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 14:37:55</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37644543"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37638820">
          <h3>
            <a class="item" href="https://limsk.ece.gatech.edu/course/ece6133/"
              >ECE6133: Physical Design Automation of VLSI Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-25 @ 01:41:36</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37638820"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
