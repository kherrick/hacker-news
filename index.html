<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41651820">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/clara/jobs/bB9fgEH-head-of-growth"
              >Clara (YC S24) Is Hiring a Head of Growth</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 21:01:15</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41651038">
          <h3>
            <a
              class="item"
              href="https://twitter.com/miramurati/status/1839025700009030027"
              >Mira Murati leaves OpenAI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 19:35:31</span
              ><span class="points-container"
                >Points: <span class="points">370</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41651038"
                  >Comments</a
                ><span class="descendants">: 250</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41650905">
          <h3>
            <a class="item" href="https://github.com/cle-b/httpdbg"
              >Show HN: Httpdbg – A tool to trace the HTTP requests sent by your
              Python code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 19:18:12</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41650905"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
            <div class="text">
              <p>
                I created httpdbg, a tool for Python developers to easily debug
                HTTP(S) client requests in Python programs.
              </p>
              <p>
                I developed it because I needed a tool that could help me trace
                the HTTP requests sent by my tests back to the corresponding
                methods in our API client.
              </p>
              <p>
                The goal of this tool is to simplify the debugging process, so I
                designed it to be as simple as possible. It requires no external
                dependencies, no setup, no superuser privileges, and no code
                modifications.
              </p>
              <p>
                I'm sharing it with you today because I use it regularly, and it
                seems like others have found it useful too—so it might be
                helpful for you as well.
              </p>
              <p>Hope you will like it.</p>
              <p>cle</p>
              <p>
                Source:
                <a href="https://github.com/cle-b/httpdbg"
                  >https://github.com/cle-b/httpdbg</a
                >
              </p>
              <p>
                Documentation:
                <a href="https://httpdbg.readthedocs.io/"
                  >https://httpdbg.readthedocs.io/</a
                >
              </p>
              <p>
                A blog post on a use case:
                <a
                  href="https://medium.com/@cle-b/trace-all-your-http-requests-in-python-using-httpdbg-9db9110db981/"
                  >https://medium.com/@cle-b/trace-all-your-http-requests-in-py...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41650647">
          <h3>
            <a
              class="item"
              href="https://security.googleblog.com/2024/09/eliminating-memory-safety-vulnerabilities-Android.html"
              >Eliminating Memory Safety Vulnerabilities at the Source</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 18:49:03</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41650647"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41650534">
          <h3>
            <a
              class="item"
              href="https://clarkwakeland.com/blog/2024/avoiding-a-BSOD-on-your-satellite/"
              >How to avoid a BSOD on your 2B dollar spacecraft</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 18:40:26</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41650534"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41650047">
          <h3>
            <a
              class="item"
              href="https://about.fb.com/news/2024/09/introducing-orion-our-first-true-augmented-reality-glasses/"
              >Orion, our first true augmented reality glasses</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 17:56:53</span
              ><span class="points-container"
                >Points: <span class="points">485</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41650047"
                  >Comments</a
                ><span class="descendants">: 359</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41649763">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/blog/llama-3-2-connect-2024-vision-edge-mobile-devices/?_fb_noscript=1"
              >Llama 3.2: Revolutionizing edge AI and vision with open,
              customizable models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 17:29:27</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41649763"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41649301">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/if-the-universe-is-a-hologram-this-long-forgotten-math-could-decode-it-20240925/"
              >Operator algebras and the substructure of space and time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 16:46:38</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41649301"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41649134">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2024/09/timeshare-owner-the-mexican-drug-cartels-want-you/"
              >Timeshare owner? The Mexican drug cartels want you</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 16:28:20</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41649134"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41648965">
          <h3>
            <a class="item" href="https://github.com/C-Naoki/image-stitcher"
              >Show HN: Fast and Exact Algorithm for Image Merging</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 16:10:35</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41648965"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              I developed the application, `image-stitcher` for image merging by
              automatically searching for overlap region.
            </div>
          </section>
        </section>
        <section id="41648772">
          <h3>
            <a class="item" href="https://x11-basic.sourceforge.net"
              >X11-Basic (1991-2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 15:54:57</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41648772"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41648711">
          <h3>
            <a class="item" href="https://github.com/capstone-engine/capstone"
              >Capstone Disassembler Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 15:48:51</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41648711"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41648564">
          <h3>
            <a
              class="item"
              href="https://github.com/haystackeditor/haystack-editor"
              >Launch HN: Haystack (YC S24) – Visualize and edit code on an
              infinite canvas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 15:31:00</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41648564"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
            <div class="text">
              <a href="https://haystackeditor.com/"
                >https://haystackeditor.com/</a
              >). Haystack re-imagines the IDE by putting it on a 2D digital
              whiteboard that automatically draws connections between code as
              you navigate and edit files. We designed it to match our mental
              model of how code works – as a graph of connected components.
              Here’s a demo of what it looks like:
              <a href="https://www.youtube.com/watch?v=5XADctpWNNs"
                >https://www.youtube.com/watch?v=5XADctpWNNs</a
              >. You can download Haystack from
              <a href="https://haystackeditor.com/"
                >https://haystackeditor.com/</a
              >.
              <p>
                We used to work as software engineers at big companies, and when
                the explosion in AI code-generation tools started we were really
                excited about them. They gave us a huge speed boost in our
                day-to-day work. But something was missing: writing code had
                become easier, but navigating codebases remained painful. We
                found that we were spending more time on the latter than the
                former!
              </p>
              <p>
                Our vision of Haystack is an IDE that helps you navigate your
                codebase at speed. You should be able to type a vague
                description of the code you’re looking for (“Show me the code
                flow that triggers after we click the submit button”) and
                immediately see the right result. But we don’t think the
                traditional split-panel interface is the best fit for this type
                of rapid navigation. Inspired by the fluidity of design tools
                like Figma (Akshay used to work there!) and Miro, we realized
                that the canvas layout is a perfect way to represent and operate
                on code flows, and a great base for all the AI and collaborative
                tooling we want to build! This is how Haystack was born.
              </p>
              <p>
                You might have seen our original Show HN (<a
                  href="https://news.ycombinator.com/item?id=41068719"
                  >https://news.ycombinator.com/item?id=41068719</a
                >) about two months ago. Since then, a ton of our users have
                told us that they’d love to contribute. We’ve made the decision
                to make the editor source-available so that folks can make
                contributions and so that they can examine the code to make sure
                they can trust it. Our repo is at
                <a href="https://github.com/haystackeditor/haystack-editor"
                  >https://github.com/haystackeditor/haystack-editor</a
                >.
              </p>
              <p>
                If you’re wondering why we’re going source-available rather than
                proper open-source: as a startup, we're going to eventually
                monetize and it’s too early for us to make the decision on
                whether going fully open-source is the right move. We want to
                own the distribution of Haystack until we can better understand
                the ramifications that open-sourcing would have, and whether
                it’s sustainable business-wise. We’d love to find a way to make
                proper open-source work, but it’s a one-way door, so we want to
                take our time to make sure we’re making an informed decision.
              </p>
              <p>
                We would love to hear about what you think about having a canvas
                in your IDE and the role visualizations have to play in software
                development!
              </p>
            </div>
          </section>
        </section>
        <section id="41648483">
          <h3>
            <a
              class="item"
              href="https://www.systeminit.com/blog-system-initiative-is-the-future/"
              >System Intiative is generally available</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 15:21:02</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41648483"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41647923">
          <h3>
            <a
              class="item"
              href="https://www.cryptomuseum.com/covert/bugs/masking/"
              >Audio Masking</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 14:27:03</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41647923"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41647876">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/grid-enhancing-technologies"
              >Reconductoring: Boosting U.S. Grid Capacity Efficiently</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 14:22:37</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41647876"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41647843">
          <h3>
            <a
              class="item"
              href="https://duriansoftware.com/joe/the-lost-language-extensions-of-metaware%27s-high-c-compiler"
              >The lost language extensions of MetaWare's High C compiler
              (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 14:19:13</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41647843"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41646531">
          <h3>
            <a
              class="item"
              href="https://www.jonashietala.se/blog/2024/09/25/why_i_still_blog_after_15_years/"
              >Why I still blog after 15 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 12:19:29</span
              ><span class="points-container"
                >Points: <span class="points">309</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41646531"
                  >Comments</a
                ><span class="descendants">: 167</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41646420">
          <h3>
            <a
              class="item"
              href="https://innocenceproject.org/who-is-marcellus-williams-man-facing-execution-in-missouri-despite-dna-evidence-supporting-innocence/"
              >Who is Marcellus Williams: Execution in Missouri despite evidence
              of innocence</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 12:05:18</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41646420"
                  >Comments</a
                ><span class="descendants">: 177</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41646085">
          <h3>
            <a
              class="item"
              href="https://stevana.github.io/scheduling_threads_like_thomas_jefferson.html"
              >Scheduling threads like Thomas Jefferson</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 11:22:17</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41646085"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41645822">
          <h3>
            <a class="item" href="https://www.jabref.org/"
              >JabRef – Literature Management</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 10:35:38</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41645822"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41645173">
          <h3>
            <a
              class="item"
              href="https://wafris.org/blog/rearchitecting-for-sqlite"
              >Rearchitecting: Redis to SQLite</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 08:37:48</span
              ><span class="points-container"
                >Points: <span class="points">228</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41645173"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41643651">
          <h3>
            <a
              class="item"
              href="https://github.com/ben-n93/SQL-tips-and-tricks"
              >SQL Tips and Tricks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 04:20:48</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41643651"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41631948">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2409.12089"
              >The Impact of Element Ordering on LM Agent Performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-24 @ 00:28:46</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41631948"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41628371">
          <h3>
            <a
              class="item"
              href="https://www.lansingstatejournal.com/story/news/local/michigan/2024/09/22/griffon-shipwreck-great-lakes-lake-michigan-steve-kathie-libert/74956091007/"
              >MI couple running out of time to prove they found Great Lakes'
              oldest shipwreck</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-23 @ 17:19:32</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41628371"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41625704">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41467-024-50473-z"
              >Combining sound with tongue stimulation for the treatment of
              tinnitus</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-23 @ 13:12:40</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41625704"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41623814">
          <h3>
            <a
              class="item"
              href="https://js13kgames.com/2024/games/king-thirteen"
              >Show HN: King Thirteen: 2048 with chess pieces, in under 13 KB</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-23 @ 08:41:25</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41623814"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <p>
                Notes on the game design:
                <a href="https://mvasilkov.animuchan.net/king-thirteen"
                  >https://mvasilkov.animuchan.net/king-thirteen</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41601250">
          <h3>
            <a class="item" href="https://bloomberg.github.io/ts-blank-space/"
              >ts-blank-space is a fast type-stripping compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 12:18:24</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41601250"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41601148">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/nasa-spacecraft-probe-possibility-life-europa-s-salty-ocean"
              >NASA spacecraft to probe possibility of life in Europa's salty
              ocean</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 12:02:44</span
              ><span class="points-container"
                >Points: <span class="points">343</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41601148"
                  >Comments</a
                ><span class="descendants">: 318</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41600903">
          <h3>
            <a
              class="item"
              href="https://dthompson.us/posts/optimizing-guile-scheme.html"
              >Optimizing Guile Scheme</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 11:28:01</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41600903"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
