<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39089303">
          <h3>
            <a
              class="item"
              href="https://rls.sites.oasis.unc.edu/s890/evtclass.pdf"
              >Extreme Value Theory (2009) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 13:28:10</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39089303"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39089294">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Jazelle"
              >Jazelle DBX: Allow ARM processors to execute Java bytecode in
              hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 13:27:22</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39089294"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39088991">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/space/2024/01/solving-a-nasa-mystery-why-did-space-shuttle-commanders-lock-the-hatch/"
              >What happens when an astronaut in orbit says he's not coming
              back?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 12:57:05</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39088991"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39088566">
          <h3>
            <a class="item" href="https://skio.com/careers/"
              >Skio (YC S20) – Subscriptions for Shopify, ReCharge Migrations Is
              Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 12:03:06</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39088551">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39088551"
              >Launch HN: Diversion (YC S22) – Cloud-Native Git Alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 12:01:10</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39088551"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
            <div class="text">
              <a href="https://diversion.dev">https://diversion.dev</a>). We’re
              building a modern, cloud-native version control. Our first users
              are game developers, who like its simplicity and scalability. See
              a quick demo here:
              <a href="https://youtu.be/DD0XkL8kDYc"
                >https://youtu.be/DD0XkL8kDYc</a
              >
              <p>
                Why a new VCS? There is no doubt that Git vastly improved our
                lives, and played a significant role in the advancement of
                software development over the past 18 years. But - it was built
                for a very different world in 2005 (slow networks, much smaller
                projects, no cloud), and is not the perfect tool for everyone
                today.
              </p>
              <p>
                The biggest drawback of Git is its limited scalability - both in
                repository and file sizes, and the number of concurrent users.
                This is the reason Google and Meta built their own version
                control systems. It’s also the reason why other large companies,
                most notably in games development, semiconductors and financial
                services are still using legacy tools like SVN and Perforce.
              </p>
              <p>
                Another issue we’re trying to fix is Git’s famous complexity. In
                our previous startup, a data scientist accidentally destroyed a
                month’s work of his team by using the wrong Git command (EDIT:
                we were eventually able to restore from a non-updated repo
                clone, after a few hours). As a developer who used CVS and SVN
                before Git was created, I often wondered why Git is so difficult
                to learn, compared to other tools.
              </p>
              <p>
                On the other hand, Git’s branching and merging abilities are
                exceptional - this has enabled the modern software development
                methodologies that we all take for granted today (e.g. feature
                branches, CI/CD), greatly improving developers’ velocity.
              </p>
              <p>
                We were wondering - is it possible to create an easy-to-use,
                fast, scalable version control system, with Git’s branching
                capabilities? And what else can be improved, while we’re at it?
              </p>
              <p>
                One thing available in modern cloud tools is real-time
                collaboration (e.g. Google Docs, Figma). While developers don’t
                necessarily want their work in progress to be visible to
                everyone, it may be very useful to easily share it when you want
                to get feedback before a commit, to detect and prevent merge
                conflicts, and to have visibility into which parts of the
                codebase are being changed by others.
              </p>
              <p>
                Diversion is built on top of distributed storage and databases,
                accessible via REST API, and runs on serverless cloud
                infrastructure. Every repository operation is an API call
                (commit, branch, merge etc.). The desktop client synchronizes
                all work in progress to the cloud in real time (even before a
                commit). Users can work with Diversion using an interactive CLI,
                Web UI, or IDE plugins (currently JetBrains, more coming soon).
                The Web UI allows to perform most basic operations, without
                needing to install a desktop client.
              </p>
              <p>
                Diversion is compatible with Git, and can synchronize with
                existing Git repositories (each new commit in Diversion goes
                into Git, and vice versa). We’re planning to release it as open
                source once the code base matures, and when we implement an open
                source repositories directory on our website (naturally,
                Diversion’s code is managed on Diversion!)
              </p>
              <p>
                We’re in open beta, you can try it here (<a
                  href="https://diversion.dev"
                  >https://diversion.dev</a
                >) (click Get Started). It’s completely self-service and there’s
                no need to talk to anyone, and it’s free for small teams (<a
                  href="https://diversion.dev/pricing"
                  >https://diversion.dev/pricing</a
                >).
              </p>
              <p>
                Building a version control is hard (as we have learned), and
                Diversion still has a long way to go. We are currently working
                on improving speed, CI integrations, plugins to IDEs and game
                engines, and other usability improvements. We would love to hear
                your thoughts and feedback on what we’ve got so far!
              </p>
            </div>
          </section>
        </section>
        <section id="39088455">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=ZuXzvjBYW8A"
              >Have the Boomers Pinched Their Children's Futures? [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 11:45:38</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39088455"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087837">
          <h3>
            <a
              class="item"
              href="https://supabase.com/blog/should-i-open-source-my-company"
              >Should I Open Source my Company?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 09:40:13</span
              ><span class="points-container"
                >Points: <span class="points">208</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087837"
                  >Comments</a
                ><span class="descendants">: 136</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087782">
          <h3>
            <a
              class="item"
              href="https://hackaday.com/2024/01/22/haier-europe-eases-off-on-legal-threat-and-seeks-dialogue/"
              >Haier Europe Eases Off on Legal Threat and Seeks Dialogue</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 09:27:19</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087782"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087752">
          <h3>
            <a class="item" href="https://qr.blinry.org/"
              >Reading QR codes without a computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 09:21:11</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087752"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087609">
          <h3>
            <a
              class="item"
              href="https://rubyflow.com/p/pb1tu2-rubywm-an-x11-window-manager-in-pure-ruby"
              >RubyWM – an X11 window manager in pure Ruby</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 08:51:14</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087609"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087274">
          <h3>
            <a
              class="item"
              href="https://www.reddit.com/r/aviation/s/kb3WBpHMFL"
              >Kayak's New Flight Filter Allows You to Exclude Aircraft
              Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 07:41:10</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087274"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087237">
          <h3>
            <a
              class="item"
              href="https://www.bbc.co.uk/news/world-us-canada-68052160"
              >Boeing 737-900ER: Second model to be inspected after 737 MAX 9
              blowout</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 07:32:07</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087237"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087016">
          <h3>
            <a
              class="item"
              href="https://chris-haarburger.com/posts/security_startups.html"
              >Ten Simple IT Security Rules for Early-Stage Startups</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 06:50:20</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087016"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39086801">
          <h3>
            <a
              class="item"
              href="https://news.mit.edu/2024/self-powered-sensor-harvests-magnetic-energy-0118"
              >Battery-free self-powered sensor harvests magnetic energy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 06:01:14</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39086801"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39086462">
          <h3>
            <a class="item" href="http://cr.yp.to/tcpip/twofd.html"
              >Two File Descriptors for Sockets</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 05:07:41</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39086462"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39086244">
          <h3>
            <a class="item" href="https://www.pfrazee.com/blog/why-not-p2p"
              >Why isn't Bluesky a peer-to-peer network?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 04:36:20</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39086244"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39086106">
          <h3>
            <a class="item" href="https://iter.ca/post/gpt-crash/"
              >GPT-3.5 crashes when it thinks about useRalativeImagePath too
              much</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 04:15:27</span
              ><span class="points-container"
                >Points: <span class="points">358</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39086106"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39086032">
          <h3>
            <a class="item" href="https://spite.github.io/CSS3DClouds/"
              >CSS3D Clouds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 03:59:49</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39086032"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39085830">
          <h3>
            <a
              class="item"
              href="https://www.nps.gov/subjects/digital/nps-data-api.htm"
              >U.S. National Park Service API</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 03:25:20</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39085830"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39085092">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/helium-is-an-essential-material-for-research-and-medical-equipment-but-its-nonrenewable-and-difficult-to-recycle-218668"
              >Helium is essential but nonrenewable and difficult to recycle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 01:44:48</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39085092"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39084533">
          <h3>
            <a
              class="item"
              href="https://hackaday.com/2024/01/21/garden-light-turned-mesh-network-node/"
              >Garden Light Turned Mesh Network Node</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 00:22:02</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39084533"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39084146">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-01-scientists-chaotic-protein-fueling-cancers.html"
              >Scientists tame chaotic protein fueling 75% of cancers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-21 @ 23:29:44</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39084146"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39084137">
          <h3>
            <a class="item" href="https://flipperzero.one"
              >Flipper Zero: Multi-Tool Device for Geeks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-21 @ 23:27:51</span
              ><span class="points-container"
                >Points: <span class="points">519</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39084137"
                  >Comments</a
                ><span class="descendants">: 221</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39082552">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/the-surprising-story-of-the-first-microprocessors"
              >The Surprising Story of the First Microprocessors (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-21 @ 20:14:17</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39082552"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39081861">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/karel-capek-robots"
              >A Man Who Coined the Word "Robot" Defends Himself</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-21 @ 19:16:56</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39081861"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39077867">
          <h3>
            <a
              class="item"
              href="https://www.nj.com/essex/2024/01/remembering-bell-labs-as-legendary-idea-factory-prepares-to-leave-nj-home.html"
              >Remembering Bell Labs as legendary idea factory prepares to leave
              N.J. home</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-21 @ 12:31:57</span
              ><span class="points-container"
                >Points: <span class="points">231</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39077867"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39067615">
          <h3>
            <a
              class="item"
              href="https://medium.com/@mustafaakin/indexing-icloud-photos-with-ai-using-llava-and-pgvector-fd58182febf6"
              >Indexing iCloud Photos with AI Using LLaVA and Pgvector</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-20 @ 14:01:45</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39067615"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39066795">
          <h3>
            <a
              class="item"
              href="https://www.jdemeta.net/p/the-dawn-of-cultural-schizophrenia"
              >The Dawn of Cultural Schizophrenia (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-20 @ 12:01:43</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39066795"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39066741">
          <h3>
            <a
              class="item"
              href="https://github.com/AkechiShiro/slides-talks/blob/main/UYBHYS2022/Talk%20SPI%20chips.pdf"
              >Dumping Firmware for fun and learning [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-20 @ 11:55:19</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39066741"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39063242">
          <h3>
            <a
              class="item"
              href="https://laplab.me/posts/whats-that-touchscreen-in-my-room/"
              >What's that touchscreen in my room?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-20 @ 00:17:56</span
              ><span class="points-container"
                >Points: <span class="points">1806</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39063242"
                  >Comments</a
                ><span class="descendants">: 531</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
