<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40185455">
          <h3>
            <a
              class="item"
              href="https://unchartedterritories.tomaspueyo.com/p/why-i-dont-invest-in-real-estate"
              >Why I Don't Invest in Real Estate</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-28 @ 02:17:34</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40185455"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40185065">
          <h3>
            <a
              class="item"
              href="https://alastairreid.github.io/riscv-spec-issues/"
              >How to improve the RISC-V specification</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-28 @ 01:05:37</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40185065"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40184916">
          <h3>
            <a class="item" href="https://datatracker.ietf.org/doc/html/rfc7282"
              >RFC 7282 – On Consensus and Humming in the IETF (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-28 @ 00:40:44</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40184916"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40184673">
          <h3>
            <a class="item" href="https://theluddite.org/#!post/google-ads"
              >Google made me ruin a perfectly good website (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 23:52:11</span
              ><span class="points-container"
                >Points: <span class="points">250</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40184673"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40184515">
          <h3>
            <a
              class="item"
              href="https://sigma-star.at/blog/2023/07/embedded-go-prog/"
              >Let's Embed a Go Program into the Linux Kernel</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 23:20:17</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40184515"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40184434">
          <h3>
            <a
              class="item"
              href="https://grist.org/international/burn-after-wearing-fashion-waste-chile/"
              >Burn After Wearing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 23:10:40</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40184434"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40183817">
          <h3>
            <a
              class="item"
              href="https://computer.rip/2024-04-26-microsoft-at-work.html"
              >Microsoft at Work</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 21:39:53</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40183817"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40183502">
          <h3>
            <a
              class="item"
              href="https://jobs.gem.com/zep/am9icG9zdDqdSHi4vSPAkX4trFIRMpZn"
              >Zep AI (YC W24) Is Hiring a Dev Advocate / Engineer with LLM
              Experience</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 21:00:05</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40182868">
          <h3>
            <a class="item" href="http://www.playkeepout.com/"
              >Keep Out – WebGL Game</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 19:49:10</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40182868"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40182695">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2404.15758"
              >Let's Think Dot by Dot: Hidden Computation in Transformer
              Language Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 19:28:26</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40182695"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40182555">
          <h3>
            <a
              class="item"
              href="https://gagor.pro/2024/02/how-i-stopped-worrying-and-loved-makefiles/"
              >How I stopped worrying and loved Makefiles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 19:09:00</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40182555"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40181896">
          <h3>
            <a
              class="item"
              href="https://blog.talosintelligence.com/arcanedoor-new-espionage-focused-campaign-found-targeting-perimeter-network-devices/"
              >ArcaneDoor – New campaign found targeting network devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 17:42:34</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40181896"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40181612">
          <h3>
            <a
              class="item"
              href="https://swe-to-mle.pages.dev/posts/einsum-for-tensor-manipulation/"
              >Einsum for Tensor Manipulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 17:08:20</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40181612"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40181306">
          <h3>
            <a class="item" href="https://github.com/truefoundry/cognita"
              >Show HN: Cognita – open-source RAG framework for modular
              applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 16:40:06</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40181306"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/truefoundry/cognita"
                >https://github.com/truefoundry/cognita</a
              >), born from collaborations with diverse enterprises, is now
              open-source. Currently, it offers seamless integrations with
              Qdrant and SingleStore.
              <p>
                In recent weeks, numerous engineers have explored Cognita,
                providing invaluable insights and feedback. We deeply appreciate
                your input and encourage ongoing dialogue (share your thoughts
                in the comments – let's keep this ‘open source’).
              </p>
              <p>
                While RAG is undoubtedly powerful, the process of building a
                functional application with it can feel overwhelming. From
                selecting the right AI models to organizing data effectively,
                there's a lot to navigate. While tools like LangChain and
                LlamaIndex simplify prototyping, an accessible, ready-to-use
                open-source RAG template with modular support is still missing.
                That's where Cognita comes in.
              </p>
              <p>Key benefits of Cognita:</p>
              <p>
                1. Central repository for parsers, loaders, embedders, and
                retrievers. 2. User-friendly UI empowers non-technical users to
                upload documents and engage in Q&amp;A. 3. Fully API-driven for
                seamless integration with other systems.
              </p>
              <p>
                We invite you to explore Cognita and share your feedback as we
                refine and expand its capabilities. Interested in contributing?
                Join the journey at
                <a href="https://www.truefoundry.com/cognita-launch"
                  >https://www.truefoundry.com/cognita-launch</a
                >.
              </p>
            </div>
          </section>
        </section>
        <section id="40181000">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40181000"
              >Ask HN: What have you built with ESPHome, ESP8266 or similar
              hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 16:05:45</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40181000"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
            <div class="text">
              Recently, ESPHome was on the homepage
              (https://news.ycombinator.com/item?id=40138228) and some people
              shared their constructions. What else have you built yourself with
              electronics like these? What makes your live easier or a little
              bit more fun?
            </div>
          </section>
        </section>
        <section id="40180821">
          <h3>
            <a class="item" href="https://www.svgviewer.dev"
              >SVG Viewer – View, edit, and optimize SVGs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 15:43:54</span
              ><span class="points-container"
                >Points: <span class="points">352</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40180821"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40180790">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/24141929/apple-iphone-imessage-antitrust-dma-lock-in"
              >The walls of Apple's garden are tumbling down</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 15:38:21</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40180790"
                  >Comments</a
                ><span class="descendants">: 326</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40180516">
          <h3>
            <a
              class="item"
              href="https://statmodeling.stat.columbia.edu/wp-content/uploads/2024/01/Bat-Ball.pdf"
              >The formation and revision of intuitions (2023) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 15:05:30</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40180516"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40180475">
          <h3>
            <a class="item" href="https://github.com/hackclub/blot"
              >Show HN: Blot – code, art, robots and open source education</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 15:01:58</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40180475"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>
                This has resulted in the development of a model called "you
                ship, we ship." We build open source creative coding
                environments, and when teenagers share the projects they make
                with these tools, we send them materials to dive deeper into the
                subject and related technologies. Our approach is predicated on
                the constructionist idea that people learn best by building
                things they care about and sharing them with others. The vision
                we have is to create a public collection of creative learning
                tools that offer people projects they can do right away and
                communities of practice to engage with.
              </p>
              <p>
                Blot is our next installment in the series. It's designed to be
                a gateway to CNC robotics through digital art. If you'd like to
                see some of the projects people have made so far, you can check
                out:
              </p>
              <p>
                <a href="https://blot.hackclub.com/gallery"
                  >https://blot.hackclub.com/gallery</a
                >
              </p>
              <p>
                You can also find projects from our first "you ship, we ship"
                called Sprig. It's a game console you get by building a game for
                it.
              </p>
              <p>
                <a href="https://sprig.hackclub.com/gallery"
                  >https://sprig.hackclub.com/gallery</a
                >
              </p>
              <p>
                I'd love people's thoughts on the model and ideas for other
                subjects in technology we could build projects around.
              </p>
            </div>
          </section>
        </section>
        <section id="40179553">
          <h3>
            <a class="item" href="https://github.com/lodefmode/moviecart"
              >Moviecart – Full length color movie and audio cartridges for
              stock Atari 2600</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 12:49:55</span
              ><span class="points-container"
                >Points: <span class="points">289</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40179553"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40179232">
          <h3>
            <a
              class="item"
              href="https://www.strangeloopcanon.com/p/what-can-llms-never-do"
              >What can LLMs never do?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 11:48:49</span
              ><span class="points-container"
                >Points: <span class="points">266</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40179232"
                  >Comments</a
                ><span class="descendants">: 216</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40178652">
          <h3>
            <a class="item" href="https://cliffle.com/blog/hubris-reply-fault/"
              >The server chose violence</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 09:37:28</span
              ><span class="points-container"
                >Points: <span class="points">270</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40178652"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40176738">
          <h3>
            <a
              class="item"
              href="https://incolumitas.com/2021/11/03/so-you-want-to-scrape-like-the-big-boys/"
              >So you want to scrape like the big boys (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-27 @ 02:56:00</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40176738"
                  >Comments</a
                ><span class="descendants">: 128</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40166516">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40166516"
              >Show HN: Scenestamps – A website for sharing movie scenes with
              timestamps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 06:40:30</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40166516"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've launched a website specifically for sharing scenes,
                complete with descriptions and timestamps from various films and
                TV shows. I'm reaching out to gather your perspectives and
                recommendations in these domains to improve the site and extend
                my outreach.
              </p>
              <p>
                Link :
                <a href="https://scenestamps.com">https://scenestamps.com</a>
              </p>
              <p>You are not required to register/login to browse the site.</p>
              <p>Scenestamps Features:</p>
              <p>
                1. Search : You can directly search for a scene or a source.
              </p>
              <p>
                2. Upload Posts : You can register with your google account,
                login and start posting right away. Unlike other sites in this
                specific domain, users are allowed to upload posts.
              </p>
              <p>There are two types of posts - scene - source</p>
              <p>
                Source is a movie,tv show, documentary, etc... One source can
                have multiple scenes
              </p>
              <p>While creating a scene post, source can be selected there.</p>
              <p>
                Scene post will have the timestamp fields. There are two types
                of it: - single - one input field of timestamp in which the
                scene happens. - from-to - two input fields, from and to within
                which the scene takes place.
              </p>
              <p>
                3. Share posts : Share feature is available on both source and
                scene posts, with which you can share the post to your favorite
                social media platforms
              </p>
              <p>
                4. Tagging system : You can add tag to the scene posts. You can
                also get all the scenes that has that tag name by clicking on
                it.
              </p>
              <p>
                I think people wanting to create scenes is quite a small
                audience, but I want to make this the best it can possibly be so
                please post any problems or suggestions in the replies or at
                reddit.com/scenestamps.com or message me x.com/gjpx_ if you
                prefer.
              </p>
            </div>
          </section>
        </section>
        <section id="40166099">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/unix/ShellImportanceOfASpace"
              >The importance of an ordinary space in a Unix shell command
              line</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 05:04:51</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40166099"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40165316">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-04-ancient-giant-tortoise-fossils-colombian.html"
              >Ancient giant tortoise fossils found in Colombian Andes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-26 @ 02:20:27</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40165316"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40159557">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/04/25/slim_another_lunar_night/"
              >Japan's Moon lander makes it through another lunar night</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 16:27:42</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40159557"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40156485">
          <h3>
            <a
              class="item"
              href="https://physicsworld.com/a/mixing-water-and-oil-no-surfactants-needed/"
              >Mixing water and oil: no surfactants needed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 12:09:37</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40156485"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40156268">
          <h3>
            <a
              class="item"
              href="https://simonedutto.github.io/2024-04-09/no-ret-no-party"
              >We were wrong, we need a database</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 11:47:10</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40156268"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40154007">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Hayy_ibn_Yaqdhan"
              >Philosophus Autodidactus</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-25 @ 06:06:54</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40154007"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
