<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46950152">
          <h3>
            <a class="item" href="https://livingwage.mit.edu/"
              >MIT Living Wage Calculator</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 19:50:54</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46950152"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46949864">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=Bc0bIpDVEa8"
              >An articulated archer automaton [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 19:32:23</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46949864"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46949642">
          <h3>
            <a
              class="item"
              href="https://www.ferrari.com/en-US/auto/ferrari-luce"
              >Luce: First Electric Ferrari. Designed by LoveFrom</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 19:19:30</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46949642"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46949452">
          <h3>
            <a
              class="item"
              href="https://www.githubstatus.com/incidents/lcw3tg2f6zsd"
              >Another GitHub outage in the same day</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 19:07:25</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46949452"
                  >Comments</a
                ><span class="descendants">: 113</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46949401">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/testing-ads-in-chatgpt/"
              >Testing Ads in ChatGPT</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 19:04:16</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46949401"
                  >Comments</a
                ><span class="descendants">: 229</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46948815">
          <h3>
            <a
              class="item"
              href="https://spitalfieldslife.com/2024/06/20/the-markets-of-old-london-i/"
              >The Markets of Old London (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 18:20:56</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46948815"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46948340">
          <h3>
            <a
              class="item"
              href="https://www.thejournal.ie/readme/bezos-washington-post-trump-6950317-Feb2026/"
              >From watchdogs to mouthpieces: Washington Post and the wreckage
              of legacy media</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 17:48:24</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46948340"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46948273">
          <h3>
            <a
              class="item"
              href="https://jsgroth.dev/blog/posts/gba-audio-interpolation/"
              >Game Boy Advance Audio Interpolation</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 17:44:10</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46948273"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46947777">
          <h3>
            <a
              class="item"
              href="https://research.google/blog/hard-braking-events-as-indicators-of-road-segment-crash-risk/"
              >Hard-braking events as indicators of road segment crash risk</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 17:09:37</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46947777"
                  >Comments</a
                ><span class="descendants">: 187</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46947096">
          <h3>
            <a
              class="item"
              href="https://github.com/jim11662418/ESP8266_WiFi_Analog_Clock"
              >Converting a $3.88 analog clock from Walmart into a ESP8266-based
              Wi-Fi clock</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 16:26:31</span
              ><span class="points-container"
                >Points: <span class="points">322</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46947096"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46946827">
          <h3>
            <a
              class="item"
              href="https://www.githubstatus.com/incidents/54hndjxft5bx"
              >GitHub is down again</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 16:12:19</span
              ><span class="points-container"
                >Points: <span class="points">442</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46946827"
                  >Comments</a
                ><span class="descendants">: 372</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46946401">
          <h3>
            <a
              class="item"
              href="https://explainers.blog/posts/why-is-the-sky-blue/"
              >Why is the sky blue?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 15:39:51</span
              ><span class="points-container"
                >Points: <span class="points">293</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46946401"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46946308">
          <h3>
            <a class="item" href="https://neal.fun/sandboxels/">Sandboxels</a>
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 15:31:09</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46946308"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46946062">
          <h3>
            <a
              class="item"
              href="https://defusedcyber.com/ivanti-epmm-sleeper-shells-403jsp"
              >Sleeper Shells: Attackers Are Planting Dormant Backdoors in
              Ivanti EPMM</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 15:11:07</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46946062"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46945663">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/tech/875309/discord-age-verification-global-roll-out"
              >Discord will require a face scan or ID for full access next
              month</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 14:37:38</span
              ><span class="points-container"
                >Points: <span class="points">753</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46945663"
                  >Comments</a
                ><span class="descendants">: 764</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://discord.com/press-releases/discord-launches-teen-by-default-settings-globally"
                >https://discord.com/press-releases/discord-launches-teen-by-...</a
              >
              <p>
                <a
                  href="https://discord.com/safety/how-discord-is-building-safer-experiences-for-teens"
                  >https://discord.com/safety/how-discord-is-building-safer-exp...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46945641">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/long-sought-proof-tames-some-of-maths-unruliest-equations-20260206/"
              >Long-Sought Proof Tames Some of Math's Unruliest Equations</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 14:36:14</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46945641"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46945497">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/business/media-telecom/senator-says-att-verizon-blocking-release-salt-typhoon-security-assessment-2026-02-03/"
              >AT&amp;amp;T, Verizon blocking release of Salt Typhoon security
              assessment reports</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 14:22:12</span
              ><span class="points-container"
                >Points: <span class="points">241</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46945497"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46945348">
          <h3>
            <a class="item" href="https://codeberg.org/smnx/promethee"
              >UEFI Bindings for JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 14:07:36</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46945348"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46945235">
          <h3>
            <a
              class="item"
              href="https://wingolog.org/archives/2026/02/09/six-thoughts-on-generating-c"
              >Thoughts on Generating C</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 13:54:48</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46945235"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46943568">
          <h3>
            <a class="item" href="https://alltheviews.world"
              >Show HN: Algorithmically finding the longest line of sight on
              Earth</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 10:05:55</span
              ><span class="points-container"
                >Points: <span class="points">340</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46943568"
                  >Comments</a
                ><span class="descendants">: 137</span></span
              >
            </h4>
            <div class="text">
              <p>
                We go into all the details at
                <a href="https://alltheviews.world"
                  >https://alltheviews.world</a
                >
              </p>
              <p>
                And there's an interactive map with over 1 billion longest
                lines, covering the whole world at
                <a href="https://map.alltheviews.world"
                  >https://map.alltheviews.world</a
                >
                Just click on any point and it'll load its longest line of
                sight.
              </p>
              <p>
                Some of you may remember Tom's post[1] from a few months ago
                about how to efficiently pack visibility tiles for computing the
                entire planet. Well now it's done. The compute run itself took
                100s of AMD Turin cores, 100s of GBs of RAM, a few TBs of disk
                and 2 days of constant runtime on multiple machines.
              </p>
              <p>
                If you are interested in the technical details, Ryan and I have
                written extensively about the algorithm and pipeline that got us
                here:
              </p>
              <p>
                * Tom's blog post:
                <a href="https://tombh.co.uk/longest-line-of-sight"
                  >https://tombh.co.uk/longest-line-of-sight</a
                >
              </p>
              <p>
                * Ryan's technical breakdown:
                <a href="https://ryan.berge.rs/posts/total-viewshed-algorithm"
                  >https://ryan.berge.rs/posts/total-viewshed-algorithm</a
                >
              </p>
              <p>
                This was a labor of love and we hope it inspires you both
                technically and naturally, to get you out seeing some of these
                vast views for yourselves!
              </p>
              <p>
                1.
                <a href="https://news.ycombinator.com/item?id=45485227"
                  >https://news.ycombinator.com/item?id=45485227</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46941882">
          <h3>
            <a
              class="item"
              href="https://surfingcomplexity.blog/2026/02/08/nobody-knows-how-the-whole-system-works/"
              >Nobody knows how the whole system works</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-09 @ 05:28:15</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46941882"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46938511">
          <h3>
            <a
              class="item"
              href="https://sandboxspirit.com/blog/art-of-roads-in-games/"
              >Art of Roads in Games</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-08 @ 21:05:24</span
              ><span class="points-container"
                >Points: <span class="points">566</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46938511"
                  >Comments</a
                ><span class="descendants">: 184</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46937696">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=46937696"
              >Ask HN: What are you working on? (February 2026)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-08 @ 19:35:55</span
              ><span class="points-container"
                >Points: <span class="points">237</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46937696"
                  >Comments</a
                ><span class="descendants">: 808</span></span
              >
            </h4>
            <div class="text">
              What are you working on? Any new ideas that you're thinking about?
            </div>
          </section>
        </section>
        <section id="46933955">
          <h3>
            <a class="item" href="https://znah.net/graphs/"
              >Like Game-of-Life, but on Growing Graphs, with WASM and WebGL</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-08 @ 13:18:37</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46933955"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46900472">
          <h3>
            <a
              class="item"
              href="https://github.com/jnidzwetzki/pg-dev-container"
              >Pg-dev-container is a ready-to-run VS Code development container
              for PostgreSQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-05 @ 15:09:45</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46900472"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46897804">
          <h3>
            <a
              class="item"
              href="https://quomodocumque.wordpress.com/2026/02/03/whats-the-entropy-of-a-random-integer/"
              >What's the Entropy of a Random Integer?</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-05 @ 09:47:53</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46897804"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46895089">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/traffic-mimes-of-colombia"
              >The Traffic Mimes of Bogotá</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-05 @ 02:58:50</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46895089"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46885249">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/medieval-monks-wrote-over-a-copy-of-an-ancient-star-catalog-now-a-particle-accelerator-is-revealing-the-long-lost-original-text-180988123/"
              >Medieval Monks Wrote over Ancient Star Catalog – Particle Accel
              Reveals Original</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-04 @ 12:53:23</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46885249"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46878373">
          <h3>
            <a class="item" href="https://www.benkuhn.net/pjm/"
              >How I've run major projects (2025)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 22:38:21</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46878373"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46877291">
          <h3>
            <a class="item" href="https://informationisbeautiful.net/"
              >Information Is Beautiful</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-02-03 @ 21:05:42</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46877291"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
