<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35443084">
          <h3>
            <a
              class="item"
              href="https://news.coincu.com/178458-do-kwon-100-years-40-years-in-south-korea/"
              >Do Kwon Faces 100 Years in Prison in the US and 40 Years in South
              Korea</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 17:28:59</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35443084"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35442947">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35442947"
              >Ask HN: Are you still doing Intermittent Fasting?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 17:20:14</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35442947"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
            <div class="text">
              <p>
                For me its easy for me to avoid eating during the week, much
                more than controlling my eating habits and eating like an
                adult... but then weekend comes and it becomes 10X harder,
                especially if others are eating around me. And then a sunny day
                comes and you "have" go have some barbecue and beer, an
                hamburguer at night, etc.
              </p>
            </div>
          </section>
        </section>
        <section id="35442890">
          <h3>
            <a class="item" href="https://github.com/koki-develop/gat"
              >Show HN: Gat – cat alternative written in Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 17:15:53</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35442890"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35442681">
          <h3>
            <a class="item" href="https://skio.com/careers/"
              >Skio (YC S20) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 17:01:15</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35442642">
          <h3>
            <a
              class="item"
              href="https://www.righto.com/2023/04/8086-microcode-string-operations.html"
              >The microcode and hardware in the 8086 processor that perform
              string operations</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 16:58:21</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35442642"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35442483">
          <h3>
            <a
              class="item"
              href="https://blog.langchain.dev/announcing-our-10m-seed-round-led-by-benchmark/"
              >LangChain Announces 10M Seed Round</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 16:48:00</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35442483"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35442116">
          <h3>
            <a class="item" href="https://github.com/curl/trurl"
              >New tool from curl creator – trurl – for URL parsing and
              manipulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 16:24:22</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35442116"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35442103">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35442103"
              >Launch HN: Type (YC W23) – AI-powered document editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 16:23:52</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35442103"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
            <div class="text">
              <a href="https://type.ai/">https://type.ai/</a>). We're building
              an AI-first document editor that helps you write. It's similar to
              Notion, but focused on building a solid authoring experience.
              <p>
                Here’s a general demo:
                <a href="https://www.youtube.com/watch?v=MpK9PWo0lUw"
                  >https://www.youtube.com/watch?v=MpK9PWo0lUw</a
                >
              </p>
              <p>
                And here’s a demo that includes math and code blocks:
                <a href="https://type.ai/code-math-demos"
                  >https://type.ai/code-math-demos</a
                >
              </p>
              <p>
                There are a lot of AI writing products out now, but we've found
                that most of them treat writing like a one-shot activity that
                should be delegated to AI. We don't think that's the optimal way
                to write. We think of great writing as the product of clear
                thinking, which requires a lot of time tinkering with and
                refining ideas. So we’re building a user-friendly document
                editor that puts the author front and center.
              </p>
              <p>
                As you write in Type, you can press cmd+k to summon simple AI
                commands. Most of our commands are grounded in familiar writing
                primitives (ex. “Write paragraph”) and attempt to understand the
                context of your document.
              </p>
              <p>
                Type supports multiple rich block types, including code and math
                and our commands are able to both interpret and output these
                block types. So if you're writing an introductory essay about
                machine learning, for example, you can use Type's chat feature
                to generate and refine equations and code blocks you'd like to
                include in your document. Once you’re satisfied with what Type
                has generated, you can drag and insert the block anywhere in
                your document (as seen in the demo video above).
              </p>
              <p>
                We’ve also built a "what to write about next" feature in the
                document sidebar that offers suggestions on ideas you may
                consider adding to your document.
              </p>
              <p>
                We’ve built some editor features that aren’t AI-specific but
                which we think make for an enjoyable authoring experience: (1)
                Type is built from the ground up to be offline-first. This means
                most interactions (search, loading documents, etc.) are instant;
                (2) Mobile support as installable PWA; (3) Keyboard shortcuts
                for the most useful commands; (4) Markdown copy/paste support.
              </p>
              <p>
                We designed Type to be most useful for longer-form writing, so
                we encourage you to try it out in the context of something like
                an essay or a technical tutorial. If you try it out at
                <a href="https://type.ai">https://type.ai</a>, we’d love to hear
                what you think. We think Type feels pretty different from other
                AI writing tools that produce fairly shallow content, but would
                love to get your honest feedback on whether we're hitting the
                mark.
              </p>
              <p>
                Each account comes with a free allocation of AI commands, after
                which you can activate a paid plan for unlimited AI usage (you
                can still create and access unlimited docs on the free plan). If
                you'd like some additional free credits, please just drop us a
                note at founders@type.ai and we'll refill your free credits.
              </p>
              <p>
                We'd love your feedback on what feels helpful and what feels
                confusing or missing. Thanks!
              </p>
            </div>
          </section>
        </section>
        <section id="35442001">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-00940-2"
              >‘This shouldn’t be happening’: levels of banned CFCs rising</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 16:17:09</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35442001"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35441997">
          <h3>
            <a
              class="item"
              href="https://www.biorxiv.org/content/10.1101/704080v2"
              >Supercentenarian records show patterns indicative of errors and
              pension fraud</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 16:16:54</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35441997"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35441941">
          <h3>
            <a class="item" href="https://github.com/yagil/ChatIDE"
              >Show HN: ChatIDE – DIY Github Copilot X</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 16:13:17</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35441941"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>
                Launch ChatIDE with a `Cmd + Shift + i`. You bring your own
                OpenAI api key. You can set the system prompt, temperature, and
                max tokens in the extension settings.
              </p>
              <p>
                The extension is currently not aware of any of the files in your
                project, although that might be cool to add later. Use it just
                like you would use ChatGPT in the browser. Feedback and
                contributions more than welcome.
              </p>
            </div>
          </section>
        </section>
        <section id="35441886">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35441886"
              >Ask HN: If Unix is written in C, how did they run C before
              Unix?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 16:10:02</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35441886"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
            <div class="text">
              C is a programming language and Unix is an OS. So, how did they
              run C before Unix era?
            </div>
          </section>
        </section>
        <section id="35441211">
          <h3>
            <a
              class="item"
              href="https://www.businessinsider.com/charlie-javice-frank-criminal-charges-financial-fraud-jpmorgan-chase-2023-1"
              >Frank founder allegedly defrauded JPMorgan out of $175M hit with
              federal charges</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 15:27:33</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35441211"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35441180">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35441180"
              >Ask HN: Courses/textbook recommendations for studying
              robotics?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 15:25:36</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35441180"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                I am studying robotics and exoskeletons as a hobby. Can HN
                please recommend high quality resources for self study?
              </p>
            </div>
          </section>
        </section>
        <section id="35440608">
          <h3>
            <a
              class="item"
              href="https://restofworld.org/2023/india-sound-boxes-paytm-phonepe/"
              >Tiny, cheap smart speakers unlocked the rise of digital payments
              in India</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 14:53:48</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35440608"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35440590">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2010.05418"
              >Achilles Heels for AGI/ASI via Decision Theoretic Adversaries</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 14:52:33</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35440590"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35440552">
          <h3>
            <a class="item" href="https://github.com/e2b-dev/e2b"
              >Show HN: We are building an open-source IDE powered by AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 14:50:33</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35440552"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35440348">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35440348"
              >Tell HN: The ratio of wants-to-be-hired to is-hiring is at a
              record high 0.94</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 14:38:06</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35440348"
                  >Comments</a
                ><span class="descendants">: 118</span></span
              >
            </h4>
            <div class="text">
              <p>
                A year ago it was 0.23. Here's a plot with the data from the
                past couple of years - https://pasteboard.co/tjZd0PgTI8GK.png
              </p>
              <p>(posting this about a day after the April thread opened)</p>
            </div>
          </section>
        </section>
        <section id="35439673">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/books/2023/apr/04/amazon-to-close-book-depository-online-shop"
              >Amazon to close Book Depository online shop</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 13:55:35</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35439673"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35439326">
          <h3>
            <a
              class="item"
              href="https://staceyoniot.com/why-tinyml-is-still-so-hard-to-get-excited-about/"
              >Why TinyML is still so hard to get excited about</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 13:34:29</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35439326"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35438068">
          <h3>
            <a class="item" href="https://taylor.town/-10x"
              >How to be a -10x Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 11:42:33</span
              ><span class="points-container"
                >Points: <span class="points">456</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35438068"
                  >Comments</a
                ><span class="descendants">: 301</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35437254">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/87108d74-b4fe-4271-bdfb-7828ba2ea351"
              >We need a more sophisticated debate about AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 09:52:57</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35437254"
                  >Comments</a
                ><span class="descendants">: 235</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35437136">
          <h3>
            <a
              class="item"
              href="https://twitter.com/AkiyoshiKitaoka/status/1642871991932944385"
              >Sugihara's Dog</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 09:35:16</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35437136"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35437065">
          <h3>
            <a
              class="item"
              href="http://lushprojects.com/circuitjs/circuitjs.html"
              >Circuit.js – Electronic circuit simulator on the web</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 09:21:01</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35437065"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35436224">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2010.03344"
              >Orthogonal Time-Frequency Space Modulation: A Promising
              Next-Generation Waveform (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 07:19:36</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35436224"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35436154">
          <h3>
            <a class="item" href="https://totemmaker.net/"
              >Totem construction system with cuttable parts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 07:10:48</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35436154"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35435811">
          <h3>
            <a
              class="item"
              href="https://wordsandbuttons.online/you_dont_have_to_learn_assembly_to_read_disassembly.html"
              >Even if you can't write assembly, you can read disassembly</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 06:24:06</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35435811"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35434768">
          <h3>
            <a class="item" href="https://www.vinylrecorder.com/stereo.html"
              >How to pack a stereo signal in one record groove</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 03:43:47</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35434768"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35432918">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2023/04/protons-mass-radius-is-apparently-shorter-than-its-charge-radius/"
              >Proton’s mass radius is apparently shorter than its charge
              radius</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 23:33:03</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35432918"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35432206">
          <h3>
            <a
              class="item"
              href="https://petapixel.com/2023/04/03/photographer-captures-ultra-rare-red-ring-of-light-over-italy/"
              >Photographer Captures Ultra-Rare Red Ring of Light Over Italy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 22:29:20</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35432206"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
