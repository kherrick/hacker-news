<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44322153">
          <h3>
            <a
              class="item"
              href="https://smoothbrains.net/posts/2025-06-15-estrogen.html"
              >Estrogen: A Trip Report</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 20:15:15</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44322153"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44321672">
          <h3>
            <a
              class="item"
              href="https://zhihaojia.medium.com/compiling-llms-into-a-megakernel-a-path-to-low-latency-inference-cf7840913c17"
              >Compiling LLMs into a MegaKernel: A Path to Low-Latency
              Inference</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 19:20:54</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44321672"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44320851">
          <h3>
            <a
              class="item"
              href="https://texashighways.com/travel-news/the-history-of-juneteenth-in-photos/"
              >Juneteenth in Photos</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 17:41:59</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44320851"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44320772">
          <h3>
            <a class="item" href="https://github.com/featureform/enrichmcp"
              >Show HN: EnrichMCP – A Python ORM for Agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 17:32:21</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44320772"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                EnrichMCP is built on top of [MCP][2] and acts like an ORM, but
                for agents instead of humans. You define your data model using
                SQLAlchemy, APIs, or custom logic, and EnrichMCP turns it into a
                type-safe, introspectable interface that agents can discover,
                traverse, and invoke.
              </p>
              <p>
                It auto-generates tools from your models, validates all I/O with
                Pydantic, handles relationships, and supports schema discovery.
                Agents can go from user → orders → product naturally, just like
                a developer navigating an ORM.
              </p>
              <p>
                We use this internally to let agents query production systems,
                call APIs, apply business logic, and even integrate ML models.
                It works out of the box with SQLAlchemy and is easy to extend to
                any data source.
              </p>
              <p>
                If you're building agentic systems or anything AI-native, I'd
                love your feedback. Code and docs are here:
                <a href="https://github.com/featureform/enrichmcp"
                  >https://github.com/featureform/enrichmcp</a
                >. Happy to answer any questions.
              </p>
              <p>
                [1]:
                <a href="https://github.com/featureform/enrichmcp"
                  >https://github.com/featureform/enrichmcp</a
                >
              </p>
              <p>
                [2]:
                <a href="https://modelcontextprotocol.io/introduction"
                  >https://modelcontextprotocol.io/introduction</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44320747">
          <h3>
            <a
              class="item"
              href="https://krzysckh.org/b/Homegrown-closures-for-uxn.html"
              >Homegrown Closures for Uxn</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 17:29:35</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44320747"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44320497">
          <h3>
            <a
              class="item"
              href="https://howdnssec.works/why-do-we-need-dnssec/"
              >Why do we need DNSSEC?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 17:03:33</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44320497"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44320460">
          <h3>
            <a
              class="item"
              href="https://flowspace.applytojob.com/apply/6oDtY2q6E9/Software-Engineer-II"
              >Flowspace (YC S17) Is Hiring Software Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 17:00:39</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44320001">
          <h3>
            <a
              class="item"
              href="https://thescoop.org/archives/2025/06/09/how-openelections-uses-llms/index.html"
              >How OpenElections uses LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 16:11:46</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44320001"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44319585">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/sciadv.adv4951"
              >Geochronology supports LGM age for human tracks at White Sands,
              New Mexico</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 15:27:44</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44319585"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://arstechnica.com/science/2025/06/study-confirms-white-sands-footprints-are-23000-years-old/"
                >https://arstechnica.com/science/2025/06/study-confirms-white...</a
              >
            </div>
          </section>
        </section>
        <section id="44319144">
          <h3>
            <a
              class="item"
              href="http://marc-b-reynolds.github.io/math/2019/02/06/Posit1.html"
              >Posit floating point numbers: thin triangles and other tricks
              (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 14:42:03</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44319144"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44318874">
          <h3>
            <a class="item" href="https://erikdemaine.org/curved/"
              >Curved-Crease Sculpture</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 14:13:15</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44318874"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">https://erikdemaine.org/curved/history/</div>
          </section>
        </section>
        <section id="44318588">
          <h3>
            <a class="item" href="https://github.com/krustowski/rou2exOS"
              >Show HN: A DOS-like hobby OS written in Rust and x86 assembly</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 13:38:57</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44318588"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              <p>
                <a href="https://blog.vxn.dev/rou2exos-rusted-edition"
                  >https://blog.vxn.dev/rou2exos-rusted-edition</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44318305">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/news/letter-from-the-southwest/the-scheme-that-broke-the-texas-lottery"
              >The Scheme That Broke the Texas Lottery</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 13:01:16</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44318305"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44317825">
          <h3>
            <a
              class="item"
              href="https://matduggan.com/what-would-a-kubernetes-2-0-look-like/"
              >What would a Kubernetes 2.0 look like</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 12:00:54</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44317825"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44317180">
          <h3>
            <a class="item" href="https://scottaaronson.blog/?p=8908"
              >Guess I'm a Rationalist Now</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 10:22:06</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44317180"
                  >Comments</a
                ><span class="descendants">: 484</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44317012">
          <h3>
            <a
              class="item"
              href="https://github.com/Maciek-roboblog/Claude-Code-Usage-Monitor"
              >Show HN: Claude Code Usage Monitor – real-time tracker to dodge
              usage cut-offs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 09:46:43</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44317012"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
            <div class="text">
              <p>Streams your prompt + completion usage in real time</p>
              <p>Predicts whether you’ll hit the cap before the session ends</p>
              <p>Runs 100 % locally (no auth, no server)</p>
              <p>
                Presets for Pro, Max × 5, Max × 20 — tweak a JSON if your plan’s
                different
              </p>
              <p>
                GitHub:
                <a
                  href="https://github.com/Maciek-roboblog/Claude-Code-Usage-Monitor"
                  >https://github.com/Maciek-roboblog/Claude-Code-Usage-Monitor</a
                >
              </p>
              <p>
                It’s already spared me a few “why did my run just stop?”
                moments, but it’s still rough around the edges. Feedback, bug
                reports, and PRs welcome!
              </p>
            </div>
          </section>
        </section>
        <section id="44316909">
          <h3>
            <a
              class="item"
              href="https://www.codelink.io/blog/post/ai-system-development-llm-rag-ai-workflow-agent"
              >From LLM to AI Agent: What's the Real Journey Behind AI System
              Development?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 09:29:28</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44316909"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44315321">
          <h3>
            <a class="item" href="https://elliptic-curves.art/"
              >Elliptic Curves as Art</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 04:02:27</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44315321"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44314423">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=LCEmiRjPEtQ"
              >Andrej Karpathy: Software in the era of AI [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 00:33:21</span
              ><span class="points-container"
                >Points: <span class="points">1004</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44314423"
                  >Comments</a
                ><span class="descendants">: 558</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44314085">
          <h3>
            <a class="item" href="https://github.com/psviderski/unregistry"
              >Show HN: Unregistry – “docker push” directly to servers without a
              registry</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-18 @ 23:17:10</span
              ><span class="points-container"
                >Points: <span class="points">591</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44314085"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
            <div class="text">
              <p>
                In certain cases, using a full-fledged external (or even local)
                registry is annoying overhead. And if you think about it,
                there's already a form of registry present on any of your
                Docker-enabled hosts — the Docker's own image storage.
              </p>
              <p>
                So I built Unregistry [1] that exposes Docker's (containerd)
                image storage through a standard registry API. It adds a `docker
                pussh` command that pushes images directly to remote Docker
                daemons over SSH. It transfers only the missing layers, making
                it fast and efficient.
              </p>
              <p></p>
              <pre><code>  docker pussh myapp:latest user@server
</code></pre>
              Under the hood, it starts a temporary unregistry container on the
              remote host, pushes to it through an SSH tunnel, and cleans up
              when done.
              <p>
                I've built it as a byproduct while working on Uncloud [2], a
                tool for deploying containers across a network of Docker hosts,
                and figured it'd be useful as a standalone project.
              </p>
              <p>Would love to hear your thoughts and use cases!</p>
              <p>
                [1]:
                <a href="https://github.com/psviderski/unregistry"
                  >https://github.com/psviderski/unregistry</a
                >
              </p>
              <p>
                [2]:
                <a href="https://github.com/psviderski/uncloud"
                  >https://github.com/psviderski/uncloud</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44310944">
          <h3>
            <a
              class="item"
              href="https://terminalbytes.com/iphone-8-solar-powered-vision-ocr-server/"
              >My iPhone 8 Refuses to Die: Now It's a Solar-Powered Vision OCR
              Server</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-18 @ 15:49:53</span
              ><span class="points-container"
                >Points: <span class="points">414</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44310944"
                  >Comments</a
                ><span class="descendants">: 176</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44301875">
          <h3>
            <a class="item" href="https://catern.com/private.html"
              >Public/protected/private is an unnecessary feature</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-17 @ 17:56:04</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44301875"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44301765">
          <h3>
            <a
              class="item"
              href="https://www.caltech.edu/about/news/star-quakes-and-monster-shock-waves"
              >Star Quakes and Monster Shock Waves</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-17 @ 17:46:40</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44301765"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44299233">
          <h3>
            <a class="item" href="https://uclab.fh-potsdam.de/arete/en"
              >Visual History of the Latin Alphabet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-17 @ 13:51:20</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44299233"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44298087">
          <h3>
            <a
              class="item"
              href="https://www.marginalia.nu/log/a_122_dead_websites/"
              >Finding Dead Websites</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-17 @ 12:03:01</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44298087"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44297761">
          <h3>
            <a class="item" href="https://lucumr.pocoo.org/2025/6/17/measuring/"
              >We Can Just Measure Things</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-17 @ 11:15:25</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44297761"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44297656">
          <h3>
            <a
              class="item"
              href="https://studios.ptilouk.net/little-brats/blog/2024-10-23_netcode.html"
              >Testing a Robust Netcode with Godot</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-17 @ 10:57:09</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44297656"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44291681">
          <h3>
            <a class="item" href="https://trend.fi"
              >Show HN: TrendFi – I built AI trading signals that
              self-optimize</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 17:45:49</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44291681"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <p>
                For the past few years, I've been obsessed with trying to get AI
                to produce accurate trading signals. The main challenges I found
                with AI trading models are lack of consistency, context window
                bottlenecks, hard to backtest, and high cost.
              </p>
              <p>
                Asking ChatGPT "Should I buy Bitcoin today?" doesn't work well
                because the LLM doesnt have a set trading strategy to opperate
                from. In addition, the small context window makes it challenging
                to fit enough historical data into. Not to mention it gets very
                expensive as well.
              </p>
              <p>
                My solution is a hybrid approach. Instead of having the LLM make
                direct predictions, I use AI as the "conductor" in the system
                that has the ability to run a series of backtesting simulations
                on high thread count AMD EPYC servers.
              </p>
              <p>
                The AI then processes the results, identifies optimal parameter
                changes, and can self-optimize after every trade (as needed) to
                adapt to changing market conditions. This setup uses LLMs for
                high-level reasoning and CPU cores for what they do best.
              </p>
              <p>
                I should mention that TrendFi is designed as a trend based
                model. It's not for day trading or catching every small market
                fluctuation. Its goal is to accurately identify major trend
                changes and provide clear alerts for those key moments.
              </p>
              <p>
                Check it out: <a href="https://trend.fi">https://trend.fi</a>
              </p>
              <p>– Michael</p>
            </div>
          </section>
        </section>
        <section id="44287248">
          <h3>
            <a class="item" href="https://strudel.cc/workshop/getting-started/"
              >Getting Started Strudel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 07:02:40</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44287248"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44284908">
          <h3>
            <a
              class="item"
              href="https://mertbulan.com/2025/06/14/munich-from-a-hamburgers-perspective/"
              >Munich from a Hamburger's perspective</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 20:55:25</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44284908"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
