<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45566638">
          <h3>
            <a
              class="item"
              href="https://tech.marksblogg.com/american-solar-farms.html"
              >American Solar Farms</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 10:02:40</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45566638"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45566253">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/business/2025/oct/13/lab-to-fab-are-promises-of-a-graphene-revolution-finally-coming-true"
              >After 2 decades, are promises of a graphene revolution coming
              true?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 08:53:17</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45566253"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45566139">
          <h3>
            <a
              class="item"
              href="https://chezsoi.org/lucas/blog/spotlight-on-pdfly.html"
              >Spotlight on pdfly, the Swiss Army knife for PDF files</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 08:36:33</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45566139"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45566123">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2510.03761"
              >LaTeXpOsEd: A Systematic Analysis of Information Leakage in
              Preprint Archives</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 08:33:34</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45566123"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45565646">
          <h3>
            <a class="item" href="https://http3-explained.haxx.se"
              >HTTP3 Explained</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 07:15:28</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45565646"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45563900">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/history-of-korean-food"
              >For centuries massive meals amazed visitors to Korea (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 01:46:18</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45563900"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45563627">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/10/12/books/john-searle-dead.html"
              >John Searle has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-13 @ 00:57:49</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45563627"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45563161">
          <h3>
            <a class="item" href="https://www.novelty-automation.com/"
              >Novelty Automation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 23:46:55</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45563161"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45562286">
          <h3>
            <a class="item" href="https://dorotac.eu/posts/fosswon/"
              >Free software hasn't won</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 21:51:45</span
              ><span class="points-container"
                >Points: <span class="points">301</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45562286"
                  >Comments</a
                ><span class="descendants">: 332</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45562188">
          <h3>
            <a class="item" href="https://reactos.org/blogs/investigating-wddm/"
              >An initial investigation into WDDM on ReactOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 21:40:43</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45562188"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45562056">
          <h3>
            <a class="item" href="https://maml.dev/"
              >MAML – A new configuration language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 21:24:39</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45562056"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45561672">
          <h3>
            <a class="item" href="https://xenodium.com/introducing-agent-shell"
              >Emacs agent-shell (powered by ACP)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 20:37:16</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45561672"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <a href="https://xenodium.com/agent-shell-0-5-improvements"
                >https://xenodium.com/agent-shell-0-5-improvements</a
              >
            </div>
          </section>
        </section>
        <section id="45561428">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45561428"
              >Ask HN: What are you working on? (October 2025)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 20:09:14</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45561428"
                  >Comments</a
                ><span class="descendants">: 667</span></span
              >
            </h4>
            <div class="text">
              What are you working on? Any new ideas that you're thinking about?
            </div>
          </section>
        </section>
        <section id="45560974">
          <h3>
            <a class="item" href="https://nanochess.org/ecs_basic_2.html"
              >Completing a BASIC language interpreter in 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 19:19:38</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45560974"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45559857">
          <h3>
            <a
              class="item"
              href="https://github.com/chili-chips-ba/wireguard-fpga"
              >Wireguard FPGA</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 17:12:00</span
              ><span class="points-container"
                >Points: <span class="points">545</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45559857"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45559767">
          <h3>
            <a
              class="item"
              href="https://sam-cooper.medium.com/the-country-that-broke-kotlin-84bdd0afb237"
              >A years-long Turkish alphabet bug in the Kotlin compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 17:02:09</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45559767"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45558611">
          <h3>
            <a class="item" href="https://ambisounds.app/"
              >Show HN: I built a simple ambient sound app with no ads or
              subscriptions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 14:49:50</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45558611"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
            <div class="text">
              <p>
                So I made Ambi, a small iOS app with a clean interface and a set
                of freely available ambient sounds — rain, waves, wind, birds,
                that sort of thing. You can mix them, adjust volume levels, and
                just let it play all night or while you work. Everything works
                offline and there are no hidden catches.
              </p>
              <p>
                It’s something I built for myself first, but I figured others
                might find it useful too. Feedback, bugs, and suggestions are
                all welcome.
              </p>
              <p>
                <a
                  href="https://apps.apple.com/app/ambi-white-noise-sleep-sounds/id6753184615"
                  >https://apps.apple.com/app/ambi-white-noise-sleep-sounds/id6...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="45555727">
          <h3>
            <a
              class="item"
              href="https://buttondown.com/hillelwayne/archive/three-ways-formally-verified-code-can-go-wrong-in/"
              >Three ways formally verified code can go wrong in practice</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-12 @ 06:17:52</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45555727"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45529331">
          <h3>
            <a class="item" href="https://3dpaws.comet.ucar.edu"
              >3D-Printed Automatic Weather Station</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-09 @ 15:45:49</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45529331"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45529081">
          <h3>
            <a
              class="item"
              href="https://cceckman.com/writing/keyboard-holders-gen1/"
              >Keyboard Holders, Generation 1</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-09 @ 15:29:31</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45529081"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45525804">
          <h3>
            <a class="item" href="https://micropythonos.com"
              >MicroPythonOS – An Android-like OS for microcontrollers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-09 @ 10:35:40</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45525804"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45517905">
          <h3>
            <a
              class="item"
              href="https://app.sqlai.ai/posts/better-sql-validator/"
              >A better SQL validator and comparison with existing SQL
              validators</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 16:25:40</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45517905"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45515978">
          <h3>
            <a
              class="item"
              href="https://wip.tf/posts/telefonefix-building-babys-first-international-landline/"
              >Show HN: Baby's first international landline</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 13:31:35</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45515978"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
            <div class="text">
              <p>
                As a weekend project, I hacked together a physical phone, a
                Raspberry Pi running Asterisk and Twilio, to let toddlers safely
                make international calls.
              </p>
              <p>
                I’ve documented the setup in this write-up and published the
                code + Ansible playbooks on GitHub so others can replicate it.
              </p>
              <p>
                I built this so kids of expats can easily stay in touch with
                family on other continents.
              </p>
              <p>
                Would love feedback from anyone who’s worked on something
                similar or tries building this themselves!
              </p>
              <p>
                writeup:
                <a
                  href="https://wip.tf/posts/telefonefix-building-babys-first-international-landline/"
                  >https://wip.tf/posts/telefonefix-building-babys-first-intern...</a
                >
                github repos: -
                <a href="https://github.com/nbr23/ansible-role-telefonefix"
                  >https://github.com/nbr23/ansible-role-telefonefix</a
                >
                -
                <a href="https://github.com/nbr23/allo-wed"
                  >https://github.com/nbr23/allo-wed</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="45515597">
          <h3>
            <a class="item" href="https://www.latent.space/p/tiny"
              >The Tiny Teams Playbook</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 12:50:32</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45515597"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45513408">
          <h3>
            <a class="item" href="https://pglinter.readthedocs.io/en/latest/"
              >Database Linting and Analysis for PostgreSQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 08:09:07</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45513408"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45512962">
          <h3>
            <a class="item" href="https://github.com/pytauri/pytauri"
              >Tauri binding for Python through Pyo3</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-08 @ 06:58:00</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45512962"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45507444">
          <h3>
            <a
              class="item"
              href="https://colincogle.name/blog/byo-weather-station/"
              >Putting a Dumb Weather Station on the Internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 19:11:04</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45507444"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45506397">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Jeffrey_Hudson"
              >Jeffrey Hudson the Court Dwarf of the English Queen Henrietta
              Maria of France</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 17:51:46</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45506397"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45502503">
          <h3>
            <a
              class="item"
              href="https://norwegianscitechnews.com/2025/10/making-regular-gps-ultra-precise/"
              >Making regular GPS ultra-precise</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-07 @ 12:54:27</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45502503"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45487232">
          <h3>
            <a
              class="item"
              href="https://www.thisiscolossal.com/2025/09/2025-bird-photographer-of-the-year-contest/"
              >Bird photographer of the year gives a lesson in planning and
              patience</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 02:53:17</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45487232"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
