<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43944167">
          <h3>
            <a class="item" href="http://astria.tacc.utexas.edu/AstriaGraph/"
              >Cosmos 482 Descent Craft tracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 08:45:59</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43944167"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43944154">
          <h3>
            <a
              class="item"
              href="https://healthimaging.com/topics/medical-imaging/computed-tomography-ct/ct-scans-dont-lie-cigarettes-are-harder-lungs-marijuana"
              >CT scans show cigarettes are harder on the lungs than
              marijuana</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 08:43:27</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43944154"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43944016">
          <h3>
            <a
              class="item"
              href="https://meta.stackexchange.com/questions/408823/after-16-years-we-re-renewing-the-brand"
              >After 16 years, we're renewing the StackOverflow Brand</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 08:12:05</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43944016"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43943984">
          <h3>
            <a class="item" href="https://www.in-ulm.de/~mascheck/various/ash/"
              >Ash (Almquist Shell) Variants</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 08:01:30</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43943984"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43943737">
          <h3>
            <a
              class="item"
              href="https://fakehistoryhunter.net/2022/07/26/not-a-3-year-old-chimney-sweep/"
              >Not a three-year-old chimney sweep (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 06:58:15</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43943737"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43943652">
          <h3>
            <a
              class="item"
              href="https://bonfirenetworks.org/posts/slow_software_for_a_burning_world/"
              >Slow Software for a Burning World</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 06:38:56</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43943652"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43943610">
          <h3>
            <a
              class="item"
              href="https://michael.stapelberg.ch/posts/2025-05-10-grobi-x11-monitor-autoconfig/"
              >In praise of grobi for auto-configuring X11 monitors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 06:28:17</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43943610"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43943236">
          <h3>
            <a class="item" href="https://github.com/marcboeker/gmail-to-sqlite"
              >Gmail to SQLite</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 04:25:43</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43943236"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43943047">
          <h3>
            <a
              class="item"
              href="https://github.com/ggml-org/llama.cpp/blob/master/docs/multimodal.md"
              >Vision Now Available in Llama.cpp</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 03:39:46</span
              ><span class="points-container"
                >Points: <span class="points">279</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43943047"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43942881">
          <h3>
            <a class="item" href="https://tixy.land"
              >A simple 16x16 dot animation from simple math rules</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 02:56:38</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43942881"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43942318">
          <h3>
            <a
              class="item"
              href="https://realitystudio.org/bibliographic-bunker/charles-bukowski-william-burroughs-and-the-computer/"
              >Charles Bukowski, William Burroughs, and the Computer (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 00:45:47</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43942318"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43942279">
          <h3>
            <a class="item" href="https://brandonli.net/semisim/"
              >Brandon's Semiconductor Simulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 00:37:48</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43942279"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43942149">
          <h3>
            <a class="item" href="https://madebyevan.com/webgl-water/"
              >WebGL Water (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 00:13:38</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43942149"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43941862">
          <h3>
            <a class="item" href="https://plainbudget.com/"
              >PlainBudget – Minimalist Plain Text Budgeting</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 23:22:20</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43941862"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43941598">
          <h3>
            <a class="item" href="https://fleursdumal.org">Fleurs du Mal</a>
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 22:42:05</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43941598"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43940747">
          <h3>
            <a
              class="item"
              href="https://theorthagonist.substack.com/p/why-reading-business-books-is-a-waste"
              >Business books are entertainment, not strategic tools</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 20:51:45</span
              ><span class="points-container"
                >Points: <span class="points">359</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43940747"
                  >Comments</a
                ><span class="descendants">: 154</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43940539">
          <h3>
            <a
              class="item"
              href="https://www.hackingwithswift.com/articles/277/whats-new-in-swift-6-2"
              >What’s new in Swift 6.2</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 20:20:52</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43940539"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43938607">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43938607"
              >Launch HN: Nao Labs (YC X25) – Cursor for Data</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 16:28:28</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43938607"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
            <div class="text">
              <a href="https://getnao.io/">https://getnao.io/</a>). We just
              launched nao, an AI code editor to work with data: a local editor,
              directly connected with your data warehouse, and powered by an AI
              copilot with built-in context of your data schema and
              data-specific tools.
              <p>
                See our demo here:
                <a href="https://www.youtube.com/watch?v=QmG6X-5ftZU"
                  >https://www.youtube.com/watch?v=QmG6X-5ftZU</a
                >
              </p>
              <p>
                Writing code with LLMs is the new normal in software
                engineering. But not when it comes to manipulating data. Tools
                like Cursor don’t interact natively with data warehouses — they
                autocomplete SQL blindly, not knowing your data schema. Most of
                us are still juggling multiple tools: writing code in Cursor,
                checking results in the warehouse console, troubleshooting with
                an observability tool, and verifying in BI tool no dashboard
                broke.
              </p>
              <p>
                When you want to write code on data with LLMs, you don’t care
                much about the code, you care about the data output. You need a
                tool that helps you write code relevant for your data, lets you
                visualize its impact on the output, and quality check it for
                you.
              </p>
              <p>
                Christophe and I have each spent 10 years in data — Christophe
                was a data engineer and has built data platforms for dozens of
                orgs, I was head of data and helped data teams building their
                analytics &amp; data products. We’ve seen how the business asks
                you to ship data fast, while you’re here wondering if this small
                line of code will mistakenly multiply the revenue on your CEO
                dashboard by x5. Which leaves you 2 choices: test extensively
                and ship slow. Not test and ship fast. That’s why we wanted to
                create nao: a tool really adapted to our data work, that would
                allow data teams to ship at business pace.
              </p>
              <p>
                nao is a fork of VS Code, with built-in connectors for BigQuery,
                Snowflake, and Postgres. We built our own AI copilot and tab
                system, gave them a RAG of your data warehouse schemas and of
                your codebase. We added a set of agent tools to query data,
                compare data, understand data tools like dbt, assess the
                downstream impact of code in your whole data lineage.
              </p>
              <p>
                The AI tab and the AI agent write straight away code matching
                your schema, may it be for SQL, python, yaml. It shows you code
                diffs and data diffs side by side, to visualize what your change
                did to the data output. And you can leave the data quality
                checks to the agent: detect missing or duplicated values,
                outliers, anticipate breaking changes downstream or compare dev
                and production data differences.
              </p>
              <p>
                Data teams usually use nao for writing SQL pipelines, often with
                dbt. It helps them create data models, document them, test them,
                while making sure they’re not breaking data lineage and figures
                in the BI. In run mode, they also use it to run some analytics,
                and identify data quality bugs in production. For less technical
                profiles, it’s also a great help to strengthen their code best
                practices. For large teams, it ensures that the code &amp;
                metrics remain well factorized and consistent.
              </p>
              <p>
                Software engineers use nao for the database exploration part:
                write SQL queries with nao tab, explore data schema with the
                agent, and write DDL.
              </p>
              <p>
                Question we often get is: why not just use Cursor and MCPs?
                Cursor has to trigger many MCP calls to get full context of the
                data, while nao has it always available in one RAG. MCPs stay in
                a very enclosed part of Cursor: they don’t bring data context to
                the tab. And they don’t make the UI more adapted to data
                workflows. Besides, nao comes as pre-packaged for data teams:
                they don’t have to set up extensions, install and authenticate
                in MCPs, build CI/CD pipelines. Which means even non-technical
                data teams can have a great developer experience.
              </p>
              <p>
                Our long-term goal is to become the best place to work with
                data. We want to fine-tune our own models for SQL, Python and
                YAML to give the most relevant code suggestions for data. We
                want to enlarge our comprehension of all data stack tools, to
                become the only agnostic editor for any of your data workflow.
              </p>
              <p>
                You can try it here:
                <a href="https://sunshine.getnao.io/releases/"
                  >https://sunshine.getnao.io/releases/</a
                >
                - download nao, sign up for free and start using it. Just for HN
                Launch, you can create a temporary account with a simple
                username if you’d prefer not to use your email. For now, we only
                have Mac version but Linux and Windows are coming.
              </p>
              <p>
                We’d love to hear your feedback — and get your thoughts on how
                we can improve even further the data dev experience!
              </p>
            </div>
          </section>
        </section>
        <section id="43937214">
          <h3>
            <a
              class="item"
              href="https://www.home.cern/news/news/physics/alice-detects-conversion-lead-gold-lhc"
              >ALICE detects the conversion of lead into gold at the LHC</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 14:31:20</span
              ><span class="points-container"
                >Points: <span class="points">558</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43937214"
                  >Comments</a
                ><span class="descendants">: 276</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936884">
          <h3>
            <a class="item" href="https://www.itter.sh/"
              >Itter.sh – Micro-Blogging via Terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 14:02:02</span
              ><span class="points-container"
                >Points: <span class="points">248</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936884"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936592">
          <h3>
            <a class="item" href="https://nietras.com/2025/05/09/sep-0-10-0/"
              >21 GB/s CSV Parsing Using SIMD on AMD 9950X</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 13:38:06</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936592"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936408">
          <h3>
            <a class="item" href="https://nrkno.github.io/sofie-core/"
              >Sofie: open-source web based system for automating live TV news
              production</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 13:18:42</span
              ><span class="points-container"
                >Points: <span class="points">330</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936408"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43935067">
          <h3>
            <a
              class="item"
              href="https://vincents.dev/blog/rust-dependencies-scare-me/?"
              >Rust’s dependencies are starting to worry me</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 09:11:05</span
              ><span class="points-container"
                >Points: <span class="points">319</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43935067"
                  >Comments</a
                ><span class="descendants">: 396</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43930187">
          <h3>
            <a class="item" href="https://rulethepla.net/the-screamer/"
              >The Screamer – A yell-on yell-off light</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-08 @ 19:15:49</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43930187"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43928942">
          <h3>
            <a class="item" href="https://dynomight.substack.com/p/dna"
              >How much information is in DNA?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-08 @ 17:42:33</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43928942"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43926097">
          <h3>
            <a class="item" href="https://www.pagetable.com/?p=1798"
              >6502 Illegal Opcodes in the Siemens PC 100 Assembly Manual</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-08 @ 13:50:38</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43926097"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43916622">
          <h3>
            <a
              class="item"
              href="https://blog.castle.io/detect-and-crash-chromium-bots-with-one-weird-trick-bots-hate-it/"
              >Detect and crash Chromium bots with one weird trick (bots hate
              it)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-07 @ 15:01:46</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43916622"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43914852">
          <h3>
            <a
              class="item"
              href="https://www.stratolaunch.com/news/stratolaunch-successfully-completes-reusable-hypersonic-flight-and-recovery-with-talon-a2-vehicle/"
              >Stratolaunch Successfully Completes Reusable Hypersonic Flight
              and Recovery</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-07 @ 12:35:23</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43914852"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43913705">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-05-private-japanese-lunar-lander-orbit.html"
              >Private Japanese lunar lander enters orbit around moon ahead of a
              June touchdown</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-07 @ 09:31:53</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43913705"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43912618">
          <h3>
            <a class="item" href="https://neal.fun/internet-roadtrip/"
              >Internet Roadtrip: Vote to steer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-07 @ 05:50:15</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43912618"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
