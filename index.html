<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37399873">
          <h3>
            <a
              class="item"
              href="https://www.fast.ai/posts/2023-09-04-learning-jumps/"
              >Can LLMs learn from a single example?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-06 @ 00:40:05</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37399873"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37399809">
          <h3>
            <a
              class="item"
              href="https://www.amny.com/housing/new-york-crackdown-airbnb-begins/"
              >New York’s crackdown on Airbnb began Tuesday</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-06 @ 00:32:50</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37399809"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37399745">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2023/09/experts-fear-crooks-are-cracking-keys-stolen-in-lastpass-breach/"
              >Experts fear crooks are cracking keys stolen in LastPass
              breach</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-06 @ 00:25:57</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37399745"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37398921">
          <h3>
            <a
              class="item"
              href="https://review.firstround.com/the-engineers-guide-to-career-growth-advice-from-my-time-at-stripe-and-facebook"
              >Engineer’s Guide to Career Growth: Advice from My Time at Stripe
              and Facebook</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 22:53:09</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37398921"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37398891">
          <h3>
            <a class="item" href="https://github.com/YavorGIvanov/sam.cpp"
              >Meta's Segment Anything written with C++ / GGML</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 22:49:28</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37398891"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37398317">
          <h3>
            <a
              class="item"
              href="https://www.reutersagency.com/authenticity-poc/"
              >Preserving trust in photojournalism through authentication
              technology</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 21:56:40</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37398317"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37398254">
          <h3>
            <a
              class="item"
              href="https://galenmarchetti.substack.com/p/hashicorp-did-it-backwards"
              >HashiCorp Did It Backwards</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 21:50:54</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37398254"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37397686">
          <h3>
            <a class="item" href="https://www.workatastartup.com/jobs/61922/"
              >Emerge (YC W21) is hiring a lead front end engineer (remote,
              small team)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 21:01:16</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37397405">
          <h3>
            <a
              class="item"
              href="https://community.aws/posts/how-search-uses-chaos-engineering"
              >How Amazon uses chaos engineering to handle 80k requests per
              second</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 20:39:09</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37397405"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37397359">
          <h3>
            <a
              class="item"
              href="https://play.google.com/store/apps/details?id=tech.ula.devstudio&amp;hl=en_US"
              >deVStudio – Runs VS Code on Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 20:36:20</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37397359"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37397323">
          <h3>
            <a
              class="item"
              href="https://bitbytebit.substack.com/p/when-deployments-are-easy-code-becomes"
              >When deployments are easy, code becomes simpler</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 20:33:18</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37397323"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37396479">
          <h3>
            <a class="item" href="https://www.scopeofwork.net/forming-an-edge/"
              >Forming an Edge</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 19:21:59</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37396479"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37395168">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/09/05/sam-altman-backed-startup-aims-to-match-neurodivergent-jobseekers-with-ideal-jobs/"
              >Mentra aims to match neurodivergent jobseekers with jobs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 17:39:08</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37395168"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37395096">
          <h3>
            <a
              class="item"
              href="https://redeem-tomorrow.com/if-you-can-use-open-source-you-can-build-hardware"
              >If you can use open source, you can build hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 17:33:35</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37395096"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37394545">
          <h3>
            <a
              class="item"
              href="https://github.com/AmpereComputing/Steam-on-Ampere"
              >Steam-on-Ampere</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 16:53:14</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37394545"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37394194">
          <h3>
            <a class="item" href="https://github.com/nyaggah/bedframe"
              >Show HN: Bedframe – open-source Browser Extension Development
              framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 16:33:40</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37394194"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37393820">
          <h3>
            <a class="item" href="https://github.com/EmNudge/watlings"
              >Learn WebAssembly by writing small programs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 16:13:09</span
              ><span class="points-container"
                >Points: <span class="points">303</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37393820"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37393099">
          <h3>
            <a class="item" href="https://recipeui.com/"
              >Show HN: Open-source Postman alternative with type safety</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 15:33:34</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37393099"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                We built this because current API tools don’t deal with the fact
                that some APIs are just painful to work with. For us, it’s
                usually error after error as we try to figure out how to
                properly form the first request.
              </p>
              <p>
                We recorded a demo to show you how TypeScript helps us
                autocomplete a request correctly.
                <a href="https://youtu.be/O_Mly_p-g5s"
                  >https://youtu.be/O_Mly_p-g5s</a
                >
              </p>
              <p>
                How does our platform improve the developer experience? The
                analogy is similar to using a statically typed language vs
                dynamically typed. Most API tools are dynamically typed. You’re
                guessing the params and relying on the request to magically work
                at runtime, only for you to go back to stack overflow or the
                docs when it doesn’t.
              </p>
              <p>
                We take the approach of defining parameters and the schema
                first. When you add a new parameter, you need to mention upfront
                if it’s required and what type it is (integer, string, boolean).
                While this can be painful in the beginning, it will save you and
                anyone you share this with the hassle of understanding how this
                API works.
              </p>
              <p>
                Our app is cross-platform on web and desktop. Our desktop app is
                &lt;20mb and built on top of Rust with Tauri, NextJS, and
                Supabase. We open source our code because we want to be
                transparent about how API requests and secrets are handled (all
                local IndexDB).
              </p>
              <p>
                I built the first version of this at Robinhood when my
                colleagues were sharing bash scripts and internal APIs on slack
                to test things. I wanted to make it easier for anyone to use an
                API quickly and made use of our OpenAPI specs to generate a nice
                autocomplete API tool. Soon after, the Options team, then the
                Crypto team, and then the whole eng org at Robinhood adopted
                this tool!
              </p>
              <p>
                Try it out at recipeui.com! Please star us on GitHub if you like
                the product
                <a href="https://github.com/RecipeUI/RecipeUI"
                  >https://github.com/RecipeUI/RecipeUI</a
                >.
              </p>
            </div>
          </section>
        </section>
        <section id="37392676">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37392676"
              >Ask HN: I’m an FCC Commissioner proposing regulation of IoT
              security updates</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 15:07:21</span
              ><span class="points-container"
                >Points: <span class="points">2342</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37392676"
                  >Comments</a
                ><span class="descendants">: 694</span></span
              >
            </h4>
            <div class="text">
              <p>
                As you know, serious vulnerabilities are common in IoT, and it
                often takes too long for these to be patched on end-user
                devices—if the manufacturer even bothers to release an update,
                and if the device was even designed to receive them. Companies
                may stop supporting a device well before consumers have stopped
                using it. The support period is often not communicated at the
                time of sale. And sometimes the end of support is not even
                announced, leaving even informed users unsure whether their
                devices are still safe.
              </p>
              <p>
                I’ve advocated for the FCC to require device manufacturers to
                support their devices with security updates for a reasonable
                amount of time [1]. I can't bring such a proposal to a vote
                since I’m not the chairman of the agency. But I was able to
                convince my colleagues to tentatively support something a little
                more moderate addressing this problem.
              </p>
              <p>
                The FCC recently issued a Notice of Proposed Rulemaking [2] for
                a cybersecurity labeling program for connected devices. If they
                meet certain criteria for the security of their product,
                manufacturers can put an FCC cybersecurity label on it. I fought
                hard for one of these criteria to be the disclosure of how long
                the product will receive security updates. I hope that, besides
                arming consumers with better information, the commitments on
                this label (including the support period) will be legally
                enforceable in contract and tort lawsuits and under other laws.
                You can see my full statement here [3].
              </p>
              <p>
                But it’s too early to declare victory. Many manufacturers oppose
                making any commitments about security updates, even voluntary
                ones. These manufacturers are heavily engaged at the FCC and
                represented by sophisticated regulatory lawyers. The FCC and
                White House are not likely to take a strong stand if they only
                hear the device manufacturer's side of the story.
              </p>
              <p>
                In short, they need to hear from you. You have experienced
                insecure protocols, exposed private keys, and other atrocious
                security. You have seen these problems persist despite ample
                warning. People ask, ‘why aren’t there rules about these
                things?’ This is your chance to get on the record and tell us
                what you think the rules should be. If infosec doesn’t make this
                an issue, the general public will continue falsely assuming that
                everything is fine. But if you get on the record and the
                government fails to act, the evidence of this failure will be
                all over the Internet forever.
              </p>
              <p>
                If you want to influence the process, you have until September
                25th, 2023 (midnight ET) to file comments in the rulemaking
                proceeding.[4] Filing is easy: go to
                <a href="https://www.fcc.gov/ecfs/search/docket-detail/23-239"
                  >https://www.fcc.gov/ecfs/search/docket-detail/23-239</a
                >
                and click to file either an ‘express’ comment (type into a
                textbox) or a ‘standard’ comment (upload a PDF). Either way, the
                FCC is required to consider your arguments. All options are on
                the table, so don’t hold back, but do make your arguments as
                clear as possible, so even lawyers can understand them. If you
                have a qualification (line of work, special degree, years of
                experience, etc.) that would bolster the credibility of your
                official comment, be sure to mention that, but the only
                necessary qualification is being an interested member of the
                public.
              </p>
              <p>
                I’m here to listen and learn. AMA. Feel free to ask any
                questions about this or related issues, and I’ll answer as many
                as I can. I just ask that we try to stay on the topic of
                security. My legal advisor, Marco Peraza, a security-focused
                software engineer turned cybersecurity lawyer, will be answering
                questions too. I’m open to incorporating your ideas (and even
                being convinced I’m wrong), and I hope that my colleagues at the
                FCC are as well. Thank you!
              </p>
              <p>
                [1]
                <a
                  href="https://www.fcc.gov/document/simington-calls-mandatory-security-updates"
                  >https://www.fcc.gov/document/simington-calls-mandatory-secur...</a
                >
              </p>
              <p>
                [2]
                <a
                  href="https://www.fcc.gov/document/fcc-proposes-cybersecurity-labeling-program-smart-devices"
                  >https://www.fcc.gov/document/fcc-proposes-cybersecurity-labe...</a
                >
              </p>
              <p>
                [3]
                <a
                  href="https://www.fcc.gov/document/fcc-proposes-cybersecurity-labeling-program-smart-devices/simington-statement"
                  >https://www.fcc.gov/document/fcc-proposes-cybersecurity-labe...</a
                >
              </p>
              <p>
                [4] If your comments are purely in response to arguments made in
                other comments, you have an extra 15 days, until October 10,
                2023.
              </p>
            </div>
          </section>
        </section>
        <section id="37392581">
          <h3>
            <a class="item" href="https://github.com/opentffoundation/opentf"
              >OpenTF repository is now public</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 15:00:30</span
              ><span class="points-container"
                >Points: <span class="points">414</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37392581"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37391848">
          <h3>
            <a class="item" href="https://github.com/measuredco/puck"
              >Show HN: Puck – Open-source visual editor for React</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 14:08:34</span
              ><span class="points-container"
                >Points: <span class="points">359</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37391848"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been dipping in and out of this problem space for the last
                few years with many of my clients.
              </p>
              <p>
                Puck sits somewhere between an old-school WYSIWYG-powered CMS
                and headless one, allowing content teams to author content using
                real React components.
              </p>
              <p>
                Traditional CMS solutions were flexible but often resulted in
                page that completely broke the brand guidelines. Headless CMS
                solutions are a fantastic way of controlling brand by
                restricting UI changes to developers, but makes layout changes
                restrictive and slow as developers often need to get involved.
              </p>
              <p>
                Puck provides a visual editor for React that can sit on top of
                your existing headless CMS (or act as standalone). We've been
                dog-fooding it on a few pages at
                <a href="https://measured.co">https://measured.co</a> and on
                <a href="https://wellpaid.io">https://wellpaid.io</a>. So far,
                so good
              </p>
              <p>
                The API is built for React, which allows FE devs to quickly
                integrate their existing component and add some form fields for
                author input, or connect it to a headless CMS of choice.
              </p>
              <p>
                It's open-source under MIT, and pairs nicely with Next.js (check
                out the demo application). Next in the pipeline: support for
                multi-column layouts, richer demos, new plugins.
              </p>
              <p>Looking forward to hearing your comments!</p>
            </div>
          </section>
        </section>
        <section id="37391161">
          <h3>
            <a
              class="item"
              href="https://nostarch.com/learn-physics-functional-programming"
              >Learn Physics with Functional Programming</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 13:13:34</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37391161"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37390184">
          <h3>
            <a class="item" href="https://github.com/deadbeefsociety/sshfs"
              >A currently maintained fork of SSHFS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 11:04:51</span
              ><span class="points-container"
                >Points: <span class="points">289</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37390184"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37389361">
          <h3>
            <a
              class="item"
              href="https://nhigham.com/2023/09/05/what-is-a-flop/"
              >What is a flop?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-05 @ 08:50:48</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37389361"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37385447">
          <h3>
            <a
              class="item"
              href="https://martypc.blogspot.com/2023/09/a-test-suite-for-intel-8088.html"
              >A Test Suite for the Intel 8088</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-04 @ 21:49:58</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37385447"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37385038">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/magazine/archive/2023/09/disabled-children-institutionalization-history/674763/"
              >The Ones We Sent Away</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-04 @ 21:03:34</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37385038"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37381019">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=gplA6pq9cOs"
              >The last few polio survivors: Last of the iron lungs (2017)
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-04 @ 14:50:45</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37381019"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37377529">
          <h3>
            <a class="item" href="https://bintracker.org/"
              >Bintracker: A Chiptune Audio Workstation for the 21st Century</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-04 @ 05:53:25</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37377529"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37369547">
          <h3>
            <a class="item" href="https://jeremykun.com/proof-gallery/"
              >Proof Gallery</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-03 @ 11:31:51</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37369547"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37364230">
          <h3>
            <a class="item" href="https://www.patreon.com/posts/78074244"
              >Time to preserve those floppy disks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-02 @ 18:38:13</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37364230"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
