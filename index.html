<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44488107">
          <h3>
            <a class="item" href="https://deno.com/blog/v2.4">Deno 2.4</a>
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 08:44:26</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44488107"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44488072">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/ae920241-597e-49d9-a4b9-bfdfa9deabb6"
              >Poland's clean energy usage overtakes coal for first time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 08:40:00</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44488072"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44486541">
          <h3>
            <a
              class="item"
              href="https://chipinsights.substack.com/p/the-era-of-full-stack-chip-designers"
              >The era of full stack chip designers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 03:41:32</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44486541"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44486235">
          <h3>
            <a
              class="item"
              href="https://oda.uni-obuda.hu/bitstream/handle/20.500.14044/10350/Gabor_S_Becker_ertekezes.pdf"
              >High Performance Image Sensor Processing Using FPGAs [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 02:36:57</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44486235"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44485649">
          <h3>
            <a class="item" href="https://github.com/JFryy/systemd-lsp"
              >Show HN: A Language Server Implementation for SystemD Unit
              Files</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 00:57:25</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44485649"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              A Language Server Protocol (LSP) implementation for systemd unit
              files, providing editing support with syntax highlighting,
              diagnostics, autocompletion, and documentation made with rust.
            </div>
          </section>
        </section>
        <section id="44485342">
          <h3>
            <a class="item" href="https://github.com/jackjackbits/bitchat"
              >Bitchat – A decentralized messaging app that works over Bluetooth
              mesh networks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 00:05:46</span
              ><span class="points-container"
                >Points: <span class="points">392</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44485342"
                  >Comments</a
                ><span class="descendants">: 170</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44485336">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=uq0pJmd7GAA"
              >There's a COMPUTER inside my DS flashcart [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 00:04:36</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44485336"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44485241">
          <h3>
            <a
              class="item"
              href="https://www.folklore.org/Swedish_Campground.html"
              >Swedish Campground (2004)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 23:49:52</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44485241"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44484688">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/p/intels-lion-cove-p-core-and-gaming"
              >Intel's Lion Cove P-Core and Gaming Workloads</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 22:27:39</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44484688"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44484682">
          <h3>
            <a
              class="item"
              href="http://addxorrol.blogspot.com/2025/07/a-non-anthropomorphized-view-of-llms.html"
              >A non-anthropomorphized view of LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 22:26:44</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44484682"
                  >Comments</a
                ><span class="descendants">: 184</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44484595">
          <h3>
            <a
              class="item"
              href="https://www.freyaindia.co.uk/p/nobody-has-a-personality-anymore"
              >Nobody has a personality anymore: we are products with labels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 22:16:37</span
              ><span class="points-container"
                >Points: <span class="points">413</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44484595"
                  >Comments</a
                ><span class="descendants">: 321</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44484363">
          <h3>
            <a
              class="item"
              href="https://fractalfir.github.io/generated_html/cg_gcc_bootstrap.html"
              >Building the Rust Compiler with GCC</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 21:46:02</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44484363"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44484207">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2504.18412"
              >LLMs should not replace therapists</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 21:27:28</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44484207"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44484137">
          <h3>
            <a
              class="item"
              href="https://www.deadlanguagesociety.com/p/why-english-doesnt-use-accents"
              >Why English doesn't use accents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 21:18:26</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44484137"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44484074">
          <h3>
            <a class="item" href="https://www.crypto101.io/"
              >Crypto 101 – Introductory course on cryptography</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 21:09:42</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44484074"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44484026">
          <h3>
            <a
              class="item"
              href="https://remark.ing/rob/rob/Thesis-interesting-work-ie"
              >Thesis: Interesting work is less amenable to the use of AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 21:01:51</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44484026"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44483530">
          <h3>
            <a class="item" href="https://github.com/MrLesk/Backlog.md"
              >Backlog.md – Markdown‑native Task Manager and Kanban visualizer
              for any Git repo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 19:55:30</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44483530"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44483485">
          <h3>
            <a
              class="item"
              href="https://github.com/BlueFalconHD/apple_generative_model_safety_decrypted"
              >I extracted the safety filters from Apple Intelligence models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 19:50:02</span
              ><span class="points-container"
                >Points: <span class="points">411</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44483485"
                  >Comments</a
                ><span class="descendants">: 282</span></span
              >
            </h4>
            <div class="text">
              I managed to reverse engineer the encryption (refered to as
              “Obfuscation” in the framework) responsible for managing the
              safety filters of Apple Intelligence models. I have extracted them
              into a repository. I encourage you to take a look around.
            </div>
          </section>
        </section>
        <section id="44482965">
          <h3>
            <a class="item" href="https://alpha.lisagui.com/"
              >Show HN: I wrote a "web OS" based on the Apple Lisa's UI, with
              1-bit graphics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 18:32:55</span
              ><span class="points-container"
                >Points: <span class="points">350</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44482965"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
            <div class="text">
              <a href="https://lisagui.com/info.html"
                >https://lisagui.com/info.html</a
              >
              <p>
                This is a web OS I wrote in vanilla JS that looks like the Apple
                Lisa Office System (1983-85), with other contemporaneous
                influences and additional improvements and features. It's
                currently in alpha and isn't remotely bug free. I had been
                holding off on posting this here until it was somewhat
                presentable and useful. Please note; the Lisa conforms more
                literally to the desktop metaphor than most modern GUIs - some
                of the important differences are mentioned in the readme.
              </p>
              <p>
                This is a complete recreation of the UI in JS; it all renders to
                a single canvas element. It's not a CSS theme, and not an
                emulator ported to JS. None of the code is written by Apple.
                I'll be happy to elaborate more in the comments, but the short
                version is the entire UI is defined outside the DOM using JS
                objects. Thus, every interface element - menus, windows,
                controls, and even typefaces - was recreated from scratch. There
                are no font files - I wrote my own typesetting system, which
                supports combining multiple text styles and generates new glyph
                variants on the fly.
              </p>
              <p>
                Many of the technical decisions I made were motivated by a
                desire to have this look the same in every browser. That's
                harder to do with the DOM and CSS, and why I moved as much logic
                as I could to JS. Also, the only part of the project outside of
                vanilla JS and standard web APIs is the Gulp toolkit, which I'm
                using as a minification/build tool. No vibe coding was used to
                make this!
              </p>
              <p>
                This is based on a UI from the 80s, and won't work well on your
                phone. If you insist on running it that way, turn on trackpad
                mode in the touchscreen settings panel of the preferences app.
                For best results, install it as a PWA (add it to your home
                screen). Also there are some odd Android bugs; the native
                touchscreen keyboard is currently broken, and there's an issue
                with the cursor when dragging windows.
              </p>
              <p>
                I realize there's not a whole lot to do within LisaGUI right
                now; I've got a big list of additional features and apps I'll be
                adding in the future. I've been working on this project for a
                while, and I'm eager to hear people's feedback and answer
                questions about it.
              </p>
            </div>
          </section>
        </section>
        <section id="44482504">
          <h3>
            <a class="item" href="https://github.com/sst/opencode"
              >Opencode: AI coding agent, built for the terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 17:26:47</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44482504"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44482194">
          <h3>
            <a
              class="item"
              href="https://davidgomes.com/async-queue-interview-ai/"
              >Async Queue – One of my favorite programming interview
              questions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 16:46:01</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44482194"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44481464">
          <h3>
            <a class="item" href="https://thenumb.at/Functions-are-Vectors/"
              >Functions Are Vectors (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 15:18:35</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44481464"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44480223">
          <h3>
            <a
              class="item"
              href="https://shkspr.mobi/blog/2025/07/get-the-location-of-the-iss-using-dns/"
              >Get the location of the ISS using DNS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 12:32:46</span
              ><span class="points-container"
                >Points: <span class="points">288</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44480223"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44467838">
          <h3>
            <a class="item" href="https://github.com/ZaneH/piano-trainer"
              >Show HN: Piano Trainer – Learn piano scales, chords and more
              using MIDI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-04 @ 20:58:53</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44467838"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44463063">
          <h3>
            <a
              class="item"
              href="https://www.engineersneedart.com/blog/almostfired/almostfired.html"
              >The first time I was almost fired from Apple</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-04 @ 09:59:43</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44463063"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44462770">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/clyl1zyv1y2o"
              >Fictional K-pop bands zoom to top of US music charts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-04 @ 09:19:31</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44462770"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44460498">
          <h3>
            <a
              class="item"
              href="https://archaeologymag.com/2025/07/neanderthals-operated-fat-factory-125000-years-ago/"
              >Neanderthals operated prehistoric “fat factory” on German
              lakeshore</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-04 @ 01:45:15</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44460498"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44459877">
          <h3>
            <a
              class="item"
              href="https://eugeneyan.com/writing/uncommon-python/"
              >Uncommon Uses of Python in Commonly Used Libraries (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-03 @ 23:12:07</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44459877"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44458896">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=-HNpim5x-IE"
              >What every programmer should know about how CPUs work [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-03 @ 20:29:45</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44458896"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44456896">
          <h3>
            <a
              class="item"
              href="https://mgorny.pl/articles/portability-of-tar-features.html"
              >Portability of Tar Features</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-03 @ 16:43:40</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44456896"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
