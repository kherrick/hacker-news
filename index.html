<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35436068">
          <h3>
            <a
              class="item"
              href="https://jobs.lever.co/photoroom/01f5cb22-695a-402a-a970-818a6c2d47a9?lever-origin=applied&amp;lever-source%5B%5D=Hacker%20News"
              >PhotoRoom Is Hiring a Senior Back End Engineer (Django, 400GB+
              PSQL DB) in Paris</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 07:00:32</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35435563">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2022-03-15/the-electric-vehicles-we-need-now-are-e-bikes"
              >The Electric Vehicles We Need Now Are E-Bikes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 05:42:54</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35435563"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35435373">
          <h3>
            <a class="item" href="https://www.bbc.co.uk/news/business-65163418"
              >Airport scraps 100ml liquid rule with new scanners</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 05:13:07</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35435373"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35435253">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35435253"
              >Ask HN: Fastest way to turn a Jupyter notebook into a website
              these days?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 04:55:11</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35435253"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
            <div class="text">
              <p>
                Is there an easier way? If I gave you a python script and some
                html what would you use to get it behind a www in the least
                amount of time possible?
              </p>
            </div>
          </section>
        </section>
        <section id="35435186">
          <h3>
            <a
              class="item"
              href="https://awesomekling.github.io/How-SerenityOS-declares-ssize_t/"
              >How SerenityOS declares ssize_t</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 04:45:35</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35435186"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35434790">
          <h3>
            <a class="item" href="https://github.com/nat/openplayground"
              >An LLM playground you can run on your laptop</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 03:46:29</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35434790"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35434374">
          <h3>
            <a class="item" href="https://www.flecs.dev/flecs/"
              >Flecs – A fast entity component system for C and C++</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 02:50:53</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35434374"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35434314">
          <h3>
            <a
              class="item"
              href="https://twitter.com/googledrive/status/1643049029251776515"
              >Google reverses 5M file limit in Google Drive</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 02:43:05</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35434314"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35433982">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41567-023-01993-w"
              >Double-slit time diffraction at optical frequencies</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-04 @ 01:56:23</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35433982"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35432958">
          <h3>
            <a
              class="item"
              href="https://www.onefootprint.com/blog/inside-the-enclave-part-2"
              >Engineering with Enclaves</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 23:36:13</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35432958"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35432243">
          <h3>
            <a
              class="item"
              href="https://op-co.de/blog/posts/hacking_the_nx300/"
              >Hacking the Samsung NX300 'Smart' Camera</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 22:32:46</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35432243"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35431678">
          <h3>
            <a
              class="item"
              href="https://orangejuiceliberationfront.com/how-hypercard-got-its-color-back/"
              >How HyperCard got its color back</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 21:40:47</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35431678"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35431466">
          <h3>
            <a
              class="item"
              href="https://english.elpais.com/science-tech/2023-01-10/if-parrots-can-talk-why-cant-monkeys.html"
              >If parrots can talk, why can’t monkeys?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 21:22:13</span
              ><span class="points-container"
                >Points: <span class="points">189</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35431466"
                  >Comments</a
                ><span class="descendants">: 143</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35431119">
          <h3>
            <a class="item" href="https://github.com/system76/firmware-open"
              >System76 Open Firmware</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 20:52:56</span
              ><span class="points-container"
                >Points: <span class="points">324</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35431119"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35430432">
          <h3>
            <a
              class="item"
              href="https://twitter.com/lmsysorg/status/1642968294998306816"
              >State-of-the-art open-source chatbot, Vicuna-13B, just released
              model weights</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 20:02:51</span
              ><span class="points-container"
                >Points: <span class="points">210</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35430432"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35430188">
          <h3>
            <a
              class="item"
              href="https://haystack.deepset.ai/blog/introducing-haystack-agents"
              >Introducing Agents in Haystack: Make LLMs resolve complex
              tasks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 19:47:26</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35430188"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35429801">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35429801"
              >Ask HN: What lesser-known accessories do you use with your
              computer?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 19:21:34</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35429801"
                  >Comments</a
                ><span class="descendants">: 381</span></span
              >
            </h4>
            <div class="text">
              E.g., any special mouse, keyboard, ring, headset, ... that has
              made a significant impact on your workflow.
            </div>
          </section>
        </section>
        <section id="35428625">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=jZvQzkFcKEM"
              >Stop-Motion Movies Are Animated at Aardman [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 18:08:55</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35428625"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35427343">
          <h3>
            <a class="item" href="https://github.com/hocus-dev/hocus"
              >Show HN: Hocus – self-hosted alternative to GitHub Codespaces
              using Firecracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 17:00:42</span
              ><span class="points-container"
                >Points: <span class="points">241</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35427343"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35426482">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35426482"
              >Launch HN: OutSail (YC W23) – Wingsails to reduce cargo ship fuel
              consumption</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 16:18:48</span
              ><span class="points-container"
                >Points: <span class="points">441</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35426482"
                  >Comments</a
                ><span class="descendants">: 209</span></span
              >
            </h4>
            <div class="text">
              <a href="https://outsailshipping.com/"
                >https://outsailshipping.com/</a
              >). We’re building a sail the size of a 747 that rolls up into a
              shipping container. When deployed, it will generate thrust from
              the wind to reduce the fuel consumption of a cargo ship. An array
              of these devices will reduce fuel consumption on ships by up to
              20%. These sails are easily stowed and removed to cause no
              interference with cargo operations. Here’s a short video showing
              our prototype:
              <a href="https://www.youtube.com/watch?v=VUpVqzpym54"
                >https://www.youtube.com/watch?v=VUpVqzpym54</a
              >.
              <p>
                Sails powered ships for millennia; but then the convenience of
                energy-dense fuels displaced sails. As ship speeds eventually
                exceeded wind speeds, the consensus became that sails had no
                place in shipping and were relegated to hobbyists and sport.
                Fast forward a century and a half, and maritime shipping, like
                all other industries, is facing a reckoning to mitigate the
                greenhouse gasses produced by their activities.
              </p>
              <p>
                The International Maritime Organization (IMO) has introduced new
                regulations which use a vessel’s Carbon Intensity Indicator
                (CII) to grade ships. This grading scale becomes more aggressive
                over time, and any ship with a poor grade must take corrective
                action. The corrective actions can be as non-invasive as
                reducing speed (aka: slow steaming) or as extreme as a retrofit
                to use a different, cleaner fuel source. This costs millions and
                takes a ship out of commission for months, and it’s difficult to
                ensure your (now more expensive) fuel is available at every port
                of call. Ship owners are hedging their bets that slow steaming
                will dominate their future, with ship order books full to
                reflect the increased capacity needed when containers take 20%
                longer to cross the ocean.
              </p>
              <p>
                Or option three. There is sufficient wind on the ocean to power
                the entire shipping industry, if you’re willing to grab it. Wind
                Assisted Ship Propulsion (WASP) devices can be used as a
                corrective action to improve a vessel’s CII rating, without
                reducing ship speed or changing the route. In other words, a
                return of sails.
              </p>
              <p>
                We are hardware engineers with over two decades of experience
                between us, working at Tesla, SpaceX, JPL, Relativity, and some
                startups. The idea for OutSail came from Arpan and Joseph
                getting coffee after work one day. When we asked each other
                “What would you do if you weren’t building satellites?” maritime
                cargo came up from both sides; Arpan from having studied the
                industry for opportunities to reduce emissions, and Joseph from
                a love of hydrodynamics and maybe too many sea-shanties. Bailey
                and Arpan, meanwhile, had been looking at working on bicycling
                infrastructure. What brought the three of us together was
                actually a Dungeons &amp; Dragons game where we realized we made
                a good team! We settled on OutSail as a good fit for our
                hardware hacking mentality, trading in our druids staffs for
                spanners.
              </p>
              <p>
                Aerodynamically, sails are simply vertical wings. Wind blowing
                across the vessel causes the sail to generate lift and drag, and
                the resultant vector has some forward component to pull the ship
                through the water. However, if the wind comes from an angle too
                close to the direction of travel, there is no thrust. As an
                added complication, the sail only sees the <i>relative</i> wind.
                If the ship travels faster, the wind will appear to come from
                closer and closer to the direction of travel, even if the true
                wind is coming from perpendicular to your course! Despite this,
                standard sails can still produce forward thrust as long as the
                wind is at least 20 degrees off from directly in front of the
                vessel. This is how our sails can still save power, even on a
                fast moving vessel.
              </p>
              <p>
                There are many sail technologies out there. A common question we
                get asked is “Are you going to use flettner rotors/suction
                airfoils?”. Both of these technologies use power supplied by the
                ship to increase the lift produced by a surface; rotor-sails
                spin, and suction airfoils…suck? Each of these have a place,
                especially at low vessel speeds. But our customers ask us for a
                solution that works for container ships cruising at the
                relatively high speed of 22kt. At these speeds, the relative
                wind is almost always ahead of you, so lift/drag becomes more
                important. Powered sails suffer from poor lift/drag, both from
                the high induced drag from very high lift coefficients, and
                system losses from drawing on ship’s power. So no we are not
                going with flettner rotors/suction airfoils. While they are the
                new exciting technology on the block, if you factor in their
                power usage and high drag ratio, they are just not as practical
                as a simple sail.
              </p>
              <p>
                So now that we’ve given a general summary of sailing, it’s time
                to explain how a 747 wing will ever fit inside a 9ft tall cargo
                container. It’s simple really: imagine a tape measure. In a tape
                measure a thin, flexible strip of metal is wound into a spiral.
                Then, when the metal is uncoiled, it naturally returns to its
                original shape. That’s exactly how we plan to make our sails.
                The skin of our sail or the inner spars (we haven’t finalized
                our design) will be made of tape measure like material (2mm
                thick steel) and the wing will be able to extend out of the
                cargo container. The video in the first paragraph explains this
                in a bit more detail.
              </p>
              <p>
                By fitting our sail into a cargo container we allow for our
                device to be installed on any cargo ship right at port. Remember
                how we mentioned that some shippers are ordering a lot more
                ships and some ships are getting retrofitted with new fuel?
                Well, shipyards are backed up for the next 5 years. By making a
                device that requires no shipyard to install, not only will we
                drastically outcompete other retrofit WASP companies in terms of
                deployment cost, but we will be the only company with a product
                shippers can put on their ship without a multiple year wait
                time.
              </p>
              <p>
                Do you have any interesting stories around sailing or wind tech?
                We would love to hear your ideas, experiences, and feedback on
                any and all of the above!
              </p>
            </div>
          </section>
        </section>
        <section id="35424807">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35424807"
              >Ask HN: Who is hiring? (April 2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 15:02:02</span
              ><span class="points-container"
                >Points: <span class="points">346</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35424807"
                  >Comments</a
                ><span class="descendants">: 372</span></span
              >
            </h4>
            <div class="text">
              <i>not</i> an option, include ONSITE.
              <p>
                Please only post if you personally are part of the hiring
                company—no recruiting firms or job boards. One post per company.
                If it isn't a household name, explain what your company does.
              </p>
              <p>
                Commenters: please don't reply to job posts to complain about
                something. It's off topic here.
              </p>
              <p>
                Readers: please only email if you are personally interested in
                the job.
              </p>
              <p>
                Searchers: try
                <a href="https://hnhired.fly.dev">https://hnhired.fly.dev</a>,
                <a href="https://kennytilton.github.io/whoishiring/"
                  >https://kennytilton.github.io/whoishiring/</a
                >,
                <a href="https://hnjobs.emilburzo.com"
                  >https://hnjobs.emilburzo.com</a
                >,
                <a href="https://news.ycombinator.com/item?id=10313519"
                  >https://news.ycombinator.com/item?id=10313519</a
                >.
              </p>
              <p>Don't miss these other fine threads:</p>
              <p>
                <i>Who wants to be hired?</i>
                <a href="https://news.ycombinator.com/item?id=35424805"
                  >https://news.ycombinator.com/item?id=35424805</a
                >
              </p>
              <p>
                <i>Freelancer? Seeking freelancer?</i>
                <a href="https://news.ycombinator.com/item?id=35424806"
                  >https://news.ycombinator.com/item?id=35424806</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="35421034">
          <h3>
            <a class="item" href="https://mullvad.net/en/browser"
              >The Mullvad Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 10:11:50</span
              ><span class="points-container"
                >Points: <span class="points">1061</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35421034"
                  >Comments</a
                ><span class="descendants">: 378</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35418933">
          <h3>
            <a class="item" href="https://csvbase.com/blog/3"
              >Parquet: An efficient, binary file format for table data</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 05:34:38</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35418933"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35418718">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/the-economist-reads/2023/03/31/five-non-fiction-graphic-books-on-lives-in-dangerous-locations"
              >Five non-fiction graphic books on lives in dangerous locations</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 04:57:30</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35418718"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35418642">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/from-whistling-arrows-and-trumpeting-elephants-to-battle-cries-and-eerie-horns-ancient-soldiers-used-sound-to-frighten-and-confuse-their-enemies-182116"
              >Ancient soldiers used sound to frighten and confuse their enemies
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 04:42:54</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35418642"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35418336">
          <h3>
            <a
              class="item"
              href="http://web.archive.org/web/20180516153837/http://www.adreca.net/NAND-Flash-Data-Recovery-Cookbook.pdf"
              >NAND Flash Data Recovery Cookbook (2013) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 03:48:24</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35418336"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35418320">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Rational_Dress_Society"
              >Rational Dress Society</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 03:46:08</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35418320"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35418303">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/collection/blights-of-the-bookish"
              >An Essay on Diseases Incidental to Literary and Sedentary Persons
              (1768)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-03 @ 03:42:33</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35418303"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35403975">
          <h3>
            <a
              class="item"
              href="https://yalereview.org/article/pankaj-mishra-remembering-benares-india-romantics-novel"
              >Remembering Benares</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-01 @ 20:55:36</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35403975"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35401895">
          <h3>
            <a
              class="item"
              href="https://www.inverse.com/input/features/tropetrainer-thomas-buchler-torah-software"
              >His software sang the words of God. Then it went silent</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-01 @ 17:03:02</span
              ><span class="points-container"
                >Points: <span class="points">350</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35401895"
                  >Comments</a
                ><span class="descendants">: 160</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
