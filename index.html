<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39328368">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/nvidia-chases-30-billion-custom-chip-market-with-new-unit-sources-2024-02-09/"
              >Nvidia pursues $30B custom chip opportunity with new unit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 17:46:17</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39328368"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39327862">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/patterns"
              >Patterns (YC S21) is hiring to automate analytics with LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 17:00:43</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39327734">
          <h3>
            <a
              class="item"
              href="https://cse.buffalo.edu/~rapaport/howtostudy.html"
              >How to Study (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 16:50:30</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39327734"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39327561">
          <h3>
            <a class="item" href="https://niagaralauncher.app/"
              >Niagara Launcher</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 16:37:38</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39327561"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39327199">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2024/feb/10/fighting-the-smartphone-invasion-the-french-village-that-voted-to-ban-scrolling-in-public"
              >A French village that voted to ban scrolling in public</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 16:06:12</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39327199"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39327192">
          <h3>
            <a class="item" href="https://github.com/djanderson/aho"
              >Aho â€“ a Git implementation in Awk</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 16:05:37</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39327192"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39327113">
          <h3>
            <a
              class="item"
              href="https://github.com/sveltejs/svelte/discussions/10085"
              >Tenets</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 15:57:42</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39327113"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39327028">
          <h3>
            <a class="item" href="https://irrlicht3d.org/index.php?t=1626"
              >Short history of all Windows UI frameworks and libraries</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 15:50:50</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39327028"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39326559">
          <h3>
            <a
              class="item"
              href="https://jacobin.com/2023/11/i-was-illegally-fired-by-amazon-for-speaking-out-about-a-coworkers-death/"
              >I Was Illegally Fired by Amazon for Speaking Out About a
              Coworker's Death (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 14:56:33</span
              ><span class="points-container"
                >Points: <span class="points">477</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39326559"
                  >Comments</a
                ><span class="descendants">: 320</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39326401">
          <h3>
            <a class="item" href="https://nbittich.github.io/adana/"
              >Show HN: Now my pet programming language can run in the
              browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 14:36:17</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39326401"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39326377">
          <h3>
            <a
              class="item"
              href="https://knowablemagazine.org/content/article/health-disease/2024/where-did-bed-bugs-come-from-how-to-get-rid-of-them"
              >Getting rid of bed bugs: trickier than ever</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 14:33:17</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39326377"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39326201">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2024/02/09/ai-might-be-reading-your-slack-teams-messages-using-tech-from-aware.html"
              >Walmart, Delta, and Starbucks are using AI to monitor employee
              messages</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 14:06:31</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39326201"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39325983">
          <h3>
            <a class="item" href="https://github.com/bloomberg/memray"
              >Memray â€“ A Memory Profiler for Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 13:28:47</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39325983"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39325700">
          <h3>
            <a
              class="item"
              href="https://www.iflscience.com/sad-clown-paradox-why-you-should-check-in-on-your-funny-friends-66845"
              >Sad clown paradox: Why you should check in on your funny
              friends</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 12:32:20</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39325700"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39324847">
          <h3>
            <a
              class="item"
              href="https://kmaasrud.com/blog/opml-is-underrated.html"
              >OPML Is Underrated</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 09:31:47</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39324847"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39324820">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=BJfmfkDQb14"
              >What is trauma? The author of "The Body Keeps the Score" explains
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 09:27:37</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39324820"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39324800">
          <h3>
            <a
              class="item"
              href="https://devlog.hexops.com/2024/building-the-directx-shader-compiler-better-than-microsoft/"
              >Building the DirectX shader compiler better than Microsoft?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 09:22:33</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39324800"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39323893">
          <h3>
            <a class="item" href="https://jessicalieb.itch.io/birdlingo"
              >BirdLingo: A birdsong learning game</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 05:37:04</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39323893"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39323601">
          <h3>
            <a class="item" href="https://github.com/hargata/lubelog"
              >LubeLogger: Self-hosted, open-source vehicle service records and
              tracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-10 @ 04:29:14</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39323601"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39322012">
          <h3>
            <a
              class="item"
              href="https://undark.org/2024/02/09/wilo-serial-killer-nuclear-lab/"
              >A nuclear weapons lab helped crack a serial-killer case</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 23:59:29</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39322012"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39318867">
          <h3>
            <a
              class="item"
              href="https://grafana.com/blog/2024/02/09/how-i-write-http-services-in-go-after-13-years/"
              >How I write HTTP services in Go after 13 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 19:00:59</span
              ><span class="points-container"
                >Points: <span class="points">688</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39318867"
                  >Comments</a
                ><span class="descendants">: 203</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39318571">
          <h3>
            <a
              class="item"
              href="https://maksimkita.com/blog/power-of-small-optimizations.html"
              >Power of small optimizations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 18:40:56</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39318571"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39316847">
          <h3>
            <a class="item" href="https://michaelbluejay.com/electricity/"
              >Saving Electricity (1998 â€“ 2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 16:46:00</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39316847"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39314153">
          <h3>
            <a class="item" href="https://cuecam-presenter.com?ct=hn"
              >Show HN: Presentations for your webcam, not a projector</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 12:37:03</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39314153"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>
                Editing cards should feel natural to anybody used to Markdown.
              </p>
              <p>
                I came to create CueCam as an "embedded entrepreneur". I had
                some success with my camera app "Shoot Pro Webcam" back in 2020
                and built on this by creating squares.tv.
              </p>
              <p>
                As I talked to more and more users, I discovered more
                opportunities to make their lives easier. I started with
                features in Shoot (camera options, pausing, drawing etc..)..
                Then I created Video Pencil (which connects to your computer and
                lets you draw on your webcam using your iPad). Then I created
                "Beat Sheet" which lets you run through "smart scripts",
                controlling Ecamm Live, OBS and mimoLive.
              </p>
              <p>
                CueCam Presenter is how I'm connecting all these elements. It
                gives you a virtual webcam, virtual mic, and seamlessly connects
                to Shoot and Video Pencil running on other devices. There are
                various ways you can use it as a teleprompter while maintaining
                eye contact.
              </p>
              <p>
                It's taken a lot to get it to this stage. The video pipeline has
                been through two major iterations and the audio pipeline even
                more. The UI has evolved and developed to cover the different
                ways it is understood by different people.
              </p>
              <p>
                Educational discounts are a must for me, as I want to help
                improve the quality of remote teaching around the world. For
                other professionals, I believe it transforms the way you
                interact with people on video calls. It's useful for recording
                software demos and running live streams.
              </p>
            </div>
          </section>
        </section>
        <section id="39313623">
          <h3>
            <a
              class="item"
              href="https://cep.dev/posts/every-infrastructure-decision-i-endorse-or-regret-after-4-years-running-infrastructure-at-a-startup/"
              >Almost every infrastructure decision I endorse or regret</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 11:05:39</span
              ><span class="points-container"
                >Points: <span class="points">978</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39313623"
                  >Comments</a
                ><span class="descendants">: 534</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39313361">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2402.03067"
              >Multilingual transformer and BERTopic for topic modeling: The
              case of Serbian</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 10:18:56</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39313361"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39313332">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/unix/XOffscreenIconMistake"
              >Accidentally making windows vanish in my old-fashioned Unix X
              environment</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 10:13:41</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39313332"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39312935">
          <h3>
            <a
              class="item"
              href="https://culture.teldap.tw/culture/index.php?option=com_content&amp;view=article&amp;id=951:earthquake-fish-academia-sinicabetty-lin&amp;catid=163:biosphere-and-nature&amp;Itemid=210"
              >Earthquake Fish</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 09:06:30</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39312935"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39311930">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/maze-proof-establishes-a-backbone-for-statistical-mechanics-20240207/"
              >Maze Proof Establishes a 'Backbone' for Statistical Mechanics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 06:13:10</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39311930"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39311787">
          <h3>
            <a class="item" href="http://bap.com.ar/"
              >Bayesian Analysis with Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 05:44:46</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39311787"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
