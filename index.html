<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41069909">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41069909"
              >Launch HN: Undermind (YC S24) – AI agent for discovering
              scientific papers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 15:36:57</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069909"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.undermind.ai/">https://www.undermind.ai/</a
              >). We’re building a search engine for complex scientific
              research.
              <p>
                We’re both physicists, and one of our biggest frustrations
                during grad school was finding research — There were a lot of
                times when we had to sit down to scope out new ideas for a
                project and quickly become a deep expert, or we had to find
                solutions to really complex technical problems, but the only way
                to do that was manually dig through papers on Google Scholar for
                hours. It was very tedious, to the point where we would often
                just skip the careful research and hope for the best. Sometimes
                you’d get burned a few months later because someone already
                solved the problem you thought was novel and important, or you’d
                waste your time inventing/building a solution for something when
                one already existed.
              </p>
              <p>
                The problem was there’s just no easy way to figure out what
                others have done in research, and load it into your brain. It’s
                one of the biggest bottlenecks for doing truly good, important
                research.
              </p>
              <p>
                We wanted to fix that. LLMs clearly help, but are mostly limited
                to general knowledge. Instead, we needed something that would
                pull in research papers, and give you exactly what you need to
                know, even for very complex ideas and topics. We realized the
                way to do this is to mimic the research strategies we already
                know work, because we do them ourselves, and so we built an
                agent-like LLM pipeline to carefully search in a way that mimics
                human research strategies.
              </p>
              <p>
                Our search system works a bit differently from casual search
                engines. First, we have you chat back and forth with an LLM to
                make sure we actually understand your really complex research
                goals up front, like you’re talking to a colleague. Then the
                system carefully searches for you for ~3 minutes. At a high
                level, it does something similar to tree search, following
                citation rabbit holes and adapting based on what it discovers to
                look for more content over multiple iterations (the same way you
                would if you decided to spend a few hours). The 3 minute delay
                is annoying, but we’re optimizing for quality of results rather
                than latency right now. At the end there’s a report.
              </p>
              <p>
                We’re trying to achieve two things with this careful, systematic
                agent-like discovery process:
              </p>
              <p>
                1. We want to be very accurate, and only recommend very specific
                results if you ask for a specific topic. To do this, we
                carefully read and evaluate content from papers with the highest
                quality LLMs (we’re just reading abstracts and citations for
                now, because they’re more widely accessible - but also working
                on adding full texts).
              </p>
              <p>
                2. We want to find everything relevant to your search, because
                in research it’s crucial to know if something exists or not. The
                key to being exhaustive is the adaptive algorithms we’ve
                developed (following citations, changing strategy based on what
                we find, etc). However, one cool feature of the automated
                pipeline is we can track the discovery process as the search
                proceeds. Early on, we find many good results, and later on they
                get more sparse, until all the good leads are exhausted and we
                stop finding anything helpful. We can statistically model that
                process, and figure out when we’ve found everything (it actually
                has an interesting exponential saturation behavior, which you
                can read a bit more about in our whitepaper (<a
                  href="https://www.undermind.ai/static/Undermind_whitepaper.pdf"
                  >https://www.undermind.ai/static/Undermind_whitepaper.pdf</a
                >), which we wrote for a previous prototype.)
              </p>
              <p>
                We have a demo video you can check out here:
                <a
                  href="https://www.loom.com/share/10067c49e4424b949a4b8c9fd8f3b12c?sid=5ee3cd96-2b05-4768-8856-cb1b83e40a70"
                  >https://www.loom.com/share/10067c49e4424b949a4b8c9fd8f3b12c?...</a
                >, and there are also some example search results on our
                homepage.
              </p>
              <p>
                You can try searching yourself here:
                <a href="https://www.undermind.ai/query_app/promotion/"
                  >https://www.undermind.ai/query_app/promotion/</a
                >
              </p>
              <p>
                (This is a special HN link where, for today, we’ve dropped the
                signup gate for your first few searches. Usually we require
                login so you can save searches.)
              </p>
              <p>
                We’re excited to share this with you! We’d love to hear about
                your experiences searching, what’s clear or not, and any
                feedback. We’ll be here to answer any questions or comments.
              </p>
            </div>
          </section>
        </section>
        <section id="41069908">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/07/25/business/southwest-airlines-assigned-seating.html"
              >Southwest Airlines Will End Its Longstanding Open-Seating
              Policy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 15:36:51</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069908"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41069896">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/technology/article/2024/jul/25/crowdstrike-workers-ubereats-vouchers"
              >CrowdStrike faces backlash as 'thank you' gift cards are
              blocked</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 15:35:39</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069896"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41069829">
          <h3>
            <a
              class="item"
              href="https://deepmind.google/discover/blog/ai-solves-imo-problems-at-silver-medal-level/"
              >AI solves IMO problems at silver medal level</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 15:29:41</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069829"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41069788">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/business/2024/07/25/machines-might-not-take-your-job-but-they-could-make-it-worse"
              >Machines might not take your job. But they could make it worse</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 15:25:52</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069788"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41069691">
          <h3>
            <a
              class="item"
              href="https://www.nbcnews.com/health/health-news/hiv-injection-twice-yearly-offers-protection-rcna163406"
              >Twice-yearly injection offers 100% protection against HIV</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 15:17:37</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069691"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41069626">
          <h3>
            <a
              class="item"
              href="https://www.forbes.com/sites/daveywinder/2024/07/24/microsofts-new-blue-screen-warning-for-windows-10-11-and-server-users/"
              >Microsoft Confirms New Blue Screen Warning for Windows 10 and 11
              Users</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 15:12:50</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069626"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41069403">
          <h3>
            <a
              class="item"
              href="https://brooker.co.za/blog/2024/07/25/cap-again.html"
              >The CAP theorem Is Irrelevant for Cloud Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 14:52:38</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069403"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41069256">
          <h3>
            <a class="item" href="https://0xinfection.github.io/reversing/"
              >Reverse Engineering for Everyone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 14:41:26</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069256"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41068995">
          <h3>
            <a
              class="item"
              href="https://serd.es/2024/07/24/Memory-mapping-an-FPGA-from-a-STM32.html"
              >Memory Mapping an FPGA from an STM32</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 14:21:36</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41068995"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41068451">
          <h3>
            <a class="item" href="https://github.com/PostgREST/postgrest"
              >PostgREST – Serve a RESTful API from Any Postgres Database</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 13:27:53</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41068451"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41067616">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/retaining-flavor-while-removing-caffeine-a-chemist-explains-the-chemistry-behind-decaf-coffee-233196"
              >A chemist explains the chemistry behind decaf coffee</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 12:04:09</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41067616"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41067578">
          <h3>
            <a
              class="item"
              href="https://boards.greenhouse.io/supabase/jobs/5225004004"
              >Supabase (YC S20) Is Hiring Auth Engineers (Fully Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 12:00:35</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41066544">
          <h3>
            <a
              class="item"
              href="https://mihaiolteanu.me/defense-of-lisp-macros"
              >Defense of Lisp Macros</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 09:18:13</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41066544"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41066536">
          <h3>
            <a
              class="item"
              href="https://rcoh.me/posts/linear-time-median-finding/"
              >My Favorite Algorithm: Linear Time Median Finding (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 09:16:53</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41066536"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41066303">
          <h3>
            <a
              class="item"
              href="https://raphael.medaer.me/2019/06/12/pgfsm.html"
              >Versioned Finite-State Machines with PostgreSQL (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 08:40:06</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41066303"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41065326">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2024/07/apple-maps-on-the-web-launches-in-beta/"
              >Apple Maps on the web launches in beta</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 06:26:40</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41065326"
                  >Comments</a
                ><span class="descendants">: 305</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41065227">
          <h3>
            <a
              class="item"
              href="https://www.elysian.press/p/employee-ownership"
              >Every company should be owned by its employees</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 06:10:38</span
              ><span class="points-container"
                >Points: <span class="points">526</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41065227"
                  >Comments</a
                ><span class="descendants">: 610</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41064645">
          <h3>
            <a
              class="item"
              href="https://jordaneldredge.com/notes/corrupted-skins/"
              >Investigating corrupt Winamp skins</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 04:14:57</span
              ><span class="points-container"
                >Points: <span class="points">362</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41064645"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41064351">
          <h3>
            <a class="item" href="https://github.com/nodejs/node/pull/53725"
              >Node.js adds experimental support for TypeScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 02:57:37</span
              ><span class="points-container"
                >Points: <span class="points">795</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41064351"
                  >Comments</a
                ><span class="descendants">: 356</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41064333">
          <h3>
            <a class="item" href="http://landley.net/toybox/"
              >What Is Toybox?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 02:53:14</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41064333"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41063258">
          <h3>
            <a
              class="item"
              href="https://www.jasoncollins.blog/posts/humans-1-chimps-0-correcting-the-record"
              >Humans 1, Chimps 0: Correcting the Record</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 23:22:57</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41063258"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41062072">
          <h3>
            <a
              class="item"
              href="https://tn1ck.com/blog/how-to-generate-sudokus"
              >Generating sudokus for fun and no profit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 21:02:09</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41062072"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41061755">
          <h3>
            <a
              class="item"
              href="https://ericwbailey.website/published/dungeons-and-dragons-taught-me-how-to-write-alt-text/"
              >Dungeons and Dragons taught me how to write alt text</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 20:35:49</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41061755"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41061390">
          <h3>
            <a class="item" href="https://github.com/mlfoundations/MINT-1T"
              >A multimodal dataset with one trillion tokens</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 20:04:24</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41061390"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41060102">
          <h3>
            <a
              class="item"
              href="https://trufflesecurity.com/blog/anyone-can-access-deleted-and-private-repo-data-github"
              >Anyone can access deleted and private repository data on
              GitHub</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 18:24:02</span
              ><span class="points-container"
                >Points: <span class="points">1775</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41060102"
                  >Comments</a
                ><span class="descendants">: 339</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41042929">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/tech/amazon-alexa-devices-echo-losses-strategy-25f2581a"
              >Alexa is in millions of households and Amazon is losing
              billions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 05:54:39</span
              ><span class="points-container"
                >Points: <span class="points">409</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41042929"
                  >Comments</a
                ><span class="descendants">: 739</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41039647">
          <h3>
            <a
              class="item"
              href="https://www.tonysm.com/when-objects-are-not-enough/"
              >When Objects Are Not Enough (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 20:48:07</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41039647"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41032097">
          <h3>
            <a
              class="item"
              href="https://www.bell-labs.com/usr/dmr/www/hopl.html"
              >Five little languages and how they grew: Dennis Ritchie's talk at
              HOPL on the</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 08:42:03</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41032097"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41026480">
          <h3>
            <a class="item" href="https://codisec.com/veles/"
              >Veles: Open-source tool for binary data analysis</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-21 @ 17:12:59</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41026480"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
