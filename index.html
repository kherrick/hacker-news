<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42779147">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/people-are-bad-reporting-what-they-eat-s-problem-dietary-research"
              >People are bad at reporting what they eat. That's a problem for
              dietary research</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-21 @ 11:54:50</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42779147"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42777874">
          <h3>
            <a
              class="item"
              href="https://daniel.haxx.se/blog/2021/10/25/the-quic-api-openssl-will-not-provide/"
              >The QUIC API OpenSSL will not provide (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-21 @ 08:57:33</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42777874"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42777857">
          <h3>
            <a class="item" href="https://github.com/MoonshotAI/Kimi-k1.5"
              >Kimi K1.5: Scaling Reinforcement Learning with LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-21 @ 08:53:21</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42777857"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42777769">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Wikipedia:Wikipedia_Signpost/2025-01-15/Traffic_report"
              >The most viewed articles of 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-21 @ 08:36:19</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42777769"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42777625">
          <h3>
            <a
              class="item"
              href="https://faiface.github.io/post/context-should-go-away-go2/"
              >Context should go away for Go 2 (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-21 @ 08:08:24</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42777625"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42774228">
          <h3>
            <a
              class="item"
              href="https://storymaps.arcgis.com/stories/eea3fbc9c05b40948563ffd0ccfab59d"
              >An astronomical view of Ancient Egyptian star clocks (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 23:07:54</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42774228"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42774221">
          <h3>
            <a class="item" href="https://ssno.cc/posts/reversing-tac-1-4-2025/"
              >Reverse engineering Call of Duty anti-cheat</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 23:07:10</span
              ><span class="points-container"
                >Points: <span class="points">354</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42774221"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42772911">
          <h3>
            <a
              class="item"
              href="https://jtanx.github.io/2018/12/28/turtle-flag-drawing/"
              >Flag drawing with Turtle</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 20:51:46</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42772911"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42772170">
          <h3>
            <a class="item" href="https://github.com/ROCm/ROCm/discussions/4276"
              >ROCm Device Support Wishlist</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 19:31:03</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42772170"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42771676">
          <h3>
            <a
              class="item"
              href="http://blog.rongarret.info/2025/01/i-am-not-failure-lessons-learned-from.html"
              >I am (not) a failure: Lessons learned from six failed startup
              attempts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 18:40:45</span
              ><span class="points-container"
                >Points: <span class="points">428</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42771676"
                  >Comments</a
                ><span class="descendants">: 251</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42771403">
          <h3>
            <a class="item" href="https://github.com/kronotop/kronotop"
              >Kronotop: Redis-compatible, transactional document store backed
              by FoundationDB</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 18:12:24</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42771403"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42770629">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/blog/announcing-yc-x25/"
              >YC X25, the spring 2025 batch</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 17:02:11</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42770629"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42770200">
          <h3>
            <a class="item" href="https://github.com/baturyilmaz/wordpecker-app"
              >Show HN: Personalized Duolingo (kind of) for vocabulary
              building</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 16:27:22</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42770200"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
            <div class="text">
              <p>
                My English is not the best but not the worst either. But I
                realized I can't boost it up after a certain level! In my
                belief, in order to truly learn a language, you need to be
                exposed to that language often. Vocabulary is the key factor
                here if you really want to improve in any language.
              </p>
              <p>
                My experience is that when I read a book to improve my English
                vocabulary, I encounter words that I don't know so often and my
                reading gets disturbed. I go look for the meaning, come back,
                put it in context, re-read it, etc. It didn't work for me. So I
                tried listening to audiobooks - I listen to the book and read
                along, and whenever I encounter a word, I write it down. I get
                these 50 words in 2-3 pages and I ask ChatGPT to give me their
                meanings. I read them, take the book, and now read it myself.
                That helps for sure, but still after a while I lose those words
                because I never encounter them again. Well then, in order to not
                forget those words, I need some kind of exercise, right? A
                flashcard app maybe? Well, I still need to go out there, ask
                ChatGPT to create questions, put them in a flashcard app, etc.
                It's still time-consuming and this is supposed to be fun!
              </p>
              <p>
                I need to be exposed to English in my daily life. I just need to
                save the words somewhere and whenever I want, I need to be able
                to practice them in a fun way, in Duolingo style maybe? So then
                I realized would it be better to store words in their own
                context? I mean, say I read Harry Potter and have a list of
                words I encountered in it, say I watch Breaking Bad and have a
                list of words I encountered watching it. I believe seeing those
                words together and practicing together makes it easier to
                remember them.
              </p>
              <p>
                But I shouldn't be the one adding the meaning of the word and
                the one to generate exercises, right? It all should be
                automated. The exercise part will be handled by LLM for sure,
                but for the meaning of the word, I can fetch from a dictionary?
                But I really don't like the dictionary definitions and one word
                can have multiple meanings in their own context. So then I need
                to use LLM for this task too and have the word's meaning in its
                own context.
              </p>
              <p>
                You create a list for your context, you add words, meanings get
                added automatically, and I see the word added in a different
                color (coloring is also a method used to remember words). It all
                takes seconds. And whenever I want to practice these lists, I
                can use learn mode to learn and test my knowledge in quiz mode.
                So I basically built this app ((thanks to Claude 3.5 Sonnet)). I
                want it to be like Duolingo, but of course I still have a way
                ahead to go, but wanted to share it in hopes of getting
                contributors.
              </p>
              <p>
                You can read more in the repository. I would love to get your
                thoughts on this.
              </p>
            </div>
          </section>
        </section>
        <section id="42770125">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=42770125"
              >I'm Peter Roberts, immigration attorney, who does work for YC and
              startups. AMA</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 16:20:29</span
              ><span class="points-container"
                >Points: <span class="points">317</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42770125"
                  >Comments</a
                ><span class="descendants">: 331</span></span
              >
            </h4>
            <div class="text">
              <p>
                Edit: Thank you again for the great questions and discussion.
                I'm taking a break now and will return in about an hour. If I
                miss any questions before the AMA ends today, I'll do my best to
                respond tomorrow
              </p>
            </div>
          </section>
        </section>
        <section id="42769871">
          <h3>
            <a class="item" href="https://mixxx.org/">Mixxx: GPL DJ Software</a>
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 15:53:31</span
              ><span class="points-container"
                >Points: <span class="points">530</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42769871"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42768072">
          <h3>
            <a class="item" href="https://github.com/deepseek-ai/DeepSeek-R1"
              >DeepSeek-R1</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 12:37:58</span
              ><span class="points-container"
                >Points: <span class="points">1424</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42768072"
                  >Comments</a
                ><span class="descendants">: 508</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42767797">
          <h3>
            <a class="item" href="https://www.mdpi.com/2504-446X/8/11/652"
              >Celestial Navigation for Drones</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 12:02:19</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42767797"
                  >Comments</a
                ><span class="descendants">: 113</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42767584">
          <h3>
            <a
              class="item"
              href="https://neilzone.co.uk/2025/01/using-esims-with-devices-that-only-have-a-physical-sim-slot-via-a-9esim-sim-card-with-android-and-linux/"
              >Using eSIMs with devices that only have a physical SIM slot via a
              9eSIM SIM car</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 11:33:15</span
              ><span class="points-container"
                >Points: <span class="points">347</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42767584"
                  >Comments</a
                ><span class="descendants">: 198</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42767132">
          <h3>
            <a
              class="item"
              href="https://medium.com/swlh/zork-the-great-inner-workings-b68012952bdc"
              >Zork: The Great Inner Workings (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 10:23:31</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42767132"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42766825">
          <h3>
            <a
              class="item"
              href="https://grossack.site/2025/01/16/undergrad-divisibility-problems.html"
              >Where do those undergraduate divisibility problems come from?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-20 @ 09:41:39</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42766825"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42754345">
          <h3>
            <a
              class="item"
              href="https://www.pankajtanwar.in/blog/unlink-vs-del-a-deep-dive-into-how-it-works-internally-in-redis"
              >Unlink vs. DEL – A deep dive into how it works internally in
              Redis</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-19 @ 06:34:32</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42754345"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42754305">
          <h3>
            <a class="item" href="https://www.sacred.computer"
              >SRCL: Open-source React project to build web apps with terminal
              aesthetics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-19 @ 06:28:36</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42754305"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42752637">
          <h3>
            <a
              class="item"
              href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=203ee701ee9833364eb551c342bb4b0a120f937e"
              >The Sonnenschein-Mantel-Debreu Results After Thirty Years</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-19 @ 00:38:36</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42752637"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42752299">
          <h3>
            <a class="item" href="https://www.readtrung.com/p/garmins-40b-pivot"
              >Garmin's –$40B Pivot</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-18 @ 23:35:06</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42752299"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42751785">
          <h3>
            <a class="item" href="https://lupyuen.org/articles/uname.html"
              >Fixing a uname bug (Apache NuttX RTOS)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-18 @ 22:03:26</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42751785"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42751403">
          <h3>
            <a
              class="item"
              href="https://aws.amazon.com/blogs/containers/migrating-from-aws-app-mesh-to-amazon-ecs-service-connect/"
              >AWS will discontinue support for AWS App Mesh</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-18 @ 21:02:22</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42751403"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42739597">
          <h3>
            <a
              class="item"
              href="https://www.historynewsnetwork.org/article/regency-sex-ed"
              >Regency Sex Ed: How did women in 19th C. Europe learn about the
              birds and bees?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-17 @ 16:22:22</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42739597"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42738143">
          <h3>
            <a
              class="item"
              href="https://dylanbeattie.net/2022/09/19/the-road-to-guitaraoke-part-1-vamp-chordino-imagesharp-ffmpeg.html"
              >Guitar chord karaoke with Vamp, Chordino, and FFmpeg (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-17 @ 14:56:53</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42738143"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42737401">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41377-024-01725-6"
              >Optical Fresnel zone plate flat lens: colored photoresist through
              I-line stepper</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-17 @ 13:40:33</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42737401"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42733654">
          <h3>
            <a
              class="item"
              href="https://petapixel.com/2025/01/16/417-megapixel-andromeda-galaxy-panorama-took-over-a-decade-to-make/"
              >417-megapixel Andromeda galaxy panorama took over a decade to
              make</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-17 @ 03:03:05</span
              ><span class="points-container"
                >Points: <span class="points">199</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42733654"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
