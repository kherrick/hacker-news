<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36992335">
          <h3>
            <a class="item" href="https://github.com/nukeykt/Nuked-MD-FPGA"
              >Nuked-MD-FPGA – accurate Sega Genesis re-implementation based on
              decapped chips</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 21:38:56</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36992335"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36992249">
          <h3>
            <a
              class="item"
              href="https://e360.yale.edu/features/as-ocean-oxygen-levels-dip-fish-face-an-uncertain-future"
              >As ocean oxygen levels dip, fish face an uncertain future</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 21:31:19</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36992249"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36991434">
          <h3>
            <a
              class="item"
              href="https://guochengqian.github.io/project/magic123/"
              >Magic123: One Image to High-Quality 3D Object Generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 20:34:42</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36991434"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36991381">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2023/08/apple-reports-third-quarter-results/"
              >Apple reports third quarter results</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 20:31:00</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36991381"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36991293">
          <h3>
            <a
              class="item"
              href="https://github.com/ErwannMillon/Color-diffusion"
              >Color-Diffusion: using diffusion models to colorize black and
              white images</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 20:24:50</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36991293"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36990615">
          <h3>
            <a class="item" href="https://www.comigo.ai"
              >Cognitive AI for ADHD</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 19:30:52</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36990615"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36990162">
          <h3>
            <a
              class="item"
              href="https://www.ornl.gov/news/researchers-use-commercial-quantum-computer-identify-molecular-candidate-development-more"
              >Commercial quantum computer identifies molecular candidate for
              better solar cell</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 18:58:09</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36990162"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36989858">
          <h3>
            <a class="item" href="https://sgp.fas.org/eprint/morland.html"
              >The Holocaust Bomb: A question of time (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 18:35:53</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36989858"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36989845">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/08/03/fcc-fines-robocaller-a-record-300m-after-blocking-billions-of-their-scam-calls/"
              >FCC fines robocaller a record $300M after blocking billions of
              their scam calls</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 18:35:11</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36989845"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36989798">
          <h3>
            <a
              class="item"
              href="https://www.infoq.com/news/2023/08/aws-ec2-public-ipv4/"
              >AWS to begin charging for public IPv4 addresses</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 18:31:50</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36989798"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36989604">
          <h3>
            <a
              class="item"
              href="https://www.hydrogeninsight.com/transport/no-more-hydrogen-trains-rail-company-that-launched-worlds-first-h2-line-last-year-opts-for-all-electric-future/2-1-1495801?zephr_sso_ott=tiwZxe"
              >Rail company that launched first H2 line opts for all-electric
              future</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 18:16:59</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36989604"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36989569">
          <h3>
            <a class="item" href="https://chrultrabook.github.io/docs/"
              >Chrultrabook – Modify a Chromebook to Run Windows/Linux/macOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 18:13:51</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36989569"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36989503">
          <h3>
            <a
              class="item"
              href="https://neon.tech/blog/pg_embedding-on-disk-hnsw-index"
              >On-disk HNSW index for Postgres with pg_embedding</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 18:08:32</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36989503"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36988744">
          <h3>
            <a class="item" href="https://brave.com/image-video-search/"
              >Brave Search launches own image and video search</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 17:15:36</span
              ><span class="points-container"
                >Points: <span class="points">188</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36988744"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36988511">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/propelauth/jobs"
              >PropelAuth (YC W22) Is Hiring Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 17:00:44</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36988262">
          <h3>
            <a
              class="item"
              href="https://electrek.co/2023/08/03/hackers-manage-unlock-tesla-software-locked-features/"
              >Hackers manage to unlock Tesla software-locked features</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 16:44:04</span
              ><span class="points-container"
                >Points: <span class="points">570</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36988262"
                  >Comments</a
                ><span class="descendants">: 536</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36988047">
          <h3>
            <a class="item" href="https://www.pmail.com/">Pegasus Mail</a>
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 16:28:24</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36988047"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36988039">
          <h3>
            <a
              class="item"
              href="https://resobscura.substack.com/p/why-early-modern-books-are-so-beautiful"
              >Why early modern books are so beautiful</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 16:28:01</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36988039"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36987920">
          <h3>
            <a
              class="item"
              href="https://hydra-so.notion.site/Hydra-1-0-beta-318504444825401e8ce21796dcadd589"
              >Show HN: Hydra 1.0 – open-source column-oriented Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 16:19:07</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36987920"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
            <div class="text">
              <p>
                hydra is an open source, column-oriented postgres. you can set
                up remarkably fast aggregates on your project in minutes to
                query billions of rows instantly.
              </p>
              <p>
                postgres is great, but aggregates can take minutes to hours to
                return results on large data sets. long-running analytical
                queries hog database resources and degrade performance. use
                hydra to run much faster analytics on postgres without making
                code changes. data is automatically loaded into columnar format
                and compressed. connect to hydra with your preferred postgres
                client (psql, dbeaver, etc).
              </p>
              <p>
                following 4 months of development on hydra v0.3.0-alpha, our
                team is proud to share our first major version release. hydra
                1.0 is under active development, but ready for use and feedback.
                we’re aiming to release 1.0 into general availability (ga) soon.
              </p>
              <p>
                for testing, try the hydra free tier to create a column-oriented
                postgres instance on the cloud.
                <a href="https://dashboard.hydra.so/signup"
                  >https://dashboard.hydra.so/signup</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36987454">
          <h3>
            <a class="item" href="https://github.com/sweepai/sweep"
              >Launch HN: Sweep (YC S23) – A bot to create simple PRs in your
              codebase</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 15:45:58</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36987454"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
            <div class="text">
              <a href="https://sweep.dev/">https://sweep.dev/</a>). Sweep is an
              open-source AI-powered junior developer. You describe a feature or
              bugfix in a GitHub issue and Sweep writes a pull request with
              code. You can see some examples here:
              <a href="https://docs.sweep.dev/examples"
                >https://docs.sweep.dev/examples</a
              >.
              <p>
                Kevin and I met while working at Roblox. We talked to our
                friends who were junior developers and noticed a lot of them
                doing grunt work. We wanted to let them focus on important work.
                Copilot is great, but we realized some tasks could be completely
                offloaded to an AI (e.g. adding a banner to your webpage
                <a href="https://github.com/sweepai/landing-page/issues/225"
                  >https://github.com/sweepai/landing-page/issues/225</a
                >).
              </p>
              <p>
                Sweep does this with a code search engine. We use code chunking,
                ranking, and formatting tricks to represent your codebase in a
                token-efficient manner for LLMs. You might have seen our blog on
                code chunking here:
                <a href="https://news.ycombinator.com/item?id=36948403"
                  >https://news.ycombinator.com/item?id=36948403</a
                >.
              </p>
              <p>
                We take these fetched code snippets and come up with a plan to
                write the PR. We found that having the LLM provide structured
                information using XML tags is very robust, as it’s easy for us
                to parse with regex, has good support for multi-line answers and
                is hard for the LLM to mess up.
              </p>
              <p>
                This is because XML is common in the LLM’s training data (the
                internet / HTML), and the opening and closing tags rarely appear
                naturally in text and code, unlike the quotations, brackets,
                backticks and newlines used by JSON’s and markdown’s delimiters.
                Further, XML lets you skip the preamble (“This question has to
                do with xyz. Here is my answer:”) and handles multi-line answers
                like PR plans and code really well. For example, we ask the LLM
                for the new code in &lt;new_code&gt; tags and a final boolean
                answer by writing &lt;answer&gt;True&lt;/answer&gt;.
              </p>
              <p>
                We use this XML format to get the LLM to create a plan,
                generating a list of files to create and modify from the
                retrieved relevant files. We iterate through the file changes
                and edit/create the necessary files. Finally, we push the
                commits to GitHub and create the PR.
              </p>
              <p>
                We’ve been using Sweep to handle small issues in Sweep’s own
                repo (it recently passed 100 commits). We’ve become well
                acquainted with its limitations. For example, Sweep sometimes
                leave unimplemented functions with just “# rest of code” since
                it runs on GPT-4, a model tuned for chatting. Other times,
                there’s minor syntax errors or undefined variables. This is why
                we spend the other half of our time building self-recovery
                methods for Sweep to fix and test its PRs.
              </p>
              <p>
                First, we invite the developer to review and add comments to
                Sweep’s pull request. This helps to a point, but Sweep’s code
                sometimes wouldn’t lint. This is table stakes. It’s frustrating
                to have to tell the bot to “add an import here” or “this
                variable is undefined”. To make this better, we used GitHub
                Actions, which automatically runs the flow of “check the code →
                tell sweep → sweep fixes the code → check the code again”. We
                like this flow because you might already have GitHub Actions,
                and it’s fully configurable. Check out this blog to learn more
                <a href="https://docs.sweep.dev/blogs/giving-dev-tools"
                  >https://docs.sweep.dev/blogs/giving-dev-tools</a
                >.
              </p>
              <p>
                So far, Sweep isn’t that fast, can’t handle massive problems
                yet, and doesn’t write hundreds of lines of code. We’re excited
                to work towards that. In the meantime, a lot of our users have
                been able to get useful results. For example, a user reported
                that an app was not working correctly on Windows, and Sweep
                wrote the PR at
                <a href="https://github.com/sweepai/sweep/pull/368/files"
                  >https://github.com/sweepai/sweep/pull/368/files</a
                >, replacing all occurrences of "/tmp" with
                "tempfile.gettempdir()". Other examples include adding a
                validation function for Github branch name (<a
                  href="https://github.com/sweepai/sweep/pull/461"
                  >https://github.com/sweepai/sweep/pull/461</a
                >) and adding dynamically generated initials in the testimonials
                on our landing page (<a
                  href="https://github.com/wwzeng1/landing-page/issues/28"
                  >https://github.com/wwzeng1/landing-page/issues/28</a
                >). For more examples, checkout
                <a href="https://docs.sweep.dev/examples"
                  >https://docs.sweep.dev/examples</a
                >.
              </p>
              <p>
                Our focus is on finding ways that an AI dev can actually help
                and not just be a novelty. I think of my daily capacity to write
                good code as a stamina bar. There’s a fixed cost to opening an
                IDE, finding the right lines of code, and making changes. If
                you’re working on a big feature and have to context switch, the
                cost is higher. I’ve been leaving the small changes to Sweep,
                and my stamina bar stays full for longer.
              </p>
              <p>
                Our repo is at
                <a href="https://github.com/sweepai/sweep"
                  >https://github.com/sweepai/sweep</a
                >, there’s a demo video at
                <a href="https://www.youtube.com/watch?v=WBVna_ow8vo"
                  >https://www.youtube.com/watch?v=WBVna_ow8vo</a
                >, and you can install Sweep here:
                <a href="https://github.com/apps/sweep-ai"
                  >https://github.com/apps/sweep-ai</a
                >. We currently have a freemium model, with 5 GPT-4 PRs at the
                free tier, 120 GPT-4 PRs at the paid tier and unlimited at the
                enterprise tier.
              </p>
              <p>
                We’re far from our vision of a full AI software engineer, but
                we’re excited to work on it with the community feedback :).
                Looking forward to hearing any of your thoughts!
              </p>
            </div>
          </section>
        </section>
        <section id="36987372">
          <h3>
            <a class="item" href="https://www.gnu.org/software/units/"
              >GNU Units</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 15:39:37</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36987372"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36986769">
          <h3>
            <a
              class="item"
              href="https://wiki.alopex.li/ElixirForCynicalCurmudgeons"
              >Elixir for cynical curmudgeons</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 14:51:27</span
              ><span class="points-container"
                >Points: <span class="points">330</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36986769"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36984695">
          <h3>
            <a class="item" href="https://stitcher.io/blog/dont-be-clever"
              >Don't be clever</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 12:08:48</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36984695"
                  >Comments</a
                ><span class="descendants">: 172</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36983704">
          <h3>
            <a
              class="item"
              href="https://bkhome.org/news/202112/why-iso-was-retired.html"
              >Why ISO was retired (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 10:06:02</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36983704"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36982996">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/who-was-the-bell-witch"
              >Who was the Bell Witch?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 08:33:12</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36982996"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36982856">
          <h3>
            <a
              class="item"
              href="https://erynwells.me/blog/2023/08/netscape-meteors/"
              >Netscape Meteors</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 08:17:44</span
              ><span class="points-container"
                >Points: <span class="points">362</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36982856"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36982459">
          <h3>
            <a
              class="item"
              href="https://www.jviotti.com/2022/05/05/debugging-the-cxx-standard-library-on-macos.html"
              >Debugging the C++ standard library on macOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 07:18:42</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36982459"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36982067">
          <h3>
            <a
              class="item"
              href="https://lithub.com/on-the-link-between-lyme-disease-and-bioweapons/"
              >On the link between Lyme disease and bioweapons (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 06:17:29</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36982067"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36981605">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/California_job_case"
              >California Job Case</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-03 @ 05:05:33</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36981605"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36969018">
          <h3>
            <a
              class="item"
              href="https://tailscale.com/blog/how-nat-traversal-works/"
              >How NAT traversal works (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-02 @ 10:22:46</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36969018"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
