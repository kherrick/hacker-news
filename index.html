<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45818973">
          <h3>
            <a
              class="item"
              href="https://twitter.com/TimSweeneyEpic/status/1985920786545123613"
              >Epic vs. Google settlement: Opening up Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 04:12:53</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45818973"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45818562">
          <h3>
            <a class="item" href="https://hypothesis.readthedocs.io/en/latest/"
              >Hypothesis: Property-Based Testing for Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 03:15:37</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45818562"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45818499">
          <h3>
            <a
              class="item"
              href="https://kyle.cascade.family/posts/preventing-kubernetes-from-pulling-the-pause-image-from-the-internet/"
              >Preventing Kubernetes from Pulling the Pause Image from the
              Internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 03:04:58</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45818499"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45818483">
          <h3>
            <a
              class="item"
              href="https://www.leefang.com/p/what-happened-to-piracy-copyright"
              >What Happened to Piracy? Copyright Enforcement Fades as AI Giants
              Rise</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 03:01:59</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45818483"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45818471">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/20251104-00/?p=111758"
              >The Microsoft SoftCard for the Apple II: Getting two processors
              to share memory</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 02:58:25</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45818471"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45818421">
          <h3>
            <a
              class="item"
              href="https://www.nbcnews.com/politics/elections/new-york-city-mayor-election-winner-2025-race-rcna238909"
              >Zohran Mamdani wins the New York mayoral race</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 02:50:06</span
              ><span class="points-container"
                >Points: <span class="points">521</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45818421"
                  >Comments</a
                ><span class="descendants">: 552</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45818319">
          <h3>
            <a
              class="item"
              href="https://www.nextgov.com/digital-government/2025/11/direct-file-wont-happen-2026-irs-tells-states/409309/"
              >Direct File won't happen in 2026, IRS tells states</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 02:30:38</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45818319"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45818282">
          <h3>
            <a
              class="item"
              href="https://gmauthority.com/blog/2025/11/these-gm-vehicles-can-no-longer-download-apps-through-their-infotainment-system/"
              >GM Deprecating In-Car App Store for Models as Recent as 2020</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 02:24:20</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45818282"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45818123">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2025/nov/04/munichs-surfers-left-stunned-after-famed-river-wave-vanishes"
              >Munich's surfers left stunned after famed river wave vanishes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-05 @ 01:51:27</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45818123"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45817167">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2025/11/04/dhs_wants_to_collect_biometric_data/"
              >Uncle Sam wants to scan your iris and collect your DNA, citizen
              or not</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 23:35:27</span
              ><span class="points-container"
                >Points: <span class="points">228</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45817167"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45817114">
          <h3>
            <a class="item" href="https://github.com/pythops/bluetui"
              >Bluetui – A TUI for managing Bluetooth on Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 23:29:31</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45817114"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45816968">
          <h3>
            <a
              class="item"
              href="https://torrentfreak.com/google-removed-749-million-annas-archive-urls-from-its-search-results/"
              >Google Removed 749M Anna's Archive URLs from Its Search
              Results</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 23:11:20</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45816968"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45816879">
          <h3>
            <a
              class="item"
              href="https://tinkerdifferent.com/threads/patching-68k-software-simpletext.4793/"
              >Patching 68K Software – SimpleText</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 22:59:22</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45816879"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45816853">
          <h3>
            <a class="item" href="https://inventingthefuture.ghost.io/mr-tiff/"
              >Mr Tiff</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 22:57:12</span
              ><span class="points-container"
                >Points: <span class="points">460</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45816853"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45816673">
          <h3>
            <a class="item" href="https://github.com/zserge/grayskull"
              >Grayskull: A tiny computer vision library in C for embedded
              systems, etc.</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 22:35:58</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45816673"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45816041">
          <h3>
            <a
              class="item"
              href="https://rameerez.com/send-this-article-to-your-friend-who-still-thinks-the-cloud-is-a-good-idea/"
              >I took all my projects off the cloud, saving thousands of
              dollars</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 21:22:15</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45816041"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45813767">
          <h3>
            <a class="item" href="https://cognition.ai/blog/codemaps"
              >Codemaps: Understand Code, Before You Vibe It</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 17:47:09</span
              ><span class="points-container"
                >Points: <span class="points">233</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45813767"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45813310">
          <h3>
            <a class="item" href="https://www.plexe.ai/"
              >Launch HN: Plexe (YC X25) – Build production-grade ML models from
              prompts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 17:07:47</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45813310"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.plexe.ai">https://www.plexe.ai</a>). We
              create production-ready ML models from natural language
              descriptions. Tell Plexe what ML problem you want to solve, point
              it at your data, and it handles the entire pipeline from feature
              engineering to deployment.
              <p>
                Here’s a walkthrough:
                <a href="https://www.youtube.com/watch?v=TbOfx6UPuX4"
                  >https://www.youtube.com/watch?v=TbOfx6UPuX4</a
                >.
              </p>
              <p>
                ML teams waste too much time on generic heavy lifting. Every
                project follows the same pattern: 20% understanding objectives,
                60% wrangling data and engineering features, 20% experimenting
                with models. Most of this is formulaic but burns months of
                engineering time. Throwing LLMs at it isn't the answer as that
                just trades engineering time for compute costs and worse
                accuracy. Plexe automates this repetitive 80%, so your team can
                work faster on what actually has value.
              </p>
              <p>
                You describe your problem in plain English ("fraud detection
                model for transactions" or "product embedding model for
                search"), connect your data (Postgres, Snowflake, S3, direct
                upload, etc), and then Plexe: - Analyzes data and engineers
                features automatically - Runs experiments across multiple
                architectures (logistic regression to neural nets) - Generates
                comprehensive evaluation reports with error analysis, robustness
                testing, and prioritized recommendations to provide actionable
                guidance - Deploys the best model with monitoring and automatic
                retraining
              </p>
              <p>
                We did a Show HN for our open-source library five months ago (<a
                  href="https://news.ycombinator.com/item?id=43906346"
                  >https://news.ycombinator.com/item?id=43906346</a
                >). Since then, we've launched our commercial platform with
                interactive refinement, production-grade model evaluations,
                retraining pipeline, data connectors, analytics dashboards, and
                deployment for online and batch inference.
              </p>
              <p>
                We use a multi-agent architecture where specialized agents
                handle different pipeline stages. Each agent focuses on its
                domain: data analysis, feature engineering, model selection,
                deployment, and so on. The platform tracks all experiments and
                generates exportable Python code.
              </p>
              <p>
                Our open-source core (<a
                  href="https://github.com/plexe-ai/plexe"
                  >https://github.com/plexe-ai/plexe</a
                >, Apache 2.0) remains free for local development. For the paid
                product, our pricing is usage-based, with a minimum top up of
                $10. Enterprises can self-host the entire platform. You can sign
                up on
                <a href="https://console.plexe.ai">https://console.plexe.ai</a>.
                Use promo code `LAUNCHDAY20` to get $20 to try out the platform.
              </p>
              <p>
                We’d love to hear your thoughts on the problem and feedback on
                the platform!
              </p>
            </div>
          </section>
        </section>
        <section id="45812606">
          <h3>
            <a class="item" href="https://github.com/Snowflake-Labs/pg_lake"
              >Pg_lake: Postgres with Iceberg and data lake access</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 16:12:27</span
              ><span class="points-container"
                >Points: <span class="points">312</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45812606"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45812024">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/tech-industry/cyber-security/on-this-day-in-1988-the-morris-worm-slithered-out-and-sparked-a-new-era-in-cybersecurity-10-percent-of-the-internet-was-infected-within-24-hours"
              >This Day in 1988, the Morris worm infected 10% of the Internet
              within 24 hours</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 15:23:14</span
              ><span class="points-container"
                >Points: <span class="points">351</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45812024"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45811093">
          <h3>
            <a class="item" href="https://terra.layoutit.com"
              >Show HN: A CSS-Only Terrain Generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-04 @ 13:58:35</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45811093"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45771151">
          <h3>
            <a class="item" href="https://zserge.com/posts/grayskull/"
              >By the Power of Grayscale</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-31 @ 12:11:03</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45771151"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45761433">
          <h3>
            <a
              class="item"
              href="https://www.cnet.com/tech/computing/apple-talks-to-me-about-vision-pro-personas-where-is-our-virtual-presence-headed/"
              >Apple’s Persona technology uses Gaussian splatting to create 3D
              facial scans</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-30 @ 15:53:21</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45761433"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45759839">
          <h3>
            <a
              class="item"
              href="https://riscv.org/blog/risc-v-jtc1-pas-submitter/"
              >RISC-V takes first step toward international ISO/IEC
              standardization</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-30 @ 13:30:37</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45759839"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45750005">
          <h3>
            <a
              class="item"
              href="https://www.ibm.com/support/pages/vectorizing-fun-and-performance"
              >Vectorizing for Fun and Performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-29 @ 17:19:40</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45750005"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45734259">
          <h3>
            <a class="item" href="https://wholeearth.info/"
              >Whole Earth Index</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-28 @ 15:36:39</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45734259"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45733836">
          <h3>
            <a
              class="item"
              href="https://byroot.github.io/ruby/performance/2025/10/28/string-literals.html"
              >Frozen String Literals: Past, Present, Future?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-28 @ 15:08:31</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45733836"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45733204">
          <h3>
            <a
              class="item"
              href="https://press.asus.com/news/press-releases/asus-proart-display-8k-pa32kcx-availability/"
              >Asus Announces October Availability of ProArt Display 8K
              PA32KCX</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-28 @ 14:17:04</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45733204"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45726597">
          <h3>
            <a
              class="item"
              href="https://tomverbeure.github.io/2025/10/26/Inside-an-Isotemp-OCXO107-10.html"
              >Inside an Isotemp OCXO107-10 Oven Controlled Crystal
              Oscillator</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-27 @ 21:35:46</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45726597"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45692042">
          <h3>
            <a
              class="item"
              href="https://www.auralarchipelago.com/auralarchipelago/kalason"
              >Singing bus horns in West Sumatra</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-24 @ 07:54:17</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45692042"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
