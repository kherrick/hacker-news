<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37149349">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-02585-7"
              >LK-99 isn’t a superconductor – how science sleuths solved the
              mystery</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 16:17:17</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37149349"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37148680">
          <h3>
            <a
              class="item"
              href="https://www.businessinsider.com/the-tech-job-recession-is-over-when-will-hiring-reaccelerate-2023-8"
              >The tech job recession is over</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 15:33:57</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37148680"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37148240">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37148240"
              >Ask HN: If we train an LLM with “data” instead of “language”
              tokens</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 15:07:03</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37148240"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
            <div class="text">
              <p>
                Traditional ML would do a lot of feature extraction and
                engineering -- from a very specific problem space --before
                throwing the training compute at it. I think there are good
                pattern detection, prediction, and anomaly detection models that
                come out of this.
              </p>
              <p>
                What happens if we just scrape all data (say metrics like
                weather, flights, population stats, gps locations, web pages
                clicks, deep space network observations, and kindergarten
                grades) and if it were possible to build a model with enough
                weights for all this diverse data ...
              </p>
              <p>
                What kind of use case might such a ... Large DATA model ...open
                up?
              </p>
            </div>
          </section>
        </section>
        <section id="37148033">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/math-proof-draws-new-boundaries-around-black-hole-formation-20230816/"
              >Math Proof Draws New Boundaries Around Black Hole Formation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 14:54:22</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37148033"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37147996">
          <h3>
            <a
              class="item"
              href="https://github.com/spring-projects/spring-framework/wiki/What%27s-New-in-Spring-Framework-6.x"
              >Spring 6.1 now compatible with virtual threads and JDK 21
              overall</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 14:52:01</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37147996"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37147729">
          <h3>
            <a
              class="item"
              href="https://www.bleepingcomputer.com/news/security/major-us-energy-org-targeted-in-qr-code-phishing-attack/"
              >Major U.S. energy org targeted in QR code phishing attack</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 14:37:00</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37147729"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37147617">
          <h3>
            <a
              class="item"
              href="https://wiki.debian.org/DebianHistory?action=AttachFile&amp;do=get&amp;target=Debian-announcement-1993.txt"
              >Brand-new Linux release, which I'm calling the Debian Linux
              Release (1993)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 14:30:15</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37147617"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37147158">
          <h3>
            <a
              class="item"
              href="https://dropbox.tech/frontend/how-we-reduced-the-size-of-our-javascript-bundles-by-33-percent"
              >We reduced the size of our JavaScript bundles by 33%</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 14:02:14</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37147158"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37146532">
          <h3>
            <a class="item" href="https://materialize.com/blog/warehouse-abuse/"
              >The uses and abuses of Cloud Data Warehouses</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 13:10:59</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37146532"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37146398">
          <h3>
            <a
              class="item"
              href="https://www.desertsun.com/story/opinion/contributors/valley-voice/2023/02/05/growing-alfalfa-in-imperial-county-and-california-wastes-water/69860506007/"
              >How do we save water: Stop growing alfalfa in Imperial County</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 13:00:26</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37146398"
                  >Comments</a
                ><span class="descendants">: 162</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37146331">
          <h3>
            <a
              class="item"
              href="https://nginx.org/en/docs/dev/development_guide.html"
              >Nginx Development Guide</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 12:55:15</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37146331"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37146268">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/8/16/23834125/microsoft-windows-task-manager-pause-shortcut"
              >Today I learned you can pause the Windows Task Manager moving
              apps around</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 12:49:38</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37146268"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37145701">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/08/16/magazine/pfas-toxic-chemicals.html"
              >Scientists are only beginning to understand how PFAS impacting
              our health</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 11:57:57</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37145701"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37145558">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/business/retail-consumer/amazon-pharmacy-automates-discounts-help-insulin-patients-get-pledged-prices-2023-08-15/"
              >Amazon Pharmacy automates discounts to help insulin patients get
              pledged prices</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 11:41:07</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37145558"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37145427">
          <h3>
            <a
              class="item"
              href="https://kotaku.com/nintendo-is-trying-to-patent-some-really-broad-tears-of-1850730637"
              >Nintendo is trying to patent some broad Tears of the Kingdom
              mechanics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 11:25:20</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37145427"
                  >Comments</a
                ><span class="descendants">: 139</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37145411">
          <h3>
            <a
              class="item"
              href="https://www.energy.gov/articles/us-department-energy-finds-energy-jobs-have-increased-nearly-every-county-america"
              >Energy Jobs Have Increased in Nearly Every County in America</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 11:24:05</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37145411"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37144985">
          <h3>
            <a
              class="item"
              href="https://htmx.org/posts/2023-06-06-htmx-github-accelerator/"
              >Htmx is part of the GitHub Accelerator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 10:19:32</span
              ><span class="points-container"
                >Points: <span class="points">575</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37144985"
                  >Comments</a
                ><span class="descendants">: 284</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37144601">
          <h3>
            <a
              class="item"
              href="https://maryrosecook.com/blog/post/is-this-a-good-book-for-me-now"
              >Is this a good book for me, now?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 09:23:27</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37144601"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37142388">
          <h3>
            <a class="item" href="https://www.netmaker.io/"
              >NetMaker: Connect Everything with a WireGuard VPN</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-16 @ 03:00:40</span
              ><span class="points-container"
                >Points: <span class="points">234</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37142388"
                  >Comments</a
                ><span class="descendants">: 137</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37140013">
          <h3>
            <a class="item" href="https://finbarr.ca/how-is-llama-cpp-possible/"
              >How Is LLaMa.cpp Possible?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 22:18:17</span
              ><span class="points-container"
                >Points: <span class="points">624</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37140013"
                  >Comments</a
                ><span class="descendants">: 205</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37136986">
          <h3>
            <a
              class="item"
              href="https://www.drorpoleg.com/thinking-fast-and-slopes/"
              >Thinking Fast and Slopes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 17:44:31</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37136986"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37134950">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/protein-disrupts-cells-energy-centers-may-be-culprit-chronic-fatigue-syndrome"
              >A protein that disrupts cells’ energy centers may be a culprit in
              CFS/ME</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 15:11:29</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37134950"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37134315">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2308.07037"
              >Bayesian Flow Networks</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 14:18:44</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37134315"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37134056">
          <h3>
            <a
              class="item"
              href="https://dl.acm.org/doi/pdf/10.1145/217838.217868"
              >A Metaobject Protocol for C++ (1995) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 13:55:34</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37134056"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37133908">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/23830432/imac-twenty-five-years-ago-saved-apple"
              >How the iMac Saved Apple</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 13:41:38</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37133908"
                  >Comments</a
                ><span class="descendants">: 208</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37131808">
          <h3>
            <a
              class="item"
              href="http://sims.durgadas.com/punchcards/ibm029.html"
              >Virtual IBM Punch Card Data Processing (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 09:19:00</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37131808"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37130988">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=P1ZDOGDMNLM"
              >Circle Evolves C++ [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 06:51:08</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37130988"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37129921">
          <h3>
            <a
              class="item"
              href="https://www.cs.utexas.edu/~eunsol/courses/data/bitter_lesson.pdf"
              >The Bitter Lesson (2019) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 03:44:34</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37129921"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37129514">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/ruins-of-neros-theater-discovered-near-vatican1/"
              >Ruins of Emperor Nero’s Theater Discovered Near Vatican</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-15 @ 02:35:34</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37129514"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37117754">
          <h3>
            <a
              class="item"
              href="https://insidethemagic.net/2022/02/disney-go-away-green-lp1/"
              >Disney invented two colors (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-14 @ 05:25:15</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37117754"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
