<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41922556">
          <h3>
            <a
              class="item"
              href="https://www.newscatcherapi.com/career/web-crawling-scraping-engineer"
              >NewsCatcher (YC S22) Is Hiring Web Scraping/Crawling Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 07:00:15</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41922081">
          <h3>
            <a class="item" href="https://bernsteinbear.com/blog/row-poly/"
              >Adding row polymorphism to Damas-Hindley-Milner</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 05:26:23</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41922081"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41921725">
          <h3>
            <a
              class="item"
              href="https://ojs.aaai.org/index.php/AIES/article/view/31742"
              >Paper finds provably minimal counterfactual explanations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 04:09:42</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41921725"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41921673">
          <h3>
            <a
              class="item"
              href="https://sqlite.org/forum/forumpost/b7e2d83c0bcfae1e"
              >Migration of the build system to autosetup</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 03:58:31</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41921673"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41920591">
          <h3>
            <a class="item" href="https://bmchtech.github.io/post/multiply/"
              >Solving the Mystery of ARM7TDMI Multiply Carry Flag</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 01:13:28</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41920591"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41920401">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2024-10-23/arm-to-cancel-qualcomm-chip-design-license-in-escalation-of-feud"
              >Arm is canceling Qualcomm's chip design license</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 00:48:24</span
              ><span class="points-container"
                >Points: <span class="points">334</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41920401"
                  >Comments</a
                ><span class="descendants">: 238</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41920127">
          <h3>
            <a
              class="item"
              href="https://www.backpacker.com/news-and-events/news/us-forest-service-job-eliminations-trail-workers/"
              >The Forest Service Is Losing 2,400 Jobsâ€“Including Most of Its
              Trail Workers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 00:13:37</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41920127"
                  >Comments</a
                ><span class="descendants">: 198</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41919711">
          <h3>
            <a
              class="item"
              href="https://science.nasa.gov/missions/chandra/the-dawn-of-a-new-era-for-supernova-1987a/"
              >The Dawn of a New Era for Supernova 1987a</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 23:09:37</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41919711"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41919365">
          <h3>
            <a
              class="item"
              href="https://eukaryotewritesblog.com/2024/10/21/i-got-dysentery-so-you-dont-have-to/"
              >I Got Dysentary So You Don't Have To</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 22:28:10</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41919365"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41919262">
          <h3>
            <a
              class="item"
              href="https://www.micron.com/about/blog/memory/dram/how-dram-changed-the-world"
              >How DRAM changed the world</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 22:12:15</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41919262"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41918621">
          <h3>
            <a
              class="item"
              href="https://github.com/abdulkader-alrezej/ipv6spot"
              >Captive Portal IPv6 Support</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 20:58:07</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41918621"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41917016">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/technology/archive/2017/04/the-tragedy-of-google-books/523320/"
              >The Tragedy of Google Books (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 18:11:03</span
              ><span class="points-container"
                >Points: <span class="points">267</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41917016"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41916322">
          <h3>
            <a
              class="item"
              href="https://www.usgs.gov/news/national-news-release/unlocking-arkansas-hidden-treasure-usgs-uses-machine-learning-show-large"
              >USGS uses machine learning to show large lithium potential in
              Arkansas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 17:05:01</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41916322"
                  >Comments</a
                ><span class="descendants">: 162</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41915958">
          <h3>
            <a class="item" href="https://github.com/solcloud/Counter-Strike"
              >Show HN: Open-source Counter-Strike-like game</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 16:27:51</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41915958"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41915724">
          <h3>
            <a
              class="item"
              href="https://planetscale.com/blog/announcing-planetscale-vectors-public-beta"
              >The PlanetScale vectors public beta</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 16:06:55</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41915724"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41915187">
          <h3>
            <a
              class="item"
              href="https://abcnews.go.com/US/wireStory/ftcs-rule-banning-fake-online-reviews-effect-115009298"
              >FTC's rule banning fake online reviews goes into effect</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 15:21:58</span
              ><span class="points-container"
                >Points: <span class="points">483</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41915187"
                  >Comments</a
                ><span class="descendants">: 269</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41914989">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/news/3-5-models-and-computer-use"
              >Computer use, a new Claude 3.5 Sonnet, and Claude 3.5 Haiku</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 15:02:46</span
              ><span class="points-container"
                >Points: <span class="points">1162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41914989"
                  >Comments</a
                ><span class="descendants">: 612</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41914845">
          <h3>
            <a
              class="item"
              href="https://clickhouse.com/blog/a-new-powerful-json-data-type-for-clickhouse"
              >A new JSON data type for ClickHouse</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 14:47:00</span
              ><span class="points-container"
                >Points: <span class="points">309</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41914845"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41914544">
          <h3>
            <a class="item" href="https://github.com/levkk/rwf"
              >Show HN: Rust Web Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 14:15:54</span
              ><span class="points-container"
                >Points: <span class="points">413</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41914544"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been "funemployed" for a few months and with all that free
                time and idle hands I wrote a full web framework (think Rails,
                not Flask) for Rust.
              </p>
              <p>
                It's boring old MVC, has its own ORM, templates, background
                jobs, auth, websockets, migrations and more. If you're keen but
                don't feel like rewriting your app in a different language, Rwf
                has a WSGI server to run Django (or Flask) inside Rust [1],
                letting you migrate to Rust at your own pace without disrupting
                your website.
              </p>
              <p>
                I think Rust makes a great prototyping and deploy straight to
                production language. Now it has yet another framework for y'all
                to play with.
              </p>
              <p>Cheers!</p>
              <p>
                [1]
                <a href="https://levkk.github.io/rwf/migrating-from-python/"
                  >https://levkk.github.io/rwf/migrating-from-python/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41911575">
          <h3>
            <a class="item" href="https://www.zapspace.net/defender_sound/"
              >Defender Sound Studio</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 05:58:17</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41911575"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41908075">
          <h3>
            <a
              class="item"
              href="https://dlmultimedia.esa.int/download/public/videos/2024/10/023/orig-2410_023_AR_EN.mp4"
              >First images from Euclid are in</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-21 @ 20:15:36</span
              ><span class="points-container"
                >Points: <span class="points">1282</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41908075"
                  >Comments</a
                ><span class="descendants">: 353</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41900190">
          <h3>
            <a
              class="item"
              href="https://github.com/konstin/sudoku-in-python-packaging"
              >Solving Sudoku in Python Packaging</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-21 @ 02:30:28</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41900190"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41898898">
          <h3>
            <a
              class="item"
              href="https://www.owlposting.com/p/a-primer-on-why-computational-predictive"
              >Why computational predictive toxicology is hard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-20 @ 22:09:46</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41898898"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41894765">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41894765"
              >Ask HN: What's the most creative 'useless' program you've ever
              written?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-20 @ 11:56:31</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41894765"
                  >Comments</a
                ><span class="descendants">: 222</span></span
              >
            </h4>
            <div class="text">
              I recently came across the concept of "useless" programs - pieces
              of code that serve no practical purpose but are fun, creative, or
              challenging to write. These could be anything from elaborate ASCII
              art generators to programs that solve imaginary problems. I'm
              curious to hear about the most interesting or creative "useless"
              programs the HN community has written. What was your motivation?
              What unexpected challenges did you face? Did you learn anything
              valuable from the experience? Some examples to get the ball
              rolling: 1. A program that prints the lyrics of "99 Bottles of
              Beer" in binary. A text-based game where you play as a semicolon
              trying to find its way to the end of a line of code. A script that
              translates English text into Shakespearean insults. Share your
              creations, no matter how quirky or impractical. Let's celebrate
              the joy of coding for coding's sake!
            </div>
          </section>
        </section>
        <section id="41889155">
          <h3>
            <a class="item" href="https://alexwlchan.net/2024/hover-states/"
              >Two examples of hover styles on images</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-19 @ 17:29:14</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41889155"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41887924">
          <h3>
            <a
              class="item"
              href="https://shafik.github.io/c++/llvm/2024/10/17/triaging-clang-fronend-bugs.html"
              >Triaging Clang C++ front end bugs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-19 @ 14:24:08</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41887924"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41887360">
          <h3>
            <a class="item" href="https://github.com/alexfedosov/move-tool"
              >Show HN: I made tool for slicing up samples to Ableton Move
              presets</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-19 @ 12:10:46</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41887360"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>
                I hope others find it useful, and at some point, Ableton sees
                the need and provides us with a built-in solution.
              </p>
            </div>
          </section>
        </section>
        <section id="41886047">
          <h3>
            <a
              class="item"
              href="https://blog.wilsonb.com/posts/2024-09-27-brainfuck.html"
              >Implementing Brainfuck in APL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-19 @ 06:32:50</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41886047"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41883365">
          <h3>
            <a
              class="item"
              href="https://github.com/pc2005cz/TheUltimate486Upgrade/blob/main/main.md"
              >Coreboot port for 486 motherboard (UM8881/6)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-18 @ 20:48:43</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41883365"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41880709">
          <h3>
            <a
              class="item"
              href="https://rabbitwaves.ca/site/flags_maritime.html"
              >An Illustrated Guide to Maritime Signal Flags</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-18 @ 16:08:21</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41880709"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
