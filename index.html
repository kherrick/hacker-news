<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38465895">
          <h3>
            <a
              class="item"
              href="https://www.ecns.cn/news/sci-tech/2023-11-29/detail-ihcvixpi0428703.shtml"
              >Loongson releases next-generation CPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 21:58:13</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38465895"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38465736">
          <h3>
            <a
              class="item"
              href="https://www.anandtech.com/show/21172/amazon-unveils-graviton4-a-96core-cpu-with-5367-gbs-memory-bandwidth"
              >Amazon Unveils Graviton4: A 96-Core ARM CPU with 536.7 GBps
              Memory Bandwidth</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 21:44:24</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38465736"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38465693">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/Jerry/921d3846-04e1-4430-a515-b91192a4993c"
              >Jerry (YC S17) Is Hiring VP Product (&amp;amp; Other Engineer and
              PM Roles)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 21:39:11</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38464715">
          <h3>
            <a class="item" href="https://web.mit.edu/~simsong/www/ugh.pdf"
              >The Unix-Haters Handbook (1994) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 20:20:52</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38464715"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38464057">
          <h3>
            <a class="item" href="https://github.com/Mozilla-Ocho/llamafile"
              >Llamafile lets you distribute and run LLMs with a single file</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 19:29:49</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38464057"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38463832">
          <h3>
            <a class="item" href="https://whenistheweekend.com/theSphere.html"
              >Write shaders for the (sim) Vegas sphere</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 19:14:42</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38463832"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38463731">
          <h3>
            <a class="item" href="https://pgxman.com/"
              >Show HN: Pgxman – npm for Postgres extensions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 19:08:15</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38463731"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Installing and updating Postgres extensions is an uphill battle.
                You're left searching for the right build tools and grappling
                with often unclear and incomplete compiling instructions to even
                try one out. But with pgxman, we've streamlined the process to
                one simple step: pgxman install [extension name].
              </p>
              <p>
                For example, to build parquet_s3_fdw manually, you'd need to:
              </p>
              <p>1. Download the parquet_s3_fdw source code;</p>
              <p>
                2. Figure out how to build it by looking at README. When
                unclear, look at the source code how to build it. The README of
                parquet_s3_fdw says it needs libarrow, libparquet &amp; aws_sdk.
                Readme doesn’t say where to get them.
              </p>
              <p>
                3. Make sure all dependencies are available to build the
                project. Either install them from apt, if available, or build
                them manually if not. For parquet_s3_fdw aws_sdk has to be built
                manually — it’s not available in any apt repos
              </p>
              <p>
                4. Build the extension targeting the correct OS, CPU
                architecture and Postgres version.
              </p>
              <p>
                5. Determine and build to the right path
                /usr/lib/postgresql/15/lib - otherwise, Postgres wouldn’t be
                able to find them.
              </p>
              <p>
                6. Repeat across all relevant Postgres instances. Hopefully,
                these Postgres versions are recent or else you’ll have to update
                postgres, set maintenance window, etc.
              </p>
              <p>
                * Added friction: Since parquet_s3_fdw is not designed to use in
                a cloud environment, and we forked it to make changes to make it
                possible to use.
              </p>
              <p>Using pgxman, you can just do:</p>
              <p></p>
              <pre><code>  pgxman install s3_parquet_fdw
</code></pre>
              pgxman integrates with your system package manager, ensuring the
              correct versions are installed without extra packages from any
              shared dependencies between extensions. pgxman’s automated build
              system creates [APT] packages for each Postgres version, platform,
              and OS supported by the extension. Extensions are built from a
              “buildkit” formula, written in YAML, and are contributed through
              GitHub.
              <p>To install pgxman, you can do</p>
              <p></p>
              <pre><code>  brew install pgxman/tap/pgxman
</code></pre>
              or, if you don't mind pipe-to-shell,
              <p></p>
              <pre><code>  curl -sfl https://install.pgx.sh | sh -
</code></pre>
              If you'd like to learn more, we have an extensive blog post here:
              <a
                href="https://www.hydra.so/blog-posts/the-design-of-postgres-extension-manager-pgxman"
                >https://www.hydra.so/blog-posts/the-design-of-postgres-exten...</a
              >.
            </div>
          </section>
        </section>
        <section id="38463355">
          <h3>
            <a
              class="item"
              href="https://www.consumerreports.org/cars/car-reliability-owner-satisfaction/who-makes-the-most-reliable-cars-a7824554938/"
              >Who makes the most reliable new cars?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 18:42:34</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38463355"
                  >Comments</a
                ><span class="descendants">: 199</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38463195">
          <h3>
            <a
              class="item"
              href="https://rootsofprogress.org/steam-engine-origins"
              >The origins of the steam engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 18:32:09</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38463195"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38462318">
          <h3>
            <a
              class="item"
              href="http://peterhajas.com/blog/pokemon_rb_connections.html"
              >Visualizing Pokémon Red and Blue Connections (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 17:32:54</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38462318"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38461344">
          <h3>
            <a
              class="item"
              href="https://www.ri.cmu.edu/app/uploads/2019/09/Person_in_WiFi_ICCV2019.pdf"
              >Person-in-WiFi: Fine-Grained Person Perception Using WiFi
              [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 16:19:33</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38461344"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38461323">
          <h3>
            <a
              class="item"
              href="https://deepmind.google/discover/blog/millions-of-new-materials-discovered-with-deep-learning/"
              >Graph Networks for Materials Exploration</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 16:17:56</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38461323"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38461249">
          <h3>
            <a class="item" href="https://github.com/01mf02/jaq"
              >Jaq – A jq clone focused on correctness, speed, and simplicity</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 16:13:23</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38461249"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38461121">
          <h3>
            <a class="item" href="https://deno.com/blog/cron">Deno Cron</a>
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 16:03:10</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38461121"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38459090">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/bci-ultrasound"
              >New neurotech eschews electricity for ultrasound</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 13:31:14</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38459090"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38458802">
          <h3>
            <a class="item" href="https://github.com/bracesdev/errtrace"
              >Show HN: Error return traces for Go, inspired by Zig</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 13:01:28</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38458802"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38458683">
          <h3>
            <a
              class="item"
              href="https://not-just-memorization.github.io/extracting-training-data-from-chatgpt.html"
              >Extracting training data from ChatGPT</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 12:46:36</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38458683"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38457953">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/Roundcube-Nextcloud"
              >Roundcube open-source webmail software merges with Nextcloud</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 11:03:47</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38457953"
                  >Comments</a
                ><span class="descendants">: 194</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38457815">
          <h3>
            <a class="item" href="https://github.com/dcrebbin/meta-vision-api"
              >Show HN: Hacky Meta Glasses GPT4 Vision Integration</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 10:43:07</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38457815"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
            <div class="text">
              <p>
                In the foodlog demonstration I just made a fake fb account
                (sorry zucc) called "Mye Food-Log".
              </p>
            </div>
          </section>
        </section>
        <section id="38457556">
          <h3>
            <a class="item" href="https://github.com/kmille/freetar"
              >Freetar – an alternative front end for ultimate-guitar.com</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 10:04:26</span
              ><span class="points-container"
                >Points: <span class="points">337</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38457556"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38457247">
          <h3>
            <a
              class="item"
              href="https://xuanwo.io/2023/04-rust-std-fs-slower-than-python/"
              >Rust std fs slower than Python? No, it's hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 09:18:32</span
              ><span class="points-container"
                >Points: <span class="points">554</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38457247"
                  >Comments</a
                ><span class="descendants">: 154</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38457125">
          <h3>
            <a
              class="item"
              href="https://octodon.social/@jalefkowit/111490485825183949"
              >The 1988 shooting down of Flight 655 as a user interface
              disaster</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 08:57:37</span
              ><span class="points-container"
                >Points: <span class="points">697</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38457125"
                  >Comments</a
                ><span class="descendants">: 547</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38456726">
          <h3>
            <a
              class="item"
              href="https://martinfowler.com/articles/exploring-gen-ai.html#memo-08"
              >How to tackle unreliability of coding assistants</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 07:56:36</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38456726"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38456692">
          <h3>
            <a class="item" href="https://imois.in/games/travle/"
              >Travle: A daily game – get between countries in as few guesses as
              possible</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 07:51:25</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38456692"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38456230">
          <h3>
            <a class="item" href="https://synergeticlabs.com/email-alchemy/"
              >Exploring Self-Hosted Email Services</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 06:27:52</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38456230"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38456021">
          <h3>
            <a
              class="item"
              href="https://jackfromeast.site/2023-01/understand-the-heap-a-beautiful-mess.html"
              >Understanding the heap – a beautiful mess</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-29 @ 05:53:12</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38456021"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38453047">
          <h3>
            <a class="item" href="https://dobb-e.com/"
              >Show HN: Dobb·E – towards home robots with an open-source
              platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-28 @ 23:23:54</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38453047"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
            <div class="text">
              <p>
                Here are some more details, below (or see a Twitter thread with
                attached media:
                <a href="https://twitter.com/i/status/1729515379892826211"
                  >https://twitter.com/i/status/1729515379892826211</a
                >
                or
                <a href="https://nitter.net/i/status/1729515379892826211"
                  >https://nitter.net/i/status/1729515379892826211</a
                >):
              </p>
              <p>
                We engineered Dobb·E to maximize efficiency, safety, and user
                comfort. As a system, it is composed of four parts: a data
                collection tool, a home dataset, a pretrained vision model, and
                a policy fine-tuning recipe.
              </p>
              <p>
                We teach our robots with imitation learning, and for data
                collection, we created the “Stick”, a tool made out of $25 of
                hardware and an iPhone.
              </p>
              <p>
                Then, using the Stick, we collected a 13 hour dataset in 22 New
                York homes, called Homes of New York (HoNY). HoNY has 1.5M
                frames collected over 216 different "environments" which is an
                order of magnitude larger compared to similar open source
                datasets.
              </p>
              <p>
                Then we trained a foundational vision model that we can
                fine-tune fast (15 minutes!) on a new task with only 5 minutes
                (human time)/ 90 seconds (demo time) of data. So from start to
                finish, it takes about 20 minutes to teach the robot a new task.
              </p>
              <p>
                Over a month, we visited 10 homes, tried 109 tasks, and got 81%
                success rate in simple household tasks. We also found a line of
                challenges, from mirrors to heavy objects, that we must overcome
                if we are to get a general purpose home robot.
              </p>
              <p>
                We open-sourced our entire system because our primary goal is to
                get more robotics and AI researchers, engineers, and enthusiasts
                to go beyond constrained lab environments and start getting into
                homes!
              </p>
              <p>So here is how you can get started:</p>
              <p>
                1. Code and STL files:
                <a href="https://github.com/notmahi/dobb-e/"
                  >https://github.com/notmahi/dobb-e/</a
                >
              </p>
              <p>
                2. Technical documentation:
                <a href="https://docs.dobb-e.com/">https://docs.dobb-e.com/</a>
              </p>
              <p>
                3. Paper:
                <a href="https://arxiv.org/abs/2311.16098"
                  >https://arxiv.org/abs/2311.16098</a
                >
              </p>
              <p>
                4. More videos and the dataset:
                <a href="https://dobb-e.com">https://dobb-e.com</a>
              </p>
              <p>
                5. Robot we used:
                <a href="https://hello-robot.com">https://hello-robot.com</a>
              </p>
            </div>
          </section>
        </section>
        <section id="38452443">
          <h3>
            <a class="item" href="https://jamie-wong.com/post/color/"
              >Color: From Hexcodes to Eyeballs (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-28 @ 22:37:48</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38452443"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38450760">
          <h3>
            <a
              class="item"
              href="https://www.biodigitaljazz.net/blog/littlebraincell.html"
              >Transistor first reported as "little brain cell"</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-28 @ 20:23:14</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38450760"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38441242">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2023/12/04/how-jensen-huangs-nvidia-is-powering-the-ai-revolution"
              >How Jensen Huang's Nvidia is powering the A.I. revolution</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-28 @ 01:45:38</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38441242"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
