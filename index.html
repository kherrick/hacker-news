<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38975226">
          <h3>
            <a
              class="item"
              href="https://github.com/microsoft/xbox-multiplayer-analysis-tool"
              >Xbox Multiplayer Analysis Tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 22:48:08</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38975226"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38975204">
          <h3>
            <a class="item" href="https://github.com/revng/revng"
              >revng translates (i386, x86-64, MIPS, ARM, AArch64, s390x)
              binaries to LLVM IR</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 22:45:23</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38975204"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38973998">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38973998"
              >Axle (YC S22) is hiring a senior product engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 21:00:57</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Over $13B is spent on uninsured loss every year, and mortgages
                and auto loans are prohibitively expensive for many borrowers.
                Why? In a large part because fleet managers, lenders, and gig
                services are missing access to insurance data.
              </p>
              <p>
                Axle solves this problem - providing instant, continuous access
                to insurance data, enabling our clients to make decisions in
                seconds instead of hours.
              </p>
              <p>
                Axle is a fast growing, seed-stage startup backed by leading
                investors including Google's AI fund, Y Combinator, and angels
                from companies like Plaid. Our team is based in New York and
                Atlanta, where we come together to collaborate between time
                spent working in our own environments.
              </p>
              <p>
                We're looking for someone to be hands on building the product
                and help us shape the engineering culture and practices as we
                grow.
              </p>
              <p>
                For more details, check us out the role here:
                <a href="https://www.ycombinator.com/companies/axle/jobs"
                  >https://www.ycombinator.com/companies/axle/jobs</a
                >.
              </p>
            </div>
          </section>
        </section>
        <section id="38972735">
          <h3>
            <a
              class="item"
              href="https://theintercept.com/2024/01/12/open-ai-military-ban-chatgpt/"
              >OpenAI deletes ban on using ChatGPT for "military and warfare"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 19:27:53</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38972735"
                  >Comments</a
                ><span class="descendants">: 191</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38972358">
          <h3>
            <a class="item" href="https://github.com/FrigadeHQ/remote-storage"
              >Show HN: RemoteStorage – sync localStorage across devices and
              browsers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 19:01:00</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38972358"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <p>
                When building frontends with Javascript, the native localStorage
                API is super useful for keeping track of state between sessions
                in the same browser, but it's not as good a solution when your
                data needs to be shared across multiple devices or browsers.
              </p>
              <p>
                For instance, let's say you want to show a welcome modal to all
                new users that sign up for your product. If you use localStorage
                to track if a user has already seen this modal, your users will
                end up getting the experience repeatedly every time they switch
                devices or browsers, or whenever Chrome decides to nuke your
                data.
              </p>
              <p>
                I built remoteStorage to help fix that. Using the same API as
                localStorage, remoteStorage allows you to easily read and write
                data on the fly while maintaining state across browsers and
                devices in order to provide a better user experience.
              </p>
              <p>
                The project is built as a monorepo in Typescript and contains a
                JS library that works across any Javascript stack (including
                Node.js and React Native) and is lightweight (~1 kb minified).
                The server is built with Nest.js with a disk-persisted Redis
                Database. It can be deployed in a few minutes using Docker.
              </p>
              <p>
                One of the biggest challenges when building this was coming up
                with a secure scheme for handling authentication while still
                keeping the API dead simple for frontend devs to use. While the
                project is intended to store non-sensitive data like impression
                events/preferences, I still wanted to make sure data couldn’t
                easily leak or be tampered with.
              </p>
              <p>
                One solution has been to generate a unique secret UUID per user
                on your own backend to identify the user. Alternatively, you
                could create a simple wrapper/proxy API around remoteStorage
                that uses your own authentication method to verify the user's
                identity before allowing them to access the data (this is super
                simple to build with React Server Components). Then, you could
                pick a secure and secret Instance ID that is not publicly
                available to ensure that only your application can access the
                data.
              </p>
              <p>
                Has anyone felt the same pain points with localStorage before?
                Is this solution useful? Let me know what you think or ideas for
                how I can improve it :)
              </p>
            </div>
          </section>
        </section>
        <section id="38972153">
          <h3><a class="item" href="https://devdocs.io">DevDocs</a></h3>
          <section>
            <h4>
              <span>2024-01-12 @ 18:46:39</span
              ><span class="points-container"
                >Points: <span class="points">232</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38972153"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38971966">
          <h3>
            <a class="item" href="https://github.com/marimo-team/marimo"
              >Show HN: Marimo – an open-source reactive notebook for Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 18:33:17</span
              ><span class="points-container"
                >Points: <span class="points">233</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38971966"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
            <div class="text">
              <p>
                GitHub repo:
                <a href="https://github.com/marimo-team/marimo"
                  >https://github.com/marimo-team/marimo</a
                >
              </p>
              <p>
                In marimo, a notebook’s code, outputs, and program state are
                always consistent. Run a cell and marimo reacts by automatically
                running the cells that reference its declared variables. Delete
                a cell and marimo scrubs its variables from program memory,
                eliminating hidden state. Our reactive runtime is based on
                static analysis, so it’s performant. If you’re worried about
                accidentally triggering expensive computations, you can disable
                specific cells from auto-running.
              </p>
              <p>
                marimo comes with UI elements like sliders, a dataframe
                transformer, and interactive plots that are automatically
                synchronized with Python [3]. Interact with an element and the
                cells that use it are automatically re-run with its latest
                value. Reactivity makes these UI elements more useful and
                ergonomic than Jupyter’s ipywidgets.
              </p>
              <p>
                Every marimo notebook can be run as a script from the command
                line, with cells executed in a topologically sorted order, or
                served as an interactive web app, using the marimo CLI.
              </p>
              <p>
                We’re a team of just two developers. We chose to develop marimo
                because we believe that the Python community deserves a better
                programming environment to do research and communicate it;
                experiment with code and share it; and learn computational
                science and teach it. We’ve seen lots of research start in
                Jupyter notebooks (much of my own has), only to fail to
                reproduce; lots of promising prototypes built that were never
                made real; and lots of tutorials written that failed to engage
                students.
              </p>
              <p>
                marimo has been developed with the close input of scientists and
                engineers, and with inspiration from many tools, including
                Pluto.jl and streamlit. We open-sourced it recently because we
                feel it’s ready for broader use. Please try it out (pip install
                marimo &amp;&amp; marimo tutorial intro). We’d appreciate your
                feedback!
              </p>
              <p>
                [1]
                <a href="https://github.com/marimo-team/marimo"
                  >https://github.com/marimo-team/marimo</a
                >
              </p>
              <p>
                [2]
                <a href="https://docs.marimo.io/faq.html#faq-problems"
                  >https://docs.marimo.io/faq.html#faq-problems</a
                >
              </p>
              <p>
                [3]
                <a href="https://docs.marimo.io/api/inputs/index.html"
                  >https://docs.marimo.io/api/inputs/index.html</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="38971409">
          <h3>
            <a
              class="item"
              href="https://status.kagi.com/issues/2024-01-12-kagi-down-on-some-regions/"
              >Kagi.com is unstable for all regions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 17:52:47</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38971409"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38971221">
          <h3>
            <a
              class="item"
              href="https://tge-data-web.nyc3.digitaloceanspaces.com/docs/Vector%20Databases%20-%20A%20Technical%20Primer.pdf"
              >Vector Databases: A Technical Primer [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 17:38:56</span
              ><span class="points-container"
                >Points: <span class="points">324</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38971221"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38971178">
          <h3>
            <a
              class="item"
              href="https://signoz.io/blog/opentelemetry-roundup-2023/"
              >The current state of OpenTelemetry</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 17:36:07</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38971178"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38971012">
          <h3>
            <a
              class="item"
              href="https://www.amazon.com/fulfill-request-respectful-information-users-Brown/dp/B0CM82FJL2"
              >I'm sorry but I cannot fulfill this request it goes against
              OpenAI use policy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 17:27:10</span
              ><span class="points-container"
                >Points: <span class="points">1009</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38971012"
                  >Comments</a
                ><span class="descendants">: 559</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38969893">
          <h3>
            <a class="item" href="https://lfranke.github.io/trips/"
              >Trilinear point splatting for real-time radiance field
              rendering</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 16:18:23</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38969893"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38969759">
          <h3>
            <a
              class="item"
              href="https://www.bluetooth.com/bluetooth-resources/features-benefits-bluetooth-mesh/"
              >Features and Benefits of Bluetooth Mesh 1.1 for Wireless Mesh
              Networking</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 16:09:25</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38969759"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38969466">
          <h3>
            <a class="item" href="https://on.ft.com/4aV0CQ7"
              >US regulator considers stripping Boeing's right to self-inspect
              planes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 15:49:08</span
              ><span class="points-container"
                >Points: <span class="points">600</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38969466"
                  >Comments</a
                ><span class="descendants">: 284</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38969348">
          <h3>
            <a
              class="item"
              href="https://www.theengineer.co.uk/content/news/autophage-rocket-engine-consumes-plastic-fuselage-for-fuel"
              >Autophage rocket engine consumes plastic fuselage for fuel</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 15:41:25</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38969348"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38969072">
          <h3>
            <a
              class="item"
              href="https://www.espressif.com/en/news/ESP32-C61_SoC"
              >ESP32-C61: Delivering Affordable Wi-Fi 6 Connectivity</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 15:21:49</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38969072"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38967744">
          <h3>
            <a
              class="item"
              href="https://blog.google/products/assistant/google-assistant-update-january-2024/"
              >Changes we're making to Google Assistant</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 13:36:53</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38967744"
                  >Comments</a
                ><span class="descendants">: 199</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38967684">
          <h3>
            <a
              class="item"
              href="https://apps.apple.com/us/app/amazing-ai/id1660147028?platform=iphone"
              >Show HN: Run Stable Diffusion Directly on iPhone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 13:30:34</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38967684"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38966601">
          <h3>
            <a
              class="item"
              href="https://www.tweag.io/blog/2023-10-05-cli-ux-in-topiary/"
              >CLI user experience case study</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 11:01:47</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38966601"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38966129">
          <h3>
            <a
              class="item"
              href="https://asteriskmag.com/issues/04/mysticism-empiricism"
              >Mysticism and Empiricism</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 09:57:48</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38966129"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38965717">
          <h3>
            <a
              class="item"
              href="https://www.williamrchase.com/writing/2019-11-10-font-height-differences-between-windows-and-mac"
              >Font height differences between Windows and Mac (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 09:00:37</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38965717"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38965429">
          <h3>
            <a class="item" href="https://game-of-life-f262d.web.app/"
              >Show HN: Conway's Game of Life, but with a gallery of other
              peoples patterns</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 08:12:00</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38965429"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>
                This project has served as a sandbox for me to practice various
                aspects of developing a comprehensive web application from
                scratch. This was my first time developing a full scale web app
                with [almost] all the features you would expect. I know it is
                nowhere near perfect in its current state, but I feel it has
                reached a point of diminishing returns, and therefore my time is
                better spent focussing on other projects with more potential. I
                may continue to develop this project further in the future just
                for fun.
              </p>
            </div>
          </section>
        </section>
        <section id="38965310">
          <h3>
            <a
              class="item"
              href="https://plato.stanford.edu/entries/inner-speech/"
              >Inner Speech</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 07:55:33</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38965310"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38964972">
          <h3>
            <a
              class="item"
              href="https://mfkl.github.io/2024/01/10/unity-double-oss-standards.html"
              >Unity's Open-Source Double Standard: The Ban of VLC</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 07:05:30</span
              ><span class="points-container"
                >Points: <span class="points">949</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38964972"
                  >Comments</a
                ><span class="descendants">: 325</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38963740">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/first-roman-gladiators"
              >The Surprising Roots of Ancient Rome's Gladiator Fights</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-12 @ 04:28:14</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38963740"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38955018">
          <h3>
            <a
              class="item"
              href="https://blog.cryptographyengineering.com/2024/01/11/attack-of-the-week-airdrop-tracing/"
              >Attack of the Week: Airdrop Tracing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-11 @ 17:03:22</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38955018"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38951347">
          <h3>
            <a
              class="item"
              href="http://www.righto.com/2021/11/reverse-engineering-yamaha-dx7.html"
              >Reverse-engineering the Yamaha DX7 synthesizer's sound chip from
              die photos (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-11 @ 12:30:50</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38951347"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38951214">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2024/01/the-largest-us-dam-removal-effort-to-date-has-begun/"
              >The largest US dam-removal effort to date has begun</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-11 @ 12:15:10</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38951214"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38949966">
          <h3>
            <a
              class="item"
              href="https://susam.net/maze/elisp-in-replacement-string.html"
              >Elisp in Replacement String</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-11 @ 09:45:57</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38949966"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38948652">
          <h3>
            <a
              class="item"
              href="https://mstdn.social/@RickyRomero/111666711075000961"
              >Diamond Subpixel Arrangement Simulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-11 @ 06:45:06</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38948652"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
