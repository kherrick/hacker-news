<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40670898">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/tech-industry/amd-ceo-lisa-su-reminisces-on-helping-design-the-ps3s-infamous-cell-processor-at-ibm"
              >AMD CEO Lisa Su reminisces about designing the PS3's infamous
              Cell processor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 15:31:30</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40670898"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40670880">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20240613-how-to-cool-down-urban-heat-islands-in-americas-heatwaves"
              >How do you cool a 100F city?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 15:30:21</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40670880"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40670612">
          <h3>
            <a
              class="item"
              href="https://engineering.fb.com/2024/06/13/web/mlow-metas-low-bitrate-audio-codec/"
              >MLow: Meta's low bitrate audio codec</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 15:05:18</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40670612"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40670242">
          <h3>
            <a class="item" href="https://www.mdpi.com/2304-8158/2/4/499"
              >Iridescence in Meat Caused by Surface Gratings</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 14:37:06</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40670242"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40669866">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2024-06-13/wells-fires-over-a-dozen-for-simulation-of-keyboard-activity"
              >Wells Fargo Fires Over a Dozen for 'Simulation of Keyboard
              Activity'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 14:08:49</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40669866"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40669827">
          <h3>
            <a
              class="item"
              href="https://www.anandtech.com/show/21445/qualcomm-snapdragon-x-architecture-deep-dive"
              >The Qualcomm Snapdragon X Architecture Deep Dive: Getting to Know
              Oryon</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 14:06:31</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40669827"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40669337">
          <h3>
            <a class="item" href="https://github.com/shell-pool/shpool"
              >Show HN: Shpool, a Lightweight Tmux Alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 13:22:29</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40669337"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
            <div class="text">
              shpool is a terminal session persistence tool developed internally
              at google to support remote workflows, which we have open sourced.
            </div>
          </section>
        </section>
        <section id="40668572">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/reworkd/jobs/4f6BHpT-founding-engineer"
              >Reworkd (YC S23) Is Hiring a founding back end/infrastructure
              engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 12:00:36</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40668088">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/3d-printed-rocket"
              >Indian Startup 3D Prints Rocket Engine in Just 72 Hours</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 11:02:11</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40668088"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40667976">
          <h3>
            <a
              class="item"
              href="https://www.propublica.org/article/microsoft-solarwinds-golden-saml-data-breach-russian-hackers"
              >Microsoft Chose Profit over Security, Whistleblower Says</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 10:39:45</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40667976"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40667786">
          <h3>
            <a
              class="item"
              href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2024GL109280"
              >Potential Ozone Depletion from Satellite Demise During
              Atmospheric Reentry</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 10:06:26</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40667786"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40665734">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2406.08478"
              >What If We Recaption Billions of Web Images with LLaMA-3?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 03:44:55</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40665734"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40665721">
          <h3>
            <a
              class="item"
              href="https://huggingface.co/blog/mlabonne/abliteration"
              >Uncensor any LLM with abliteration</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 03:42:39</span
              ><span class="points-container"
                >Points: <span class="points">383</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40665721"
                  >Comments</a
                ><span class="descendants">: 178</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40665023">
          <h3>
            <a
              class="item"
              href="https://www.netmeister.org/blog/cidr-allocations.html"
              >Whose CIDR is it anyway?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-13 @ 01:31:28</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40665023"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40664339">
          <h3>
            <a
              class="item"
              href="https://engineering.fb.com/2024/06/12/data-infrastructure/training-large-language-models-at-scale-meta/"
              >How Meta trains large language models at scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 23:35:08</span
              ><span class="points-container"
                >Points: <span class="points">353</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40664339"
                  >Comments</a
                ><span class="descendants">: 173</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40663704">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=2MYzvQ1v8Ww"
              >Gerald Sussman: Programming is (should be) fun (2022) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 22:02:27</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40663704"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40662176">
          <h3>
            <a
              class="item"
              href="https://english.kyodonews.net/news/2024/06/bc2d7f45d456-japan-enacts-law-to-curb-apple-googles-app-dominance.html#google_vignette"
              >Japan enacts law to promote competition in smartphone app
              stores</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 19:43:50</span
              ><span class="points-container"
                >Points: <span class="points">412</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40662176"
                  >Comments</a
                ><span class="descendants">: 278</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40661703">
          <h3>
            <a
              class="item"
              href="https://blog.chromium.org/2024/06/building-faster-smarter-chromebook.html"
              >ChromeOS will soon be developed on large portions of the Android
              stack</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 19:02:46</span
              ><span class="points-container"
                >Points: <span class="points">278</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40661703"
                  >Comments</a
                ><span class="descendants">: 374</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40660986">
          <h3>
            <a
              class="item"
              href="https://stamen.com/designing-the-avocado-of-uncertainty/"
              >Designing the avocado of uncertainty visualization</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 17:58:14</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40660986"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40660761">
          <h3>
            <a class="item" href="https://computerwebsite.net/writing/gjk"
              >The GJK Algorithm: A weird and beautiful way to do a simple
              thing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 17:35:09</span
              ><span class="points-container"
                >Points: <span class="points">555</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40660761"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40660689">
          <h3>
            <a
              class="item"
              href="https://wp.optics.arizona.edu/oscoutreach/diffractive-chocolate/"
              >Diffractive Chocolate</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 17:27:33</span
              ><span class="points-container"
                >Points: <span class="points">213</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40660689"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40659236">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40659236"
              >Launch HN: Overwatch (YC S22): OSINT platform for cyber and fraud
              risk</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 15:32:53</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40659236"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.overwatchdata.ai"
                >https://www.overwatchdata.ai</a
              >), a platform to automate OSINT and threat intel, turning it into
              actionable insights. Check out our clickthrough demo here:
              <a href="https://app.storylane.io/share/qyayvtamapis"
                >https://app.storylane.io/share/qyayvtamapis</a
              >.
              <p>
                Overwatch began when we were working with risk and threat intel
                teams at Google, Stripe, and government. We experienced the
                immense challenge every fraud and cyber threat analyst faces:
                manually parsing through an ocean of data to find valuable
                insights and filter out the noise. This included using many of
                the feeds and tools out there that were often very expensive,
                noisy, keyword-based, and lacked accurate entity extraction or
                advanced query features.
              </p>
              <p>
                Most threat intelligence tools utilize thousands of keywords and
                teams of analysts to manually sift through torrents of alerts.
                These alerts are usually individual posts on various platforms
                across news, social media, deep and dark web sources that have
                some matching keyword. This is full of false positives,
                requiring many hours to wade through to figure out what intel
                matters most to our users, why, and what they can do next.
              </p>
              <p>
                Overwatch uses an alternative approach by layering AI agents and
                NLP techniques, including a combination of multifarious
                datasets, cluster analysis, topic modeling, Retrieval Augmented
                Language Models (RALM) and domain knowledgeable agents.
              </p>
              <p>
                This allows us to (1) Filter through OSINT in real time to
                identify events and narratives that matter to our users, and
                write reports on what they could do about it; (2) Identify dark
                web and deep web threats, fraud methods, new tactics, and
                compromised accounts, stolen checks, and credentials affecting
                our users or their peers; (3) Send an alert any time one a 3rd
                party supplier or parts of the tech stack are impacted by a
                widely exploited vulnerability, ransomware attack, or breach;
                and (4) Track malware and ransomware groups that are actively
                targeting your industry including Indicators of Compromise
                (IOCs).
              </p>
              <p>
                Our intelligence is actionable because the alert comes with the
                context and important details that an analyst needs to make an
                informed decision. Being AI-native, we also have a range of chat
                and data visualization features to effectively function as an
                intel co-pilot or industry expert. Finally, our in-house
                intelligence analysts and investigators can assist threat
                intelligence teams with HUMINT investigations and darkweb
                acquisition.
              </p>
              <p>
                Our current customers include internet platforms, financial
                institutions, and supply chain companies. Within a day of one
                breach, one of our customers used Overwatch to surface 18,000+
                leaked credentials. Another used us to surface fraudulent checks
                and learn exactly how threat actors were targeting their
                specific product features.
              </p>
              <p>
                Our website says “Request a demo” but if you want to poke around
                on a very basic example of how we’re aggregating dark web, deep
                web, social, and surface web, log in at
                <a href="https://app.overwatchdata.io/"
                  >https://app.overwatchdata.io/</a
                >
                using these credentials: username:
                try_overwatch@overwatchdata.io pw: HelloHNWorld
              </p>
              <p>
                That login is for an un-personalized feed of cyber threat intel
                (breaches, vulnerabilities, ransomed organizations, and industry
                updates) that gives you a flavor of not just the kind of
                information from which we can collect, but more importantly, how
                our technology prioritizes, clusters, and summarizes alerts for
                cyber / fraud analysts. Try the chat agent on the left-hand side
                to parse through the data.
              </p>
              <p>
                Or sign up for a longer trial and preview of our email alerts:
                <a href="https://xryl45u9uep.typeform.com/to/pvtZQyS0"
                  >https://xryl45u9uep.typeform.com/to/pvtZQyS0</a
                >. You can also check out our clickthrough demo for dark and
                deep web intelligence:
                <a href="https://app.storylane.io/share/qyayvtamapis"
                  >https://app.storylane.io/share/qyayvtamapis</a
                >.
              </p>
              <p>
                Integration options range from simple dashboard access to our
                API for those who want to weave our intelligence directly into
                other products. Pricing is dependent on how complex a threat
                landscape our users want to monitor and we’re still figuring out
                how to standardize this but we’ll always do our best for the HN
                community.
              </p>
              <p>
                Since the platform is AI-powered, it can also be used for news
                monitoring, supply chain disruptions, regulatory monitoring, or
                social media monitoring. We’ve had a lot of experience wrangling
                text-based feeds and using numerous AI-models (from embeddings,
                entity extractors, and LLMs) to filter, categorize, cluster, and
                analyze the data into meaning - so let us know if you’d like to
                nerd-out or have had any particular challenges. Looking forward
                to your feedback and questions! Thanks, HN!
              </p>
            </div>
          </section>
        </section>
        <section id="40657574">
          <h3>
            <a
              class="item"
              href="https://staniks.github.io/articles/serious-engine-networking-analysis"
              >Serious Sam handled massive amounts of enemies on 56k modem
              connections</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 12:55:15</span
              ><span class="points-container"
                >Points: <span class="points">345</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40657574"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40657467">
          <h3>
            <a class="item" href="https://drawingmachines.org/"
              >Drawing Machines</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-12 @ 12:44:14</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40657467"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40650974">
          <h3>
            <a class="item" href="https://github.com/lexbor/lexbor"
              >Lexbor – An open source HTML Renderer library</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-11 @ 20:16:23</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40650974"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40648082">
          <h3>
            <a class="item" href="https://twenty.com"
              >Twenty, a modern CRM alternative to Salesforce</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-11 @ 16:15:47</span
              ><span class="points-container"
                >Points: <span class="points">338</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40648082"
                  >Comments</a
                ><span class="descendants">: 143</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40645773">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/06/11/science/mushroom-hunters-dna.html"
              >Mushroom Hunters Can't Stop Finding Mysterious Fungi</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-11 @ 13:05:52</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40645773"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40645726">
          <h3>
            <a
              class="item"
              href="https://resobscura.substack.com/p/centuries-of-childhood"
              >Centuries of Childhood</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-11 @ 13:00:37</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40645726"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40644960">
          <h3>
            <a class="item" href="https://www.authorclock.com/"
              >Author Clock: a novel way to tell time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-11 @ 11:24:20</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40644960"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40644366">
          <h3>
            <a
              class="item"
              href="https://news.artnet.com/art-world/medieval-game-pieces-emerge-from-the-ruins-of-a-mysterious-german-castle-2497815"
              >Medieval game pieces emerge from the ruins of a German castle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-11 @ 09:51:48</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40644366"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
