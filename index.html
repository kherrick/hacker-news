<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38548209">
          <h3>
            <a
              class="item"
              href="https://quad9.net/news/blog/quad9-turns-the-sony-case-around-in-dresden/"
              >Quad9 turns the Sony case around in Dresden</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 19:11:46</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38548209"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38548130">
          <h3>
            <a
              class="item"
              href="https://wikimediafoundation.org/news/2023/12/05/introducing-wikifunctions-first-wikimedia-project-to-launch-in-a-decade-creates-new-forms-of-knowledge/"
              >Wikifunctions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 19:04:28</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38548130"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38547737">
          <h3>
            <a class="item" href="https://www.dataorienteddesign.com/dodbook/"
              >Data-Oriented Design</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 18:30:15</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38547737"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38547556">
          <h3>
            <a
              class="item"
              href="https://postgresml.org/blog/introducing-the-openai-switch-kit-move-from-closed-to-open-source-ai-in-minutes"
              >OpenAI Switch Kit: Swap OpenAI with any open-source model</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 18:17:49</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38547556"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38547203">
          <h3>
            <a class="item" href="https://w3c.social/@w3c/111534700276754588"
              >W3C Leaves Twitter</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 17:49:57</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38547203"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38547033">
          <h3>
            <a class="item" href="https://www.lume.ai/"
              >Show HN: Lume – automate data mappings using AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 17:37:48</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38547033"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.lume.ai/">https://www.lume.ai/</a>).
              <p>
                At Lume, we use AI to automatically transform your source data
                into any desired target schema in seconds, making onboarding
                client data or integrating with new systems take seconds rather
                than days or weeks. In other words, we use AI to automatically
                map data between any two data schemas, and output the
                transformed data to you.
              </p>
              <p>
                We are live with customers and are just beginning to open up our
                product to more prospects. Although we do not have a sandbox
                yet, here is a video walkthrough of how the product works:
                <a
                  href="https://www.loom.com/share/c651b9de5dc8436e91da96f88e7256ec?sid=4e8d65a9-e49c-408c-86f5-3994f38acb41"
                  >https://www.loom.com/share/c651b9de5dc8436e91da96f88e7256ec?...</a
                >. And, here is our documentation:
                <a href="https://docs.lume.ai">https://docs.lume.ai</a>. We
                would love to get you set up to test it, so please reach out.
              </p>
              <p>
                Using Lume: we do not have self-serve yet. In the meantime, you
                can request full access to our API through the Request Access
                button in <a href="https://www.lume.ai">https://www.lume.ai</a>.
                The form asks for quick information e.g. email so that I can
                reach out to you to onboard you. Please mention you came from HN
                and I’ll prioritize your request.
              </p>
              <p>
                How our full API product offering works: Through Lume’s API,
                users can specify their source data and target schema. Lume’s
                engine, which includes AI and rule-based models, creates the
                desired transformation under the hood by producing the necessary
                logic, and returns the transformed data in the response.
              </p>
              <p>
                We also support mapper deployment, which allows you to edit and
                save the AI generated mappers for important production use
                cases. This allows you to confidently reuse a static and
                deterministic mapper for your data pipelines.
              </p>
              <p>Our clients have three primary use cases</p>
              <p>
                - Ingest Client Data: Each client you work with handles data
                differently. They name, format, and handle their data in their
                own way, and it means you have to iteratively ingest each new
                client's data.
              </p>
              <p>
                - Normalize data from unique data systems. To provide your
                business value, your team needs to connect to various data
                providers or handle legacy data. Creating pipelines from each
                one is time consuming, and things as small as column name
                differences between systems makes it burdensome to get started.
              </p>
              <p>
                - Build and maintain data pipelines. Creating different
                pipelines to that map to your target schema, whether for BI
                tooling, downstream data processing, or other purposes, means
                you have to manually create and maintain these mappings between
                schemas.
              </p>
              <p>
                We're still trying to figure out pricing so we don't have that
                on our website yet - sorry, but we wanted to share this even
                though it's still at an early stage.
              </p>
              <p>
                We’d love your feedback, ideas &amp; questions. Also, feel free
                to reach out to me directly at nicolas@lume.ai. Thank you.
              </p>
            </div>
          </section>
        </section>
        <section id="38546520">
          <h3>
            <a class="item" href="https://spotlightjs.com/"
              >Spotlight: Sentry for Development</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 17:03:27</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38546520"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38546478">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/polymath-robotics/jobs/5icOcQK-robotics-safety-engineer-in-san-francisco"
              >Polymath Robotics (YC S22) is hiring a robotics safety engineer –
              San Francisco</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 17:01:07</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38546121">
          <h3>
            <a class="item" href="https://www.flickr.org/tools/flickypedia/"
              >Flickypedia helps you put Flickr photos on Wikimedia Commons</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 16:34:01</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38546121"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38545538">
          <h3>
            <a class="item" href="https://github.com/winglang/wing"
              >Show HN: Winglang – a new Cloud-Oriented programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 15:56:30</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38545538"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38545417">
          <h3>
            <a
              class="item"
              href="https://spacetimedb.com/blog/databases-and-data-oriented-design"
              >Databases are the endgame for data-oriented design</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 15:48:44</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38545417"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38545207">
          <h3>
            <a class="item" href="https://github.com/CopilotKit/CopilotKit"
              >Show HN: CopilotKit- Build in-app AI chatbots and AI-powered
              Textareas</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 15:35:41</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38545207"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38544824">
          <h3>
            <a
              class="item"
              href="https://cloud.google.com/blog/products/ai-machine-learning/introducing-cloud-tpu-v5p-and-ai-hypercomputer"
              >Cloud TPU v5p and AI Hypercomputer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 15:10:46</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38544824"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38544729">
          <h3>
            <a class="item" href="https://deepmind.google/technologies/gemini/"
              >Gemini</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 15:03:47</span
              ><span class="points-container"
                >Points: <span class="points">734</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38544729"
                  >Comments</a
                ><span class="descendants">: 747</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38543947">
          <h3>
            <a class="item" href="https://marincomics.com/amiga-demoscene/"
              >Show HN: Why is the Amiga so beloved in the demoscene? (2023
              essay)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 13:59:21</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38543947"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                Let's explore the birth of the demoscene, the Amiga platform's
                revolutionary beginnings, its emotional resonance within a
                dedicated community, and its broader influence on the field of
                computer graphics and sound.
              </p>
            </div>
          </section>
        </section>
        <section id="38543229">
          <h3>
            <a
              class="item"
              href="https://www.epa.gov/mold/mold-course-introduction"
              >Mold Course</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 12:58:29</span
              ><span class="points-container"
                >Points: <span class="points">244</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38543229"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38543155">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/cybersecurity/governments-spying-apple-google-users-through-push-notifications-us-senator-2023-12-06/"
              >Governments spying on Apple, Google users through push
              notifications</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 12:49:52</span
              ><span class="points-container"
                >Points: <span class="points">512</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38543155"
                  >Comments</a
                ><span class="descendants">: 449</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38543029">
          <h3>
            <a class="item" href="https://yformer.github.io/efficient-sam/"
              >EfficientSAM</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 12:35:21</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38543029"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38542875">
          <h3>
            <a
              class="item"
              href="https://blog.playcanvas.com//compressing-gaussian-splats/"
              >Compressing Gaussian Splats</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 12:18:48</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38542875"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38542764">
          <h3>
            <a
              class="item"
              href="https://fly.io/blog/rethinking-serverless-with-flame/"
              >Rethinking Serverless with Flame</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 12:03:39</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38542764"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38541640">
          <h3>
            <a
              class="item"
              href="https://thewebshowcase.withgoogle.com/bring-code-from-platforms-into-the-browser"
              >Bring code from other platforms into the browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 08:27:46</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38541640"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38540761">
          <h3>
            <a
              class="item"
              href="https://aphyr.com/posts/367-why-is-jepsen-written-in-clojure"
              >Why is Jepsen written in Clojure?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-06 @ 05:32:43</span
              ><span class="points-container"
                >Points: <span class="points">409</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38540761"
                  >Comments</a
                ><span class="descendants">: 203</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38538111">
          <h3>
            <a class="item" href="https://thume.ca/2023/12/02/tracing-methods/"
              >All my favorite tracing tools</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 22:56:29</span
              ><span class="points-container"
                >Points: <span class="points">296</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38538111"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38536252">
          <h3>
            <a
              class="item"
              href="https://thereader.mitpress.mit.edu/lessons-from-lake-tanganyikas-scale-eating-fish/"
              >Lessons from Lake Tanganyika's Scale Eating Fish</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 20:06:59</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38536252"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38529679">
          <h3>
            <a class="item" href="https://bentsukun.ch/posts/os-culture/"
              >Operating Systems, Transit and Cultural Influences</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 11:44:26</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38529679"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38529143">
          <h3>
            <a
              class="item"
              href="https://medium.com/@happybits/how-hackerman-would-create-an-image-just-by-typing-zeros-and-ones-a-deep-dive-into-gif-file-32bada0926c0"
              >How Hackerman would create an image just by typing 0 and 1 – a
              deep dive to GIF</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 10:30:36</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38529143"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38528488">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/marine/heave-oscillators-wave-energy-ship/"
              >"Heaving oscillators" use wave power to extend shipping range</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 09:02:48</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38528488"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38528416">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gaming/2023/11/infocoms-ingenious-code-porting-tools-for-zork-and-other-games-have-been-found/"
              >Infocom’s code-porting tools for Zork and other games have been
              found</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-05 @ 08:49:50</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38528416"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38521822">
          <h3>
            <a class="item" href="https://musicfromouterspace.com/"
              >Music from Outer Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 19:22:05</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38521822"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38516699">
          <h3>
            <a class="item" href="https://www.penciltalk.org/">Pencil Talk</a>
          </h3>
          <section>
            <h4>
              <span>2023-12-04 @ 13:00:11</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38516699"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
