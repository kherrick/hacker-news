<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40276687">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40276687"
              >Ask HN: How to do simple heartbeat monitoring?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 16:54:01</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40276687"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <p>
                My team is hosting an API that sends open telemetry data to
                Signoz &amp; manages on-call via PagerDuty. We've configured
                Signoz to hit Pagerduty when there's a series of 500 errors.
              </p>
              <p>
                However, our server went down last night and NO opentel data was
                sent to Signoz. We weren't notified that the server went down as
                there weren't 500 responses to report. What's the easiest way to
                have a cron-like query hit our API and integrate with our
                existing stack? Is this feasible with our existing vendors?
                Should I have a serverless function running on a timer that uses
                Pagerduty's API? Should I be migrating to another monitoring
                service?
              </p>
              <p>Any advice would be appreciated!</p>
            </div>
          </section>
        </section>
        <section id="40276550">
          <h3>
            <a
              class="item"
              href="https://github.com/haizelabs/thorn-in-haizestack"
              >Thorn in a HaizeStack test for evaluating long-context
              adversarial robustness</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 16:40:30</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40276550"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40276465">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=1fikd9NfsSA"
              >Largest model railway launches inductive Formula 1 circuit
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 16:31:05</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40276465"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40276451">
          <h3>
            <a
              class="item"
              href="https://github.blog/2024-05-02-introducing-artifact-attestations-now-in-public-beta/"
              >Artifact Attestations–now in public beta</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 16:29:03</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40276451"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40275986">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/travel/article/20231024-why-your-balsamic-vinegar-is-likely-fake"
              >Balsamic vinegar is likely fake</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 15:47:07</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40275986"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40275759">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/sciadv.adl2524"
              >Evaluating bias and noise induced by the U.S. Census Bureau's
              privacy protection</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 15:24:30</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40275759"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40275639">
          <h3>
            <a
              class="item"
              href="https://ai.nejm.org/doi/full/10.1056/AIdbp2300040"
              >Large Language Models Are Poor Medical Coders</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 15:15:06</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40275639"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40275235">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/business/finance/robinhood-crypto-gets-wells-notice-us-sec-2024-05-06/"
              >Robinhood Crypto Gets Wells Notice from US SEC</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 14:39:41</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40275235"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40274777">
          <h3>
            <a class="item" href="https://voidstarsec.com/blog/jtag-pifex"
              >PiFex: JTAG Hacking with a Raspberry Pi</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 13:59:42</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40274777"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40274662">
          <h3>
            <a
              class="item"
              href="https://keygen.sh/blog/your-14-day-free-trial-aint-gonna-cut-it/"
              >A fourteen-day free trial ain’t gonna cut it</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 13:50:10</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40274662"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40273780">
          <h3>
            <a
              class="item"
              href="https://thereader.mitpress.mit.edu/daniel-dennett-where-am-i/"
              >Daniel Dennett: 'Where Am I?'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 12:21:07</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40273780"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40273587">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/fern/jobs/KmSsgCu-deployed-engineer"
              >Fern (YC W23) Is Hiring a Customer-Centric Software Engineer in
              NYC</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 12:00:11</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40273470">
          <h3>
            <a class="item" href="https://www.getanyplant.com/plants"
              >Show HN: A free site to explore and discover 6k plants</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 11:42:41</span
              ><span class="points-container"
                >Points: <span class="points">189</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40273470"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
            <div class="text">
              <p>
                I’m a data scientist by profession, so probably 80% of the work
                was totally new to me. I built v1 using wordpress , v2 using
                django, and v3 I pivoted to using react and next js for
                frontend.
              </p>
              <p>
                I would greatly appreciate any feedback on the site as well as
                any advice on how to grow it.
              </p>
            </div>
          </section>
        </section>
        <section id="40273177">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40273177"
              >Ask HN: Interesting TUIs (text user interfaces), maybe forgotten
              ones?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 10:50:19</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40273177"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>
                (I'm only familiar with a handful of modern ones in Emacs—Magit,
                the SLIME inspector, dired, as well as the terminal TUI from the
                Linux tool perf).
              </p>
            </div>
          </section>
        </section>
        <section id="40270586">
          <h3>
            <a
              class="item"
              href="https://news.artnet.com/art-world/doves-typeface-2454807"
              >Remnants of a legendary typeface have been rescued from the
              Thames</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 02:27:06</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40270586"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40270219">
          <h3>
            <a class="item" href="https://github.com/ExistentialAudio/BlackHole"
              >BlackHole: macOS Audio Loopback Driver</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-06 @ 01:16:26</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40270219"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40269489">
          <h3>
            <a class="item" href="https://github.com/alessiodm/drl-zh"
              >Deep Reinforcement Learning: Zero to Hero</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 23:12:28</span
              ><span class="points-container"
                >Points: <span class="points">462</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40269489"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40267989">
          <h3>
            <a
              class="item"
              href="https://johnnydecimal.com/20-29-communication/22-blog/22.00.0036-quitaversary/"
              >Quitaversary</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 20:26:58</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40267989"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40265904">
          <h3>
            <a
              class="item"
              href="https://arslan.io/2024/05/05/braun-borse-2024/"
              >Visiting the annual Braun collectors fair</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 16:09:54</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40265904"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40265537">
          <h3>
            <a
              class="item"
              href="https://softwaredoug.com/blog/2024/05/05/faster-intersect"
              >Faster sorted array intersections</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 15:23:20</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40265537"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40264194">
          <h3>
            <a
              class="item"
              href="https://imzaldih.com/en/post/bug-spoke-russian-crashed-app/"
              >A bug that spoke Russian and crashed my app</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 12:01:01</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40264194"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40263819">
          <h3>
            <a
              class="item"
              href="https://mattyyeung.github.io/deterministic-quoting"
              >Deterministic Quoting: Making LLMs safer for healthcare</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 10:47:36</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40263819"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40263711">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/hydrostor-compressed-air-battery-california-australia-energy-climate/"
              >A company is building a giant compressed-air battery in the
              Australian outback</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 10:28:17</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40263711"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40262897">
          <h3>
            <a
              class="item"
              href="https://wadetregaskis.com/swifts-native-clocks-are-very-inefficient/"
              >Swift's native Clocks are inefficient</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 07:10:36</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40262897"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40262626">
          <h3>
            <a
              class="item"
              href="https://www.jeremykun.com/2024/05/04/fhe-overview/"
              >A High-Level Technical Overview of Homomorphic Encryption</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 06:02:02</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40262626"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40262543">
          <h3>
            <a
              class="item"
              href="http://oldvcr.blogspot.com/2024/05/with-powerpc-windows-ce-and-wiin-pad.html"
              >With PowerPC, Windows CE and the WiiN-Pad Slate, Everyone's a
              WiiN-Er</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 05:42:51</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40262543"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40262221">
          <h3>
            <a
              class="item"
              href="https://notes.mtb.xyz/p/fintech-stack-open-source"
              >The new fintech stack is open source?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 04:20:06</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40262221"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40261535">
          <h3>
            <a
              class="item"
              href="https://blog.benedictfritz.com/the-agony-and-ecstasy-of-costco/"
              >The agony and ecstasy of Costco (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-05 @ 00:56:23</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40261535"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40261279">
          <h3>
            <a class="item" href="https://github.com/Megapixel99/nodejs-k8s"
              >Show HN: Kubernates in Node.js</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-04 @ 23:56:47</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40261279"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              This project was/is an attempt to recreate the core functionality
              of v1.29.1 Kubernetes in NodeJS, while being fully compatible with
              the kubectl CLI.
            </div>
          </section>
        </section>
        <section id="40261267">
          <h3>
            <a
              class="item"
              href="https://www.cia.gov/legacy/museum/exhibit/project-azorian/"
              >About Project Azorian</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-04 @ 23:53:57</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40261267"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
