<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37450356">
          <h3>
            <a
              class="item"
              href="https://www.mcsweeneys.net/articles/our-self-driving-cars-will-save-countless-lives-but-they-will-kill-some-of-you-first"
              >Our Self-Driving Cars Will Save Lives, but They Will Kill Some of
              You First</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 21:15:44</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37450356"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37450228">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/freshpaint/bfe56523-bff4-4ca3-936b-0ba15fb4e572?utm_source=hn"
              >Freshpaint (YC S19) is hiring engineers to build a HIPAA
              compliant data platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 21:00:20</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37449921">
          <h3>
            <a
              class="item"
              href="https://vivaldi.com/blog/news/alert-no-google-topics-in-vivaldi/"
              >No Google Topics in Vivaldi</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 20:24:54</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37449921"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37448914">
          <h3>
            <a class="item" href="https://github.com/ZeroIntensity/view.py"
              >Show HN: I built a Python web framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 18:47:54</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37448914"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
            <div class="text">been working on this for nearly a year</div>
          </section>
        </section>
        <section id="37448659">
          <h3>
            <a class="item" href="https://github.com/scottbez1/smartknob"
              >SmartKnob – Haptic input knob with software-defined endstops and
              virtual detents</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 18:30:39</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37448659"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37448554">
          <h3>
            <a
              class="item"
              href="https://mycophobia.org/desktop_gui_minimalism.html"
              >On Desktop GUI Minimalism</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 18:23:18</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37448554"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37448460">
          <h3>
            <a class="item" href="https://notgull.net/why-you-want-async/"
              >Why you might want async in your project</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 18:17:56</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37448460"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37448005">
          <h3>
            <a class="item" href="https://github.com/Ads-cmu/WhatsApp-Llama"
              >Show HN: WhatsApp-Llama: A clone of yourself from your WhatsApp
              conversations</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 17:43:11</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37448005"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been thinking about the idea of a LLM thats a clone of me -
                instead of generating replies to be a helpful assistant, it
                generates replies that are exactly like mine. The concept's
                appeared in fiction numerous times (the talking paintings in
                Harry Potter that mimic the person painted, the clones in The
                Prestige), and I think with LLMs, there might actually be a
                possibility of us doing something like this!
              </p>
              <p>
                I've just released a fork of the facebookresearch/llama-recipes
                which allows you to fine-tune a Llama model on your personal
                WhatsApp conversations. This adaptation can train the model
                (using QLoRA) to respond in a way that's eerily similar to your
                own texting style.
              </p>
              <p>What I've figured out so far:</p>
              <p>
                Quick Learning: The model quickly adapts to personal nuances,
                emoji usage, and phrases that you use. I've trained just 1 epoch
                on a P100 GPU using QLoRA and 4 bit quantization, and its
                already captured my mannerisms
              </p>
              <p>
                Turing Tests: As an experiment, I asked my friends to ask me 3
                questions, and responded with 2 candidate responses (one from me
                and one from llama). My friends then had to guess which
                candidate response was mine and which one was Llama's. Llama
                managed to fool 10% of my friends, but with more compute, I
                think it can do way better.
              </p>
              <p>
                Here's the GitHub repository:
                <a href="https://github.com/Ads-cmu/WhatsApp-Llama/"
                  >https://github.com/Ads-cmu/WhatsApp-Llama/</a
                >
              </p>
              <p>
                Would love to hear feedback, suggestions, and any cool
                experiences if you decide to give it a try! I'd love to see how
                far we can push this by training bigger models for more epochs
                (I ran out of compute credits)
              </p>
            </div>
          </section>
        </section>
        <section id="37447810">
          <h3>
            <a
              class="item"
              href="https://iahwrites.substack.com/p/existing-in-an-un-simulated-reality"
              >Existing in an Un-Simulated Reality</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 17:27:52</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37447810"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37446790">
          <h3>
            <a
              class="item"
              href="https://awealthofcommonsense.com/2023/09/the-u-s-housing-market-vs-the-canadian-housing-market/"
              >The U.S. housing market vs. the Canadian housing market</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 15:54:15</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37446790"
                  >Comments</a
                ><span class="descendants">: 408</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37446509">
          <h3>
            <a
              class="item"
              href="https://www.funtoo.org/Making_the_Distribution,_Part_1"
              >Making the Distribution, Part 1</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 15:29:14</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37446509"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37446430">
          <h3>
            <a
              class="item"
              href="https://ffmpeg.org/pipermail/ffmpeg-devel/2023-September/314167.html"
              >FFmpeg Patches for a 20% speedup of Apple ProRes decoding</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 15:23:10</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37446430"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37446083">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/wellness/2023/09/08/public-restrooms-hard-find-comic/"
              >Public restrooms are hard to find in America</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 14:52:20</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37446083"
                  >Comments</a
                ><span class="descendants">: 376</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37445963">
          <h3>
            <a class="item" href="https://forum.dji.com/thread-293546-1-1.html"
              >DJI Virtual Flight (iOS) has been broken for five months</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 14:38:53</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37445963"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37445951">
          <h3>
            <a
              class="item"
              href="https://github.com/PCrnjak/PAROL6-Desktop-robot-arm"
              >PAROL6 Desktop Robot Arm</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 14:37:45</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37445951"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37445401">
          <h3>
            <a class="item" href="https://benchmarks.llmonitor.com"
              >Asking 60 LLMs a set of 20 questions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 13:51:33</span
              ><span class="points-container"
                >Points: <span class="points">450</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37445401"
                  >Comments</a
                ><span class="descendants">: 248</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37444268">
          <h3>
            <a
              class="item"
              href="https://bricknerd.com/home/every-type-of-plastic-used-by-lego-5-20-22"
              >Every type of plastic used by LEGO (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 11:43:59</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37444268"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37444066">
          <h3>
            <a
              class="item"
              href="https://www.thebookseller.com/features/berkeley-hotel-hostage"
              >The Berkeley Hotel Hostage of Douglas Adams</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 11:12:22</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37444066"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37443404">
          <h3>
            <a
              class="item"
              href="https://datavirke.dk/posts/bare-metal-kubernetes-part-1-talos-on-hetzner/"
              >Bare-Metal Kubernetes, Part I: Talos on Hetzner</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 08:44:52</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37443404"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37443395">
          <h3>
            <a
              class="item"
              href="https://icfp23.sigplan.org/details/ocaml-2023-papers/5/Eio-1-0-Effects-based-IO-for-OCaml-5"
              >Eio 1.0 – Effects-based IO for OCaml 5</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 08:44:07</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37443395"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37443252">
          <h3>
            <a
              class="item"
              href="https://axleos.com/making-a-newsletter-backend/"
              >Making a newsletter backend</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-09 @ 08:12:21</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37443252"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37440696">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/obituaries/2023/09/08/dennis-austin-software-developer-powerpoint-dies/"
              >Dennis Austin, developer of PowerPoint, has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-08 @ 23:45:55</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37440696"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37433784">
          <h3>
            <a
              class="item"
              href="https://daily.jstor.org/a-teen-celebrity-in-1804/"
              >A Teen Celebrity in 1804</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-08 @ 14:15:01</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37433784"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37432336">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/world/interactive/2023/tennis-match-fixing-gambling-investigation-belgium/"
              >A small-town police officer took down a large match-fixing ring
              in tennis</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-08 @ 11:49:55</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37432336"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37428491">
          <h3>
            <a
              class="item"
              href="https://www.macstories.net/stories/i-used-a-game-boy-camera-for-facetime-video-calls-in-ipados-17-and-it-was-glorious/"
              >I used a Game Boy camera for Facetime video calls in iPadOS 17</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-08 @ 02:26:44</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37428491"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37426598">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/20230904-00/?p=108704"
              >What happens when you shift a register by more than the register
              size?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-07 @ 22:39:13</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37426598"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37419739">
          <h3>
            <a
              class="item"
              href="https://neurosciencenews.com/sequential-memory-human-trait-23888/"
              >Sequential Memory Is a Unique Human Trait</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-07 @ 14:50:54</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37419739"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37415804">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/news/intel-confirms-arm-investment-arm-and-risc-v-is-where-the-volumes-are"
              >Intel announces Arm investment, talks up RISC-V</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-07 @ 07:32:48</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37415804"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37413027">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/culture/touchstones/wong-kar-wais-in-the-mood-for-love"
              >The era-defining aesthetic of “In the Mood for Love”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-06 @ 23:55:59</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37413027"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37412845">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-09-ai-magnetic-materials-critical-elements.html"
              >Researchers use AI to find new magnetic materials without
              critical elements</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-09-06 @ 23:35:23</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37412845"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
