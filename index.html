<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35565431">
          <h3>
            <a
              class="item"
              href="https://www.vice.com/en/article/k7z8be/torswats-computer-generated-ai-voice-swatting"
              >A Computer Generated Swatting Service Is Causing Havoc Across
              America</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-14 @ 04:13:26</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35565431"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35565212">
          <h3>
            <a
              class="item"
              href="https://huyenchip.com/2023/04/11/llm-engineering.html"
              >Building LLM Applications for Production</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-14 @ 03:30:10</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35565212"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35564874">
          <h3>
            <a
              class="item"
              href="https://github.com/riscv-collab/riscv-gnu-toolchain"
              >GNU toolchain for RISC-V including GCC</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-14 @ 02:36:27</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35564874"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35564655">
          <h3>
            <a
              class="item"
              href="https://servo.org/blog/2023/04/13/layout-2013-vs-2020/"
              >Layout 2013 and Layout 2020</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-14 @ 02:04:53</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35564655"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35564521">
          <h3>
            <a
              class="item"
              href="https://passingtime.substack.com/p/whats-the-least-impactful-way-to"
              >The least impactful way to spend $300M?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-14 @ 01:40:28</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35564521"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35564291">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/atlas-2/jobs/DREaPP6-senior-demand-generation-manager-global"
              >Atlas (YC W22) Is Hiring for a Demand Gen Manager
              (International)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-14 @ 01:00:06</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35562807">
          <h3>
            <a
              class="item"
              href="https://twitter.com/id_aa_carmack/status/1646634954703421441"
              >When you combine two things that are close, but not the same</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 22:10:20</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35562807"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35562430">
          <h3>
            <a
              class="item"
              href="http://peter.eisentraut.org/blog/2023/04/04/sql-2023-is-finished-here-is-whats-new"
              >SQL:2023 is finished: Here is what's new</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 21:37:26</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35562430"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35562357">
          <h3>
            <a
              class="item"
              href="https://www.cisa.gov/sites/default/files/2023-04/principles_approaches_for_security-by-design-default_508_0.pdf"
              >Shifting the Balance of Cybersecurity Risk: Security-by-Design
              and -Default [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 21:32:03</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35562357"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35562230">
          <h3>
            <a class="item" href="https://consentomatic.au.dk/"
              >Consent-O-Matic: Automatic cookie management</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 21:22:40</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35562230"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561948">
          <h3>
            <a
              class="item"
              href="https://www.theparisreview.org/blog/2023/03/14/camuss-new-york-diary-1946/"
              >Camus's New York Diary (1946)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 20:56:02</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561948"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561942">
          <h3>
            <a
              class="item"
              href="https://news.lettersofnote.com/p/i-hope-you-will-never-see-this-letter"
              >I hope you will never see this letter (1961)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 20:55:22</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561942"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561824">
          <h3>
            <a
              class="item"
              href="https://www.commonwealmagazine.org/end-life-dreams"
              >End-of-Life Dreams</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 20:46:06</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561824"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561747">
          <h3>
            <a
              class="item"
              href="https://adamkdean.co.uk/posts/gpt-unicorn-a-daily-exploration-of-gpt-4s-image-generation-capabilities"
              >GPT Unicorn: A Daily Exploration of GPT-4's Image Generation
              Capabilities</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 20:40:25</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561747"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561485">
          <h3>
            <a
              class="item"
              href="https://ai.googleblog.com/2023/04/robotic-deep-rl-at-scale-sorting-waste.html"
              >Sorting waste and recyclables with a fleet of robots</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 20:15:48</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561485"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35561203">
          <h3>
            <a class="item" href="https://fairanimateddrawings.com/site/home"
              >Animated Drawings</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 19:51:37</span
              ><span class="points-container"
                >Points: <span class="points">336</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35561203"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35560577">
          <h3>
            <a
              class="item"
              href="https://www.ctrl.blog/entry/append-only-social.html"
              >Don’t record your social life on an append-only social network
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 19:10:18</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35560577"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35559925">
          <h3>
            <a
              class="item"
              href="https://fly.io/phoenix-files/elixir-and-rust-is-a-good-mix/"
              >Elixir and Rust is a good mix</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 18:29:04</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35559925"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35559145">
          <h3>
            <a
              class="item"
              href="https://www.washington.edu/news/2023/04/10/warm-liquid-spewing-from-oregon-seafloor-comes-from-cascadia-fault-could-offer-clues-to-earthquake-hazards/"
              >Warm liquid from Oregon seafloor comes from Cascadia fault</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 17:38:22</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35559145"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35559124">
          <h3>
            <a class="item" href="https://tailscale.dev/blog/darwin-spelunking"
              >Improving Tailscale via Apple’s open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 17:36:39</span
              ><span class="points-container"
                >Points: <span class="points">364</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35559124"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35558522">
          <h3>
            <a
              class="item"
              href="https://www.latent.space/p/segment-anything-roboflow#details"
              >Segment Anything Model and the hard problems of computer
              vision</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 17:01:24</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35558522"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35552824">
          <h3>
            <a class="item" href="https://github.com/zylin/zpu"
              >Zylin ZPU: 32 bit CPU with GCC toolchain</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 09:04:47</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35552824"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35550339">
          <h3>
            <a
              class="item"
              href="https://www.telesens.co/2017/07/17/calculating-position-from-raw-gps-data/"
              >Calculating Position from Raw GPS Data (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 02:58:59</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35550339"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35549145">
          <h3>
            <a
              class="item"
              href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=f4083bec95971f6449c24025c114c7b82b279f07"
              >The Future of Television Advertising (2005)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-13 @ 00:27:19</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35549145"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35548618">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/culture/cultural-comment/requiem-for-a-great-cat"
              >Requiem for a Great Cat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-12 @ 23:35:29</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35548618"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35539476">
          <h3>
            <a class="item" href="https://beamanalytics.io/"
              >Show HN: Google Analytics alternative with the most generous free
              tier</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-12 @ 13:40:12</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35539476"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
            <div class="text">
              <p>
                As an indie hacker, the new Google Analytics (GA4) coming
                motivated me to look for a straightforward alternative that
                would also be affordable. I had a few basic product requirements
                and didn’t want to spend too much to replace a free product.
                There are a lot of great Google Analytics alternatives out
                there, but the pricing didn’t seem right. As someone who likes
                to just build things, many of which aren’t businesses yet, it
                didn’t make sense to pay for options like Plausible and Fathom
                out of the gate.
              </p>
              <p>
                So I joined with a friend to build Beam Analytics. Beam gives
                you all the standard web analytics. It also comes with easy to
                create funnels so you can see how users move through your site.
                And we have a great proxy for cohort retention that doesn’t need
                you to log any data with us. It’s cookie-less and GDPR
                compliant.
              </p>
              <p>
                The free tier is 100k page views per month so hopefully you’ll
                give it a try. There’s also a Wordpress integration to make
                integrating with WordPress sites as easy as a single click -
                <a href="https://wordpress.org/plugins/beam-analytics/"
                  >https://wordpress.org/plugins/beam-analytics/</a
                >.
              </p>
              <p>
                Appreciate your feedback. You can also email us at hi (at)
                beamanalytics.io or DM me on twitter @TheBuilderJR.
              </p>
            </div>
          </section>
        </section>
        <section id="35537248">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/primitive-asgard-cells-show-life-on-the-brink-of-complexity-20230411/"
              >Primitive Asgard cells show life on the brink of complexity</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-12 @ 09:56:45</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35537248"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35535153">
          <h3>
            <a
              class="item"
              href="https://blogs.bl.uk/digitisedmanuscripts/2023/04/inside-a-tudor-home.html"
              >A Tudor Woman's Home</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-12 @ 04:51:31</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35535153"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35535081">
          <h3>
            <a
              class="item"
              href="https://www.nationalgeographic.com/travel/article/author-paul-theroux-rail-travel"
              >Paul Theroux reflects on the evolving nature of rail travel</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-12 @ 04:40:49</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35535081"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35525877">
          <h3>
            <a
              class="item"
              href="https://psyche.co/ideas/a-life-of-splendid-uselessness-is-a-life-well-lived"
              >A life of splendid uselessness is a life well lived</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-11 @ 14:43:10</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35525877"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
