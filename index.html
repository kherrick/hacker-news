<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45405285">
          <h3>
            <a
              class="item"
              href="https://blogs.oracle.com/java/post/detaching-graalvm-from-the-java-ecosystem-train"
              >Detaching GraalVM from the Java Ecosystem Train</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 15:56:03</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45405285"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45405221">
          <h3>
            <a
              class="item"
              href="https://justin.searls.co/posts/why-im-not-rushing-to-take-sides-in-the-rubygems-fiasco/"
              >Why I'm not rushing to take sides in the RubyGems fiasco</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 15:48:10</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45405221"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45405177">
          <h3>
            <a
              class="item"
              href="https://chrisloy.dev/post/2025/09/28/the-ai-coding-trap"
              >The AI coding trap</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 15:43:33</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45405177"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45404997">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45404997"
              >The Death of Utilitarian Programming</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 15:21:01</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45404997"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <i
                >The code you write should be *directly* useful or serve the
                interest of at least one actual human being.</i
              >
              It might appear somewhat abstract or vague, so examples might
              help. For example, I don't consider <i>frameworks</i> as
              utilitarian code. What you create are like the "frames" of a
              picture box, someone else (the user) will take it and draw the
              actual picture. Though you did help with part of the process, it's
              indirect at best. You're part of the supply chain here, not part
              of the team.
              <p>
                A clever and witty bash script running on a unix server
                somewhere is also not utilitarian coding, no human ever directly
                benefited from it.
              </p>
              <p>
                Libraries can be somewhat utilitarian, at least more than
                frameworks. At least they provide some reusable functionality to
                the user out of the box like logging, scanning a barcode,
                fetching data from a URL, etc. But again, a lot of indirection
                and little lasting time, what did *you* learn about
                implementation and life in that process my friend?
              </p>
              <p>
                It's my strong belief that our life's purpose isn't just about
                learning technology but also other non-technical things in life
                (such as life itself). By compartmentalizing themselves into
                libraries, frameworks, specifications, package managers, build
                and tooling, etc, many coders over the last decade have sort of
                divorced themselves from the intricacies and interaction with
                life itself.
              </p>
              <p>
                A decade ago from now (i.e. circa 2014-15) is where I'd say
                utilitarian coding came to an end. The kind of programming that
                prevailed until then (mostly desktop programming) was highly
                utilitarian in nature. You used to develop a Winforms App for
                the client, with actual textboxes, dropdowns and buttons,
                tailored to their specific requirements and domain knowledge,
                what could be more utilitarian than that! You used to gain
                domain expertise and not just technology expertise.
              </p>
              <p>
                As things started moving to the cloud, the interaction between
                the end-user and programmer became less and less, that's when
                utilitarian coding started dying too. As a new breed of
                specialists called "Agile Experts", "Scrum Masters", "Tech
                Advocates", "Thought Leaders", etc. started inserting themselves
                between the coder and end user, the former's role started
                morphing as the ostrich policy of dealing only with technology
                and nothing else. We started losing touch with domain expertise,
                and became branded as "python coder", "PHP scripter", "web
                developer", "AI developer", etc. That's how folks started
                churning out more frameworks, libraries, packages, stencils,
                helper scripts, etc. instead of worrying about actual problem
                solving with the stakeholders.
              </p>
              <p>
                This is how things stand right now for the most part, desktop
                development and other forms of utilitarian coding have still
                maintained their small niche somewhere, but they're just a
                niche. But it's not a healthy development, nor is it sustainable
                long term. I strongly feel that this bubble is waiting to burst
                one day soon, and there will be a reversion towards utilitarian
                coding again. Even the cloud itself needs to be more
                utilitarian, a lot of needless clutter out there which can be
                simplified.
              </p>
              <p>What do you think? Let me know in comments.</p>
            </div>
          </section>
        </section>
        <section id="45404907">
          <h3>
            <a
              class="item"
              href="https://www.vice.com/en/article/she-sent-her-iphone-to-apple-repair-techs-uploaded-her-nudes-to-facebook/"
              >She Sent Her iPhone to Apple. Repair Techs Uploaded Her Nudes to
              Facebook (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 15:09:07</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45404907"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45404803">
          <h3>
            <a
              class="item"
              href="https://apieceofthepi.substack.com/p/the-golden-ratio-as-a-number-base"
              >The golden ratio as a number base</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 14:57:34</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45404803"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45404793">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2025/sep/28/as-my-daughter-got-sicker-and-sicker-our-quest-for-answers-dragged-on-how-did-we-all-miss-the-bacteria-taking-over-her-body"
              >How did we all miss the bacteria taking over her body?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 14:56:22</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45404793"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45404667">
          <h3>
            <a class="item" href="https://toolbrew.co/"
              >Show HN: Toolbrew – Free little tools without signups or ads</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 14:40:46</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45404667"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <p>
                If there is a tool you wish existed, you can request it on the
                site and I will build it. Do your worst. Seriously, ANY tool.
              </p>
              <p>Maybe it helps, maybe not. Enjoy!</p>
            </div>
          </section>
        </section>
        <section id="45404573">
          <h3>
            <a class="item" href="https://github.com/9fans/plan9port"
              >Plan 9 from User Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 14:27:44</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45404573"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45404373">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/The_Demon-Haunted_World"
              >The Demon-Haunted World</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 14:00:12</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45404373"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45404022">
          <h3>
            <a
              class="item"
              href="https://sebastiano.tronto.net/blog/2025-09-28-alphabetic-order/"
              >When I say "alphabetical order", I mean "alphabetical order"</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 13:00:16</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45404022"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45404021">
          <h3>
            <a class="item" href="https://privacybadger.org/"
              >Privacy Badger is a free browser extension made by EFF to stop
              spying</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 12:59:54</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45404021"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45403373">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=w3ma9iYx4rg"
              >Fred Dibnah shows how to erect a chimney scaffold at 200 feet
              (1982) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 10:52:10</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45403373"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45403288">
          <h3>
            <a class="item" href="https://gamedevtorch.com/"
              >Show HN: Curated gamedev specific search engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 10:36:23</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45403288"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45402820">
          <h3>
            <a
              class="item"
              href="https://ashvardanian.com/posts/beyond-openmp-in-cpp-rust/"
              >Beyond OpenMP in C++ and Rust: Taskflow, Rayon, Fork Union</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 08:53:36</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45402820"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45402197">
          <h3>
            <a class="item" href="https://oses.ioblako.com/"
              >Run 14 vintage OSes (Windows 1.01→XP, ReactOS, Haiku) in the
              browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 06:31:16</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45402197"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45401907">
          <h3>
            <a
              class="item"
              href="http://www.ibmfiles.com/pages/intellipower185.htm"
              >IBM Intellistation 185 AIX workstation (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 05:04:39</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45401907"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45401051">
          <h3>
            <a class="item" href="https://www.linspyre.com/ecoholics/temps.html"
              >Solar panels + cold = A potential problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-28 @ 01:48:15</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45401051"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45400376">
          <h3>
            <a class="item" href="https://online-go.com/learn-to-play-go"
              >Learn to play Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-27 @ 23:50:42</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45400376"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45398005">
          <h3>
            <a class="item" href="https://www.theroom.lol"
              >I made a public living room and the internet keeps putting
              weirder stuff in it</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-27 @ 17:59:47</span
              ><span class="points-container"
                >Points: <span class="points">253</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45398005"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
            <div class="text">
              I built this silly web game using the nano banana api, if you like
              dumb stuff come join burning through my google cloud credits.
            </div>
          </section>
        </section>
        <section id="45396441">
          <h3>
            <a class="item" href="https://messenger.abeto.co/"
              >A WebGL game where you deliver messages on a tiny planet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-27 @ 15:17:30</span
              ><span class="points-container"
                >Points: <span class="points">1807</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45396441"
                  >Comments</a
                ><span class="descendants">: 287</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45395991">
          <h3>
            <a class="item" href="https://github.com/francoismichel/ssh3"
              >SSH3: Faster and rich secure shell using HTTP/3</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-27 @ 14:27:10</span
              ><span class="points-container"
                >Points: <span class="points">491</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45395991"
                  >Comments</a
                ><span class="descendants">: 248</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45375462">
          <h3>
            <a
              class="item"
              href="https://www.syncdna.com/blog/time-travel-or-just-clever-tech"
              >Time travel? Or, just clever technology</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-25 @ 16:59:22</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45375462"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45370798">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-025-02851-w"
              >Man still alive six months after pig kidney transplant</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-25 @ 09:20:39</span
              ><span class="points-container"
                >Points: <span class="points">443</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45370798"
                  >Comments</a
                ><span class="descendants">: 242</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45366149">
          <h3>
            <a
              class="item"
              href="https://www.rabbitmq.com/blog/2025/09/23/sql-filter-expressions"
              >Broker-Side SQL Filtering with RabbitMQ Streams</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 21:25:27</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45366149"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45365927">
          <h3>
            <a
              class="item"
              href="https://advanced.onlinelibrary.wiley.com/doi/10.1002/adma.202500959"
              >Textile Encoding via Elastically Graded Embroidered
              Tessellations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 21:03:45</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45365927"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45364370">
          <h3>
            <a
              class="item"
              href="https://www.mortati.com/glusker/elecmech/index.htm"
              >Electromechanical Calculating Machines from the 1960's</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 18:41:04</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45364370"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45363465">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/security/2025/09/supermicro-server-motherboards-can-be-infected-with-unremovable-malware/"
              >Supermicro server motherboards can be infected with unremovable
              malware</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 17:32:30</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45363465"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45362365">
          <h3>
            <a
              class="item"
              href="https://apps.apple.com/us/app/ridepods-race-with-head/id6752268828"
              >I built and launched the first AirPods-Controlled Game</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 16:09:59</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45362365"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45358841">
          <h3>
            <a class="item" href="https://pyrefly.org/blog/why-typed-python/"
              >Python developers are embracing type hints</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-24 @ 11:23:54</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45358841"
                  >Comments</a
                ><span class="descendants">: 409</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
