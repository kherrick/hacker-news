<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42673762">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/us-news/2025/jan/12/us-supreme-court-roe"
              >US Supreme Court curbed public scrutiny as it boosted security
              before Roe ruling</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 14:26:38</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42673762"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42673090">
          <h3>
            <a
              class="item"
              href="https://www.hmd.com/en_int/press/hmd-key-press-release"
              >HMD Key – A lightweight, affordable smartphone</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 12:27:16</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42673090"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42672960">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/harper/jobs/VUe2K9r-founding-operations-lead"
              >Harper (YC W25) Is Hiring #1 Founding Growth/Operations Lead</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 12:02:18</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42672790">
          <h3>
            <a
              class="item"
              href="https://lukaspetersson.com/blog/2025/bitter-vertical/"
              >AI founders will learn the bitter lesson</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 11:22:55</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42672790"
                  >Comments</a
                ><span class="descendants">: 150</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42672758">
          <h3>
            <a
              class="item"
              href="https://worldsensorium.com/rewilding-the-self/"
              >Rewilding the Self</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 11:18:07</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42672758"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42672752">
          <h3>
            <a
              class="item"
              href="https://nautil.us/these-physicists-want-to-ditch-dark-energy-1177085/"
              >Physicists Want to Ditch Dark Energy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 11:17:03</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42672752"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42672675">
          <h3>
            <a
              class="item"
              href="https://www.therepository.email/mullenweg-shuts-down-wordpress-sustainability-team-igniting-backlash"
              >Mullenweg Shuts Down WordPress Sustainability Team, Igniting
              Backlash</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 11:01:55</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42672675"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42671512">
          <h3>
            <a
              class="item"
              href="https://matt.might.net/articles/phd-school-in-pictures/?_nospa=true"
              >The Illustrated Guide to a PhD</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 05:26:54</span
              ><span class="points-container"
                >Points: <span class="points">300</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42671512"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42671472">
          <h3>
            <a class="item" href="https://www.kenney.nl/"
              >Kenney.nl: Free Game Assets</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 05:17:50</span
              ><span class="points-container"
                >Points: <span class="points">347</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42671472"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42671105">
          <h3>
            <a
              class="item"
              href="https://blog.djhaskin.com/blog/why-i-chose-common-lisp/"
              >Why I Chose Common Lisp</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 03:38:25</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42671105"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42670468">
          <h3>
            <a
              class="item"
              href="https://www.potaroo.net/ispcol/2025-01/addr2024.html"
              >IP addresses through 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-12 @ 01:39:10</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42670468"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42669681">
          <h3>
            <a
              class="item"
              href="https://www.seangoedecke.com/working-for-americans/"
              >What it's like working for American companies as an Australian</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-11 @ 23:03:56</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42669681"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42669637">
          <h3>
            <a
              class="item"
              href="https://www.digitalmars.com/articles/Cobvious.html"
              >Obvious things C should do</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-11 @ 22:58:22</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42669637"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42668953">
          <h3>
            <a class="item" href="https://www.eso.org/public/news/eso2501/"
              >World's darkest and clearest skies at risk from industrial
              megaproject</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-11 @ 21:11:06</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42668953"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42667797">
          <h3>
            <a
              class="item"
              href="https://www.loc.gov/resource/g4361p.ct000092/?r=-0.628,0.425,1.749,0.902,0"
              >Map of California roads for cyclers (1895)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-11 @ 18:18:36</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42667797"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42666572">
          <h3>
            <a
              class="item"
              href="https://tomscii.sig7.se/2025/01/De-smarting-the-Marshall-Uxbridge"
              >De-smarting the Marshall Uxbridge</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-11 @ 15:42:02</span
              ><span class="points-container"
                >Points: <span class="points">268</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42666572"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42666492">
          <h3>
            <a class="item" href="https://github.com/mathuo/dockview"
              >Show HN: TypeScript/React/Vue Window Layout Manager (Tabs,
              Floating, Popouts)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-11 @ 15:31:03</span
              ><span class="points-container"
                >Points: <span class="points">296</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42666492"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42665367">
          <h3>
            <a class="item" href="https://github.com/hybridgroup/go-haystack"
              >Track your devices via Apple FindMy network in Go/TinyGo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-11 @ 12:14:34</span
              ><span class="points-container"
                >Points: <span class="points">322</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42665367"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42660848">
          <h3>
            <a class="item" href="https://github.com/djyt/cannonball"
              >Cannonball: An enhanced OutRun engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-10 @ 22:11:11</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42660848"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42653744">
          <h3>
            <a
              class="item"
              href="https://blog.anj.ai/2025/01/llm-token-generation-probabilities.html"
              >How outdated information hides in LLM token generation
              probabilities</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-10 @ 08:24:10</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42653744"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42649837">
          <h3>
            <a class="item" href="https://zty.pe/">ZType – Typing Game</a>
          </h3>
          <section>
            <h4>
              <span>2025-01-09 @ 21:13:21</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42649837"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42649139">
          <h3>
            <a
              class="item"
              href="https://sunshowers.io/posts/nextest-process-per-test/"
              >Why Rust nextest is process-per-test</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-09 @ 19:40:54</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42649139"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42647668">
          <h3>
            <a class="item" href="https://github.com/aerugo/simplegantt"
              >Show HN: Ultra-portable Gantt chart tool for very regulated
              environments</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-09 @ 17:11:51</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42647668"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
            <div class="text">
              <p>
                I needed a project management tool, and what we had on offer was
                too clunky and old. I built SimpleGantt to be ultra lightweight
                and portable. It's one HTML, one Javascript and one CSS file.
                Each project is saved into a single .yaml file.
              </p>
              <p>
                If you have a SharePoint environment you can "host" it by
                uploading the repo to SharePoint after renaming simplegantt.html
                to simplegantt.aspx. That allows anyone with access to open the
                tool by simply having the URL.
              </p>
              <p>
                Try it at:
                <a href="https://aerugo.github.io/simplegantt/simplegantt"
                  >https://aerugo.github.io/simplegantt/simplegantt</a
                >
              </p>
              <p>
                This is a couple of days of tinkering, and mostly exists to keep
                me from going crazy while managing projects with lots of
                deadlines and dependencies, so don't expect much. But another
                person in the same position, finding this might lead to calmer
                days.
              </p>
            </div>
          </section>
        </section>
        <section id="42645859">
          <h3>
            <a
              class="item"
              href="http://charleshughsmith.blogspot.com/2025/01/i-quit-tsunami-of-burnout-few-see.html"
              >The Tsunami of Burnout Few See</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-09 @ 14:25:21</span
              ><span class="points-container"
                >Points: <span class="points">511</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42645859"
                  >Comments</a
                ><span class="descendants">: 284</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42644426">
          <h3>
            <a
              class="item"
              href="https://css-tip.com/animation-without-keyframes/"
              >Running Animations Without Keyframes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-09 @ 12:04:57</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42644426"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42642971">
          <h3>
            <a class="item" href="https://ollama.com/library/phi4"
              >Phi 4 available on Ollama</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-09 @ 08:12:57</span
              ><span class="points-container"
                >Points: <span class="points">208</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42642971"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42640755">
          <h3>
            <a class="item" href="https://ourworldindata.org/simon-ehrlich-bet"
              >Who would have won the Simon-Ehrlich bet over different
              decades?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-09 @ 01:52:29</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42640755"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42640207">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/security/2025/01/googles-chrome-web-store-has-a-serious-spam-problem-promoting-shady-extensions/"
              >How hucksters are manipulating Google to promote shady Chrome
              extensions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-09 @ 00:29:18</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42640207"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42640178">
          <h3>
            <a
              class="item"
              href="https://matklad.github.io/2023/10/06/what-is-an-invariant.html"
              >What is an invariant? (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-09 @ 00:24:48</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42640178"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42631557">
          <h3>
            <a
              class="item"
              href="https://medium.com/@alexey.medvecky/ai-in-the-80s-how-a-simple-animal-guessing-game-pioneered-machine-learning-before-it-was-cool-2f4a63dfe762"
              >AI in the 80s? How a Simple Animal Guessing Game Pioneered
              Machine Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-01-08 @ 06:21:57</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42631557"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
