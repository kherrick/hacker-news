<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41193968">
          <h3>
            <a
              class="item"
              href="https://thehill.com/opinion/technology/4800828-office-mandates-cause-attrition/"
              >Employers used return-to-office to make workers quit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 17:21:02</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41193968"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41193512">
          <h3>
            <a
              class="item"
              href="https://blog.cloudflare.com/introducing-automatic-ssl-tls-securing-and-simplifying-origin-connectivity"
              >Cloudflare Introduces Automatic SSL/TLS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 16:44:18</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41193512"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41193112">
          <h3>
            <a class="item" href="https://github.com/roundtableAI/roundtable-js"
              >Show HN: RoundtableJS – Open-source programmatic survey
              library</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 16:13:05</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41193112"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/roundtableAI/roundtable-js"
                >https://github.com/roundtableAI/roundtable-js</a
              >) to program research surveys at scale.
              <p>
                Academic and market researchers want a DIY platform for survey
                research. Most existing tools are no-code, and these researchers
                want programmatic software that handles advanced branching logic
                and customization. We know this because we spent five years
                using open-source survey software for our academic work.
              </p>
              <p>
                One of the key insights of RoundtableJS is to leverage
                JavaScript’s async/await functionality for managing survey
                logic. In other libraries survey logic is determined via
                callbacks that trigger when a page is submitted (i.e., if the
                user answers “Yes” to Q2, show page 3), which quickly becomes a
                nightmare to manage and debug. Our library lets developers build
                the timeline in an async function which means the logic flows
                intuitively from top to bottom.
              </p>
              <p>
                However, this fully programmable logic can be inaccessible to
                non-developers, and so our cloud offering
                (surveys.roundtable.ai) lets users program surveys using natural
                language by storing the library into context of an LLM (which
                acts as a library-specific copilot, demo link here:
                <a
                  href="https://www.loom.com/share/7e7f30aa96244542a62d6c6ed125f2d5?sid=1ab3682d-8165-4131-99ac-7ab17b67bf32"
                  >https://www.loom.com/share/7e7f30aa96244542a62d6c6ed125f2d5?...</a
                >).
              </p>
              <p>
                We think that being open-source will give us an edge in
                integrating LLMs into our platform. We designed RoundtableJS
                with LLM usage in mind, i.e. making it fully customizable and
                general-purpose. The alternative – building a library with a
                more constrained focus – would be more intuitive for unassisted
                programmers, but AI assistance makes it really easy to customize
                any part of the survey. Already we think this approach is easier
                and faster than no-code alternatives.
              </p>
              <p>
                We left academia last year and have been building products in
                the survey space since. Our first product was an AI-powered
                survey simulator (<a
                  href="https://news.ycombinator.com/item?id=36865625"
                  >https://news.ycombinator.com/item?id=36865625</a
                >). People loved playing with it, but it was difficult to
                monetize (as many HN comments predicted). We abandoned this,
                talked to customers, and found that data quality is a huge
                problem in market research (e.g.
                <a
                  href="https://www.kantar.com/company-news/kantar-partners-with-realeyes-to-tackle-billion-dollar-survey-fraud-problem"
                  >https://www.kantar.com/company-news/kantar-partners-with-rea...</a
                >). We released an API that analyzes open-end responses for low
                quality and fraudulent typing behavior. This helps firms save
                time cleaning data, but it is a limited market.
              </p>
              <p>
                We plan to monetize through our cloud offering, which currently
                offers instant link deployment, an interactive code editor and a
                fraud detection suite. We plan to introduce more features here
                in the analytics, design, and productivity space.
              </p>
              <p>
                Surveys are ubiquitous, but they are often bland and generic. By
                allowing people to fully customize them for today’s distribution
                channels, we want to make it easy to design better, more
                engaging surveys.
              </p>
              <p>We just launched. Where can we improve?</p>
            </div>
          </section>
        </section>
        <section id="41193045">
          <h3>
            <a
              class="item"
              href="https://www.figma.com/blog/migrating-onto-kubernetes/"
              >How we migrated onto K8s in less than 12 months</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 16:07:54</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41193045"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41192698">
          <h3>
            <a class="item" href="https://github.com/markfasheh/duperemove"
              >Duperemove – Tools for deduping file systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 15:38:43</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41192698"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41192643">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/fitbit"
              >Engineering the First Fitbit: The Inside Story</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 15:34:28</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41192643"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41192247">
          <h3>
            <a class="item" href="https://qwenlm.github.io/blog/qwen2-math/"
              >Qwen2-Math</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 15:00:18</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41192247"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41192147">
          <h3>
            <a class="item" href="https://careers.activeloop.ai/"
              >Activeloop (YC S18): Hiring Senior C++ Engineers to Scale
              Database for AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 14:49:27</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41192118">
          <h3>
            <a
              class="item"
              href="https://blog.nightly.mozilla.org/2024/08/07/firefox-sidebar-and-vertical-tabs-try-them-out-in-nightly-firefox-labs-131/"
              >Firefox Sidebar and Vertical tabs: try them out</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 14:46:48</span
              ><span class="points-container"
                >Points: <span class="points">280</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41192118"
                  >Comments</a
                ><span class="descendants">: 185</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41191720">
          <h3>
            <a class="item" href="https://jepsen.io/analyses/jetcd-0.8.2"
              >Jepsen: Jetcd 0.8.2</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 14:09:14</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41191720"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41191540">
          <h3>
            <a
              class="item"
              href="https://www.statsignificant.com/p/how-long-does-music-stardom-last"
              >How Long Does Music Stardom Last? A Statistical Analysis</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 13:55:09</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41191540"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41191069">
          <h3>
            <a
              class="item"
              href="https://dmitry.gr/?r=06.%20Thoughts&amp;proj=11.%20RP2350"
              >I got almost all of my wishes granted with RP2350</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 13:03:22</span
              ><span class="points-container"
                >Points: <span class="points">235</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41191069"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41189971">
          <h3>
            <a
              class="item"
              href="https://bughunters.google.com/blog/6303226026131456/a-deep-dive-into-cve-2023-2163-how-we-found-and-fixed-an-ebpf-linux-kernel-vulnerability"
              >How we found and fixed an eBPF Linux kernel vulnerability</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 10:39:06</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41189971"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41189678">
          <h3>
            <a class="item" href="https://jon.bo/posts/digital-tools/"
              >Digital Tools I Wish Existed (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 09:41:59</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41189678"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41189637">
          <h3>
            <a class="item" href="https://zumerlab.github.io/orbit-docs/"
              >Show HN: Orbit – A CSS radial UI composer framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 09:35:46</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41189637"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41188966">
          <h3>
            <a class="item" href="https://pytorch.org/blog/flexattention/"
              >FlexAttention: The Flexibility of PyTorch with the Performance of
              FlashAttention</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 07:24:58</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41188966"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41188295">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/b3bb80f4-4e01-4ce6-8358-f4f8638790f8"
              >Google and Meta struck secret ads deal to target teenagers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 05:08:18</span
              ><span class="points-container"
                >Points: <span class="points">457</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41188295"
                  >Comments</a
                ><span class="descendants">: 230</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41186862">
          <h3>
            <a class="item" href="https://github.com/dupontgu/pov_pong_mouse"
              >Mouse Pong: play a game from mouse's firmware with persistence of
              vision cursor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-08 @ 00:18:19</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41186862"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41186631">
          <h3>
            <a
              class="item"
              href="https://sites.google.com/site/lagadoacademy/machining---lathes-mills-etc/review---ford-s-first-engine"
              >Review – Ford's First Engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 23:40:14</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41186631"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41186310">
          <h3>
            <a class="item" href="https://argdown.org/"
              >Argdown, like Markdown for argument mapping</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 22:45:00</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41186310"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41186117">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/books/2024/08/02/book-against-death-elias-canetti-review/"
              >In ‘The Book Against Death,’ Elias Canetti rants against
              mortality</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 22:11:33</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41186117"
                  >Comments</a
                ><span class="descendants">: 490</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41184359">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/08/07/science/boeing-starliner-nasa-spacex.html"
              >NASA Says Boeing Starliner Astronauts May Fly Home on SpaceX in
              2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 19:10:54</span
              ><span class="points-container"
                >Points: <span class="points">340</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184359"
                  >Comments</a
                ><span class="descendants">: 454</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41182917">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/983965/3266dc25bf5c68d7/"
              >Maximal min() and max()</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 16:26:34</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41182917"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41182810">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-07-fruitful-watermelon-genetics-advanced-base.html"
              >Fruitful innovation: Transforming watermelon genetics with
              advanced base editors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 16:14:37</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41182810"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41171144">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41171144"
              >Show HN: Launch React components in your app with no-code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 14:25:45</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41171144"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <a href="https://youtu.be/qrPip41Ecyg"
                >https://youtu.be/qrPip41Ecyg</a
              >. The docs are here:
              <a href="https://docs.frigade.com/v2/platform/collections"
                >https://docs.frigade.com/v2/platform/collections</a
              >.
              <p>
                This enables non-technical teammates to launch native, prebuilt
                components directly in the product UI without involving
                engineering. We also provide the ability to update content (i.e.
                CMS), track user progress/state and target components to
                specific users from our admin panel.
              </p>
              <p>
                The new feature, called Collections (<a
                  href="https://frigade.com/blog/collections"
                  >https://frigade.com/blog/collections</a
                >), works by embedding a channel directly in code — think of it
                as a &lt;div /&gt; that can spawn an inline React component – or
                on the floating z-index level. For instance, a channel for UI
                cards that sits directly in your dashboard or floating
                experiences like surveys and popups. Collections can be styled
                using your own design system to feel native and blend in with
                the rest of your application.
              </p>
              <p>
                Collections also have air traffic controls (ATC) like cool-offs,
                limits, and priorities. You can think of it as an intelligent
                queue of React components in one “slot”. The ATC engine will
                automatically determine what order and when to show them. The
                rules can be useful to keep the user experience from getting
                spammy as your team launches more experiences at the same time.
                For instance, you can set it up so you only show one
                announcement modal per day max, or spread out in-app nudges to
                upgrade over a few weeks time.
              </p>
              <p>
                We were surprised by how hard it was to build this. The main
                challenges were: In order for the engine to respect the
                cool-offs and limits, we had to dig deep into the React
                rendering lifecycle to prevent the same component from rendering
                twice. This can happen when the same component is used in
                multiple Collections across the DOM tree. This is tough because
                a component can adhoc show up at any given time without notice
                due to the nature of dynamic web applications. We solved this by
                building a centralized client-side registry that keeps track of
                the DOM tree.
              </p>
              <p>
                Air traffic control is decided server side, and we knew we
                didn’t want to keep a web socket open indefinitely to render a
                simple component. So, we had to come up with a performant scheme
                that allowed the ATC logic tree to be transferred on initial
                render so the client-side can determine when each component
                should get rendered. For the first release, we offer a library
                of pre-built React components that can be easily launched in
                your web application. We’ll soon be adding the ability to launch
                any custom React components as well.
              </p>
              <p>
                We built this server-driven UI approach because we believe it
                provides teams an option that balances quality and speed. It’s
                also how companies like Uber, Pinterest and Rippling build and
                launch these in-app experiences internally, as well.
              </p>
              <p>
                Compared to some of the existing no-code tools in the space, we
                believe this approach offers more control and flexibility. We
                like the idea that product and engineering can define the
                boundaries and designs of what non-technical teammates can
                launch in production. Especially when compared to similar tools
                where content can be injected any which way with WYSIWYG editors
                on top of an otherwise carefully crafted web application.
              </p>
              <p>
                What do you think about this approach? Have you built these
                kinds of flows in-house before or used one of the
                injection-based no-code tools? I’d love to hear any feedback or
                ideas on the launch. And feel free to play around with
                Collections yourself for free at frigade.com!
              </p>
            </div>
          </section>
        </section>
        <section id="41167899">
          <h3>
            <a class="item" href="https://jackw01.github.io/scanlight/"
              >A Better Light Source for Scanning Color Negative Film</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 04:58:59</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41167899"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41167626">
          <h3>
            <a
              class="item"
              href="https://www.androidauthority.com/samsung-ifixit-partnership-story-3456726/"
              >The Story of Samsung's failed deal with iFixit, as told by
              iFixit's CEO</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 03:51:51</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41167626"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41163875">
          <h3>
            <a
              class="item"
              href="https://jasoneckert.github.io/myblog/icon-computer/"
              >Ontario's Computer: The Burroughs ICON (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-05 @ 18:19:57</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41163875"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41151013">
          <h3>
            <a class="item" href="https://github.com/vpand/icpp"
              >ICPP – Running C++ in anywhere like a script</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-04 @ 03:36:37</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41151013"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41145573">
          <h3>
            <a
              class="item"
              href="https://www.math.brown.edu/streil/papers/LADW/LADW.html"
              >Linear Algebra Done Wrong (2004)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 09:34:43</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41145573"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
