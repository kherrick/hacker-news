<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44960594">
          <h3>
            <a class="item" href="https://github.com/automazeio/ccpm"
              >Show HN: Project management system for Claude Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 10:32:12</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44960594"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
            <div class="text">
              <p>
                The problem was that context kept disappearing between tasks.
                With multiple Claude agents running in parallel, I’d lose track
                of specs, dependencies, and history. External PM tools didn’t
                help because syncing them with repos always created friction.
              </p>
              <p>
                The solution was to treat GitHub Issues as the database. The
                "system" is ~50 bash scripts and markdown configs that:
              </p>
              <p>
                - Brainstorm with you to create a markdown PRD, spins up an
                epic, and decomposes it into tasks and syncs them with GitHub
                issues - Track progress across parallel streams - Keep
                everything traceable back to the original spec - Run fast from
                the CLI (commands finish in seconds)
              </p>
              <p>
                We’ve been using it internally for a few months and it’s cut our
                shipping time roughly in half. Repo:
                <a href="https://github.com/automazeio/ccpm"
                  >https://github.com/automazeio/ccpm</a
                >
              </p>
              <p>
                It’s still early and rough around the edges, but has worked well
                for us. I’d love feedback from others experimenting with
                GitHub-centric project management or AI-driven workflows.
              </p>
            </div>
          </section>
        </section>
        <section id="44960316">
          <h3>
            <a
              class="item"
              href="https://tidewave.ai/blog/tidewave-web-phoenix-rails"
              >Tidewave Web: in-browser coding agent for Rails and Phoenix</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 09:43:04</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44960316"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44959833">
          <h3>
            <a class="item" href="https://www.rudyrucker.com/mirrorshades/HTML/"
              >Mirrorshades: The Cyberpunk Anthology (1986)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 08:15:00</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44959833"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44959092">
          <h3>
            <a
              class="item"
              href="https://www.databricks.com/company/newsroom/press-releases/databricks-raising-series-k-investment-100-billion-valuation"
              >Databricks is raising a Series K Investment at &amp;gt;$100B
              valuation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 06:06:15</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44959092"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44959073">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44959073"
              >Ask HN: Why does the US Visa application website do a port-scan
              of my network?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 06:03:03</span
              ><span class="points-container"
                >Points: <span class="points">323</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44959073"
                  >Comments</a
                ><span class="descendants">: 140</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://addons.mozilla.org/en-US/firefox/addon/port-authority/"
                >https://addons.mozilla.org/en-US/firefox/addon/port-authorit...</a
              >
              and yesterday I visited this website:
              <a href="https://ceac.state.gov/genniv/"
                >https://ceac.state.gov/genniv/</a
              >
              and I got a notification that the website tried to do a port-scan
              of my private network.
              <p>
                Is this a common thing? I have just recently installed the
                extension, so I am not sure if there are a lot of other websites
                who do it.
              </p>
              <p>
                Since looking into it, I noticed that uBlock Origin already has
                the default list "Block Outsider Intrusion into LAN" but it
                wasn't enabled.
              </p>
            </div>
          </section>
        </section>
        <section id="44958752">
          <h3>
            <a
              class="item"
              href="https://arthi-chaud.github.io/posts/type-machine/"
              >Type-machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 04:59:27</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44958752"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44958400">
          <h3>
            <a
              class="item"
              href="https://gregoryszorc.com/blog/2021/04/07/modern-ci-is-too-complex-and-misdirected/"
              >Modern CI is too complex and misdirected (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 03:30:06</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44958400"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44958020">
          <h3>
            <a
              class="item"
              href="https://www.mooreds.com/wordpress/archives/3530"
              >The value of hitting the HN front page</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 02:00:11</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44958020"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44957454">
          <h3>
            <a
              class="item"
              href="https://pistachioapp.com/blog/copilot-broke-your-audit-log"
              >Copilot broke audit logs, but Microsoft won't tell customers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 00:18:00</span
              ><span class="points-container"
                >Points: <span class="points">626</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44957454"
                  >Comments</a
                ><span class="descendants">: 234</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44957443">
          <h3>
            <a class="item" href="https://agents.md/"
              >AGENTS.md – Open format for guiding coding agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-20 @ 00:15:03</span
              ><span class="points-container"
                >Points: <span class="points">636</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44957443"
                  >Comments</a
                ><span class="descendants">: 301</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44957157">
          <h3>
            <a
              class="item"
              href="https://nautil.us/a-rogue-new-life-form-1232095/"
              >Tiny microbe challenges the definition of cellular life</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-19 @ 23:18:48</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44957157"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44956915">
          <h3>
            <a class="item" href="https://muffinman.io/blog/invaders/"
              >How to Draw a Space Invader</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-19 @ 22:41:16</span
              ><span class="points-container"
                >Points: <span class="points">407</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44956915"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44956730">
          <h3>
            <a
              class="item"
              href="https://languagehat.com/the-forgotten-meaning-of-jerk/"
              >The forgotten meaning of "jerk"</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-19 @ 22:11:29</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44956730"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44954524">
          <h3>
            <a class="item" href="https://d2lang.com/blog/ascii/"
              >D2 (text to diagram tool) now supports ASCII renders</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-19 @ 18:14:41</span
              ><span class="points-container"
                >Points: <span class="points">375</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44954524"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44953316">
          <h3>
            <a
              class="item"
              href="https://xenodium.com/emacs-as-your-video-trimming-tool"
              >Emacs as your video-trimming tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-19 @ 16:22:01</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44953316"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44953032">
          <h3>
            <a
              class="item"
              href="https://research.kudelskisecurity.com/2025/08/19/how-we-exploited-coderabbit-from-a-simple-pr-to-rce-and-write-access-on-1m-repositories/"
              >How we exploited CodeRabbit: From simple PR to RCE and write
              access on 1M repos</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-19 @ 15:55:15</span
              ><span class="points-container"
                >Points: <span class="points">633</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44953032"
                  >Comments</a
                ><span class="descendants">: 212</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44951563">
          <h3>
            <a class="item" href="https://h4x0r.org/futex/"
              >Without the futex, it's futile</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-19 @ 13:53:42</span
              ><span class="points-container"
                >Points: <span class="points">279</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44951563"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44951200">
          <h3>
            <a class="item" href="https://github.com/inshinrei/halua"
              >Show HN: I've made an easy to extend and flexible JavaScript
              logger</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-19 @ 13:20:37</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44951200"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <p>Would like to hear a feedback from you!</p>
            </div>
          </section>
        </section>
        <section id="44943666">
          <h3>
            <a class="item" href="https://jax-ml.github.io/scaling-book/gpus/"
              >How to Think About GPUs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 18:18:36</span
              ><span class="points-container"
                >Points: <span class="points">212</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44943666"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44939939">
          <h3>
            <a
              class="item"
              href="https://www.getlago.com/blog/why-we-still-build-with-ruby-in-2025"
              >Why we still build with Ruby in 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 12:42:31</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44939939"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44939902">
          <h3>
            <a
              class="item"
              href="https://gaussianprocess.org/gpml/chapters/RW.pdf"
              >Gaussian Processes for Machine Learning (2006) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 12:37:06</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44939902"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44939849">
          <h3>
            <a
              class="item"
              href="https://hothardware.com/news/intel-foundry-demos-deer-creek-falls-reference-soc"
              >Intel Foundry Demonstrates First Arm-Based Chip on 18A Node</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 12:31:18</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44939849"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44939654">
          <h3>
            <a class="item" href="https://aartaka.me/customize-repl.html"
              >Customizing Lisp REPLs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 11:57:19</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44939654"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44939456">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2508.10791"
              >MapLibre Tile: A next generation geospatial format optimized for
              rendering</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 11:28:32</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44939456"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44939423">
          <h3>
            <a
              class="item"
              href="https://noteflakes.com/articles/2025-08-18-how-to-make-ruby-faster"
              >How I Made Ruby Faster Than Ruby</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 11:22:22</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44939423"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44939165">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/the-end-of-handwriting/"
              >The End of Handwriting</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 10:37:25</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44939165"
                  >Comments</a
                ><span class="descendants">: 164</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44938718">
          <h3>
            <a class="item" href="https://github.com/mikasjp/BusyBee"
              >Fast and observable background job processing for .NET</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 09:11:16</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44938718"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44938667">
          <h3>
            <a class="item" href="https://github.com/railsjazz/rails_charts"
              >Rails Charts Using ECharts from Apache</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 09:00:53</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44938667"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44937819">
          <h3>
            <a
              class="item"
              href="https://sites.pitt.edu/~jdnorton/Goodies/block_stacking/block_stacking.html"
              >The Block Stacking Problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-18 @ 06:01:44</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44937819"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44921195">
          <h3>
            <a
              class="item"
              href="https://cpldcpu.com/2025/08/13/candle-flame-oscillations-as-a-clock/"
              >Candle Flame Oscillations as a Clock</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-16 @ 07:49:51</span
              ><span class="points-container"
                >Points: <span class="points">309</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44921195"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
