<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36085538">
          <h3>
            <a class="item" href="https://github.com/kyegomez/tree-of-thoughts"
              >Tree of Thoughts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 15:34:59</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36085538"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36085536">
          <h3>
            <a class="item" href="https://stripe.com/docs/payments/paypal"
              >Stripe Launches PayPal Integration</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 15:34:54</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36085536"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36085531">
          <h3>
            <a
              class="item"
              href="https://spacenews.com/nasa-safety-panel-skeptical-of-starliner-readiness-for-crewed-flight/"
              >NASA safety panel skeptical of Starliner readiness for crewed
              flight</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 15:34:48</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36085531"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36085310">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36085310"
              >Ask HN: Have any managers/team leads been asked to layoff staff
              b/c of AI?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 15:18:15</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36085310"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
            <div class="text">
              <p>I'm wondering how common this is right now ?</p>
            </div>
          </section>
        </section>
        <section id="36084881">
          <h3>
            <a
              class="item"
              href="https://shkspr.mobi/blog/2023/02/how-much-of-ais-recent-success-is-due-to-the-forer-effect/"
              >How much of AI's recent success is due to the Forer Effect?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 14:45:48</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36084881"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36084503">
          <h3>
            <a class="item" href="https://www.fretboardfly.com"
              >Show HN: I created a game to memorize the fretboard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 14:18:58</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36084503"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>“Uhh…Where’s the C# here?”</p>
              <p>“Where’s the flat-3rd of this root on the 4th string?”</p>
              <p>
                “Sure would be nice to know the closest min7 triad shape to play
                over here..”
              </p>
              <p>
                I tried memorizing the fretboard the obvious way but it
                extreeemly boring for me. Being a developer, I decided to turn
                it into a game. I'd love for you guys to try it out and let me
                know what you think: It's at [www.fretboardfly.com](<a
                  href="https://www.fretboardfly.com"
                  >https://www.fretboardfly.com</a
                >)
              </p>
              <p>
                I've only built the first module right now which is for note
                memorization but there's been enough interest that I'm planning
                on building more modules. Please let me know if you like it,
                what you'd change about it and what other modules you'd like to
                see in future.
              </p>
              <p>
                The stack is Vue 3/Nuxt 3/Firebase/Firestore/Tailwind deployed
                on Vercel. Happy to field questions on the tech side of things
                as well
              </p>
            </div>
          </section>
        </section>
        <section id="36084483">
          <h3>
            <a
              class="item"
              href="https://www.trueorbetter.com/2018/05/how-lemon-was-invented.html"
              >How the lemon was invented</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 14:17:23</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36084483"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36084450">
          <h3>
            <a class="item" href="https://deno.com/blog/node-builtins-on-deploy"
              >Node.js built-ins on Deno Deploy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 14:14:22</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36084450"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36084076">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/news/our-local-correspondents/what-is-a-weed"
              >What Is a Weed?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 13:47:55</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36084076"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36083707">
          <h3>
            <a
              class="item"
              href="https://nationalinterest.org/feature/case-south-korean-membership-g7-206233"
              >The case for South Korean membership in the G7</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 13:19:27</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36083707"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36083620">
          <h3>
            <a
              class="item"
              href="https://twitter.com/PGeldsetzer1/status/1661776663074738176"
              >Causal evidence that Alzheimer's may be caused by an infection</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 13:11:50</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36083620"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36082788">
          <h3>
            <a
              class="item"
              href="https://bugzilla.redhat.com/show_bug.cgi?id=2208553"
              >XFS metadata corruption after upgrade to 6.3.3 kernel</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 11:37:01</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36082788"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36082453">
          <h3>
            <a
              class="item"
              href="https://jdebp.uk/FGA/dont-abuse-su-for-dropping-privileges.html"
              >Don't abuse su for dropping user privileges (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 10:49:30</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36082453"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36081655">
          <h3>
            <a
              class="item"
              href="https://newsletter.pragmaticengineer.com/p/layoffs-push-down-scores-on-glassdoor"
              >Layoffs push down scores on Glassdoor: this is how companies
              respond</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 08:48:20</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36081655"
                  >Comments</a
                ><span class="descendants">: 165</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36081540">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36081540"
              >Ask HN: What are some good resources for learning about low level
              disk/file IO?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 08:29:57</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36081540"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
            <div class="text">
              <p>
                Example of some questions I'd like to be able to answer or at
                least make reasonable decisions about (<i>note</i>: I don't
                actually want any answers to the above now, they're just
                examples of the sort of thing I'd like to read in depth about,
                and build up some background knowledge):
              </p>
              <p></p>
              <pre><code>  * how to ensure data's been safely written (e.g. when to flush, fsync, what
    guarantees that gives, using WAL)
  * blocks sizes to read/write for different purposes, tradeoffs, etc.
  * considerations for writing to different media/filesystems (e.g. disk, ssd, NFS)
  * when to rely on OS disk cache vs. using own cache
  * when to use/not use mmap
  * performance considerations (e.g. multiple small files vs. few larger ones,
    concurrent readers/writers, locking, etc.)
  * OS specific considerations
</code></pre>
              I recall reading some posts (related to Redis/SQLite/Postgres)
              related to this, which made me realise that it's a fairly complex
              topic, but not one I've found a good entry point for.
              <p>
                Any pointers to books, documentation, etc. on the above would be
                much appreciated.
              </p>
            </div>
          </section>
        </section>
        <section id="36081240">
          <h3>
            <a
              class="item"
              href="https://www.vibilagare.se/english/12-years-saabs-bankruptcy-secret-nevs-electric-cars-revealed"
              >12 years since Saab’s bankruptcy: Secret NEVS electric cars
              revealed</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 07:43:22</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36081240"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36080886">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2305.12544"
              >A PhD student's perspective on research in NLP in the era of
              LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 06:52:03</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36080886"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36079940">
          <h3>
            <a
              class="item"
              href="https://hakaimagazine.com/features/weird-rare-and-everywhere/"
              >Weird, Rare, and Everywhere</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 04:30:03</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36079940"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36079649">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-01700-y"
              >New work helps to explain how chronic stress can inflame the
              gut</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 03:54:08</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36079649"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36079311">
          <h3>
            <a
              class="item"
              href="https://theclimatebrink.substack.com/p/emissions-are-no-longer-following"
              >Emissions are no longer following the worst case scenario</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 03:08:23</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36079311"
                  >Comments</a
                ><span class="descendants">: 168</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36079115">
          <h3>
            <a
              class="item"
              href="https://cacm.acm.org/magazines/2023/6/273222-the-silent-revolution-of-sat/fulltext"
              >The Silent (R)evolution of SAT</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-26 @ 02:41:54</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36079115"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36074959">
          <h3>
            <a
              class="item"
              href="https://www.jitx.com/blog/automating-everything-in-a-usb-cable-tester-pcb-design"
              >Automating everything in a USB cable tester PCB design</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-25 @ 19:25:37</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36074959"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36069260">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/2012/08/before-the-fire/"
              >Before the Fire: Saturn-Apollo Applications (1966)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-25 @ 11:13:44</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36069260"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36068682">
          <h3>
            <a class="item" href="https://ogris.de/howtos/freebsd-jails.html"
              >Jails on FreeBSD</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-25 @ 09:37:40</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36068682"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36068677">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36068677"
              >Ask HN: What happened to fuzzy logic?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-25 @ 09:37:13</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36068677"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
            <div class="text">
              Fuzzy Logic was a very talked about field few decades ago. What is
              the state of that field of research? Is it still being persued or
              are there applications of it already implemented commercially?
            </div>
          </section>
        </section>
        <section id="36068243">
          <h3>
            <a class="item" href="https://xyproblem.info/"
              >The XY Problem (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-25 @ 08:17:35</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36068243"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36067958">
          <h3>
            <a class="item" href="https://github.com/tidwall/jj"
              >Jj: JSON Stream Editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-25 @ 07:25:18</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36067958"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36057997">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36057997"
              >Ask HN: How do you approach a problem you are not sure has a
              solution?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-24 @ 13:46:42</span
              ><span class="points-container"
                >Points: <span class="points">250</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36057997"
                  >Comments</a
                ><span class="descendants">: 218</span></span
              >
            </h4>
            <div class="text">
              How do you battle against (self-inflicted) anxiety/paralysis when
              you are attempting to tackle a problem you are not sure has a
              solution? I have a very open mind to solving problems but it can
              make it difficult to come to conclusions. Anyone know what I'm
              talking about here? Have any advice?
            </div>
          </section>
        </section>
        <section id="36054751">
          <h3>
            <a
              class="item"
              href="https://inference-review.com/article/state-of-the-union"
              >State of the Union (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-24 @ 06:23:27</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36054751"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36042371">
          <h3>
            <a
              class="item"
              href="https://www.cs.cmu.edu/~pavlo/slides/pavlo-keynote-sigmod2017.pdf"
              >Nobody cares about our concurrency control research [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-23 @ 10:45:09</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36042371"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
