<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41369885">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/great-question/jobs/zQR17wz-customer-support-lead"
              >Great Question (YC W21) Is Hiring Customer Support Lead</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 17:00:27</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41369705">
          <h3>
            <a
              class="item"
              href="https://cerebras.ai/blog/introducing-cerebras-inference-ai-at-instant-speed"
              >Cerebras Inference: AI at Instant Speed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 16:49:46</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41369705"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41369586">
          <h3>
            <a
              class="item"
              href="https://twitter.com/ArtificialAnlys/status/1828463912389402896"
              >Cerebras launches inference for Llama 3.1; benchmarked at 1846
              tokens/s on 8B</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 16:42:01</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41369586"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41369008">
          <h3>
            <a
              class="item"
              href="https://cacm.acm.org/opinion/the-myth-of-the-coder/"
              >The Myth of the Coder and Programmer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 16:02:44</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41369008"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41368935">
          <h3>
            <a
              class="item"
              href="https://salesforcedevops.net/index.php/2024/08/19/ai-apocalypse/"
              >80% of AI Projects Crash and Burn, Billions Wasted Says Rand
              Report</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 15:55:56</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41368935"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41368866">
          <h3>
            <a
              class="item"
              href="https://www.theartnewspaper.com/2024/08/27/sainsbury-wing-contractors-find-1990-letter-from-donor-anticipating-their-demolition-of-false-columns"
              >Sainsbury Wing contractors find 1990 letter from donor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 15:49:27</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41368866"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41368835">
          <h3>
            <a class="item" href="https://bootstrappable.org"
              >Bootstrappable Builds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 15:46:02</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41368835"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41368363">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Eazel"
              >Eazel, ex-Apple led Linux startup</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 15:04:46</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41368363"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41367964">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2024/08/new-0-day-attacks-linked-to-chinas-volt-typhoon/"
              >New 0-Day Attacks Linked to China's 'Volt Typhoon'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 14:31:50</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41367964"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41367750">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41367750"
              >Launch HN: Bucket Robotics (YC S24) – Defect detection for molded
              and cast parts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 14:12:45</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41367750"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <a href="https://bucket.bot">https://bucket.bot</a> Bucket
              transforms CAD models into custom defect detection models for
              manufacturing:
              <a href="https://youtu.be/RCyguguf3Is"
                >https://youtu.be/RCyguguf3Is</a
              >
              <p>
                Injection molded and cast parts are everywhere – 50% of what’s
                visible on a modern car is injection molded – and these molds
                are custom created for each part and assembly line. Injection
                molding is a process where small plastic pellets are heated -
                primarily by friction from an auger - and pushed into a mold -
                usually two big milled out chunks of aluminum or steel - that
                are pushed together by somewhere between 10 tons and 1000s of
                tons of pressure. Once the plastic cools the machine opens up
                the mold and pushes the newly formed object out using rods
                called ejector pins. Look at a plastic object and you can
                usually find a couple round marks from the ejector pins, a mark
                from the injection site, a ridge where the faces of the molds
                meet, and maybe some round stamp marks that tell you the day and
                shift it was made on. (Link to a great explainer on the process:
                <a href="https://youtu.be/RMjtmsr3CqA?si=QjErT_rOU9-_TQ8d"
                  >https://youtu.be/RMjtmsr3CqA?si=QjErT_rOU9-_TQ8d</a
                >)
              </p>
              <p>
                Defect detection is either traditional ML based – get a
                real-world sample, image it, label defect, repeat until there’s
                a big enough set to build a model – or done manually. Humans
                have an 80% success rate at detection - that gets worse
                throughout the day, because decision fatigue leads to
                deterioration in performance near lunch/end-of-shift (<a
                  href="https://en.wikipedia.org/wiki/Decision_fatigue"
                  >https://en.wikipedia.org/wiki/Decision_fatigue</a
                >). Creating an automated system usually takes somewhere between
                2 days and 2 weeks to collect and label real world samples then
                build a model.
              </p>
              <p>
                Injection molding is currently a 300 billion USD market, and as
                vehicle electrification increases, more of the total components
                of a car are injection molded making that market even bigger.
                And because so much of that surface area is customer-facing –
                any blemish, scratch, or burn is considered defective. Speaking
                to folks in the space, you can see a defect rate as high as 15%
                for blemishes as small as 1cm^2.
              </p>
              <p>
                Our solution to this problem is to build the models off of CAD
                designs instead of real world data. An injection mold is usually
                machined aluminum or steel and can cost anywhere from $5k to
                &gt;$100k - usually with a significant lead time. So when
                customers send out their designs to the mold makers - or their
                CNC if they do it in-house - they can also send them to us in
                parallel and have a defect detection model ready to go long
                before their mold is even finished.
              </p>
              <p>
                On the backend we’re generating these detection models by
                creating a large number of variations of the 3D model - some to
                simulate innocuous things like ejector pin marks and most to
                simulate various defects like flash. Once we have our 3D models
                generated we fire them off to the cloud to render photorealistic
                scenes with varied camera parameters, lighting, and obscurants
                (shops are dusty). Now that we have labeled images it’s a simple
                task to train a fairly off the shelf transformer based vision
                model from them and deliver it to the customer.
              </p>
              <p>
                Running the model doesn’t require fancy hardware - our usual
                target device is an Orin Nano with a 12MP camera on it - and we
                run it purely on-device so that customer images don’t need to
                leave their worksite. We charge customers by the model — when
                they plan a line change to a new mold, ideally they’ll contact
                us and we’ll have their model ready before retooling is
                complete.
              </p>
              <p>
                Injection molding is as error prone as it is cool to watch. For
                example, flash is a thin layer of extra plastic - usually
                hanging off the edge of the part or overhanging a hole in the
                part which makes parts defective aesthetically or can even
                prevent parts from joining up properly. It can happen for so
                many reasons. Too high an injection pressure, too low a clamping
                pressure, a grubby mold surface, mold wear, poor mold design,
                and that’s just to name a few!
              </p>
              <p>
                Steph and I have a history of working on tasks performed
                manually that we want to automate – we’ve been working together
                for the last five years in Pittsburgh on self-driving cars at
                Argo AI, Latitude AI, and Stack AV. Before that, I worked at
                Michelin’s test track and Uber ATG. We really, really love
                robots.
              </p>
              <p>
                Our first pitch to Y Combinator was, “build a better Intel
                RealSense” since it’s a universally used (and loathed) vision
                system in robotics. We built our first few units and started
                building demos for how folks could use our camera - and that’s
                when we found defect detection for injection molding and
                casting. Defect detection is understood and highly automated for
                things like PCBs – where a surface defect can indicate a future
                critical failure (hey that capacitor looks a little big?) but
                defect detection for higher volume/lower cost parts is still too
                high a cost and effort for most shops.
              </p>
              <p>
                We’re excited to launch Bucket with you all! We’d love to hear
                from the community – and if you know anyone working in
                industrial computer vision or in quality control, please connect
                us! My email is matt@bucket.bot – we can’t wait to see what you
                all think!
              </p>
            </div>
          </section>
        </section>
        <section id="41367644">
          <h3>
            <a class="item" href="https://lucumr.pocoo.org/2024/8/27/minijinja/"
              >MiniJinja: Learnings from Building a Template Engine in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 14:02:43</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41367644"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41366436">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/energy/underground-nuclear-reactors/"
              >Nuclear reactors a mile underground promise safe, cheap power</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 11:36:25</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41366436"
                  >Comments</a
                ><span class="descendants">: 210</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41366304">
          <h3>
            <a
              class="item"
              href="https://mainichi.jp/english/articles/20240823/p2a/00m/0bu/024000c"
              >Why has Japan been hit with rice shortages despite normal
              crops?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 11:19:42</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41366304"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41366064">
          <h3>
            <a
              class="item"
              href="https://www.sciencenews.org/article/dark-matter-wimps-lz"
              >The possibilities for dark matter have shrunk</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 10:37:06</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41366064"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41366006">
          <h3>
            <a class="item" href="https://splatt3r.active.vision/"
              >Splatt3R: Zero-Shot Gaussian Splatting from Uncalibrated Image
              Pairs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 10:23:35</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41366006"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41365868">
          <h3>
            <a
              class="item"
              href="https://www.politico.com/news/2024/08/26/zuckerberg-meta-white-house-pressure-00176399"
              >Zuckerberg claims regret on caving to White House pressure on
              content</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 09:50:15</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41365868"
                  >Comments</a
                ><span class="descendants">: 424</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41365637">
          <h3>
            <a
              class="item"
              href="https://twitter.com/realgeorgehotz/status/1828197925874463166"
              >"Tinyboxes finally have a buy it now button"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 08:54:44</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41365637"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41364637">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/08/26/anthropic-publishes-the-system-prompt-that-makes-claude-tick/"
              >Anthropic publishes the 'system prompts' that make Claude tick</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 04:45:46</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41364637"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41364549">
          <h3>
            <a
              class="item"
              href="https://box86.org/2024/08/box64-and-risc-v-in-2024/"
              >Box64 and RISC-V in 2024: What It Takes to Run the Witcher 3 on
              RISC-V</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 04:23:27</span
              ><span class="points-container"
                >Points: <span class="points">307</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41364549"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41364412">
          <h3>
            <a class="item" href="https://rustdate.over-yonder.net/"
              >FreeBSD-rustdate, a reimplementation of FreeBSD-update</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 03:46:35</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41364412"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41363549">
          <h3>
            <a
              class="item"
              href="https://www.classcentral.com/report/2u-edx-bankruptcy/"
              >The Triple Failure of 2U, EdX, and Axim</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-27 @ 00:34:05</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41363549"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41363231">
          <h3>
            <a
              class="item"
              href="https://www.finalemusic.com/blog/end-of-finale-new-journey-dorico-letter-from-president/"
              >The End of Finale</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 23:34:21</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41363231"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41361281">
          <h3>
            <a
              class="item"
              href="https://transactional.blog/blog/2024-erasure-coding"
              >Erasure Coding for Distributed Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 20:03:45</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41361281"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41347230">
          <h3>
            <a
              class="item"
              href="https://github.com/DOSAYGO-Research/irradix/blob/main/paper.md"
              >Show HN: Outperforming VByte for Large Integers Using
              Phi-Encoding</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 13:38:45</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41347230"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41346201">
          <h3>
            <a
              class="item"
              href="https://nbviewer.org/github/SciRuby/sciruby-notebooks/blob/master/getting_started.ipynb"
              >Ruby in Jupyter Notebook</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 10:28:47</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41346201"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41340874">
          <h3>
            <a
              class="item"
              href="https://www.chiefdelphi.com/t/team-341-miss-daisy-2024-cad-code-and-design-binder-release/467546"
              >Show HN: High school robotics code/CAD/design binder release</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 19:40:18</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41340874"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                My name is Patrick, and I am a junior at my High School’s FRC
                robotics team FRC 341 “Miss Daisy” (yes named after the movie).
                Every year, during the first weekend in January, a new robotics
                game is released (no it’s not battlebots). The game could be
                about launching balls into a goal, climbing monkeybars, or
                placing cubes on a see-saw. This year we were challenged to
                build a robot that could shoot orange foam donuts into a goal
                about 6 feet in the air. Here is a yt video with the game
                animation
                <a href="https://www.youtube.com/watch?v=9keeDyFxzY4&amp;t"
                  >https://www.youtube.com/watch?v=9keeDyFxzY4&amp;t</a
                >. After we received the game we then had six weeks to design,
                build, program, and field a robot capable of playing the game.
                And we did pretty well this year! I have attached a ChiefDelphi
                thread (robotics forum) where we have released our season
                materials. This being our CAD (3D model of robot), code, and
                design binder. I encourage you to take a look and leave any
                questions that you may have.
              </p>
              <p>Thanks a lot!</p>
            </div>
          </section>
        </section>
        <section id="41338946">
          <h3>
            <a class="item" href="https://github.com/nicbarker/clay"
              >Clay (short for C Layout) is a high performance 2D UI layout
              library</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 15:26:45</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41338946"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41338240">
          <h3>
            <a
              class="item"
              href="https://lackofimagination.org/2024/08/firewalling-your-code/"
              >Firewalling your code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 13:39:42</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41338240"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41336462">
          <h3>
            <a class="item" href="https://github.com/HumbleUI/HumbleUI"
              >Clojure Desktop UI Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 08:01:39</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41336462"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41318440">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-08-mammoths-ice-age-people-pikes.html"
              >To kill mammoths in the Ice Age, people used planted pikes, not
              throwing spears</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-22 @ 09:52:29</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41318440"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
