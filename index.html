<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40065862">
          <h3>
            <a class="item" href="https://www.futureofhumanityinstitute.org"
              >Future of Humanity Institute shuts down</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 15:14:08</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40065862"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40065704">
          <h3>
            <a
              class="item"
              href="https://cutlefish.substack.com/p/tbm-271-the-biggest-untapped-opportunity"
              >The biggest source of waste is untapped skilled pragmatists</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 15:04:08</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40065704"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40065114">
          <h3>
            <a
              class="item"
              href="https://stability.ai/news/stable-diffusion-3-api"
              >Stable Diffusion 3 API Now Available</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 14:26:31</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40065114"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40064744">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=zdv6MlFlOrA"
              >Formlabs Form 4 3D Printer Beats Injection Molding Machine in
              Speed and Quality [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 14:01:26</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40064744"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40064736">
          <h3>
            <a class="item" href="https://mistral.ai/news/mixtral-8x22b/"
              >Mixtral 8x22B</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 14:00:37</span
              ><span class="points-container"
                >Points: <span class="points">296</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40064736"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40064105">
          <h3>
            <a
              class="item"
              href="https://bostondynamics.com/blog/electric-new-era-for-atlas/"
              >An Electric New Era for Atlas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 13:12:14</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40064105"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40064027">
          <h3>
            <a
              class="item"
              href="https://research.google/blog/solving-the-minimum-cut-problem-for-undirected-graphs/"
              >Solving the minimum cut problem for undirected graphs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 13:05:14</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40064027"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063908">
          <h3>
            <a
              class="item"
              href="https://lxqt-project.org/release/2024/04/15/release-lxqt-2-0-0/"
              >LXQt 2.0.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:52:06</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063908"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063803">
          <h3>
            <a class="item" href="https://github.com/WINSDK/bite"
              >Show HN: BiTE – Cross-platform executable viewer and reverse
              engineering tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:39:49</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063803"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                I’m excited to share a project I’ve been working on throughout
                my university studies. It’s called BiTE (<a
                  href="https://github.com/WINSDK/bite"
                  >https://github.com/WINSDK/bite</a
                >) and it's a tool primarily focused on being an executable
                viewer with reverse engineering capabilities.
              </p>
              <p>
                BiTE supports Windows, MacOS, and Linux, along with their
                associated executable formats. It’s also capable of parsing and
                displaying debug information using DWARF/PDB formats, which I
                hope will be useful even for just comparing codegen.
              </p>
              <p>
                I’ve put a lot of effort into this and it's the first time I'm
                releasing something like this publicly. Any feedback, bug
                reports, or feature suggestions would be greatly appreciated!
              </p>
            </div>
          </section>
        </section>
        <section id="40063795">
          <h3>
            <a
              class="item"
              href="https://www.scottaaronson.com/democritus/lec9.html"
              >Quantum mechanics is the operating system that other physical
              theories run on</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:38:40</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063795"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063607">
          <h3>
            <a
              class="item"
              href="https://www.stimmel-law.com/en/articles/story-2-acid-test-clause"
              >The VC acid test as a founder (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:21:06</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063607"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063367">
          <h3>
            <a
              class="item"
              href="https://johnhawks.net/weblog/how-many-bathrooms-have-neandertals-in-the-tile/"
              >How many bathrooms have Neanderthals in the tile?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:00:32</span
              ><span class="points-container"
                >Points: <span class="points">228</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063367"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063366">
          <h3>
            <a class="item" href="https://www.finleycms.com/careers/"
              >Finley (YC W21) is hiring for capital markets innovators (US
              remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:00:25</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063137">
          <h3>
            <a
              class="item"
              href="https://github.com/Desbordante/desbordante-core"
              >Show HN: Desbordante 2.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 11:36:54</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063137"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>Changes:</p>
              <p>
                * New feature: discovery of exact order dependencies. This
                primitive allows you to discover patterns related to orderings
                of columns, e.g. pay increasing with grade. It is available with
                two different axiomatizations — set-based and list-based. The
                latter is faster, but may miss some dependencies, while the
                former is more accurate, but computationally more demanding.
                Note that they present dependencies in different formats.
              </p>
              <p>
                * New feature: discovery of probabilistic functional
                dependencies for both existing metrics: PerTuple and PerValue.
                This primitive helps in discovering a special case of
                approximate functional dependencies that better detects multiple
                violations in a small set of clusters. Provided examples
                illustrate the differences between existing AFD formulation and
                those PFDs, as well as show some of the potential use cases of
                PFDs.
              </p>
              <p>
                * New feature: discovery of inclusion dependencies. This
                primitive can help users to recover primary key — foreign key
                relationships, or to find joinable columns in a table or a
                collection of tables. It is available as an exact algorithm
                (Spider) and as an approximate one (Faida), with Faida
                potentially producing errors but being much faster.
              </p>
              <p>
                * New feature: we extend the set of supported data types by
                adding graphs. We started with supporting graph functional
                dependencies (GFD), and Desbordante can now validate GFDs. GFDs
                allow users to define patterns in graphs, specifying conditions
                both on graph structure and node content. Graph dependencies can
                be a bit tricky, so we provide illustrated examples.
              </p>
              <p>
                * We’ve made discovery of conditional functional dependencies
                available in Python. This primitive can be considered as:
              </p>
              <p></p>
              <pre><code>  1) an another way to define approximate functional dependencies, which, unlike other approaches, offers rich semantics (context), helping in understanding complex cases when the exact FD does not hold,
 
  2) an AFDs discovery algorithm which provides control over how frequent and how consistent this pattern is, 

  3) a building block for many existing data repair algorithms. 
</code></pre>
              * We’ve also made validation of approximate unique column
              combinations available in Python. This primitive is suitable for
              defining keys in tables and for detecting partial duplicates over
              a subset of columns. As is usually the case with any validation
              primitive, we additionally provide discovery of exceptions and
              computation of improved thresholds.
              <p>
                For all introduced primitives, we provide descriptive examples.
                All primitives are supported in the console version of
                Desbordante, with the help file containing references to papers
                in which these primitives are described.
              </p>
              <p>Miscellaneous:</p>
              <p>
                * We have established a github organization and gathered all
                repositories related to our project in one place.
              </p>
              <p>
                * We have extended the coverage of the option for limiting the
                maximum size of the left-hand side to all functional dependency
                discovery algorithms. This should allow users to speed up the FD
                discovery if they do not need dependencies with large LHSes.
              </p>
              <p>
                * We’ve added many new example scripts. Since the project is
                currently under-documented, we hope this will be helpful for our
                potential users. You can see them here (<a
                  href="https://github.com/Desbordante/desbordante-core/tree/main/examples"
                  >https://github.com/Desbordante/desbordante-core/tree/main/ex...</a
                >).
              </p>
              <p>
                * To improve our overall documentation level, we have also
                published several guides — see the papers section (<a
                  href="https://desbordante.unidata-platform.ru/papers"
                  >https://desbordante.unidata-platform.ru/papers</a
                >).
              </p>
            </div>
          </section>
        </section>
        <section id="40062987">
          <h3>
            <a
              class="item"
              href="https://www.tugraz.at/en/tu-graz/services/news-stories/media-service/singleview/article/sicherheitsluecke-in-browser-schnittstelle-erlaubt-rechnerzugriff-ueber-grafikkarte"
              >Security Vulnerability in Browser Interface Allows Computer
              Access via GPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 11:17:29</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40062987"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40062590">
          <h3>
            <a
              class="item"
              href="https://bitbucket.org/blaze-lib/blaze/src/master/"
              >Blaze: A High Performance C++ Math Library</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 10:15:57</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40062590"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40062552">
          <h3>
            <a
              class="item"
              href="https://kguttag.com/2023/12/06/humane-ai-pico-laser-projection-230m-ai-twist-on-an-old-scam/"
              >Humane AI – Pico Laser Projection – AI Twist on an Old Scam
              (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 10:11:50</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40062552"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40061597">
          <h3>
            <a
              class="item"
              href="https://profmattstrassler.com/2024/04/16/why-the-higgs-field-is-nothing-like-molasses-soup-or-a-crowd/"
              >Why the Higgs Field Is Nothing Like Molasses, Soup, or a Crowd</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 07:35:01</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40061597"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40061298">
          <h3>
            <a
              class="item"
              href="https://fosscomics.com/8.%20The%20Origins%20of%20Unix%20and%20the%20C%20Language/"
              >F/OSS Comics: 8. The Origins of Unix and the C Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 06:51:13</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40061298"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40060915">
          <h3>
            <a
              class="item"
              href="https://www.bonappetit.com/story/food-industry-influencers"
              >How the Food Industry Pays Influencers to Shill Blueberries,
              Butter, and More</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 05:48:46</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40060915"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40060198">
          <h3>
            <a
              class="item"
              href="https://www.cs.yale.edu/homes/perlis-alan/quotes.html"
              >Perlis's Programming Epigrams</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 03:43:18</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40060198"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40060123">
          <h3>
            <a
              class="item"
              href="https://rmarcus.info/blog/2024/04/12/pg-over-time.html"
              >Ten years of improvements in PostgreSQL's optimizer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 03:27:58</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40060123"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40059887">
          <h3>
            <a
              class="item"
              href="https://ajkprojects.com/stopactinglikeyourefamous"
              >Stop Acting Like You're Famous</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 02:44:58</span
              ><span class="points-container"
                >Points: <span class="points">473</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40059887"
                  >Comments</a
                ><span class="descendants">: 227</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40059829">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/20240415-47/?p=109663"
              >Tax consequences of WIN95 team members keeping a piece of
              software for testing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 02:34:09</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40059829"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40055908">
          <h3>
            <a
              class="item"
              href="https://hazlitt.net/feature/everything-we-cant-describe-music"
              >Everything We Can't Describe in Music</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 19:02:13</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40055908"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40050027">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/2024/04/15/raytracing-on-meteor-lakes-igpu/"
              >Raytracing on Meteor Lake's iGPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 09:34:27</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40050027"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40048702">
          <h3>
            <a class="item" href="https://filipvrba.github.io/ruby-js/"
              >RubyJS-Vite</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 05:41:44</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40048702"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40048177">
          <h3>
            <a class="item" href="https://github.com/kevinbentley/Descent3"
              >Descent 3 Source Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 03:49:06</span
              ><span class="points-container"
                >Points: <span class="points">1198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40048177"
                  >Comments</a
                ><span class="descendants">: 316</span></span
              >
            </h4>
            <div class="text">
              Someone recently asked if the source code from Descent 3 will be
              released. I reached out to my old boss (Matt Toschlog) at Outrage
              Entertainment and he gave me the go ahead. I'm going to work on
              getting this running again and I'm looking for some
              co-maintainers.
            </div>
          </section>
        </section>
        <section id="40047806">
          <h3>
            <a
              class="item"
              href="https://maphappenings.com/2024/04/11/story-of-etak/"
              >A curious phenomenon called 'Etak'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 02:27:23</span
              ><span class="points-container"
                >Points: <span class="points">920</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40047806"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40045832">
          <h3>
            <a
              class="item"
              href="https://link.springer.com/article/10.1007/s10816-024-09642-z"
              >Bronze Age Stone Anchors as Material Metaphors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-15 @ 21:29:28</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40045832"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
