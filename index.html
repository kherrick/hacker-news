<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41184952">
          <h3>
            <a class="item" href="https://github.com/neondatabase/neon"
              >Neon: A serverless open-source alternative to AWS Aurora
              Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 20:16:06</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184952"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41184726">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41184726"
              >Ask HN: Front-end bait and switch?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 19:52:29</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184726"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <i>First-paragraph TL;DR:</i> A weird and very specific thing
              keeps happening to me: I tell a recruiter that I don't do
              front-end work, I take an interview with an employer, I make it
              clear during the interview that I don't do front-end work, I hear
              nothing but "Yes", I take the job...and then I get assigned
              front-end work. My performance drops off a cliff, I try to
              communicate, it gets worse, and if I don't quit, I get fired. Once
              could be a fluke, but it has happened several times. I don't
              understand and would seriously like to understand so I can avoid
              it.
              <p>
                Here's the most recent example: I interview in December, it's
                great, there's a former colleague that remembers a lecture I
                gave, he's a cool guy, and I make it clear to new boss that I
                don't do front-end work, but to be sure, I tell them during the
                last round of interviews not just that I don't do front-end but
                that I keep getting this bizarre bait and switch. New boss nods,
                talks about scaling problems, they need someone that's good at
                Postgres. I sign a job offer and my first week, I get "please
                move these buttons". I protest, he says it's to get me used to
                their workflow. So I move the buttons, then go back and forth
                with QA for a week on spacing issues. I get a bad feeling and
                remind new boss. Similar weeks go by, I get invited to a
                meeting, HR CC'd: I'm slow and my work is bad. I tell them I'll
                do whatever they want to pay me to do, but I do a better job if
                I'm doing the work I am great at, "I mentioned this during the
                interview, I would not have taken the job if it was front-end".
                New boss stares down and does not say anything for while the
                lead talks about everyone on his team being a full-stack
                developer so I need to acquire front-end expertise in a hurry. I
                spend my evenings and weekends learning Vue.js, doesn't go well,
                another meeting where new boss won't make eye contact and now
                he's old boss.
              </p>
              <p>
                I still don't understand why. I've started getting somewhat
                superstitious: I'm leaving JS/CSS off my resume and LinkedIn, I
                tell recruiters that I don't know JS. I hear about the
                difficulty scaling their public-facing APIs, the new customer
                that requires rewriting the ETL pipeline, I sign up, but I
                arrive and hear "We'll do those things later, first we need you
                to make a landing page and help port the front end to the new
                version of React."
              </p>
              <p>
                It's gotten maddening: at a previous employer, I started having
                panic attacks and chain-smoking (both fixed now). I design and
                build APIs, I write back-end code, I optimize
                Postgres/MySQL/Redis, I build telemetry and then use it to
                implement data-driven rate limits to mitigate DDoS attacks, I
                architect systems, I transform and move massive amounts of data
                quickly and reliably. I'm very good at those things just not at
                browser front-ends.
              </p>
              <p>
                I can't rationalize it as coincidence or a fluke: at least half
                a dozen employers have told me I'd be doing back-ends and ask me
                for front-end web development. I've worked at a lot of startups
                and have done plenty of consulting jobs: I understand wearing
                several hats (it is one of my favorite things about startups),
                and I like jumping in to help where it's needed, even on the
                front-end.
              </p>
              <p>
                Has this happened to anyone else? No one I have worked with
                before seems to have this problem. Why would an employer do
                this? That's important to know: if I don't know why, I don't
                know what to do to prevent it. Since I am well into the
                senior/staff level and skilled, I cost way more than a junior
                front-end dev, so it can't be for economic reasons. It has
                happened too many times across too many years to be a weird
                employer or a coincidence. I don't want to come off defensive or
                combative during an interview, but even being extremely direct
                has gotten the same result, so it can't be ambiguity. Is there
                some magic phrase I can use with employers to say "Seriously, we
                will both be unhappy if you want me to make a web front-end,
                this will be a catastrophe"? What am I doing wrong?
              </p>
            </div>
          </section>
        </section>
        <section id="41184559">
          <h3>
            <a class="item" href="https://mistral.ai/news/build-tweak-repeat/"
              >Mistral Agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 19:32:46</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184559"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41184365">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/blog-post/prevention-hiv"
              >Prevention of HIV</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 19:11:39</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184365"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41184359">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/08/07/science/boeing-starliner-nasa-spacex.html"
              >NASA Says Boeing Starliner Astronauts May Fly Home on SpaceX in
              2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 19:10:54</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184359"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41184307">
          <h3>
            <a
              class="item"
              href="https://www.turkiyetoday.com/turkiye/4-reasons-why-turkiye-banned-roblox-37404/"
              >Türkiye Bans Roblox</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 19:05:42</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184307"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41184153">
          <h3>
            <a
              class="item"
              href="https://lapcatsoftware.com/articles/2024/8/3.html"
              >Apple memory holed its broken promise for an OCSP opt-out</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 18:50:55</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184153"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41184102">
          <h3>
            <a
              class="item"
              href="https://hackaday.com/2024/08/05/a-two-stroke-engine-made-from-scratch-using-basic-hardware-store-parts/"
              >A Two-Stroke Engine Made from Scratch Using Basic Hardware Store
              Parts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 18:44:03</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184102"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41184037">
          <h3>
            <a
              class="item"
              href="https://blog.gitbutler.com/gitbutler-is-now-fair-source/"
              >GitButler is now fair source</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 18:35:08</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41184037"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41183808">
          <h3>
            <a
              class="item"
              href="https://www.core77.com/posts/133176/What-are-the-Olympics-Shooting-Competitors-Wearing-On-Their-Faces"
              >What Are the Olympics Shooting Competitors Wearing on Their
              Faces?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 18:08:24</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41183808"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41183269">
          <h3>
            <a
              class="item"
              href="https://e360.yale.edu/digest/clean-air-act-climate-change"
              >1970 Clean Air Act was intended to cover carbon dioxide</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 17:05:12</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41183269"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41183240">
          <h3>
            <a
              class="item"
              href="https://github.com/dotnet/csharplang/blob/18a527bcc1f0bdaf542d8b9a189c50068615b439/proposals/TypeUnions.md"
              >Official proposal for Type Unions in C#</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 17:02:00</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41183240"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41183224">
          <h3>
            <a
              class="item"
              href="https://job-boards.greenhouse.io/flexport/jobs/5993812?gh_jid=5993812"
              >Flexport (YC W14) is hiring a product designer for our new
              Control Tower product</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 17:00:39</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41183115">
          <h3>
            <a class="item" href="https://icode4.coffee/?p=954"
              >Tony Hawk's Pro Strcpy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 16:48:42</span
              ><span class="points-container"
                >Points: <span class="points">237</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41183115"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41182847">
          <h3>
            <a
              class="item"
              href="https://hacks.mozilla.org/2024/08/puppeteer-support-for-firefox/"
              >Puppeteer Support for Firefox</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 16:19:06</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41182847"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41182805">
          <h3>
            <a
              class="item"
              href="https://www.gauge.sh/blog/python-extensions-should-be-lazy"
              >Python extensions should be lazy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 16:14:04</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41182805"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41182714">
          <h3>
            <a
              class="item"
              href="https://www.genengnews.com/topics/translational-medicine/cell-free-bioactive-scaffold-supports-cartilage-regeneration-in-large-animal-joints/"
              >Cell-Free Bioactive Scaffold Supports Cartilage
              Regeneration-Large Animal Joints</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 16:04:18</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41182714"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41182395">
          <h3>
            <a
              class="item"
              href="http://www.numberworld.org/blogs/2024_8_7_zen5_avx512_teardown/"
              >Zen5's AVX512 Teardown and More</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 15:28:30</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41182395"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41182101">
          <h3>
            <a class="item" href="https://safemap.io/sf/map"
              >Show HN: Play with an interactive heatmap of SF crime (and other
              cities)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 14:56:51</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41182101"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41182055">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41182055"
              >Launch HN: Release (YC W20) – Orchestrate AI Infrastructure and
              Applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 14:50:11</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41182055"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
            <div class="text">
              <a href="https://release.ai/">https://release.ai/</a>). We
              launched on HN in 2020 (<a
                href="https://news.ycombinator.com/item?id=22486031"
                >https://news.ycombinator.com/item?id=22486031</a
              >) after leaving TrueCar, where we managed a 300 person
              development team. Our original focus was making staging
              environments easier with ephemeral environments, but along the way
              AI applications started to emerge as an important and critical
              component of distributed applications. As we talked to customers
              using our original product, we realized we had built the
              underlying platform needed to address the needs of orchestrating
              AI applications and infrastructure. So here we are and we’re
              excited to share Release.ai with HN.
              <p>
                Here’s a video showcasing the platform and demonstrating how to
                easily manage new data and changes using the RAG stack of your
                choice:
                <a href="https://www.youtube.com/watch?v=-OdWRxMX1iA"
                  >https://www.youtube.com/watch?v=-OdWRxMX1iA</a
                >
              </p>
              <p>
                If you want to try release.ai out, we’re offering a sandbox
                account with limited free GPU cycles so you can play around and
                get a feel for Release.ai:
                <a href="https://release.ai">https://release.ai</a>. We suggest
                playing around with some of the RAG AI templates and adding
                custom workflows like in the demo video. The sandbox comes with
                5 free compute hours on an Amazon g5.2xlarge instance (A10 with
                24GB VRAM, 8vCPUs and 32GB). You will also get 16 GB and 4vCPUs
                for cpu workloads such as web servers. You will be able to run
                an inference engine plus things like an api server, etc.
              </p>
              <p>
                After the sandbox expires, you can switch to our free plan,
                which requires a credit card and associating an AWS/GCP account
                with Release to manage the compute in your cloud account. The
                free account provides 100 free managed environment hours a
                month. If you never go over, you never pay us anything. If you
                do, our pricing is here:
                <a href="https://release.com/pricing"
                  >https://release.com/pricing</a
                >.
              </p>
              <p>
                For those that like to read more, here’s the deeper background.
              </p>
              <p>
                It’s clear that open source AI and AI privacy are going to be
                big. Yes, many developers are going to choose SaaS offerings
                like OpenAI to build their AI applications, but as open source
                frameworks and models improve, we’re seeing a shift to open
                source running on cloud. Security and privacy is a top concern
                of companies leveraging these SaaS solutions, which forces them
                to look at running infrastructure themselves. That’s where we
                hope to come in: we’ve built Release.ai so all your data, models
                and infrastructure stay in your cloud account and open source
                frameworks are first class citizens.
              </p>
              <p>
                Orchestration - Integrating AI applications into a software
                development workflow and orchestrating their lifecycle is a new
                and different challenge than traditional web application
                development. Release also makes it possible to manage and
                integrate your web and AI apps using a single application and
                methodology.
              </p>
              <p>
                To make orchestrating AI applications easier, we built a
                workflow engine that can create the complex workflows that AI
                applications require. For example, you can automate the
                redeployment of an AI inference server easily when underlying
                data changes using webhooks and our workflow engine.
              </p>
              <p>
                Cost and expertise - Managing and scaling the hardware required
                to run AI workloads is hard and can be incredibly expensive.
                Release.ai lets you manage GPU compute resources across multiple
                clouds with different instance/node groups for various jobs
                within a single admin interface. We use K8s under the covers to
                pull this off. With over 5 years of building and running K8s
                infrastructure our customers have told us this is how it should
                be done.
              </p>
              <p>
                Getting started with AI frameworks is time consuming and
                requires some pretty in-depth expertise. We built out a library
                of AI templates (<a
                  href="https://docs.release.com/release.ai/release.ai-templates"
                  >https://docs.release.com/release.ai/release.ai-templates</a
                >) using our Application Template format (which is kind of a
                super docker-compose:
                <a
                  href="https://docs.release.com/reference-documentation/application-settings/application-template"
                  >https://docs.release.com/reference-documentation/application...</a
                >) for common open source frameworks to make it easy to get
                started developing AI applications. Setting up and getting these
                frameworks running is a hassle, so we made it one click to
                launch and deploy.
              </p>
              <p>
                We currently have over 20 templates including temples for RAG
                applications, fine tuning and useful tools like Juypter
                notebooks, Promptfoo, etc. We worked closely with Docker and
                Nvidia to support their frameworks: GenAI and Nvidia NEMO/Nims.
                We plan to launch community templates soon after launch. If you
                have suggestions for more templates we should support, please
                let us know in the comments.
              </p>
              <p>
                We’re thrilled to share Release.ai with you and would love to
                get your feedback. We hope you’ll try it out, and please let us
                know what you think!
              </p>
            </div>
          </section>
        </section>
        <section id="41181057">
          <h3>
            <a class="item" href="https://github.com/jank/curiosity"
              >Basic ReAct webapp using FastHTML and LangGraph</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 13:09:54</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41181057"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41180504">
          <h3>
            <a class="item" href="https://roometron.com"
              >Show HN: I've spent nearly 5y on a web app that creates 3D
              apartments</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 12:03:39</span
              ><span class="points-container"
                >Points: <span class="points">333</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41180504"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41180441">
          <h3>
            <a class="item" href="https://www.budgetflow.cc/"
              >Show HN: BudgetFlow – Budget planning using interactive Sankey
              diagrams</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 11:56:02</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41180441"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41176461">
          <h3>
            <a
              class="item"
              href="https://practical.engineering/blog/2024/8/6/how-french-drains-work"
              >How French Drains Work</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 23:07:07</span
              ><span class="points-container"
                >Points: <span class="points">413</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41176461"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41175281">
          <h3>
            <a
              class="item"
              href="https://lithoz.com/en/lithoz-and-glassomer-launch-innovation-partnership-presenting-lithaglass-powered-by-glassomer-a-3d-printable-quartz-glass-for-high-performance-applications/"
              >A 3D-printable quartz glass for high-performance applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 20:56:13</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41175281"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41174890">
          <h3>
            <a
              class="item"
              href="https://www.amusingplanet.com/2016/04/blackhouses-of-scotland.html"
              >Blackhouses of Scotland</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 20:19:58</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41174890"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41173177">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/artanddesign/article/2024/aug/06/superfest-unbreakable-drinking-glasses-east-germany"
              >East Germany invented 'unbreakable' drinking glasses</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-06 @ 17:37:51</span
              ><span class="points-container"
                >Points: <span class="points">325</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41173177"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41157876">
          <h3>
            <a
              class="item"
              href="https://www.xda-developers.com/how-turned-old-phone-nas/"
              >I turned an old phone into a NAS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-05 @ 03:15:44</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41157876"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41147393">
          <h3>
            <a
              class="item"
              href="https://news.ubc.ca/2024/07/ubc-super-black-wood-nxylon/"
              >Nxylon: New super-black material made from wood</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 16:06:24</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41147393"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41144685">
          <h3>
            <a
              class="item"
              href="https://lsd.gnunet.org/lsd0004/draft-schanzen-r5n.html"
              >R5N - Obfuscated mesh routing on hostile networks.</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-03 @ 04:30:27</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41144685"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
