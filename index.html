<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43532009">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43532009"
              >Wondercraft (YC S22) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-31 @ 07:00:19</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Work with the founders &amp; product team to materialize the
                vision into concrete flows and screens that can be implemented
                Work alongside the growth team to build assets and flows to
                increase growth and retention About YOU
              </p>
              <p>We are looking for someone who:</p>
              <p>
                Is excited by the ability to contribute to a variety of areas in
                the company (e.g. product, marketing, etc) Understands and
                incorporates the psychology of end-users into designs Is
                multi-disciplinary, and has experiences across graphic, product,
                web, and UI/UX designs Is a great communicator and a logical
                thinker Isn’t afraid to experiment, fail, and iterate Is ready
                to go at full speed with the team Is proficient in design
                software such as Figma and Photoshop Is ready to join the
                mission of a small team taking on a big industry Is interested
                in AI advancements Has startup experience (huge plus) Has built
                something like this for a startup like ours (huge plus) What’s
                in it for you?
              </p>
              <p>
                At Wondercraft, everyone wins. We believe in creating
                positive-sum outcomes in all interactions we have, internally
                and externally. At Wondercraft, you have the chance to really
                make a difference by getting your hands dirty and building
                something rapidly. We believe in building magic at lightning
                speed. We’ve been proud to ship quality features every single
                week, and we intend to only increase this pace even further. At
                Wondercraft, you have the chance to grow. Working in a small
                team means you are working directly with the Founders.
                Regardless of your career aspirations, you would have so much to
                learn from Wondercraft. Wondercraft is one of the fastest
                growing AI companies, especially in the Text-to-Speech space and
                will soon be raising a Series A round. Joining now gives you the
                opportunity to get equity at a very meaningful value. Plus some
                on-the-job benefits:
              </p>
              <p>
                Salary range $40k - $100k depending on how much you have to
                bring to the table. We are keen to compensate for the value you
                create! Private health insurance so that we can take care of
                your physical health. Hybrid working. We would prefer to all
                work together in our office in central London because we believe
                face-to-face contact time is essential for us growing together a
                team. That said, we don’t mind if you work from home one or two
                days a week.
              </p>
            </div>
          </section>
        </section>
        <section id="43531415">
          <h3>
            <a class="item" href="https://www.marutan.net/rpcemu/index.php"
              >RPCEmu is an emulator of classic Acorn computer systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-31 @ 05:28:03</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43531415"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43531013">
          <h3>
            <a
              class="item"
              href="https://www.postandcourier.com/news/special_reports/marine-fighter-jet-eject-north-charleston/article_80d55e4a-f600-11ef-8ef4-03f14319ce57.html"
              >A decision to eject from a failing F-35B fighter and the betrayal
              in its wake</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-31 @ 04:25:51</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43531013"
                  >Comments</a
                ><span class="descendants">: 113</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43530889">
          <h3>
            <a class="item" href="https://github.com/oerg866/win98-quickinstall"
              >Win98-quickinstall: A framework and installer to quickly install
              Windows 98</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-31 @ 04:10:45</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43530889"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43530863">
          <h3>
            <a
              class="item"
              href="https://www.laphamsquarterly.org/roundtable/laphams-quarterly-announces-new-stewardship"
              >Lapham's Quarterly Announces New Stewardship</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-31 @ 04:07:41</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43530863"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43530675">
          <h3>
            <a
              class="item"
              href="https://www.latimes.com/entertainment-arts/business/story/2025-03-17/joker-matrix-studio-village-roadshow-files-for-chapter-11-bankruptcy"
              >Village Roadshow Entertainment has filed for Chapter 11
              bankruptcy protection</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-31 @ 03:40:40</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43530675"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43529709">
          <h3>
            <a
              class="item"
              href="https://www.cam.ac.uk/stories/merlin-manuscript-discovered-cambridge"
              >Fragments of a rare Merlin manuscript from c. 1300</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-31 @ 01:27:09</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43529709"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43529257">
          <h3>
            <a
              class="item"
              href="https://www.vox.com/2020/1/8/21051869/indoor-air-pollution-student-achievement"
              >Installing air filters in classrooms has surprisingly large
              educational benefits (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-31 @ 00:22:40</span
              ><span class="points-container"
                >Points: <span class="points">217</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43529257"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43529163">
          <h3>
            <a class="item" href="https://breezewiki.com/"
              >BreezeWiki makes wiki pages on Fandom readable</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-31 @ 00:07:54</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43529163"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43529104">
          <h3><a class="item" href="https://oka.wiki/">Oka.wiki</a></h3>
          <section>
            <h4>
              <span>2025-03-30 @ 23:59:23</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43529104"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43527521">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/pmarks-net/af40dba69272806c1ec9cbe71429d2e7"
              >Xfinity XB3 hardware mod: Disable WiFi and save 2 watts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 20:52:39</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43527521"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43527452">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43527452"
              >Ask HN: What are you working on? (March 2025)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 20:43:15</span
              ><span class="points-container"
                >Points: <span class="points">208</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43527452"
                  >Comments</a
                ><span class="descendants">: 496</span></span
              >
            </h4>
            <div class="text">
              What are you working on? Any new ideas that you're thinking about?
            </div>
          </section>
        </section>
        <section id="43527044">
          <h3>
            <a
              class="item"
              href="https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql/"
              >Public secrets exposure leads to supply chain attack on GitHub
              CodeQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 19:54:46</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43527044"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43527001">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/security/2025/03/computer-scientist-goes-silent-after-fbi-raid-and-purging-from-university-website/"
              >FBI raids home of prominent computer scientist who has gone
              incommunicado</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 19:50:10</span
              ><span class="points-container"
                >Points: <span class="points">827</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43527001"
                  >Comments</a
                ><span class="descendants">: 335</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43526763">
          <h3>
            <a
              class="item"
              href="https://nostarch.com/introduction-system-programming-linux"
              >Introduction to System Programming in Linux (Early Access)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 19:22:36</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43526763"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43526621">
          <h3>
            <a
              class="item"
              href="https://dl.acm.org/doi/pdf/10.1145/3341301.3359656"
              >File Systems Unfit as Distributed Storage Back Ends (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 19:03:42</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43526621"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43526396">
          <h3>
            <a class="item" href="https://www.asimov.press/p/nobel-duel"
              >The Nobel Duel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 18:35:03</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43526396"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43524937">
          <h3>
            <a class="item" href="https://github.com/winblues/blue95"
              >Blue95: a desktop for your childhood home's computer room</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 15:30:22</span
              ><span class="points-container"
                >Points: <span class="points">473</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43524937"
                  >Comments</a
                ><span class="descendants">: 243</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43523765">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/travel/2025/03/28/air-france-lost-cellphone/"
              >Why a plane turned around when a passenger lost a phone
              midflight</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 12:50:45</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43523765"
                  >Comments</a
                ><span class="descendants">: 161</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43523741">
          <h3>
            <a
              class="item"
              href="https://unlinkedlist.org/2023/03/19/tail-call-recursion-in-java-with-asm/"
              >Tail Call Recursion in Java with ASM (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 12:47:07</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43523741"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43522966">
          <h3>
            <a
              class="item"
              href="https://hilariusbookbinder.substack.com/p/the-average-college-student-today"
              >The average college student today</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 10:20:11</span
              ><span class="points-container"
                >Points: <span class="points">527</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43522966"
                  >Comments</a
                ><span class="descendants">: 631</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43520796">
          <h3>
            <a class="item" href="https://www.noemamag.com/the-dingos-fate/"
              >The Dingo's Fate</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-30 @ 02:45:12</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43520796"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43514969">
          <h3>
            <a class="item" href="https://paulgraham.com/do.html">What to Do</a>
          </h3>
          <section>
            <h4>
              <span>2025-03-29 @ 12:24:16</span
              ><span class="points-container"
                >Points: <span class="points">232</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43514969"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43508817">
          <h3>
            <a
              class="item"
              href="https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-025-02190-2"
              >A cretaceous fly trap? Remarkable abdominal modification in a
              fossil wasp</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-28 @ 18:55:00</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43508817"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43505420">
          <h3>
            <a class="item" href="https://ironarray.io/blog/compute-bigger"
              >Compress Better, Compute Bigger</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-28 @ 13:50:36</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43505420"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43504514">
          <h3>
            <a class="item" href="https://tf230.matteason.co.uk/"
              >Claim for a missing tooth</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-28 @ 12:25:00</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43504514"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43502348">
          <h3>
            <a
              class="item"
              href="https://sergeyteplyakov.github.io/Blog/2025/03/27/Finalizers_are_tricker_than_you_might_think_p2.html"
              >Finalizers are tricker than you might think. Part 2</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-28 @ 06:58:00</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43502348"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43502124">
          <h3>
            <a class="item" href="https://pubs.usgs.gov/publication/pp1707"
              >Orphan tsunami of 1700–Japanese clues to a parent earthquake in
              America (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-28 @ 06:23:06</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43502124"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43498861">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/books/2025/mar/19/george-orwell-me-richard-blair-life-with-extraordinary-father"
              >George Orwell and me: Richard Blair on life with his
              extraordinary father</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-27 @ 22:21:20</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43498861"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43498399">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-03-digital-cuneiforms-tool-access-ancient.html"
              >Digital cuneiforms: Updated tool expands access to ancient
              Hittite texts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-27 @ 21:28:33</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43498399"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
