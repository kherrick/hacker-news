<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44290413">
          <h3>
            <a
              class="item"
              href="https://www.chemistryworld.com/opinion/benzene-at-200/4021504.article"
              >Benzene at 200</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 15:16:47</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44290413"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44290315">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2506.11016"
              >ZjsComponent: A Pragmatic Approach to Reusable UI Fragments for
              Web Development</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 15:07:42</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44290315"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44290121">
          <h3>
            <a class="item" href="https://diskuv.com/dk/help/latest/"
              >Show HN: dk – A script runner and cross-compiler, written in
              OCaml</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 14:49:34</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44290121"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>
                My testing ground has been students with one or two AP CS
                courses (high school computer science in the US), some of whom
                interned with me. I had to tackle a few problems:
              </p>
              <p>
                - The development environment had to be simple to setup and the
                programming language couldn't be complicated - The recognition
                that writing small, easily testable units of work (ex.
                "scripts") has been the only way I've found for very junior
                programmers to develop a large application - Cheap, locked-down
                development hardware (ex. school computers with limited RAM and
                no Administrator privileges) is sometimes used for deployment to
                cheap hardware targets (ex. hand-me-down Android tablets)
              </p>
              <p>
                My solution was to write a standalone binary called `dk` that
                uses scripts as the atom of work, cross-compiles to standalone
                executables, and downloads the runtimes and sysroots it needs
                on-demand. It sits roughly in the same space as Python and Go.
              </p>
              <p>
                `dk` is available for Windows, macOS and Linux/glibc host
                machines with a growing list of cross-compilation targets. Your
                `dk` scripts are written in an almost complete subset of OCaml
                4: all `dk` scripts are OCaml, but not all OCaml code can run in
                `dk`. The other differences from conventional OCaml are that
                `dk` comes with a large library included, and that I treat any
                feature as buggy if the feature does not work on all supported
                OS-es.
              </p>
              <p>
                The above origin of `dk` is admittedly odd (and abbreviated), so
                I was not expecting that `dk` would now be a general-purpose
                scripting tool. Yet it is. I can wrap, re-use and organize most
                of my hand-written software as a set of `dk` scripts.
              </p>
              <p>
                Fair warning: The cross-compilation support in `dk` has had a
                recent overhaul and not every bug is closed. The error messages
                suck (you have to scroll up to see the root cause and
                resolution) but they will improve. Some progress bars are
                missing. There are also a few experimental features ...
                `uv`-style imports and an interactive interpreter are the big
                ones ... which are purposely under-documented because I am
                worried about `dk`'s API surface.
              </p>
              <p>
                But it still works well, and you can see some real applications
                in the Examples section. I'd love if you could give it a kick in
                the tires and give `dk` some feedback! The issue list is at
                &lt;<a href="https://github.com/diskuv/dk/issues"
                  >https://github.com/diskuv/dk/issues</a
                >&gt;.
              </p>
            </div>
          </section>
        </section>
        <section id="44289705">
          <h3>
            <a
              class="item"
              href="https://personal.math.ubc.ca/~cass/graphics/text/www/"
              >Mathematical Illustrations: A Manual of Geometry and
              PostScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 14:14:54</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44289705"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44289554">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2025/06/16/salesforce_llm_agents_benchmark/"
              >Salesforce study finds LLM agents flunk CRM and confidentiality
              tests</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 13:59:18</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44289554"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44288937">
          <h3>
            <a
              class="item"
              href="https://turso.tech/blog/working-on-databases-from-prison"
              >Working on databases from prison</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 12:32:02</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44288937"
                  >Comments</a
                ><span class="descendants">: 201</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44288748">
          <h3>
            <a class="item" href="https://infracost.io/join-the-team"
              >Infracost (YC W21) is hiring software engineers (GMT+2 to
              GMT-6)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 12:00:18</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44288643">
          <h3>
            <a class="item" href="https://github.com/bperel/socket-call"
              >Show HN: Socket-call – Call socket.io events like normal
              JavaScript functions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 11:40:54</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44288643"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built a Typescript library (named socket-call, for lack of a
                more sexy name) whose goal is to be able to call socket.io
                events as regular functions.
              </p>
              <p>So you declare your server-side like so:</p>
              <p></p>
              <pre><code>  ...
  const listenEvents = (services: UserServices) =&gt; ({
    // Add your events here, the name of the event is the name of the function
    login: async (username: string) =&gt; {
      services._socket.data.user = { username };
      console.log(`User ${username} logged in`);
      setInterval(() =&gt; {
        // Calling an event that's handled client-side
        services.showServerMessage(`You're still logged in ${username}!`)
      }, 1000);
      return `You are now logged in ${username}!`;
    },
  });
</code></pre>
              and then on the client side you call them like normal async
              Javascript functions (and you can also create client-side event
              handlers):
              <p></p>
              <pre><code>  ...
  const user = socket.addNamespace&lt;UserEmitEvents, UserListenEvents&gt;(
    '/user'
  );
  
  // Calling an event that's declared server-side
  user.login(username.value).then((message) =&gt; {
    console.log('Server acked with', message);
  });
  
  // Handling an event that is sent by the server
  user.showServerMessage = (message) =&gt; {
    console.log('Server sent us the message', message);
  }

</code></pre>
              I use this library for my own projects and would be interested to
              receive feedback about it :-)
            </div>
          </section>
        </section>
        <section id="44288051">
          <h3>
            <a
              class="item"
              href="https://www.openculture.com/2025/06/how-the-bic-cristal-ballpoint-pen-became-the-most-successful-product-in-history.html"
              >How the BIC Cristal ballpoint pen became ubiquitous</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 10:06:51</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44288051"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44287395">
          <h3>
            <a class="item" href="https://bowshock.nl/irc/"
              >Start your own Internet Resiliency Club</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 07:38:17</span
              ><span class="points-container"
                >Points: <span class="points">375</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44287395"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44287043">
          <h3>
            <a
              class="item"
              href="https://huggingface.co/nanonets/Nanonets-OCR-s"
              >Nanonets-OCR-s – OCR model that transforms documents into
              structured markdown</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 06:14:56</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44287043"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44285874">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/is-gravity-just-entropy-rising-long-shot-idea-gets-another-look-20250613/"
              >Is gravity just entropy rising? Long-shot idea gets another
              look</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 00:36:41</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44285874"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44285781">
          <h3>
            <a
              class="item"
              href="https://voxelmanip.se/2025/06/14/jokes-and-humour-in-the-public-android-api/"
              >Jokes and Humour in the Public Android API</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-16 @ 00:14:55</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44285781"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44285440">
          <h3>
            <a
              class="item"
              href="https://www.darpa.mil/news/2025/darpa-program-distance-record-power-beaming"
              >DARPA program sets distance record for power beaming</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 22:40:40</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44285440"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44285392">
          <h3>
            <a
              class="item"
              href="https://news.kaist.ac.kr/newsen/html/news/?mode=V&amp;mng_no=47450"
              >Real-time CO2 monitoring without batteries or external power</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 22:29:34</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44285392"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44284871">
          <h3>
            <a class="item" href="https://github.com/rorosen/zeekstd"
              >Show HN: Zeekstd – Rust Implementation of the ZSTD Seekable
              Format</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 20:49:18</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44284871"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                I would like to share a Rust implementation of the Zstandard
                seekable format I've been working on.
              </p>
              <p>
                Regular zstd compressed files consist of a single frame, meaning
                you have to start decompression at the beginning. The seekable
                format splits compressed data into a series of independent
                frames, each compressed individually, so that decompression of a
                section in the middle of an archive only requires zstd to
                decompress at most a frame's worth of extra data, instead of the
                entire archive.
              </p>
              <p>
                I started working with the seekable format because I wanted to
                resume downloads of big zstd compressed files that are
                decompressed and written to disk on the fly. At first I created
                and used bindings to the C functions that are available
                upstream[1], however, I stumbled over the first segfault rather
                quickly (it's now fixed) and found out that the functions only
                allow basic things. After looking closer at the upstream
                implementation, I noticed that is uses functions of the core API
                that are now deprecated and it doesn't allow access to low-level
                (de)compression contexts. To me it looks like a PoC/demo
                implementation that isn't maintained the same way as the zstd
                core API, probably that's also the reason it's in the contrib
                directory.
              </p>
              <p>
                My use-case seemed to require a complete rewrite of the seekable
                format, so I decided to implement it from scratch in Rust using
                bindings to the advanced zstd compression API, available from
                zstd 1.4.0.
              </p>
              <p>
                The result is a single dependency library crate[2], and a CLI
                crate[3] for the seekable format that feels similar to the
                regular zstd tool.
              </p>
              <p>Any feedback is highly appreciated!</p>
              <p>
                [1]:
                <a
                  href="https://github.com/facebook/zstd/tree/dev/contrib/seekable_format"
                  >https://github.com/facebook/zstd/tree/dev/contrib/seekable_f...</a
                >
                [2]:
                <a href="https://crates.io/crates/zeekstd"
                  >https://crates.io/crates/zeekstd</a
                >
                [3]:
                <a href="https://github.com/rorosen/zeekstd/tree/main/cli"
                  >https://github.com/rorosen/zeekstd/tree/main/cli</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44284657">
          <h3>
            <a class="item" href="https://github.com/cosmos72/twin"
              >Twin – A Textmode WINdow Environment</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 20:07:27</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44284657"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44283614">
          <h3>
            <a
              class="item"
              href="https://blog.kowalczyk.info/a-stsj/simplest-c-callback-from-sumatrapdf.html"
              >Simplest C++ Callback, from SumatraPDF</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 17:26:38</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44283614"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44282998">
          <h3>
            <a
              class="item"
              href="https://www.downtowndougbrown.com/2025/06/modifying-an-hdmi-dummy-plugs-edid-using-a-raspberry-pi/"
              >Modifying an HDMI dummy plug's EDID using a Raspberry Pi</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 16:00:43</span
              ><span class="points-container"
                >Points: <span class="points">265</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44282998"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44282378">
          <h3>
            <a
              class="item"
              href="https://tim.dierks.org/2014/05/security-standards-and-name-changes-in.html"
              >Why SSL was renamed to TLS in late 90s (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 14:10:37</span
              ><span class="points-container"
                >Points: <span class="points">417</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44282378"
                  >Comments</a
                ><span class="descendants">: 195</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44282143">
          <h3>
            <a
              class="item"
              href="https://ourworldindata.org/childhood-leukemia-treatment-history"
              >Childhood leukemia: how a deadly cancer became treatable</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 13:12:42</span
              ><span class="points-container"
                >Points: <span class="points">248</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44282143"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44281727">
          <h3>
            <a
              class="item"
              href="https://github.com/frankmcsherry/blog/blob/master/posts/2025-06-03.md"
              >Datalog in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-15 @ 11:18:40</span
              ><span class="points-container"
                >Points: <span class="points">309</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44281727"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44275900">
          <h3>
            <a class="item" href="https://pitr.ca/2025-06-14-queens"
              >Solving LinkedIn Queens with APL</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-14 @ 12:09:51</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44275900"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44275737">
          <h3>
            <a
              class="item"
              href="https://paperclipmaximizer.ai/Unaware_Adversaries.pdf"
              >A Framework for Characterizing Emergent Conflict Between
              Non-Coordinating Agents [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-14 @ 11:36:01</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44275737"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44275471">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41557-025-01815-x"
              >Chemical knowledge and reasoning of large language models vs.
              chemist expertise</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-14 @ 10:22:06</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44275471"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44275134">
          <h3>
            <a
              class="item"
              href="https://www.mexicolore.co.uk/maya/home/maya-blue-unlocking-the-mysteries-of-an-ancient-pigment"
              >Maya Blue: Unlocking the Mysteries of an Ancient Pigment</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-14 @ 08:48:25</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44275134"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44275063">
          <h3>
            <a
              class="item"
              href="https://smr.unl.edu/papers/Krings_et_al-2025-ICRA.pdf"
              >Mechanisms for Detection and Repair of Puncture Damage in Soft
              Robotics [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-14 @ 08:29:15</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44275063"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44275014">
          <h3>
            <a
              class="item"
              href="https://www.vidarholen.net/contents/wordcount/#fuck*,shit*,damn*,idiot*,retard*,crap*"
              >Occurences of swearing in the Linux kernel source code over
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-14 @ 08:15:31</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44275014"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44261118">
          <h3>
            <a
              class="item"
              href="https://www.psu.edu/news/research/story/worlds-first-2d-non-silicon-computer-developed"
              >First 2D, non-silicon computer developed</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-12 @ 18:26:43</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44261118"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44259238">
          <h3>
            <a
              class="item"
              href="https://github.com/rubenwiersma/painting_tools"
              >Hyperspectral scans of historical pigments and painting
              reconstructions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-12 @ 16:00:19</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44259238"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
