<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44533004">
          <h3>
            <a class="item" href="https://github.com/BloopAI/vibe-kanban"
              >Show HN: Vibe Kanban – Kanban board to manage your AI coding
              agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 15:08:52</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44533004"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44532913">
          <h3>
            <a
              class="item"
              href="https://www.carolinecrampton.com/im-done-with-social-media/"
              >I'm Done with Social Media</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 15:00:36</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44532913"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44532306">
          <h3>
            <a
              class="item"
              href="https://www.jeffgeerling.com/blog/2025/upgrading-m4-pro-mac-minis-storage-half-price"
              >Upgrading an M4 Pro Mac mini's storage for half the price</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 14:06:07</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44532306"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44531764">
          <h3>
            <a
              class="item"
              href="https://www.lesswrong.com/posts/CCuJotfcaoXf8FYcy/some-arguments-against-a-land-value-tax"
              >Some arguments against a land value tax (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 13:14:21</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44531764"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44531707">
          <h3>
            <a class="item" href="https://craigmod.com/ridgeline/210/"
              >Overtourism in Japan, and how it hurts small businesses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 13:07:03</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44531707"
                  >Comments</a
                ><span class="descendants">: 135</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44531697">
          <h3>
            <a
              class="item"
              href="https://ddkang.substack.com/p/ai-agent-benchmarks-are-broken"
              >AI Agent Benchmarks Are Broken</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 13:06:32</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44531697"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44531635">
          <h3>
            <a class="item" href="https://leerob.com/vercel"
              >Things I learned from 5 years at Vercel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 13:00:41</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44531635"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44531120">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/07/10/world/europe/uk-post-office-scandal-report.html"
              >At Least 13 People Died by Suicide Amid U.K. Post Office Scandal,
              Report Says</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 11:56:19</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44531120"
                  >Comments</a
                ><span class="descendants">: 234</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44530922">
          <h3>
            <a
              class="item"
              href="https://internetaddictsanonymous.org/internet-and-technology-addiction/signs-of-an-addiction-to-ai/"
              >Recovering from AI Addiction</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 11:28:11</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44530922"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44530767">
          <h3>
            <a
              class="item"
              href="https://patternproject.substack.com/p/from-the-mac-to-the-mystical-bill"
              >Bill Atkinson's Psychedelic User Interface</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 11:03:59</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44530767"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44530581">
          <h3>
            <a
              class="item"
              href="https://twitter.com/cis_female/status/1943069934332055912"
              >FP8 is ~100 tflops faster when the kernel name has "cutlass" in
              it</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 10:36:26</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44530581"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44530375">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/06/24/technology/amazon-ai-data-centers.html"
              >At Amazon's biggest data center, everything is supersized for
              AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 10:03:11</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44530375"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44529061">
          <h3>
            <a
              class="item"
              href="https://formularsumo.co.uk/blog/2025/apple-vs-the-law/"
              >Apple vs the Law</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 06:49:12</span
              ><span class="points-container"
                >Points: <span class="points">308</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44529061"
                  >Comments</a
                ><span class="descendants">: 275</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44528943">
          <h3>
            <a class="item" href="https://openfront.io/"
              >OpenFront: Realtime Risk-like multiplayer game in the browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 06:27:19</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44528943"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44527947">
          <h3>
            <a class="item" href="https://bentoml.com/llm/"
              >LLM Inference Handbook</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 02:40:32</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44527947"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44527190">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/Jul/11/grok-musk/"
              >Grok: Searching X for "From:Elonmusk (Israel or Palestine or
              Hamas or Gaza)"</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-11 @ 00:22:43</span
              ><span class="points-container"
                >Points: <span class="points">591</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44527190"
                  >Comments</a
                ><span class="descendants">: 434</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44526015">
          <h3>
            <a class="item" href="https://github.com/fosrl/pangolin"
              >Show HN: Pangolin – Open source alternative to Cloudflare
              Tunnels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-10 @ 21:50:43</span
              ><span class="points-container"
                >Points: <span class="points">359</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44526015"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
            <div class="text">
              <p>
                We made Pangolin so you retain full control over your
                infrastructure while providing a user-friendly and feature-rich
                solution for managing proxies, authentication, and access, all
                with a clean and simple dashboard web UI.
              </p>
              <p>
                GitHub:
                <a href="https://github.com/fosrl/pangolin"
                  >https://github.com/fosrl/pangolin</a
                >
              </p>
              <p>
                Deployment takes about 5 minutes on a VPS:
                <a
                  href="https://docs.fossorial.io/Getting%20Started/quick-install"
                  >https://docs.fossorial.io/Getting%20Started/quick-install</a
                >
              </p>
              <p>
                Demo by Lawrence Systems (YouTube):
                <a
                  href="https://youtu.be/g5qOpxhhS7M?si=M1XTWLGLUZW0WzTv&amp;t=723"
                  >https://youtu.be/g5qOpxhhS7M?si=M1XTWLGLUZW0WzTv&amp;t=723</a
                >
              </p>
              <p>Some use cases:</p>
              <p></p>
              <pre><code>  - Grant users access to your apps from anywhere using just a web-browser

  - Proxy behind CGNAT

  - One application load balancer across multiple clouds and on-premises

  - Easily expose services on IoT and edge devices for field monitoring

  - Bring localhost online for easy access
</code></pre>
              A few key features:
              <p></p>
              <pre><code>  - No port forwarding and hide your public IP for self-hosting

  - Create proxies to multiple different private networks

  - OAuth2/OIDC identity providers

  - Role-based access control

  - Raw TCP and UDP support

  - Resource-specific pin codes, passwords, email OTP

  - Self-destructing shareable links

  - API for automation

  - WAF with CrowdSec and Geoblocking</code></pre>
            </div>
          </section>
        </section>
        <section id="44524544">
          <h3>
            <a class="item" href="https://github.com/cactus-compute/cactus"
              >Show HN: Cactus – Ollama for Smartphones</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-10 @ 19:20:59</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44524544"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
            <div class="text">
              <p>
                Ollama enables deploying LLMs models locally on laptops and edge
                severs, Cactus enables deploying on phones. Deploying directly
                on phones facilitates building AI apps and agents capable of
                phone use without breaking privacy, supports real-time inference
                with no latency, we have seen personalised RAG pipelines for
                users and more.
              </p>
              <p>
                Apple and Google actively went into local AI models recently
                with the launch of Apple Foundation Frameworks and Google AI
                Edge respectively. However, both are platform-specific and only
                support specific models from the company. To this end, Cactus:
              </p>
              <p>
                - Is available in Flutter, React-Native &amp; Kotlin
                Multi-platform for cross-platform developers, since most apps
                are built with these today.
              </p>
              <p>
                - Supports any GGUF model you can find on Huggingface; Qwen,
                Gemma, Llama, DeepSeek, Phi, Mistral, SmolLM, SmolVLM,
                InternVLM, Jan Nano etc.
              </p>
              <p>
                - Accommodates from FP32 to as low as 2-bit quantized models,
                for better efficiency and less device strain.
              </p>
              <p>
                - Have MCP tool-calls to make them performant, truly helpful
                (set reminder, gallery search, reply messages) and more.
              </p>
              <p>
                - Fallback to big cloud models for complex, constrained or
                large-context tasks, ensuring robustness and high availability.
              </p>
              <p>
                It's completely open source. Would love to have more people try
                it out and tell us how to make it great!
              </p>
              <p>
                Repo:
                <a href="https://github.com/cactus-compute/cactus"
                  >https://github.com/cactus-compute/cactus</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44522505">
          <h3>
            <a class="item" href="https://graphicallinearalgebra.net/"
              >Graphical Linear Algebra</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-10 @ 16:02:40</span
              ><span class="points-container"
                >Points: <span class="points">283</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44522505"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44522076">
          <h3>
            <a
              class="item"
              href="https://dynamicland.org/2024/FAQ/#What_is_Realtalks_relationship_to_AI"
              >What is Realtalk’s relationship to AI? (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-10 @ 15:25:56</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44522076"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44521871">
          <h3>
            <a class="item" href="https://stylepedia.net/style/"
              >Red Hat Technical Writing Style Guide</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-10 @ 15:01:42</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44521871"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44521457">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/tidal-energy-turbine-marine-meygen-scotland-ffff3a7082205b33b612a1417e1ec6d6"
              >Underwater turbine spinning for 6 years off Scotland's coast is a
              breakthrough</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-10 @ 14:23:46</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44521457"
                  >Comments</a
                ><span class="descendants">: 202</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44521224">
          <h3>
            <a class="item" href="https://flix.dev/"
              >Flix – A powerful effect-oriented programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-10 @ 14:02:04</span
              ><span class="points-container"
                >Points: <span class="points">313</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44521224"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44520419">
          <h3>
            <a class="item" href="https://foks.pub/"
              >FOKS: Federated Open Key Service</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-10 @ 12:49:21</span
              ><span class="points-container"
                >Points: <span class="points">268</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44520419"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44508601">
          <h3>
            <a
              class="item"
              href="https://lwn.net/ml/all/cover.1747070147.git.anand.jain@oracle.com/"
              >Btrfs Allocator Hints</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-09 @ 11:17:26</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44508601"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44507078">
          <h3>
            <a class="item" href="https://evertpot.com/http/"
              >Series of posts on HTTP status codes (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-09 @ 07:05:17</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44507078"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44492014">
          <h3>
            <a
              class="item"
              href="https://developers.googleblog.com/en/scale-your-ai-workloads-batch-mode-gemini-api/"
              >Batch Mode in the Gemini API: Process More for Less</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 16:30:18</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44492014"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44491709">
          <h3>
            <a class="item" href="https://pico2.pinout.xyz"
              >Show HN: Interactive pinout for the Raspberry Pi Pico 2</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 16:01:13</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44491709"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
            <div class="text">
              <p>
                Recently I've updated these with a new "Upside-down" view to
                complement the rear view, giving a pinout in the right
                orientation to match your project.
              </p>
              <p>
                The Pico sites are all hand-coded single HTML pages with
                supporting CSS and minimal JS. They are set up to optionally
                install as a "Desktop" web app. They also degrade into a
                somewhat usable table in lieu of CSS and use vector graphics
                (for the board itself) to be viewable and printable at any size.
              </p>
              <p>
                Finally, hidden behind "Advanced" is a pinout of the test pads
                and special function pins!
              </p>
              <p>
                [1] -
                <a
                  href="https://web.archive.org/web/20130505194305/pi.gadgetoid.com/pinout"
                  >https://web.archive.org/web/20130505194305/pi.gadgetoid.com/...</a
                >
                [2] -
                <a href="https://pico.pinout.xyz">https://pico.pinout.xyz</a>
                [3] -
                <a href="https://pico2.pinout.xyz">https://pico2.pinout.xyz</a>
              </p>
            </div>
          </section>
        </section>
        <section id="44490510">
          <h3>
            <a
              class="item"
              href="https://www.recall.ai/blog/postgres-listen-notify-does-not-scale"
              >Postgres LISTEN/NOTIFY does not scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 14:05:06</span
              ><span class="points-container"
                >Points: <span class="points">511</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44490510"
                  >Comments</a
                ><span class="descendants">: 247</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44490308">
          <h3>
            <a
              class="item"
              href="https://www.core77.com/posts/137602/The-ChompSaw-A-Benchtop-Power-Tool-Thats-Safe-for-Kids-to-Use"
              >The ChompSaw: A Benchtop Power Tool That's Safe for Kids to
              Use</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-07 @ 13:43:22</span
              ><span class="points-container"
                >Points: <span class="points">235</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44490308"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
