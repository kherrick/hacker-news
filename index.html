<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44869323">
          <h3>
            <a
              class="item"
              href="https://twitter.com/KeithSakata/status/1954884361695719474"
              >I've seen 12 people hospitalized after losing touch with reality
              because of AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 20:50:13</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44869323"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44867374">
          <h3>
            <a class="item" href="https://planetscale.com/blog/announcing-neki"
              >Neki – sharded Postgres by the team behind Vitess</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 18:03:57</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44867374"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44867238">
          <h3>
            <a class="item" href="https://github.com/ollama/ollama/issues/11714"
              >Ollama and gguf</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 17:54:08</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44867238"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44866894">
          <h3>
            <a
              class="item"
              href="https://dankennedy.net/2025/08/08/the-associated-press-tells-its-book-critics-that-its-ending-weekly-reviews/"
              >AP to end its weekly book reviews</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 17:25:57</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44866894"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44866677">
          <h3>
            <a
              class="item"
              href="https://opensource.googleblog.com/2025/08/whats-new-in-iceberg-v3.html"
              >Apache Iceberg V3 Spec new features for more efficient and
              flexible data lakes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 17:07:34</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44866677"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44866621">
          <h3>
            <a
              class="item"
              href="https://www.sas.upenn.edu/~jesusfv/Slides_London.pdf"
              >The demographic future of humanity: facts and consequences
              [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 17:03:33</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44866621"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44866587">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/trellis/jobs/Cv3ZwXh-forward-deployed-engineers-all-levels-august-2025"
              >Trellis (YC W24) Is Hiring: Automate Prior Auth in Healthcare</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 17:00:04</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44866500">
          <h3>
            <a
              class="item"
              href="https://timharford.com/2025/05/the-value-of-institutional-memory/"
              >The Value of Institutional Memory</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 16:53:43</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44866500"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44866208">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cjr11qqvvwlo"
              >Wikipedia loses challenge against Online Safety Act</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 16:33:26</span
              ><span class="points-container"
                >Points: <span class="points">327</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44866208"
                  >Comments</a
                ><span class="descendants">: 345</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44865997">
          <h3>
            <a
              class="item"
              href="https://deanebarker.net/tech/blog/custom-elements-markdown/"
              >The Joy of Mixing Custom Elements, Web Components, and
              Markdown</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 16:16:56</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44865997"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44865916">
          <h3>
            <a
              class="item"
              href="https://www.joshbeckman.org/blog/practicing/ui-vs-api-vs-uai"
              >UI vs. API. vs. UAI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 16:11:50</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44865916"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44865834">
          <h3>
            <a
              class="item"
              href="https://opuslabs.substack.com/p/learn-reflect-apply-prepare"
              >Learn, Reflect, Apply, Prepare: The Four Daily Practices That
              Changed How I Live</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 16:06:04</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44865834"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44865560">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/news/757461/microsoft-github-thomas-dohmke-resignation-coreai-team-transition"
              >GitHub is no longer independent at Microsoft after CEO
              resignation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 15:47:48</span
              ><span class="points-container"
                >Points: <span class="points">798</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44865560"
                  >Comments</a
                ><span class="descendants">: 568</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44865290">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44865290"
              >Launch HN: Halluminate (YC S25) – Simulating the internet to
              train computer use</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 15:30:49</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44865290"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
            <div class="text">
              <a href="https://halluminate.ai/">https://halluminate.ai/</a>). We
              help AI labs train computer use agents with high quality data and
              RL environments.
              <p>
                Training AI agents to use computers, browsers, and software is
                one of the highest-potential opportunities for AI. To date,
                however, this capability is still unreliable. The emerging
                method to improve this is called Reinforcement Learning with
                Verifiable Rewards (RLVR). However, researchers are currently
                bottlenecked by a lack of high-quality simulators and task +
                verifiers.
              </p>
              <p>
                To solve this problem, we’re building Westworld, a
                fully-simulated internet made up of synthetic versions of the
                most common consumer and enterprise apps. Agents use Westworld
                to learn how to do economically valuable tasks.
              </p>
              <p>
                For example, AI agents can practice planning vacations on a
                simulated flight booking site (<a
                  href="https://flights.halluminate.ai/"
                  >https://flights.halluminate.ai/</a
                >), or learn how to reorganize outdated information in your
                sales platform, or train to do financial modeling directly in a
                spreadsheet.
              </p>
              <p>
                Here’s a demo showing our flight booking simulation:
                <a
                  href="https://www.loom.com/share/74a3b28067e24c1b886054ba90a90aa5"
                  >https://www.loom.com/share/74a3b28067e24c1b886054ba90a90aa5</a
                >.
              </p>
              <p>
                How it works: AI agents access our environment and are given a
                task + verifier. A task is basically an objective for the agent
                to achieve, for example "Book me a flight from SF to NYC on this
                date with x, y, z filters.” A verifier is a programmatic way to
                determine if the task was successfully completed. For example,
                in this case it might be a json that checks if the final flight
                data matches expectations. These signals can then be used to
                calculate a reward in RL.
              </p>
              <p>
                The more simulators we build, the more AI labs can improve on
                capabilities that computer use agents are currently weak at. One
                of our customers saw a ~20% improvement in date-picking
                performance when training on our flight booking simulator.
              </p>
              <p>Two things make this hard so far:</p>
              <p>
                (1) The simulations have to be realistic. You can’t get away
                with a vibe-coded “80% solution” because even small divergences
                impact performance. Generating simulated data is even harder.
                For example, massaging flight data to look realistic took a lot
                of trial and experimentation.
              </p>
              <p>
                (2) The tasks you train agents on have to be well-chosen. They
                are only valuable if they reflect work that people actually want
                solved. We need a lot of feedback from domain experts to get
                this right.
              </p>
              <p>
                That said, we find this work incredibly interesting and are
                excited to tackle these issues. A few things we are pumped to
                ship in the near term: - Ability to train on long-horizon tasks
                by stringing multiple simulators together for extended
                workflows; - Procedural data generation. Instead of
                synthetically generating all the data upfront, how can we model
                data generation so that our simulators are populated
                procedurally as agents explore (think Minecraft); - Open source!
                We plan to release our environments to the public so
                developers/researchers can hack them for their own
                experimentation.
              </p>
              <p>
                RL simulators are just one part of our business. The other part
                is around human data creation (think Scale AI but for computer
                use). We produce off-the-shelf pre-training/fine-tuning
                datasets, expert human evaluation/error analysis, or any other
                data needs for our customers. There are also a lot of exciting
                overlaps between the two - for example, using human experts to
                help create our simulators/tasks. Happy to go in more detail,
                but we thought that simulators would make for the more
                interesting HackerNews post :)
              </p>
              <p>
                Finally, about us: Wyatt and I met while studying CS at Cornell
                and have been living and working together for over 7 years. I
                previously led product/research at Capital One Labs, where I
                launched one of the first AI agents in banking. Wyatt previously
                was a Cornell Milstein scholar and did large-scale data
                engineering for 2 early-stage startups in NYC. We left our jobs
                last year, and faced these problems first-hand while building
                evals for our customers who were browser/computer use agent
                companies.
              </p>
              <p>
                If anyone has any questions, feedback, or thoughts please let us
                know! Looking forward to your comments.
              </p>
            </div>
          </section>
        </section>
        <section id="44864680">
          <h3>
            <a
              class="item"
              href="https://academic.oup.com/mnras/article/541/4/2853/8213862?login=false"
              >36B solar mass black hole at centre of the Cosmic Horseshoe
              gravitational lens</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 14:42:27</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44864680"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44864467">
          <h3>
            <a
              class="item"
              href="https://dafoster.net/articles/2025/07/22/designing-software-in-the-large/"
              >Designing Software in the Large</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 14:25:58</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44864467"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44864185">
          <h3>
            <a
              class="item"
              href="https://dwyer.co.za/static/claude-code-is-all-you-need.html"
              >Claude Code is all you need</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 14:03:46</span
              ><span class="points-container"
                >Points: <span class="points">379</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44864185"
                  >Comments</a
                ><span class="descendants">: 225</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44864134">
          <h3>
            <a class="item" href="https://www.al3rez.com/todo-txt-journey"
              >I tried every todo app and ended up with a .txt file</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 13:59:02</span
              ><span class="points-container"
                >Points: <span class="points">644</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44864134"
                  >Comments</a
                ><span class="descendants">: 428</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44863409">
          <h3>
            <a class="item" href="https://pricingpages.design/"
              >Pricing Pages – A Curated Gallery of Pricing Page Designs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 12:27:08</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44863409"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44863242">
          <h3>
            <a class="item" href="https://www.openssh.com/pq.html"
              >OpenSSH Post-Quantum Cryptography</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 12:01:58</span
              ><span class="points-container"
                >Points: <span class="points">307</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44863242"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44862583">
          <h3>
            <a
              class="item"
              href="https://github.com/ggml-org/llama.cpp/pull/14737"
              >Mistral Integration Improved in Llama.cpp</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 10:10:46</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44862583"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44862414">
          <h3>
            <a class="item" href="https://aarol.dev/posts/zig-simd-substr/"
              >Faster substring search with SIMD in Zig</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 09:41:13</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44862414"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44861106">
          <h3>
            <a class="item" href="https://issues.chromium.org/issues/412578726"
              >The Chrome VRP Panel has decided to award $250k for this
              report</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 05:56:33</span
              ><span class="points-container"
                >Points: <span class="points">472</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44861106"
                  >Comments</a
                ><span class="descendants">: 253</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44860015">
          <h3>
            <a class="item" href="https://mattwie.se/no-sleep-till-agi"
              >Optimizing my sleep around Claude usage limits</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-11 @ 01:32:31</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44860015"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44857643">
          <h3>
            <a
              class="item"
              href="https://bscholl.substack.com/p/move-fast-and-dont-break-safety-critical"
              >How Boom uses software to accelerate hardware development</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-10 @ 19:37:25</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44857643"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44841354">
          <h3>
            <a
              class="item"
              href="https://asimov.blog/a-guide-dog-for-the-face-blind/"
              >A Guide Dog for the Face-Blind</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 20:26:47</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44841354"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44839496">
          <h3>
            <a class="item" href="https://bytebuddy.net/"
              >Byte Buddy is a code generation and manipulation library for
              Java</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 17:25:03</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44839496"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44837949">
          <h3>
            <a
              class="item"
              href="https://kmicinski.com/functional-programming/2025/08/01/loops/"
              >Why tail-recursive functions are loops</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 15:10:54</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44837949"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44834570">
          <h3>
            <a
              class="item"
              href="https://whitemountainski.co/pages/white-mountain-direttissima"
              >White Mountain Direttissima</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-08 @ 07:44:57</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44834570"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44829783">
          <h3>
            <a
              class="item"
              href="https://gitpi.us/article-archive/porting-to-os2/"
              >Porting to OS/2 (1987)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-07 @ 20:14:09</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44829783"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
