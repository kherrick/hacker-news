<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35904320">
          <h3>
            <a class="item" href="https://www.barebones.com/store/"
              >BBEdit is 30 years old</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 16:14:47</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35904320"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35903956">
          <h3>
            <a
              class="item"
              href="https://blog.system76.com/post/may-flowers-spring-cosmic-showers/"
              >May Flowers Spring COSMIC Showers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 15:52:21</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35903956"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35903394">
          <h3>
            <a
              class="item"
              href="https://medium.com/@arunvenkats/automating-the-capture-of-airplane-pictures-with-raspberry-pis-ads-b-and-iot-software-39e25ddcf3ea"
              >Automating the capture of airplane pictures with Raspberry Pi,
              ADS-B, IoT (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 15:16:40</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35903394"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35903294">
          <h3>
            <a
              class="item"
              href="https://badar.tech/2023/04/30/electronics-lab-bench-setup-guide/"
              >Electronics Lab Bench Setup Guide</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 15:09:04</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35903294"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35903267">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2023/may/11/muharrem-ince-turkish-presidential-candidate-withdraws-alleged-sex-tape"
              >Turkish presidential candidate quits race after release of
              alleged sex tape</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 15:07:03</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35903267"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35903188">
          <h3>
            <a
              class="item"
              href="https://www.deusinmachina.net/p/understanding-the-power-of-bitwise"
              >Understanding the power of bitwise operators</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 15:02:04</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35903188"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35902506">
          <h3>
            <a
              class="item"
              href="https://lwn.net/SubscriberLink/930705/4bbe9c26d7884277/"
              >Faster CPython at PyCon, part one</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 14:21:17</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35902506"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35902174">
          <h3>
            <a
              class="item"
              href="https://fungi.com/blogs/articles/place-mushrooms-in-sunlight-to-get-your-vitamin-d"
              >Place mushrooms in sunlight to get your vitamin D (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 13:58:25</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35902174"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35902086">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35902086"
              >Ask HN: Resources for older developers?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 13:51:51</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35902086"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
            <div class="text">
              I am early 50's and still code around half of my day. I do manage
              a small team but my primary love has always been development. I'm
              wondering what resources there are for us senior devs who keep
              coding? My older friends in the field chat when we are able about
              the cyclic nature of tech, coding, managing, mentoring and
              sometimes (unfortunately) strategies for dealing with ageism. But
              the pool of 40+ yr old devs is not huge in my area so I'd like
              access to a online community if anyone has pointers. Thanks!
            </div>
          </section>
        </section>
        <section id="35901889">
          <h3>
            <a
              class="item"
              href="https://www.bristol.ac.uk/news/2023/may/gig-economy-worker-research.html"
              >Majority of gig economy workers are earning below minimum wage:
              research</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 13:40:35</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35901889"
                  >Comments</a
                ><span class="descendants">: 236</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35901881">
          <h3>
            <a
              class="item"
              href="http://eodg.atm.ox.ac.uk/user/dudhia/rowing/physics/basics.html"
              >Basic Physics of Rowing (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 13:40:00</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35901881"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35901538">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2305.04928"
              >A transformer-based method for zero and few-shot biomedical
              NER</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 13:12:37</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35901538"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35900922">
          <h3>
            <a class="item" href="https://onesignal.com/careers"
              >OneSignal (YC S11) Is Hiring Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 12:00:48</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35900891">
          <h3>
            <a class="item" href="https://pharo.org/news/pharo11-released.html"
              >Pharo 11</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 11:56:02</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35900891"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35900635">
          <h3>
            <a
              class="item"
              href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3419012/"
              >Fern leaves and cauliflower curds are not fractals (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 11:24:04</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35900635"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35900282">
          <h3>
            <a
              class="item"
              href="https://fly.io/blog/js-ecosystem-delightfully-wierd/"
              >The JavaScript ecosystem is delightfully weird</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 10:38:43</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35900282"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35899642">
          <h3>
            <a class="item" href="https://www.degreeless.design"
              >Product design and UX design resources – Degreeless.Design</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 09:05:01</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35899642"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35899527">
          <h3>
            <a
              class="item"
              href="https://lore.kernel.org/lkml/20230509165657.1735798-1-kent.overstreet@linux.dev/T/#mf171fd06ffa420fe1bcf0f49a2b44a361ca6ac44"
              >Bcachefs – A New COW Filesystem</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 08:50:26</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35899527"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35897146">
          <h3>
            <a
              class="item"
              href="https://info.computerhistory.org/xerox-parc-archive"
              >The Xerox PARC Archive</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 03:46:55</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35897146"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35896971">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/startups-are-scooping-up-big-techs-cast-off-workers-981f7d35"
              >Startups Are Scooping Up Big Tech’s Cast-Off Workers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 03:26:00</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35896971"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35896190">
          <h3>
            <a
              class="item"
              href="https://twitter.com/paulg/status/1655925905527537666"
              >When you lose the ability to write, you also lose some of your
              ability to think</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 01:39:24</span
              ><span class="points-container"
                >Points: <span class="points">706</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35896190"
                  >Comments</a
                ><span class="descendants">: 421</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35896176">
          <h3>
            <a
              class="item"
              href="https://cloud.google.com/blog/products/maps-platform/create-immersive-3d-map-experiences-photorealistic-3d-tiles"
              >Google Earth 3D Models Now Available as Open Standard (GlTF)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 01:37:16</span
              ><span class="points-container"
                >Points: <span class="points">388</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35896176"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35894199">
          <h3>
            <a
              class="item"
              href="https://academic.oup.com/ahr/article-abstract/128/1/177/7098054"
              >When Hay Was King: Energy History and Economic Nationalism in the
              19th C. USA</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 22:13:12</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35894199"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35893133">
          <h3>
            <a
              class="item"
              href="https://news.ucsc.edu/2023/04/sea-lion-size.html"
              >As the California sea lion population got bigger, so did male sea
              lions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 20:36:17</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35893133"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35890926">
          <h3>
            <a class="item" href="https://zarasophos.net/erasmus/"
              >The Erasmus Network</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 17:57:25</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35890926"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35886334">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/big-pipes-ddos-for-hire-fbi/"
              >A team of sleuths quietly hunting cyberattack-for-hire
              services</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 12:23:51</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35886334"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885982">
          <h3>
            <a class="item" href="https://noidea.dog/#/fires/"
              >The History of Fire Escapes (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 11:32:39</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885982"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885859">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/news/new-philips-monitor-features-an-e-paper-side-panel"
              >New Philips Monitor Features an E-Paper Side Panel</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 11:12:10</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885859"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885696">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2023/05/researchers-craft-a-fully-edible-battery/"
              >Researchers craft a fully edible battery</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 10:42:11</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885696"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35885046">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Protocol_Wars"
              >Protocol Wars</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 08:26:54</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35885046"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
