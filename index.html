<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39094306">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/world-europe-68056421"
              >British man appears in court over bomb joke sent in private
              message</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 19:40:12</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39094306"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39094288">
          <h3>
            <a
              class="item"
              href="https://jacobbartlett.substack.com/p/my-toddler-still-loves-planes-so"
              >My Toddler Still Loves Planes, So I Upgraded Her Radar</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 19:38:55</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39094288"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39094187">
          <h3>
            <a
              class="item"
              href="https://durmonski.com/life-advice/against-normalcy/"
              >Against Normalcy: Why Being Normal Can Be Dangerous</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 19:30:35</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39094187"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39094181">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39094181"
              >Ask HN: Is Apple's R1 a Discrete GPU?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 19:30:21</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39094181"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>The confirmed details of the R1 chip are scant:</p>
              <p>
                - It does a lot of image processing and sensor data integration:
                "the brand-new R1 chip processes input from 12 cameras, five
                sensors, and six microphones to ensure that content feels like
                it is appearing right in front of the user's eyes, in real time.
                R1 streams new images to the displays within 12 milliseconds"[0]
              </p>
              <p>
                - It has substantial memory bandwidth: "256GB/s memory
                bandwidth"[1]
              </p>
              <p>
                - It uses special, high bandwidth memory: "To support R1’s
                high-speed processing, SK hynix has developed the custom
                1-gigabit DRAM. The new DRAM is known to have increased the
                number of input and output pins by eightfold to minimize delays.
                Such chips are also called Low Latency Wide IO. According to
                experts, the new chip also appears to have been designed using a
                special packaging method – Fan-Out Wafer Level Packaging – to be
                attached to the R1 chipset as a single unit […]"[2]
              </p>
              <p>
                - This is subjective, but: Apple shows it as being roughly the
                same size as the M2 processor in the Vision Pro marketing[3],
                indicating it's a peer to the M2. Now, that may mean nothing,
                but based on my experience with Apple kremlinology they are not
                arbitrary about stuff like that.
              </p>
              <p>
                So I see all this and get major GPU vibes. But I'm just some guy
                on a the internet, so what do I know?
              </p>
              <p>
                0:
                https://www.macrumors.com/2023/06/05/apple-reveals-vision-pro-headset/
              </p>
              <p>1: https://www.apple.com/apple-vision-pro/specs/</p>
              <p>2: https://9to5mac.com/2023/07/11/vision-pro-performance/</p>
              <p>3: https://www.apple.com/apple-vision-pro/</p>
            </div>
          </section>
        </section>
        <section id="39093970">
          <h3>
            <a class="item" href="https://www.jotaen.net/iE3XC/"
              >CLI tool, written in Rust, to diff directory snapshots</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 19:14:30</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39093970"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39093821">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2024/01/google-and-att-invest-in-starlink-rival-for-satellite-to-smartphone-service/"
              >Google and AT&amp;amp;T invest in Starlink rival for
              satellite-to-smartphone service</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 19:05:10</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39093821"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39093773">
          <h3>
            <a
              class="item"
              href="https://nypost.com/2024/01/22/news/nyc-bound-flight-canceled-when-passenger-notices-missing-bolts-on-plane-wing/"
              >Passenger notices missing bolts on plane wing, flight canceled</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 19:01:46</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39093773"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39093109">
          <h3>
            <a class="item" href="https://danluu.com/2choices-eviction/"
              >Caches: LRU vs. Random</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 18:19:22</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39093109"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39092849">
          <h3>
            <a
              class="item"
              href="https://www.inngest.com/blog/building-the-inngest-queue-pt-i-fairness-multi-tenancy"
              >Building a fair multi-tenant queuing system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 17:59:54</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39092849"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39092505">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gaming/2024/01/modder-recreates-game-boy-advance-games-using-the-audio-from-crash-sounds/"
              >Modder re-creates Game Boy Advance games using the audio from
              crash sounds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 17:39:13</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39092505"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39092278">
          <h3>
            <a
              class="item"
              href="https://www.lesswrong.com/posts/oA23zoEjPnzqfHiCt/there-is-way-too-much-serendipity"
              >There is way too much serendipity</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 17:26:24</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39092278"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39091981">
          <h3>
            <a class="item" href="https://github.com/LiheYoung/Depth-Anything"
              >Depth Anything: Unleashing the Power of Large-Scale Unlabeled
              Data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 17:08:37</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39091981"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39091949">
          <h3>
            <a class="item" href="https://n9o.xyz/posts/202401-evolution-ai/"
              >Evolution of AI and Amara's Law</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 17:06:39</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39091949"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39091901">
          <h3>
            <a class="item" href="https://patterns.app/"
              >Patterns (YC S21) is hiring to automate analytics with LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 17:03:26</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39091857">
          <h3>
            <a
              class="item"
              href="https://www.uaf.edu/news/woolly-mammoth-movements-tied-to-earliest-alaska-hunting-camps.php"
              >Woolly mammoth movements tied to earliest Alaska hunting camps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 17:00:14</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39091857"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39091838">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Fair_cake-cutting"
              >Fair Cake-Cutting</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 16:59:11</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39091838"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39091819">
          <h3>
            <a class="item" href="https://vxdev.pages.dev"
              >Show HN: Vx.dev – GitHub-Powered AI for effortless development</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 16:58:25</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39091819"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39091777">
          <h3>
            <a
              class="item"
              href="https://lightning.ai/lightning-ai/studios/code-lora-from-scratch?view=public&amp;section=all"
              >LoRA from scratch: implementation for LLM finetuning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 16:56:20</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39091777"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39091566">
          <h3>
            <a
              class="item"
              href="https://lgug2z.com/articles/building-and-privately-caching-x86-and-aarch64-nixos-systems-on-github-actions/"
              >Building and Privately Caching x86 and Aarch64 NixOS Systems with
              GitHub Actions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 16:42:18</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39091566"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39091416">
          <h3>
            <a
              class="item"
              href="https://tuananh.net/2024/01/21/cloud-cost-optimization-at-scale-part-1/"
              >Cutting down AWS cost by $150k per year simply by shutting things
              off</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 16:33:57</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39091416"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39090879">
          <h3>
            <a
              class="item"
              href="https://www.neowin.net/news/meta-now-lets-eu-users-unlink-their-facebook-messenger-and-instagram-accounts/"
              >Meta now lets EU users unlink their Facebook, Messenger and
              Instagram accounts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 16:00:00</span
              ><span class="points-container"
                >Points: <span class="points">229</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39090879"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39090266">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2024/01/29/tripping-on-utopia-margaret-mead-the-cold-war-and-the-troubled-birth-of-psychedelic-science-benjamin-breen-book-review"
              >When America first dropped acid</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 15:12:25</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39090266"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39088551">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39088551"
              >Launch HN: Diversion (YC S22) – Cloud-Native Git Alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 12:01:10</span
              ><span class="points-container"
                >Points: <span class="points">230</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39088551"
                  >Comments</a
                ><span class="descendants">: 294</span></span
              >
            </h4>
            <div class="text">
              <a href="https://diversion.dev">https://diversion.dev</a>). We’re
              building a modern, cloud-native version control. Our first users
              are game developers, who like its simplicity and scalability. See
              a quick demo here:
              <a href="https://youtu.be/DD0XkL8kDYc"
                >https://youtu.be/DD0XkL8kDYc</a
              >
              <p>
                Why a new VCS? There is no doubt that Git vastly improved our
                lives, and played a significant role in the advancement of
                software development over the past 18 years. But - it was built
                for a very different world in 2005 (slow networks, much smaller
                projects, no cloud), and is not the perfect tool for everyone
                today.
              </p>
              <p>
                The biggest drawback of Git is its limited scalability - both in
                repository and file sizes, and the number of concurrent users.
                This is the reason Google and Meta built their own version
                control systems. It’s also the reason why other large companies,
                most notably in games development, semiconductors and financial
                services are still using legacy tools like SVN and Perforce.
              </p>
              <p>
                Another issue we’re trying to fix is Git’s famous complexity. In
                our previous startup, a data scientist accidentally destroyed a
                month’s work of his team by using the wrong Git command (EDIT:
                we were eventually able to restore from a non-updated repo
                clone, after a few hours). As a developer who used CVS and SVN
                before Git was created, I often wondered why Git is so difficult
                to learn, compared to other tools.
              </p>
              <p>
                On the other hand, Git’s branching and merging abilities are
                exceptional - this has enabled the modern software development
                methodologies that we all take for granted today (e.g. feature
                branches, CI/CD), greatly improving developers’ velocity.
              </p>
              <p>
                We were wondering - is it possible to create an easy-to-use,
                fast, scalable version control system, with Git’s branching
                capabilities? And what else can be improved, while we’re at it?
              </p>
              <p>
                One thing available in modern cloud tools is real-time
                collaboration (e.g. Google Docs, Figma). While developers don’t
                necessarily want their work in progress to be visible to
                everyone, it may be very useful to easily share it when you want
                to get feedback before a commit, to detect and prevent merge
                conflicts, and to have visibility into which parts of the
                codebase are being changed by others.
              </p>
              <p>
                Diversion is built on top of distributed storage and databases,
                accessible via REST API, and runs on serverless cloud
                infrastructure. Every repository operation is an API call
                (commit, branch, merge etc.). The desktop client synchronizes
                all work in progress to the cloud in real time (even before a
                commit). Users can work with Diversion using an interactive CLI,
                Web UI, or IDE plugins (currently JetBrains, more coming soon).
                The Web UI allows to perform most basic operations, without
                needing to install a desktop client.
              </p>
              <p>
                Diversion is compatible with Git, and can synchronize with
                existing Git repositories (each new commit in Diversion goes
                into Git, and vice versa). We’re planning to release it as open
                source once the code base matures, and when we implement an open
                source repositories directory on our website (naturally,
                Diversion’s code is managed on Diversion!)
              </p>
              <p>
                We’re in open beta, you can try it here (<a
                  href="https://diversion.dev"
                  >https://diversion.dev</a
                >) (click Get Started). It’s completely self-service and there’s
                no need to talk to anyone, and it’s free for small teams (<a
                  href="https://diversion.dev/pricing"
                  >https://diversion.dev/pricing</a
                >).
              </p>
              <p>
                Building a version control is hard (as we have learned), and
                Diversion still has a long way to go. We are currently working
                on improving speed, CI integrations, plugins to IDEs and game
                engines, and other usability improvements. We would love to hear
                your thoughts and feedback on what we’ve got so far!
              </p>
            </div>
          </section>
        </section>
        <section id="39087752">
          <h3>
            <a class="item" href="https://qr.blinry.org/"
              >Reading QR codes without a computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 09:21:11</span
              ><span class="points-container"
                >Points: <span class="points">406</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087752"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087609">
          <h3>
            <a
              class="item"
              href="https://rubyflow.com/p/pb1tu2-rubywm-an-x11-window-manager-in-pure-ruby"
              >RubyWM – an X11 window manager in pure Ruby</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 08:51:14</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087609"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087274">
          <h3>
            <a
              class="item"
              href="https://www.reddit.com/r/aviation/s/kb3WBpHMFL"
              >Kayak's new flight filter allows you to exclude aircraft
              models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 07:41:10</span
              ><span class="points-container"
                >Points: <span class="points">450</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087274"
                  >Comments</a
                ><span class="descendants">: 311</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39084329">
          <h3>
            <a
              class="item"
              href="https://profmattstrassler.com/2024/01/19/how-far-could-the-sun-possibly-be/"
              >How far could the sun possibly be?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-21 @ 23:52:41</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39084329"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39081861">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/karel-capek-robots"
              >A Man Who Coined the Word "Robot" Defends Himself</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-21 @ 19:16:56</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39081861"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39067615">
          <h3>
            <a
              class="item"
              href="https://medium.com/@mustafaakin/indexing-icloud-photos-with-ai-using-llava-and-pgvector-fd58182febf6"
              >Indexing iCloud Photos with AI Using LLaVA and Pgvector</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-20 @ 14:01:45</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39067615"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39067320">
          <h3>
            <a class="item" href="https://www.brokentoys.org/ludum-mortuus-est/"
              >Ludum Mortuus Est</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-20 @ 13:21:13</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39067320"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
