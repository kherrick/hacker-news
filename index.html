<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43975318">
          <h3>
            <a class="item" href="https://peyre.42web.io/Colonization/index.htm"
              >Sid Meier's Colonization</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 17:17:17</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43975318"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43975254">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/ai/2025/05/gop-sneaks-decade-long-ai-regulation-ban-into-spending-bill/"
              >GOP sneaks decade-long AI regulation ban into spending bill</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 17:12:33</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43975254"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43974891">
          <h3>
            <a
              class="item"
              href="https://ethz.ch/en/news-and-events/eth-news/news/2025/05/eth-zurich-researchers-discover-new-security-vulnerability-in-intel-processors.html"
              >ETH Zurich researchers discover new security vulnerability in
              Intel processors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 16:44:51</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43974891"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43974484">
          <h3>
            <a class="item" href="https://github.com/ag-ui-protocol/ag-ui"
              >Show HN: AG-UI Protocol – Bring Agents into Frontend
              Applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 16:09:57</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43974484"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43974268">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2025/05/12/openais-stargate-project-reportedly-struggling-to-get-off-the-ground-thanks-to-tariffs/"
              >OpenAI's Stargate project struggling to get off the ground, due
              to tariffs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 15:51:28</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43974268"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43974026">
          <h3>
            <a
              class="item"
              href="https://ruby0x1.github.io/machinery_blog_archive/post/a-taxonomy-of-bugs/index.html"
              >A Taxonomy of Bugs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 15:29:18</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43974026"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43974005">
          <h3>
            <a class="item" href="https://www.rifters.com/crawl/?p=11511"
              >It Awaits Your Experiments</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 15:27:47</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43974005"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43973721">
          <h3>
            <a class="item" href="https://www.marginalia.nu/log/a_119_pdf/"
              >PDF to Text, a Challenging Problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 15:01:09</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43973721"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43972535">
          <h3>
            <a
              class="item"
              href="https://wqtz.bearblog.dev/high-stress-job-relationships/"
              >In a high-stress work environment, prioritize relationships</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 13:08:52</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43972535"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43972438">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2025/05/13/eu_security_bug_database/"
              >As US vuln-tracking falters, EU enters with its own security bug
              database</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 12:58:25</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43972438"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43972425">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43972425"
              >Launch HN: Miyagi (YC W25) turns YouTube videos into online,
              interactive courses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 12:56:42</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43972425"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
            <div class="text">
              <a href="https://miyagilabs.ai">https://miyagilabs.ai</a>), an
              AI-powered education platform that transforms educational YouTube
              videos into interactive courses. It helps you learn better through
              active practice and personalized feedback.
              <p>
                We use LLMs to automatically generate quizzes, practice
                questions, and real-time feedback from any educational video or
                resource—turning passive watching into active learning. Here’s a
                short demo:
                <a href="https://youtu.be/alO7FaorHOY"
                  >https://youtu.be/alO7FaorHOY</a
                >.
              </p>
              <p>
                Improving education has always been tricky. Bloom’s 2-sigma
                problem (showing that a high-quality personal tutor is far more
                effective than conventional methods) has persisted, even as
                technology has advanced.
              </p>
              <p>
                We met at MIT as CS majors and have always been passionate about
                education. Over the years, we’ve become teachers and experts in
                subjects like chess, algorithms, math, languages, and ninja
                warrior. A common theme was that we both heavily relied on
                YouTube to learn.
              </p>
              <p>
                YouTube has incredible content for learning pretty much
                anything, but it’s buried in a lot of distractions. Also,
                passively watching videos is far less effective than taking
                notes, asking questions, and doing practice problems, which is
                what we aim to do with Miyagi Labs.
              </p>
              <p>
                Our solution is essentially a multi-step function that takes in
                a YouTube playlist (or list of any resources) and outputs an
                entire course with summaries, questions, answers, and more. The
                pipeline is roughly: video/resource —&gt; transcript/text —&gt;
                chunks —&gt; summary and question —&gt; answers to questions,
                with some other features along the way.
              </p>
              <p>
                We mostly use prompting and different models at each step to
                make the course as useful as possible. Certain topics require
                more practice problems vs. comprehension, and we’d use reasoning
                models for highly technical subjects.
              </p>
              <p>
                We launched about three months ago and currently have 400+
                courses and partnerships with some businesses and awesome
                creators. Some of our popular courses include 3Blue1Brown’s
                linear algebra course, a botany course on plants and ecology,
                and YC’s How to Start a Startup series.
              </p>
              <p>
                Our product resembles classical MOOC-style course platforms in
                terms of UI, but is more interactive. It’s really easy to ask a
                question or receive custom feedback compared to a static course
                on Coursera. It’s also comparable to AI tutor sites, but we try
                to build more of a community and require less activation energy
                as a learner. We’re basically betting that AI can hugely improve
                education, but that students still want to learn from their
                favorite creators and want baseline shared resources for
                standard topics that are then augmented with personalized
                features.
              </p>
              <p>
                You can try it here:
                <a href="https://miyagilabs.ai">https://miyagilabs.ai</a> (no
                login required for most courses—but if you sign up you can also
                create your own course).
              </p>
              <p>
                We’d love your feedback on what kinds of videos/resources you’d
                like to learn from, what’s missing from current learning tools,
                and if you know any creators or educators who would like to
                collaborate. Happy to hear any feedback and answer any
                questions!
              </p>
            </div>
          </section>
        </section>
        <section id="43971716">
          <h3>
            <a
              class="item"
              href="https://www.openwall.com/lists/oss-security/2025/05/12/1"
              >Multiple Security Issues in GNU Screen</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 11:28:49</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43971716"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43971688">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43971688"
              >Show HN: Basecoat – shadcn/UI components, no React required</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 11:22:40</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43971688"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                - Live demo &amp; documentation:
                <a href="https://basecoatui.com">https://basecoatui.com</a>
              </p>
              <p>
                - MIT‑licensed and free:
                <a href="https://github.com/hunvreus/basecoat/"
                  >https://github.com/hunvreus/basecoat/</a
                >
              </p>
              <p>
                - Works with any backend (Flask, Django, Rails, PHP, etc.) or
                static site.
              </p>
              <p>- Fully theme‑compatible with shadcn/ui [2].</p>
              <p>
                - Uses a sliver of Alpine.js only for a few interactive bits
                (e.g. combobox). Swap in your own JS if you prefer.
              </p>
              <p>- Dead simple to use, just drop in a class here and there:</p>
              <p></p>
              <pre><code>  &lt;button class="btn" data-tooltip="This is a tooltip text"&gt;Click me&lt;/button&gt;
</code></pre>
              Why I built it: after moving from a Next.js stack back to Flask +
              Tailwind + HTMX, I missed shadcn/ui and didn’t want walls of
              Tailwind classes (like Flowbite or Preline).
              <p>
                Feedback is most welcome: bugs, requests for components,
                criticism.
              </p>
              <p>
                [1]: <a href="https://v4.shadcn.com/">https://v4.shadcn.com/</a>
              </p>
              <p>
                [2]:
                <a href="https://basecoatui.com/installation/#install-theming"
                  >https://basecoatui.com/installation/#install-theming</a
                >
              </p>
              <p>
                [3]: <a href="https://pagescms.org">https://pagescms.org</a>
              </p>
            </div>
          </section>
        </section>
        <section id="43971464">
          <h3>
            <a
              class="item"
              href="https://twitter.com/ID_AA_Carmack/status/1922100771392520710"
              >The world could run on older hardware if software optimization
              was a priority</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 10:31:09</span
              ><span class="points-container"
                >Points: <span class="points">424</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43971464"
                  >Comments</a
                ><span class="descendants">: 367</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43971314">
          <h3>
            <a class="item" href="https://github.com/felixpalmer/a5"
              >Show HN: A5</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 10:02:46</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43971314"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43970837">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43970837"
              >Ask HN: How are you acquiring your first hundred users?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 08:41:25</span
              ><span class="points-container"
                >Points: <span class="points">337</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43970837"
                  >Comments</a
                ><span class="descendants">: 218</span></span
              >
            </h4>
            <div class="text">
              <p>
                What we are currently doing: 1) Cold outreach to power users -
                to convert them into affiliates. 2) Cold outreach to individuals
                who have target ICP communities. 3) SEO for more long term (not
                for the first 500)
              </p>
            </div>
          </section>
        </section>
        <section id="43970800">
          <h3>
            <a
              class="item"
              href="https://zylinski.se/posts/a-programming-language-for-me/"
              >A programming language made for me</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 08:35:11</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43970800"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43970637">
          <h3>
            <a
              class="item"
              href="https://erratique.ch/writings/anti-personnel-computing"
              >Anti-Personnel Computing (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 08:06:59</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43970637"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43970363">
          <h3>
            <a
              class="item"
              href="https://admiralcloudberg.medium.com/trial-by-fire-the-crash-of-aeroflot-flight-1492-ee61cebcf6ec"
              >Trial by Fire: The crash of Aeroflot flight 1492</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 07:12:54</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43970363"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43969827">
          <h3>
            <a class="item" href="https://github.com/mozilla-firefox/firefox"
              >Mozilla Firefox – Official GitHub repo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 05:23:10</span
              ><span class="points-container"
                >Points: <span class="points">709</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43969827"
                  >Comments</a
                ><span class="descendants">: 389</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43969442">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2502.07864"
              >TransMLA: Multi-head latent attention is all you need</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 03:29:47</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43969442"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43968897">
          <h3>
            <a class="item" href="https://github.com/apple/ml-fastvlm"
              >FastVLM: Efficient vision encoding for vision language models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 01:16:02</span
              ><span class="points-container"
                >Points: <span class="points">329</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43968897"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43958562">
          <h3>
            <a
              class="item"
              href="https://computer.rip/2025-05-11-air-traffic-control.html"
              >Air Traffic Control</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-12 @ 00:39:22</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43958562"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43957140">
          <h3>
            <a class="item" href="https://www.why.is/svar.php?id=5513"
              >Why are coffee stains darker at the edges?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-11 @ 21:03:09</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43957140"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43952707">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/1d35759f-f2a9-46c4-904b-4a78ccc027df"
              >Insurers launch cover for losses caused by AI chatbot errors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-11 @ 10:07:22</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43952707"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43951885">
          <h3>
            <a class="item" href="https://ratfactor.com/snobol/"
              >I learned Snobol and then wrote a toy Forth</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-11 @ 06:38:27</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43951885"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43945483">
          <h3>
            <a class="item" href="https://membrane.stream/"
              >Membrane, Media Framework for Elixir</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 13:33:00</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43945483"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43943942">
          <h3>
            <a
              class="item"
              href="https://www.ctrl-alt-test.fr/2025/15-years-of-shader-minification/"
              >15 Years of Shader Minification</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-10 @ 07:51:30</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43943942"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43939029">
          <h3>
            <a
              class="item"
              href="https://nrk.neocities.org/articles/c-constexpr-macro#detecting-if-an-expression-is-constant-in-c"
              >Detecting if an expression is constant in C</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 17:09:04</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43939029"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43934869">
          <h3>
            <a
              class="item"
              href="https://serd.es/2025/05/08/Switch-project-pt1.html"
              >Open Hardware Ethernet Switch project, part 1</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 08:34:56</span
              ><span class="points-container"
                >Points: <span class="points">246</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43934869"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
