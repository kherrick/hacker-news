<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40451112">
          <h3>
            <a class="item" href="https://duckduckgo.com/?q=search+not+working"
              >What Happened to DuckDuckGo?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-23 @ 06:20:17</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40451112"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40450306">
          <h3>
            <a
              class="item"
              href="https://www.sfgate.com/food/article/taco-bell-ebay-mark-smith-paintings-19464177.php"
              >One of the most unusual heists in America seems to be unfolding
              at Taco Bell</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-23 @ 03:56:13</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40450306"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40450128">
          <h3>
            <a class="item" href="https://magicui.design/"
              >Magic UI: UI Library for Design Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-23 @ 03:23:54</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40450128"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40449767">
          <h3>
            <a class="item" href="https://windirstat.net/"
              >WinDirStat – Windows Directory Statistics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-23 @ 02:34:14</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40449767"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40449454">
          <h3>
            <a
              class="item"
              href="https://amvizion.org/blog/lessons-learned-from-yc.html"
              >Lessons learned from studying 4k YC companies</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-23 @ 01:48:53</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40449454"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40449278">
          <h3>
            <a class="item" href="https://fpvsim.com/drone-flying-101"
              >Drone Flying 101 – An Interactive Tutorial for Beginners</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-23 @ 01:25:35</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40449278"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40447998">
          <h3>
            <a class="item" href="https://github.com/misohena/el-easydraw"
              >Emacs Easydraw – drawing tool inside Emacs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 23:13:50</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40447998"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40447431">
          <h3>
            <a
              class="item"
              href="https://www.vox.com/future-perfect/351132/openai-vested-equity-nda-sam-altman-documents-employees"
              >Leaked OpenAI documents reveal aggressive tactics toward former
              employees</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 22:22:30</span
              ><span class="points-container"
                >Points: <span class="points">1283</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40447431"
                  >Comments</a
                ><span class="descendants">: 417</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40446433">
          <h3>
            <a class="item" href="https://github.com/leukipp/cortile"
              >Cortile – Linux auto tiling manager with hot corner support</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 20:56:20</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40446433"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40444267">
          <h3>
            <a
              class="item"
              href="https://materializedview.io/p/s3-is-showing-its-age"
              >S3 is showing its age</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 18:23:17</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40444267"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40444121">
          <h3>
            <a class="item" href="https://tryclojure.org/">Try Clojure</a>
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 18:11:34</span
              ><span class="points-container"
                >Points: <span class="points">413</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40444121"
                  >Comments</a
                ><span class="descendants">: 271</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40443927">
          <h3>
            <a class="item" href="https://github.com/nucleuscloud/neosync"
              >Show HN: Neosync – Open-Source Data Anonymization for Postgres
              and MySQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 17:53:45</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40443927"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.github.com/nucleuscloud/neosync"
                >https://www.github.com/nucleuscloud/neosync</a
              >). Neosync is an open source platform that helps developers
              anonymize production data, generate synthetic data and sync it
              across their environments for better testing, debugging and
              developer experience.
              <p>
                Most developers and teams have some version of a database seed
                script that creates some mock data for their local and stage
                databases. The problem is that production data is messy and it’s
                very difficult to replicate that with mock data. This causes two
                big problems for developers.
              </p>
              <p>
                The first problem is that features seem to work locally/stage
                but have bugs and edge cases in production because the seed data
                you used to develop against was not representative of production
                data.
              </p>
              <p>
                The second problem we saw was that debugging production errors
                would take a long time and would often resurface. When we see a
                bug in production, the first thing we want to do is reproduce it
                locally, but if we can’t reproduce the state of the data
                locally, then we’re kind of flying blind.
              </p>
              <p>
                Working directly with production data would solve both of these
                problems but most teams can’t because of: (1) privacy/security
                issues and (2) scale. So we set out to solve these two problems
                with Neosync.
              </p>
              <p>
                We solve the privacy and security problem using anonymization
                and synthetic data. We have 40+ pre-built transformers (or you
                can write your own in code) that can anonymize PII or sensitive
                data so that it’s safe to use locally. Additionally, you can
                generate synthetic data from scratch that fits your existing
                schema across your database.
              </p>
              <p>
                The second problem is scale. Some production databases are too
                big to fit locally or just have more data than you need. Also,
                in some cases, you may want to debug a certain customer’s data
                and you only want their data. We solve this with subsetting. You
                can pass in a SQL query to filter your table(s) and Neosync will
                handle all of the heavy lifting including referential integrity.
              </p>
              <p>
                At the core of Neosync does three things: (1) It streams data
                from a source to one or multiple destination databases. We never
                store your sensitive data. (2) While that data is being
                streamed, we transform it. You define which schemas and tables
                you want to sync and at the column level, select a transformer
                that defines how you want to anonymize the data or generate
                synthetic data. (3) We subset your data based on your filters.
              </p>
              <p>
                We do all of this while handling referential integrity. Whether
                you have primary keys, foreign keys, unique constraints,
                circular dependencies (within a table and across tables),
                sequences and more, Neosync preserves those references.
              </p>
              <p>
                We also ship with APIs, a Terraform provider, a CLI and Github
                action that you can use to hydrate a CI database.
              </p>
              <p>
                Neosync is an open source project written in Go and Typescript
                and can be run on Docker Compose, Bare Metal, or Kubernetes via
                Helm. You can also use our hosted platform or managed platform
                that you can deploy in your VPC. We also have a hosted platform
                with a generous free tier -
                <a href="https://neosync.dev">https://neosync.dev</a>
              </p>
              <p>
                Here's a brief loom demo:
                <a
                  href="https://www.loom.com/share/ac21378d01cd4d848cf723e4960e8338?sid=2faf613c-92be-44fa-9278-c8087e777356"
                  >https://www.loom.com/share/ac21378d01cd4d848cf723e4960e8338?...</a
                >
              </p>
              <p>We'd love any feedback you have!</p>
            </div>
          </section>
        </section>
        <section id="40443920">
          <h3>
            <a class="item" href="https://github.com/onecodex/rust-bfield"
              >Show HN: B-field, a novel probabilistic key-value data structure
              (`rust-bfield`)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 17:53:16</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40443920"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
            <div class="text">
              <p>
                The B-field allows you to compactly store data using only a few
                bytes per key-value pair. We've successfully utilized it in
                genomics to associate billions of "k-mers" with taxonomic
                identifiers while maintaining an efficient memory footprint. But
                the data structure is also useful beyond computational biology,
                particularly where you have large unique key domains and
                constrained value ranges.
              </p>
              <p>
                Available under an Apache 2 license. We hope it proves useful,
                and we're happy to answer any questions!
              </p>
            </div>
          </section>
        </section>
        <section id="40443302">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/opinion/articles/2024-05-22/citi-missed-a-fat-finger"
              >Citi Missed a Fat Finger</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 17:01:40</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40443302"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40442595">
          <h3>
            <a class="item" href="https://string.spiel.com/"
              >Pluckable Strings</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 16:05:06</span
              ><span class="points-container"
                >Points: <span class="points">529</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40442595"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40441945">
          <h3>
            <a class="item" href="https://unify.ai/chat?default=true"
              >Show HN: Route your prompts to the best LLM</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 15:07:20</span
              ><span class="points-container"
                >Points: <span class="points">189</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40441945"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
            <div class="text">
              <p>
                Here is a quick(ish) screen-recroding explaining how it works:
                <a href="https://youtu.be/ZpY6SIkBosE"
                  >https://youtu.be/ZpY6SIkBosE</a
                >
              </p>
              <p>
                Best results when training a custom router on your own prompt
                data:
                <a href="https://youtu.be/9JYqNbIEac0"
                  >https://youtu.be/9JYqNbIEac0</a
                >
              </p>
              <p>
                The router balances user preferences for quality, speed and
                cost. The end result is higher quality and faster LLM responses
                at lower cost.
              </p>
              <p>
                The quality for each candidate LLM is predicted ahead of time
                using a neural scoring function, which is a BERT-like
                architecture conditioned on the prompt and a latent
                representation of the LLM being scored. The different LLMs are
                queried across the batch dimension, with the neural scoring
                architecture taking a single latent representation of the LLM as
                input per forward pass. This makes the scoring function very
                modular to query for different LLM combinations. It is trained
                in a supervised manner on several open LLM datasets, using GPT4
                as a judge. The cost and speed data is taken from our live
                benchmarks, updated every few hours across all continents. The
                final "loss function" is a linear combination of quality, cost,
                inter-token-latency and time-to-first-token, with the user
                effectively scaling the weighting factors of this linear
                combination.
              </p>
              <p>
                Smaller LLMs are often good enough for simple prompts, but
                knowing exactly how and when they might break is difficult.
                Simple perturbations of the phrasing can cause smaller LLMs to
                fail catastrophically, making them hard to rely on. For example,
                Gemma-7B converts numbers to strings and returns the "largest"
                string when asking for the "largest" number in a set, but works
                fine when asking for the "highest" or "maximum".
              </p>
              <p>
                The router is able to learn these quirky distributions, and
                ensure that the smaller, cheaper and faster LLMs are only used
                when there is high confidence that they will get the answer
                correct.
              </p>
              <p>
                Pricing-wise, we charge the same rates as the backend providers
                we route to, without taking any margins. We also give $50 in
                free credits to all new signups.
              </p>
              <p>
                The router can be used off-the-shelf, or it can be trained
                directly on your own data for improved performance.
              </p>
              <p>What do people think? Could this be useful?</p>
              <p>Feedback of all kinds is welcome!</p>
            </div>
          </section>
        </section>
        <section id="40441487">
          <h3>
            <a
              class="item"
              href="https://socket.dev/blog/the-push-to-ban-ransom-payments-is-gaining-momentum"
              >The push to ban ransom payments is gaining momentum</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 14:31:58</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40441487"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40441093">
          <h3>
            <a class="item" href="https://github.com/ohbarye/pbt"
              >Show HN: PBT – A property-based testing library for Ruby</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 13:58:25</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40441093"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                I introduce a property-based testing tool for Ruby. Ruby's ease
                of test-writing and rich ecosystem are widely acclaimed.
                However, property-based testing is not as widely used as in
                other languages such as Haskell or Elixir, and I think this is
                because there is no de facto testing tool.
              </p>
              <p>
                This gem currently not only has the basic functionality of
                stateless property-based testing but also has the following
                features:
              </p>
              <p>
                - Support verbose mode that allows you to see its shrinking
                procedure and algorithms.
              </p>
              <p>
                - Support several concurrency/parallel executions of each test.
                As of now, Ractor/Thread/Process are available. (The default is
                sequential, considering benchmark results and actual use cases)
              </p>
              <p>Happy hacking!</p>
            </div>
          </section>
        </section>
        <section id="40440971">
          <h3>
            <a class="item" href="https://github.com/srush/Tensor-Puzzles"
              >Tensor Puzzles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 13:48:09</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40440971"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40440854">
          <h3>
            <a class="item" href="https://www.gatesnotes.com/Brave-New-Words"
              >Sal Khan is pioneering innovation in education again</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 13:39:53</span
              ><span class="points-container"
                >Points: <span class="points">313</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40440854"
                  >Comments</a
                ><span class="descendants">: 309</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40440841">
          <h3>
            <a
              class="item"
              href="https://thephd.dev/just-put-raii-in-c-bro-please-bro-just-one-more-destructor-bro-cmon-im-good-for-it"
              >Why not just do simple C++ RAII in C?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 13:38:51</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40440841"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40440086">
          <h3>
            <a
              class="item"
              href="https://engineering.mit.edu/engage/ask-an-engineer/whats-the-difference-between-a-motor-and-an-engine/"
              >What's the difference between a motor and an engine?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 12:21:23</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40440086"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40439654">
          <h3>
            <a
              class="item"
              href="https://petapixel.com/2024/05/21/microsoft-paints-new-ai-image-generator-builds-on-your-brushstrokes/"
              >Microsoft Paint's new AI image generator builds on your
              brushstrokes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 11:23:20</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40439654"
                  >Comments</a
                ><span class="descendants">: 136</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40439515">
          <h3>
            <a class="item" href="https://gmunk.com/Windows-10-Desktop/"
              >Windows 10 wallpaper was physically built and photographed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 10:59:46</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40439515"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40439404">
          <h3>
            <a
              class="item"
              href="https://wingolog.org/archives/2024/05/22/growing-a-bootie"
              >Growing a Bootie</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 10:38:40</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40439404"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40438510">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Number_16_(spider)"
              >Number 16 (spider)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 08:08:26</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40438510"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40437641">
          <h3>
            <a class="item" href="https://maggieappleton.com/generative-forgery"
              >Faking William Morris, Generative Forgery, and the Erosion of Art
              History</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-22 @ 05:31:30</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40437641"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40426453">
          <h3>
            <a class="item" href="https://www.emacswiki.org/emacs/EmacsStories"
              >Emacs used as a message router in Germany's ATC systems in the
              1990s (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-21 @ 10:18:00</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40426453"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40425762">
          <h3>
            <a
              class="item"
              href="https://slothconservation.org/sloths-move-slow/"
              >Why Are Sloths So Slow?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-21 @ 08:55:56</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40425762"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40425402">
          <h3>
            <a
              class="item"
              href="https://www.gutenberg.org/files/62636/62636-h/62636-h.htm"
              >To the Person Sitting in Darkness (1901)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-21 @ 08:06:14</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40425402"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
