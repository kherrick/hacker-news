<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41213711">
          <h3>
            <a class="item" href="https://cjycode.com/posts/rust-ui-flutter/"
              >Show HN: Rust GUI Library via Flutter</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-11 @ 02:55:20</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41213711"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/fzyzcjy/flutter_rust_bridge"
                >https://github.com/fzyzcjy/flutter_rust_bridge</a
              >
              v2.0.0) between Flutter and Rust, which auto translates syntaxes
              like arbitrary types, &amp;mut, async, traits, results, closure
              (callback), lifetimes, etc. The goal is to make a bridge between
              the two, seamlessly as if working in one single language.
              <p>
                Then, as an example, I showed how to write Rust applications
                with GUI by utilizing Flutter. That is discussed in the link in
                details.
              </p>
              <p>
                To play with it, please visit the GitHub repo, or refer to the
                end of the article for detailed folders and commands.
              </p>
              <p>
                When I first released 1.0.0 years ago, it only contained few
                features compared to today. It is the result of the hard work of
                contributors and me, and many thanks to all the contributors!
              </p>
            </div>
          </section>
        </section>
        <section id="41213514">
          <h3>
            <a class="item" href="https://github.com/MicroPhase/antsdr-fw-patch"
              >ANTSDR: Low-cost SDR Alternatives for Ettus Research and Lime
              Microsystems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-11 @ 01:59:17</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41213514"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41213442">
          <h3>
            <a class="item" href="https://www.rfc-editor.org/rfc/rfc9180.html"
              >RFC 9180: Hybrid Public Key Encryption</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-11 @ 01:41:18</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41213442"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41213387">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/quantum-key-distribution"
              >Quantum Cryptography Has Everyone Scrambling</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-11 @ 01:29:16</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41213387"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41213151">
          <h3>
            <a
              class="item"
              href="https://www.rnz.co.nz/news/national/524791/the-surveilled-society-who-is-watching-you-and-how"
              >The surveilled society: Who is watching you and how</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-11 @ 00:20:41</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41213151"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41213082">
          <h3>
            <a
              class="item"
              href="https://blog.zarfhome.com/2024/08/tic-tac-toe-mysteries"
              >The Tic-Tac-Toe Mysteries of Xerloc O'Xolmes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-11 @ 00:01:09</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41213082"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41213053">
          <h3>
            <a class="item" href="https://chevyray.dev/blog/creating-175-fonts/"
              >I Created 175 Fonts Using Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 23:52:44</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41213053"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41212899">
          <h3>
            <a
              class="item"
              href="https://www.entropicengineering.com/defcon-32-statement"
              >Entropic Engineering DEFCON 32 Statement</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 23:10:49</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41212899"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41212364">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/business/healthcare-pharmaceuticals/us-fda-approves-first-nasal-spray-allergic-reactions-2024-08-09/"
              >US FDA approves nasal spray alternative to EpiPen for allergic
              reactions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 21:30:46</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41212364"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41212271">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/2024/08/10/amds-strix-point-zen-5-hits-mobile/"
              >AMD's Strix Point: Zen 5 Hits Mobile</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 21:18:51</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41212271"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41212193">
          <h3>
            <a
              class="item"
              href="https://blog.gingerbeardman.com/2024/08/10/stapler-i-remade-a-32-year-old-classic-macintosh-app/"
              >Stapler: I remade a 32 year old classic Macintosh app</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 21:03:04</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41212193"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41211540">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/blog-post/things-i-won-t-work-dimethylcadmium"
              >Things I Won't Work With: Dimethylcadmium (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 19:11:39</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41211540"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41211519">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/Defcon/comments/1ep00ln/def_cons_response_to_the_badge_controversy/"
              >DEF CON's response to the badge controversy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 19:07:23</span
              ><span class="points-container"
                >Points: <span class="points">212</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41211519"
                  >Comments</a
                ><span class="descendants">: 181</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41211039">
          <h3>
            <a class="item" href="https://dl.acm.org/doi/10.1145/3591264"
              >Interval parsing grammars for file format parsing (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 17:42:02</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41211039"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41210742">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/bluepnume/8f2376b0893bc6b85564e7359359ecd4"
              >OneText (YC W23) is hiring a lead TypeScript/Node engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 17:00:01</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41209994">
          <h3>
            <a class="item" href="https://github.com/supabase/pg_replicate"
              >Show HN: Pg_replicate – Build Postgres replication applications
              in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 15:00:41</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41209994"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41209688">
          <h3>
            <a class="item" href="https://github.com/evilsocket/opensnitch"
              >OpenSnitch is a GNU/Linux interactive application firewall</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 14:15:52</span
              ><span class="points-container"
                >Points: <span class="points">278</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41209688"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41208988">
          <h3>
            <a class="item" href="https://roitman.io/blog/91"
              >A wonderful coincidence or an expected connection: why π² ≈ g</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 12:24:54</span
              ><span class="points-container"
                >Points: <span class="points">376</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41208988"
                  >Comments</a
                ><span class="descendants">: 246</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41208506">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/technology/2024/08/10/front-porch-forum-vermont-research-new-public/"
              >On Front Porch Forum, politics is fair game but unkindness is
              prohibited</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 10:18:02</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41208506"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41207793">
          <h3>
            <a
              class="item"
              href="http://muratbuffalo.blogspot.com/2024/08/linearizability-correctness-condition.html"
              >Linearizability: A correctness condition for concurrent
              objects</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 06:51:39</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41207793"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41207608">
          <h3>
            <a
              class="item"
              href="https://fabiensanglard.net/snes_ppus_how/index.html"
              >How the SNES Graphics System Works</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 05:48:43</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41207608"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41207182">
          <h3>
            <a
              class="item"
              href="https://www.caltech.edu/about/news/caltech-team-develops-first-noninvasive-method-to-continually-measure-true-blood-pressure"
              >Caltech Develops First Noninvasive Method to Continually Measure
              Blood Pressure</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 03:53:04</span
              ><span class="points-container"
                >Points: <span class="points">208</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41207182"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41207048">
          <h3>
            <a class="item" href="https://arun.is/blog/shanghai-cars/"
              >Shanghai's Automotive Metamorphosis</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 03:16:14</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41207048"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41206908">
          <h3>
            <a
              class="item"
              href="https://blog.screenshotbot.io/2024/08/10/building-a-highly-available-web-service-without-a-database/"
              >Building a highly-available web service without a database</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 02:37:55</span
              ><span class="points-container"
                >Points: <span class="points">240</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41206908"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41204228">
          <h3>
            <a class="item" href="https://disneyanimation.com/process/"
              >Animated Film Making Process</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-09 @ 18:30:18</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41204228"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41203269">
          <h3>
            <a class="item" href="https://www.nissin.com/en_jp/about/founder/"
              >Our Founder – Momofuku Ando</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-09 @ 16:24:28</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41203269"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41183795">
          <h3>
            <a
              class="item"
              href="https://www.joshcanhelp.com/personal-data-pipeline/"
              >Imagining a personal data pipeline</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 18:06:44</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41183795"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41181155">
          <h3>
            <a
              class="item"
              href="https://entertainment.howstuffworks.com/olympic-timing.htm"
              >How Olympic Timing Works</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 13:18:00</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41181155"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41180356">
          <h3>
            <a
              class="item"
              href="https://newsletter.posthog.com/p/ab-testing-mistakes-i-learned-the"
              >A/B testing mistakes I learned the hard way</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 11:45:23</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41180356"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41179043">
          <h3>
            <a
              class="item"
              href="https://www.ams.org/notices/200503/fea-weil.pdf"
              >A 1940 Letter of André Weil on Analogy in Mathematics (2003)
              [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-07 @ 07:31:12</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41179043"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
