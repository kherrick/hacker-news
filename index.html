<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41929585">
          <h3>
            <a
              class="item"
              href="https://typeblog.net/55833/getting-called-paid-actor-by-linus-torvalds"
              >Getting Called "Paid Actor" by Linus Torvalds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 21:52:32</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41929585"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41929174">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2024/Oct/21/claude-artifacts/"
              >Everything I built with Claude Artifacts this week</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 20:52:13</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41929174"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41928968">
          <h3>
            <a class="item" href="https://resobscura.substack.com/p/post-postal"
              >Post-postal: What did we lose when we stopped writing letters?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 20:25:09</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41928968"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41928529">
          <h3>
            <a
              class="item"
              href="https://www.copetti.org/writings/consoles/playstation-vita/"
              >Playstation Vita Architecture (Part 1)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 19:31:51</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41928529"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41928203">
          <h3>
            <a
              class="item"
              href="https://github.com/dittofeed/dittofeed/tree/main/packages/emailo"
              >Show HN: Open-source low-code email editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 18:54:59</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41928203"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/dittofeed/dittofeed"
                >https://github.com/dittofeed/dittofeed</a
              >).
              <p>
                We just added low-code functionality to our open-source email
                template editor. The editor features a Notion-inspired “/”
                command interface for inserting new blocks.
              </p>
              <p>
                You still have the option of using MJML or HTML, but we wanted
                to give everyone an easier option for creating primarily
                text-based emails.
              </p>
              <p>
                We have a live demo of the editor which you can access here
                (just hit the “Create Template” button):
                <a href="https://demo.dittofeed.com/dashboard/templates"
                  >https://demo.dittofeed.com/dashboard/templates</a
                >
              </p>
              <p>
                Since this is the first iteration of the feature, we’d love to
                hear your thoughts and feedback on how we can improve it.
              </p>
              <p>You can reach us anytime at:</p>
              <p>founders@dittofeed.com</p>
              <p>
                If you’d like to self-host Dittofeed and want help from us and
                the community, you can join our Discord:
                <a href="https://discord.gg/HajPkCG4Mm"
                  >https://discord.gg/HajPkCG4Mm</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41927624">
          <h3>
            <a class="item" href="https://github.com/huggingface/chat-macOS"
              >Show HN: A macOS Client for HuggingFace Chat</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 18:00:11</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41927624"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41927436">
          <h3>
            <a
              class="item"
              href="https://quansight.com/post/my-numpy-year-creating-a-dtype-for-the-next-generation-of-scientific-computing/"
              >My NumPy year: Creating a DType for the next generation of
              scientific computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 17:44:18</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41927436"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41926978">
          <h3>
            <a
              class="item"
              href="https://finance.yahoo.com/news/goldman-and-apple-illegally-sidestepped-obligations-to-credit-card-customers-cfpb-161226158.html"
              >Goldman and Apple 'illegally sidestepped' obligations to
              credit-card customers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 17:00:21</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41926978"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41926942">
          <h3>
            <a class="item" href="https://blog.gitbutler.com/fearless-rebasing/"
              >GitButler now supports first class conflicts, making rebasing
              less annoying</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 16:57:25</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41926942"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41926770">
          <h3>
            <a class="item" href="https://github.com/corbt/agent.exe"
              >Show HN: Agent.exe, a cross-platform app to let 3.5 Sonnet
              control your machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 16:44:01</span
              ><span class="points-container"
                >Points: <span class="points">300</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41926770"
                  >Comments</a
                ><span class="descendants">: 171</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41926669">
          <h3>
            <a
              class="item"
              href="https://pypy.org/posts/2024/10/jit-peephole-dsl.html"
              >A DSL for peephole transformation rules of integer operations in
              the PyPy JIT</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 16:31:58</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41926669"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41926067">
          <h3>
            <a
              class="item"
              href="https://github.com/srcbookdev/srcbook/blob/main/README.md"
              >Show HN: Srcbook – Self-hosted alternative to AI app builders</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 15:31:29</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41926067"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <a href="https://news.ycombinator.com/item?id=41291700"
                >https://news.ycombinator.com/item?id=41291700</a
              >) and the response was encouraging, but we kept hearing that
              people wanted to build interactive apps.
              <p>
                Today we are releasing just that. You can think of it as an
                open-source and local version of vercel’s v0. We actually think
                of it as something in between an IDE and that, because we
                believe the code matters and don’t shy away from that: you can
                view and edit the code in a full editor, but prompt your way
                forward if that's what you prefer. When the AI makes changes you
                can review the files diff like you would a GitHub pull request,
                and toggle between versions to view the visual diff.
              </p>
              <p>Try it now: npx srcbook@latest start</p>
              <p>
                It’s surprisingly good at building apps, especially with the
                latest claude model sonnet3.5 that came out yesterday. Here’s a
                video showing building and iterating on a ticket tracker MVP in
                a few minutes
                <a href="https://www.youtube.com/watch?v=jYOmzasvP74"
                  >https://www.youtube.com/watch?v=jYOmzasvP74</a
                >
              </p>
              <p>Key features:</p>
              <p>- bring you own API key</p>
              <p>- diff viewer</p>
              <p>- apply/undo mechanism to see the visual diff</p>
              <p>- export the code</p>
              <p>- code is OSS under apache2</p>
            </div>
          </section>
        </section>
        <section id="41925644">
          <h3>
            <a
              class="item"
              href="https://apps.apple.com/us/app/zesfy-planner-calendar/id6479947874"
              >Show HN: I built a task manager that separates "do" and "due"
              dates</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 14:52:34</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41925644"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
            <div class="text">
              <p>
                I’m the founder of Zesfy, a productivity app that I’ve been
                developing over the past few years. It’s designed to seamlessly
                integrate your tasks with your calendar, allowing you to
                transform your to-do lists into actionable events in just
                seconds. Here are some of its key features:
              </p>
              <p></p>
              <pre><code>  - Task Progress: Automatically update your progress based on subtasks completed
  - Step: Create step-by-step breakdown of the subtask
  - Target: Organize tasks with due date
  - Session: Insert multiple tasks to calendar event
  - Space: Filter event from specific sets of calendars
</code></pre>
              I recently introduced new features that often missing from other
              productivity apps: the ability to set both “Do” and “Due” dates.
              With these features, you can effortlessly plan your tasks for the
              day while keeping track the upcoming due dates. What makes Zesfy
              unique is it separates tasks you’ve planned and those that are
              already scheduled in your calendar, giving you a more organized
              and flexible workflow.
              <p>
                App Store:
                <a
                  href="https://apps.apple.com/us/app/zesfy-planner-calendar/id6479947874"
                  >https://apps.apple.com/us/app/zesfy-planner-calendar/id64799...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41925622">
          <h3>
            <a
              class="item"
              href="https://blogsystem5.substack.com/p/bazelcon-2024-recap"
              >BazelCon 2024 Recap</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 14:50:10</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41925622"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41925323">
          <h3>
            <a class="item" href="https://jacko.io/async_intro.html"
              >Async Rust in Three Parts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 14:23:29</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41925323"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41924787">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41924787"
              >Launch HN: GPT Driver (YC S21) – End-to-end app testing in
              natural language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 13:18:17</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41924787"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
            <div class="text">
              <a href="https://mobileboost.io/">https://mobileboost.io/</a>).
              We’re building GPT Driver, an AI-native approach to create and
              execute end-to-end (E2E) tests on mobile applications. Our
              solution allows teams to define tests in natural language and
              prevents test flakiness by taking a visual approach paired with
              LLM (Large Language Model) reasoning. This helps achieve E2E test
              coverage with a fraction of the usual effort.
              <p>
                You can watch a brief product walkthrough here:
                <a href="https://www.youtube.com/watch?v=5-Ge2fqdlxc"
                  >https://www.youtube.com/watch?v=5-Ge2fqdlxc</a
                >
              </p>
              <p>
                In terms of trying the product out: since the service is
                resource-intensive (we provide hosted virtual/real phone
                instances), we don't currently have a playground available.
                However, you can see some examples here
                <a href="https://mobileboost.io/showcases"
                  >https://mobileboost.io/showcases</a
                >
                and book a demo of GPT Driver testing your app through our
                website.
              </p>
              <p>
                Why we built this: working at previous startups and scaleups, we
                saw how as app teams grew, QA teams would struggle to ensure
                everything was still working. This caused tension between teams
                and resulted in bugs making it into production.
              </p>
              <p>
                You’d expect automated tests to help, but these were a huge
                effort because only engineers could create the tests, and the
                apps themselves kept changing—breaking the tests regularly and
                leading to high maintenance overhead. Functional tests often
                failed not because of actual app errors, but due to changes like
                copy updates or modifications to element IDs. This was already a
                challenge, even before considering the added complexities of
                multiple platforms, different environments, multilingual UIs,
                marketing popups, A/B tests, or minor UI changes from
                third-party authentication or payment providers.
              </p>
              <p>
                We realized that combining computer vision with LLM reasoning
                could solve the common flakiness issues in E2E testing. So, we
                launched GPT Driver—a no-code editor paired with a hosted
                emulator/simulator service that allows teams to set up test
                automation efficiently. Our visual + LLM reasoning test
                execution reduces false alarms, enabling teams to integrate
                their E2E tests into their CI/CD pipelines without getting
                blocked. Some interesting technical challenges we faced along
                the way: (1) UI Object Detection from Vision Input: We had to
                train object detection models (YOLO and Faster R-CNN based) on a
                subset of the RICO dataset as well as our own dataset to be able
                to interact accurately with the UI. (2) Reasoning with Current
                LLMs: We have to shorten instructions, action history, and
                screen content during runtime for better results, as handling
                large amounts of input tokens remains a challenge. We also work
                with reasoning templates to achieve robust decision-making. (3)
                Performance Optimization: We optimized our agentic loop to make
                decisions in less than 4 seconds. To reduce this further, we
                implemented caching mechanisms and offer a command-first
                approach, where our AI agent only takes over when the command
                fails.
              </p>
              <p>
                Since launching GPT Driver, we’ve seen adoption by technical
                teams, both with and without dedicated QA roles. Compared to
                code-based tests, the core benefit is the reduction of both the
                manual work and the time required to maintain effective E2E
                tests. This approach is particularly powerful for apps which
                have a lot of dynamic screens and content such as Duolingo which
                we have been working with since a couple of months.
                Additionally, the tests can now also be managed by
                non-engineers.
              </p>
              <p>
                We’d love to hear about your experiences with E2E test
                automation—what approaches have worked or didn’t work for you?
                What features would you find valuable?
              </p>
            </div>
          </section>
        </section>
        <section id="41923931">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2024/10/the-global-surveillance-free-for-all-in-mobile-ad-data/"
              >The global surveillance free-for-all in mobile ad data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 11:39:49</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41923931"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41923625">
          <h3>
            <a
              class="item"
              href="https://cybernetist.com/2024/10/21/you-should-probably-pay-attention-to-tokenizers/"
              >Probably pay attention to tokenizers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 10:29:15</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41923625"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41923429">
          <h3>
            <a
              class="item"
              href="https://blog.cloudflare.com/intro-access-for-infrastructure-ssh/"
              >Fearless SSH: Short-lived certificates bring Zero Trust to
              infrastructure</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 09:44:36</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41923429"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41922928">
          <h3>
            <a
              class="item"
              href="https://www.davidreis.me/2024/what-happens-when-you-make-a-move-in-lichess"
              >What happens when you make a move in lichess.org?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 08:13:47</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41922928"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41922356">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=iwVu2BWLZqA"
              >The Incredible Machine (1968) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 06:24:16</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41922356"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41917016">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/technology/archive/2017/04/the-tragedy-of-google-books/523320/"
              >The Tragedy of Google Books (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 18:11:03</span
              ><span class="points-container"
                >Points: <span class="points">368</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41917016"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41913145">
          <h3>
            <a
              class="item"
              href="https://quansight.com/post/my-numpy-year-creating-a-dtype-for-the-next-generation-of-scientific-computing/"
              >My NumPy year: Creating a DType for the next generation of
              scientific computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 11:12:10</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41913145"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41913057">
          <h3>
            <a class="item" href="https://parksontheair.com/index.html"
              >Parks on the Air</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 10:55:33</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41913057"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41913009">
          <h3>
            <a class="item" href="https://mhamilton.net/facesinthings"
              >Seeing faces in things: A model and dataset for pareidolia</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 10:45:43</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41913009"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41912769">
          <h3>
            <a
              class="item"
              href="http://incompleteideas.net/book/the-book-2nd.html"
              >Reinforcement Learning: An Introduction (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 09:58:10</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41912769"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41911335">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/the-indigenous-faith-that-reveres-its-own-alphabet-as-sacred"
              >The Script Creator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 05:02:16</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41911335"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41903425">
          <h3>
            <a class="item" href="https://substack.com/home/post/p-150506520"
              >Bulk optimization of queries in Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-21 @ 12:27:27</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41903425"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41894158">
          <h3>
            <a class="item" href="https://github.com/SatyrDiamond/DawVert"
              >DawVert – a DAW project file converter</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-20 @ 09:26:48</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41894158"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41890642">
          <h3>
            <a
              class="item"
              href="https://jaapgrolleman.com/shanghai-before-the-foreigners/"
              >Shanghai Before the Foreigners</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-19 @ 20:42:49</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41890642"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
