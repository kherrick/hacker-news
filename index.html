<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43421740">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2025/03/19/eu-sends-apple-first-dma-interoperability-instructions-for-apps-and-connected-devices/"
              >EU sends Apple first DMA interoperability instructions for apps
              and devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 11:19:48</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43421740"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43421694">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/space/2025/03/can-nasa-remain-nonpartisan-when-basic-spaceflight-truths-are-shredded/"
              >Can NASA remain nonpartisan when basic spaceflight truths are
              shredded?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 11:10:45</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43421694"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43420892">
          <h3>
            <a class="item" href="https://github.com/michal-stlv/stelvio"
              >Stelvio: Serverless AWS for Python Devs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 08:37:35</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43420892"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43420683">
          <h3>
            <a
              class="item"
              href="https://blogs.windows.com/msedgedev/2025/03/19/minding-the-gaps-a-new-way-to-draw-separators-in-css/"
              >Minding the gaps: A new way to draw separators in CSS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 08:00:54</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43420683"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43420678">
          <h3>
            <a
              class="item"
              href="https://github.com/tonypan2/minesweeper-mcp-server"
              >Show HN: I built a MCP server so Claude can play Minesweeper</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 07:58:57</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43420678"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>I am curious how I can prompt Claude to do better?</p>
            </div>
          </section>
        </section>
        <section id="43420152">
          <h3>
            <a
              class="item"
              href="https://fastcall.dev/posts/genai-genesis-firebase/"
              >How I accepted myself into Canada's largest AI hackathon</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 05:42:21</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43420152"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43419996">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/03/19/science/space/astronomer-desi-dark-energy.html"
              >'More Than a Hint' That Dark Energy Isn't What Astronomers
              Thought</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 04:57:12</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43419996"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43419928">
          <h3>
            <a
              class="item"
              href="https://borretti.me/article/introducing-austral"
              >Austral: A Systems Language with Linear Types and Capabilities
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 04:37:09</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43419928"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43419701">
          <h3>
            <a
              class="item"
              href="https://www.feldera.com/blog/the-pain-that-is-github-actions"
              >The Pain That Is GitHub Actions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 03:37:31</span
              ><span class="points-container"
                >Points: <span class="points">297</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43419701"
                  >Comments</a
                ><span class="descendants">: 235</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43419545">
          <h3>
            <a
              class="item"
              href="https://www.allaboutcircuits.com/news/silicon-labs-shrinks-wireless-socs-to-extend-ble-to-miniature-devices/"
              >Silicon Labs Shrinks Wireless SoCs to Extend BLE to Miniature
              Devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 02:58:48</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43419545"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43419422">
          <h3>
            <a class="item" href="https://sre.google/stpa/teaching/"
              >Teaching a new way to prevent outages at Google</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 02:36:16</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43419422"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43419365">
          <h3>
            <a class="item" href="https://www.gammon.com.au/forum/?id=11203"
              >GPascal – A Blast from the Past (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 02:25:18</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43419365"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43419240">
          <h3>
            <a class="item" href="https://group.softbank/en/news/press/20250320"
              >SoftBank Group to Acquire Ampere Computing for 6.5B</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 01:58:47</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43419240"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43419237">
          <h3>
            <a
              class="item"
              href="https://github.com/Tencent/Hunyuan3D-2/commit/baab8ba18e46052246f85a2d0f48736586b84a33"
              >Hunyuan3D-2-Turbo: fast high-quality shape generation in ~1s on a
              4090</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-20 @ 01:58:29</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43419237"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43418218">
          <h3>
            <a
              class="item"
              href="https://deeplearning.cs.cmu.edu/./S25/index.html"
              >Introduction to Deep Learning (CMU)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-19 @ 23:12:45</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43418218"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43418184">
          <h3>
            <a
              class="item"
              href="https://newscenter.lbl.gov/2025/03/19/desi-opens-access-to-the-largest-3d-map-of-the-universe-yet/"
              >DESI Opens Access to the Largest 3D Map of the Universe Yet</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-19 @ 23:08:08</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43418184"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43417932">
          <h3>
            <a class="item" href="https://szymanowiczs.github.io/bolt3d"
              >Bolt3D: Generating 3D Scenes in Seconds</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-19 @ 22:30:56</span
              ><span class="points-container"
                >Points: <span class="points">212</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43417932"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43417894">
          <h3>
            <a class="item" href="https://canopylabs.ai/model-releases"
              >Orpheus-3B – Emotive TTS by Canopy Labs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-19 @ 22:26:39</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43417894"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43417511">
          <h3>
            <a
              class="item"
              href="https://zacharyhuang.substack.com/p/llm-agent-internal-as-a-graph-tutorial"
              >LLM Agents Are Simply Graph – Tutorial for Dummies</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-19 @ 21:29:13</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43417511"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43414405">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43414405"
              >Launch HN: Modernbanc (YC W20) – Modern and fast accounting
              software</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-19 @ 16:50:05</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43414405"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
            <div class="text">
              <a href="https://modernbanc.com">https://modernbanc.com</a>).
              Today we’re introducing our modern accounting software designed
              for startups and small businesses. Here’s a demo video:
              <a href="https://www.youtube.com/watch?v=gLkJ-6liTNU"
                >https://www.youtube.com/watch?v=gLkJ-6liTNU</a
              >
              <p>
                If you're familiar with the issue tracker Linear, think of it as
                Linear for accounting software. It is fast, works offline, and
                saves you time with automated bookkeeping, accounting and
                invoicing.
              </p>
              <p>
                This is our third pivot. Previously, we built infrastructure
                like a ledger API and payments vault to help companies create
                fintech products.
              </p>
              <p>
                For this idea, our motivation came from two completely opposite
                experiences: using Linear and using Quickbooks. The difference
                in quality between the two products was shocking, and despite
                there being dozens of accounting tools, none come even close to
                the quality of Linear, Notion, or Figma.
              </p>
              <p>
                With Linear, I’ve heard stories of engineers threatening to quit
                if their company switches to another tool! With Quickbooks it
                takes me so long to get to the right page that sometimes I
                forget why I opened it.
              </p>
              <p>
                This was baffling to us because accounting is the core system of
                every business—it tells you what you have, what you made, and
                whether you’ll still be around in 12 months.
              </p>
              <p>
                To solve this, we took a Linear-like approach, focusing on speed
                and quality from day one. For example, we built our own in-house
                real-time sync engine to ensure it’s lightning fast, works
                offline, and keeps your business finances at your fingertips.
              </p>
              <p>
                Modernbanc is still early and doesn’t have every feature yet,
                but we believe we’ve built a long-term foundation for the best
                accounting software in the world. It even includes a built-in
                spreadsheet so you’re never limited in reporting.
              </p>
              <p>
                Although early, the software is already useful and helps
                founders: Automate bookkeeping effortlessly. Transaction rules
                and AI smart actions handle the work for you. Get answers to any
                question, including runway, burn, and custom budgets, all in one
                place; Create and manage invoices. Our AI will auto-match
                incoming payments to them; Be tax-ready with all the data
                available for seamless tax filing. And if you don’t have an
                accountant, we’ll find you one!
              </p>
              <p>
                We’ll have more releases in the coming weeks including receipts
                matching, payroll integrations and AI-powered report generation.
              </p>
              <p>
                We’ve just launched (mainly focusing on smaller US-based
                startups) and would love your feedback! Please give it a go at
                <a href="https://modernbanc.com">https://modernbanc.com</a>
                (you’ll see a demo workspace once you sign-up).
              </p>
              <p>
                We’d love your feedback! If you’ve ever been frustrated by
                accounting software, what has been the worst part? What features
                are missing? Have you ever had to rely on a spreadsheet because
                your accounting tool could not do what you needed? We are still
                early, so your input will help shape what we build next. If you
                have thoughts, frustrations, or ideas, we would love to hear
                them!
              </p>
            </div>
          </section>
        </section>
        <section id="43414393">
          <h3>
            <a class="item" href="https://ezyang.github.io/ai-blindspots/"
              >AI Blindspots – Blindspots in LLMs I've noticed while AI
              coding</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-19 @ 16:48:32</span
              ><span class="points-container"
                >Points: <span class="points">451</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43414393"
                  >Comments</a
                ><span class="descendants">: 173</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43414235">
          <h3>
            <a class="item" href="https://unsloth.ai/blog/gemma3"
              >Fine-tune Google's Gemma 3</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-19 @ 16:34:45</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43414235"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43413935">
          <h3>
            <a
              class="item"
              href="https://joe-antognini.github.io/astronomy/daylight"
              >How fast the days are getting longer (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-19 @ 16:13:20</span
              ><span class="points-container"
                >Points: <span class="points">543</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43413935"
                  >Comments</a
                ><span class="descendants">: 190</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43398434">
          <h3>
            <a
              class="item"
              href="https://www.ilograph.com/blog/posts/diagrams-ai-can-and-cannot-generate/"
              >Diagrams AI can, and cannot, generate</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-18 @ 12:09:51</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43398434"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43386973">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-03-dark-oxygen-deep-sea-discovery.html"
              >'Dark oxygen': a deep-sea discovery that has split scientists</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-17 @ 10:40:05</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43386973"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43385127">
          <h3>
            <a
              class="item"
              href="https://www.historytoday.com/archive/feature/restoring-faith-cretes-ancient-minoan-civilisation"
              >Restoring Faith: Crete's Ancient Minoan Civilisation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-17 @ 04:10:08</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43385127"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43379173">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/magazine/archive/2025/04/canadian-national-railroad-graydon-carter/681770/"
              >How My Six Months Working on the Railway Changed My Life</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-16 @ 14:04:44</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43379173"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43378587">
          <h3>
            <a
              class="item"
              href="https://readbunce.com/p/how-i-got-100-off-my-train-travel"
              >How I got 100% off my train travel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-16 @ 12:44:11</span
              ><span class="points-container"
                >Points: <span class="points">218</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43378587"
                  >Comments</a
                ><span class="descendants">: 207</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43378358">
          <h3>
            <a
              class="item"
              href="https://news.err.ee/1609634600/muons-used-to-test-the-condition-of-a-road-bridge-in-estonia"
              >Muons used to test the condition of a road bridge in Estonia</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-16 @ 12:05:53</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43378358"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43378276">
          <h3>
            <a
              class="item"
              href="https://icicle-lang.github.io/posts/2025-02-01-a-time-travelling-optimisation.html"
              >Destructive Updates – A Stitch in Time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-16 @ 11:47:37</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43378276"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
