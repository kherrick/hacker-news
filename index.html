<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40347118">
          <h3>
            <a
              class="item"
              href="https://qz.com/google-cloud-pension-fund-unisuper-1851472990"
              >Google accidentally deleted a $125B pension fund's account</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 19:14:36</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40347118"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40346995">
          <h3>
            <a class="item" href="https://github.com/nkasmanoff/pi-card"
              >Show HN: Pi-C.A.R.D, a Raspberry Pi Voice Assistant</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 19:03:55</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40346995"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>
                It uses distributed models so latency is something I'm working
                on, but I am curious on where this could go, if anywhere.
              </p>
              <p>Very much a WIP. Feedback welcome :-)</p>
            </div>
          </section>
        </section>
        <section id="40346677">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/amazon-autonomous-vehicle-investigation-crashes-zoox-45c53600710407bc6f82b0a855c46e12"
              >Amazon's self-driving taxi Zoox under investigation by US after
              rear-end crashes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 18:36:09</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40346677"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40346597">
          <h3>
            <a
              class="item"
              href="https://aws.amazon.com/about-aws/whats-new/2024/05/amazon-s3-no-charge-http-error-codes/"
              >Amazon S3 will no longer charge for several HTTP error codes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 18:30:00</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40346597"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40346148">
          <h3>
            <a class="item" href="https://www.fornaxis.org/forge/"
              >Language, OS and GUI -independent windowing API provided as a
              virtual filesystem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 17:53:44</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40346148"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40346024">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/ca/newsroom/2024/05/apple-and-google-deliver-support-for-unwanted-tracking-alerts-in-ios-and-android/"
              >Apple and Google deliver support for unwanted tracking alerts in
              iOS and Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 17:46:28</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40346024"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40345775">
          <h3>
            <a class="item" href="https://openai.com/index/hello-gpt-4o/"
              >GPT-4o</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 17:28:00</span
              ><span class="points-container"
                >Points: <span class="points">1066</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40345775"
                  >Comments</a
                ><span class="descendants">: 748</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40345696">
          <h3>
            <a class="item" href="https://github.com/pipecat-ai/pipecat"
              >Show HN: An open source framework for voice assistants</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 17:21:14</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40345696"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
            <div class="text">
              <p>
                On the theory that something like a LlamaIndex or LangChain for
                real-time/conversational AI would be useful, a few of us started
                working on a Python library for voice (and multimodal) AI
                assistants/agents.
              </p>
              <p>
                So ... Pipecat: a framework for building things like personal
                coaches, meeting assistants, story-telling toys for kids,
                customer support bots, virtual friends, and snarky social bots.
              </p>
              <p>
                Most of the core contributors to Pipecat so far work together at
                our day jobs. This has been a kind of "20% time" thing at our
                company. But we're serious about welcoming all contributions. We
                want Pipecat to support any and all models, services, transport
                layers, and infrastructure tooling. If you're interested in this
                stuff, please check it out and let us know what you think.
                Submit PRs. Become a maintainer. Join the Discord. Post cool
                stuff. Post funny stuff when your voice agent goes completely
                off the rails (as mine sometimes do).
              </p>
            </div>
          </section>
        </section>
        <section id="40345654">
          <h3>
            <a class="item" href="https://chaphlagical.icu/Deblur-GS/"
              >Deblur-GS: 3D Gaussian Splatting from Camera Motion Blurred
              Images</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 17:16:54</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40345654"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40345627">
          <h3>
            <a
              class="item"
              href="https://twitter.com/DiscordPreviews/status/1790065494432608432"
              >Discord has been using ML to determine the gender and age of some
              of its users</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 17:14:50</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40345627"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40345596">
          <h3>
            <a
              class="item"
              href="https://twitter.com/xoseperez/status/1790031351443341357"
              >Raspberry Pi CM5 seen in the wild</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 17:12:48</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40345596"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40345460">
          <h3>
            <a
              class="item"
              href="https://www.notion.so/activeloop/Careers-Activeloop-9dad048520b6452e8954830d61250c5a"
              >Activeloop (YC S18) Hiring a Senior C++ Engineer with Data
              Streaming Experience</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 17:02:12</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40344946">
          <h3>
            <a class="item" href="https://dotat.at/@/2024-05-13-what-ident.html"
              >Unix version control lore: what, ident</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 16:17:20</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40344946"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40344837">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=9ag0fPMmYPQ"
              >Mojo: Ownership and lifetime checks deep dive with Chris Lattner
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 16:06:30</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40344837"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40344581">
          <h3>
            <a class="item" href="https://github.com/ogxd/gxhash"
              >GxHash is a fast and robust non-cryptographic hashing
              algorithm</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 15:42:12</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40344581"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40344302">
          <h3>
            <a
              class="item"
              href="https://www.tii.ae/news/falcon-2-uaes-technology-innovation-institute-releases-new-ai-model-series-outperforming-metas"
              >Falcon 2</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 15:17:26</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40344302"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40343131">
          <h3>
            <a
              class="item"
              href="https://github.com/paradedb/paradedb/tree/dev/pg_lakehouse"
              >Pg_lakehouse: Query Any Data Lake from Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 13:29:17</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40343131"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40342843">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-01410-z"
              >2.4M person study: Internet use boosts, not hurts, well being</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 13:00:49</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40342843"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40342803">
          <h3>
            <a class="item" href="https://www.val.town/v/maxm/staticChess"
              >Static Chess</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 12:56:34</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40342803"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40342578">
          <h3>
            <a
              class="item"
              href="https://apps.npr.org/plant-hardiness-garden-map/"
              >The USDA's gardening zones shifted, this map shows you what's
              changed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 12:32:41</span
              ><span class="points-container"
                >Points: <span class="points">356</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40342578"
                  >Comments</a
                ><span class="descendants">: 161</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40340642">
          <h3>
            <a
              class="item"
              href="https://rouninmedia.github.io/protecting-your-email-address-via-svg-instead-of-js/"
              >Protecting your email address via SVG instead of JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 07:33:57</span
              ><span class="points-container"
                >Points: <span class="points">235</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40340642"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40340417">
          <h3>
            <a
              class="item"
              href="https://newbooksnetwork.com/just-here-for-the-comments"
              >Just Here for the Comments: Lurking as Digital Literacy
              Practice</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 06:52:07</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40340417"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40339998">
          <h3>
            <a class="item" href="https://www.gnu.org/software/librejs/"
              >GNU LibreJS: blocks JavaScript traps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-13 @ 05:12:54</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40339998"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40338443">
          <h3>
            <a class="item" href="https://www.macrelix.org/"
              >MacRelix – Unix-like features for classic Mac OS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-12 @ 23:47:18</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40338443"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40337936">
          <h3>
            <a
              class="item"
              href="https://hazyresearch.stanford.edu/blog/2024-05-12-tk"
              >GPUs Go Brrr</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-12 @ 22:05:58</span
              ><span class="points-container"
                >Points: <span class="points">992</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40337936"
                  >Comments</a
                ><span class="descendants">: 219</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40337933">
          <h3>
            <a class="item" href="https://www.pdfequips.com/"
              >I built an online PDF management platform using open-source
              software</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-12 @ 22:05:30</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40337933"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40334309">
          <h3>
            <a
              class="item"
              href="https://hardforum.com/threads/bitboys.1973024/"
              >The Myth of Loss: Bitboys</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-12 @ 13:32:01</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40334309"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40333584">
          <h3>
            <a
              class="item"
              href="https://gopher.floodgap.com/overbite/relevance.html"
              >Overbite Project: Why still use Gopher? What makes Gopher
              relevant?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-12 @ 11:37:11</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40333584"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40333408">
          <h3>
            <a class="item" href="https://orloj.org/orloj/"
              >Pražský Orloj: Prague astronomical clock simulator. (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-12 @ 10:42:02</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40333408"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40332586">
          <h3>
            <a
              class="item"
              href="http://gamelab.mit.edu/games/a-slower-speed-of-light/"
              >A Slower Speed of Light (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-12 @ 06:27:34</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40332586"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
