<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43999748">
          <h3>
            <a
              class="item"
              href="https://hueffner.de/falk/blog/a-leap-year-check-in-three-instructions.html"
              >A leap year check in three instructions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 21:57:19</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43999748"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43998707">
          <h3>
            <a class="item" href="https://codeberg.org/unspeaker/tek"
              >Tek – A music making program for 24-bit Unicode terminals</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 19:56:59</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43998707"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43998597">
          <h3>
            <a
              class="item"
              href="https://www.complete.org/old-and-small-technology/"
              >Old and Small Technology</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 19:46:38</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43998597"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43998472">
          <h3>
            <a class="item" href="https://sketch.dev/blog/agent-loop"
              >The unreasonable effectiveness of an LLM agent loop with tool
              use</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 19:33:44</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43998472"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43998423">
          <h3>
            <a
              class="item"
              href="https://www.orsolabs.com/post/refactoring-clojure-1/"
              >Refactoring Clojure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 19:28:01</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43998423"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43998115">
          <h3>
            <a
              class="item"
              href="https://ahelwer.ca/post/2025-05-15-tla-dev-status/"
              >The current state of TLA⁺ development</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 18:53:55</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43998115"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43998008">
          <h3>
            <a
              class="item"
              href="https://computeradsfromthepast.substack.com/p/dr-dobbs-journal-interviews-jef-raskin"
              >Dr. Dobb's Journal Interviews Jef Raskin (1986)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 18:43:43</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43998008"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43997830">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/05/15/world/europe/harvard-law-magna-carta-original.html"
              >Harvard Law paid $27 for a copy of Magna Carta. It's an
              original</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 18:26:29</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43997830"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43997636">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/05/15/health/gene-editing-personalized-rare-disorders.html"
              >Baby is healed with first personalized gene-editing treatment</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 18:06:06</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43997636"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43997286">
          <h3>
            <a
              class="item"
              href="https://www.mbid.me/posts/stop-using-rest-for-state-synchronization/"
              >Stop using REST for state synchronization (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 17:30:03</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43997286"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43996980">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/fetii/jobs/QDjleWs-senior-operations-manager-fetii"
              >Fetii (YC S22) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 17:00:07</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43996796">
          <h3>
            <a
              class="item"
              href="https://resobscura.substack.com/p/onfims-world-medieval-child-artists"
              >Onfim's world: Child artists in history</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 16:43:20</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43996796"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43996555">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43996555"
              >Launch HN: Tinfoil (YC X25): Verifiable Privacy for Cloud AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 16:19:00</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43996555"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
            <div class="text">
              <a href="https://tinfoil.sh">https://tinfoil.sh</a>. We host
              models and AI workloads on the cloud while guaranteeing zero data
              access and retention. This lets us run open-source LLMs like
              Llama, or Deepseek R1 on cloud GPUs without you having to trust
              us—or any cloud provider—with private data.
              <p>
                Since AI performs better the more context you give it, we think
                solving AI privacy will unlock more valuable AI applications,
                just how TLS on the Internet enabled e-commerce to flourish
                knowing that your credit card info wouldn't be stolen by someone
                sniffing internet packets.
              </p>
              <p>
                We come from backgrounds in cryptography, security, and
                infrastructure. Jules did his PhD in trusted hardware and
                confidential computing at MIT, and worked with NVIDIA and
                Microsoft Research on the same, Sacha did his PhD in
                privacy-preserving cryptography at MIT, Nate worked on privacy
                tech like Tor, and I (Tanya) was on Cloudflare's cryptography
                team. We were unsatisfied with band-aid techniques like PII
                redaction (which is actually undesirable in some cases like AI
                personal assistants) or “pinky promise” security through legal
                contracts like DPAs. We wanted a real solution that replaced
                trust with provable security.
              </p>
              <p>
                Running models locally or on-prem is an option, but can be
                expensive and inconvenient. Fully Homomorphic Encryption (FHE)
                is not practical for LLM inference for the foreseeable future.
                The next best option is using secure enclaves: a secure
                environment on the chip that no other software running on the
                host machine can access. This lets us perform LLM inference in
                the cloud while being able to prove that no one, not even
                Tinfoil or the cloud provider, can access the data. And because
                these security mechanisms are implemented in hardware, there is
                minimal performance overhead.
              </p>
              <p>
                Even though we (Tinfoil) control the host machine, we do not
                have any visibility into the data processed inside of the
                enclave. At a high level, a secure enclave is a set of cores
                that are reserved, isolated, and locked down to create a
                sectioned off area. Everything that comes out of the enclave is
                encrypted: memory and network traffic, but also peripheral
                (PCIe) traffic to other devices such as the GPU. These
                encryptions are performed using secret keys that are generated
                inside the enclave during setup, which never leave its
                boundaries. Additionally, a “hardware root of trust” baked into
                the chip lets clients check security claims and verify that all
                security mechanisms are in place.
              </p>
              <p>
                Up until recently, secure enclaves were only available on CPUs.
                But NVIDIA confidential computing recently added these
                hardware-based capabilities to their latest GPUs, making it
                possible to run GPU-based workloads in a secure enclave.
              </p>
              <p>Here’s how it works in a nutshell:</p>
              <p>
                1. We publish the code that should run inside the secure enclave
                to Github, as well as a hash of the compiled binary to a
                transparency log called Sigstore
              </p>
              <p>
                2. Before sending data to the enclave, the client fetches a
                signed document from the enclave which includes a hash of the
                running code signed by the CPU manufacturer. It then verifies
                the signature with the hardware manufacturer to prove the
                hardware is genuine. Then the client fetches a hash of the
                source code from a transparency log (Sigstore) and checks that
                the hash equals the one we got from the enclave. This lets the
                client get verifiable proof that the enclave is running the
                exact code we claim.
              </p>
              <p>
                3. With the assurance that the enclave environment is what we
                expect, the client sends its data to the enclave, which travels
                encrypted (TLS) and is only decrypted inside the enclave.
              </p>
              <p>
                4. Processing happens entirely within this protected
                environment. Even an attacker that controls the host machine
                can’t access this data. We believe making end-to-end
                verifiability a “first class citizen” is key. Secure enclaves
                have traditionally been used to remove trust from the cloud
                provider, not necessarily from the application provider. This is
                evidenced by confidential VM technologies such as Azure
                Confidential VM allowing ssh access by the host into the
                confidential VM. Our goal is to provably remove trust both from
                ourselves, aka the application provider, as well as the cloud
                provider.
              </p>
              <p>
                We encourage you to be skeptical of our privacy claims.
                Verifiability is our answer. It’s not just us saying it’s
                private; the hardware and cryptography let you check. Here’s a
                guide that walks you through the verification process:
                <a
                  href="https://docs.tinfoil.sh/verification/attestation-architecture"
                  >https://docs.tinfoil.sh/verification/attestation-architectur...</a
                >.
              </p>
              <p>
                People are using us for analyzing sensitive docs, building
                copilots for proprietary code, and processing user data in
                agentic AI applications without the privacy risks that
                previously blocked cloud AI adoption.
              </p>
              <p>We’re excited to share Tinfoil with HN!</p>
              <p>
                * Try the chat (<a href="https://tinfoil.sh/chat"
                  >https://tinfoil.sh/chat</a
                >): It verifies attestation with an in-browser check. Free,
                limited messages, $20/month for unlimited messages and
                additional models
              </p>
              <p>
                * Use the API (<a href="https://tinfoil.sh/inference"
                  >https://tinfoil.sh/inference</a
                >): OpenAI API compatible interface. $2 / 1M tokens
              </p>
              <p>
                * Take your existing Docker image and make it end to end
                confidential by deploying on Tinfoil. Here's a demo of how you
                could use Tinfoil to run a deepfake detection service that could
                run securely on people's private videos:
                <a href="https://www.youtube.com/watch?v=_8hLmqoutyk"
                  >https://www.youtube.com/watch?v=_8hLmqoutyk</a
                >. Note: This feature is not currently self-serve.
              </p>
              <p>
                * Reach out to us at contact@tinfoil.sh if you want to run a
                different model or want to deploy a custom application, or if
                you just want to learn more!
              </p>
              <p>
                Let us know what you think, we’d love to hear about your
                experiences and ideas in this space!
              </p>
            </div>
          </section>
        </section>
        <section id="43996431">
          <h3>
            <a class="item" href="https://dynomight.net/numpy/"
              >I don't like NumPy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 16:05:22</span
              ><span class="points-container"
                >Points: <span class="points">295</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43996431"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43996307">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2025/05/15/coinbase-says-hackers-bribed-staff-to-steal-customer-data-and-are-demanding-20-million-ransom.html"
              >Coinbase says hackers bribed staff to steal customer data,
              demanding $20M ransom</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 15:52:21</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43996307"
                  >Comments</a
                ><span class="descendants">: 283</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43996251">
          <h3>
            <a class="item" href="https://undetectag.com/"
              >Show HN: Undetectag, track stolen items with AirTag</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 15:46:26</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43996251"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
            <div class="text"><p>What do you think?</p></div>
          </section>
        </section>
        <section id="43996243">
          <h3>
            <a
              class="item"
              href="https://www.asimov.press/p/model-organisms-are-not-static"
              >Model Organisms Are Not Static</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 15:45:43</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43996243"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43996031">
          <h3>
            <a class="item" href="https://www.alexbowe.com/wavelet-trees/"
              >Wavelet Trees: An Introduction (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 15:27:04</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43996031"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43995144">
          <h3>
            <a
              class="item"
              href="https://blog.papey.fr/post/07-demystifying-ruby-01/"
              >Demystifying Ruby: It's all about threads (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 13:56:47</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43995144"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43995122">
          <h3>
            <a class="item" href="https://useautumn.com/blog/backendless"
              >How we made billing backendless</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 13:54:23</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43995122"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43995005">
          <h3>
            <a class="item" href="https://eoinmurray.info/boltzmann-machine"
              >A Tiny Boltzmann Machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 13:41:37</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43995005"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43994987">
          <h3>
            <a class="item" href="https://github.com/marv1nnnnn/llm-min.txt"
              >Show HN: Min.js style compression of tech docs for LLM context</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 13:40:04</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43994987"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43994827">
          <h3>
            <a class="item" href="https://github.com/axbycc/LiveSplat"
              >Show HN: Real-Time Gaussian Splatting</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 13:26:49</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43994827"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
            <div class="text">
              LiveSplat is a system for turning RGBD camera streams into
              Gaussian splat scenes in real-time. The system works by passing
              all the RGBD frames into a feed forward neural net that outputs
              the current scene as Gaussian splats. These splats are then
              rendered in real-time. I've put together a demo video at the link
              above.
            </div>
          </section>
        </section>
        <section id="43994765">
          <h3>
            <a
              class="item"
              href="https://www.clientserver.dev/p/malicious-compliance-by-booking-an"
              >Malicious compliance by booking an available meeting room</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 13:20:28</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43994765"
                  >Comments</a
                ><span class="descendants">: 264</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43994333">
          <h3>
            <a
              class="item"
              href="https://juhrjuhr.itch.io/deep-space-exploitation/devlog/945428/9-pathfinding"
              >Pathfinding</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-15 @ 12:32:15</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43994333"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43988753">
          <h3>
            <a
              class="item"
              href="https://matklad.github.io/2025/05/14/scalar-select-aniti-pattern.html"
              >The Scalar Select Anti-Pattern</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-14 @ 20:19:23</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43988753"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43973964">
          <h3>
            <a
              class="item"
              href="https://daniel.haxx.se/blog/2022/05/12/a-tale-of-a-trailing-dot/"
              >A Tale of a Trailing Dot (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 15:24:26</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43973964"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43972485">
          <h3>
            <a class="item" href="https://davelucia.com/blog/lua-elixir"
              >Lua for Elixir</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 13:03:51</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43972485"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43971678">
          <h3>
            <a
              class="item"
              href="https://research.google/blog/ml-enhanced-code-completion-improves-developer-productivity/"
              >ML-Enhanced Code Completion Improves Developer Productivity
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 11:20:49</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43971678"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43970768">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-fastest-way-yet-to-color-graphs-20250512/"
              >The Fastest Way yet to Color Graphs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-13 @ 08:29:10</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43970768"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
