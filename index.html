<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43853382">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2025/04/29/north_korea_worker_interview_questions/"
              >The one interview question that will protect you from North
              Korean fake workers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 03:21:55</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43853382"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43853297">
          <h3>
            <a
              class="item"
              href="https://www.jsonline.com/story/news/crime/2025/04/25/milwaukee-police-considering-trading-mugshots-for-facial-recognition-tech/83084223007/"
              >Milwaukee police considering trading mugshots for facial
              recognition tech</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 03:05:25</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43853297"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43853188">
          <h3>
            <a
              class="item"
              href="https://twitter.com/WyzeCam/status/1917662183036706849"
              >Wyze pays $255k of tariffs on $167k of floodlights</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 02:40:14</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43853188"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43853118">
          <h3>
            <a
              class="item"
              href="https://www.fastcompany.com/91324241/this-company-built-an-entire-rail-terminal-in-queens-to-avoid-relying-on-trucks"
              >Company built its own rail terminal in NYC to avoid relying on
              trucks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 02:26:16</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43853118"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43852771">
          <h3>
            <a class="item" href="https://csvforge.com"
              >Show HN: Convert Large CSV/XLSX to JSON or XML in Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 01:31:19</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43852771"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <p>
                Here's a few things that makes this converter different: - runs
                in the browser - all parsing and conversion is client side can
                handle data any size data - automatically detects delimiters,
                encodings, and data types as it parses - Live preview with
                column renaming, search/replace, and data cleanup - Export to
                JSON or XML â€” clean, structured output that can be used for API
                or Databases
              </p>
              <p>
                backstory: I built this tool for myself. I work with massive CSV
                and TXT files, some over 10GB, and opening them in Excel would
                freeze my laptop, some of the online converters only limits to a
                certain size, so I started learning Python and pandas but ended
                up wasting so much time trying different delimiters or fixing
                badly structured data just to make it usable, and I thought this
                would be a really fun project to build
              </p>
              <p>I'd love some feedback. Thank you</p>
              <p>
                URL: <a href="https://csvforge.com">https://csvforge.com</a>
              </p>
            </div>
          </section>
        </section>
        <section id="43852564">
          <h3>
            <a
              class="item"
              href="https://azure.microsoft.com/en-us/blog/one-year-of-phi-small-language-models-making-big-leaps-in-ai/"
              >Phi-4 Reasoning Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 01:02:41</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43852564"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43852548">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/gromo/jobs/aP4JS9K-product-tech-business-ai-enthusiasts"
              >GroMo (YC W21) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 01:01:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43852527">
          <h3>
            <a class="item" href="https://stockhausenspace.blogspot.com/"
              >Stockhausen: Sounds in Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 00:57:42</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43852527"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43852266">
          <h3>
            <a
              class="item"
              href="https://www.hirox-europe.com/gigapixel/girl-with-a-pearl-earring/"
              >108B Pixel Scan of Johannes Vermeer's Girl with a Pearl
              Earring</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 00:22:01</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43852266"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43852220">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/04/30/world/julia-parsons-dead.html"
              >Julia Parsons, U.S. Navy Code Breaker During World War II, Dies
              at 104</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 00:16:49</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43852220"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43852145">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/tech/apple-violated-antitrust-ruling-federal-judge-finds-66b85957"
              >Apple violated antitrust ruling, judge finds</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-01 @ 00:03:55</span
              ><span class="points-container"
                >Points: <span class="points">562</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43852145"
                  >Comments</a
                ><span class="descendants">: 186</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43852096">
          <h3>
            <a
              class="item"
              href="https://jessie.cafe/posts/pwning-ladybirds-libjs/"
              >Pwning the Ladybird Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 23:59:09</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43852096"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43851612">
          <h3>
            <a
              class="item"
              href="https://www.electrospaces.net/2025/04/how-us-defense-secretary-hegseth.html"
              >How the US defense secretary circumvents official DoD
              communications equipment</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 22:54:07</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43851612"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43851314">
          <h3>
            <a
              class="item"
              href="https://www.espressif.com/en/news/ESP32-C5_Mass_Production"
              >Espressif's ESP32-C5 Is Now in Mass Production</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 22:15:21</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43851314"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43851099">
          <h3>
            <a
              class="item"
              href="https://www.inceptionlabs.ai/introducing-mercury"
              >Mercury: Commercial-scale diffusion language model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 21:51:10</span
              ><span class="points-container"
                >Points: <span class="points">268</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43851099"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43850238">
          <h3>
            <a class="item" href="https://chipsandcheese.com/p/zhaoxins-kx-7000"
              >Zhaoxin's KX-7000</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 20:23:33</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43850238"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43849536">
          <h3>
            <a class="item" href="https://lemonyte.com/blog/beamng-malware"
              >I Found Malware in a BeamNG Mod</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 19:17:28</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43849536"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43849373">
          <h3>
            <a class="item" href="https://hoefler.dev/articles/vsock.html"
              >Linux Kernel Exploitation: Attack of the Vsock</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 19:03:04</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43849373"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43849271">
          <h3>
            <a class="item" href="https://osuosl.org/blog/osl-future/"
              >Future of OSU Open Source Lab in Jeopardy</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 18:51:52</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43849271"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43848398">
          <h3>
            <a
              class="item"
              href="https://tennysontbardwell.com/blog/2025/04/30/mechanical-computing/index.html"
              >Reversible computing with mechanical links and pivots</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 17:35:08</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43848398"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43848325">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/google-labs/notebooklm-audio-overviews-50-languages/"
              >NotebookLM Audio Overviews are now available in over 50
              languages</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 17:28:38</span
              ><span class="points-container"
                >Points: <span class="points">255</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43848325"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43847432">
          <h3>
            <a
              class="item"
              href="https://github.com/deepseek-ai/DeepSeek-Prover-V2"
              >DeepSeek-Prover-V2</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 16:23:28</span
              ><span class="points-container"
                >Points: <span class="points">326</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43847432"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43846964">
          <h3>
            <a class="item" href="https://promptrepo.com/finetune/"
              >Show HN: Create your own finetuned AI model using Google
              Sheets</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 15:53:36</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43846964"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <p>
                We built Promptrepo to make finetuning accessible to product
                teams â€” not just ML engineers. Last week, OpenAIâ€™s CPO shared
                how they use fine-tuning for everything from customer support to
                deep research, and called it the future for serious AI teams.
                Yet most teams I know still rely on prompting, because
                fine-tuning is too technical, while the people who have the
                training data (product managers and domain experts) are often
                non-technical. With Promptrepo, they can now:
              </p>
              <p>- Add training examples in Google Sheets</p>
              <p>- Click a button to train</p>
              <p>- Deploy and test instantly</p>
              <p>- Use OpenAI, Claude, Gemini or Llama models</p>
              <p>
                Weâ€™ve used this internally for years to power AI workflows in
                our products (Formfacade, Formesign, Neartail), and we're now
                opening it up to others. Would love your feedback and happy to
                answer any questions!
              </p>
              <p>---</p>
              <p>
                Try it free -
                <a href="https://promptrepo.com/finetune"
                  >https://promptrepo.com/finetune</a
                >
              </p>
              <p>
                Demo video -
                <a href="https://www.youtube.com/watch?v=e1CTin1bD0w"
                  >https://www.youtube.com/watch?v=e1CTin1bD0w</a
                >
              </p>
              <p>
                Why we built it -
                <a
                  href="https://guesswork.co/support/post/fine-tuning-is-the-future-and-now-its-within-every.anc-ddfd2598-5798-423d-b6ec-e7d84e98847a.html"
                  >https://guesswork.co/support/post/fine-tuning-is-the-future-...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43846487">
          <h3>
            <a
              class="item"
              href="https://jayd.ml/2025/04/30/someone-at-youtube-needs-glasses.html"
              >Someone at YouTube needs glasses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 15:18:47</span
              ><span class="points-container"
                >Points: <span class="points">1087</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43846487"
                  >Comments</a
                ><span class="descendants">: 582</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43842683">
          <h3>
            <a class="item" href="https://github.com/XiaomiMiMo/MiMo"
              >Xiaomi MiMo Reasoning Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 08:48:20</span
              ><span class="points-container"
                >Points: <span class="points">422</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43842683"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43842306">
          <h3>
            <a class="item" href="https://habr.com/en/articles/905812/"
              >I created Perfect Wiki and reached $250k in annual revenue
              without investors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 07:45:51</span
              ><span class="points-container"
                >Points: <span class="points">600</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43842306"
                  >Comments</a
                ><span class="descendants">: 342</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43840842">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/sycophancy-in-gpt-4o/"
              >Sycophancy in GPT-4o</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 03:06:26</span
              ><span class="points-container"
                >Points: <span class="points">514</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43840842"
                  >Comments</a
                ><span class="descendants">: 406</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43840193">
          <h3>
            <a class="item" href="https://www.jasonthorsness.com/25"
              >You Wouldn't Download a Hacker News</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-30 @ 01:26:31</span
              ><span class="points-container"
                >Points: <span class="points">388</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43840193"
                  >Comments</a
                ><span class="descendants">: 202</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43833195">
          <h3>
            <a
              class="item"
              href="https://jepsen.io/analyses/amazon-rds-for-postgresql-17.4"
              >Jepsen: Amazon RDS for PostgreSQL 17.4</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-29 @ 14:30:11</span
              ><span class="points-container"
                >Points: <span class="points">582</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43833195"
                  >Comments</a
                ><span class="descendants">: 139</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43827054">
          <h3>
            <a
              class="item"
              href="https://danfabulich.medium.com/all-four-major-web-browsers-are-about-to-lose-80-of-their-funding-0e42ceb358f1"
              >All four major web browsers are about to lose 80% of their
              funding</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-28 @ 23:03:19</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43827054"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
