<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39386156">
          <h3>
            <a class="item" href="https://openai.com/sora"
              >Sora: Creating video from text</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 18:14:18</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39386156"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39386092">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/technology/2024/02/15/kids-online-safety-act-kosa-senate/"
              >Senate Poised to Pass Kids Online Safety Act KOSA</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 18:09:11</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39386092"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39385809">
          <h3>
            <a
              class="item"
              href="https://llm-academic-speech-data.catalystresearch.io/"
              >University of Michigan selling student speech and papers as LLM
              training data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 17:48:51</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39385809"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39385739">
          <h3>
            <a
              class="item"
              href="https://twitter.com/spatialweeb/status/1757581115609817236"
              >Unreal Engine 5 ported to WebGPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 17:45:07</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39385739"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39385635">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39385635"
              >Launch HN: Zenfetch (YC W23) – Turn notes/browser history into a
              GPT assistant</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 17:39:48</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39385635"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.zenfetch.com">https://www.zenfetch.com</a>) -
              a Chrome extension that transforms your saved web browsing into a
              personal chatGPT and search engine. Here’s a demo video:
              <a
                href="https://www.loom.com/share/abe9d40dc82545a482be55b631f9bf2a?sid=53fb1432-0c59-4c08-93aa-3b3184363cc3"
                >https://www.loom.com/share/abe9d40dc82545a482be55b631f9bf2a?...</a
              >
              <p>
                How it works: (1) Optionally import your existing saved web
                browsing through one of our integrations or through a URL CSV
                import. (2) Click the Zenfetch icon in a tab to save any PDF,
                YouTube video, note, article, email, forum post, etc. Zenfetch
                can save almost anything across the internet. (3) Zenfetch
                indexes the text or transcript and adds that information to your
                personal knowledge assistant. This is done on your computer so
                you don’t have to worry about paywalls, logins, etc. (4) Use the
                dashboard or side panel to search your knowledge or chat with
                your personal knowledge assistant.
              </p>
              <p>
                We built Zenfetch to solve our personal problem: we were reading
                tons of content but using little to none of the information.
                While searching for solutions, we found that most tools were
                good at storing information but not at retrieving it. We even
                found that search functionalities on existing read-later tools
                got worse the more content we saved.
              </p>
              <p>
                A few examples of how our users use Zenfetch: “What was that
                article I read on the new nuclear fusion company?”, “Analyze
                this strategy based on the Lenny Rachitsky article I read”,
                “Summarize Karpathys video introducing LLMs”, “Which research
                papers mentioned the increase in carbon emissions?”, “Compile
                the different perspectives I’ve read on climate change”, and
                more.
              </p>
              <p>
                Zenfetch is free for the first 14 days and then costs $14.99/mo
                (No credit card needed for the trial).
              </p>
              <p>
                We’d love for you to try it out and let us know what we can do
                to improve your experience! While we only work on Chromium-based
                browsers right now, we’re actively working on browser
                compatibility and integrations. Let us know which ones to
                prioritize!
              </p>
            </div>
          </section>
        </section>
        <section id="39385301">
          <h3>
            <a
              class="item"
              href="https://www.vice.com/en/article/4a388g/flipper-zero-ban-canada-hacking-car-thefts"
              >Feds want to ban the Flipper Zero – Experts say it's a
              scapegoat</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 17:15:08</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39385301"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39385121">
          <h3>
            <a class="item" href="https://www.finleycms.com/careers/"
              >Finley (YC W21) Is a Fintech Hiring Software Engineers (US
              Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 17:00:21</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39385043">
          <h3>
            <a
              class="item"
              href="https://timesofsandiego.com/military/2024/02/14/air-force-oks-autonomous-cargo-flights-across-california-after-successful-test/"
              >Air Force OKs Autonomous Cargo Flights Across California After
              Successful Test</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 16:54:28</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39385043"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39384731">
          <h3>
            <a
              class="item"
              href="https://512pixels.net/projects/default-mac-wallpapers-in-5k/"
              >Every Default macOS Wallpaper</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 16:29:39</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39384731"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39383798">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2024/02/asahi-linux-projects-opengl-support-on-apple-silicon-officially-surpasses-apples/"
              >Asahi Linux project's OpenGL support on Apple Silicon officially
              surpasses Apple</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 15:26:37</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39383798"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39383739">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41370-024-00643-4"
              >Chlormequat in food and urine from adults in the United States
              from 2017 to 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 15:22:36</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39383739"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39383593">
          <h3>
            <a
              class="item"
              href="https://twitter.com/JeffDean/status/1758146022726041615"
              >Gemini 1.5 Pro</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 15:12:36</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39383593"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39383446">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/ai/google-gemini-next-generation-model-february-2024/"
              >Our next-generation model: Gemini 1.5</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 15:02:09</span
              ><span class="points-container"
                >Points: <span class="points">443</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39383446"
                  >Comments</a
                ><span class="descendants">: 269</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39383386">
          <h3>
            <a class="item" href="https://observablehq.com/blog/observable-2-0"
              >Observable 2.0, a static site generator for data apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 14:57:49</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39383386"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39383246">
          <h3>
            <a class="item" href="https://www.justship.today/"
              >Show HN: Just Ship, a free and open source SvelteKit SaaS
              boilerplate</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 14:44:18</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39383246"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39382803">
          <h3>
            <a class="item" href="https://dstack.ai/"
              >Show HN: Dstack – an open-source engine for running GPU
              workloads</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 14:03:44</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39382803"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39382281">
          <h3>
            <a
              class="item"
              href="https://twitter.com/birk/status/1758087210211909649"
              >GitHub now officially supports polar.sh as a funding platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 13:15:14</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39382281"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39382264">
          <h3>
            <a
              class="item"
              href="https://consciousdigital.org/deceptive-design-patterns/"
              >How deceptive design is used to compromise your privacy and how
              to fight back</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 13:14:06</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39382264"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39382227">
          <h3>
            <a
              class="item"
              href="https://www.lambdafunctions.com/articles/elixir-and-rust"
              >Managing mutable data in Elixir with Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 13:09:51</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39382227"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39380165">
          <h3>
            <a
              class="item"
              href="https://tsdr.uspto.gov/documentviewer?caseId=sn97733259&amp;docId=FREF20240206125856&amp;linkId=1#docIndex=0&amp;page=1"
              >OpenAI – Application for US trademark “GPT” has failed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 07:52:48</span
              ><span class="points-container"
                >Points: <span class="points">501</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39380165"
                  >Comments</a
                ><span class="descendants">: 226</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39379480">
          <h3>
            <a
              class="item"
              href="https://scarybeastsecurity.blogspot.com/2020/11/reverse-engineering-forgotten-1970s.html"
              >Reverse engineering a forgotten 1970s Intel dual core beast: 8271
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 05:35:48</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39379480"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39379339">
          <h3>
            <a
              class="item"
              href="https://www.aldipricemap.com/navel_oranges.html"
              >Show HN: Aldi Price Map</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 05:09:45</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39379339"
                  >Comments</a
                ><span class="descendants">: 249</span></span
              >
            </h4>
            <div class="text">
              Hi HN, Inspired by the recent discussion on traderjoesprices.com,
              and sites such as mccheapest.com, here is a map of how much does
              it cost to shop (this week's promo items) at Aldi
            </div>
          </section>
        </section>
        <section id="39378773">
          <h3>
            <a class="item" href="https://github.com/valine/NeuralFlow"
              >Show HN: NeuralFlow – Visualize the intermediate output of
              Mistral 7B</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 03:29:20</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39378773"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39377052">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/online-anonymity-study-found-stable-pseudonyms-created-a-more-civil-environment-than-real-user-names-171374"
              >Stable pseudonyms create a more civil environment than real
              names: study (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 23:28:27</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39377052"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39371064">
          <h3>
            <a class="item" href="https://github.com/m31coding/fuzzy-search"
              >Show HN: Frontend Fuzzy Search</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 15:37:24</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39371064"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
            <div class="text">
              <p>
                The implementation is based on 3-grams by the book, augmented
                with a novel trick of sorting the characters within the 3-grams
                for enhanced accuracy. For a detailed explanation you may refer
                to my related blog post at
                <a href="https://www.m31coding.com/blog/fuzzy-search.html"
                  >https://www.m31coding.com/blog/fuzzy-search.html</a
                >.
              </p>
              <p>Happy Coding!</p>
            </div>
          </section>
        </section>
        <section id="39367763">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/02/14/friction_is_good/"
              >Friction is Good: Let's add it to our digital experiences</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 08:32:20</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39367763"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39366435">
          <h3>
            <a class="item" href="http://macintoshgarden.org/games/portal"
              >Portal (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 04:19:12</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39366435"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39344643">
          <h3>
            <a class="item" href="https://codeberg.org/glowdust/glowdust"
              >Glowdust is a new kind of database management system</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-12 @ 13:44:01</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39344643"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39344568">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-02-behavior-mammals-world.html"
              >Baird's beaked whales found in shallower waters than previously
              observed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-12 @ 13:36:52</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39344568"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39344493">
          <h3>
            <a
              class="item"
              href="https://www.x86matthew.com/view_post?id=mips_1"
              >WoWMIPS – MIPS Emulator for Windows, Part 1: Introduction</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-12 @ 13:27:55</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39344493"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
