<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41566097">
          <h3>
            <a
              class="item"
              href="https://letterstoanewdeveloper.com/2020/01/27/software-is-about-people-not-code/"
              >Software is about people, not code (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 10:07:00</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41566097"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41564009">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2024/09/16/science/voyager-1-thruster-issue/index.html"
              >47-year-old Voyager 1 fired up thrusters it hasn't used in
              decades</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 04:08:54</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41564009"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41564003">
          <h3>
            <a
              class="item"
              href="https://www.downtowndougbrown.com/2024/09/fixing-an-elgato-hd60-s-hdmi-capture-device-with-the-help-of-ghidra/"
              >Fixing an Elgato HD60 S HDMI capture device with the help of
              Ghidra</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 04:06:50</span
              ><span class="points-container"
                >Points: <span class="points">258</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41564003"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41563958">
          <h3>
            <a class="item" href="https://voideditor.com"
              >Show HN: Void, an open-source Cursor/GitHub Copilot
              alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 03:58:29</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41563958"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
            <div class="text">
              <p>
                The hard part: we're building Void as a fork of vscode. The repo
                has great documentation for extensions, but going deeper gets
                pretty involved. All of the code is OOP-based, and they mount
                DOM nodes the old-school way (which is what React was supposed
                to solve..). So adding new UI features isn't exactly trivial.
                Microsoft also made its extension marketplace closed-source so
                we (and Cursor) have to hack our way through it. One thing we're
                excited about is refactoring and creating docs so that it's much
                easier for anyone to contribute.
              </p>
              <p>
                The other benefit of open source is we don't need to hide how
                our prompts are built, so we can transfer the private API logic
                that Cursor has right onto your local machine. This lets you
                host a model on-prem and have your data stay completely private.
                It also means you can go directly to LLM providers (OpenAI,
                Anthropic) instead of going through us as a middleman.
              </p>
              <p>
                There's still a lot to build, and full disclosure, we are very
                early stage. But we're super excited about building and have a
                working prototype that we're quickly adding features to.
              </p>
              <p>
                Let us know if there's anything you want to see in a
                Cursor-style editor. Or feel free to shoot us a pull request.
                Cheers!
              </p>
            </div>
          </section>
        </section>
        <section id="41563626">
          <h3>
            <a class="item" href="https://gwern.net/book-writing"
              >Why to Not Write a Book</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 02:58:35</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41563626"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41563100">
          <h3>
            <a class="item" href="https://github.com/achristmascarl/rainfrog"
              >rainfrog – a database management TUI for Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 01:35:22</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41563100"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41562774">
          <h3>
            <a
              class="item"
              href="https://www.news.uscg.mil/News-by-Region/Headquarters/Titan-Submersible/"
              >Titan Submersible Marine Board of Investigation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 00:42:33</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41562774"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41562673">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2402.12875"
              >Chain of Thought Empowers Transformers to Solve Inherently Serial
              Problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 00:23:17</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41562673"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41562481">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/intel-aws-expand-strategic-collaboration-chip-manufacturing-2024-09-16/"
              >Intel foundry business to make custom chip for Amazon,
              chipmaker's shares jump</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 23:50:50</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41562481"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41562287">
          <h3>
            <a class="item" href="https://github.com/nyxpsi/nyxpsi"
              >Nyxpsi – A Next-Gen Network Protocol for Extreme Packet Loss</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 23:24:57</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41562287"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41562034">
          <h3>
            <a
              class="item"
              href="https://corgea.com/blog/fine-tuning-for-precision-and-privacy-how-corgea-s-llm-enhances-enterprise-application-security"
              >We fine-tuned an LLM to triage and fix insecure code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 22:57:15</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41562034"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41561647">
          <h3>
            <a class="item" href="https://franzelio.franzai.com/"
              >Franzelio: Draw Lines. Make Music. Share Your Instrument</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 22:15:24</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41561647"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41560648">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/how-intel-lost-sony-playstation-business-2024-09-16/"
              >Intel lost the Sony Playstation business to AMD</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 20:43:52</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41560648"
                  >Comments</a
                ><span class="descendants">: 154</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41560343">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=kHiCHRB-RlA"
              >K340A: The Brain Computer of Chernobyl Duga Radar [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 20:21:03</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41560343"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41558554">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2024/09/16/amazon-jassy-tells-employees-to-return-to-office-five-days-a-week.html"
              >Amazon tells employees to return to office five days a week</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 17:44:23</span
              ><span class="points-container"
                >Points: <span class="points">1172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41558554"
                  >Comments</a
                ><span class="descendants">: 1324</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41558081">
          <h3>
            <a
              class="item"
              href="https://arcan-fe.com/2024/09/16/a-spreadsheet-and-a-debugger-walks-into-a-shell/"
              >A Spreadsheet and a Debugger Walk into a Shell</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 16:59:22</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41558081"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41557851">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/09/16/apple-watch-sleep-apnea-detection-gets-fda-approval/"
              >Apple Watch sleep apnea detection gets FDA approval</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 16:35:47</span
              ><span class="points-container"
                >Points: <span class="points">402</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41557851"
                  >Comments</a
                ><span class="descendants">: 276</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41557345">
          <h3>
            <a
              class="item"
              href="https://www.latacora.com/blog/2024/09/13/datomic-and-content-addressable-techniques/"
              >Datomic and Content Addressable Techniques</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 15:53:33</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41557345"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41556519">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41556519"
              >Launch HN: Silurian (YC S24) – Simulate the Earth</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 14:32:38</span
              ><span class="points-container"
                >Points: <span class="points">292</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41556519"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
            <div class="text">
              <a href="https://silurian.ai">https://silurian.ai</a>). Silurian
              builds foundation models to simulate the Earth, starting with the
              weather. Some of our recent hurricane forecasts can be visualized
              at
              <a href="https://hurricanes2024.silurian.ai/"
                >https://hurricanes2024.silurian.ai/</a
              >.
              <p>
                What is it worth to know the weather forecast 1 day earlier?
                That’s not a hypothetical question, traditional forecasting
                systems have been improving their skill at a rate of 1 day per
                decade. In other words, today’s 6-day forecast is as accurate as
                the 5-day forecast ten years ago. No one expects this rate of
                improvement to hold steady, it has to slow down eventually,
                right? Well in the last couple years GPUs and modern deep
                learning have actually sped it up.
              </p>
              <p>
                Since 2022 there has been a flurry of weather deep learning
                systems research at companies like NVIDIA, Google DeepMind,
                Huawei and Microsoft (some of them built by yours truly). These
                models have little to no built-in physics and learn to forecast
                purely from data. Astonishingly, this approach, done correctly,
                produces better forecasts than traditional simulations of the
                physics of our atmosphere.
              </p>
              <p>
                Jayesh and Cris came face-to-face with this technology’s
                potential while they were respectively leading the [ClimaX](<a
                  href="https://arxiv.org/abs/2301.10343"
                  >https://arxiv.org/abs/2301.10343</a
                >) and [Aurora](<a href="https://arxiv.org/abs/2405.13063"
                  >https://arxiv.org/abs/2405.13063</a
                >) projects at Microsoft. The foundation models they built
                improved on the ECMWF’s forecasts, considered the gold standard
                in weather prediction, while only using a fraction of the
                available training data. Our mission at Silurian is to scale
                these models to their full potential and push them to the limits
                of physical predictability. Ultimately, we aim to model all
                infrastructure that is impacted by weather including the energy
                grid, agriculture, logistics, and defense. Hence: simulate the
                Earth.
              </p>
              <p>
                Before we do all that, this summer we’ve built our own
                foundation model, GFT (Generative Forecasting Transformer), a
                1.5B parameter frontier model that simulates global weather up
                to 14 days ahead at approximately 11km resolution (<a
                  href="https://www.ycombinator.com/launches/Lcz-silurian-simulate-the-earth"
                  >https://www.ycombinator.com/launches/Lcz-silurian-simulate-t...</a
                >). Despite the scarce amount of extreme weather data in
                historical records, we have seen that GFT is performing
                extremely well on predicting 2024 hurricane tracks (<a
                  href="https://silurian.ai/posts/001/hurricane_tracks"
                  >https://silurian.ai/posts/001/hurricane_tracks</a
                >). You can play around with our hurricane forecasts at
                <a href="https://hurricanes2024.silurian.ai"
                  >https://hurricanes2024.silurian.ai</a
                >. We visualize these using [cambecc/earth] (<a
                  href="https://github.com/cambecc/earth"
                  >https://github.com/cambecc/earth</a
                >), one of our favorite open source weather visualization tools.
              </p>
              <p>
                We’re excited to be launching here on HN and would love to hear
                what you think!
              </p>
            </div>
          </section>
        </section>
        <section id="41549649">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2024/Sep/15/how-to-succeed-in-mrbeast-production/"
              >How to succeed in MrBeast production (Leaked PDF)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-15 @ 19:24:24</span
              ><span class="points-container"
                >Points: <span class="points">1970</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41549649"
                  >Comments</a
                ><span class="descendants">: 1278</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41547378">
          <h3>
            <a
              class="item"
              href="https://ece.engin.umich.edu/stories/michigan-micro-mote-m3-makes-history-as-the-worlds-smallest-computer"
              >Michigan Micro Mote (M3) makes history as the smallest computer
              (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-15 @ 13:26:25</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41547378"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41546894">
          <h3>
            <a
              class="item"
              href="https://freerangestats.info/blog/2024/09/14/stepwise"
              >Stepwise selection of variables in regression is Evil</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-15 @ 11:45:37</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41546894"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41546619">
          <h3>
            <a
              class="item"
              href="https://www.infinitepartitions.com/art001.html"
              >Dissecting the gzip format (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-15 @ 10:38:03</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41546619"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41542409">
          <h3>
            <a class="item" href="https://github.com/satmihir/fair"
              >Fair: A Go library for serving resources fairly</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-14 @ 20:00:28</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41542409"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41539033">
          <h3>
            <a
              class="item"
              href="https://github.com/thomastschurtschenthaler/electrico"
              >Show HN: Electrico – Electron Without Node and Chrome (Rust /
              Wry)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-14 @ 11:18:14</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41539033"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41533207">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Mecanum_wheel"
              >Mecanum Wheel</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-13 @ 17:21:59</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41533207"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41529709">
          <h3>
            <a class="item" href="https://ppml.dev/"
              >The Pragmatic Programmer for Machine Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-13 @ 10:07:04</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41529709"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41528928">
          <h3>
            <a class="item" href="https://lwn.net/Articles/871113/"
              >User-Space Interrupts (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-13 @ 07:42:02</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41528928"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41522814">
          <h3>
            <a
              class="item"
              href="https://alastairswinnerton.com/2015/09/07/bionicle-my-actual-part-in-its-origins/"
              >Bionicle – my actual part in its origins (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-12 @ 16:45:41</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41522814"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41517455">
          <h3>
            <a class="item" href="https://chessdream.vercel.app"
              >ChessDream, a place for chess players to improve</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-12 @ 03:56:28</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41517455"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
