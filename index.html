<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36522665">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/aigamedev/comments/142j3yt/valve_is_not_willing_to_publish_games_with_ai/"
              >Valve bans games using AI generated graphics or text from
              Steam</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 16:27:38</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36522665"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36522471">
          <h3>
            <a
              class="item"
              href="https://twitter.com/Reuters/status/1674309239974576128"
              >Aspartame is set to be declared a possible carcinogen</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 16:14:59</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36522471"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36522232">
          <h3>
            <a
              class="item"
              href="https://www.marketwatch.com/story/the-airbnb-collapse-is-real-rental-revenue-has-halved-in-some-parts-of-the-u-s-says-this-chart-83d72bbd"
              >Airbnb rental revenues have plunged in some parts of the US, this
              chart suggests</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 15:58:55</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36522232"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36522182">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Vickrey_auction"
              >Vickrey Auction</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 15:55:56</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36522182"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36521388">
          <h3>
            <a
              class="item"
              href="https://nypost.com/2023/06/29/ftc-plans-major-antitrust-lawsuit-against-amazon-report/"
              >FTC reportedly plans major antitrust lawsuit against Amazon</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 15:05:58</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36521388"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36520985">
          <h3>
            <a class="item" href="https://github.com/rabbibotton/clog"
              >Clog – The Common Lisp Omnificent GUI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 14:40:17</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36520985"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36520925">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-02167-7"
              >Monster gravitational waves spotted for first time</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 14:36:21</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36520925"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36520658">
          <h3>
            <a
              class="item"
              href="https://www.latimes.com/politics/story/2023-06-29/supreme-court-strikes-down-affirmative-action-in-college-admissions"
              >Supreme Court strikes down affirmative action in college
              admissions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 14:16:31</span
              ><span class="points-container"
                >Points: <span class="points">332</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36520658"
                  >Comments</a
                ><span class="descendants">: 493</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36520410">
          <h3>
            <a
              class="item"
              href="https://www.windmill.dev/blog/knowledge-base-discord-bot"
              >Show HN: Build a discord/Slack bot to answer questions with your
              docs and GPT4</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 13:54:14</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36520410"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <p>
                You will also need pgvector (here hosted on supabase) and of
                course a GPT4 api key.
              </p>
              <p>
                It showcases an approval step so that you only provide answers
                you are confident giving to your users, which feels less
                robotic.
              </p>
              <p>
                All the building blocks are scripts that you can reuse outside
                of windmill and you could build this in any other workflow
                engines (although less conveniently).
              </p>
              <p>
                We use it for our own needs on discord [2] and thoughts this was
                a common need for any product having community support on slack
                or discord.
              </p>
              <p>
                [1]:
                <a href="https://github.com/windmill-labs/windmill"
                  >https://github.com/windmill-labs/windmill</a
                >
              </p>
              <p>
                [2]:
                <a href="https://discord.com/invite/V7PM2YHsPB"
                  >https://discord.com/invite/V7PM2YHsPB</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36519497">
          <h3>
            <a
              class="item"
              href="https://whileydave.com/2023/06/27/programming-languages-going-above-and-beyond/"
              >Programming languages going above and beyond</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 12:29:19</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36519497"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36519448">
          <h3>
            <a
              class="item"
              href="https://linear.app/blog/scaling-the-linear-sync-engine"
              >Scaling Linear's Sync Engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 12:23:34</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36519448"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36519442">
          <h3>
            <a
              class="item"
              href="https://www.insider.com/submersible-expert-oceangate-ceo-hull-defect-will-only-get-worse-2023-6"
              >Submarine expert tried to dissuade OceanGate CEO, from taking
              customers in Titan</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 12:22:58</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36519442"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36519393">
          <h3>
            <a class="item" href="https://hivekit.io/"
              >Show HN: Hivekit – Geospatial app platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 12:13:56</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36519393"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <p>
                We’re Adam &amp; Wolfram, the founders of Hivekit (<a
                  href="https://hivekit.io"
                  >https://hivekit.io</a
                >), a geospatial app platform to track people and vehicles,
                stream updates, and execute logic based on spatial events.
              </p>
              <p>
                This allows teams in logistics, ride-sharing, delivery,
                construction, agriculture or AR gaming to fully concentrate on
                what makes their offering unique without having to worry about
                the complex infrastructure required to run large scale
                geospatial apps.
              </p>
              <p>
                We both have a long history of building realtime data services
                for industries like financial trading, gaming or app development
                - but there’s something interesting about that. We were
                repeatedly approached by companies in mines, food delivery
                networks, ride sharing companies, mines and even farm-equipment
                manufacturers who were willing to twist our purpose-built
                solutions into a pretzel to make them work for geospatial
                tracking.
              </p>
              <p>
                Recognizing this lack of commodity tech, we started meeting with
                tech folk from around the world, went to onsite visits in
                English mines, Italian mozzarella plants and German construction
                yards (one of my favorite parts of the job) and learned that
                there’s a huge need for a low level realtime data platform for
                geospatial apps.
              </p>
              <p>
                Hivekit is that platform. It lets you send location and other
                data from large numbers of vehicles and devices, subscribe to
                realtime update feeds from apps and websites, store routes and
                historic data, run scriptable logic in response to spatial
                events and comes with all the bits needed to build a successful
                geospatial app such as online status, geofencing, rich auth and
                permissions, fulltext search or pubsub notifications.
              </p>
              <p>But we want to do more:</p>
              <p>
                We’re already working on a 3D world map that lets you track all
                workers, vehicles and objects, add custom UIs and interactive
                map overlays, pause and rewind time and - most importantly -
                control your workforce Command &amp; Conquer style: Simply
                select a few units, assign a task and Hivekit will translate it
                into individual instructions, send them out and track their
                progress.
              </p>
              <p>
                But our real goal isn’t for human operators to control their
                workforce, but for an AI to automate and optimize operations.
                Now, before everyone gets too excited: this won’t be an AI in
                the GPT sense, but more “traditional” ML, optimizing for
                individual value sets, e.g. “ensure that my taxi drivers are
                positioned optimally during the course of the day to ensure the
                lowest possible time to pick up.”
              </p>
              <p>
                You can read more about our plans here:
                <a href="https://hivekit.io/about/our-vision/"
                  >https://hivekit.io/about/our-vision/</a
                >
              </p>
              <p>
                Who are we? Wolfram previously built
                <a href="https://arcentry.com/">https://arcentry.com/</a>,
                <a href="https://deepstream.io/">https://deepstream.io/</a> and
                <a href="https://golden-layout.com/"
                  >https://golden-layout.com/</a
                >, Adam is Director of Engineering for a trading tech company.
              </p>
            </div>
          </section>
        </section>
        <section id="36519359">
          <h3>
            <a
              class="item"
              href="https://www.deusinmachina.net/p/racket-the-scheme-you-should-try"
              >Racket: Lisp for the modern day</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 12:10:09</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36519359"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36519311">
          <h3>
            <a
              class="item"
              href="https://www.iccl.ie/news/last-minute-government-amendment-seeks-to-muzzle-dpc-critics/"
              >Last-minute Government amendment seeks to muzzle DPC critics
              (Ireland)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 12:05:04</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36519311"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36519030">
          <h3>
            <a
              class="item"
              href="https://www.wbtv.com/2023/06/28/plane-lands-charlotte-douglas-international-airport-after-dealing-with-mechanical-issues/"
              >Delta flight lands in Charlotte without front landing gear</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 11:31:20</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36519030"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36519006">
          <h3>
            <a
              class="item"
              href="https://cowboystatedaily.com/2023/06/27/baseball-sized-hail-smashing-into-panels-at-150-mph-destroys-scottsbluff-solar-farm/"
              >Baseball-sized hail destroys Scottsbluff solar farm</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 11:27:54</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36519006"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36518256">
          <h3>
            <a
              class="item"
              href="https://www.bcorporation.net/en-us/find-a-b-corp/"
              >Find a B Corp</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 09:30:47</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36518256"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36517651">
          <h3>
            <a
              class="item"
              href="https://github.com/ParthJadhav/Tkinter-Designer"
              >Tkinter Designer: Quickly Turn Figma Design to Python Tkinter
              GUI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 07:55:33</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36517651"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36517525">
          <h3>
            <a class="item" href="https://awk.dev/"
              >The Awk Programming Language, Second Edition</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 07:34:55</span
              ><span class="points-container"
                >Points: <span class="points">390</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36517525"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36517149">
          <h3>
            <a class="item" href="https://blog.kagi.com/safe-round"
              >Kagi raises $670k</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 06:38:10</span
              ><span class="points-container"
                >Points: <span class="points">349</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36517149"
                  >Comments</a
                ><span class="descendants">: 296</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36515531">
          <h3>
            <a
              class="item"
              href="https://til.simonwillison.net/python/stdlib-cli-tools"
              >CLI tools hidden in the Python standard library</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-29 @ 02:15:16</span
              ><span class="points-container"
                >Points: <span class="points">412</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36515531"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36511012">
          <h3>
            <a class="item" href="https://blog.jonlu.ca/posts/us-east-1-latency"
              >Noticing when an app is only hosted in us-east-1</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-28 @ 19:03:04</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36511012"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36508842">
          <h3>
            <a
              class="item"
              href="https://twitter.com/dag_spicer/status/1673799376437927936"
              >Ed Fredkin has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-28 @ 16:30:28</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36508842"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36498477">
          <h3>
            <a class="item" href="https://nullprogram.com/blog/2023/06/26/"
              >Solving “Two Sum” in C with a tiny hash table</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 20:53:16</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36498477"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36498432">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=zXPiqk0-zDY"
              >A 32-Bit Computer Inside Terraria [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 20:49:16</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36498432"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36494484">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/giant-gravity-hole-in-the-ocean-may-be-the-ghost-of-an-ancient-sea1/"
              >Giant 'Gravity Hole' in the Ocean May Be the Ghost of an Ancient
              Sea</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 15:43:33</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36494484"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36493191">
          <h3>
            <a
              class="item"
              href="https://bastian.rieck.me/blog/posts/2023/writing_why/"
              >Why write?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 14:20:48</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36493191"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36488678">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/nasa-deep-space-food-challenge"
              >NASA’s Contest to Develop the Space Food of the Future</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-27 @ 03:50:06</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36488678"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36477710">
          <h3>
            <a
              class="item"
              href="https://evanlh.com/posts/shortest_path_first_sdlc/"
              >Code the shortest path first</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-26 @ 09:57:30</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36477710"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
