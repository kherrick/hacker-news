<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39697902">
          <h3>
            <a class="item" href="https://github.com/oldherl/syllazh"
              >Linux TTY font for Chinese, but treat it as a syllabic writing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 21:42:32</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39697902"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39697731">
          <h3>
            <a
              class="item"
              href="https://blog.lmorchard.com/2024/03/13/github-actions-for-didthis/"
              >I like automations for inclusive development</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 21:25:18</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39697731"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39697520">
          <h3>
            <a
              class="item"
              href="https://blog.jcoglan.com/2017/02/12/the-myers-diff-algorithm-part-1/"
              >The Myers diff algorithm: part 1</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 21:07:19</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39697520"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696876">
          <h3>
            <a
              class="item"
              href="https://www.ox.ac.uk/news/2024-03-05-ai-reveals-prostate-cancer-not-just-one-disease"
              >Prostate cancer includes two different evotypes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 20:17:16</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696876"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696856">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2024/03/18/how-arnold-schoenberg-changed-hollywood"
              >How Arnold Schoenberg changed Hollywood</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 20:15:35</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696856"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696845">
          <h3>
            <a class="item" href="https://storybook.js.org/blog/storybook-8/"
              >Storybook 8</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 20:14:53</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696845"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696583">
          <h3>
            <a
              class="item"
              href="https://research.ibm.com/blog/science-expert-LLM"
              >IBM and NASA build language models to make scientific knowledge
              more accessible</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 19:54:30</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696583"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696482">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2024/03/eff-ninth-circuit-theres-no-software-exception-traditional-copyright-limits"
              >EFF to Ninth Circuit: No Software Exception to Traditional
              Copyright Limits</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 19:47:53</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696482"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696394">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/technology/2024/03/10/big-tech-companies-ai-research/"
              >Silicon Valley is pricing academics out of AI research</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 19:40:35</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696394"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696152">
          <h3>
            <a
              class="item"
              href="https://eieio.games/nonsense/game-13-breaktime/"
              >BreakTime: Running Breakout inside Google Calendar</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 19:21:53</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696152"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39696139">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=8p02DtmyQhU"
              >A world from a sheet of paper (2023) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 19:21:10</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39696139"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39695685">
          <h3>
            <a
              class="item"
              href="https://careers.snapmagic.com/o/senior-full-stack-engineer-snapmagic-copilot-2"
              >SnapMagic (YC S15) the AI Copilot for electronics is hiring
              full-stack engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 18:46:35</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39694505">
          <h3>
            <a
              class="item"
              href="https://loomcom.com/blog/emulating-the-dmd-5620-terminal/"
              >Emulating the DMD 5620 Terminal (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 17:27:27</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39694505"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39694353">
          <h3>
            <a
              class="item"
              href="https://possiblywrong.wordpress.com/2024/03/12/lemonade-stand/"
              >Lemonade Stand</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 17:17:36</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39694353"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39693221">
          <h3>
            <a class="item" href="https://ar5iv.labs.arxiv.org/html/1312.4068"
              >Marcel Grossmann and his contribution to the general theory of
              relativity</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 16:05:29</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39693221"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39692801">
          <h3>
            <a class="item" href="https://github.com/flox/flox"
              >Show HN: Flox 1.0 – Open-source dev env as code with Nix</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 15:44:29</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39692801"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm Ron Efroni, CEO at Flox, and today we are releasing version
                1.0 of our open source CLI, helping folks manage development
                environments everywhere.My own experience with development
                environments began with air-gapped systems, having to actually
                burn software to a CD to iterate over a very slow and expensive
                development cycle, sometimes reaching the server rack and
                realizing I have the wrong disk.... Fast forward to today and
                there are countless alternatives available backed by incredible
                compute resources, yet we somehow still find ourselves paying
                the price of long development cycles. That's why I've been
                working for over a decade to simplify the development stack so
                we can spend more time on making 1's and 0's do magical things,
                and why my co-founder Michael and I started Flox to bring you
                the solution based on Nix. Today is just the first step on that
                journey. We hope you'll take a peek at our new release, and very
                much look forward to continuing the journey with you from here
                together!
              </p>
              <p>Introducing Flox 1.0</p>
              <p>
                Flox is a platform that lets developers and operators focus on
                building fast with reproducible environments that span the
                enterprise SDLC. Using a declarative framework based on Nix, a
                package management and configuration tool, Flox allows
                developers to create environments that contain everything they
                need to build software.
              </p>
              <p>Why Flox?</p>
              <p>
                Flox behaves a lot like your favorite and familiar package
                manager, but it allows you to create as many environments as you
                want on your machine. Each one can contain a different
                combination of packages.
              </p>
              <p>
                Environments are portable by default. If you install a package
                inside one that isn't cross-platform, it's easy to carve out
                exceptions. It's also easy to write hooks and populate your
                environment with variables - we designed it to be hackable.
              </p>
              <p>
                Flox environments run in user-space, like, where you are. When
                you type `ls` after activating a Flox environment you will see
                the same stuff because you're in the same place - even with all
                those new packages available. No mounting volumes, no proxying
                ports. No breaking into the toolset you just conjured.
              </p>
              <p>
                Getting Started: No sign-ups, just one install away. Dive into
                our GitHub repository (<a href="https://github.com/flox/flox"
                  >https://github.com/flox/flox</a
                >) and start exploring
              </p>
              <p>
                I’m around all day to answer questions, talk Nix, or just
                reminisce about simpler times ;).
              </p>
              <p>Lots of open source love, Ron</p>
            </div>
          </section>
        </section>
        <section id="39692387">
          <h3>
            <a
              class="item"
              href="https://deepmind.google/discover/blog/sima-generalist-ai-agent-for-3d-virtual-environments/"
              >A generalist AI agent for 3D virtual environments</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 15:22:56</span
              ><span class="points-container"
                >Points: <span class="points">328</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39692387"
                  >Comments</a
                ><span class="descendants">: 212</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39692249">
          <h3>
            <a class="item" href="https://github.com/phospho-app/phospho"
              >Show HN: Phospho – Text Analytics for LLM Apps (Posthog for
              Prompts)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 15:14:04</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39692249"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/phospho-app/phospho"
                >https://github.com/phospho-app/phospho</a
              >
              and landing is <a href="https://phospho.ai">https://phospho.ai</a>
              <p>
                Most people building with LLMs today don’t have quantified
                evaluation and usage metrics on the interactions between users
                and their product. The only solution is to read every message
                (or a sample) to get a sense of what is going on. You can't
                improve your product without understanding who your users are
                and how they are using it. Nobody would launch a website without
                standard analytics today; the same principle should apply to LLM
                products.
              </p>
              <p>
                We made phospho to analyze the large amounts of text from user
                inputs and LLM app outputs, and give you quantified and
                actionable insights.
              </p>
              <p>
                You first log messages and set up semantic events. Eg: “user is
                talking about sports”, “assistant didn’t quote the source”. We
                then run asynchronous jobs to detect if events are present in
                the text or not. To do so, we use GPT-4 for the first few
                events, and then downsize to smaller fine-tuned models (cheaper
                &amp; faster). It works with any LLM provider (OpenAI, Mistral,
                Ollama…). No proxy, no monkey patch, and no OpenAI key needed.
              </p>
              <p>
                You can link phospho to your users’ feedback, and even use the
                platform to annotate some messages yourself. This helps you
                design step by step a custom evaluation pipeline that runs
                automatically, fits your needs, and enables you to iterate.
              </p>
              <p>
                Results are available in dashboards, as dataframes, or via API.
                You can also directly leverage the events in your app to trigger
                actions in real-time with the API or via webhooks.
              </p>
              <p>
                Deploy everything with Docker, or use the hosted cloud version.
                We have Python/Javascript SDK and an API. License is Apache 2.0.
              </p>
              <p>
                Give it a spin and see where we’re at:
                <a href="https://github.com/phospho-app/phospho"
                  >https://github.com/phospho-app/phospho</a
                >
                We’re interested in both feature requests and roasts. Let us
                know what you think!
              </p>
            </div>
          </section>
        </section>
        <section id="39691749">
          <h3>
            <a
              class="item"
              href="https://determinate.systems/posts/flakehub-cache-beta/"
              >Show HN: FlakeHub Cache: Fast, secure, configurable. A new take
              on Nix caching</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 14:38:59</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39691749"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39691735">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/world-us-canada-68555051"
              >Paul Alexander, ‘the man in the iron lung’, has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 14:38:11</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39691735"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39691119">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/mass-timber-is-great-but-it-will"
              >Mass timber is great, but it will not solve the housing
              shortage</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 13:41:59</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39691119"
                  >Comments</a
                ><span class="descendants">: 504</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39691108">
          <h3>
            <a
              class="item"
              href="https://voidcomputing.hu/blog/worse-better-prettier/"
              >More AR Glasses USB Protocols: The Worse, the Better and the
              Prettier</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 13:40:17</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39691108"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39690725">
          <h3>
            <a class="item" href="https://marker.pages.dev/"
              >Show HN: A user-friendly UI for viewing and editing Markdown
              files</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 12:47:43</span
              ><span class="points-container"
                >Points: <span class="points">234</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39690725"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39690363">
          <h3>
            <a
              class="item"
              href="https://kottke.org/24/03/how-photos-were-transmitted-by-wire-in-the-1930s"
              >How photos were transmitted by wire in the 1930s</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 11:53:09</span
              ><span class="points-container"
                >Points: <span class="points">202</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39690363"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39689872">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-03-giant-sequoias-rapidly-feature-uk.html"
              >Giant sequoias are a rapidly growing feature of the UK
              landscape</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 10:31:32</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39689872"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39688545">
          <h3>
            <a class="item" href="https://fly.io/blog/jit-wireguard-peers/"
              >JIT WireGuard</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-13 @ 06:13:09</span
              ><span class="points-container"
                >Points: <span class="points">408</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39688545"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39684845">
          <h3>
            <a
              class="item"
              href="https://tedium.co/2024/03/02/why-physical-objects-decay/"
              >Luster Lost: Pondering the way that physical objects degrade over
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-12 @ 20:55:59</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39684845"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39682424">
          <h3>
            <a
              class="item"
              href="https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2020.568049/full"
              >Arthropod Intelligence? The Case for Portia (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-12 @ 17:39:02</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39682424"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39677152">
          <h3>
            <a
              class="item"
              href="https://www.hemmings.com/stories/article/steaming-sensation-1925-doble"
              >Howard Hughes modified a 1925 Doble steam car to reach 133 MPH
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-12 @ 07:57:42</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39677152"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39666976">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/03/11/technology/carmakers-driver-tracking-insurance.html"
              >Automakers are sharing consumers' driving behavior with insurance
              companies</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-11 @ 11:55:08</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39666976"
                  >Comments</a
                ><span class="descendants">: 256</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
