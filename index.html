<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45215032">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45215032"
              >Launch HN: Ghostship (YC S25) – AI agents that find bugs in your
              web app</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 19:06:32</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45215032"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <a href="https://tryghostship.dev/">https://tryghostship.dev/</a
              >).
              <p>
                Ghostship lets you find bugs in your web app by entering in your
                URL and describing a user journey.
              </p>
              <p>
                Here's a video of Ghostship in action:
                <a
                  href="https://www.loom.com/share/dec264ae32f94d50adb141c9246837c3?sid=b3a6121e-1a6f-4428-8e5d-7a9bc502fcd2"
                  >https://www.loom.com/share/dec264ae32f94d50adb141c9246837c3?...</a
                >.
              </p>
              <p>
                For over half our lives, we've been developers and we've done
                tons of user-facing projects like a coding competition I built
                called CerealCodes or freelancing projects on Upwork. The
                biggest problem we faced was that we shipped bugs in edge cases
                we didn't test, and the process of testing was annoying to do
                everytime we shipped a new feature. We tried automated testing
                tools, but those were flaky and couldn't adapt to feature
                changes. They also were really annoying to set up.
              </p>
              <p>
                Our solution is to use browser agents to help you find bugs in
                your web app by clicking through your product like users would.
                You'd enter in your URL, describe what a user would do, and
                Ghostship would go through and try finding bugs by going through
                the user journey and extrapolating edge cases by visually seeing
                where else to click as it goes through each step in the user
                journey. We then show session replays of our agents going
                through your web app and list out all the steps it took.
              </p>
              <p>
                We're able to find edge cases with almost no prompting. All you
                need to do is enter in one URL and one user journey (if you have
                login credentials on your web app, enter in some test
                credentials).
              </p>
              <p>
                One bug we were able to find with Ghostship was on the YC
                application page. Apparently you could add your education dates
                in reverse chronological order (April 2022 to January 2021,
                which makes no sense).
              </p>
              <p>
                Another bug we were able to find was a crypto smart contract CRM
                dashboard we vibe coded where we found a bug involving data
                corruption when you tried editing a draft contract multiple
                times.
              </p>
              <p>
                You can sign up here:
                <a href="https://playground.tryghostship.dev/"
                  >https://playground.tryghostship.dev/</a
                >
                for a limited number of credits. We'd love to hear from the HN
                community, whether you're building a web app for fun or a
                developer shipping a cool user-facing product to customers. We'd
                love to see what bugs we can find in your web app with
                Ghostship!
              </p>
              <p>
                p.s. If you want Ghostship directly in your CI/CD pipeline and
                run after every PR, book a demo with us.
              </p>
            </div>
          </section>
        </section>
        <section id="45214908">
          <h3>
            <a class="item" href="https://www.shloked.com/writing/claude-memory"
              >Claude's Memory Architecture Is the Polar Opposite of
              ChatGPT's</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 18:55:50</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45214908"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45214672">
          <h3>
            <a
              class="item"
              href="https://vmsplice.net/~stefan/stefanha-kvm-forum-2025.pdf"
              >Making io_uring pervasive in QEMU [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 18:32:43</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45214672"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45214670">
          <h3>
            <a
              class="item"
              href="https://github.com/SWE-bench/SWE-bench/issues/465"
              >Top model scores may be skewed by Git history leaks in
              SWE-bench</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 18:32:23</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45214670"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45214498">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/adam/jobs/q6td4uk-founding-engineer"
              >Adam (YC W25) Is Hiring to Build the Future of CAD</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 18:16:09</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45214164">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2025/09/bulletproof-host-stark-industries-evades-eu-sanctions/"
              >Bulletproof host Stark Industries evades EU sanctions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 17:42:56</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45214164"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45214023">
          <h3>
            <a
              class="item"
              href="https://letsencrypt.org/2025/09/11/native-acme-for-nginx"
              >Native ACME support comes to Nginx</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 17:28:13</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45214023"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45213732">
          <h3>
            <a
              class="item"
              href="https://www.cbc.ca/news/canada/british-columbia/robber-bees-terrace-bc-apiary-1.7627532"
              >'Robber bees' invade apiarist's shop in attempted honey heist</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 16:58:08</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45213732"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45213612">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2508.19825"
              >A tech-law measurement and analysis of event listeners for
              wiretapping</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 16:46:09</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45213612"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45213299">
          <h3>
            <a
              class="item"
              href="https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/"
              >NT OS Kernel Information Disclosure Vulnerability</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 16:13:09</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45213299"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45212960">
          <h3>
            <a class="item" href="https://spiraldb.com/post/announcing-spiral"
              >Spiral</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 15:45:38</span
              ><span class="points-container"
                >Points: <span class="points">213</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45212960"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45211868">
          <h3>
            <a class="item" href="https://www.hudsong.dev/digital-darwin"
              >Conway's Game of Life, but musical</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 14:05:31</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45211868"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45211596">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/no-more-injections-crispr-offers-new-hope-for-treating-diabetes/"
              >CRISPR offers new hope for treating diabetes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 13:45:28</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45211596"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45211527">
          <h3>
            <a
              class="item"
              href="https://gothamist.com/news/from-burner-phones-to-decks-of-cards-nyc-teens-are-adjusting-to-the-smartphone-ban"
              >From burner phones to decks of cards: NYC teens adjusting to the
              smartphone ban</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 13:39:43</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45211527"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45211127">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/an-engineering-history-of-the-manhattan"
              >An engineering history of the Manhattan Project</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 13:04:49</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45211127"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45210910">
          <h3>
            <a
              class="item"
              href="https://discuss.grapheneos.org/d/13107-grapheneos-and-forensic-extraction-of-data"
              >GrapheneOS and Forensic Extraction of Data (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 12:46:27</span
              ><span class="points-container"
                >Points: <span class="points">266</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45210910"
                  >Comments</a
                ><span class="descendants">: 140</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45210850">
          <h3>
            <a
              class="item"
              href="https://bun.com/blog/behind-the-scenes-of-bun-install"
              >Behind the scenes of Bun Install</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 12:39:29</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45210850"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45210564">
          <h3>
            <a
              class="item"
              href="https://lists.w3.org/Archives/Public/public-json-ld-wg/2025Sep/0012.html"
              >Gregg Kellogg has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 12:03:32</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45210564"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45210428">
          <h3>
            <a
              class="item"
              href="https://www.macrumors.com/2025/09/11/airpods-live-translation-eu-restricted/"
              >AirPods live translation blocked for EU users with EU Apple
              accounts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 11:46:13</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45210428"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45210399">
          <h3>
            <a class="item" href="https://alignmentalignment.ai"
              >Center for the Alignment of AI Alignment Centers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 11:42:23</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45210399"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45209558">
          <h3>
            <a class="item" href="https://reshaped.so/blog/reshaped-oss"
              >Reshaped is now open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 09:32:49</span
              ><span class="points-container"
                >Points: <span class="points">228</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45209558"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45209389">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2025/08/16/samsungs-us-market-share-apple-rivalry-foldable-phones.html"
              >Samsung taking market share from Apple in U.S. as foldable phones
              gain momentum</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 09:02:50</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45209389"
                  >Comments</a
                ><span class="descendants">: 136</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45208925">
          <h3>
            <a
              class="item"
              href="https://grapheneos.social/@GrapheneOS/115164133992525834"
              >GrapheneOS accessed Android security patches but not allowed to
              publish sources</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-11 @ 07:43:12</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45208925"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45202489">
          <h3>
            <a class="item" href="https://pion.ly/blog/making-a-game-with-pion/"
              >Show HN: Making a cross-platform game in Go using WebRTC
              Datachannels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-10 @ 19:30:37</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45202489"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45170274">
          <h3>
            <a
              class="item"
              href="https://jivimberg.io/blog/2023/09/04/the-inverse-conway-maneuver/"
              >Pulling an Inverse Conway Maneuver at Netflix (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-08 @ 16:26:32</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45170274"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45167694">
          <h3>
            <a
              class="item"
              href="https://www.commonwealmagazine.org/tumult-and-sympathy"
              >Tumult and Sympathy – The Letters of Oliver Sacks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-08 @ 12:58:09</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45167694"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45167688">
          <h3>
            <a class="item" href="https://publicsuffix.org/"
              >Public Suffix List</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-08 @ 12:56:55</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45167688"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45167049">
          <h3>
            <a
              class="item"
              href="https://www.jimmyff.co.uk/blog/beyond-package-management-how-nix-refactored-my-digital-life/"
              >Beyond package management: How Nix refactored my digital life</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-08 @ 11:36:25</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45167049"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45166238">
          <h3>
            <a class="item" href="https://jonathan-frere.com/posts/helix/"
              >The Helix Text Editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-08 @ 09:27:40</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45166238"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45163423">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-09-yellow-fabric-blue.html"
              >Removing yellow stains from fabric with blue light</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-08 @ 00:01:54</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45163423"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
