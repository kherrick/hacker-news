<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41294822">
          <h3>
            <a class="item" href="https://vfxblog.com/dinosaurinputdevice/"
              >The oral history of the Dinosaur Input Device</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 21:45:56</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294822"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294764">
          <h3>
            <a
              class="item"
              href="https://www.aisnakeoil.com/p/ai-companies-are-pivoting-from-creating"
              >AI companies are pivoting from creating gods to building
              products</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 21:34:30</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294764"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294559">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-08-scientist-nonlinear-black-hole-mimickers.html"
              >Scientist performs the first nonlinear study of black hole
              mimickers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 21:01:33</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294559"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294553">
          <h3>
            <a class="item" href="https://up.codes/careers?utm_source=HN"
              >UpCodes (YC S17) is hiring remote SWEs, PMs to automate
              construction compliance</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 21:00:50</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294509">
          <h3>
            <a
              class="item"
              href="https://randsinrepose.com/archives/late-again/"
              >Late Again</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 20:54:59</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294509"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294490">
          <h3>
            <a class="item" href="https://robata.app"
              >Show HN: Robata, macOS window selector: put it on the grill</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 20:52:56</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294490"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <p>
                This is a macOS app that allows you to see all your open windows
                on each monitor and select the one you want.
              </p>
              <p>
                It also lets you view the current state of things like email or
                chat windows, terminal processes, and more.
              </p>
              <p>
                You can use "cmd" and the key above the tab key for alt-tab like
                behaviour.
              </p>
              <p>
                You can also toggle the UI by resting a finger on the corner of
                your trackpad.
              </p>
              <p>I also wrote some dev details here:</p>
              <p>
                <a href="https://madebyenzo.com/#robata"
                  >https://madebyenzo.com/#robata</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41294354">
          <h3>
            <a
              class="item"
              href="https://www.techdirt.com/2024/08/19/court-sees-through-californias-protect-the-children-ruse-strikes-down-kids-code/"
              >Court Sees Through California's 'Protect the Children' Ruse,
              Strikes Down AADC</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 20:33:25</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294354"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294332">
          <h3>
            <a class="item" href="https://cardinal.kx.studio/"
              >Cardinal – Virtual modular synthesizer plugin</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 20:29:45</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294332"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294202">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-08-rare-species-area-years-arizona.html"
              >'Rare species' not seen in the area for 50 years spotted on
              Arizona trail camera</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 20:10:48</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294202"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41294067">
          <h3>
            <a class="item" href="https://github.com/wasi-master/13ft"
              >13ft – A site similar to 12ft.io but is self hosted</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 19:49:22</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41294067"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41293929">
          <h3>
            <a
              class="item"
              href="https://www.instructables.com/Lenticular-Clock/"
              >Lenticular Clock</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 19:32:02</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41293929"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41293901">
          <h3>
            <a
              class="item"
              href="https://research.google/blog/transformers-in-music-recommendation/"
              >Music recommendation system using transformer models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 19:28:22</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41293901"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41293850">
          <h3>
            <a class="item" href="https://netboot.xyz/"
              >Netboot.xyz: your favorite operating systems in one place</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 19:19:44</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41293850"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41293767">
          <h3>
            <a
              class="item"
              href="http://www.righto.com/2024/08/minuteman-guidance-computer.html"
              >The guidance system and computer of the Minuteman III nuclear
              missile</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 19:06:59</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41293767"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41293381">
          <h3>
            <a class="item" href="https://andadinosaur.com/launch-imgpls"
              >Imgpls – An extension to load Imgur images directly</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 18:19:51</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41293381"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41292784">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2024/08/19/migrating-mess-with-dns-to-use-powerdns/"
              >Migrating Mess with DNS to Use PowerDNS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 17:14:12</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41292784"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41292633">
          <h3>
            <a
              class="item"
              href="https://arjunbansal.substack.com/p/llms-know-more-than-what-they-say"
              >LLMs know more than what they say</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 16:53:09</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41292633"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41292018">
          <h3>
            <a
              class="item"
              href="https://berthub.eu/articles/posts/the-gigantic-unregulated-power-plants-in-the-cloud/"
              >The gigantic and unregulated power plants in the cloud</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 15:45:19</span
              ><span class="points-container"
                >Points: <span class="points">304</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41292018"
                  >Comments</a
                ><span class="descendants">: 152</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41291470">
          <h3>
            <a
              class="item"
              href="https://ably.com/blog/optimizing-global-message-transit-latency-a-journey-through-tcp-configuration"
              >Optimizing global message transit latency: a journey through TCP
              configuration</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 14:40:42</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41291470"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41291219">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41291219"
              >Launch HN: Sorcerer (YC S24) – Weather balloons that collect more
              data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 14:13:36</span
              ><span class="points-container"
                >Points: <span class="points">217</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41291219"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
            <div class="text">
              <a href="https://sorcerer.earth">https://sorcerer.earth</a>).
              Sorcerer builds weather balloons that last for over six months,
              collecting 1000x more data per dollar and reaching previously
              inaccessible regions.
              <p>
                In 1981, weather disasters caused $3.5 billion in damages in the
                United States. In 2023, that number was $94.9 billion (<a
                  href="https://www.ncei.noaa.gov/access/billions/time-series"
                  >https://www.ncei.noaa.gov/access/billions/time-series</a
                >). The National Weather Service spends billions annually on its
                network of weather balloons, satellites, and aircraft sensors –
                generating hundreds of terabytes of data every day. This data,
                called observation data, is fed into massive supercomputers
                running advanced physics to produce global weather forecasts.
                Despite this cost, there are still places in the US where we
                don't know what the temperature will be two days from now:
                <a
                  href="https://www.washingtonpost.com/climate-environment/interactive/2024/how-accurate-is-the-weather-forecast/"
                  >https://www.washingtonpost.com/climate-environment/interacti...</a
                >. And for the rest of the world that lacks weather
                infrastructure? There’s always the Weather Rock:
                <a href="https://en.wikipedia.org/wiki/Weather_rock"
                  >https://en.wikipedia.org/wiki/Weather_rock</a
                >.
              </p>
              <p>
                The most important data for these forecasts come from vertical
                data ‘slices’ of the atmosphere, called soundings. Every day
                2,500 single-use latex radiosondes are launched across the globe
                to collect these soundings. They stay aloft for about two hours
                before popping and falling back to Earth. Launch sites for these
                systems are sparse in Latin America and Africa, and they’re
                completely non-existent over oceans. This leaves about 80% of
                the globe with inadequate weather data for accurate predictions.
              </p>
              <p>
                The coverage gap became painfully evident to Max and Alex during
                their time at Urban Sky. While building balloons for
                high-altitude aerial imaging, they kept running into a problem:
                no matter what weather forecast they used, they couldn’t get
                accurate wind predictions for the upper atmosphere. They tried
                all of the free and commercial forecast products, but none of
                them were accurate enough. Digging into it more, we learned that
                a big part of the problem was the lack of high-quality in-situ
                data at those altitudes.
              </p>
              <p>
                To solve this problem, our systems ascend and descend between
                sea level and 65,000ft several times a day to collect vertical
                data soundings. Each vehicle (balloon + payload) weighs less
                than a pound and can be launched from anywhere in the world, per
                the FAA and ICAO reg. Here’s one we launched from Potrero Hill
                in SF,
                <a href="https://youtu.be/75fN5WpRWH0"
                  >https://youtu.be/75fN5WpRWH0</a
                >
                and here’s another near the Golden Gate Bridge,
                <a href="https://youtu.be/7yLmzLPUFVQ"
                  >https://youtu.be/7yLmzLPUFVQ</a
                >. Although we can’t “drive” these balloons laterally, we can
                use opposing wind layers to target or avoid specific regions.
                Here’s what a few simulated flight paths look like, to give you
                an idea:
                <a href="https://youtu.be/F_Di8cjaEUY"
                  >https://youtu.be/F_Di8cjaEUY</a
                >
              </p>
              <p>
                Our payload uses a satellite transceiver for communications and
                a small, thin film solar panel array to generate power. In
                addition to the weather data, we also get real-time telemetry
                from the vehicles, which we use to optimize their flight paths.
                This includes maintaining the optimal spacing between balloons
                and steering them to a recovery zone at the end of their
                lifespan so we can recycle them.
              </p>
              <p>
                These systems spend most of their time in the stratosphere which
                is an extremely unforgiving environment. We’ll often see
                temperatures as low as -80°C while flying near the equator.
                Throughout the day, we experience extreme temperature cycling as
                they ascend and descend through the atmosphere. We’ll often
                encounter 100mph+ wind shears near the boundary with the
                troposphere (the tropopause) that can rip apart the balloon
                envelope. These conditions make the stratosphere a very
                difficult place to deploy to prod.
              </p>
              <p>
                The real magic of what we’re building will come into play when
                we have hundreds of these systems in the air over data-sparse
                regions. But even now, we can do useful and interesting things
                with them. Some of our early customers are companies who fly
                very big, very expensive things into the stratosphere. They use
                our balloons to give them a clear idea of what conditions are
                ahead of their operations, and we’re working on a forecast
                product specifically designed for the stratosphere.
              </p>
              <p>
                The combination of long duration and low cost is novel. We can
                theoretically maintain thousands of balloons in the atmosphere
                at any given time for a tenth of the cost of one useful weather
                satellite. We’re also using the data we collect to train AI
                models that produce forecasts with better accuracy than existing
                numerical (supercomputer) forecasts. Because we’re collecting
                totally unique data over areas that lack observation, our models
                will maintain a consistent edge versus models that are only
                trained on open data.
              </p>
              <p>
                We’re really excited to be launching Sorcerer here with you!
                We’d love to hear what you think. And if you find one of our
                balloons in the Bay Area: Sorry! It’s still a work in progress
                (and please get it back to us).
              </p>
              <p>
                I’ll leave you all with a bonus video of Paul Buchheit launching
                one of our balloons, which we thought was pretty cool:
                <a href="https://www.youtube.com/watch?v=-sngF9VvDzg"
                  >https://www.youtube.com/watch?v=-sngF9VvDzg</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41290409">
          <h3>
            <a
              class="item"
              href="https://snats.xyz/pages/articles/classifying_a_bunch_of_pdfs.html"
              >Classifying all of the pdfs on the internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 12:23:09</span
              ><span class="points-container"
                >Points: <span class="points">234</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41290409"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41290237">
          <h3>
            <a
              class="item"
              href="https://thingswemake.com/bit-banging-a-basic-birthday/"
              >Bit-banging a BASIC Birthday</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 11:57:26</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41290237"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41289114">
          <h3>
            <a
              class="item"
              href="https://blog.reverberate.org/2021/04/21/musttail-efficient-interpreters.html"
              >Parsing protobuf at 2+GB/s: how I learned to love tail calls in C
              (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 08:42:03</span
              ><span class="points-container"
                >Points: <span class="points">318</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41289114"
                  >Comments</a
                ><span class="descendants">: 136</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41287425">
          <h3>
            <a
              class="item"
              href="https://blog.archive.org/2024/08/19/archiving-the-famous-computer-cafe/"
              >Archiving "The Famous Computer Cafe"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 03:02:52</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41287425"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41287031">
          <h3>
            <a
              class="item"
              href="https://github.com/MatthewKuKanich/FindMyFlipper"
              >FindMy Flipper – AirTag and SmartTag Emulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-19 @ 01:31:05</span
              ><span class="points-container"
                >Points: <span class="points">244</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41287031"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41284703">
          <h3>
            <a class="item" href="https://github.com/janbjorge/PgQueuer"
              >Show HN: PgQueuer – Transform PostgreSQL into a Job Queue</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-18 @ 19:22:31</span
              ><span class="points-container"
                >Points: <span class="points">349</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41284703"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
            <div class="text">
              PgQueuer is a minimalist, high-performance job queue library for
              Python, leveraging the robustness of PostgreSQL. Designed for
              simplicity and efficiency, PgQueuer uses PostgreSQL's
              LISTEN/NOTIFY to manage job queues effortlessly.
            </div>
          </section>
        </section>
        <section id="41268540">
          <h3>
            <a class="item" href="https://en.esotericsoftware.com/"
              >Spine – 2D skeletal animation for games, with physical secondary
              motions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-16 @ 17:40:10</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41268540"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41263928">
          <h3>
            <a
              class="item"
              href="https://pedermisager.org/blog/seven_basic_rules_for_causal_inference/"
              >Seven basic rules for causal inference</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-16 @ 07:14:57</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41263928"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41261711">
          <h3>
            <a class="item" href="https://www.greptile.com/blog/semantic"
              >Searching a Codebase in English</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-15 @ 23:48:59</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41261711"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41260076">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=a87tB__3KEs"
              >Designing (Procedural) Monsters (2021) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-15 @ 20:34:19</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41260076"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
