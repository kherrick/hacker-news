<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35712625">
          <h3>
            <a
              class="item"
              href="https://www.lenfestinstitute.org/solution-set/i-canceled-22-digital-newspaper-subscriptions-heres-what-i-learned-about-digital-retention-strategies/"
              >What I learned unsubscribing from 22 newspapers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 12:30:32</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35712625"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35712360">
          <h3>
            <a
              class="item"
              href="https://www3.nhk.or.jp/nhkworld/en/news/20230426_23/"
              >Japan's population may drop by almost one-third by 2070</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 12:04:09</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35712360"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35712321">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35712321"
              >Kalshi (YC W19) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 12:01:15</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                We're expanding our team and are seeking ambitious and hungry
                engineers to join the adventure.
              </p>
              <p>
                You can view our open positions at
                <a href="https://kalshi.com/careers"
                  >https://kalshi.com/careers</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="35712238">
          <h3>
            <a class="item" href="https://renewables-map.robinhawkes.com"
              >Show HN: An interactive map showing live wind farm generation in
              Great Britain</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 11:53:09</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35712238"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              <p>
                It's an interactive map showing live generation for major wind
                farms in Great Britain, showing what each wind farm is
                generating both now and in the past, and where that generation
                is physically located.
              </p>
              <p>
                Animated weather data is from WeatherLayers and shows current
                and historic wind conditions on the map, providing context to
                wind generation around the country.
              </p>
              <p>
                History mode allows you to go back in time and see wind
                generation and weather conditions for a particular date and
                time. It's great for exploring days of record generation, such
                as the 21.6GW record on January 10th, 2023!
              </p>
              <p>
                Prediction mode lets you see what wind farms are estimated to be
                generating using current wind conditions and model based on
                historic generation and wind speeds. Is a wind farm generating
                as you expect, or is there something to look into?
              </p>
              <p>
                An experimental feature allows you to see what future wind farms
                could be generating today (or in the past!) if they were already
                built and operational. If you click the "sparkle" button on the
                map you'll get to see what the upcoming 3.6GW Dogger Bank wind
                farm is estimated to generate if it was operational today.
              </p>
              <p>
                There's an "About" section on the site that goes into detail on
                the various public data sources and how some of the features
                work. I also document a lot of this on my Twitter @robhawkes if
                you're curious.
              </p>
              <p>
                This is just the start and there are many more features to come!
              </p>
              <p>Please let me know your comments and suggestions.</p>
            </div>
          </section>
        </section>
        <section id="35712131">
          <h3>
            <a
              class="item"
              href="https://www.diyphotography.net/ai-used-photographers-photos-for-training-then-slapped-him-with-an-invoice/"
              >AI used photographer’s photos for training, then slapped him with
              an invoice</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 11:42:48</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35712131"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35712099">
          <h3>
            <a
              class="item"
              href="https://www.akshaykhot.com/ruby-switch-statement/"
              >Ruby's Switch Statement Is More Flexible Than You Thought</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 11:38:05</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35712099"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35711968">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2023-04-26/microsoft-s-69-billion-activision-deal-blocked-by-uk-watchdog"
              >UK Blocks Microsoft’s $69B Activision Deal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 11:17:28</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35711968"
                  >Comments</a
                ><span class="descendants">: 178</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35711913">
          <h3>
            <a
              class="item"
              href="https://www.gov.uk/government/news/microsoft-activision-deal-prevented-to-protect-innovation-and-choice-in-cloud-gaming"
              >Microsoft / Activision deal prevented to protect innovation and
              choice in gaming</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 11:09:05</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35711913"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35711349">
          <h3>
            <a
              class="item"
              href="https://status.cloud.google.com/regional/europe"
              >Google cloud Europe is out</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 09:39:17</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35711349"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35711317">
          <h3>
            <a
              class="item"
              href="https://news.harvard.edu/gazette/story/2023/03/study-confirms-why-we-need-female-mice-in-neuroscience-research/"
              >We need female mice in neuroscience research</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 09:33:39</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35711317"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35711013">
          <h3>
            <a class="item" href="https://neutralino.js.org/docs/"
              >Neutralinojs – Build lightweight cross-platform desktop apps with
              JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 08:48:42</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35711013"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35710848">
          <h3>
            <a
              class="item"
              href="https://www.sciencenews.org/article/vegan-leather-fungi-repair-mycelium"
              >Vegan Leather Made of Dormant Fungi Can Repair Itself</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 08:24:06</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35710848"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35709453">
          <h3>
            <a class="item" href="https://app.jellylade.com"
              >Show HN: Jellylade – Turn your screenshots into posts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 03:43:26</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35709453"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35709348">
          <h3>
            <a
              class="item"
              href="https://www.redhat.com/sysadmin/podman-inside-container"
              >How to use Podman inside of a container (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 03:19:22</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35709348"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35709114">
          <h3>
            <a
              class="item"
              href="https://open5gs.org/open5gs/docs/tutorial/01-your-first-lte/"
              >Your First LTE</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 02:32:11</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35709114"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35708869">
          <h3>
            <a
              class="item"
              href="https://defcon.social/@mysk/110262313275622023"
              >Google Authenticator cloud sync: Google can see the secrets, even
              while stored</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 01:43:39</span
              ><span class="points-container"
                >Points: <span class="points">338</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35708869"
                  >Comments</a
                ><span class="descendants">: 113</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35708683">
          <h3>
            <a
              class="item"
              href="https://nautil.us/my-life-with-the-penguins-298047/"
              >My Life with the Penguins</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 01:08:59</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35708683"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35708613">
          <h3>
            <a class="item" href="https://neat.joeldare.com"
              >Show HN: Neat – Minimalist CSS Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 00:56:33</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35708613"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
            <div class="text">
              <p>
                I noticed I hadn't shared this with HN for about 18 months (5 or
                6 minor version changes) so I thought it might be okay to do
                that now.
              </p>
              <p>Edit: Err, I missed a post from 7 months ago.</p>
              <p>Previous Posts:</p>
              <p>
                <a href="https://news.ycombinator.com/item?id=32990838"
                  >https://news.ycombinator.com/item?id=32990838</a
                >
                (7 months ago)
              </p>
              <p>
                <a href="https://news.ycombinator.com/item?id=24594381"
                  >https://news.ycombinator.com/item?id=24594381</a
                >
                (Sept 25, 2021)
              </p>
              <p>
                <a href="https://news.ycombinator.com/item?id=26308052"
                  >https://news.ycombinator.com/item?id=26308052</a
                >
                (March 1, 2021)
              </p>
              <p>
                <a href="https://news.ycombinator.com/item?id=25660317"
                  >https://news.ycombinator.com/item?id=25660317</a
                >
                (January 20, 2021)
              </p>
              <p>
                <a href="https://news.ycombinator.com/item?id=23221957"
                  >https://news.ycombinator.com/item?id=23221957</a
                >
                (May 28, 2020)
              </p>
            </div>
          </section>
        </section>
        <section id="35708359">
          <h3>
            <a
              class="item"
              href="https://www.3blue1brown.com/lessons/prime-spirals"
              >Why do prime numbers make these spirals? (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 00:14:45</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35708359"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35708331">
          <h3>
            <a class="item" href="https://tavianator.com/2023/futex.html"
              >You could have invented futexes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-26 @ 00:10:56</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35708331"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35707692">
          <h3>
            <a
              class="item"
              href="https://www.mux.com/blog/how-content-moderation-rescued-750k-in-unpaid-invoices-from-soccer-pirates"
              >We glued together content moderation to stop soccer pirates</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-25 @ 22:40:24</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35707692"
                  >Comments</a
                ><span class="descendants">: 195</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35697627">
          <h3>
            <a class="item" href="https://e2eml.school/transformers.html"
              >Transformers from Scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-25 @ 07:42:34</span
              ><span class="points-container"
                >Points: <span class="points">245</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35697627"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35697535">
          <h3>
            <a
              class="item"
              href="https://publicdomainreview.org/essay/chaos-bewitched-moby-dick-and-ai"
              >Chaos Bewitched: Moby-Dick and AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-25 @ 07:26:52</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35697535"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35692535">
          <h3>
            <a
              class="item"
              href="https://erlangforums.com/t/open-sourcing-erlfuzz/2562"
              >Erlfuzz – Fuzzer for the Erlang compiler and VM</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-24 @ 20:12:56</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35692535"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35690753">
          <h3>
            <a class="item" href="http://rocket.jonh.net"
              >Show HN: Homemade rocketship treehouse – hardware to custom OS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-24 @ 17:41:26</span
              ><span class="points-container"
                >Points: <span class="points">374</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35690753"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
            <div class="text">
              <a href="https://news.ycombinator.com/item?id=2246856"
                >https://news.ycombinator.com/item?id=2246856</a
              >)
              <p>
                The Ravenna Ultra-Low-Altitude Vehicle is a backyard rocketship
                treehouse nestled in the Seattle neighborhood of Ravenna. Click
                the link to see a demo video (<a href="http://rocket.jonh.net"
                  >http://rocket.jonh.net</a
                >).
              </p>
              <p>
                The hexagonal treehouse is about 6.5 feet (2 meters) across at
                its widest point. The frame is welded mild steel with riveted
                aluminum siding. It contains nearly 800 LEDs forming dozens of
                numeric displays spread across 14 control panels, each with an
                acrylic face laser-cut and etched with labels such as "Lunar
                Distance" and "Hydraulic Pressure". The pilot controls the
                rocket using a joystick and panels full of working switches,
                knobs and buttons. Underneath the capsule are three "thrusters"
                that shoot plumes of water and compressed air under the control
                of the pilot's joystick, simulating real positioning thrusters.
                Takeoff and docking sequences are augmented by a paint-shaker
                that simulates the vibration of a rocket engine. Sound effects
                complete the illusion, with a powered subwoofer that gives the
                rocket a satisfying rumble.
              </p>
              <p>
                When it was built in 2011, rocket operations were controlled by
                three Atmega328 microprocessors on custom-fabricated printed
                circuit boards, running a small operating system, RULOS, built
                just for this project. A trench running from the house to the
                rocket carries 12VDC power for the lighting and electronics,
                water for the thrusters, compressed air, and several data
                signals.
              </p>
              <p>
                Since 2011, the two-person team has upgraded it, here is a
                recent update from the makers:
              </p>
              <p>
                One of the most visible changes is replacing the primary 4-line
                display with a slicker 6-line display (i.e., 6 rows of 8 columns
                of 7-segment LEDs). The audio synthesizer has been upgraded to a
                PCB that can generate 50khz, 16-bit audio. The interconnection
                bus, which had been flat IDC cable carrying individual on/off
                lines, was upgraded to a true I2C-based networked distributed
                system with over a dozen individually addressable targets, all
                interconnected by standard cat5 cable that carries both our I2C
                protocol and power. We also moved much of the electronics from
                8-bit atmega328s to newer, 32-bit STM32F3's. RULOS has been
                expanded into a pretty general purpose embedded systems platform
                ported to 5 major lines of CPU (atmega, attiny, stm32, nxp lpc,
                and esp32). We've used it for dozens of other projects in the
                last 12 years, including a nanosecond-accurate timestamper, a
                GPS datalogger, an air quality sensor, various little electronic
                control boards for toys (e.g. these, and this), and an
                autonomous boat (that sank). It is all available on Github:
                <a href="https://github.com/jelson/rulos"
                  >https://github.com/jelson/rulos</a
                >.
              </p>
            </div>
          </section>
        </section>
        <section id="35685685">
          <h3>
            <a
              class="item"
              href="https://admiralcloudberg.medium.com/highway-to-ruin-the-crash-of-southern-airways-flight-242-7eb1433281fe"
              >Last Highway Landing in USA</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-24 @ 10:19:31</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35685685"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35685517">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/passwords-passkey-transition-time/"
              >The transition from logins to cryptographic passkeys is getting
              messy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-24 @ 09:51:48</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35685517"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35685249">
          <h3>
            <a
              class="item"
              href="https://eclecticlight.co/2018/12/29/painting-goethes-faust-0-introduction-to-a-new-series/"
              >Painting Goethe’s Faust (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-24 @ 09:06:38</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35685249"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35684961">
          <h3>
            <a class="item" href="https://github.com/dessalines/thumb-key"
              >Thumb-Key: a privacy-conscious smart keyboard, made specifically
              for your thumbs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-24 @ 08:21:19</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35684961"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35683754">
          <h3>
            <a
              class="item"
              href="https://chris-said.io/2023/04/21/double-descent-in-human-learning/"
              >Double Descent in Human Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-04-24 @ 04:46:11</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35683754"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
