<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39055164">
          <h3>
            <a
              class="item"
              href="https://fernandovillalba.substack.com/p/devops-dont-destroy-silos-transform"
              >Silos are fine, as long as there is an API between them</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 13:32:08</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39055164"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39055139">
          <h3>
            <a
              class="item"
              href="https://delta.io/blog/delta-lake-vs-parquet-comparison/"
              >Delta Lake vs. Parquet: A Comparison</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 13:30:03</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39055139"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39054956">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/shop/buy-vision/apple-vision-pro"
              >Apple Vision Pro available for pre-order</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 13:05:28</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39054956"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39054671">
          <h3>
            <a
              class="item"
              href="https://blog.chybby.com/posts/building-a-usb-snes-controller"
              >Building a USB SNES Controller</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 12:30:35</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39054671"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39054455">
          <h3>
            <a class="item" href="https://nango.dev/jobs"
              >Nango (YC W23) Is Hiring Back End Engineers (Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 12:00:09</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39053830">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/software/operating-systems/driver-hack-lets-you-run-linux-after-windows-bsods-no-reboot-required"
              >Driver hack lets you run Linux after Windows BSODs, no reboot
              required</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 10:30:03</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39053830"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39052219">
          <h3>
            <a class="item" href="https://www.loadership.com/"
              >LoaderShip – CSS-Only Loaders</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 06:34:23</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39052219"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39052196">
          <h3>
            <a
              class="item"
              href="https://workspaceupdates.googleblog.com/2023/09/winding-down-google-sync-and-less-secure-apps-support.html"
              >Google will disable all but OAuth for IMAP, SMTP and POP starting
              Sept. 30</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 06:30:36</span
              ><span class="points-container"
                >Points: <span class="points">303</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39052196"
                  >Comments</a
                ><span class="descendants">: 176</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39052051">
          <h3>
            <a
              class="item"
              href="https://github.com/pdp11/fuzzball-operating-system"
              >David Mills' Fuzzball</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 06:04:44</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39052051"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39051876">
          <h3>
            <a
              class="item"
              href="https://brooker.co.za/blog/2024/01/18/scalability.html"
              >What Is Scalability Anyway?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 05:28:14</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39051876"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39051691">
          <h3>
            <a
              class="item"
              href="https://www.fortressofdoors.com/four-magic-words/"
              >Four Magic Words</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 04:54:56</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39051691"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39051655">
          <h3>
            <a
              class="item"
              href="https://social.clawhammer.net/blog/posts/2024-01-19-CultureChange/"
              >Culture Change at Google</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 04:46:32</span
              ><span class="points-container"
                >Points: <span class="points">382</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39051655"
                  >Comments</a
                ><span class="descendants">: 298</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39051508">
          <h3>
            <a
              class="item"
              href="https://www.tbray.org/ongoing/When/202x/2024/01/15/Google-2024"
              >Mourning Google</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 04:17:13</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39051508"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39051362">
          <h3>
            <a class="item" href="https://orthic.shorthand.fun/"
              >Orthic Shorthand – Write as fast as you type</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 03:48:01</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39051362"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39051246">
          <h3>
            <a
              class="item"
              href="https://elists.isoc.org/pipermail/internet-history/2024-January/009265.html"
              >Dave Mills has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 03:27:58</span
              ><span class="points-container"
                >Points: <span class="points">443</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39051246"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39050905">
          <h3>
            <a class="item" href="https://zlinky.com/"
              >Show HN: Lightweight Productivity Tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 02:28:24</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39050905"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <p>
                I’m the founder of Zlinky (<a href="http://Zlinky.com"
                  >http://Zlinky.com</a
                >).
              </p>
              <p>
                Zlinky is an app that helps you save and organize your links and
                screenshots. We have worked hard to keep the app very simple. We
                also have a web version and a Chrome Extension.
              </p>
              <p>
                I was inspired to build this app as I was struggling to find an
                easy way save / organize / revisit / connect ideas. I couldn't
                find an existing tool that was lightweight and purpose built.
              </p>
              <p>
                I spend a LOT of time consuming content, and I felt that I
                wasn't being effective revisiting the highest quality content
                for work or personal purposes. My screenshots were also in a
                mess and that one important screenshot often got lost.
              </p>
              <p>
                I learnt about building prosumer apps as the Co-Founder of
                ManageFlitter (RIP). We scaled ManageFlitter to over 4 million
                users. Eventually Twitter refused most of our most valuable
                features. The ManageFlitter story captures the crazy
                rollercoaster that was building on top of the public Twitter
                API.
              </p>
              <p>
                Zlinky has a very generous free account that should be
                sufficient most users for a long period of time.
              </p>
              <p>
                Would love to get your feedback, questions, and ideas. Thanks!
                :)
              </p>
              <p>Kevin</p>
            </div>
          </section>
        </section>
        <section id="39049999">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/ocean-floor-holes-purposes-eels"
              >Why holes at the bottom of the ocean disappear and reappear</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-19 @ 00:26:28</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39049999"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39049703">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-00130-8"
              >AlphaFold Found Possible Psychedelics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 23:53:32</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39049703"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39049691">
          <h3>
            <a
              class="item"
              href="https://upollo.ai/blog/10-second-teleportation"
              >10 Second Teleportation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 23:53:05</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39049691"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39049284">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/why-do-other-people-form-imaginary-shapes-in-our-minds"
              >The Geometry of Other People</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 23:13:04</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39049284"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39048317">
          <h3>
            <a
              class="item"
              href="https://gds.blog.gov.uk/2024/01/17/how-we-migrated-our-postgresql-database-with-11-seconds-downtime/"
              >We migrated our PostgreSQL database with 11 seconds downtime</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 21:51:05</span
              ><span class="points-container"
                >Points: <span class="points">454</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39048317"
                  >Comments</a
                ><span class="descendants">: 167</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39047825">
          <h3>
            <a
              class="item"
              href="https://gmays.com/how-im-relearning-math-as-an-adult/"
              >Relearning math as an adult</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 21:12:54</span
              ><span class="points-container"
                >Points: <span class="points">295</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39047825"
                  >Comments</a
                ><span class="descendants">: 173</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39046904">
          <h3>
            <a
              class="item"
              href="https://harpers.org/archive/2024/02/lost-highway-emily-gogolak/"
              >Lost Highway: The trials of trucking school</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 20:05:58</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39046904"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39046190">
          <h3>
            <a
              class="item"
              href="https://www.lrb.co.uk/the-paper/v46/n02/susan-eilenberg/hooted-from-the-stage"
              >Hooted from the Stage: review of two new books on Keats</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 19:10:42</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39046190"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39043871">
          <h3>
            <a
              class="item"
              href="https://waxy.org/2024/01/the-quiet-death-of-ellos-big-dreams/"
              >The quiet death of Ello's big dreams</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 16:35:59</span
              ><span class="points-container"
                >Points: <span class="points">439</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39043871"
                  >Comments</a
                ><span class="descendants">: 222</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39042093">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39042093"
              >Launch HN: Talc AI (YC S23) – Test Sets for AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 14:32:55</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39042093"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
            <div class="text">
              <a href="https://talc.ai/demo">https://talc.ai/demo</a>
              <p>
                We’ve found that it's very difficult to know how well LLM
                applications (and especially RAG systems) are going to work in
                the wild. Many companies tackle this by having developers or
                contractors run tests manually. It’s a slow process that holds
                back development, and often results in unexpected behavior when
                the application ships.
              </p>
              <p>
                We’ve dealt with similar problems before; Max was a staff
                engineer working on systematic technical solutions for privacy
                problems at facebook, and Matt worked on ML ops on facebooks’
                election integrity team, helping run classifiers that handled
                trillions of data points. We learned that even the best
                predictive systems need to be deeply understood and trusted to
                be useful to product teams, and set out to build the same
                understanding in AI.
              </p>
              <p>
                To solve this, we take ideas from academia on how to benchmark
                the general capabilities of language models, and apply them to
                generating domain specific test cases that run against your
                actual prompts and code.
              </p>
              <p>
                Consider an analogy: If you’re a lawyer, we don’t need to be
                lawyers to open up a legal textbook and test your knowledge of
                the content. Similarly if you’re building a legal AI
                application, we don’t need to build your application to come up
                with an effective set of tests that can benchmark your
                performance.
              </p>
              <p>
                To make this more concrete - when you pick a topic in the demo,
                we grab the associated wikipedia page and extract a bunch of
                facts from it using a classic NLP technique called “named entity
                recognition”. For example if you picked FreeBASIC, we might
                extract the following line from it:
              </p>
              <p></p>
              <pre><code>    Source of truth: "IDEs specifically made for FreeBASIC include FBide and FbEdit,[5] while more graphical options include WinFBE Suite and VisualFBEditor." 

</code></pre>
              This line is our source of truth. We then use an LLM to work
              backwards from this fact into a question and answer:
              <p></p>
              <pre><code>    Question: "What programming language are the IDEs WinFBE Suite and FbEdit designed to support?"
    Reference Answer: "FreeBasic"

</code></pre>
              We can then evaluate accurately by comparing the reference answer
              and the original source of truth– this is how we generate “simple”
              questions in the demo.
              <p>
                In production we’re building this same functionality on our
                customers' knowledge base instead of wikipedia. We then employ a
                few different strategies to generate questions – these range
                from simple factual questions like “how much does the 2024 chevy
                tahoe cost”, to complex questions like “What would a mechanic
                have to do to fix the recall on my 2018 Golf?” These questions
                are based on facts extracted from your knowledge base and real
                customer examples.
              </p>
              <p>
                This testing and grading process is fast – it’s driven by a
                mixture of LLMs and traditional algorithms, and can turn around
                in minutes. Our business model is pretty simple - we charge for
                each test created. If you opt to use our grading product as well
                we charge for each example graded against the test.
              </p>
              <p>
                We’re excited to hear what the HN community thinks – please let
                us know in the comments if you have any feedback, questions or
                concerns!
              </p>
            </div>
          </section>
        </section>
        <section id="39040014">
          <h3>
            <a
              class="item"
              href="https://weather.com/science/nature/video/two-cicada-broods-unite-for-first-time-in-221-years"
              >Two Cicada Broods Emerge Together</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-18 @ 10:11:12</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39040014"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39034603">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/culture/2024/jan/01/cerne-abbas-giant-is-hercules-and-was-army-meeting-point-say-historians"
              >Cerne Abbas giant is Hercules and was army meeting point, say
              historians</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-17 @ 22:40:16</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39034603"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39028384">
          <h3>
            <a
              class="item"
              href="https://www.planeandpilotmag.com/hearing-and-doing/"
              >Hearing and Doing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-17 @ 14:44:51</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39028384"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39025631">
          <h3>
            <a class="item" href="https://bleuje.com/randomanimations/"
              >Random Animations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-17 @ 09:51:43</span
              ><span class="points-container"
                >Points: <span class="points">410</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39025631"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
