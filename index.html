<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43806375">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/finance-and-economics/2025/04/24/economists-dont-know-whats-going-on"
              >Economists don't know what's going on</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 19:27:25</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43806375"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43806308">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2025/04/smells-like-teen-friendship-how-scent-influences-social-choices/"
              >Women rely partly on smell when choosing friends</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 19:16:28</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43806308"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43805729">
          <h3>
            <a
              class="item"
              href="https://www.mail-archive.com/silklist@lists.hserus.net/msg08034.html"
              >Barlow's Principles of Adult Behaviour</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 17:58:16</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43805729"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43805683">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/robot-dexterity-still-seems-hard"
              >Robot Dexterity Still Seems Hard</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 17:53:12</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43805683"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43805369">
          <h3>
            <a
              class="item"
              href="https://www.macsparky.com/blog/2025/04/the-seven-year-rule/"
              >The Seven-Year Rule</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 17:13:18</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43805369"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43803724">
          <h3>
            <a class="item" href="https://github.com/si14/stuffed-naan-js"
              >Stuffed-Na(a)N: stuff your NaNs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 14:04:01</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43803724"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43803659">
          <h3>
            <a
              class="item"
              href="https://naml.us/post/thank-you-for-holding-my-duck/"
              >Thank you for holding my duck (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 13:56:34</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43803659"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43803518">
          <h3>
            <a class="item" href="https://github.com/facebookresearch/MILS"
              >LLMs can see and hear without any training</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 13:38:25</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43803518"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43803243">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/Apr/26/o3-photo-locations/"
              >Watching o3 guess a photo's location is surreal, dystopian and
              entertaining</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 13:04:08</span
              ><span class="points-container"
                >Points: <span class="points">476</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43803243"
                  >Comments</a
                ><span class="descendants">: 246</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43803148">
          <h3>
            <a class="item" href="https://github.com/joexbayer/RetrOS-32"
              >Show HN: My self-written hobby OS is finally running on my
              vintage IBM ThinkPad</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 12:51:41</span
              ><span class="points-container"
                >Points: <span class="points">237</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43803148"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
            <div class="text">
              Finally got my hobby OS up and running on real hardware. I love
              the old IBM thinkpads, so thought it was the perfect machine to
              get it working on. Been working on it for quite some time now, but
              this has been a big milestone!
            </div>
          </section>
        </section>
        <section id="43802839">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43802839"
              >Freshpaint (YC S19) is hiring back end and front end engineers
              (Remote, US only)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 12:00:38</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>Tech stack: Go, Postgres, AWS, TypeScript, React.</p>
              <p>We're looking for:</p>
              <p>
                Backend Engineers: Experience with backend systems, APIs,
                distributed architectures, and product-focused engineering.
                Apply here:
                <a href="https://tinyurl.com/4nbv7wde"
                  >https://tinyurl.com/4nbv7wde</a
                >
              </p>
              <p>
                Frontend Engineers: Experience with React, TypeScript, and
                owning UI development in collaborative environments. Apply here:
                <a href="https://tinyurl.com/wfud7ppv"
                  >https://tinyurl.com/wfud7ppv</a
                >
              </p>
              <p>Experience at high growth, early stage startups is a must.</p>
              <p>Fully remote (US). Competitive salary and equity.</p>
              <p>
                Follow the URL's above to apply or email our recruiter at
                shannan@freshpaint.io
              </p>
            </div>
          </section>
        </section>
        <section id="43802792">
          <h3>
            <a
              class="item"
              href="https://changelog.complete.org/archives/10768-announcing-the-nncpnet-email-network"
              >The NNCPNET Email Network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 11:54:04</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43802792"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43802727">
          <h3>
            <a
              class="item"
              href="https://www.happiness.hks.harvard.edu/february-2025-issue/the-friendship-recession-the-lost-art-of-connecting"
              >The Friendship Recession: The Lost Art of Connecting</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 11:41:21</span
              ><span class="points-container"
                >Points: <span class="points">275</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43802727"
                  >Comments</a
                ><span class="descendants">: 211</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43801906">
          <h3>
            <a class="item" href="https://yarchive.net/blog/prostate/"
              >An end to all this prostate trouble?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 08:39:29</span
              ><span class="points-container"
                >Points: <span class="points">413</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43801906"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43801439">
          <h3>
            <a
              class="item"
              href="https://www.chemistryworld.com/news/australian-who-ordered-radioactive-materials-over-the-internet-walks-away-from-court/4021306.article"
              >Australian who ordered radioactive materials walks away from
              court</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 06:42:59</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43801439"
                  >Comments</a
                ><span class="descendants">: 209</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43801179">
          <h3>
            <a class="item" href="https://www.cloudofoz.com/verlet-test/"
              >Cloth</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 05:31:52</span
              ><span class="points-container"
                >Points: <span class="points">379</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43801179"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43800151">
          <h3>
            <a class="item" href="https://mobygratis.com/"
              >Mobygratis – Free Moby music to empower your creative projects</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 01:38:54</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43800151"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43800002">
          <h3>
            <a class="item" href="https://lite.berkeley-humanoid.org/"
              >Berkeley Humanoid Lite – Open-source robot</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 01:03:40</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43800002"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799820">
          <h3>
            <a
              class="item"
              href="https://samj.substack.com/p/that-joke-isnt-funny-any-more"
              >I wrote a book called "Crap Towns". It seemed funny at the
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 00:30:41</span
              ><span class="points-container"
                >Points: <span class="points">352</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799820"
                  >Comments</a
                ><span class="descendants">: 256</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799802">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/computers/smartphone-listening-conversations-ads-facebook/"
              >Your phone isn't secretly listening to you, but the truth is more
              disturbing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 00:26:48</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799802"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799697">
          <h3>
            <a
              class="item"
              href="https://www.doliver.org/articles/rss-as-a-skill"
              >Reading RSS content is a skilled activity</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-26 @ 00:08:14</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799697"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799557">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-04-fifteen-giant-radio-galaxies-askap.html"
              >Fifteen new giant radio galaxies discovered with ASKAP</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 23:48:44</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799557"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799396">
          <h3>
            <a class="item" href="https://tavianator.com/2025/configure.html"
              >Parallel ./configure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 23:19:56</span
              ><span class="points-container"
                >Points: <span class="points">188</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799396"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43799302">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/technology/2025/04/25/wikipedia-nonprofit-ed-martin-letter/"
              >Wikipedia’s nonprofit status questioned by D.C. U.S. attorney</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 23:03:55</span
              ><span class="points-container"
                >Points: <span class="points">801</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43799302"
                  >Comments</a
                ><span class="descendants">: 728</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43798757">
          <h3>
            <a
              class="item"
              href="https://madebyoll.in/posts/world_emulation_via_dnn/"
              >World Emulation via Neural Network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 21:33:57</span
              ><span class="points-container"
                >Points: <span class="points">231</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43798757"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43797256">
          <h3>
            <a class="item" href="https://github.com/ndrwnaguib/principia"
              >Show HN: Formalizing Principia Mathematica using Lean</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 18:49:30</span
              ><span class="points-container"
                >Points: <span class="points">174</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43797256"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                <a href="https://ndrwnaguib.com/principia/"
                  >https://ndrwnaguib.com/principia/</a
                >
              </p>
              <p>
                <a href="https://github.com/ndrwnaguib/principia"
                  >https://github.com/ndrwnaguib/principia</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43796935">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2504.11651"
              >Lossless LLM compression for efficient GPU inference via
              dynamic-length float</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 18:20:53</span
              ><span class="points-container"
                >Points: <span class="points">388</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43796935"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43795300">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-025-01266-x"
              >Reproducibility project fails to validate dozens of biomedical
              studies</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 16:14:08</span
              ><span class="points-container"
                >Points: <span class="points">253</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43795300"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43791992">
          <h3>
            <a class="item" href="https://clevercoloringbook.com/"
              >Show HN: I used OpenAI's new image API for a personalized
              coloring book service</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 10:05:39</span
              ><span class="points-container"
                >Points: <span class="points">296</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43791992"
                  >Comments</a
                ><span class="descendants">: 167</span></span
              >
            </h4>
            <div class="text">
              <p>
                Last month, when OpenAI's Sora was released for public use I
                (foolishly) thought I'd manually drag-and-drop each order’s
                photos into Sora's UI and copy the resulting images back into my
                system. This took way too much time (about an hour for each of
                the few books I made and tested with family and friends). It
                clearly wasn't possible to release this version because I’d be
                losing a huge amount of time on every order. So instead, I
                decided I'd finish off the project as best I could, put it "on
                ice," and wait for the API release.
              </p>
              <p>
                The API is now released (quicker than I thought it'd be, too!)
                and I integrated it last night. I'd love your feedback on any
                and all aspects.
              </p>
              <p>
                The market is mostly family-based, but from my testing of the
                physical book I've found that both adults and kids enjoy
                coloring them in (it's surprisingly cathartic and creative). If
                you would like to order one you can get 10% off by tapping the
                total price line item five times.
              </p>
            </div>
          </section>
        </section>
        <section id="43791474">
          <h3>
            <a
              class="item"
              href="https://addyo.substack.com/p/avoiding-skill-atrophy-in-the-age"
              >Avoiding skill atrophy in the age of AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-25 @ 08:30:54</span
              ><span class="points-container"
                >Points: <span class="points">297</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43791474"
                  >Comments</a
                ><span class="descendants">: 288</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
