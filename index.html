<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39420385">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/munificent/b1bcd969063da3e6c298be070a22b604"
              >A random dungeon generator that fits on a business card</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 16:34:13</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39420385"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39420319">
          <h3>
            <a
              class="item"
              href="https://jacobin.com/2024/02/yanis-varoufakis-techno-feudalism-capitalism-interview/"
              >Are We Transitioning from Capitalism to Silicon Serfdom?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 16:27:45</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39420319"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39420060">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/story/she-wanted-to-make-her-frank-lloyd-wright-house-greener-heres-how-it-went-45eaf89e"
              >She Wanted to Make Her Frank Lloyd Wright House Greener</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 15:55:00</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39420060"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39419774">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/technology/2024/feb/17/no-focus-no-fights-and-a-bad-back-16-ways-technology-has-ruined-my-life-tim-dowling"
              >No focus, no fights, and a bad back â€“ 16 ways technology has
              ruined my life</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 15:25:04</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39419774"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39419210">
          <h3>
            <a
              class="item"
              href="https://www.esri.com/arcgis-blog/products/arcgis-living-atlas/mapping/access-over-181000-usgs-historical-topographic-maps/"
              >Access over 181,000 USGS Historical Topographic Maps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 14:12:21</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39419210"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39419195">
          <h3>
            <a class="item" href="https://yashkant.github.io/spad/"
              >SPAD: Spatially Aware Multiview Diffusers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 14:09:37</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39419195"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39419126">
          <h3>
            <a class="item" href="https://hn.moritz.pm"
              >Show HN: Hacker News Outliers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 13:59:15</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39419126"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
            <div class="text">
              <p><a href="https://hn.moritz.pm/">https://hn.moritz.pm/</a></p>
              <p>
                It's quite simple because I wanted to learn from the project.
                But I think it's useful, to get a summary of what was important
                over the last days.
              </p>
              <p>
                The UI is almost identical to the HN frontpage, you can click on
                the comments to view the thread and on the username to see the
                profile. The rest of the cards takes you to the submitted URL.
              </p>
            </div>
          </section>
        </section>
        <section id="39419098">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/Linux-Kernel-To-Rust-1.77"
              >The Linux Kernel Prepares for Rust 1.77 Upgrade</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 13:55:22</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39419098"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39419087">
          <h3>
            <a
              class="item"
              href="https://hbr.org/2024/02/stop-basing-your-self-worth-on-other-peoples-opinions"
              >Stop Basing Your Self-Worth on Other People's Opinions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 13:53:52</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39419087"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39419010">
          <h3>
            <a
              class="item"
              href="https://webassembly.github.io/spec/core/binary/instructions.html"
              >WASM Instructions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 13:44:54</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39419010"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418855">
          <h3>
            <a
              class="item"
              href="https://linuxiac.com/cosmic-desktop-slated-to-debut-with-popos-24-04-lts/"
              >Cosmic Desktop Is Slated to Debut with Pop _OS 24.04 LTS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 13:23:58</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418855"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418841">
          <h3>
            <a
              class="item"
              href="https://www.mydbops.com/blog/postgresql-schema-changes-with-pg_osc/"
              >Revolutionizing PostgreSQL Schema Changes with pg-osc</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 13:22:34</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418841"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418741">
          <h3>
            <a
              class="item"
              href="https://www.consilium.europa.eu/en/press/press-releases/2024/02/08/mercury-council-and-parliament-strike-a-deal-to-completely-phase-out-mercury-in-the-eu/"
              >Mercury: Council and Parliament strike a deal to phase out
              mercury in the EU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 13:09:03</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418741"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418632">
          <h3>
            <a
              class="item"
              href="https://stats.stackexchange.com/questions/639548/why-is-everything-based-on-likelihoods-even-though-likelihoods-are-so-small"
              >Why is everything based on likelihoods even though likelihoods
              are so small?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 12:53:30</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418632"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418530">
          <h3>
            <a class="item" href="https://www.photopea.com/"
              >PhotoPea: Advanced Image Editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 12:34:33</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418530"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418386">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/1e677a7e-9494-4f5b-a724-9e58ef26b34f"
              >EU to hit Apple with first ever fine in â‚¬500M penalty over music
              streaming</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 12:06:38</span
              ><span class="points-container"
                >Points: <span class="points">217</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418386"
                  >Comments</a
                ><span class="descendants">: 226</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418283">
          <h3>
            <a class="item" href="https://github.com/CorsixTH/CorsixTH"
              >CorsixTH: Open-source clone of Theme Hospital</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 11:45:03</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418283"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39418102">
          <h3>
            <a
              class="item"
              href="https://www.newsweek.com/clifford-stoll-why-web-wont-be-nirvana-185306"
              >The web won't be nirvana (1995)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 11:07:12</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39418102"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39417895">
          <h3>
            <a class="item" href="https://without.boats/blog/futures-unordered/"
              >FuturesUnordered and the Order of Futures</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 10:26:50</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39417895"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39417829">
          <h3>
            <a
              class="item"
              href="https://registerspill.thorstenball.com/p/from-1s-to-4ms"
              >Zed Editor: All Occurrences Search from 1s to 4ms</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 10:16:41</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39417829"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39417638">
          <h3>
            <a class="item" href="https://www.downloadyoutubesubtitle.com/"
              >Show HN: I create a free website for download YouTube transcript,
              subtitle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 09:41:09</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39417638"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39417503">
          <h3>
            <a
              class="item"
              href="https://adamobeng.com/wddbfs-mount-a-sqlite-database-as-a-filesystem/"
              >Wddbfs â€“ Mount a SQLite database as a filesystem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 09:15:33</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39417503"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39417420">
          <h3>
            <a
              class="item"
              href="https://brainbaking.com/post/2024/02/pimp-your-boardgame/"
              >Pimp Your Board Games</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 09:00:45</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39417420"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39417231">
          <h3>
            <a
              class="item"
              href="https://dev.arie.bovenberg.net/blog/python-datetime-pitfalls/"
              >Python datetime pitfalls, and what libraries are (not) doing
              about it</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 08:26:43</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39417231"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39416966">
          <h3>
            <a
              class="item"
              href="https://www.tctmagazine.com/additive-manufacturing-3d-printing-news/metal-additive-manufacturing-news/mit-researchers-demonstrate-rapid-liquid-metal-3d-printing-technique/"
              >MIT researchers demonstrate rapid liquid metal 3D printing
              technique</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 07:27:26</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39416966"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39416543">
          <h3>
            <a class="item" href="https://xeiaso.net/blog/2024/the-layoff/"
              >The Layoff</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-18 @ 05:44:58</span
              ><span class="points-container"
                >Points: <span class="points">336</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39416543"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39414532">
          <h3>
            <a
              class="item"
              href="https://vgel.me/posts/representation-engineering/"
              >Representation Engineering: Mistral-7B on Acid</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-17 @ 23:26:29</span
              ><span class="points-container"
                >Points: <span class="points">292</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39414532"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39413972">
          <h3>
            <a
              class="item"
              href="https://shekhargulati.com/2022/07/08/my-notes-on-gitlabs-postgres-schema-design/"
              >My notes on Gitlab's Postgres schema design (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-17 @ 22:05:23</span
              ><span class="points-container"
                >Points: <span class="points">430</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39413972"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39408162">
          <h3>
            <a
              class="item"
              href="https://coredumped.dev/2022/05/19/a-vision-of-a-multi-threaded-emacs/"
              >A vision of a multi-threaded Emacs (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-17 @ 10:20:49</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39408162"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39408099">
          <h3>
            <a class="item" href="https://treksit.com/index.html"
              >Treksit â€“ Interstellar puzzle based on Graph Theory</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-17 @ 10:09:45</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39408099"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
