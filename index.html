<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37297360">
          <h3>
            <a
              class="item"
              href="https://www.thefactsite.com/charles-darwin-eating-habits/"
              >Charles Darwin Ate One of Everything He Discovered</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 17:13:43</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37297360"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37297304">
          <h3>
            <a
              class="item"
              href="https://openai.com/blog/introducing-chatgpt-enterprise"
              >Introducing ChatGPT Enterprise</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 17:09:47</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37297304"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37297174">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/siphox/jobs/nFufcgs-siphox-kit-team-lead-director-level"
              >SiPhox (YC S20) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 17:00:12</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37296783">
          <h3>
            <a
              class="item"
              href="https://stratechery.com/2023/nvidia-on-the-mountaintop/"
              >Nvidia on the Mountaintop</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 16:36:17</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37296783"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37296401">
          <h3>
            <a class="item" href="https://fig.io/blog/post/fig-joins-aws"
              >Fig Has Joined AWS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 16:13:47</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37296401"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37296122">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2023/08/28/health/cancer-screenings-extend-life-wellness/index.html"
              >Most cancer screenings don’t extend life, study finds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 15:57:44</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37296122"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37295884">
          <h3>
            <a
              class="item"
              href="https://www.colino.net/wordpress/en/binary-release-of-mastodon-for-the-apple-c/"
              >MastApple//C, a Mastodon client for the Apple II (//C and ][e)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 15:42:21</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37295884"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37295611">
          <h3>
            <a class="item" href="https://www.sbcl.org/news.html#2.3.8"
              >Steel Bank Common Lisp 2.3.8 released: “a mark-region parallel GC
              is available”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 15:25:00</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37295611"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37295439">
          <h3>
            <a
              class="item"
              href="https://www.noq.dev/blog/cleaning-up-dead-bodies-in-aws-iam"
              >Cleaning Up Dead Bodies in AWS IAM</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 15:15:52</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37295439"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37295408">
          <h3>
            <a
              class="item"
              href="https://docs.confident-ai.com/docs/tutorials/evaluating-llamaindex"
              >Unit Test LlamaIndex with DeepEval</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 15:14:21</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37295408"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37295192">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/selfhosted/comments/163nxcm/continue_with_localai_an_alternative_to_githubs/"
              >Continue with LocalAI: An alternative to GitHub's Copilot that
              runs locally</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 15:03:39</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37295192"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37295149">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37295149"
              >Launch HN: HyLight (YC S23) – Hydrogen airships to inspect energy
              infrastructure</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 15:00:59</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37295149"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.hylight.aero">https://www.hylight.aero</a>).
              We build and operate autonomous hydrogen airships to inspect
              energy infrastructure like pipelines and power lines. Here’s a
              video:
              <a href="https://www.youtube.com/watch?v=SuW5ur8ER7A"
                >https://www.youtube.com/watch?v=SuW5ur8ER7A</a
              >.
              <p>
                Energy infrastructure operators (utility companies) struggle
                with conducting precise inspections of their assets. It is
                extremely important for them because they need to make sure that
                the network is in good condition to avoid outages and leaks.
                This infrastructure has big impacts when it is malfunctioning.
                For instance, methane leaks from oil and gas infrastructure
                represent 4% of global carbon emissions every year (and approx.
                $7B worth of losses in Northern America and Europe).
              </p>
              <p>
                Gas and power networks are physically so large (more than 47M
                miles globally) that millions of miles of inspections must be
                done each year. Currently the most used solution is helicopters
                (used on 90% of inspections). Helicopters are dangerous, have a
                high carbon footprint and are costly to use. Plus, helicopter
                service providers have to go as fast as they can to save their
                margins. So the data quality is not optimal at all.
              </p>
              <p>
                Our airship (the “HyLighter”) does exactly what is needed to
                gather a lot of precise information from the air. It flies
                slowly and can hover almost indefinitely, it consumes little
                energy, allowing great range for inspections. It can
                simultaneously mount all the sensors that are required for the
                inspections (HQ cameras, LiDAR, infrared, leak detection
                devices...). Plus, due to its size, we can write stuff on it to
                tell nearby residents what we are doing.
              </p>
              <p>
                How does it work? It is basically a drone airship. We use a
                lighter-than-air gas in the envelope (helium or hydrogen) for
                buoyancy. We have a H2 tank and fuel cell transforming H2 into
                power for all the systems. In terms of engines we built 2 gyros
                (gyroscopes engines) at the rear and front of the airship. They
                allow us to have vectorial thrust and therefore to be extremely
                maneuverable. The sensors are fixed under the HyLighter on
                gimbals and can easily “follow” the linear infrastructure that
                is inspected.
              </p>
              <p>
                When we began working on H2 and drones, we quickly realized that
                there was a problem with the weight of H2 tanks. The tanks have
                to be very strong to contain enough H2 which is extremely low in
                density. Then, we realized that we could use the "problem"
                inherent to H2 (very low density) to our advantage. We simply
                needed to use H2 as a lifting gas and power source. The envelope
                of the airship becomes the tank!
              </p>
              <p>
                The HyLighter is more efficient than other current solutions. As
                mentioned, helicopters are the most-used at present. Compared to
                those, we use less energy, emit less GHG, have better data
                quality, and less risks for human beings as the HyLighter is
                unmanned. Compared to quad drones, we have longer flight time
                and more payload, allowing for various simultaneous sensors
                collecting data—we can simultaneously mount all the sensors that
                are required for the inspections (HQ cameras, LiDAR, infrared,
                leak detection devices). Compared to plane drones, our flight
                speed is lower so we can collect better data and less ground
                risk. Compared to satellites, we have a lot more precision
                (actually they can't even be used for most of our operational
                use cases).
              </p>
              <p>
                The genesis of HyLight is that Théo wanted to work on new uses
                of H2 and drones when he was at school. He was joined by Martin
                who studied in the same engineering school, then by Josef who's
                Martin's BFF and then by me. I met Théo when we finished our
                studies in UC Berkeley last year and we all launched HyLight
                together. As we kept working on it, we gained more and more
                interest from pipeline and power line operators and we realized
                that there was indeed a big problem.
              </p>
              <p>
                HyLight is at the stage where we have our first POCs. Our first
                paid flight is in the coming weeks. Our business model is
                straightforward: inspection as a service. We charge a price per
                kilometer depending on length, location and type of data
                collected.
              </p>
              <p>
                I discovered HN not too long ago and I’m impressed with the
                engagement in tech and innovation of this community! I’m very
                interested to get your opinion on HyLight. Maybe some people
                work in the energy industry and know a thing or two about energy
                infra inspections that we could learn from? If so please tell us
                what you think, be it red flags or positive stuff! Also, as
                individuals, how would you feel seeing a big drone airship
                flying in the air near your home? We look forward to any and all
                comments!
              </p>
            </div>
          </section>
        </section>
        <section id="37295144">
          <h3>
            <a class="item" href="https://lfortran.org/"
              >Lfortran: Modern interactive LLVM-based Fortran compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 15:00:43</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37295144"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37295097">
          <h3>
            <a
              class="item"
              href="https://bit.kevinslin.com/p/opentelemetry-in-2023"
              >OpenTelemetry in 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 14:58:09</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37295097"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37294793">
          <h3>
            <a
              class="item"
              href="https://hakibenita.com/postgresql-unused-index-size"
              >Postgres: The Unexpected Find That Freed 20GB of Unused Index
              Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 14:42:04</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37294793"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37294440">
          <h3>
            <a
              class="item"
              href="https://scratchdb.com/blog/ansible-hetzner-deploys/"
              >Zero-Downtime Hetzner Deploys with Ansible</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 14:21:05</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37294440"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37293911">
          <h3>
            <a class="item" href="https://seacrew.github.io/helm-compose/"
              >Helm-Compose – The Docker-compose like tool for K8s
              development</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 13:48:44</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37293911"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37293294">
          <h3>
            <a class="item" href="https://olfconference.org/speakers/"
              >Ohio LinuxFest 2023 Conference Speakers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 13:03:31</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37293294"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37293072">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/australia-news/2023/aug/28/live-worm-living-womans-brain-australia-depression-forgetfulness"
              >Live worm found in Australian woman’s brain</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 12:39:20</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37293072"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37293002">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37293002"
              >Ask HN: My mother is slowly losing her eyesight, how to
              prepare?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 12:31:21</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37293002"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
            <div class="text">
              <p>
                My mother has a degenerative illness that is slowly going to
                lower here eyesight (starting from the center of the retina). We
                are not sure how far this is going to go.
              </p>
              <p>
                She is an avid reader (several books every month) and this is
                what I would like to address in the first place. Then there are
                the other aspects that are less technical but are
                <i>very much</i> welcome as well.
              </p>
              <p>
                She reads on a Kobo (or similar device) and the fact that she
                can make the fonts bigger is already a good thing. She will
                probably continue to do so (hopefully to get to the point where
                she will have to spell each word...).
              </p>
              <p>
                She also solves quite a lot of "literature oriented" quizzes
                (similar to crosswords) - today this is on paper but I will need
                to find a way for her to move online.
              </p>
              <p>
                I would appreciate any tricks or solutions for non-technical
                people like her that could make her life easier.
              </p>
            </div>
          </section>
        </section>
        <section id="37292864">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-08-trees-seeds-secrets-mast-seeding.html"
              >Trees guard their seeds: Unlocking the secrets of mast seeding</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 12:14:45</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37292864"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37292379">
          <h3>
            <a
              class="item"
              href="https://www.feststelltaste.de/how-to-find-time-to-learn-after-work/"
              >How to find time to learn after work (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 11:19:10</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37292379"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37291765">
          <h3>
            <a
              class="item"
              href="https://www.canva.dev/blog/engineering/we-put-half-a-million-files-in-one-git-repository-heres-what-we-learned/"
              >We put half a million files in one Git repository (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 09:46:41</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37291765"
                  >Comments</a
                ><span class="descendants">: 128</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37291504">
          <h3>
            <a class="item" href="https://fortran-lang.org/en/index.html"
              >Fortran</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 09:01:40</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37291504"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37291007">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/culture/2023/08/the-strange-secretive-world-of-north-korean-science-fiction/"
              >The secretive world of North Korean science fiction</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 07:39:51</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37291007"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37290356">
          <h3>
            <a
              class="item"
              href="https://learnbyexample.github.io/learn_gnuawk/awk-introduction.html"
              >CLI text processing with GNU awk</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 06:02:36</span
              ><span class="points-container"
                >Points: <span class="points">324</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37290356"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37289742">
          <h3>
            <a
              class="item"
              href="https://www.noemamag.com/finding-hope-in-the-dark-power-of-fungus/"
              >Finding Hope in the Dark Power of Fungus</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 04:23:05</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37289742"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37289321">
          <h3>
            <a class="item" href="https://github.com/danog/php-tokio"
              >PHP-Tokio – Use any async Rust library from PHP</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 03:18:34</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37289321"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37289067">
          <h3>
            <a
              class="item"
              href="https://www.westpoint.edu/news/press-releases/west-point-discovers-time-capsule-monument-base"
              >West Point discovers time capsule from 1828</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-28 @ 02:38:40</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37289067"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37286074">
          <h3>
            <a
              class="item"
              href="https://www.math.uci.edu/~rvershyn/teaching/hdp/hdp.html"
              >High-Dimensional Probability and Applications in Data Science</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 19:58:17</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37286074"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
