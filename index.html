<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40502956">
          <h3>
            <a class="item" href="https://github.com/openkoda/openkoda"
              >Show HN: We're building your open-source, private Salesforce</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 17:11:56</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40502956"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40502858">
          <h3>
            <a class="item" href="https://www.workatastartup.com/jobs/66397"
              >Linum (YC W23) is a hiring a founding AI engineer to train
              text-to-video models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 17:00:50</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40502794">
          <h3>
            <a
              class="item"
              href="https://twitter.com/janleike/status/1795497960509448617"
              >Jan Leike joins Anthropic on their superalignment team</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 16:54:51</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40502794"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40502776">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/legal/us-court-hear-challenges-potential-tiktok-ban-september-2024-05-28/"
              >US court to hear challenges to potential TikTok ban in
              September</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 16:53:35</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40502776"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40502090">
          <h3>
            <a
              class="item"
              href="https://twitter.com/karpathy/status/1795484547267834137"
              >Reproduce GPT-2 in llm.c</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 15:58:46</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40502090"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40501561">
          <h3>
            <a
              class="item"
              href="https://blog.r-project.org/2024/05/17/generalizing-support-for-functional-oop-in-r/index.html"
              >Generalizing Support for Functional OOP in R</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 15:19:00</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40501561"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40501379">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/biology/orcas-killer-whales-boats/"
              >Free time, curiosity and playfulness has led to young orcas
              bumping boats</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 15:02:08</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40501379"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40501375">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/paypal-is-planning-an-ad-business-using-data-on-its-millions-of-shoppers-cc5e0625"
              >PayPal is planning an ad business using data on its shoppers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 15:01:52</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40501375"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40501164">
          <h3>
            <a class="item" href="https://github.com/turbo9team/turbo9"
              >Turbo9 – A Compact and Efficient Pipelined 6809 Microprocessor
              IP</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 14:39:14</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40501164"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40501027">
          <h3>
            <a class="item" href="https://f-droid.org/2024/05/24/mobifree.html"
              >Mobifree – An open-source mobile ecosystem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 14:24:24</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40501027"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40501021">
          <h3>
            <a class="item" href="https://grooved.okat.best/"
              >Show HN: I made a free app to calibrate your turntable by simply
              playing a song</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 14:23:28</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40501021"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
            <div class="text">
              <p>
                I made a little app that lets you to calibrate your turntable by
                putting on any record and tapping a button. It's called Grooved
                and it uses your phone's microphone to see how fast your platter
                is going, almost like magic.
              </p>
              <p>
                You can see what it looks like in action here:
                <a
                  href="https://twitter.com/OKatBest/status/1795453042994680148"
                  >https://twitter.com/OKatBest/status/1795453042994680148</a
                >
              </p>
              <p>
                The app itself is free without ads, subscriptions, or trackers.
                It's a tool I built for myself, and I just thought someone else
                might want to use it too. I have never seen this technology
                being used before, all other apps require you to either print
                something and use the camera, or to place your phone on the
                spinning platter and use the accelerometer.
              </p>
              <p>
                You can grab it on the App Store, and I am working on an Android
                version I hope to release at some point in June.
              </p>
              <p>Would love to hear what you think about it!</p>
              <p>Ivan_</p>
            </div>
          </section>
        </section>
        <section id="40501015">
          <h3>
            <a
              class="item"
              href="https://eos.org/science-updates/an-air-quality-model-that-is-evolving-with-the-times"
              >An air quality model that is evolving with the times</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 14:22:52</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40501015"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40500997">
          <h3>
            <a class="item" href="https://astrid.tech/2024/05/28/0/ping-ff02-1/"
              >Ping Ff02:1</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 14:21:38</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40500997"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40499130">
          <h3>
            <a
              class="item"
              href="https://wasmi-labs.github.io/blog/posts/wasmi-v0.32/"
              >Wasmi v0.32: WebAssembly interpreter is now faster than ever</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 10:06:37</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40499130"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40498933">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2405.15838"
              >What You Shouldn't Know About Quantum Computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 09:23:24</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40498933"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40498580">
          <h3>
            <a class="item" href="https://www.file0.dev"
              >Show HN: File0 – An easier way to manage files in serverless
              apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 08:17:00</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40498580"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
            <div class="text">
              <p>
                I can't be asked, so I built FILE0. It's for storing files but
                you don't need to complete an online course.
              </p>
            </div>
          </section>
        </section>
        <section id="40497171">
          <h3>
            <a
              class="item"
              href="http://oldvcr.blogspot.com/2024/05/refurb-weekend-canon-cat.html"
              >Refurb Weekend: Canon Cat</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 03:55:01</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40497171"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40497117">
          <h3>
            <a
              class="item"
              href="https://users.math.yale.edu/public_html/People/frame/Fractals/"
              >Fractal Geometry</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 03:41:31</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40497117"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40496660">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-05-succeed-accurately-dating-year-prehistoric.html"
              >Researchers accurately dating a 7k-year-old settlement using
              cosmic rays</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 02:00:13</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40496660"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40496150">
          <h3>
            <a class="item" href="https://github.com/dlvhdr/gh-dash"
              >Gh-dash: A beautiful CLI dashboard for GitHub</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-28 @ 00:25:27</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40496150"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40495149">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2405.15071"
              >Grokked Transformers Are Implicit Reasoners</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-27 @ 21:58:32</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40495149"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40492515">
          <h3>
            <a
              class="item"
              href="https://blog.jgc.org/2024/05/controlling-taylor-swift-eras-tour.html"
              >Controlling the Taylor Swift Eras Tour wristbands with Flipper
              Zero</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-27 @ 16:55:59</span
              ><span class="points-container"
                >Points: <span class="points">893</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40492515"
                  >Comments</a
                ><span class="descendants">: 225</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40492234">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2405.14975"
              >Surveilling the masses with wi-fi-based positioning systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-27 @ 16:25:53</span
              ><span class="points-container"
                >Points: <span class="points">378</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40492234"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40491694">
          <h3>
            <a
              class="item"
              href="https://blog.ploetzli.ch/2024/should-i-use-jwt-for-authentication/"
              >Should I use JWTs for authentication tokens?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-27 @ 15:31:24</span
              ><span class="points-container"
                >Points: <span class="points">505</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40491694"
                  >Comments</a
                ><span class="descendants">: 347</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40491038">
          <h3>
            <a
              class="item"
              href="https://blog.benjojo.co.uk/post/class-e-addresses-in-the-real-world"
              >Reclaiming IPv4 Class E's 240.0.0.0/4</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-27 @ 14:28:02</span
              ><span class="points-container"
                >Points: <span class="points">230</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40491038"
                  >Comments</a
                ><span class="descendants">: 290</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40486068">
          <h3>
            <a
              class="item"
              href="https://maskray.me/blog/2024-05-26-evolution-of-elf-object-file-format"
              >Evolution of the ELF object file format</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-26 @ 22:42:36</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40486068"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40478175">
          <h3>
            <a class="item" href="https://github.com/grego/sumtype.h"
              >Show HN: Sum (algebraic) types for C in one 100 line header</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-25 @ 21:58:20</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40478175"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40473381">
          <h3>
            <a
              class="item"
              href="http://neopythonic.blogspot.com/2009/04/tail-recursion-elimination.html"
              >Tail Recursion Elimination (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-25 @ 07:54:10</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40473381"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40470237">
          <h3>
            <a
              class="item"
              href="https://blog.gingerbeardman.com/2024/05/24/emigre-typography-and-graphic-design-magazine-1984-2005/"
              >Emigre typography and graphic design magazine (1984–2005)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-24 @ 20:30:00</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40470237"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40468066">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/how-often-do-supernovas-strike-earth/"
              >Surprising supernova scars cover the Earth</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-05-24 @ 16:56:42</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40468066"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
