<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35922207">
          <h3>
            <a
              class="item"
              href="https://sschueller.github.io/posts/ci-cd-with-kicad-and-gitlab/"
              >CI/CD with KiCad and Gitlab</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 20:49:49</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35922207"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35922020">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/business/2023/05/11/how-fast-can-european-steelmakers-decarbonise"
              >How fast can European steelmakers decarbonise?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 20:36:57</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35922020"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35921828">
          <h3>
            <a
              class="item"
              href="https://blog.koehntopp.info/2023/05/12/50-years-in-filesystems-1994.html"
              >The SGI XFS Filesystem</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 20:21:45</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35921828"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35921538">
          <h3>
            <a class="item" href="https://grinfeld.org/strang/"
              >Gilbert Strang's final lecture at MIT: May 15, 11:00am</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 20:01:29</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35921538"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35920844">
          <h3>
            <a class="item" href="https://sorry.idont.date/"
              >Open-source disposable email service</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 19:13:06</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35920844"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35920811">
          <h3>
            <a
              class="item"
              href="https://atlarge-research.com/pdfs/2022-systor-apis.pdf"
              >Understanding Modern Storage APIs: A systematic study of libaio,
              SPDK, io_uring [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 19:10:32</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35920811"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35920773">
          <h3>
            <a class="item" href="https://crates.io/crates/hyper"
              >Hyper – A fast and correct HTTP implementation for Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 19:07:51</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35920773"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35920261">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/in-memoriam-may-2023"
              >Morris Tanenbaum, inventor of the silicon transistor, has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 18:32:59</span
              ><span class="points-container"
                >Points: <span class="points">265</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35920261"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35920082">
          <h3>
            <a class="item" href="https://github.com/windmill-labs/windmill"
              >Windmill: Open-source developer platform to turn scripts into
              workflows and UIs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 18:20:44</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35920082"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35919667">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2305.06946"
              >Exploring the native use of 64-bit posit arithmetic in scientific
              computing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 17:57:22</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35919667"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35919492">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/how-ai-knows-things-no-one-told-it/"
              >How AI knows things no one told it</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 17:44:45</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35919492"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35919311">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-01569-x"
              >Hammerhead sharks are first fish found to ‘hold their breath’</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 17:33:42</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35919311"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35919227">
          <h3>
            <a
              class="item"
              href="https://github.com/hleb-kastseika/tg-channel-to-rss"
              >AWS Lambda function for converting of Telegram channel to RSS
              feed</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 17:27:30</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35919227"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35919133">
          <h3>
            <a
              class="item"
              href="https://www.bleepingcomputer.com/news/security/toyota-car-location-data-of-2-million-customers-exposed-for-ten-years/"
              >Toyota: Car location data and videos of 2M customers exposed for
              ten years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 17:21:07</span
              ><span class="points-container"
                >Points: <span class="points">317</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35919133"
                  >Comments</a
                ><span class="descendants">: 184</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35918660">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/blog-post/vaccine-pancreatic-cancer-treatment"
              >A vaccine for pancreatic cancer treatment?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 16:44:05</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35918660"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35918450">
          <h3>
            <a class="item" href="https://asymptote.sourceforge.io/"
              >Asymptote: 2D and 3D TeX-Aware Vector Graphics Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 16:29:36</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35918450"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35917912">
          <h3>
            <a
              class="item"
              href="https://twitter.com/elonmusk/status/1657050349608501249"
              >Linda Yaccarino is the new CEO of Twitter</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 15:51:20</span
              ><span class="points-container"
                >Points: <span class="points">375</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35917912"
                  >Comments</a
                ><span class="descendants">: 778</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35917361">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/05/11/technology/us-chiplets-tech.html"
              >U.S. focuses on invigorating ‘chiplets’ to stay cutting-edge in
              tech</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 15:09:11</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35917361"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35916064">
          <h3>
            <a class="item" href="https://implement-dns.wizardzines.com/"
              >Implement DNS in a Weekend</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 13:37:45</span
              ><span class="points-container"
                >Points: <span class="points">455</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35916064"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35915923">
          <h3>
            <a
              class="item"
              href="https://microcorelabs.wordpress.com/2023/04/28/ibm-pc-8088-replaced-with-a-motorola-68000/"
              >IBM PC 8088 replaced with a Motorola 68000</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 13:25:54</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35915923"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35915492">
          <h3>
            <a
              class="item"
              href="https://www.thebaltimorebanner.com/community/criminal-justice/baltimore-lawsuit-hyundai-kia-thefts-WQ74KXUXTBGB3JOTHQHEGIPT6M/"
              >Baltimore sues Hyundai, Kia over spike in car thefts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 12:52:09</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35915492"
                  >Comments</a
                ><span class="descendants">: 307</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35915191">
          <h3>
            <a class="item" href="https://github.com/digital-fabric/polyphony"
              >Polyphony: Fine-Grained Concurrency for Ruby</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 12:26:43</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35915191"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35914997">
          <h3>
            <a
              class="item"
              href="https://eclecticlight.co/2023/05/12/has-apple-sounded-the-last-post/"
              >Has Apple sounded the last POST?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 12:06:14</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35914997"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35914929">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35914929"
              >Kalshi (YC W19) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 12:00:05</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <a href="http://kalshi.com/careers">http://kalshi.com/careers</a>
              - if you don't see a role that aligns, feel free to drop a
              "Generic Application"
              <p>
                We're a regulated financial exchange, and the first to allow
                people to trade directly on economic events such as inflation,
                interest rates, whether the debt ceiling will be raised, whether
                student loans will be forgiven, and more. If you're hungry and
                want to build the next stage of financial markets, reach out!
              </p>
            </div>
          </section>
        </section>
        <section id="35914447">
          <h3>
            <a class="item" href="https://zlib.net/pigz/"
              >Pigz: Parallel gzip for modern multi-processor, multi-core
              machines</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 10:51:40</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35914447"
                  >Comments</a
                ><span class="descendants">: 162</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35913485">
          <h3>
            <a class="item" href="https://ochagavia.nl/blog/hangman-over-quic/"
              >Hangman over QUIC</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 08:27:49</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35913485"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35913188">
          <h3>
            <a
              class="item"
              href="https://www.nybooks.com/articles/1992/12/17/the-one-and-only-2/"
              >The Life and Science of Richard Feynman (1992)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 07:43:15</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35913188"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35913083">
          <h3>
            <a
              class="item"
              href="https://www.chicagomag.com/chicago-magazine/may-2023/the-last-gamble-of-tokyo-joe/"
              >The Last Gamble of Tokyo Joe</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-12 @ 07:28:04</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35913083"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35906783">
          <h3>
            <a
              class="item"
              href="https://tedgioia.substack.com/p/how-an-ibm-computer-learned-to-sing"
              >An IBM computer learned to sing in 1961</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-11 @ 19:02:42</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35906783"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35893819">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/ai/musiclm-google-ai-test-kitchen/"
              >Turn ideas into music with MusicLM</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-10 @ 21:32:09</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35893819"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
