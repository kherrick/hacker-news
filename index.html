<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41008527">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/aviator/jobs"
              >Aviator (YC S21) Is hiring engineers to build the DevEx
              platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 17:00:06</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41008488">
          <h3>
            <a
              class="item"
              href="https://agourlay.github.io/ruxguitar-tablature-player/"
              >Playing Guitar Tablatures in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 16:57:11</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41008488"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41007980">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/article/2024/jul/17/signs-of-two-gases-phosphine-ammonia-in-clouds-of-venus-life"
              >Signs of two gases in clouds of Venus could indicate life,
              scientists say</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 16:14:08</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41007980"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41007828">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41586-024-07701-9"
              >Deletion of Il11 extended the lives of mice by 25%</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 16:02:10</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41007828"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41007403">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41007403"
              >Show HN: Sendune – open-source HTML email designer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 15:22:40</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41007403"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
            <div class="text">
              <a href="https://designer.sendune.com/"
                >https://designer.sendune.com/</a
              >
              Code:
              <a
                href="https://github.com/SendWithSES/Drag-and-Drop-Email-Designer"
                >https://github.com/SendWithSES/Drag-and-Drop-Email-Designer</a
              >
              <p>
                HTML for email is probably the hardest code to write. Even a
                teeny-tiny deviation from the rules will break the email in
                untold combination of os/desktop/mobile clients.
              </p>
              <p>
                It's mid 2024. Almost 50 years since email was invented and 35
                years since HTML was born. A
                'basic-open-source-HTML-email-designer' must be a solved
                problem, right? We thought so too.
              </p>
              <p>Sadly, that's not the case.</p>
              <p>
                There are a few decent open source email designers but they
                carry dependencies that make them cumbersome to embed within
                your app. That's why we decided to open source our HTML Email
                Designer.
              </p>
              <p>
                The SENDUNE email designer focuses on simplicity and ease of
                use. It is light-weight. It does pure HTML - no intermediate
                code wranglers like mjml. There is no lock-in of any kind. Save
                HTML output as a template and use with ANY email service
                provider.
              </p>
              <p>
                Feel free to fork the repository, make improvements, and submit
                pull requests.
              </p>
              <p>AMA: hello at sendune dot com</p>
            </div>
          </section>
        </section>
        <section id="41007348">
          <h3>
            <a
              class="item"
              href="https://www.cnx-software.com/2024/07/19/radxa-x4-low-cost-credit-card-sized-intel-n100-sbc-raspberry-pi-5-alternative/"
              >Radxa X4 low-cost, credit card-sized Intel N100 SBC goes for $60
              and up</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 15:16:16</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41007348"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41006946">
          <h3>
            <a
              class="item"
              href="https://coroot.com/blog/instrumenting-python-gil-with-ebpf"
              >Instrumenting Python GIL with eBPF</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 14:31:04</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41006946"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41006552">
          <h3>
            <a
              class="item"
              href="https://www.jpl.nasa.gov/news/nasas-curiosity-rover-discovers-a-surprise-in-a-martian-rock"
              >NASA's Curiosity rover discovers a surprise in a Martian rock</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 13:47:48</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41006552"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41006308">
          <h3>
            <a
              class="item"
              href="https://marcan.st/2017/12/debugging-an-evil-go-runtime-bug/"
              >Debugging an evil Go runtime bug: From heat guns to kernel
              compiler flags</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 13:24:40</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41006308"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41005181">
          <h3>
            <a
              class="item"
              href="https://worthrises.org/pressreleases/2024/7/18/fcc-votes-unanimously-to-significantly-lower-phone-and-video-communication-costs-after-decades-of-exploitation-by-prison-telecoms"
              >FCC votes to limit prison telecom charges</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 11:33:45</span
              ><span class="points-container"
                >Points: <span class="points">634</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41005181"
                  >Comments</a
                ><span class="descendants">: 267</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41003055">
          <h3>
            <a class="item" href="https://www.theendpoem.com/"
              >End Poem by Julian Gough</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 07:48:25</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41003055"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41002273">
          <h3>
            <a class="item" href="https://johnfactotum.github.io/foliate/"
              >Foliate: Read e-books in style, navigate with ease</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 05:48:08</span
              ><span class="points-container"
                >Points: <span class="points">457</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41002273"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41002195">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/crowdstrike/comments/1e6vmkf/bsod_error_in_latest_crowdstrike_update/"
              >Crowdstrike Update: Windows Bluescreen and Boot Loops</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 05:26:13</span
              ><span class="points-container"
                >Points: <span class="points">3239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41002195"
                  >Comments</a
                ><span class="descendants">: 2549</span></span
              >
            </h4>
            <div class="text">
              <p>
                My laptop blue-screened and rebooted, but is working fine after
                the reboot.
              </p>
              <p>
                A local radio station has also said they've got the same issues
                with their laptops and their phone system is down as a result.
              </p>
              <p>
                Not seeing anything on news sites yet. Anyone else seeing
                similar?
              </p>
              <p>Above is all based in Australia.</p>
            </div>
          </section>
        </section>
        <section id="41001780">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/the-nash-equilibrium-is-the-optimal-poker-strategy-expert-players-dont-always-use-it/"
              >Professional poker players know the optimal strategy but don't
              always use it</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 03:17:18</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41001780"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41001559">
          <h3>
            <a class="item" href="https://github.com/thegoodduck/NetSour"
              >Show HN: NetSour, CLI Based Wireshark</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-19 @ 02:17:29</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41001559"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              This code is still in early beta, but i sincerley hope it will
              become as ubiquitous as VIM on Linux.
            </div>
          </section>
        </section>
        <section id="41000846">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/science/archive/2024/07/animal-naming-elephant-consciousness-language/679075/"
              >Elephants use namelike calls</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 23:53:36</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41000846"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40999928">
          <h3>
            <a
              class="item"
              href="https://www.esa.int/Enabling_Support/Operations/Double_trouble_Gaia_hit_by_micrometeoroid_and_solar_storm"
              >Double trouble: ESA's Gaia hit by micrometeoroid and solar
              storm</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 21:27:08</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40999928"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40998927">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/what-would-it-take-to-recreate-bell"
              >What would it take to recreate Bell Labs?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 19:28:21</span
              ><span class="points-container"
                >Points: <span class="points">301</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40998927"
                  >Comments</a
                ><span class="descendants">: 236</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40998647">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/07/18/usps-shared-customer-postal-addresses-with-meta-linkedin-and-snap/"
              >USPS shared customer postal addresses with Meta, LinkedIn and
              Snap</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 18:56:33</span
              ><span class="points-container"
                >Points: <span class="points">377</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40998647"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40998497">
          <h3>
            <a
              class="item"
              href="https://twitter.com/mutableai/status/1813815706783490055"
              >Show HN: How we leapfrogged traditional vector based RAG with a
              'language map'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 18:40:14</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40998497"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
            <div class="text">
              <p>
                Part of our mission at Mutable.ai is to make it much easier for
                developers to build and understand software. One of the natural
                ways to do this is to create a codebase chat, that answer
                questions about your repo and help you build features.
              </p>
              <p>
                It might seem simple to plug in your codebase into a
                state-of-the-art LLM, but LLMs have two limitations that make
                human-level assistance with code difficult:
              </p>
              <p>
                1. They currently have context windows that are too small to
                accommodate most codebases, let alone your entire organization's
                codebases.
              </p>
              <p>
                2. They need to reason immediately to answer any questions
                without thinking through the answer "step-by-step."
              </p>
              <p>
                We built a chat sometime a year ago based on keyword retrieval
                and vector embeddings. No matter how hard we tried, including
                training our own dedicated embedding model, we could not get the
                chat to get us good performance.
              </p>
              <p>
                Here is a typical example:
                <a
                  href="https://x.com/mutableai/article/1813815706783490055/media/1813813912472870913"
                  >https://x.com/mutableai/article/1813815706783490055/media/18...</a
                >
              </p>
              <p>
                If you ask how to do quantization in llama.cpp the answers were
                oddly specific and seemed to pull in the wrong context
                consistently, especially from tests. We could, of course, take
                countermeasures, but it felt like a losing battle.
              </p>
              <p>
                So we went back to step 1, let’s understand the code, let’s do
                our homework, and for us, that meant actually putting an
                understanding of the codebase down in a document — a
                Wikipedia-style article — called Auto Wiki. The wiki features
                diagrams and citations to your codebase. Example:
                <a href="https://wiki.mutable.ai/ggerganov/llama.cpp"
                  >https://wiki.mutable.ai/ggerganov/llama.cpp</a
                >
              </p>
              <p>
                This wiki is useful in and of itself for onboarding and
                understanding the business logic of a codebase, but one of the
                hopes for constructing such a document was that we’d be able to
                circumvent traditional keyword and vector-based RAG approaches.
              </p>
              <p>
                It turns out using a wiki to find context for an LLM overcomes
                many of the weaknesses of our previous approach, while still
                scaling to arbitrarily large codebases:
              </p>
              <p>
                1. Instead of context retrieval through vectors or keywords, the
                context is retrieved by looking at the sources that the wiki
                cites. 2. The answers are based both on the section(s) of the
                wiki that are relevant AND the content of the actual code that
                we put into memory — this functions as a “language map” of the
                codebase.
              </p>
              <p>
                See it in action below for the same query as our old codebase
                chat:
              </p>
              <p>
                <a
                  href="https://x.com/mutableai/article/1813815706783490055/media/1813814321144844288"
                  >https://x.com/mutableai/article/1813815706783490055/media/18...</a
                >
              </p>
              <p>
                <a
                  href="https://x.com/mutableai/article/1813815706783490055/media/1813814363939315712"
                  >https://x.com/mutableai/article/1813815706783490055/media/18...</a
                >
              </p>
              <p>
                The answer cites it sources in both the wiki and the actual code
                and gives a step by step guide to doing quantization with
                example code.
              </p>
              <p>
                The quality of the answer is dramatically improved - it is more
                accurate, relevant, and comprehensive.
              </p>
              <p>
                It turns out language models love being given language and not a
                bunch of text snippets that are nearby in vector space or that
                have certain keywords! We find strong performance consistently
                across codebases of all sizes. The results from the chat are so
                good they even surprised us a little bit - you should check it
                out on a codebase of your own, at
                <a href="https://wiki.mutable.ai">https://wiki.mutable.ai</a>,
                which we are happy to do for free for open source code, and
                starts at just $2/mo/repo for private repos.
              </p>
              <p>
                We are introducing evals demonstrating how much better our chat
                is with this approach, but were so happy with the results we
                wanted to share with the whole community.
              </p>
              <p>Thank you!</p>
            </div>
          </section>
        </section>
        <section id="40998158">
          <h3>
            <a class="item" href="https://github.com/quackduck/devzat"
              >Devzat – Chat over SSH, with some nice quality-of-life
              features</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 17:58:52</span
              ><span class="points-container"
                >Points: <span class="points">390</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40998158"
                  >Comments</a
                ><span class="descendants">: 92</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40997850">
          <h3>
            <a class="item" href="https://github.com/soupslurpr/Transcribro"
              >Transcribro: On-device Accurate Speech-to-text</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 17:25:15</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40997850"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40997087">
          <h3>
            <a
              class="item"
              href="https://compoundsemiconductor.net/article/119170/Polychromatic_pixels"
              >Polychromatic Pixels</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 16:11:41</span
              ><span class="points-container"
                >Points: <span class="points">188</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40997087"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40995982">
          <h3>
            <a class="item" href="https://research.swtch.com/bisect"
              >Hash-based bisect debugging in compilers and runtimes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 14:36:58</span
              ><span class="points-container"
                >Points: <span class="points">229</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40995982"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40995955">
          <h3>
            <a
              class="item"
              href="https://ras.ac.uk/news-and-press/news/want-spot-deepfake-look-stars-their-eyes"
              >Want to spot a deepfake? Look for the stars in their eyes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-18 @ 14:34:42</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40995955"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40985017">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2407.09025"
              >SpreadsheetLLM: Encoding Spreadsheets for Large Language
              Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-17 @ 12:16:18</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40985017"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40978820">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=mUKRPoQKynk"
              >10-acre underground home and gardens in Fresno (2023) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-16 @ 18:07:57</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40978820"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40968922">
          <h3>
            <a
              class="item"
              href="https://github.com/veggiedefender/open-and-shut"
              >Type in Morse code by repeatedly slamming your laptop shut</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-15 @ 15:47:38</span
              ><span class="points-container"
                >Points: <span class="points">697</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40968922"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40968215">
          <h3>
            <a
              class="item"
              href="https://interjectedfuture.com/visual-programming-should-start-in-the-debugger/"
              >Visual programming should start in the debugger</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-15 @ 14:32:37</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40968215"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40967935">
          <h3>
            <a
              class="item"
              href="https://www.tandfonline.com/doi/full/10.1080/01611194.2024.2351117?src=exp-la"
              >Artificial neural network approach to finding the key length of
              Vigenère cipher</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-15 @ 13:55:43</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40967935"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
