<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38801519">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/medical/carbon-nanotube-foam-helmet-liner-concussion/"
              >Novel helmet liner 30 times better at stopping concussions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-29 @ 03:34:27</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38801519"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38801275">
          <h3>
            <a
              class="item"
              href="https://www.kaspersky.com/about/press-releases/2023_kaspersky-discloses-iphone-hardware-feature-vital-in-operation-triangulation-case"
              >Kaspersky discloses iPhone hardware feature vital in Operation
              Triangulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-29 @ 02:45:16</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38801275"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38800438">
          <h3>
            <a
              class="item"
              href="https://ethresear.ch/t/sticking-to-8192-signatures-per-slot-post-ssf-how-and-why/17989"
              >Vitalik Buterin proposes to make Ethereum PoS 'lighter and
              simpler'</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-29 @ 00:28:27</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38800438"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38799686">
          <h3>
            <a class="item" href="http://luc.devroye.org/fonts-51468.html"
              >Smallest Typeface</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 22:44:57</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38799686"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38798600">
          <h3>
            <a class="item" href="https://www.electronicsfleamarket.com"
              >Electronics Flea Market</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 21:05:22</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38798600"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38798496">
          <h3>
            <a class="item" href="https://graphwords.com"
              >GraphWords: Visual Dictionary and Thesaurus</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 20:56:51</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38798496"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38798489">
          <h3>
            <a class="item" href="http://mmos.ch/"
              >Multiplayer Online Science</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 20:56:18</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38798489"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38798383">
          <h3>
            <a class="item" href="https://learnbchs.org/"
              >BCHS software stack: BSD, C, httpd, SQLite</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 20:47:24</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38798383"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38797472">
          <h3><a class="item" href="https://hexcodle.com/">Hexcodle</a></h3>
          <section>
            <h4>
              <span>2023-12-28 @ 19:29:14</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38797472"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38797076">
          <h3>
            <a class="item" href="https://github.com/atc1441/ATCmiBand8fw"
              >Custom firmware for MI fitness band</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 18:54:53</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38797076"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38796870">
          <h3>
            <a class="item" href="http://www.liero.be/"
              >Liero – Sling'n'shoot Worms Game</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 18:40:30</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38796870"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38796075">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/the-technological-innovations-that"
              >Technological innovations that produced the shale revolution</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 17:44:20</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38796075"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38795559">
          <h3>
            <a class="item" href="https://osmapp.org"
              >OsmAPP – A Universal OpenStreetMap App</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 17:05:25</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38795559"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38795516">
          <h3>
            <a
              class="item"
              href="https://x.com/ArjunMahadevan/status/1737555905900658815?s=20"
              >Doola a "Business-in-a-Box" (YC S20) Is Hiring a CPA</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 17:01:07</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38794733">
          <h3>
            <a class="item" href="https://anytype.io/"
              >Show HN: Anytype – local-first, P2P knowledge management</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 16:00:21</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38794733"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
            <div class="text">
              <p>
                Anytype fulfils the seven ideals of local first software from
                here -
                <a href="https://www.inkandswitch.com/local-first/"
                  >https://www.inkandswitch.com/local-first/</a
                >
                , our team felt these things are important to all of us:
              </p>
              <p>
                • No spinners: your work at your fingertips. Anytype keeps the
                primary copy of each space on the local device. Data
                synchronization with other devices happens quietly in the
                background - allowing you to operate with your data at your
                fingertips.
              </p>
              <p>
                • Your work is not trapped on one device. Users can easily work
                on different devices. Each device keeps data in local storage,
                synchronisation between devices happens in the background using
                CRDTs to resolve conflicts.
              </p>
              <p>
                • The network is optional. Everything works offline. Data
                synchronization need not necessarily go via the Internet:
                AnySync allows users to sync data via local WiFi networks.
                Still, there is a role for the network - it works as additional
                backup, helps with peer discovery and especially solves the
                closed-laptop problem (you made changes on laptop, when your
                phone was offline, the changes can either sync when both devices
                are online or via backup node).
              </p>
              <p>
                • Seamless collaboration with your colleagues. Achieving this
                goal is one of the biggest challenges in realizing local-first
                software, but we believe with CRDTs it's possible. AnySync
                supports it &amp; we will release multiplayer version soon.
              </p>
              <p>
                • The Long Now. Because you have a local-first application, you
                can use it on your computer even if the software author
                disappears. This is also strengthened by open data standards and
                open code.
              </p>
              <p>
                • Security and privacy by default. AnySync uses end-to-end
                encryption so that backup nodes store encrypted data that they
                cannot read. Conflict resolution happens on-device. The keys are
                controlled by users.
              </p>
              <p>
                • You retain ultimate ownership and control. Users control
                encryption keys; there is no central registry of users (we don’t
                ask even your email). We added an option to self-host your
                backup to support full autonomy of users from the network.
              </p>
            </div>
          </section>
        </section>
        <section id="38794625">
          <h3>
            <a class="item" href="https://github.com/hunar4321/particle-life"
              >Particle Life</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 15:52:17</span
              ><span class="points-container"
                >Points: <span class="points">208</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38794625"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38793249">
          <h3>
            <a class="item" href="https://www.gregegan.net/FOUNDATIONS/"
              >Foundations (1997-2000)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 13:28:10</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38793249"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38793206">
          <h3>
            <a
              class="item"
              href="https://dubroy.com/blog/cold-blooded-software/"
              >Cold-blooded software</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 13:22:56</span
              ><span class="points-container"
                >Points: <span class="points">388</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38793206"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38792446">
          <h3>
            <a
              class="item"
              href="https://blogsystem5.substack.com/p/the-ides-we-had-30-years-ago-and"
              >IDEs we had 30 years ago</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 11:38:57</span
              ><span class="points-container"
                >Points: <span class="points">470</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38792446"
                  >Comments</a
                ><span class="descendants">: 398</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38791575">
          <h3>
            <a
              class="item"
              href="https://media.ccc.de/v/37c3-12326-you_ve_just_been_fucked_by_psyops"
              >You've just been fucked by psyops [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 09:17:46</span
              ><span class="points-container"
                >Points: <span class="points">301</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38791575"
                  >Comments</a
                ><span class="descendants">: 308</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38791519">
          <h3>
            <a
              class="item"
              href="https://www.abc.net.au/news/2023-12-28/google-maps-sending-people-wrong-way-quairading-shire/103207090"
              >Quairading shire erects signs telling travellers to ignore Google
              Maps</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 09:08:19</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38791519"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38791517">
          <h3>
            <a
              class="item"
              href="https://buttondown.email/hillelwayne/archive/i-formally-modeled-dreidel-for-no-good-reason/"
              >Formally modeled Dreidel for no good reason</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 09:08:05</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38791517"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38790597">
          <h3>
            <a
              class="item"
              href="https://andreasjhkarlsson.github.io//jekyll/update/2023/12/27/4-billion-if-statements.html"
              >4B If Statements</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-28 @ 06:11:31</span
              ><span class="points-container"
                >Points: <span class="points">1252</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38790597"
                  >Comments</a
                ><span class="descendants">: 422</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38787892">
          <h3>
            <a class="item" href="https://github.com/jasonjmcghee/rem"
              >Show HN: Rem: Remember Everything (open source)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-27 @ 22:56:22</span
              ><span class="points-container"
                >Points: <span class="points">373</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38787892"
                  >Comments</a
                ><span class="descendants">: 144</span></span
              >
            </h4>
            <div class="text">
              <p>
                Note: Relies on Apple Silicon, and configured to only produce
                Apple Silicon builds.
              </p>
              <p>
                I think the idea of recording everything you see has the
                potential to change how we interact with our computers, and
                believe it should be open source.
              </p>
              <p>
                Also, from a privacy / security perspective, this is like...
                pretty scary stuff, and I want the code open so we know for
                certain that nothing is leaving your laptop. Even logging to
                Sentry has the potential to leak private info.
              </p>
            </div>
          </section>
        </section>
        <section id="38786069">
          <h3>
            <a
              class="item"
              href="https://allegralaboratory.net/a-claxonomy-of-mexico-citys-traffic/"
              >A Claxonomy of Mexico City's Traffic</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-27 @ 20:09:37</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38786069"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38786046">
          <h3>
            <a
              class="item"
              href="https://www.historytoday.com/archive/miscellanies/medieval-icelandic-feasts"
              >Medieval Icelandic Feasts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-27 @ 20:08:28</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38786046"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38785468">
          <h3>
            <a
              class="item"
              href="https://www.eia.gov/todayinenergy/detail.php?id=61106"
              >First new U.S. nuclear reactor since 2016 is now in operation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-27 @ 19:19:37</span
              ><span class="points-container"
                >Points: <span class="points">869</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38785468"
                  >Comments</a
                ><span class="descendants">: 864</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38784994">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/tom-smothers-dies-smothers-brothers-3e1727faf1b6469da7b2cfc7b2874c56"
              >Comedian Tom Smothers has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-27 @ 18:36:16</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38784994"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38783870">
          <h3>
            <a class="item" href="https://www.youtube.com/shorts/j1b4whvmIOc"
              >Chinese villagers capture video of falling Long March rocket
              booster [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-27 @ 16:56:18</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38783870"
                  >Comments</a
                ><span class="descendants">: 165</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38778807">
          <h3>
            <a
              class="item"
              href="https://tomverbeure.github.io/2023/12/26/Controlling-an-HP-1670G-with-Your-Linux-PC-X-Server.html"
              >Remote controlling an HP 1670G logic analyzer with a Linux PC X
              server</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-12-27 @ 03:32:36</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38778807"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
