<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40068187">
          <h3>
            <a class="item" href="https://antithesis.com/blog/sdtalk/"
              >How Antithesis finds bugs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 18:07:01</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40068187"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40068170">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2404.02305"
              >Collapse of Self-Trained Language Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 18:05:59</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40068170"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40067677">
          <h3>
            <a
              class="item"
              href="https://asciinema.org/a/piP22yYwcaohu5cA2gyuv1W61"
              >Show HN: Speeding up LLM inference 2x times (possibly)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:26:09</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067677"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                It's a new (I think) algorithm, that allows to adjust smoothly -
                and in real time - how many calculations you'd like to do during
                inference of an LLM model.
              </p>
              <p>
                It seems that it's possible to do just 20-25% of weight
                multiplications instead of all of them, and still get good
                inference results.
              </p>
              <p>
                I implemented it to run on M1/M2/M3 GPU. The mmul approximation
                itself can be pushed to run 2x fast before the quality of output
                collapses.
              </p>
              <p>
                The inference speed is just a bit faster than Llama.cpp's,
                because the rest of implementation could be better, but with a
                better development I think it can be a new method to speed up
                inference - in addition to quantization.
              </p>
              <p>You could call it ad-hoc model distillation :)</p>
              <p>
                You can change the speed / accuracy of a model at will, in real
                time.
              </p>
              <p>
                Oh, and as a side effect, the data format allows to also choose
                how much of the model you want to load into the memory. You can
                decide to skip say 10-20-40% of the least important weights.
              </p>
              <p>
                It's implemented for Mistral, it was also tested slightly on
                Mixtral and Llama. It's for FP16 for now, but Q8 is in the
                works.
              </p>
              <p>
                The algorithm is described here, and the implementation is open
                source.
              </p>
              <p>
                <a href="https://kolinko.github.io/effort/"
                  >https://kolinko.github.io/effort/</a
                >
              </p>
              <p>
                I know these are bold claims, but I hope they survive the
                scrutiny :)
              </p>
            </div>
          </section>
        </section>
        <section id="40067605">
          <h3>
            <a
              class="item"
              href="https://www.businessinsider.com/why-reddit-is-taking-over-google-right-now-2024-4"
              >Reddit is taking over Google</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:20:32</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067605"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40067556">
          <h3>
            <a
              class="item"
              href="https://mastodon.social/@stroughtonsmith/112287515017810339"
              >AltStore PAL, the first alternative app marketplace on iPhone, is
              available now</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:16:13</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067556"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40067486">
          <h3>
            <a
              class="item"
              href="https://bawolf.substack.com/p/embeddings-are-a-good-starting-point"
              >Embeddings are a good starting point for the AI curious app
              developer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:09:14</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067486"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40067484">
          <h3>
            <a class="item" href="https://www.damaia.com/google"
              >Show HN: A self-published art book about Google's first 25
              years</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:09:04</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067484"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <p>
                So… I wrote a book. It’s a different book with a unique
                approach. It’s not a novel or a technical book. It’s a
                biography, a company’s biography. My hope is that it serves two
                purposes: to inspire founders and to captivate interior
                designers.
              </p>
              <p>
                It all started three years ago. My wife and I were discussing
                interior design for our living room and she brought up what
                beautiful coffee table books should we have. After looking at
                her favorites I realized there’s nothing like this for tech
                startups. Digital products are intangible, how cool would it be
                to make them tangible and a beautiful art/decor book for your
                home office or living room?
              </p>
              <p>
                This idea of consolidating my particular interests with my
                wife’s decorative goals got stuck in the back of my head for a
                while. I searched and searched. I could only find these kinds of
                books related to design, architecture, fashion, or travel.
                Nothing about tech startups. The next logical step for me was to
                do it myself…
              </p>
              <p>
                And oh… what a “mistake” it was. This whole project was done
                during nights and weekends - the first half while working on my
                startup and the last half while helping create Webflow Labs. You
                have no idea how many times I “quit” the project. In the end,
                perseverance and discipline were key to making it happen.
              </p>
              <p>
                During my founder journey, I collected several notes about
                successful (and unsuccessful) tech startups to help me learn
                from them. I decided to write about Google’s fascinating story:
                a true generational company and one of the most valuable
                companies in the world.
              </p>
              <p>
                It’s with great pleasure and satisfaction that I’m introducing
                you to “Google - First 25 Years”. A book celebrating the minds
                behind the tech giant's incredible journey from Stanford to
                global dominance.
              </p>
              <p>
                I have absolutely no idea if this book’s format and concept make
                sense or if it has an audience willing to invest ($169). Here
                are some of the unique features:
              </p>
              <p>▪ Silk hardcover</p>
              <p>▪ Limited edition</p>
              <p>▪ Handpainted edges</p>
              <p>▪ More than 30 handmade illustrations</p>
              <p>
                I’m producing only 1,000 copies. If the book concept seems
                interesting enough, leave a comment, I’d love to know your
                thoughts!
              </p>
              <p>
                Either way, this project was a super fun ride where being
                outside my comfort zone was the best way to learn storytelling,
                graphic design, and product manufacturing.
              </p>
              <p>
                At least, I hope this inspires you to go back to your side
                projects and finish them!
              </p>
            </div>
          </section>
        </section>
        <section id="40067372">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40067372"
              >Y Combinator is hiring full stack engineers – learn tons about
              startups</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 17:00:46</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Why would you want to work at YC? Well, the short of it is that
                you’d get unprecedented insight into how companies are started –
                with access to all the talks, constantly being around founders,
                and working directly with YC Group Partners. Our GPs are
                possibly the 12 most knowledgeable people in the world about
                starting companies. You’d be hard pressed to work here and NOT
                learn something new about startups every day – which might be
                helpful if you’re interested in starting a company yourself.
              </p>
              <p>
                Software also touches everything YC does. When I went through YC
                in 2013, the core pieces of the YC batch were a dinner each
                week, a 1-1 with your group partner, and an end-of-batch Demo
                Day event to raise money. Today, YC offers so many software
                tools to help founders build their companies, including:
              </p>
              <p>
                * Demo Day website, which has helped founders raise $3B+ over
                the last 3 years
              </p>
              <p>
                * Work at a Startup, where 1000s of companies have hired from a
                pool of 1M+ job seekers
              </p>
              <p>
                * Bookface, a tool for YC founders to support and help each
                other build their companies
              </p>
              <p>
                YC software runs kind of like a startup: we have a small
                engineering team (15 people) full of full-stack software
                developers (Rails, React, Postgres) who talk to our users, ship
                fast and iterate often. YC’s great for people who like to move
                fast and learn quickly. As a member of our team, you’d work with
                and learn from some pretty experienced people who were early at
                Facebook, Carta, Salesforce, Twilio and other top companies.
              </p>
              <p>
                Many of us have also been founders, and seven former employees
                have gone on to start startups that were funded by YC. If you
                want to start a startup but don’t have a great idea yet, we
                welcome you to spend a couple years here to learn, and then
                launch your own. On the flip side, if you can see yourself
                writing code indefinitely, we’d love to keep you happy here at
                YC for a long time. Either one works for us.
              </p>
              <p>
                Building software at YC isn’t for everyone – YC’s real product
                is the Batch program and the Group Partners’ advice and help for
                the life of your startup. Our software team is often in the
                background, helping scale YC’s ability to help more companies,
                and in a way that means *more* 1-1 attention and support for
                each founder. What keeps me motivated is continuing to scale and
                improve YC through software, and getting to work with some of
                the most kind and talented people of my 20+ year career.
              </p>
              <p>
                If you have questions, I would love to answer them here. (It
                would help me understand how I can make our role &amp; work more
                clear!) And if this resonates with you, shoot me an email with
                what you’d most be excited to work on (job descriptions below) :
              </p>
              <p>ryan@ycombinator.com</p>
              <p>
                * Y Combinator, Product Engineer on Bookface:
                <a
                  href="https://www.ycombinator.com/companies/y-combinator/jobs/sVRZiOZ-product-engineer-bookface"
                  >https://www.ycombinator.com/companies/y-combinator/jobs/sVRZ...</a
                >
              </p>
              <p>
                * Y Combinator, Product Engineer on Work at a Startup:
                <a
                  href="https://www.ycombinator.com/companies/y-combinator/jobs/dUJA6i7-product-engineer-work-at-a-startup"
                  >https://www.ycombinator.com/companies/y-combinator/jobs/dUJA...</a
                >
              </p>
              <p>
                * Y Combinator, Product Engineer on Internal Tools:
                <a
                  href="https://www.ycombinator.com/companies/y-combinator/jobs/YK4UNN9-product-engineer-internal-tools"
                  >https://www.ycombinator.com/companies/y-combinator/jobs/YK4U...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="40067206">
          <h3>
            <a
              class="item"
              href="https://newsletter.pessimistsarchive.org/p/the-forgotten-war-on-beepers"
              >The forgotten war on beepers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 16:47:21</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067206"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40067184">
          <h3>
            <a
              class="item"
              href="https://www.themarginalian.org/2024/04/12/dictionary-of-obscure-sorrows/"
              >The Dictionary of Obscure Sorrows</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 16:45:40</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40067184"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40066975">
          <h3>
            <a
              class="item"
              href="https://www.messynessychic.com/2024/04/12/djangos-journey-the-making-of-the-nomadic-king-of-french-swing/"
              >The Making of Django Reinhardt</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 16:30:31</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40066975"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40066921">
          <h3>
            <a
              class="item"
              href="https://www.technologyreview.com/2024/04/17/1090856/international-space-station-axiom-low-earth-orbit/"
              >The great commercial takeover of low Earth orbit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 16:26:59</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40066921"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40065862">
          <h3>
            <a class="item" href="https://www.futureofhumanityinstitute.org"
              >Future of Humanity Institute shuts down</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 15:14:08</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40065862"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40065821">
          <h3>
            <a class="item" href="https://github.com/mitchellh/libxev"
              >libxev: A cross-platform, high-performance event loop</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 15:11:26</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40065821"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40065704">
          <h3>
            <a
              class="item"
              href="https://cutlefish.substack.com/p/tbm-271-the-biggest-untapped-opportunity"
              >The biggest source of waste is untapped skilled pragmatists</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 15:04:08</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40065704"
                  >Comments</a
                ><span class="descendants">: 143</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40065114">
          <h3>
            <a
              class="item"
              href="https://stability.ai/news/stable-diffusion-3-api"
              >Stable Diffusion 3 API Now Available</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 14:26:31</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40065114"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40064736">
          <h3>
            <a class="item" href="https://mistral.ai/news/mixtral-8x22b/"
              >Mixtral 8x22B</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 14:00:37</span
              ><span class="points-container"
                >Points: <span class="points">402</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40064736"
                  >Comments</a
                ><span class="descendants">: 194</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40064105">
          <h3>
            <a
              class="item"
              href="https://bostondynamics.com/blog/electric-new-era-for-atlas/"
              >An electric new era for Atlas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 13:12:14</span
              ><span class="points-container"
                >Points: <span class="points">252</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40064105"
                  >Comments</a
                ><span class="descendants">: 301</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40064027">
          <h3>
            <a
              class="item"
              href="https://research.google/blog/solving-the-minimum-cut-problem-for-undirected-graphs/"
              >Solving the minimum cut problem for undirected graphs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 13:05:14</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40064027"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063908">
          <h3>
            <a
              class="item"
              href="https://lxqt-project.org/release/2024/04/15/release-lxqt-2-0-0/"
              >LXQt 2.0.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:52:06</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063908"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063803">
          <h3>
            <a class="item" href="https://github.com/WINSDK/bite"
              >Show HN: BiTE – Cross-platform executable viewer and reverse
              engineering tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:39:49</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063803"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <p>
                I’m excited to share a project I’ve been working on throughout
                my university studies. It’s called BiTE (<a
                  href="https://github.com/WINSDK/bite"
                  >https://github.com/WINSDK/bite</a
                >) and it's a tool primarily focused on being an executable
                viewer with reverse engineering capabilities.
              </p>
              <p>
                BiTE supports Windows, MacOS, and Linux, along with their
                associated executable formats. It’s also capable of parsing and
                displaying debug information using DWARF/PDB formats, which I
                hope will be useful even for just comparing codegen.
              </p>
              <p>
                I’ve put a lot of effort into this and it's the first time I'm
                releasing something like this publicly. Any feedback, bug
                reports, or feature suggestions would be greatly appreciated!
              </p>
            </div>
          </section>
        </section>
        <section id="40063795">
          <h3>
            <a
              class="item"
              href="https://www.scottaaronson.com/democritus/lec9.html"
              >Quantum mechanics is the operating system other physical theories
              run on (2007)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:38:40</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063795"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40063367">
          <h3>
            <a
              class="item"
              href="https://johnhawks.net/weblog/how-many-bathrooms-have-neandertals-in-the-tile/"
              >How many bathrooms have Neanderthals in the tile?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 12:00:32</span
              ><span class="points-container"
                >Points: <span class="points">349</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40063367"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40061298">
          <h3>
            <a
              class="item"
              href="https://fosscomics.com/8.%20The%20Origins%20of%20Unix%20and%20the%20C%20Language/"
              >F/OSS Comics: 8. The Origins of Unix and the C Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 06:51:13</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40061298"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40060123">
          <h3>
            <a
              class="item"
              href="https://rmarcus.info/blog/2024/04/12/pg-over-time.html"
              >Ten years of improvements in PostgreSQL's optimizer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-17 @ 03:27:58</span
              ><span class="points-container"
                >Points: <span class="points">250</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40060123"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40055908">
          <h3>
            <a
              class="item"
              href="https://hazlitt.net/feature/everything-we-cant-describe-music"
              >Everything We Can't Describe in Music</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 19:02:13</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40055908"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40055116">
          <h3>
            <a
              class="item"
              href="https://adnanthekhan.com/2024/04/15/an-obscure-actions-workflow-vulnerability-in-googles-flank/"
              >An Obscure Actions Workflow Vulnerability in Google's Flank</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 17:57:19</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40055116"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40051013">
          <h3>
            <a class="item" href="https://oolite.space/"
              >Oolite: An open source open-world space opera</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 12:14:14</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40051013"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40050162">
          <h3>
            <a
              class="item"
              href="https://www.vice.com/en/article/kz4gqm/why-this-20-year-old-crt-monitor-is-better-than-a-4k-lcd"
              >LCD displays still don't match the responsiveness of clunky CRT
              screens (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 09:57:32</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40050162"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40048702">
          <h3>
            <a class="item" href="https://filipvrba.github.io/ruby-js/"
              >RubyJS-Vite</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 05:41:44</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40048702"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
