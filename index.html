<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39531441">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/business/2024/feb/27/train-travel-generates-less-carbon-than-battery-ev-says-rail-group-data"
              >Electric cars produce twice as much COâ‚‚ as trains, says rail
              group data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 23:06:02</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39531441"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39531101">
          <h3>
            <a class="item" href="https://larahogan.me/blog/desk-moves/"
              >Dealing with surprising human emotions: desk moves (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 22:34:34</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39531101"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39530487">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/health/healthcare/u-s-launches-antitrust-investigation-of-healthcare-giant-unitedhealth-ff5a00d2"
              >U.S. Launches Antitrust Investigation of UnitedHealth</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 21:46:41</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39530487"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39530203">
          <h3>
            <a
              class="item"
              href="https://overkill.wtf/nintendo-sue-yuzu-emulator/"
              >Nintendo is suing the creators of Switch emulator Yuzu</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 21:25:50</span
              ><span class="points-container"
                >Points: <span class="points">392</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39530203"
                  >Comments</a
                ><span class="descendants">: 246</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39530113">
          <h3>
            <a
              class="item"
              href="https://retrocomputing.stackexchange.com/questions/29565/does-this-8088-code-in-the-leisure-suit-larry-2-game-actually-do-anything"
              >Does this 8088 code in the Leisure Suit Larry 2 game do
              anything?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 21:18:24</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39530113"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39529895">
          <h3>
            <a class="item" href="https://www.tesorio.com/careers#job-openings"
              >Tesorio (YC S15) Is Hiring a Head of Infrastructure (100%
              Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 21:02:22</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39529775">
          <h3>
            <a
              class="item"
              href="https://isburmistrov.substack.com/p/all-you-need-is-wide-events-not-metrics"
              >All you need is Wide Events, not "Metrics, Logs and Traces"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 20:53:39</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39529775"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39528726">
          <h3>
            <a class="item" href="https://github.com/SuperTux/supertux"
              >SuperTux</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 19:42:21</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39528726"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39528192">
          <h3>
            <a class="item" href="https://github.com/sdv-dev/SDV"
              >Synthetic data generation for tabular data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 19:05:40</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39528192"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39528134">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2024-02-27/apple-cancels-work-on-electric-car-shifts-team-to-generative-ai"
              >Apple cancels work on electric car, shifts team to generative
              AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 19:02:22</span
              ><span class="points-container"
                >Points: <span class="points">542</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39528134"
                  >Comments</a
                ><span class="descendants">: 574</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39526922">
          <h3>
            <a class="item" href="https://agraef.github.io/pure-lang/"
              >Pure Programming Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 17:38:51</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39526922"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39526797">
          <h3>
            <a
              class="item"
              href="https://www.browserless.io/blog/2024/02/26/unblock-api/?apcid=00620de59ffc742367908900&amp;utm_campaign=unblock-api-announcement&amp;utm_content=unblock-api-announcement&amp;utm_medium=email&amp;utm_source=ortto"
              >The /unblock API from Browserless: dodging bot detection as a
              service</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 17:30:10</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39526797"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39526057">
          <h3>
            <a class="item" href="https://ciechanow.ski/airfoil/">Airfoil</a>
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 16:32:49</span
              ><span class="points-container"
                >Points: <span class="points">1383</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39526057"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39525243">
          <h3>
            <a
              class="item"
              href="https://the-engi-nerd.github.io/posts/welcome/"
              >Testing the F-35C Tailhook</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 15:32:36</span
              ><span class="points-container"
                >Points: <span class="points">289</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39525243"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39525071">
          <h3>
            <a class="item" href="https://github.com/bruin-data/ingestr"
              >Show HN: I built an open-source data copy tool called ingestr</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 15:18:13</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39525071"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/bruin-data/ingestr"
                >https://github.com/bruin-data/ingestr</a
              >)
              <p>
                I did build quite a few data warehouses both for the companies I
                worked at, as well as for consultancy projects. One of the more
                common pain points I observed was that everyone had to rebuild
                the same data ingestion bit over and over again, and each in
                different ways:
              </p>
              <p>
                - some wrote code for the ingestion from scratch to various
                degrees
              </p>
              <p>
                - some used off-the-shelf data ingestion tools like Fivetran /
                Airbyte
              </p>
              <p>
                I have always disliked both of these approaches, for different
                reasons, but never got around to working on what I'd imagine to
                be the better way forward.
              </p>
              <p>
                The solutions that required writing code for copying the data
                had quite a bit of overhead such as how to generalize them, what
                language/library to use, where to deploy, how to monitor, how to
                schedule, etc. I ended up figuring out solutions for each of
                these matters, but the process always felt suboptimal. I like
                coding but for more novel stuff rather than trying to copy a
                table from Postgres to BigQuery. There are libraries like dlt
                (awesome lib btw, and awesome folks!) but that still required me
                to write, deploy, and maintain the code.
              </p>
              <p>
                Then there are solutions like Fivetran or Airbyte, where there's
                a UI and everything is managed through there. While it is nice
                that I didn't have to write code for copying the data, I still
                had to either pay some unknown/hard-to-predict amount of money
                to these vendors or host Airbyte myself which is roughly back to
                square zero (for me, since I want to maintain the least amount
                of tech myself). Nothing was versioned, people were changing
                things in the UI and breaking the connectors, and what worked
                yesterday didn't work today.
              </p>
              <p>
                I had a bit of spare time a couple of weeks ago and I wanted to
                take a stab at the problem. I have been thinking of
                standardizing the process for quite some time already, and dlt
                had some abstractions that allowed me to quickly prototype a CLI
                that copies data from one place to another. I made a few
                decisions (that I hope I won't regret in the future):
              </p>
              <p>
                - everything is a URI: every source and every destination is
                represented as a URI
              </p>
              <p>
                - there can be only one thing copied at a time: it'll copy only
                a single table within a single command, not a full database with
                an unknown amount of tables
              </p>
              <p>
                - incremental loading is a must, but doesn't have to be super
                flexible: I decided to support full-refresh, append-only, merge,
                and delete+insert incremental strategies, because I believe this
                covers 90% of the use-cases out there.
              </p>
              <p>
                - it is CLI-only, and can be configured with flags &amp; env
                variables so that it can be automated quickly, e.g. drop it into
                GitHub Actions and run it daily.
              </p>
              <p>
                The result ended up being `ingestr` (<a
                  href="https://github.com/bruin-data/ingestr"
                  >https://github.com/bruin-data/ingestr</a
                >).
              </p>
              <p>
                I am pretty happy with how the first version turned out, and I
                plan to add support for more sources &amp; destinations. ingestr
                is built to be flexible with various source and destination
                combinations, and I plan to introduce more non-DB sources such
                as Notion, GSheets, and custom APIs that return JSON (which I am
                not sure how exactly I'll do but open to suggestions!).
              </p>
              <p>
                To be perfectly clear: I don't think ingestr covers 100% of data
                ingestion/copying needs out there, and it doesn't aim that. My
                goal with it is to cover most scenarios with a decent set of
                trade-offs so that common scenarios can be solved easily without
                having to write code or manage infra. There will be more complex
                needs that require engineering effort by others, and that's
                fine.
              </p>
              <p>
                I'd love to hear your feedback on how can ingestr help data
                copying needs better, looking forward to hearing your thoughts!
              </p>
              <p>Best, Burak</p>
            </div>
          </section>
        </section>
        <section id="39524874">
          <h3>
            <a class="item" href="https://github.com/piercefreeman/mountaineer"
              >Show HN: Mountaineer â€“ Webapps in Python and React</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 14:59:53</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39524874"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
            <div class="text">
              <p>
                Iâ€™ve written a good 25+ webapps over the last few years in
                almost every major framework under the sun. Python and React
                remain my favorite. They let you get started quickly and grow to
                scale. But the developer experience of linking these two worlds
                remains less than optimal:
              </p>
              <p>
                â€” Sharing typehints and schemas across frontend and backend code
              </p>
              <p>
                â€” Scattered fetch() calls to template data and modify server
                objects
              </p>
              <p>â€” Server side rendering / gateway support</p>
              <p>â€” Error handling on frontend fetches</p>
              <p>
                Mountaineer is an attempt to solve those problems. I didnâ€™t want
                to re-invent the wheel of what Python and React are good at, so
                itâ€™s relatively light on syntax. It provides one frontend hook
                for React apps and introduces a MVC convention on the backend
                for managing views. Support files are generated progressively
                through a local watcher, so IDE type-hints and function calls
                work out of the box.
              </p>
              <p>
                Itâ€™s more intuitive to explain with some code, so pop over to
                the Github if youâ€™re interested in this stack and taking a look:
              </p>
              <p>
                Github:
                <a href="https://github.com/piercefreeman/mountaineer"
                  >https://github.com/piercefreeman/mountaineer</a
                >
              </p>
              <p>
                More context:
                <a
                  href="https://freeman.vc/notes/mountaineer-v01-webapps-in-python-and-react"
                  >https://freeman.vc/notes/mountaineer-v01-webapps-in-python-a...</a
                >
              </p>
              <p>Would love to hear your thoughts!</p>
            </div>
          </section>
        </section>
        <section id="39524327">
          <h3>
            <a class="item" href="https://github.com/ankane/blazer"
              >Blazer: Business intelligence made simple</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 14:13:38</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39524327"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39524164">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/environment/surrey-cooling-effects-green-spaces-waterways/"
              >Botanical gardens can cool city air by an average of 5Â°C</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 13:59:45</span
              ><span class="points-container"
                >Points: <span class="points">311</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39524164"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39523813">
          <h3>
            <a
              class="item"
              href="https://www.ainonline.com/aviation-news/air-transport/2024-02-26/boeing-missing-key-elements-safety-culture-faa-report"
              >Boeing missing key elements of safety culture: FAA report</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 13:30:24</span
              ><span class="points-container"
                >Points: <span class="points">329</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39523813"
                  >Comments</a
                ><span class="descendants">: 269</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39523641">
          <h3>
            <a class="item" href="https://beltmag.com/consider-the-pawpaw/"
              >Consider the Pawpaw</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 13:11:47</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39523641"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39523495">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/the-strange-and-turbulent-global-world-of-ant-geopolitics"
              >Ant Geopolitics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 12:57:43</span
              ><span class="points-container"
                >Points: <span class="points">223</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39523495"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39523403">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/space/2024/02/faa-closes-starship-inquiry-and-spacex-details-causes-of-november-accidents/"
              >SpaceX discloses cause of Starship anomalies as it clears an FAA
              hurdle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 12:48:09</span
              ><span class="points-container"
                >Points: <span class="points">189</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39523403"
                  >Comments</a
                ><span class="descendants">: 262</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39522770">
          <h3>
            <a
              class="item"
              href="https://erikbern.com/2021/04/19/software-infrastructure-2.0-a-wishlist.html"
              >Software Infrastructure 2.0: A Wishlist (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 11:23:17</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39522770"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39522348">
          <h3>
            <a
              class="item"
              href="https://docs.emailengine.app/how-i-turned-my-open-source-project-into/"
              >I turned my open-source project into a full-time business</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 10:16:18</span
              ><span class="points-container"
                >Points: <span class="points">527</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39522348"
                  >Comments</a
                ><span class="descendants">: 201</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39522249">
          <h3>
            <a
              class="item"
              href="https://invertedpassion.com/why-time-seems-to-pass-faster-as-we-age/"
              >Why time seems to pass faster as we age</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 10:02:44</span
              ><span class="points-container"
                >Points: <span class="points">265</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39522249"
                  >Comments</a
                ><span class="descendants">: 185</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39518803">
          <h3>
            <a
              class="item"
              href="https://www.millersbookreview.com/p/cormac-mccarthy-sideline-freelance-copy-editor"
              >Cormac McCarthy's Sideline: Freelance copy editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-27 @ 01:05:29</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39518803"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39513870">
          <h3>
            <a
              class="item"
              href="https://www.lawfaremedia.org/article/supreme-court-oral-argument-preview-social-media-first-amendment-cases"
              >Social Media First Amendment Cases</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 17:11:31</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39513870"
                  >Comments</a
                ><span class="descendants">: 172</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39512912">
          <h3>
            <a class="item" href="https://speakz.ai"
              >Show HN: AI Dub Tool I Made to Watch Foreign Language Videos with
              My 7-Year-Old</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-26 @ 16:08:45</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39512912"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39505597">
          <h3>
            <a
              class="item"
              href="https://blog.ian.stapletoncordas.co/2024/02/a-retrospective-on-requests"
              >A retrospective on Requests</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 22:31:32</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39505597"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39500743">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/sciadv.adk6870"
              >Anomalous cooling of bosons by dimensional reduction</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-25 @ 13:36:44</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39500743"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
