<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43081929">
          <h3>
            <a
              class="item"
              href="https://yalereview.org/article/tavakoli-rem-peter-ames-carlin"
              >What happened when REM went mainstream</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 18:36:14</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43081929"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43081713">
          <h3>
            <a class="item" href="https://bryce.co/undebuggable/"
              >Debugging an Undebuggable App</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 18:10:35</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43081713"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43080895">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43080895"
              >Launch HN: Roark (YC W25) – Taking the pain out of voice AI
              testing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 16:54:52</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43080895"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <a href="https://roark.ai">https://roark.ai</a>). We built a tool
              that lets developers replay real production calls against their
              latest Voice AI changes, so they can catch failures, test updates,
              and iterate with confidence.
              <p>
                Here’s a demo video:
                <a href="https://www.youtube.com/watch?v=eu8mo28LsTc"
                  >https://www.youtube.com/watch?v=eu8mo28LsTc</a
                >.
              </p>
              <p>
                We ran into this problem while building a voice AI agent for a
                dental clinic. Patients kept getting stuck in loops, failing to
                confirm insurance, or misunderstanding responses. The only way
                to test fixes was to manually call the agent or read through
                hundreds of transcripts, hoping to catch issues. It was slow,
                frustrating, and unreliable.
              </p>
              <p>
                Talking to other teams, we found this wasn’t just a niche issue
                - every team building Voice AI struggled to validate performance
                efficiently. Debugging meant calling the agent over and over.
                Updates shipped with unknown regressions. Sentiment analysis
                relied only on text, missing key audio cues like hesitation or
                frustration, which often signal deeper issues.
              </p>
              <p>
                That’s why we built Roark. Instead of relying on scripted test
                cases, Roark captures real production calls from VAPI, Retell,
                or a custom-built agent via API and replays them against your
                latest agent changes. We don’t just feed back text, we preserve
                what the user said, how they said it, and when they said it,
                mimicking pauses, sentiment, and tone up until the conversation
                flow changes. This ensures your agent is tested under real-world
                conditions, not just synthetic scripts.
              </p>
              <p>
                For each replay that we run, Roark checks if the agent follows
                key flows (e.g. verifying identity before sharing account
                details). Our speech based evaluators also detect sentiments
                such as frustration and confusion, long pauses, and
                interruptions - things that regular transcripts miss.
              </p>
              <p>
                After testing, Roark provides Mixpanel-style analytics to track
                failures, conversation flows, and key performance metrics,
                helping teams debug faster and ship with confidence. Instead of
                hoping changes work, teams get immediate pass/fail results,
                side-by-side transcript comparisons, and real-world insights.
              </p>
              <p>
                We’re already working with teams in healthcare, legal, and
                customer service who rely on Voice AI for critical interactions.
                They use Roark to debug AI failures faster, test updates before
                they go live, and improve customer experiences - without
                manually calling their bots dozens of times.
              </p>
              <p>
                Our product isn’t <i>quite</i> ready yet for self-service, so
                you’ll still see the dreaded “book a demo” on our home page. If
                you’re reading this, though, we’d love to fast-track you, so we
                made a special page for HN signups here:
                <a href="https://roark.ai/hn-access"
                  >https://roark.ai/hn-access</a
                >. If you’re working on Voice AI and want to try us out, please
                do!
              </p>
              <p>
                Would love any feedback, thoughts, or questions from the HN
                community!
              </p>
            </div>
          </section>
        </section>
        <section id="43080858">
          <h3>
            <a class="item" href="https://pwy.io/posts/kartoffels-v0.7/"
              >kartoffels v0.7: Cellular Automata, Statistics, 32-bit RISC-V</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 16:51:52</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43080858"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43080535">
          <h3>
            <a class="item" href="https://hk.jdx.dev/about.html"
              >Hk, a new Git hook manager from jdx</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 16:23:30</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43080535"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43080531">
          <h3>
            <a class="item" href="https://github.com/dhealy05/frames_of_mind"
              >Watch R1 "think" with animated chains of thought</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 16:23:07</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43080531"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43080378">
          <h3>
            <a
              class="item"
              href="https://www.thomas-huehn.com/open-source-projects-could-sell-sbom-fragments/"
              >Open Source projects could sell SBoM fragments</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 16:09:47</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43080378"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43079791">
          <h3>
            <a
              class="item"
              href="https://web.dev/blog/ruby-on-rails-on-webassembly"
              >Now you can run Ruby on Rails in the browser using WebAssembly</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 15:15:14</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43079791"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43079023">
          <h3>
            <a class="item" href="https://espargos.net/"
              >Espargos: ESP32-based WiFi sensing array</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 13:54:40</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43079023"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43078555">
          <h3>
            <a class="item" href="https://inscribed.app/"
              >Show HN: Inscribed, create stop motion animation and slide
              powered by Excalidraw</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 13:04:34</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43078555"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been writing a lot of tech content lately and needed a way
                to create a stop motion to visualize ideas for my blog.
              </p>
              <p>
                I'm a big fan of Excalidraw and Apple Keynote, so this tool is
                an attempt to combine the UX of the two together. Sketch like
                Excalidraw with a slide making interface (with shortcuts) like
                Apple Keynote.
              </p>
              <p>
                Features: - keyboard shortcuts: copy/paste/del, up/down
                navigation - adjust document size - drag and drop images -
                google fonts integration - presentation mode - export as GIF, or
                as iframe to embed everywhere you want.
              </p>
              <p>
                Try it yourself:
                <a href="https://inscribed.app">https://inscribed.app</a>
              </p>
              <p>
                Demo:
                <a href="https://www.youtube.com/watch?v=wEXE8-6yEzw"
                  >https://www.youtube.com/watch?v=wEXE8-6yEzw</a
                >
              </p>
              <p>
                Github:
                <a href="https://github.com/chunrapeepat/inscribed"
                  >https://github.com/chunrapeepat/inscribed</a
                >
              </p>
              <p>Hope you like it. any feedback is welcome.</p>
            </div>
          </section>
        </section>
        <section id="43078537">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/sciadv.adu4034"
              >Fluoxetine promotes metabolic defenses to protect from
              sepsis-induced lethality</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 13:02:46</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43078537"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43077675">
          <h3>
            <a
              class="item"
              href="https://yosefk.com/blog/cxx-thread-local-storage-performance.html"
              >0+0 &amp;gt; 0: C++ thread-local storage performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 11:18:29</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43077675"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43077074">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2502.10248"
              >Step-Video-T2V: The Practice, Challenges, and Future of Video
              Foundation Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 09:54:46</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43077074"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43075347">
          <h3>
            <a class="item" href="https://www.ruder.io/secret-word2vec/"
              >The secret ingredients of word2vec (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 05:02:35</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43075347"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43075113">
          <h3>
            <a
              class="item"
              href="http://muratbuffalo.blogspot.com/2025/02/my-time-at-mit.html"
              >My Time at MIT</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 04:23:10</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43075113"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43073969">
          <h3>
            <a
              class="item"
              href="https://kindlemodding.org/jailbreaking/WinterBreak/"
              >All Kindles can now be jailbroken</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 01:42:12</span
              ><span class="points-container"
                >Points: <span class="points">1092</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43073969"
                  >Comments</a
                ><span class="descendants">: 354</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43073808">
          <h3>
            <a
              class="item"
              href="https://hforsten.com/homemade-polarimetric-synthetic-aperture-radar-drone.html"
              >Homemade polarimetric synthetic aperture radar drone</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 01:22:49</span
              ><span class="points-container"
                >Points: <span class="points">516</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43073808"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43073377">
          <h3>
            <a
              class="item"
              href="https://rlafuente.com/post?post=2025-2-16-marketmaking-on-kalshi"
              >Making Markets on Kalshi</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 00:26:04</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43073377"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43073292">
          <h3>
            <a
              class="item"
              href="https://sfstandard.com/2025/02/08/golden-gate-park-ranger-homelessness/"
              >San Francisco homelessness: Park ranger helps one person at a
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-17 @ 00:15:50</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43073292"
                  >Comments</a
                ><span class="descendants">: 468</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43073149">
          <h3>
            <a
              class="item"
              href="https://retrocomputing.stackexchange.com/questions/31288/does-or-did-cobol-default-to-1875-05-20-for-corrupt-or-missing-dates"
              >Does or did COBOL default to 1875-05-20 for corrupt or missing
              dates?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 23:56:16</span
              ><span class="points-container"
                >Points: <span class="points">233</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43073149"
                  >Comments</a
                ><span class="descendants">: 387</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43072338">
          <h3>
            <a class="item" href="https://uchu.style"
              >Uchū – Color palette for internet lovers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 22:22:40</span
              ><span class="points-container"
                >Points: <span class="points">599</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43072338"
                  >Comments</a
                ><span class="descendants">: 245</span></span
              >
            </h4>
            <div class="text">
              <p>
                About a year ago I embarked on creating a color scheme for a
                project and I loved it so much I began using it for everything.
                I decided to make an official repo for it to share with the
                world.
              </p>
              <p>Anyhoo, hope y'all enjoy it.</p>
            </div>
          </section>
        </section>
        <section id="43071983">
          <h3>
            <a
              class="item"
              href="https://nyanpasu64.gitlab.io/blog/amdgpu-sleep-wake-hang/"
              >I helped fix sleep-wake hangs on Linux with AMD GPUs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 21:42:03</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43071983"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43066953">
          <h3>
            <a
              class="item"
              href="https://chadnauseam.com/coding/random/calculator-app"
              >“A calculator app? Anyone could make that”</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 10:16:49</span
              ><span class="points-container"
                >Points: <span class="points">1682</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43066953"
                  >Comments</a
                ><span class="descendants">: 407</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43066247">
          <h3>
            <a
              class="item"
              href="https://defn.io/2025/02/16/type-safe-watchos-communication/"
              >DSLs for Safe iOS/WatchOS Communication</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-16 @ 08:02:30</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43066247"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43053403">
          <h3>
            <a
              class="item"
              href="https://www.learningfromexamples.com/p/reflections-on-superintelligence"
              >Reflections on AGI from 1879</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-14 @ 21:43:50</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43053403"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43050447">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-01-extreme-supersonic-planet-solar.html"
              >Extreme supersonic winds measured on a planet outside our solar
              system</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-14 @ 17:01:43</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43050447"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43048073">
          <h3>
            <a
              class="item"
              href="https://langdev.stackexchange.com/questions/4325/how-do-modern-compilers-choose-which-variables-to-put-in-registers"
              >How do modern compilers choose which variables to put in
              registers?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-14 @ 13:30:24</span
              ><span class="points-container"
                >Points: <span class="points">309</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43048073"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43047341">
          <h3>
            <a
              class="item"
              href="https://www.infobip.com/developers/blog/seniors-working-on-a-legacy-project"
              >You're not a senior engineer until you've worked on a legacy
              project</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-14 @ 11:36:39</span
              ><span class="points-container"
                >Points: <span class="points">326</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43047341"
                  >Comments</a
                ><span class="descendants">: 205</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43040986">
          <h3>
            <a class="item" href="https://maps.vvolhejn.com"
              >Spacetime maps: A map that warps to show travel time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-13 @ 20:36:11</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43040986"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43040507">
          <h3>
            <a class="item" href="https://github.com/umami-software/umami"
              >Umami is a simple, fast, privacy-focused alternative to Google
              Analytics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-13 @ 19:56:30</span
              ><span class="points-container"
                >Points: <span class="points">255</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43040507"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
