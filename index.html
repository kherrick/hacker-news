<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36767837">
          <h3>
            <a
              class="item"
              href="https://writings.stephenwolfram.com/2023/07/generative-ai-space-and-the-mental-imagery-of-alien-minds/"
              >Generative AI space and the mental imagery of alien minds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 04:34:25</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36767837"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36767606">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/ideas/archive/2023/07/hollywoods-cruel-strategy/674730/"
              >The Businessmen Broke Hollywood</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 03:51:54</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36767606"
                  >Comments</a
                ><span class="descendants">: 195</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36767452">
          <h3>
            <a
              class="item"
              href="https://blog.eladgil.com/p/ai-startup-vs-incumbent-value"
              >AI: Startup vs Incumbent Value (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 03:27:01</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36767452"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36767092">
          <h3>
            <a
              class="item"
              href="https://www.hagerty.com/media/advice/a-few-things-to-know-before-you-steal-my-914/"
              >A few things to know before stealing my 914 (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 02:32:25</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36767092"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36766844">
          <h3>
            <a
              class="item"
              href="https://nextcity.org/urbanist-news/new-yorks-driver-owned-ride-hailing-app-is-putting-its-foot-on-the-accelera"
              >The Drivers Cooperative: New York’s driver-owned ride-hailing
              app</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 02:01:08</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36766844"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36766816">
          <h3>
            <a class="item" href="https://thehtml.review/"
              >The HTML review is an annual journal of literature made to exist
              on the web</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 01:57:45</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36766816"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36766700">
          <h3>
            <a class="item" href="https://stability.ai/research/minds-eye"
              >fMRI-to-image with contrastive learning and diffusion priors</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 01:43:02</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36766700"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36766556">
          <h3>
            <a
              class="item"
              href="https://dm13450.github.io/2023/07/15/Stat-Arb-Walkthrough.html"
              >Statistical Arbitrage – An Easy Walkthrough</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 01:20:37</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36766556"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36766523">
          <h3>
            <a class="item" href="https://islamov.ai/stable-diffusion-webgpu/"
              >Stable Diffusion WebGPU demo</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 01:14:58</span
              ><span class="points-container"
                >Points: <span class="points">325</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36766523"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36766395">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36766395"
              >MixRank (YC S11) is hiring global remote software engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 01:00:27</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                MixRank processes petabytes of data every month from web
                crawling. We have hundreds of customers using our data products
                including Google, Amazon, Facebook, Intel, and Adobe, across
                industries including Recruiting, Finance, Security, Sales, and
                Marketing.
              </p>
              <p>
                Our team is 35 full-time, full-remote from 15+ countries. We're
                growing, profitable, employee-owned, no dependence on outside
                funding. Applicants from all geographies and backgrounds are
                welcome.
              </p>
              <p>
                We are looking for passionate individuals for whom programming
                is not just a job but it's something they love to do. We're
                obsessed with computers, programming, big data, databases,
                compilers, hardware, math, data science, and the internet. Does
                this sound like you? Please apply to join our team.
              </p>
              <p>
                Our code base is very friendly to new contributors. You'll have
                a (fully-automated) development environment and be pushing
                commits on your first day. Deployments to production happen
                multiple times per day and finish in less than 2 minutes. Our
                codebase is written in Python, SQL, Javascript/TypeScript, Rust,
                and Nix. The basic technologies you'll need to be productive are
                Python, PostgreSQL, Linux, and Git.
              </p>
              <p>
                We operate at a larger scale than typical startups. We operate
                two datacenters with high performance servers we've built that
                are capable of dealing with the volumes of data we process.
                We've implemented our own distributed file system. We do
                full-scale web crawls. We download and perform static analysis
                on the entire universe of Android APKs and iOS IPAs that are
                published. Unlike a typical startup where you'll spend half of
                your time in meetings, and the other half fixing bugs from Jira
                tickets— at MixRank you'll get to direct your entire focus into
                difficult technical problems that will help you to grow as an
                individual.
              </p>
              <p>--</p>
              <p>Junior Software Engineer</p>
              <p>
                We're looking for remote junior engineers that have 0-3 years of
                professional experience in software, and 5+ years of curiosity
                exploring computers, programming, and technical hobby projects.
                This is an open-ended entry role with mentorship and diverse
                opportunities to work on all areas of our product: databases,
                distributed systems, infrastructure and tooling, data analysis,
                machine learning, frontend/backend web development, APIs, data
                mining, data modeling, and more. To stand out, please highlight
                what makes you unique: passion for computing, curiosity and side
                projects, work ethic, niche research, etc.
              </p>
              <p>
                Ideally you've already finished with school, but if you still
                have one or more years left please feel free to apply anyway. If
                you're the right fit for the team we'll figure out a way to
                accommodate your schedule.
              </p>
              <p>--</p>
              <p>Software Engineer</p>
              <p>
                We're hiring generalist software engineers to work on web
                applications, data mining, machine learning/data science, data
                transformation/ETL, data modeling, database scaling,
                infrastructure, devops, and more. We'll customize the role to
                whatever subset of these areas match your interests.
              </p>
              <p>
                Beneficial experience includes PostgreSQL, Python, Linux,
                TypeScript, Rust, Nix, frontend/backend web development, and
                data mining.
              </p>
              <p>--</p>
              <p>
                Please apply here:
                <a href="https://www.ycombinator.com/companies/mixrank/jobs"
                  >https://www.ycombinator.com/companies/mixrank/jobs</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36765747">
          <h3>
            <a
              class="item"
              href="https://sourceware.org/git/?p=glibc.git;a=commit;h=454a20c8756c9c1d55419153255fc7692b3d2199"
              >Strlcpy and strlcat added to glibc 2.38</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 23:46:19</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36765747"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36765558">
          <h3>
            <a
              class="item"
              href="https://nautil.us/loss-of-smell-may-be-an-early-sign-of-brain-diseases-354483/"
              >Loss of smell may be an early sign of brain diseases</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 23:29:12</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36765558"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36765479">
          <h3>
            <a
              class="item"
              href="https://austinkleon.com/2023/07/10/never-waste-a-midlife-crisis/"
              >Never waste a midlife crisis</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 23:22:15</span
              ><span class="points-container"
                >Points: <span class="points">306</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36765479"
                  >Comments</a
                ><span class="descendants">: 295</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36763758">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/electronics/computer-memory-resistive-switching-denser-data-storage/"
              >Computer memory prototype ditches 1s and 0s for denser data
              storage</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 20:41:39</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36763758"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36763718">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2307.07367"
              >Are large language models a threat to digital public goods?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 20:37:48</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36763718"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36763493">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/07/17/books/harry-g-frankfurt-dead.html"
              >Harry Frankfurt has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 20:20:15</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36763493"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36763419">
          <h3>
            <a
              class="item"
              href="https://twitter.com/scienceisstrat1/status/1680959906969444352"
              >The US economy and the EU were the same size in 2008, the US is
              now nearly 2X</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 20:13:25</span
              ><span class="points-container"
                >Points: <span class="points">294</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36763419"
                  >Comments</a
                ><span class="descendants">: 566</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36763175">
          <h3>
            <a
              class="item"
              href="https://blog.arduino.cc/2023/07/17/introducing-the-nano-esp32-thats-iot/"
              >The Nano ESP32</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 19:55:01</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36763175"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36762879">
          <h3>
            <a
              class="item"
              href="https://twitter.com/JakeMooreUK/status/1680962682726363136"
              >You can deactivate anyone's WhatsApp account by simply sending an
              email</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 19:33:30</span
              ><span class="points-container"
                >Points: <span class="points">431</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36762879"
                  >Comments</a
                ><span class="descendants">: 198</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36762682">
          <h3>
            <a class="item" href="https://research.swtch.com/coro"
              >Coroutines for Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 19:16:31</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36762682"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36758122">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36758122"
              >Launch HN: Grai (YC S22) – Open-Source Data Observability
              Platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 13:40:22</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36758122"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
            <div class="text">
              <a href="https://grai.io">https://grai.io</a>), an open-source
              data observability platform. It helps prevent production data
              outages by evaluating changes to your data pipelines in CI, rather
              than at runtime.
              <p>
                Ever experienced a production outage due to changes in upstream
                data sources? That's a problem we regularly encountered whether
                deploying machine learning or keeping a datawarehouse
                operational and it led us to create Grai.
              </p>
              <p>
                Systematically testing the impact of data changes on the rest of
                your stack turns out to be quite difficult when the same data is
                copied and used across many different services and applications.
                Simple changes like renaming a column in a database can result
                in broken BI dashboards, incorrect training data for ML models,
                and data pipeline failure. For example, business users regularly
                deal with questions like "why does revenue look different in
                different dashboards".
              </p>
              <p>
                These sort of problems are commonly dealt with by passively
                monitoring application execution logs for anomalies that might
                indicate an outage. Our goal was to move that task out of
                runtime where an outage has already occurred back into testing.
              </p>
              <p>
                At its core, Grai is a graph of the relationships between the
                data in your organization, from columns in a database to JSON
                fields in an API. This graph allows Grai to analyze the
                downstream impact of proposed changes during CI and before they
                go live.
              </p>
              <p>
                It includes a variety of pre-built integrations with common data
                tools such as PostgreSQL, Snowflake, dbt, and Fivetran, which
                automatically extract metadata and synchronize the state of your
                graph. It's built on a flexible data model backed by REST and
                GraphQL APIs and a Python client library. This way, users can
                directly build on top of Grai as they see fit. For example,
                because every object in Grai serializes to a yaml definition
                file, sort of like a CRD in Kubernetes, even if a pre-built
                integration doesn't exist it's fairly easy to manually create or
                script a custom solution.
              </p>
              <p>
                We made the decision to build open-source from the beginning in
                part because we believe lineage is underutilized both
                organizationally and technologically. We hope to provide a
                foundation for the community to build cool concepts on top and
                have already had companies come to us with amazing ideas, like
                optimizing their real-time query pipelines to take advantage of
                spot price arbitrage between cloud and on-prem.
              </p>
              <p>
                We try not to be overly opinionated about how organizations
                work, so whether you maintain a development database or run
                service containers in GitHub Actions it doesn't really matter.
                When your tests are triggered we evaluate the new state of the
                environment and check for any impacts, before reporting back as
                a comment in the pull request.
              </p>
              <p>
                Data observability can have unexpected benefits. One of our
                customers uses us because we make on-boarding new engineers
                easier. Because we render an infinitely zoomable Figma-like
                graph of the entire data stack it's possible for them to
                visually explore end-to-end data flows and application
                dependencies.
              </p>
              <p>
                You can find a quick demo here:
                <a href="https://vimeo.com/824026569"
                  >https://vimeo.com/824026569</a
                >, we've also put together an example getting started guide if
                you want to try things out yourself:
                <a href="https://docs.grai.io/examples/enhanced-dbt"
                  >https://docs.grai.io/examples/enhanced-dbt</a
                >. Since everything is open source, you can always explore the
                code (<a href="https://github.com/grai-io/grai-core"
                  >https://github.com/grai-io/grai-core</a
                >) and docs (<a href="https://docs.grai.io"
                  >https://docs.grai.io</a
                >), where we have example deployment configurations for
                docker-compose and Kubernetes.
              </p>
              <p>
                We would love to hear your feedback. If there's a feature we're
                missing, we'll build it. If you have a UX or developer
                experience suggestion, we'll fix it. If it's something else, we
                want to hear about it. We can't wait to hear your feedback and
                thank you in advance!
              </p>
            </div>
          </section>
        </section>
        <section id="36756504">
          <h3>
            <a class="item" href="https://jacquesmattheij.com/be-consultant/"
              >How to be a consultant, a freelancer, or an independent
              contractor (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 11:05:36</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36756504"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36745852">
          <h3>
            <a class="item" href="https://www.waseda.jp/top/en/news/78001"
              >A novel solid, rechargeable air battery</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 11:36:52</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36745852"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36744888">
          <h3>
            <a class="item" href="https://www.geocities.ws/oldternet/"
              >The Homepage of the Oldternet</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 08:51:01</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36744888"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36744762">
          <h3>
            <a class="item" href="https://openbenches.org/"
              >OpenBenches – A map of memorial benches</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 08:24:17</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36744762"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36744690">
          <h3>
            <a class="item" href="https://mathoverflow.net/a/44213"
              >It's not mathematics that you need to contribute to (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 08:11:11</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36744690"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36739565">
          <h3>
            <a
              class="item"
              href="https://jeremymikkola.com/posts/2021_04_01_the_problem_with_slow_tools.html"
              >The problem with slow tools (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-15 @ 18:19:45</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36739565"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36733878">
          <h3>
            <a class="item" href="https://omniglot.com/writing/cree.htm"
              >Cree Syllabics (2002)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-15 @ 05:32:52</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36733878"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36722587">
          <h3>
            <a
              class="item"
              href="http://igoro.com/archive/gallery-of-processor-cache-effects/"
              >Gallery of Processor Cache Effects</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-14 @ 11:58:44</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36722587"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36722112">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Alto_Trek"
              >Alto Trek</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-14 @ 10:51:39</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36722112"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
