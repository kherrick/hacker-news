<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44818077">
          <h3>
            <a
              class="item"
              href="https://mixxx.org/news/2025-08-06-qml-project/"
              >The new shape of Mixxx 3.0 – Open Source DJing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 21:29:30</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44818077"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44818044">
          <h3>
            <a
              class="item"
              href="http://wonks.github.io/germane/summer2025/2025/08/06/germane.html"
              >Analyzing Control Flow More Like a Human [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 21:26:04</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44818044"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44817725">
          <h3>
            <a class="item" href="https://301party.com/"
              >301party.com: Intentionally open redirect</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 20:54:39</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44817725"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44817583">
          <h3>
            <a class="item" href="https://www.avibagla.com/blueskydictionary/"
              >The Bluesky Dictionary</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 20:43:08</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44817583"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44817539">
          <h3>
            <a class="item" href="https://www.projecthyperion.org"
              >Project Hyperion: Interstellar ship design competition</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 20:40:17</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44817539"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44816977">
          <h3>
            <a
              class="item"
              href="https://www.espn.com/espn/feature/story/_/id/43832710/how-f1-evolved-1950-where-headed-2026"
              >The History of F1 Design</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 20:01:37</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44816977"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44816755">
          <h3>
            <a
              class="item"
              href="https://www.b-list.org/weblog/2025/aug/06/litestar/"
              >Litestar is worth a look</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 19:43:01</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44816755"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44816692">
          <h3>
            <a class="item" href="https://pavpanchekha.com/blog/9bit.html"
              >We'd be better off with 9-bit bytes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 19:39:20</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44816692"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44816060">
          <h3>
            <a
              class="item"
              href="https://fontsinuse.com/uses/35835/the-arcane-alphabets-of-black-sabbath"
              >The arcane alphabets of Black Sabbath</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 18:51:54</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44816060"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44815718">
          <h3>
            <a
              class="item"
              href="https://stackdiver.com/posts/vibe-coding-the-mit-course-catalog/"
              >Vibe coding the MIT course catalog</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 18:23:19</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44815718"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44815702">
          <h3>
            <a
              class="item"
              href="https://danielchasehooper.com/posts/segment_array/"
              >A fast, growable array with stable pointers in C</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 18:21:28</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44815702"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44815405">
          <h3>
            <a
              class="item"
              href="https://github.com/gleam-lang/gleam/blob/main/changelog/v1.12.md"
              >Gleam v1.12</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 17:57:57</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44815405"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44814993">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-08-wild-pigs-flesh-neon-blue.html"
              >Wild pigs' flesh turning neon blue in California</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 17:28:56</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44814993"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44814596">
          <h3>
            <a class="item" href="https://www.multicians.org/multics.html"
              >Multics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 16:57:55</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44814596"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44813854">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/google-labs/jules-now-available/"
              >Jules, our asynchronous coding agent</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 16:05:39</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44813854"
                  >Comments</a
                ><span class="descendants">: 135</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44813789">
          <h3>
            <a
              class="item"
              href="https://www.collabora.com/news-and-blog/blog/2025/08/06/writing-a-rust-gpu-kernel-driver-a-brief-introduction-on-how-gpu-drivers-work/"
              >Writing a Rust GPU kernel driver: a brief introduction on how GPU
              drivers work</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 16:00:54</span
              ><span class="points-container"
                >Points: <span class="points">179</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44813789"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44813397">
          <h3>
            <a class="item" href="https://tonsky.me/blog/lockfiles/"
              >We shouldn't have needed lockfiles</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 15:33:37</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44813397"
                  >Comments</a
                ><span class="descendants">: 233</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44812985">
          <h3>
            <a class="item" href="https://glfmn.io/posts/zig-error-patterns/"
              >Zig Error Patterns</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 15:03:19</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44812985"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44812695">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/new-method-is-the-fastest-way-to-find-the-best-routes-20250806/"
              >Breaking the sorting barrier for directed single-source shortest
              paths</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 14:43:02</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44812695"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
            <div class="text">
              <a href="https://arxiv.org/abs/2504.17033"
                >https://arxiv.org/abs/2504.17033</a
              >
            </div>
          </section>
        </section>
        <section id="44811567">
          <h3>
            <a
              class="item"
              href="https://github.com/manzaltu/claude-code-ide.el"
              >Claude Code IDE integration for Emacs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 13:17:38</span
              ><span class="points-container"
                >Points: <span class="points">499</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44811567"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44811280">
          <h3>
            <a class="item" href="https://303-gen-06a668.netlify.app/"
              >303Gen – 303 acid loops generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 12:50:06</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44811280"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44808542">
          <h3>
            <a
              class="item"
              href="https://acko.net/blog/html-is-dead-long-live-html/"
              >Rethinking DOM from first principles</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 06:51:13</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44808542"
                  >Comments</a
                ><span class="descendants">: 128</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44807868">
          <h3>
            <a class="item" href="https://github.com/KittenML/KittenTTS"
              >Show HN: Kitten TTS – 25MB CPU-Only, Open-Source TTS Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-06 @ 05:04:36</span
              ><span class="points-container"
                >Points: <span class="points">736</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44807868"
                  >Comments</a
                ><span class="descendants">: 310</span></span
              >
            </h4>
            <div class="text">
              <p>
                This release supports English text-to-speech applications in
                eight voices: four male and four female. The model is quantized
                to int8 + fp16, and it uses onnx for runtime. The model is
                designed to run literally anywhere eg. raspberry pi, low-end
                smartphones, wearables, browsers etc. No GPU required!
              </p>
              <p>
                We're releasing this to give early users a sense of the latency
                and voices that will be available in our next release (hopefully
                next week). We'd love your feedback! Just FYI, this model is an
                early checkpoint trained on less than 10% of our total data.
              </p>
              <p>
                We started working on this because existing expressive OSS
                models require big GPUs to run them on-device and the cloud
                alternatives are too expensive for high frequency use. We think
                there's a need for frontier open-source models that are tiny
                enough to run on edge devices!
              </p>
            </div>
          </section>
        </section>
        <section id="44788321">
          <h3>
            <a
              class="item"
              href="https://math.stackexchange.com/questions/567265/why-is-it-worth-spending-time-on-type-theory"
              >Why is it worth spending time on type theory? (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-04 @ 16:46:10</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44788321"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44783717">
          <h3>
            <a
              class="item"
              href="https://www.tcracs.org/tcrwp/1origin-of-cisco/"
              >The Real Origin of Cisco Systems (1999)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-04 @ 09:48:15</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44783717"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44781343">
          <h3>
            <a
              class="item"
              href="https://every.to/feeds/b0e329f3048258e8eeb7/the-man-who-beat-ibm"
              >A Man Who Beat IBM</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-04 @ 01:31:42</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44781343"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44778898">
          <h3>
            <a class="item" href="https://comptime.js.org/"
              >Comptime.ts: compile-time expressions for TypeScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-03 @ 19:11:40</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44778898"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44778772">
          <h3>
            <a
              class="item"
              href="https://books.open.tudelft.nl/home/catalog/book/11"
              >The 1090 Megahertz Riddle: A Guide to Decoding Mode S and ADS-B
              Signals</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-03 @ 18:54:34</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44778772"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44777086">
          <h3>
            <a class="item" href="https://automerge.org/blog/automerge-3/"
              >Automerge 3.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-03 @ 15:08:58</span
              ><span class="points-container"
                >Points: <span class="points">195</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44777086"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44773480">
          <h3>
            <a class="item" href="https://systemd.io/CONVERTING_TO_HOMED/"
              >Converting Existing Users to systemd-homed</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-03 @ 02:00:51</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44773480"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
