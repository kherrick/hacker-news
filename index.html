<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44089156">
          <h3>
            <a class="item" href="https://chomsky.info/20230503-2/"
              >Chomsky on What ChatGPT Is Good For</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 17:07:58</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44089156"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44089150">
          <h3>
            <a class="item" href="https://github.com/ossu/computer-science"
              >Path to a free self-taught education in Computer Science</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 17:06:55</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44089150"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44089108">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/martin/jobs"
              >Martin (YC S23) Is Hiring Founding AI/Product Engineers to Build
              a Better Siri</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 17:00:38</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44089106">
          <h3>
            <a
              class="item"
              href="https://ephemeral.cx/2013/12/writing-a-self-mutating-x86_64-c-program/"
              >Writing a Self-Mutating x86_64 C Program (2013)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 17:00:26</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44089106"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44088926">
          <h3>
            <a
              class="item"
              href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=5202339"
              >Can a Corporation Be Pardoned?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 16:28:58</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44088926"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44088777">
          <h3>
            <a class="item" href="https://github.com/DustinBrett/daedalOS"
              >Show HN: DaedalOS – Desktop Environment in the Browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 16:06:12</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44088777"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <a href="https://dustinbrett.com">https://dustinbrett.com</a>
              <p>Hey HN!</p>
              <p>
                I've been building my passion project daedalOS for over 4 years
                now.
              </p>
              <p>
                The original idea was to give visitors to my website the
                experience as if they had remotely connected to my personal
                machine. To do this I decided I would attempt to recreate as
                much of the functionality as possible.
              </p>
              <p>
                My hope is to keep working on this project for the rest of my
                life and continue to evolve it's capabilities as technologies
                progress.
              </p>
              <p>Thanks for checking it out!</p>
            </div>
          </section>
        </section>
        <section id="44088772">
          <h3>
            <a
              class="item"
              href="https://www.damiencharlotin.com/hallucinations/"
              >AI Hallucination Cases Database</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 16:05:10</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44088772"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44088682">
          <h3>
            <a
              class="item"
              href="https://behind.pretix.eu/2018/01/20/cups-driver/"
              >Writing your own CUPS printer driver in 100 lines of Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 15:52:48</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44088682"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44088644">
          <h3>
            <a
              class="item"
              href="https://www.solipsys.co.uk/new/WhyTopPostingHasWon.html?ye25hn"
              >Why Top Posting Has Won (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 15:46:56</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44088644"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44088482">
          <h3>
            <a
              class="item"
              href="https://www.404media.co/authors-are-accidentally-leaving-ai-prompts-in-their-novels/"
              >Authors Are Accidentally Leaving AI Prompts in Their Novels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 15:24:42</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44088482"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44088392">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/VictorTaelin/5776ede998d0039ad1cc9b12fd96811c"
              >Implementing complex numbers and FFT with just datatypes
              (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 15:10:00</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44088392"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44088248">
          <h3>
            <a class="item" href="https://schaoss.github.io/wall-go/"
              >Show HN: Wall Go – browser remake of a Devil's Plan 2
              mini-game</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 14:49:46</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44088248"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/schaoss/wall-go"
                >https://github.com/schaoss/wall-go</a
              >
              <p>
                I binge-watched Netflix’s “Devil’s Plan 2” and got hooked on the
                “Wall Go” round. A few nights of vibe-coding later, here’s a
                fully playable browser version:
              </p>
              <p>
                • 7×7 board, staggered placement (1-2-2-1), 0-to-2-step moves,
                mandatory wall each turn. • Light / dark mode, mobile-friendly
                hit boxes • Simple AI (ΔReach + liberty heuristic) – beats
                random, not a grandmaster yet • Tech stack: Bun + Vite + React +
                Tailwind v4 + Zustand, deployed on GitHub Pages
              </p>
              <p>
                Looking for feedback: * is the AI too weak / unfair? * any UI
                quirks on touch devices? * rule misinterpretations I missed?
              </p>
              <p>
                Bug reports, feature requests, or PRs very welcome. Hope you
                enjoy boxing your friends into tiny corners as much as I did
                while coding this :)
              </p>
            </div>
          </section>
        </section>
        <section id="44088216">
          <h3>
            <a class="item" href="https://lottie.github.io/"
              >Lottie is an open format for animated vector graphics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 14:45:47</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44088216"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44087916">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/strange-metals-point-whole-new-way-understand-electricity"
              >'Strange metals' point to a whole new way to understand
              electricity</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 14:02:19</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44087916"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44087892">
          <h3>
            <a class="item" href="https://betterfriend-drab.vercel.app/"
              >Show HN: BetterFriend – a CRM just to be a better friend</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 13:59:12</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44087892"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
            <div class="text">
              <p>
                At work, we've got a CRM for clients, to remind ourselves to
                message people. I just needed something much smaller, just to
                remind myself to message friends and family.
              </p>
              <p>
                Friends, best friends, and family have different cadences that
                this will generate tickets to remind you to message them. Feel
                free to use, as I'll continue to host this just for myself
                regardless.
              </p>
            </div>
          </section>
        </section>
        <section id="44087844">
          <h3>
            <a class="item" href="https://hynek.me/talks/design-pressure/"
              >Design Pressure: The Invisible Hand That Shapes Your Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 13:51:55</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44087844"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44087687">
          <h3>
            <a
              class="item"
              href="https://github.com/trailbaseio/trailbase/releases/tag/v0.12.0"
              >Fast, Simple and Open Firebase Alternative: TrailBase</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 13:30:53</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44087687"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44087049">
          <h3>
            <a class="item" href="https://expressive.app/expressive-animator/"
              >Show HN: SVG Animation Software</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 11:21:22</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44087049"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
            <div class="text">
              Expressive Animator is an SVG vector animation software that helps
              users create and export animated icons, logos, and illustrations.
              Users can import SVG, PDF, Adobe Illustrator files, and Figma
              designs, and animate them using easing controls, motion paths,
              masking, and other techniques. Expressive Animator also allow
              users to export their animations in other formats as Lottie, GIF,
              PNG, and video.
            </div>
          </section>
        </section>
        <section id="44085920">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/May/25/claude-4-system-card/"
              >Claude 4 System Card</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 06:06:39</span
              ><span class="points-container"
                >Points: <span class="points">410</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44085920"
                  >Comments</a
                ><span class="descendants">: 160</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44084885">
          <h3>
            <a
              class="item"
              href="https://blog.pipetogrep.org/2025/05/23/how-to-install-windows-nt-4-server-on-proxmox/"
              >How to Install Windows NT 4 Server on Proxmox</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-25 @ 01:34:54</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44084885"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44083917">
          <h3>
            <a
              class="item"
              href="https://pleromanonx86.wordpress.com/2025/05/06/why-old-games-never-die-but-new-ones-do/"
              >Why old games never die, but new ones do</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-24 @ 21:29:05</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44083917"
                  >Comments</a
                ><span class="descendants">: 271</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44083467">
          <h3>
            <a class="item" href="https://endler.dev/2025/reinvent-the-wheel/"
              >Reinvent the Wheel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-24 @ 20:05:12</span
              ><span class="points-container"
                >Points: <span class="points">529</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44083467"
                  >Comments</a
                ><span class="descendants">: 200</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44083388">
          <h3>
            <a class="item" href="https://blog.siguza.net/tachy0n/"
              >Tachy0n: The Last 0day Jailbreak</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-24 @ 19:50:41</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44083388"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44081494">
          <h3>
            <a
              class="item"
              href="https://longform.asmartbear.com/little-company/"
              >You’re a little company, now act like one (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-24 @ 14:49:02</span
              ><span class="points-container"
                >Points: <span class="points">253</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44081494"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44072929">
          <h3>
            <a class="item" href="https://github.com/David-OConnor/daedalus"
              >Show HN: Open-source protein and ligand viewer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 13:56:36</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44072929"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm gradually splitting it into standalone libs, published to
                crates.io. Some are up already, others are integrated, and will
                be split off when sufficiently mature and decoupled.
              </p>
              <p>
                Uses parallel execution when able, through thread pools (Rayon),
                CPU SIMD and Cuda.
              </p>
              <p>
                The default control scheme is non-standard, unless you play
                video games...
              </p>
              <p>Any feedback and critique appreciated!</p>
            </div>
          </section>
        </section>
        <section id="44072137">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/news/672682/internet-archive-microfiche-lo-fi-beats-channel"
              >Now you can watch the Internet Archive preserve documents in real
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 12:14:22</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44072137"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44071769">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/graduate-student-solves-classic-problem-about-the-limits-of-addition-20250522/"
              >Graduate Student Solves Classic Problem About the Limits of
              Addition</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-23 @ 11:15:01</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44071769"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44068119">
          <h3>
            <a
              class="item"
              href="https://en.protothema.gr/2025/05/19/hydra-see-photos-of-vehicles-on-the-island-after-the-works-they-abandon-them-here-say-residents/"
              >Hydra: Vehicles on the island – 'After the works they abandon
              them here'</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 23:05:57</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44068119"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44066120">
          <h3>
            <a class="item" href="https://github.com/xe-nvdk/rtcollector"
              >Show HN: rtcollector - A modular, RedisTimeSeries-native
              observability agent</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 19:53:37</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44066120"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                Between RedisTimeSeries, RedisJSON, RediSearch, and Streams, I
                realized: this could actually be the backbone for a full
                observability stack.
              </p>
              <p>
                So I built rtcollector, a modular, Redis-native observability
                agent. It’s written in Python, configured with YAML, and
                designed to push system, container, and database metrics into
                RedisTimeSeries with labels and retention. Think of it as a
                Telegraf alternative, but for Redis.
              </p>
              <p>
                Right now, I’ve implemented input plugins for: • Linux: CPU,
                memory, disk, I/O, network • macOS: CPU, memory, disk, I/O,
                network • Docker: container stats via API • Redis, MySQL,
                PostgreSQL
              </p>
              <p>The idea is to keep it simple, extensible, and Redis-first.</p>
              <p>
                Next steps: • Native logs via RedisJSON + RediSearch (already
                prototyped!) • Support for Redis Streams (for traces/events) •
                Dashboards in Grafana using the Redis data source
              </p>
              <p>
                If you’re into observability, Redis, or just like building small
                purposeful tools, I’d love your thoughts or contributions. It’s
                early, but already useful for homelabs, edge boxes, and anyone
                tired of deploying 10 containers just to get CPU metrics.
              </p>
              <p>
                Repo:
                <a href="https://github.com/xe-nvdk/rtcollector"
                  >https://github.com/xe-nvdk/rtcollector</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44058859">
          <h3>
            <a
              class="item"
              href="https://www.historytoday.com/archive/feature/portugal-mamluks-and-age-discovery"
              >Portugal, the Mamluks, and the Age of Discovery</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 04:44:23</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44058859"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
