<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37225550">
          <h3>
            <a class="item" href="https://www.workatastartup.com/jobs/61922/"
              >Emerge (YC W21) is hiring a lead front end engineer [remote,
              small team]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 17:00:29</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37225467">
          <h3>
            <a
              class="item"
              href="https://dailyinvestor.com/energy/28170/broken-solar-panels-manufactured-specifically-for-south-africa/"
              >‘Broken’ solar panels manufactured specifically for South
              Africa</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 16:55:07</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37225467"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37225397">
          <h3>
            <a
              class="item"
              href="https://blog.alexewerlof.com/p/broken-ownership"
              >6 Archetypes of Broken Ownership</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 16:51:17</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37225397"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37224861">
          <h3>
            <a class="item" href="https://noiszy.com"
              >Noiszy: A browser plugin that creates meaningless web data –
              digital “noise.”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 16:16:57</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37224861"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37224651">
          <h3>
            <a class="item" href="https://go.dev/blog/slog"
              >Structured Logging with Slog</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 16:02:03</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37224651"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37224609">
          <h3>
            <a
              class="item"
              href="https://www.businessinsider.com/tesla-asked-nhtsa-redact-information-autopilot-fsd-use-crashes-report-2023-8"
              >Tesla asked officials to redact info of driver-assistance in use
              during crashes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 15:59:34</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37224609"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37224377">
          <h3>
            <a class="item" href="https://www.points411.com/"
              >Show HN: Points and Miles Database</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 15:43:13</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37224377"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37224148">
          <h3>
            <a class="item" href="https://flakehub.com/"
              >Show HN: FlakeHub – Discover and publish Nix flakes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 15:29:24</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37224148"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37224042">
          <h3>
            <a
              class="item"
              href="https://rosenzweig.io/blog/first-conformant-m1-gpu-driver.html"
              >The first conformant M1 GPU driver</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 15:23:09</span
              ><span class="points-container"
                >Points: <span class="points">447</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37224042"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37223776">
          <h3>
            <a class="item" href="https://github.com/opencopilotdev/opencopilot"
              >Show HN: OpenCopilot – Build Your Open-Source Copilot in a Single
              Day</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 15:03:49</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37223776"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                OpenCopilot is an OSS framework which helps devs to build
                open-source AI Copilots that actually work and embed into their
                product with ease.
              </p>
              <p>Why another LLM framework?</p>
              <p>
                Twitter is full of impressive LLM applications but once you peel
                off the curtains it’s clear that they are just demos. The reason
                being because building an AI Copilot that goes beyond a Twitter
                demo can be complex, time-consuming and unreliable.
              </p>
              <p>
                Our team has been in the AI space since 2018 and built numerous
                LLM apps &amp; copilots. While doing that, we got approached by
                many startups saying they’d also like to build a copilot for
                their product but they haven’t been able to get it reliable,
                fast or cost-effective enough for production use. Thus we built
                OpenCopilot framework, so devs can intuitively get AI Copilots
                running in less than 10 minutes and iterate towards a useful
                Copilot in a single day.
              </p>
              <p>
                We believe every product, company and individual will have their
                Copilot in the future. Thus, we’d love your feedback, questions
                and constructive criticism.
              </p>
            </div>
          </section>
        </section>
        <section id="37223323">
          <h3>
            <a
              class="item"
              href="https://www.vintag.es/2023/08/the-pocket-telephone.html"
              >1919 Cartoon Depicting the Use of a ‘Pocket Telephone’</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 14:33:32</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37223323"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37223018">
          <h3>
            <a
              class="item"
              href="https://discourse.nixos.org/t/inkscape-possible-domain-compromise/32008"
              >Inkscape possible domain compromise</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 14:15:20</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37223018"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37222823">
          <h3>
            <a class="item" href="https://github.com/chrieke/prettymapp"
              >Prettymapp – Create beautiful maps from OpenStreetMap data in a
              streamlit webapp</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 13:58:58</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37222823"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37222822">
          <h3>
            <a
              class="item"
              href="https://about.fb.com/news/2023/08/seamlessm4t-ai-translation-model/"
              >Meta Releases SeamlessM4T, a Multimodal AI Model for Speech and
              Text Translation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 13:58:50</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37222822"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37222672">
          <h3>
            <a
              class="item"
              href="https://www.404media.co/the-secret-weapon-hackers-can-use-to-dox-nearly-anyone-in-america-for-15-tlo-usinfosearch-transunion/"
              >The Secret Weapon Hackers Can Use to Dox Nearly Anyone in America
              for $15</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 13:48:41</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37222672"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37222668">
          <h3>
            <a
              class="item"
              href="https://zig.news/kristoff/extend-a-c-c-project-with-zig-55di"
              >Extend a C/C++ Project with Zig (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 13:48:28</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37222668"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37222579">
          <h3>
            <a
              class="item"
              href="https://www.techradar.com/computing/websites-apps/someone-needs-to-save-the-internet-archives-from-the-lawyers-and-i-have-an-idea"
              >Someone needs to save the Internet Archives from the lawyers and
              I have an idea</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 13:41:47</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37222579"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37222393">
          <h3>
            <a
              class="item"
              href="https://gizmodo.com/tiktok-cfius-draft-agreement-shows-spying-requests-1850759715"
              >The Feds Asked TikTok for Lots of Domestic Spying Features</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 13:26:47</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37222393"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37222191">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/8/22/23841167/microsoft-excel-python-integration-support"
              >Microsoft is bringing Python to Excel</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 13:10:09</span
              ><span class="points-container"
                >Points: <span class="points">346</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37222191"
                  >Comments</a
                ><span class="descendants">: 251</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37221487">
          <h3>
            <a class="item" href="https://manu.zone/books/close-to-the-machine/"
              >Close to the Machine: Technophilia and its discontents</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 12:05:18</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37221487"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37221138">
          <h3>
            <a class="item" href="https://github.com/gtworek/PSBits"
              >Simple PowerShell things allowing you to dig a bit deeper than
              usual</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 11:18:25</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37221138"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37220828">
          <h3>
            <a class="item" href="https://github.com/antonmedv/walk"
              >Antonmedv/walk: Terminal file manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 10:37:51</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37220828"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37220667">
          <h3>
            <a
              class="item"
              href="https://blog.promaton.com/how-to-avoid-kpi-psychosis-in-your-organization-5ffc83967f2b?gi=aaf774f21dbb"
              >Why KPIs are destroying businesses</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 10:09:49</span
              ><span class="points-container"
                >Points: <span class="points">385</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37220667"
                  >Comments</a
                ><span class="descendants">: 331</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37219779">
          <h3>
            <a
              class="item"
              href="https://www.arm.com/company/news/2023/08/arm-announces-public-filing-of-registration-statement-for-proposed-initial-public-offering"
              >Arm Announces Public Filing for Proposed Initial Public
              Offering</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 07:44:50</span
              ><span class="points-container"
                >Points: <span class="points">276</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37219779"
                  >Comments</a
                ><span class="descendants">: 228</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37219374">
          <h3>
            <a
              class="item"
              href="https://archive.org/details/healthlighteffec00ottj"
              >Effects of natural and artificial light on man and other living
              things (1909)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 06:31:11</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37219374"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37218841">
          <h3>
            <a
              class="item"
              href="https://blog.ioces.com/matt/posts/i-walked-across-luxembourg/"
              >I walked across Luxembourg</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 04:57:26</span
              ><span class="points-container"
                >Points: <span class="points">321</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37218841"
                  >Comments</a
                ><span class="descendants">: 189</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37218727">
          <h3>
            <a
              class="item"
              href="https://scienceswitch.com/2023/08/22/revolutionary-electrolyzer-efficiently-converts-co2-into-renewable-propane-fuel/"
              >Electrolyzer efficiently converts CO2 into renewable propane
              fuel</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 04:34:04</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37218727"
                  >Comments</a
                ><span class="descendants">: 228</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37218263">
          <h3>
            <a
              class="item"
              href="https://www.hillelwayne.com/post/ahk-scripts-project/"
              >Learn AutoHotKey by stealing my scripts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 03:20:32</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37218263"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37217761">
          <h3>
            <a
              class="item"
              href="https://blog.ploeh.dk/2023/08/21/compile-time-type-checked-truth-tables/"
              >Compile-Time Checked Truth Tables</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-22 @ 02:07:56</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37217761"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37214898">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence"
              >Kullback–Leibler Divergence</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-21 @ 20:26:31</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37214898"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
