<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41080644">
          <h3>
            <a class="item" href="https://tonsky.me/blog/diagrams/"
              >Where should visual programming go?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:50:42</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080644"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080599">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=pJ-25-pRhpY"
              >Call the compiler, fax it your code [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:45:08</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080599"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080570">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=qlfh_rv6khY"
              >A simple procedural animation technique [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:40:18</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080570"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080485">
          <h3>
            <a
              class="item"
              href="https://mcognetta.github.io/posts/leetcode-random-seed/"
              >Finding a random seed that solves a LeetCode problem (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:31:03</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080485"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080442">
          <h3>
            <a
              class="item"
              href="https://www.lumafield.com/article/how-does-a-car-cigarette-lighter-work"
              >How a car cigarette lighter works, in CT scans</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:25:14</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080442"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080435">
          <h3>
            <a
              class="item"
              href="https://www.newscientist.com/article/2438117-google-creates-self-replicating-life-from-digital-primordial-soup/"
              >Google creates self-replicating life from digital 'primordial
              soup'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:24:38</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080435"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080373">
          <h3>
            <a
              class="item"
              href="https://statmodeling.stat.columbia.edu/2024/07/10/three-cultures-bayes-subjective-objective-pragmatic/"
              >Bayesian Statistics: The Three Cultures</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:15:15</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080373"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080367">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Androgynous_Peripheral_Attach_System"
              >Androgynous Peripheral Attach System</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:14:52</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080367"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080366">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/monumental-proof-settles-geometric-langlands-conjecture-20240719/"
              >Monumental proof settles geometric Langlands conjecture</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:14:32</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080366"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080222">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41080222"
              >Sample (YC W24) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 17:00:19</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                We’re starting by automating billing for clinical labs. Clinical
                labs often go unpaid for &gt;30% of the tests they run, and
                pathologists will inevitably get roped into insurance paperwork
                over helping patients. Our product automatically gets the right
                documentation together for reimbursement, sends paperwork to
                insurance, and follows up over the phone to make sure clinicians
                get paid for their work.
              </p>
              <p>
                Labs are just the start: our goal is to become the payment rails
                for medical benefits. Instead of doctors spending their time on
                paperwork, we’re building the infrastructure to let them focus
                on patients again. After winning in labs, we'll support more
                specialties with their billing and sell directly to health
                insurance.
              </p>
              <p>
                We’re based in San Francisco, and are hiring an on-site founding
                engineer to join our team. We’re profitable and backed by some
                of the best founders &amp; leaders in the industry, including
                Homebrew Ventures, Hummingbird VC, Y Combinator, Kulveer Taggar
                (CEO, Zeus), Zack Kanter (CEO, Stedi), and great folks from
                Retool, Stripe, Ambience Healthcare, and Watershed.
              </p>
              <p>
                If this sounds interesting, send by an email to
                ankit@samplehc.com with HN in the title. Looking forward to
                meeting you!
              </p>
            </div>
          </section>
        </section>
        <section id="41080070">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/us-news/education/advanced-placement-exams-test-scores-higher-f4dce3c2"
              >It is now easier to pass AP tests</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 16:45:35</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080070"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080063">
          <h3>
            <a
              class="item"
              href="https://www.fastcompany.com/91159743/skip-and-arcteryx-built-an-amazing-new-exoskeleton-heres-what-its-like-to-walk-in-it"
              >Skip and Arc'teryx built a futuristic exoskeleton</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 16:44:35</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080063"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41079819">
          <h3>
            <a
              class="item"
              href="https://moonbearmusings.com/lets-talk-about-how-mihoyos-monetization-works/"
              >How Mihoyo's monetization works</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 16:14:45</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41079819"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41079814">
          <h3>
            <a
              class="item"
              href="https://eieio.games/essays/scaling-one-million-checkboxes/"
              >Scaling One Million Checkboxes to 650M checks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 16:14:15</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41079814"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41079388">
          <h3>
            <a
              class="item"
              href="https://blog.wfmu.org/freeform/2009/03/captain-beefhearts-10-commandments-of-guitar-playing.html"
              >Captain Beefheart's 10 Commandments of Guitar Playing (1996)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 15:23:59</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41079388"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41079083">
          <h3>
            <a class="item" href="https://siboehm.com/articles/22/CUDA-MMM"
              >How to optimize a CUDA matmul kernel for cuBLAS-like performance:
              a worklog</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 14:50:10</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41079083"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41079027">
          <h3>
            <a class="item" href="https://text.npr.org/nx-s1-5049970"
              >how do you 'accurately' speak English in ancient Rome?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 14:44:35</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41079027"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41076831">
          <h3>
            <a
              class="item"
              href="https://www.lemonde.fr/en/france/article/2024/07/26/france-s-high-speed-trains-struck-by-malicious-acts_6699471_7.html"
              >France high-speed rail traffic disrupted by 'malicious acts' on
              Olympic ceremony</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 08:23:08</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41076831"
                  >Comments</a
                ><span class="descendants">: 308</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41076375">
          <h3>
            <a class="item" href="https://lwn.net/Articles/972580/"
              >A hash table by any other name</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 06:53:50</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41076375"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41075766">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2024-07-26/zurich-bern-consider-billboard-bans-after-vernier-outlaws-visual-pollution"
              >A Swiss town banned billboards. Zurich, Bern may soon follow</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 04:26:53</span
              ><span class="points-container"
                >Points: <span class="points">473</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41075766"
                  >Comments</a
                ><span class="descendants">: 477</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41075390">
          <h3>
            <a class="item" href="https://publish.uwo.ca/~jbell/univ.pdf"
              >Alexandre Grothendieck, The New Universal Church (1971) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 02:31:56</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41075390"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41074485">
          <h3>
            <a class="item" href="https://github.com/google-deepmind/treescope"
              >Treescope: Interactive HTML Pretty-Printer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 23:23:26</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41074485"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41073777">
          <h3>
            <a
              class="item"
              href="https://stamen.com/the-many-lives-of-null-island/"
              >The Many Lives of Null Island</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 21:52:21</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41073777"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41069829">
          <h3>
            <a
              class="item"
              href="https://deepmind.google/discover/blog/ai-solves-imo-problems-at-silver-medal-level/"
              >AI solves International Math Olympiad problems at silver medal
              level</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 15:29:41</span
              ><span class="points-container"
                >Points: <span class="points">1297</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41069829"
                  >Comments</a
                ><span class="descendants">: 495</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41067079">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/why-levittown-didnt-revolutionize"
              >Why Levittown didn't revolutionize homebuilding</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 10:54:14</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41067079"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41063361">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-02369-7"
              >Memory for music doesn't diminish with age</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 23:36:37</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41063361"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41044262">
          <h3>
            <a
              class="item"
              href="https://blog.mattstuchlik.com/2024/07/21/fastest-memory-read.html"
              >Counting bytes faster than you'd think possible</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 09:34:38</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41044262"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41040900">
          <h3>
            <a
              class="item"
              href="https://www.nbcnews.com/news/us-news/shoe-prints-lead-fbi-suspect-man-woman-involved-multiple-new-mexico-wi-rcna163087"
              >Shoe prints lead FBI to suspect couple involved in multiple New
              Mexico wildfires</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 23:28:23</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41040900"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41036370">
          <h3>
            <a
              class="item"
              href="https://standardsmanual.com/products/nasa-graphics-standards-manual"
              >NASA Graphics Standards Manual</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 16:34:23</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41036370"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41036267">
          <h3>
            <a
              class="item"
              href="https://www.therailwayhub.co.uk/67072/from-the-archive-operation-smash-hit-84/"
              >When British Railways deliberately crashed a train</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 16:27:59</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41036267"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
