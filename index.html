<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41847656">
          <h3>
            <a
              class="item"
              href="https://www.earth.com/news/study-dark-matter-does-not-exist-and-the-universe-is-27-billion-years-old/"
              >Study: Dark matter doesn't exist, the universe is 27B years
              old</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 12:04:30</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41847656"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41847239">
          <h3>
            <a class="item" href="http://lillian.com/films/"
              >Short films by Lillian F. Schwartz (1927-2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 10:58:52</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41847239"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41846780">
          <h3>
            <a class="item" href="https://browser.engineering/index.html"
              >Web Browser Engineering</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 09:42:29</span
              ><span class="points-container"
                >Points: <span class="points">244</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41846780"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41846636">
          <h3>
            <a class="item" href="https://github.com/Snowiiii/Pumpkin"
              >Show HN: Pumpkin – A Modern Minecraft server written in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 09:18:16</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41846636"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41845646">
          <h3>
            <a
              class="item"
              href="https://github.com/gnikoloff/drawing-graphics-on-apple-vision-with-metal-rendering-api"
              >Drawing Graphics on Apple Vision with the Metal Rendering API</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 06:44:44</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41845646"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41844545">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/sport/2024/oct/14/cheating-alleged-after-mens-world-conker-champion-found-with-steel-chestnut"
              >World conker champion found with steel chestnut, cleared of
              cheating</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-15 @ 03:12:00</span
              ><span class="points-container"
                >Points: <span class="points">308</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41844545"
                  >Comments</a
                ><span class="descendants">: 415</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41842975">
          <h3>
            <a class="item" href="https://www.zyphra.com/post/zamba2-7b"
              >Zamba2-7B</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 22:45:51</span
              ><span class="points-container"
                >Points: <span class="points">267</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41842975"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41842775">
          <h3>
            <a
              class="item"
              href="https://mattferraro.dev/posts/caustics-engineering"
              >The Physics of Magic Windows (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 22:25:47</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41842775"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41842294">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/health/2024/10/do-you-really-need-those-routine-dental-x-rays-probably-not/"
              >Routine dental X-rays are not backed by evidence</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 21:37:00</span
              ><span class="points-container"
                >Points: <span class="points">223</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41842294"
                  >Comments</a
                ><span class="descendants">: 219</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41841366">
          <h3>
            <a class="item" href="https://www.greptile.com/blog/how-we-engineer"
              >Splitting engineering teams into defense and offense</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 20:07:27</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41841366"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840872">
          <h3>
            <a
              class="item"
              href="https://play.ht/news/introducing-play-3-0-mini/"
              >Play 3.0 mini – A lightweight, reliable, cost-efficient
              Multilingual TTS model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 19:16:17</span
              ><span class="points-container"
                >Points: <span class="points">210</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840872"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840769">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/business/energy-oil/google-nuclear-power-artificial-intelligence-87966624"
              >Google commits to buying power generated by nuclear-energy
              startup Kairos Power</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 19:06:22</span
              ><span class="points-container"
                >Points: <span class="points">520</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840769"
                  >Comments</a
                ><span class="descendants">: 404</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840390">
          <h3>
            <a class="item" href="https://jsomers.net/blog/gettiers"
              >The three-page paper that shook philosophy: Gettiers in software
              engineering</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 18:28:54</span
              ><span class="points-container"
                >Points: <span class="points">235</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840390"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41840023">
          <h3>
            <a
              class="item"
              href="https://medicalxpress.com/news/2024-10-commonly-arm-positions-substantially-overestimate.html"
              >Commonly used arm positions can overestimate blood pressure
              readings: study</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:57:00</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41840023"
                  >Comments</a
                ><span class="descendants">: 185</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839994">
          <h3>
            <a class="item" href="https://github.com/payloadcms/payload"
              >PayloadCMS: Open-Source, Fullstack Next.js Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:55:13</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839994"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839776">
          <h3>
            <a
              class="item"
              href="https://coldwaters.substack.com/p/scale-ruins-everything"
              >Scale Ruins Everything</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:34:38</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839776"
                  >Comments</a
                ><span class="descendants">: 136</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839773">
          <h3>
            <a class="item" href="https://github.com/spiraldb/vortex"
              >Show HN: Vortex – a high-performance columnar file format</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 17:34:26</span
              ><span class="points-container"
                >Points: <span class="points">202</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839773"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839326">
          <h3>
            <a class="item" href="https://furilabs.com/shop/flx1/"
              >Furilabs Linux Phone</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 16:52:13</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839326"
                  >Comments</a
                ><span class="descendants">: 171</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41839095">
          <h3>
            <a
              class="item"
              href="https://www.elidourado.com/p/airship-industries"
              >Cargo Airships Are Happening</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 16:31:25</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41839095"
                  >Comments</a
                ><span class="descendants">: 100</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41838337">
          <h3>
            <a class="item" href="https://busy.bar/?hn">Busy Status Bar</a>
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 15:19:12</span
              ><span class="points-container"
                >Points: <span class="points">1221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41838337"
                  >Comments</a
                ><span class="descendants">: 387</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41837204">
          <h3>
            <a class="item" href="https://github.com/splitbrain/clipscreen"
              >Show HN: X11 tool to share a screen area in any video meeting</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 13:11:56</span
              ><span class="points-container"
                >Points: <span class="points">294</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41837204"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41836903">
          <h3>
            <a class="item" href="http://www.technoblogy.com/show?4MGW"
              >Sound Lab – A Simple Analogue Synthesiser</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 12:31:26</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41836903"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41835040">
          <h3>
            <a class="item" href="https://github.com/gosub-io/gosub-engine"
              >Gosub – An open-source browser engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-14 @ 07:17:00</span
              ><span class="points-container"
                >Points: <span class="points">328</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41835040"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
            <div class="text">
              <p>
                Today, we're excited to introduce Gosub, a new open-source
                browser engine that we are building from the ground up in Rust!
              </p>
              <p>
                Gosub aims to be a modern, modular, and highly flexible browser
                engine. While still in the early development and experimentation
                phase, Gosub is shaping up nicely, and we’re looking to onboard
                more contributors to help us bring this project to life.
              </p>
              <p>Some of the key highlights:</p>
              <p></p>
              <pre><code>  * Written in Rust: We're leveraging Rust's safety and performance features to create a robust and efficient engine.
  * Modular Design: The project is organized around modules, allowing for clean separation of concerns and easier collaboration. It also allows us to easily swap components based on needs and allows more freedom for engine implementers in the future.
  * Collaborative and open source: We’re building Gosub with the intention of making it approachable and open to contributions, aiming to create a project that's easier to understand and collaborate on compared to existing browsers.
</code></pre>
              Instead of writing another shell around Chromium or WebKit, we
              decided to write a browser engine from scratch. We believe that
              having a diverse landscape of engines is the only way to defeat a
              monoculture that is currently threatening current browsers and by
              extension the internet itself. We cannot and should not let a very
              small number of large companies dictate the future of the web and
              its usage.
              <p>
                With Gosub, we're aiming to build something more approachable
                that can evolve with the latest web technologies, all while
                being open to contributors from day one.
              </p>
              <p>
                We’re looking for developers with or without experience in Rust.
                You just need to be interested in browser technologies. There
                are plenty of opportunities to work on core modules, document
                our progress, and help shape the project's direction.
              </p>
              <p>
                We can already render simple pages, including the hackernews
                front page. However, to render most sites correctly, it is still
                a long journey, so come and join us!
              </p>
            </div>
          </section>
        </section>
        <section id="41819217">
          <h3>
            <a
              class="item"
              href="https://taylor.town/history-of-microwave-ovens"
              >A History of Microwave Ovens</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-12 @ 14:14:30</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41819217"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41818964">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-10-hidden-teeth-dna-19th-century.html"
              >19th century lions preyed on humans and giraffes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-12 @ 13:35:45</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41818964"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41818620">
          <h3>
            <a
              class="item"
              href="https://www.cell.com/cancer-cell/pdf/S1535-6108(02)00133-2.pdf"
              >Can a biologist fix a radio? What I learned while studying
              apoptosis (2002) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-12 @ 12:34:55</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41818620"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41818609">
          <h3>
            <a class="item" href="https://www.kv4p.com/"
              >Turn your Android phone into a modern ham radio transceiver</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-12 @ 12:32:29</span
              ><span class="points-container"
                >Points: <span class="points">419</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41818609"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41812762">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2024/oct/10/images-remarkable-preservation-ernest-shackleton-ship-endurance"
              >New images show state of preservation of Ernest Shackleton's
              ship</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-11 @ 19:33:18</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41812762"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41803457">
          <h3>
            <a
              class="item"
              href="https://gist.github.com/dannguyen/faaa56cebf30ad51108a9fe4f8db36d8"
              >Extracting financial disclosure and police reports with OpenAI
              Structured Output</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-10 @ 20:51:14</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41803457"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41784521">
          <h3>
            <a
              class="item"
              href="https://www.te.com/en/products/sensors/position-sensors/resources/lvdt-tutorial.html"
              >Linear Variable Differential Transformer (LVDT) Basics</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 04:32:16</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41784521"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
