<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36203204">
          <h3>
            <a class="item" href="https://www.thousandeyes.com/outages/"
              >Is there a wider internet outage today?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 20:34:57</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36203204"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36202650">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36202650"
              >Ask HN: What Are You Working On?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 19:58:31</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36202650"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <p>
                I'm Neo, currently building a newsletter called Unheard Roots
                where I share the stories &amp; strategies behind the early days
                of game changing startups.
              </p>
              <p>
                If you're building a startup that has found PMF and want to put
                your story out there, I'd love to do a feature on you.
              </p>
              <p>
                I've got an audience of 800+ entrepreneurs, startups employees,
                and VCs / Investors across the board that would be seeing your
                story.
              </p>
              <p>
                We would talk about how you got into startups / business, how
                you decided to build your current venture, and the stories &amp;
                strategies from the early days (growth, building the product,
                fundraising, etc).
              </p>
              <p>
                Just comment under this post and tell me about yourself &amp;
                your startup.I promise I will reply to each and every serious
                comment.
              </p>
              <p>
                (Alternatively you can reach out to me on Twitter at
                @theneooftech)
              </p>
            </div>
          </section>
        </section>
        <section id="36202088">
          <h3>
            <a
              class="item"
              href="https://twitter.com/jonsneyers/status/1665792517613256705"
              >macOS 14 will support JPEG XL</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 19:23:15</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36202088"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36201821">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2023/06/05/some-blogging-myths/"
              >Some Blogging Myths</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 19:12:44</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36201821"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36201608">
          <h3>
            <a class="item" href="https://www.apple.com/apple-vision-pro/"
              >Apple Vision Pro</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 19:06:04</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36201608"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36201593">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2023/06/introducing-apple-vision-pro/"
              >Apple Vision Pro: Apple’s first spatial computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 19:04:46</span
              ><span class="points-container"
                >Points: <span class="points">858</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36201593"
                  >Comments</a
                ><span class="descendants">: 918</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36200806">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2023/06/ios-17-makes-iphone-more-personal-and-intuitive/"
              >iOS 17 makes iPhone more personal and intuitive</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 18:29:08</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36200806"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36200738">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/science-nature/forests-around-chernobyl-arent-decaying-properly-180950075/"
              >Forests Around Chernobyl Aren’t Decaying Properly (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 18:24:47</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36200738"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36200480">
          <h3>
            <a
              class="item"
              href="https://developer.chrome.com/blog/how-photoshop-solved-working-with-files-larger-than-can-fit-into-memory/"
              >How Photoshop solved working with files larger than can fit into
              memory</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 18:10:49</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36200480"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36200389">
          <h3>
            <a class="item" href="https://web.whatsapp.com/">WhatsApp Down</a>
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 18:05:20</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36200389"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36200268">
          <h3>
            <a
              class="item"
              href="https://www.obe.tv/why-does-mpeg-ts-still-exist/"
              >Why does MPEG Transport Stream still exist?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 17:58:19</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36200268"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36199911">
          <h3>
            <a class="item" href="https://argilla.io/blog/argilla-for-llms/"
              >Open-Source Data Collection Platform for LLM Fine-Tuning and
              RLHF</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 17:37:35</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36199911"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36199639">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2023/06/apple-unveils-new-mac-studio-and-brings-apple-silicon-to-mac-pro/"
              >Apple unveils new Mac Studio and brings Apple Silicon to Mac
              Pro</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 17:22:16</span
              ><span class="points-container"
                >Points: <span class="points">281</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36199639"
                  >Comments</a
                ><span class="descendants">: 171</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36199637">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2023/06/apple-introduces-m2-ultra/"
              >Apple Introduces M2 Ultra</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 17:22:11</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36199637"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36198566">
          <h3>
            <a
              class="item"
              href="https://ersei.net/en/blog/diy-programming-language"
              >Building a Programming Language in Twenty-Four Hours</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 16:19:06</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36198566"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36198329">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2023/06/our-right-challenge-junk-patents-under-threat"
              >Our right to challenge junk patents is under threat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 16:03:55</span
              ><span class="points-container"
                >Points: <span class="points">687</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36198329"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36197880">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36197880"
              >Launch HN: Nucleus (YC W23) – Kubernetes platform for both devs
              and ops</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 15:39:09</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36197880"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <a href="https://nucleuscloud.com">https://nucleuscloud.com</a>),
              a Kubernetes developer platform. We automate infrastructure,
              security, integrations, and more, helping developers ship faster
              while also automating a lot of repetitive tasks for devops and
              platform teams. Here’s a demo:
              <a
                href="https://www.loom.com/share/95265177704346c7b379e981978cd8c5"
                >https://www.loom.com/share/95265177704346c7b379e981978cd8c5</a
              >.
              <p>
                It's expensive, time-consuming, and technically difficult to
                build a secure, scalable Kubernetes platform. Yet many companies
                that do this spend 6+ months building it themselves and then
                hire an expensive platform team to manage it. We've talked to
                customers who have spent $1.5M to build something that isn't
                their core product.
              </p>
              <p>
                On the technology side, you have to solve for authentication,
                authorization, service registry and discovery, scalability,
                observability, infrastructure and more. Most teams end up
                stitching together a bunch of OS tools and cloud primitives just
                to end up with a fragile system that’s difficult to maintain as
                it grows. On the people side, it’s difficult and expensive to
                find developers and devops engineers who deeply understand
                Kubernetes and distributed systems. When they leave, tech and
                process documentation is incomplete, hard to find and often
                outdated.
              </p>
              <p>
                Nick and I have been building infrastructure platforms for the
                past 7 years at companies like NewFront, Skyflow, IBM and
                Garmin. Companies like ours were spending a lot of time and
                energy in building internal developer platforms from scratch and
                then hiring expensive teams to maintain them. These were
                important platforms but never the companies’ core product. It
                seemed crazy to us that a series A company would have 2-3
                developers spend 6+ months building something that wasn't their
                core product. We felt like there had to be a better way.
              </p>
              <p>
                We’re building a platform that accomplishes 4 things: (1) Reduce
                the time it takes to spin up Kubernetes environments and
                services; (2) Provide an intuitive developer experience that
                simplifies working with Kubernetes; (3) Empower devops and
                platform teams to automate manual tasks and enable developer
                self service without spending months building infra; (4)
                Centralize, organize and be a source of truth for infra-related
                configurations, processes and documentation.
              </p>
              <p>
                To get into the architecture a bit, you can think of Nucleus as
                three layers:
              </p>
              <p>
                At the bottom layer, we build and manage pre-configured
                Kubernetes clusters in your AWS accounts. We install different
                add-ons into the cluster that enable key functionality such as
                security, autoscaling and metrics. You can find a full list in
                our docs -
                <a href="https://docs.nucleuscloud.com"
                  >https://docs.nucleuscloud.com</a
                >. The idea is that you can run Nucleus on autopilot without
                needing to be a Kubernetes expert. That said, many engineers
                want access to kubectl, so we make it easy to provision
                different user-profiles with different access to kubectl via an
                IAM role.
              </p>
              <p>
                The next layer up is the service mesh layer. We built on top of
                Istio to implement things like authN, authZ, service discovery
                and registry. We were also really inspired by this blogpost from
                the neobank Monzo (<a
                  href="https://monzo.com/blog/2022/03/31/how-we-secure-monzos-banking-platform"
                  >https://monzo.com/blog/2022/03/31/how-we-secure-monzos-banki...</a
                >). Each cluster has a dedicated load balancer that sits in a
                public subnet while the cluster and services are in a private
                subnet. Communication between these services uses mTLS. Private
                services are, by default, isolated and can’t talk to any other
                service unless you explicitly authorize it. We make that as easy
                as passing in the service name. This is all automated and
                transparent to the end-user. We’re soon going to be coming out
                with more features around managing load balancers and enabling
                blue-green deploys with zero downtime cutovers.
              </p>
              <p>
                The top layer is our integration layer. We provide a bunch of
                integrations and we’re continuing to building out more. This
                includes container registry tools (DockerHub, ECR, Github),
                Observability (Datadog, Prometheus, Grafana), Secrets Managers
                (param store), DBs (Aurora, MongoDb), and CI/CD (github
                actions). The idea is that you shouldn’t be spending time trying
                to build integrations for each of your services, you should just
                point-and-click which ones you need. We’ve built a permissioning
                system which makes it easy to give/revoke access for an
                integration to any service or environment. For example, if you
                want your dev services to have access to your dev db, you
                shouldn’t have to build that separately for each service. You
                just configure it once, pick the services or environment that
                needs access to and we automatically expose those environment
                variables to those services.
              </p>
              <p>
                Ultimately, the vision is to build a platform across all cloud
                providers that developers and devops teams can use to build,
                test, deploy and manage environments and services transparently.
                We strongly believe that developers and devops/platform teams
                should be working on the same platform. So many of the
                communication and siloing issues happen because teams use
                different platforms and tools. Consolidating those into one
                platform helps everyone stay in sync and have access to
                everything they need.
              </p>
              <p>
                We’ve never been big fans of the complicated pricing that most
                SaaS companies have so we sell Nucleus as a single annual
                license where you get everything. In full transparency, we
                currently price Nucleus around $35k/license, or about 10% of
                what it would cost you to build and maintain this yourself.
              </p>
              <p>
                Our current customers range from small startups who want to
                focus on getting to market fast and not worry about infra or
                devops, to mid-market companies that want to empower their
                existing devops teams with automation. Their main use-cases are:
                1. Automatically containerizing their services (with our
                built-in CI/CD pipeline) and deploying them on Kubernetes 2.
                Building out a microservices architecture (we have a built-in in
                service mesh) 3. Making it easy for developers to self-service
                environments, environment variables and more.
              </p>
              <p>
                If you're interested to learn more, check out our docs (<a
                  href="https://docs.nucleuscloud.com"
                  >https://docs.nucleuscloud.com</a
                >) and you can sign up for a free account here (<a
                  href="https://app.nucleuscloud.com"
                  >https://app.nucleuscloud.com</a
                >). We're always looking for feedback so please let us know your
                thoughts/questions and thanks for having us!
              </p>
            </div>
          </section>
        </section>
        <section id="36197569">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/06/05/business/sec-binance-charges.html"
              >SEC Accuses Binance of Mishandling Funds and Lying to
              Regulators</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 15:23:58</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36197569"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36197353">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2023-06-05/sec-sues-binance-and-ceo-zhao-for-breaking-us-securities-rules"
              >SEC Sues Binance and CEO Zhao for Breaking US Securities Rules</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 15:13:30</span
              ><span class="points-container"
                >Points: <span class="points">369</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36197353"
                  >Comments</a
                ><span class="descendants">: 277</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36197291">
          <h3>
            <a
              class="item"
              href="https://platform.openai.com/docs/guides/gpt-best-practices"
              >GPT Best Practices</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 15:10:05</span
              ><span class="points-container"
                >Points: <span class="points">352</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36197291"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36197280">
          <h3>
            <a
              class="item"
              href="https://twitter.com/joncstone/status/1665728784366960641"
              >An Excel error led Austria's SPÖ to announce the wrong candidate
              as the winner</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 15:09:37</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36197280"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36197266">
          <h3>
            <a
              class="item"
              href="https://www.lilysthings.org/blog/linux-on-xbox360/"
              >Linux on the Xbox 360</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 15:08:55</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36197266"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36195600">
          <h3>
            <a
              class="item"
              href="https://natehoffelder.com/blog/google-no-longer-automatically-indexes-websites-wtf/"
              >Google no longer automatically indexes websites?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 13:01:54</span
              ><span class="points-container"
                >Points: <span class="points">455</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36195600"
                  >Comments</a
                ><span class="descendants">: 389</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36194950">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-01845-w"
              >Thousands of early-career NIH researchers forming union for first
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 11:40:27</span
              ><span class="points-container"
                >Points: <span class="points">236</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36194950"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36194941">
          <h3>
            <a
              class="item"
              href="https://shkspr.mobi/blog/2023/06/why-did-usenet-fail/"
              >Why did Usenet fail?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 11:39:28</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36194941"
                  >Comments</a
                ><span class="descendants">: 176</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36194786">
          <h3>
            <a class="item" href="https://austinhenley.com/blog/cosine.html"
              >Implementing Cosine in C from Scratch (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 11:12:11</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36194786"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36194703">
          <h3>
            <a
              class="item"
              href="https://borretti.me/article/why-lisp-syntax-works"
              >Why Lisp Syntax Works</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 10:59:05</span
              ><span class="points-container"
                >Points: <span class="points">259</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36194703"
                  >Comments</a
                ><span class="descendants">: 232</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36193326">
          <h3>
            <a class="item" href="https://graydon2.dreamwidth.org/307291.html"
              >The Rust I wanted had no future</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 07:03:45</span
              ><span class="points-container"
                >Points: <span class="points">773</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36193326"
                  >Comments</a
                ><span class="descendants">: 408</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36192777">
          <h3>
            <a class="item" href="https://sandstorm.io/"
              >Sandstorm: Open-source platform for self-hosting web apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 05:41:46</span
              ><span class="points-container"
                >Points: <span class="points">393</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36192777"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36191713">
          <h3>
            <a class="item" href="http://www.typewritten.org/Media/"
              >Historical workstation desktop interface screenshots</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 02:53:47</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36191713"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
