<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43905697">
          <h3>
            <a class="item" href="https://aso.dev/blog/apple-sign-in/"
              >Show HN: Sign in with Apple" broke after update–losing data for a
              third of users</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 14:41:58</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43905697"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>What exactly happened?</p>
              <p>
                • Apple began returning a completely new userIdentifier for
                existing Apple IDs, without users initiating any changes. This
                effectively made user authentication impossible, as we can no
                longer match users to their existing data. • The email field now
                always returns null. Although this behavior is typical for
                subsequent sign-ins, it’s irrelevant in this case because the
                userIdentifier itself changed, leaving no way to identify
                existing accounts. • Previously issued relay emails
                (@privaterelay.appleid.com) no longer accept emails—we verified
                this with bounce tests. • Users also report that our app has
                disappeared from their Apple ID’s authorized apps list.
              </p>
              <p>Important context:</p>
              <p>
                • We migrated our Apple Developer account from Individual to
                Organization about a year ago. • Everything worked perfectly
                until the May 3, 2025 update. • The incident occurred precisely
                on the day Apple released updates to the Developer Console
                (Accounts, Profiles, etc.). We strongly believe these internal
                changes at Apple triggered the issue.
              </p>
              <p>Consequences:</p>
              <p>
                • Every user received a new userIdentifier, meaning our system
                sees returning users as entirely new, breaking the link to their
                historical data. • One-third of our users, who registered via
                Apple’s private relay email, are now completely unreachable: •
                We can’t contact them (emails bounce). • We can’t restore their
                access (new IDs don’t match old accounts). • We have sent three
                support requests to Apple via email—no reply or acknowledgment
                yet, with no escalation path or live chat available.
              </p>
              <p>⸻</p>
              <p>
                We were fortunate because ASO.dev also supports an alternative
                sign-in method (email with a one-time login code). Without this
                alternative, we would’ve permanently lost access for every user
                who originally signed in with Apple.
              </p>
              <p>⸻</p>
              <p>We’re openly sharing this story to:</p>
              <p>
                • Warn developers who rely solely on Apple Sign-In and relay
                email addresses. • Connect with others who’ve faced similar
                issues—let’s share experiences. • Draw Apple’s attention to this
                critical problem—currently, there is no documented solution and
                no available support.
              </p>
              <p>
                Never rely solely on Apple ID authentication. Always implement a
                fallback method, as even major ecosystems can fail
                unpredictably.
              </p>
            </div>
          </section>
        </section>
        <section id="43905299">
          <h3>
            <a class="item" href="https://accent-strength.boldvoice.com/"
              >Accents in Latent Spaces: How AI Hears Accent Strength in
              English</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 14:07:57</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43905299"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43905185">
          <h3>
            <a class="item" href="https://github.com/al13n321/nnd"
              >Nnd – a TUI debugger alternative to GDB, LLDB</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 13:58:03</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43905185"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43904865">
          <h3>
            <a
              class="item"
              href="https://github.com/mohsenph69/Godot-MTerrain-plugin"
              >MTerrain: Optimized terrain system and editor for Godot</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 13:26:21</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43904865"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43904511">
          <h3>
            <a class="item" href="https://github.com/hookdeck/outpost"
              >Show HN: Outpost – OSS infra for outbound webhooks and event
              destinations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 12:50:46</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43904511"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                If you're building a platform, you eventually need to send
                events to your users (think payment success, resource updates,
                workflow changes). Implementing this reliably—handling retries,
                monitoring, scaling, providing a decent dev experience for
                consumers, and managing tenants—becomes a significant, recurring
                engineering task that distracts from core product development.
                We built Outpost to offload that complexity.
              </p>
              <p>
                Outpost delivers events via traditional webhooks and also
                directly to event destinations like message queues and buses.
                While webhooks are ubiquitous, they have limitations at scale
                regarding cost, reliability patterns, and security posture. We
                observed platforms like Stripe, Shopify, and Twilio offering
                direct bus/queue integrations for these reasons—it's often
                cheaper and more resilient. It offers a better DX for consumers
                who prefer programmatic consumption. Outpost provides this
                flexibility out of the box as a core feature.
              </p>
              <p>Key features:</p>
              <p>
                - Multiple Delivery Methods: Webhooks + native Event
                Destinations (SQS, Kinesis, GCP Pub/Sub, RabbitMQ, Hookdeck,
                etc.).
              </p>
              <p>
                - Guaranteed Delivery: At-least-once guarantee with configurable
                automatic retries.
              </p>
              <p>
                - Observability: Built-in event log &amp; OpenTelemetry support.
              </p>
              <p>
                - Management: API for destination (endpoint) management;
                optional User Portal for end-user self-service (debugging,
                destination management).
              </p>
              <p>
                - Multi-tenancy, topics, webhook security best practices
                (signatures, timestamps), etc.
              </p>
              <p>
                Given you most likely already have a system in place, Outpost is
                backward compatible with your existing payload format, HTTP
                headers, and signatures.
              </p>
              <p>
                It's written in Go and licensed under Apache 2.0. It's still
                early days, and we'd love your feedback – especially on the
                architecture, desired event destinations, or any rough edges you
                find.
              </p>
              <p>
                GitHub:
                <a href="https://github.com/hookdeck/outpost"
                  >https://github.com/hookdeck/outpost</a
                >
                Docs:
                <a href="https://outpost.hookdeck.com/docs"
                  >https://outpost.hookdeck.com/docs</a
                >
              </p>
              <p>Thanks for checking it out!</p>
            </div>
          </section>
        </section>
        <section id="43903959">
          <h3>
            <a
              class="item"
              href="https://news.northwestern.edu/stories/2025/04/taking-the-bite-out-of-lyme-disease/"
              >Taking the bite out of Lyme disease</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 11:38:44</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43903959"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43903945">
          <h3>
            <a
              class="item"
              href="https://homepages.inf.ed.ac.uk/wadler/papers/propositions-as-types/propositions-as-types.pdf"
              >Propositions as Types (2014) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 11:36:09</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43903945"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43903853">
          <h3>
            <a
              class="item"
              href="https://trifectatech.org/blog/memory-safe-sudo-to-become-the-default-in-ubuntu/"
              >Memory-safe sudo to become the default in Ubuntu</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 11:22:55</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43903853"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43903741">
          <h3>
            <a
              class="item"
              href="https://www.seangoedecke.com/getting-things-done/"
              >Getting things “done” in large tech companies</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 11:04:39</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43903741"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43903728">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/scientists-taught-pet-parrots-to-video-call-each-other-and-the-birds-loved-it-180982041/"
              >Design and evaluation of a parrot-to-parrot video-calling system
              (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 11:03:28</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43903728"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43902869">
          <h3>
            <a
              class="item"
              href="https://haacked.com/archive/2012/07/05/turkish-i-problem-and-why-you-should-care.aspx/"
              >The Turkish İ Problem and Why You Should Care (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 08:34:17</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43902869"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43902263">
          <h3>
            <a
              class="item"
              href="https://www.blu-ray.com/movies/Sneakers-4K-Blu-ray/343185/"
              >Sneakers (1992)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 06:15:13</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43902263"
                  >Comments</a
                ><span class="descendants">: 170</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43902212">
          <h3>
            <a class="item" href="https://notashelf.dev/posts/curse-of-knowing"
              >The curse of knowing how, or; fixing everything</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 06:01:23</span
              ><span class="points-container"
                >Points: <span class="points">630</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43902212"
                  >Comments</a
                ><span class="descendants">: 287</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43901985">
          <h3>
            <a
              class="item"
              href="https://cel.cs.brown.edu/blog/an-interactive-debugger-for-rust-trait-errors/"
              >An Interactive Debugger for Rust Trait Errors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 05:09:42</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43901985"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43901619">
          <h3>
            <a
              class="item"
              href="https://anukari.com/blog/devlog/an-appeal-to-apple"
              >An appeal to Apple from Anukari</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 03:40:10</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43901619"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43901495">
          <h3>
            <a class="item" href="https://critical-css-extractor.kigo.studio/"
              >Critical CSS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 03:13:08</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43901495"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43900463">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2503.20481"
              >Analyzing Modern Nvidia GPU Cores</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 23:38:56</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43900463"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43899317">
          <h3>
            <a
              class="item"
              href="http://us-climate.blogspot.com/2015/03/dreary-weather.html"
              >Dreariness Index (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 20:50:00</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43899317"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43899251">
          <h3>
            <a
              class="item"
              href="https://uwithumlaut.wordpress.com/2020/07/24/pixels-in-islamic-art-square-kufic-calligraphy/"
              >Pixels in Islamic Art: Square Kufic Calligraphy (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 20:42:03</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43899251"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43899236">
          <h3>
            <a
              class="item"
              href="https://blog.yaakov.online/replacing-kubernetes-with-systemd/"
              >Replacing Kubernetes with systemd (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 20:40:14</span
              ><span class="points-container"
                >Points: <span class="points">349</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43899236"
                  >Comments</a
                ><span class="descendants">: 251</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43899028">
          <h3>
            <a class="item" href="https://github.com/KoljaB/RealtimeVoiceChat"
              >Show HN: Real-time AI Voice Chat at ~500ms Latency</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 20:17:32</span
              ><span class="points-container"
                >Points: <span class="points">453</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43899028"
                  >Comments</a
                ><span class="descendants">: 178</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43898717">
          <h3>
            <a class="item" href="https://winwang.blog/posts/bitonic-sort/"
              >Faster sorting with SIMD CUDA intrinsics (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 19:45:09</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43898717"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/wiwa/blog-code/"
                >https://github.com/wiwa/blog-code/</a
              >
            </div>
          </section>
        </section>
        <section id="43897772">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/evolving-our-structure/"
              >Evolving OpenAI's Structure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 18:08:02</span
              ><span class="points-container"
                >Points: <span class="points">572</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43897772"
                  >Comments</a
                ><span class="descendants">: 613</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43893442">
          <h3>
            <a
              class="item"
              href="https://www.scottishhistory.org/articles/the-inchtuthil-nail-hoard/"
              >The Inchtuthil Nail Hoard</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 10:17:17</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43893442"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43883642">
          <h3>
            <a
              class="item"
              href="https://www.thedial.world/articles/news/issue-27/switzerland-civilian-bunkers"
              >Why does Switzerland have so many bunkers?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-04 @ 01:05:16</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43883642"
                  >Comments</a
                ><span class="descendants">: 107</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43883230">
          <h3>
            <a
              class="item"
              href="https://www.smh.com.au/culture/music/even-this-modern-maestro-won-t-touch-the-world-s-weirdest-instrument-20250417-p5lsms.html"
              >Carolina Eyck, renowned superstar of the theremin</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-03 @ 23:35:31</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43883230"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43876798">
          <h3>
            <a class="item" href="https://www.vmos.com/"
              >VMOS – Virtual Android on Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-03 @ 04:08:22</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43876798"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43875476">
          <h3>
            <a
              class="item"
              href="https://micahflee.com/tm-sgnl-the-obscure-unofficial-signal-app-mike-waltz-uses-to-text-with-trump-officials/"
              >Technical analysis of the Signal clone used by Trump officials</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-02 @ 23:20:59</span
              ><span class="points-container"
                >Points: <span class="points">731</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43875476"
                  >Comments</a
                ><span class="descendants">: 304</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43871730">
          <h3>
            <a
              class="item"
              href="https://www.cbc.ca/radio/asithappens/as-it-happens-thursday-edition-1.2963357/sea-snail-teeth-top-kevlar-titanium-as-world-s-strongest-material-1.2963549"
              >Sea snail teeth top Kevlar, titanium as strongest material
              (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-02 @ 16:16:52</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43871730"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43871601">
          <h3>
            <a
              class="item"
              href="http://jas-hacks.blogspot.com/2025/05/rk3588-implementing-vectorscope-for.html"
              >RK3588 – Implementing a Vectorscope for processing video in real
              time</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-02 @ 16:05:30</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43871601"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
