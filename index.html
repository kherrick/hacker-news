<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36210133">
          <h3>
            <a
              class="item"
              href="https://twitter.com/sterlingcrispin/status/1665792422914453506"
              >Apple Vision predictive bio-feedback</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 09:09:29</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36210133"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36209867">
          <h3>
            <a
              class="item"
              href="https://erikjohannes.no/posts/20230108-reconstructing-obsidian-features-in-vim/"
              >Reconstructing Obsidian Features in Vim and Bash</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 08:32:40</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36209867"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36209574">
          <h3>
            <a
              class="item"
              href="https://www.freshpaint.io/blog/github-copilot-and-the-methods-of-rationality"
              >GitHub Copilot and the Methods of Rationality</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 07:50:46</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36209574"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36209408">
          <h3>
            <a class="item" href="https://developer.apple.com/passkeys/"
              >Passkeys now support external providers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 07:29:19</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36209408"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36209078">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/linux/KernelArgvFixup"
              >The Linux kernel will fix some peculiar argv usage in
              execve(2)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 06:49:07</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36209078"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36209047">
          <h3>
            <a
              class="item"
              href="https://www.nvidia.com/en-us/data-center/grace-hopper-superchip/"
              >Nvidia releases new AI chip with 480GB CPU RAM, 96GB GPU RAM</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 06:46:31</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36209047"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36209014">
          <h3>
            <a
              class="item"
              href="https://developer.apple.com/wwdc23/topics/ml-vision/"
              >Apple releasing segmentation/pose for humans and animals,
              embedding for 27 lang</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 06:42:31</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36209014"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36208568">
          <h3>
            <a
              class="item"
              href="https://blog.turso.tech/why-sqlite-is-so-great-for-the-edge-ee00a3a9a55f"
              >Why SQLite is so great for the edge</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 05:37:28</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36208568"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36207926">
          <h3>
            <a class="item" href="https://brandonhan.uk/HeadSculpt/"
              >HeadSculpt: Crafting 3D Head Avatars with Text</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 04:00:58</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36207926"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36207705">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/06/05/first-impressions-yes-apple-vision-pro-works-and-yes-its-good/"
              >First impressions: Yes, Apple Vision Pro works and yes, it’s
              good</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 03:31:57</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36207705"
                  >Comments</a
                ><span class="descendants">: 197</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36207268">
          <h3>
            <a
              class="item"
              href="https://nautil.us/what-hallucinogens-will-make-you-see-308247/"
              >What Hallucinogens Will Make You See</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 02:22:50</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36207268"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36207211">
          <h3>
            <a
              class="item"
              href="https://www.cbsnews.com/news/grail-cancer-test-mistake-letter/"
              >Grail wrongly told hundreds of people they might have cancer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 02:15:21</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36207211"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36207142">
          <h3>
            <a class="item" href="https://www.waituntil8th.org"
              >The Wait Until 8th pledge</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 02:04:53</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36207142"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36207009">
          <h3>
            <a
              class="item"
              href="https://zilliz.com/blog/exploring-magic-vector-databases-jupyter-notebooks"
              >Vector Database in a Jupyter Notebook</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 01:43:47</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36207009"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36206746">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/news/annals-of-crime/a-confession-exposes-indias-secret-hacking-industry"
              >A confession exposes India’s hacking industry</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 01:08:38</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36206746"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36206526">
          <h3>
            <a class="item" href="http://ascii.textfiles.com/archives/5543"
              >Preparing for the Incoming Computer Shopper Tsunami</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 00:39:28</span
              ><span class="points-container"
                >Points: <span class="points">332</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36206526"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36206347">
          <h3>
            <a
              class="item"
              href="http://www.gllamm.org/Chung_etal_Pmetrika2013.pdf"
              >A Penalized Likelihood Estimator for Variance Parameters in
              Multilevel Models [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-06 @ 00:18:41</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36206347"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36204453">
          <h3>
            <a
              class="item"
              href="https://iucompilercourse.github.io/tutorial-web-page/"
              >Tutorial: Teaching and Learning Compilers Incrementally</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 21:55:02</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36204453"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36203610">
          <h3>
            <a class="item" href="https://plebbit-test.netlify.app"
              >Demo: Fully P2P and open source Reddit alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 21:09:26</span
              ><span class="points-container"
                >Points: <span class="points">271</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36203610"
                  >Comments</a
                ><span class="descendants">: 185</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36201821">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2023/06/05/some-blogging-myths/"
              >Some blogging myths</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 19:12:44</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36201821"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36201593">
          <h3>
            <a
              class="item"
              href="https://www.apple.com/newsroom/2023/06/introducing-apple-vision-pro/"
              >Apple Vision Pro: Apple’s first spatial computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 19:04:46</span
              ><span class="points-container"
                >Points: <span class="points">2315</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36201593"
                  >Comments</a
                ><span class="descendants">: 2501</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36201143">
          <h3>
            <a class="item" href="https://floraincognita.com/"
              >Flora Incognita – free AI-supported plant identification
              university project</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 18:48:21</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36201143"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36201127">
          <h3>
            <a
              class="item"
              href="https://aljazaribook.com/en/2019/06/09/cast-brass-door-en/"
              >What is so beautiful about this door? On al-Jazari as an engineer
              (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 18:47:15</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36201127"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36198329">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2023/06/our-right-challenge-junk-patents-under-threat"
              >Our right to challenge junk patents is under threat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 16:03:55</span
              ><span class="points-container"
                >Points: <span class="points">1115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36198329"
                  >Comments</a
                ><span class="descendants">: 178</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36197880">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36197880"
              >Launch HN: Nucleus (YC S22) – Kubernetes platform for both devs
              and ops</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 15:39:09</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36197880"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
            <div class="text">
              <a href="https://nucleuscloud.com">https://nucleuscloud.com</a>),
              a Kubernetes developer platform. We automate infrastructure,
              security, integrations, and more, helping developers ship faster
              while also automating a lot of repetitive tasks for devops and
              platform teams. Here’s a demo:
              <a
                href="https://www.loom.com/share/95265177704346c7b379e981978cd8c5"
                >https://www.loom.com/share/95265177704346c7b379e981978cd8c5</a
              >.
              <p>
                It's expensive, time-consuming, and technically difficult to
                build a secure, scalable Kubernetes platform. Yet many companies
                that do this spend 6+ months building it themselves and then
                hire an expensive platform team to manage it. We've talked to
                customers who have spent $1.5M to build something that isn't
                their core product.
              </p>
              <p>
                On the technology side, you have to solve for authentication,
                authorization, service registry and discovery, scalability,
                observability, infrastructure and more. Most teams end up
                stitching together a bunch of OS tools and cloud primitives just
                to end up with a fragile system that’s difficult to maintain as
                it grows. On the people side, it’s difficult and expensive to
                find developers and devops engineers who deeply understand
                Kubernetes and distributed systems. When they leave, tech and
                process documentation is incomplete, hard to find and often
                outdated.
              </p>
              <p>
                Nick and I have been building infrastructure platforms for the
                past 7 years at companies like NewFront, Skyflow, IBM and
                Garmin. Companies like ours were spending a lot of time and
                energy in building internal developer platforms from scratch and
                then hiring expensive teams to maintain them. These were
                important platforms but never the companies’ core product. It
                seemed crazy to us that a series A company would have 2-3
                developers spend 6+ months building something that wasn't their
                core product. We felt like there had to be a better way.
              </p>
              <p>
                We’re building a platform that accomplishes 4 things: (1) Reduce
                the time it takes to spin up Kubernetes environments and
                services; (2) Provide an intuitive developer experience that
                simplifies working with Kubernetes; (3) Empower devops and
                platform teams to automate manual tasks and enable developer
                self service without spending months building infra; (4)
                Centralize, organize and be a source of truth for infra-related
                configurations, processes and documentation.
              </p>
              <p>
                To get into the architecture a bit, you can think of Nucleus as
                three layers:
              </p>
              <p>
                At the bottom layer, we build and manage pre-configured
                Kubernetes clusters in your AWS accounts. We install different
                add-ons into the cluster that enable key functionality such as
                security, autoscaling and metrics. You can find a full list in
                our docs -
                <a href="https://docs.nucleuscloud.com"
                  >https://docs.nucleuscloud.com</a
                >. The idea is that you can run Nucleus on autopilot without
                needing to be a Kubernetes expert. That said, many engineers
                want access to kubectl, so we make it easy to provision
                different user-profiles with different access to kubectl via an
                IAM role.
              </p>
              <p>
                The next layer up is the service mesh layer. We built on top of
                Istio to implement things like authN, authZ, service discovery
                and registry. We were also really inspired by this blogpost from
                the neobank Monzo (<a
                  href="https://monzo.com/blog/2022/03/31/how-we-secure-monzos-banking-platform"
                  >https://monzo.com/blog/2022/03/31/how-we-secure-monzos-banki...</a
                >). Each cluster has a dedicated load balancer that sits in a
                public subnet while the cluster and services are in a private
                subnet. Communication between these services uses mTLS. Private
                services are, by default, isolated and can’t talk to any other
                service unless you explicitly authorize it. We make that as easy
                as passing in the service name. This is all automated and
                transparent to the end-user. We’re soon going to be coming out
                with more features around managing load balancers and enabling
                blue-green deploys with zero downtime cutovers.
              </p>
              <p>
                The top layer is our integration layer. We provide a bunch of
                integrations and we’re continuing to building out more. This
                includes container registry tools (DockerHub, ECR, Github),
                Observability (Datadog, Prometheus, Grafana), Secrets Managers
                (param store), DBs (Aurora, MongoDb), and CI/CD (github
                actions). The idea is that you shouldn’t be spending time trying
                to build integrations for each of your services, you should just
                point-and-click which ones you need. We’ve built a permissioning
                system which makes it easy to give/revoke access for an
                integration to any service or environment. For example, if you
                want your dev services to have access to your dev db, you
                shouldn’t have to build that separately for each service. You
                just configure it once, pick the services or environment that
                needs access to and we automatically expose those environment
                variables to those services.
              </p>
              <p>
                Ultimately, the vision is to build a platform across all cloud
                providers that developers and devops teams can use to build,
                test, deploy and manage environments and services transparently.
                We strongly believe that developers and devops/platform teams
                should be working on the same platform. So many of the
                communication and siloing issues happen because teams use
                different platforms and tools. Consolidating those into one
                platform helps everyone stay in sync and have access to
                everything they need.
              </p>
              <p>
                We’ve never been big fans of the complicated pricing that most
                SaaS companies have so we sell Nucleus as a single annual
                license where you get everything. In full transparency, we
                currently price Nucleus around $35k/license, or about 10% of
                what it would cost you to build and maintain this yourself.
              </p>
              <p>
                Our current customers range from small startups who want to
                focus on getting to market fast and not worry about infra or
                devops, to mid-market companies that want to empower their
                existing devops teams with automation. Their main use-cases are:
                1. Automatically containerizing their services (with our
                built-in CI/CD pipeline) and deploying them on Kubernetes 2.
                Building out a microservices architecture (we have a built-in in
                service mesh) 3. Making it easy for developers to self-service
                environments, environment variables and more.
              </p>
              <p>
                If you're interested to learn more, check out our docs (<a
                  href="https://docs.nucleuscloud.com"
                  >https://docs.nucleuscloud.com</a
                >) and you can sign up for a free account here (<a
                  href="https://app.nucleuscloud.com"
                  >https://app.nucleuscloud.com</a
                >). We're always looking for feedback so please let us know your
                thoughts/questions and thanks for having us!
              </p>
            </div>
          </section>
        </section>
        <section id="36195885">
          <h3>
            <a
              class="item"
              href="https://onthearts.com/p/how-wittgenstein-watched-movies"
              >How Wittgenstein Watched Movies</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 13:27:02</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36195885"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36195105">
          <h3>
            <a
              class="item"
              href="https://neurofrontiers.blog/helplessness-is-not-learned/"
              >Helplessness is not learned (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 12:02:15</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36195105"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36194473">
          <h3>
            <a class="item" href="https://sql.ophir.dev/"
              >Show HN: SQLPage – Build Dynamic Websites with Just SQL
              Queries</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 10:20:45</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36194473"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <p>
                I wanted to share the open source project I have been working on
                during the last year: SQLPage, a tool to build small web
                applications entirely in SQL.
              </p>
              <p>
                Building web applications with just SQL isn't as crazy as it
                seems. Most simple applications can be expressed declaratively
                as just data queries that fill pre-defined web components.
              </p>
              <p>
                I'd love to hear your feedback and thoughts on it. Would you
                potentially use it? How can it be improved?
              </p>
              <p>
                Website:
                <a href="https://sql.ophir.dev/">https://sql.ophir.dev/</a>
                Github:
                <a href="https://github.com/lovasoa/SQLpage"
                  >https://github.com/lovasoa/SQLpage</a
                >
                Example app:
                <a href="https://conundrum.ophir.dev/"
                  >https://conundrum.ophir.dev/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36193495">
          <h3>
            <a class="item" href="https://qri.org/blog/psycrypto-contest"
              >Messages that can only be understood under the influence of
              psychedelics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 07:27:35</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36193495"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36193196">
          <h3>
            <a
              class="item"
              href="https://yeokhengmeng.com/2023/06/teardown-and-review-of-hand386/"
              >Teardown and review of a new 386 system: Hand386</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-06-05 @ 06:45:18</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36193196"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
