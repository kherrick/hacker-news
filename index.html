<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43178225">
          <h3>
            <a class="item" href="https://www.linkedin.com/jobs/view/4165715593"
              >Voker (YC S24) is hiring an LA-based full stack AI software
              engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 22:13:22</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43177931">
          <h3>
            <a
              class="item"
              href="https://www.geldata.com/blog/edgedb-is-now-gel-and-postgres-is-the-future"
              >EdgeDB is now Gel and Postgres is the Future</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 21:47:06</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43177931"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43177117">
          <h3>
            <a class="item" href="https://github.com/drivecore/mycoder"
              >Show HN: MyCoder, an open source Claude-Code alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 20:41:30</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43177117"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43176782">
          <h3>
            <a class="item" href="https://www.tedwiggin.com/MIMT.html"
              >Ghost House – software for automatic inbetweens</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 20:16:10</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43176782"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43176553">
          <h3>
            <a
              class="item"
              href="https://martins1612.github.io/emergent_misalignment_betley.pdf"
              >Emergent Misalignment: Narrow finetuning can produce broadly
              misaligned LLMs [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 19:59:41</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43176553"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43176314">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2025/02/framework-known-for-upgradable-laptops-intros-not-particularly-upgradable-desktop/"
              >Framework's first desktop is a strange–but unique–mini ITX gaming
              PC</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 19:39:21</span
              ><span class="points-container"
                >Points: <span class="points">314</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43176314"
                  >Comments</a
                ><span class="descendants">: 286</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43175628">
          <h3>
            <a
              class="item"
              href="https://sockpuppet.org/blog/2025/02/09/fixing-illinois-foia/"
              >I Went to SQL Injection Court</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 18:39:10</span
              ><span class="points-container"
                >Points: <span class="points">515</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43175628"
                  >Comments</a
                ><span class="descendants">: 202</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43175408">
          <h3>
            <a
              class="item"
              href="https://pypy.org/posts/2025/02/pypy-gc-sampling.html"
              >Low Overhead Allocation Sampling with VMProf in PyPy's GC</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 18:20:18</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43175408"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43175315">
          <h3>
            <a class="item" href="http://codex99.com/photography/the-xb70.html"
              >The XB-70 (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 18:12:31</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43175315"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43174910">
          <h3>
            <a
              class="item"
              href="https://noperator.dev/posts/document-ranking-for-complex-problems/"
              >Hard problems that reduce to document ranking</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 17:37:07</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43174910"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43174221">
          <h3>
            <a class="item" href="https://www.tech-pubs.net/wiki/Main_Page"
              >Show HN: My new wiki for Silicon Graphics stuff</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 16:46:07</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43174221"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
            <div class="text">
              I also run IRIXNet. I'm here to share my newest SGI-related
              project.
            </div>
          </section>
        </section>
        <section id="43173773">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/new-maps-of-the-bizarre-chaotic-space-time-inside-black-holes-20250224/"
              >New maps of the chaotic space-time inside black holes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 16:15:39</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43173773"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43173462">
          <h3>
            <a
              class="item"
              href="https://hypercritical.co/2025/02/25/hyperspace"
              >Hyperspace</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 15:51:54</span
              ><span class="points-container"
                >Points: <span class="points">512</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43173462"
                  >Comments</a
                ><span class="descendants">: 298</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43173378">
          <h3>
            <a class="item" href="https://github.com/browser-use/browser-use"
              >Launch HN: Browser Use (YC W25) – open-source web agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 15:45:17</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43173378"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
            <div class="text">
              <a href="https://browser-use.com/">https://browser-use.com/</a>),
              an easy way to connect AI agents with the browser. Our agent
              library is open-source (<a
                href="https://github.com/browser-use/browser-use"
                >https://github.com/browser-use/browser-use</a
              >) and we have what is the biggest open-source community for
              browser agents. And now we have a cloud offering—hence our Launch
              HN today!
              <p>
                Check out this video to see it in action:
                <a href="https://preview.screen.studio/share/r1h4DuAk"
                  >https://preview.screen.studio/share/r1h4DuAk</a
                >. There are lots more demos at
                <a href="https://github.com/browser-use/browser-use"
                  >https://github.com/browser-use/browser-use</a
                >
                on how we control the web with prompts.
              </p>
              <p>
                We started coding a decade ago with Selenium bots and macros to
                automate tasks. Then we both moved into ML. Last November, we
                asked ourselves, “How hard could it be to build the interface
                between LLMs and the web?”
              </p>
              <p>
                We launched on Show HN (<a
                  href="https://news.ycombinator.com/item?id=42052432"
                  >https://news.ycombinator.com/item?id=42052432</a
                >) and have since been addressing various challenges of browser
                automation, such as: - Automation scripts break when the website
                changes - Automation scripts are annoying to build - Captchas
                and rate limits - parsing errors and API key management - and
                perhaps worst of all, login screens.
              </p>
              <p>
                People use us to fill out their forms, extract data behind login
                walls, or automate their CRM. Others use the xPaths browser-use
                clicked on and build their scripts faster, or directly rerun the
                actions of browser-use deterministically. We’re currently
                working on robust task reruns, agent memory for long tasks,
                parallelization for repetitive tasks, and many other sweet
                improvements.
              </p>
              <p>
                One interesting aspect is that some companies now want to change
                their UI to be more agent-friendly. Some developers even replace
                ugly UIs with nice ones and use browser-use to copy data over.
              </p>
              <p>
                Besides the open-source we have an API. We host the browser and
                LLMs for you and help you with handling proxy rotation,
                persistent sessions and allowing you to run multiple instances
                in parallel. We price at $30/month—significantly lower than
                OpenAI’s Operator.
              </p>
              <p>
                On the open-source side, browser use remains free. You can use
                any LLM, from Gemini to Sonnet, Qwen, or even DeepSeek-R1. It’s
                licensed under MIT, giving you full freedom to customize it.
              </p>
              <p>
                We’d love to hear from you—what automation challenges are you
                facing? Any thoughts, questions, experiences are welcome!
              </p>
            </div>
          </section>
        </section>
        <section id="43172338">
          <h3>
            <a
              class="item"
              href="https://milvus.io/blog/introduce-deepsearcher-a-local-open-source-deep-research.md"
              >DeepSearcher: A local open-source Deep Research</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 14:33:42</span
              ><span class="points-container"
                >Points: <span class="points">157</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43172338"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43171239">
          <h3>
            <a
              class="item"
              href="https://dashbit.co/blog/running-python-in-elixir-its-fine"
              >Embedding Python in Elixir, it's fine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 12:53:15</span
              ><span class="points-container"
                >Points: <span class="points">236</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43171239"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43170545">
          <h3>
            <a class="item" href="https://chicory.dev/"
              >Chicory: A JVM native WebAssembly runtime</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 11:22:06</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43170545"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43169773">
          <h3>
            <a
              class="item"
              href="https://lukasz.langa.pl/f37aa97a-9ea3-4aeb-b6a0-9daeea5a7505/"
              >A possible future of Python in the browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 09:15:14</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43169773"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43162793">
          <h3>
            <a class="item" href="https://github.com/ggerganov/ggwave"
              >Ggwave: Tiny Data-over-Sound Library</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-24 @ 18:09:19</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43162793"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43159222">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=a0CVCcb0RJM"
              >I recreated Shazam's algorithm with Go [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-24 @ 13:20:43</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43159222"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43154295">
          <h3>
            <a
              class="item"
              href="https://www.newsweek.com/bald-eagles-back-brink-extinction-2025097"
              >Bald eagles are thriving again after near extinction</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 23:36:03</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43154295"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43151943">
          <h3>
            <a
              class="item"
              href="https://mathstodon.xyz/@tao/114054291471216181"
              >Part two of Grant Sanderson's video with Terry Tao on the cosmic
              distance ladder</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 18:51:49</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43151943"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43149077">
          <h3>
            <a
              class="item"
              href="https://shkspr.mobi/blog/2025/02/why-are-qr-codes-with-capital-letters-smaller-than-qr-codes-with-lower-case-letters/"
              >Why are QR Codes with capital letters smaller than QR codes with
              lower case?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-23 @ 13:25:44</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43149077"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43138960">
          <h3>
            <a
              class="item"
              href="https://forums.hexus.net/hexus-news/426608-looks-like-end-hexus-forums.html"
              >Forum with 2.6M posts being deleted due to UK Online Safety
              Act</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 13:55:03</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43138960"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43138497">
          <h3>
            <a
              class="item"
              href="https://www.macsparky.com/blog/2025/02/knitting-your-parachute/"
              >Knitting Your Parachute</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 12:42:48</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43138497"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43138368">
          <h3>
            <a
              class="item"
              href="https://blog.gitbutler.com/how-git-core-devs-configure-git/"
              >How core Git developers configure Git</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 12:23:56</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43138368"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43137616">
          <h3>
            <a
              class="item"
              href="https://p.migdal.pl/blog/2025/02/markdown-saves/"
              >If it is worth keeping, save it in Markdown</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 09:52:26</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43137616"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43134657">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-02-static-electricity-materials-contact-history.html"
              >Static electricity depends on materials' contact history</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-22 @ 00:02:14</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43134657"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43134563">
          <h3>
            <a class="item" href="https://xon.sh/"
              >Xonsh – A Python-powered shell</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-21 @ 23:48:53</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43134563"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43133207">
          <h3>
            <a
              class="item"
              href="https://www.ben-evans.com/benedictevans/2025/2/17/the-deep-research-problem"
              >The Deep Research problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-21 @ 21:26:28</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43133207"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
